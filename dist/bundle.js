(() => {
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __markAsModule = (target) => __defProp(target, "__esModule", {value: true});
  var __commonJS = (callback, module) => () => {
    if (!module) {
      module = {exports: {}};
      callback(module.exports, module);
    }
    return module.exports;
  };
  var __export = (target, all) => {
    __markAsModule(target);
    for (var name in all)
      __defProp(target, name, {get: all[name], enumerable: true});
  };
  var __exportStar = (target, module, desc) => {
    __markAsModule(target);
    if (module && typeof module === "object" || typeof module === "function") {
      for (let key of __getOwnPropNames(module))
        if (!__hasOwnProp.call(target, key) && key !== "default")
          __defProp(target, key, {get: () => module[key], enumerable: !(desc = __getOwnPropDesc(module, key)) || desc.enumerable});
    }
    return target;
  };
  var __toModule = (module) => {
    if (module && module.__esModule)
      return module;
    return __exportStar(__defProp(module != null ? __create(__getProtoOf(module)) : {}, "default", {value: module, enumerable: true}), module);
  };

  // node_modules/es6-promise-polyfill/promise.js
  var require_promise = __commonJS((exports) => {
    (function(global2) {
      var NativePromise = global2["Promise"];
      var nativePromiseSupported = NativePromise && "resolve" in NativePromise && "reject" in NativePromise && "all" in NativePromise && "race" in NativePromise && function() {
        var resolve2;
        new NativePromise(function(r) {
          resolve2 = r;
        });
        return typeof resolve2 === "function";
      }();
      if (typeof exports !== "undefined" && exports) {
        exports.Promise = nativePromiseSupported ? NativePromise : Promise2;
        exports.Polyfill = Promise2;
      } else {
        if (typeof define == "function" && define.amd) {
          define(function() {
            return nativePromiseSupported ? NativePromise : Promise2;
          });
        } else {
          if (!nativePromiseSupported)
            global2["Promise"] = Promise2;
        }
      }
      var PENDING = "pending";
      var SEALED = "sealed";
      var FULFILLED = "fulfilled";
      var REJECTED = "rejected";
      var NOOP = function() {
      };
      function isArray(value) {
        return Object.prototype.toString.call(value) === "[object Array]";
      }
      var asyncSetTimer = typeof setImmediate !== "undefined" ? setImmediate : setTimeout;
      var asyncQueue = [];
      var asyncTimer;
      function asyncFlush() {
        for (var i = 0; i < asyncQueue.length; i++)
          asyncQueue[i][0](asyncQueue[i][1]);
        asyncQueue = [];
        asyncTimer = false;
      }
      function asyncCall(callback, arg) {
        asyncQueue.push([callback, arg]);
        if (!asyncTimer) {
          asyncTimer = true;
          asyncSetTimer(asyncFlush, 0);
        }
      }
      function invokeResolver(resolver, promise) {
        function resolvePromise(value) {
          resolve(promise, value);
        }
        function rejectPromise(reason) {
          reject(promise, reason);
        }
        try {
          resolver(resolvePromise, rejectPromise);
        } catch (e) {
          rejectPromise(e);
        }
      }
      function invokeCallback(subscriber) {
        var owner = subscriber.owner;
        var settled = owner.state_;
        var value = owner.data_;
        var callback = subscriber[settled];
        var promise = subscriber.then;
        if (typeof callback === "function") {
          settled = FULFILLED;
          try {
            value = callback(value);
          } catch (e) {
            reject(promise, e);
          }
        }
        if (!handleThenable(promise, value)) {
          if (settled === FULFILLED)
            resolve(promise, value);
          if (settled === REJECTED)
            reject(promise, value);
        }
      }
      function handleThenable(promise, value) {
        var resolved;
        try {
          if (promise === value)
            throw new TypeError("A promises callback cannot return that same promise.");
          if (value && (typeof value === "function" || typeof value === "object")) {
            var then = value.then;
            if (typeof then === "function") {
              then.call(value, function(val) {
                if (!resolved) {
                  resolved = true;
                  if (value !== val)
                    resolve(promise, val);
                  else
                    fulfill(promise, val);
                }
              }, function(reason) {
                if (!resolved) {
                  resolved = true;
                  reject(promise, reason);
                }
              });
              return true;
            }
          }
        } catch (e) {
          if (!resolved)
            reject(promise, e);
          return true;
        }
        return false;
      }
      function resolve(promise, value) {
        if (promise === value || !handleThenable(promise, value))
          fulfill(promise, value);
      }
      function fulfill(promise, value) {
        if (promise.state_ === PENDING) {
          promise.state_ = SEALED;
          promise.data_ = value;
          asyncCall(publishFulfillment, promise);
        }
      }
      function reject(promise, reason) {
        if (promise.state_ === PENDING) {
          promise.state_ = SEALED;
          promise.data_ = reason;
          asyncCall(publishRejection, promise);
        }
      }
      function publish(promise) {
        var callbacks = promise.then_;
        promise.then_ = void 0;
        for (var i = 0; i < callbacks.length; i++) {
          invokeCallback(callbacks[i]);
        }
      }
      function publishFulfillment(promise) {
        promise.state_ = FULFILLED;
        publish(promise);
      }
      function publishRejection(promise) {
        promise.state_ = REJECTED;
        publish(promise);
      }
      function Promise2(resolver) {
        if (typeof resolver !== "function")
          throw new TypeError("Promise constructor takes a function argument");
        if (this instanceof Promise2 === false)
          throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
        this.then_ = [];
        invokeResolver(resolver, this);
      }
      Promise2.prototype = {
        constructor: Promise2,
        state_: PENDING,
        then_: null,
        data_: void 0,
        then: function(onFulfillment, onRejection) {
          var subscriber = {
            owner: this,
            then: new this.constructor(NOOP),
            fulfilled: onFulfillment,
            rejected: onRejection
          };
          if (this.state_ === FULFILLED || this.state_ === REJECTED) {
            asyncCall(invokeCallback, subscriber);
          } else {
            this.then_.push(subscriber);
          }
          return subscriber.then;
        },
        catch: function(onRejection) {
          return this.then(null, onRejection);
        }
      };
      Promise2.all = function(promises) {
        var Class = this;
        if (!isArray(promises))
          throw new TypeError("You must pass an array to Promise.all().");
        return new Class(function(resolve2, reject2) {
          var results = [];
          var remaining = 0;
          function resolver(index2) {
            remaining++;
            return function(value) {
              results[index2] = value;
              if (!--remaining)
                resolve2(results);
            };
          }
          for (var i = 0, promise; i < promises.length; i++) {
            promise = promises[i];
            if (promise && typeof promise.then === "function")
              promise.then(resolver(i), reject2);
            else
              results[i] = promise;
          }
          if (!remaining)
            resolve2(results);
        });
      };
      Promise2.race = function(promises) {
        var Class = this;
        if (!isArray(promises))
          throw new TypeError("You must pass an array to Promise.race().");
        return new Class(function(resolve2, reject2) {
          for (var i = 0, promise; i < promises.length; i++) {
            promise = promises[i];
            if (promise && typeof promise.then === "function")
              promise.then(resolve2, reject2);
            else
              resolve2(promise);
          }
        });
      };
      Promise2.resolve = function(value) {
        var Class = this;
        if (value && typeof value === "object" && value.constructor === Class)
          return value;
        return new Class(function(resolve2) {
          resolve2(value);
        });
      };
      Promise2.reject = function(reason) {
        var Class = this;
        return new Class(function(resolve2, reject2) {
          reject2(reason);
        });
      };
    })(typeof window != "undefined" ? window : typeof global != "undefined" ? global : typeof self != "undefined" ? self : exports);
  });

  // node_modules/object-assign/index.js
  var require_object_assign = __commonJS((exports, module) => {
    /*
    object-assign
    (c) Sindre Sorhus
    @license MIT
    */
    "use strict";
    var getOwnPropertySymbols = Object.getOwnPropertySymbols;
    var hasOwnProperty = Object.prototype.hasOwnProperty;
    var propIsEnumerable = Object.prototype.propertyIsEnumerable;
    function toObject(val) {
      if (val === null || val === void 0) {
        throw new TypeError("Object.assign cannot be called with null or undefined");
      }
      return Object(val);
    }
    function shouldUseNative() {
      try {
        if (!Object.assign) {
          return false;
        }
        var test1 = new String("abc");
        test1[5] = "de";
        if (Object.getOwnPropertyNames(test1)[0] === "5") {
          return false;
        }
        var test2 = {};
        for (var i = 0; i < 10; i++) {
          test2["_" + String.fromCharCode(i)] = i;
        }
        var order2 = Object.getOwnPropertyNames(test2).map(function(n) {
          return test2[n];
        });
        if (order2.join("") !== "0123456789") {
          return false;
        }
        var test3 = {};
        "abcdefghijklmnopqrst".split("").forEach(function(letter) {
          test3[letter] = letter;
        });
        if (Object.keys(Object.assign({}, test3)).join("") !== "abcdefghijklmnopqrst") {
          return false;
        }
        return true;
      } catch (err) {
        return false;
      }
    }
    module.exports = shouldUseNative() ? Object.assign : function(target, source) {
      var from;
      var to = toObject(target);
      var symbols;
      for (var s = 1; s < arguments.length; s++) {
        from = Object(arguments[s]);
        for (var key in from) {
          if (hasOwnProperty.call(from, key)) {
            to[key] = from[key];
          }
        }
        if (getOwnPropertySymbols) {
          symbols = getOwnPropertySymbols(from);
          for (var i = 0; i < symbols.length; i++) {
            if (propIsEnumerable.call(from, symbols[i])) {
              to[symbols[i]] = from[symbols[i]];
            }
          }
        }
      }
      return to;
    };
  });

  // node_modules/eventemitter3/index.js
  var require_eventemitter3 = __commonJS((exports, module) => {
    "use strict";
    var has = Object.prototype.hasOwnProperty;
    var prefix = "~";
    function Events() {
    }
    if (Object.create) {
      Events.prototype = Object.create(null);
      if (!new Events().__proto__)
        prefix = false;
    }
    function EE(fn, context2, once) {
      this.fn = fn;
      this.context = context2;
      this.once = once || false;
    }
    function addListener(emitter, event, fn, context2, once) {
      if (typeof fn !== "function") {
        throw new TypeError("The listener must be a function");
      }
      var listener = new EE(fn, context2 || emitter, once), evt = prefix ? prefix + event : event;
      if (!emitter._events[evt])
        emitter._events[evt] = listener, emitter._eventsCount++;
      else if (!emitter._events[evt].fn)
        emitter._events[evt].push(listener);
      else
        emitter._events[evt] = [emitter._events[evt], listener];
      return emitter;
    }
    function clearEvent(emitter, evt) {
      if (--emitter._eventsCount === 0)
        emitter._events = new Events();
      else
        delete emitter._events[evt];
    }
    function EventEmitter() {
      this._events = new Events();
      this._eventsCount = 0;
    }
    EventEmitter.prototype.eventNames = function eventNames() {
      var names = [], events, name;
      if (this._eventsCount === 0)
        return names;
      for (name in events = this._events) {
        if (has.call(events, name))
          names.push(prefix ? name.slice(1) : name);
      }
      if (Object.getOwnPropertySymbols) {
        return names.concat(Object.getOwnPropertySymbols(events));
      }
      return names;
    };
    EventEmitter.prototype.listeners = function listeners(event) {
      var evt = prefix ? prefix + event : event, handlers = this._events[evt];
      if (!handlers)
        return [];
      if (handlers.fn)
        return [handlers.fn];
      for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {
        ee[i] = handlers[i].fn;
      }
      return ee;
    };
    EventEmitter.prototype.listenerCount = function listenerCount(event) {
      var evt = prefix ? prefix + event : event, listeners = this._events[evt];
      if (!listeners)
        return 0;
      if (listeners.fn)
        return 1;
      return listeners.length;
    };
    EventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {
      var evt = prefix ? prefix + event : event;
      if (!this._events[evt])
        return false;
      var listeners = this._events[evt], len = arguments.length, args, i;
      if (listeners.fn) {
        if (listeners.once)
          this.removeListener(event, listeners.fn, void 0, true);
        switch (len) {
          case 1:
            return listeners.fn.call(listeners.context), true;
          case 2:
            return listeners.fn.call(listeners.context, a1), true;
          case 3:
            return listeners.fn.call(listeners.context, a1, a2), true;
          case 4:
            return listeners.fn.call(listeners.context, a1, a2, a3), true;
          case 5:
            return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;
          case 6:
            return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;
        }
        for (i = 1, args = new Array(len - 1); i < len; i++) {
          args[i - 1] = arguments[i];
        }
        listeners.fn.apply(listeners.context, args);
      } else {
        var length = listeners.length, j;
        for (i = 0; i < length; i++) {
          if (listeners[i].once)
            this.removeListener(event, listeners[i].fn, void 0, true);
          switch (len) {
            case 1:
              listeners[i].fn.call(listeners[i].context);
              break;
            case 2:
              listeners[i].fn.call(listeners[i].context, a1);
              break;
            case 3:
              listeners[i].fn.call(listeners[i].context, a1, a2);
              break;
            case 4:
              listeners[i].fn.call(listeners[i].context, a1, a2, a3);
              break;
            default:
              if (!args)
                for (j = 1, args = new Array(len - 1); j < len; j++) {
                  args[j - 1] = arguments[j];
                }
              listeners[i].fn.apply(listeners[i].context, args);
          }
        }
      }
      return true;
    };
    EventEmitter.prototype.on = function on(event, fn, context2) {
      return addListener(this, event, fn, context2, false);
    };
    EventEmitter.prototype.once = function once(event, fn, context2) {
      return addListener(this, event, fn, context2, true);
    };
    EventEmitter.prototype.removeListener = function removeListener(event, fn, context2, once) {
      var evt = prefix ? prefix + event : event;
      if (!this._events[evt])
        return this;
      if (!fn) {
        clearEvent(this, evt);
        return this;
      }
      var listeners = this._events[evt];
      if (listeners.fn) {
        if (listeners.fn === fn && (!once || listeners.once) && (!context2 || listeners.context === context2)) {
          clearEvent(this, evt);
        }
      } else {
        for (var i = 0, events = [], length = listeners.length; i < length; i++) {
          if (listeners[i].fn !== fn || once && !listeners[i].once || context2 && listeners[i].context !== context2) {
            events.push(listeners[i]);
          }
        }
        if (events.length)
          this._events[evt] = events.length === 1 ? events[0] : events;
        else
          clearEvent(this, evt);
      }
      return this;
    };
    EventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {
      var evt;
      if (event) {
        evt = prefix ? prefix + event : event;
        if (this._events[evt])
          clearEvent(this, evt);
      } else {
        this._events = new Events();
        this._eventsCount = 0;
      }
      return this;
    };
    EventEmitter.prototype.off = EventEmitter.prototype.removeListener;
    EventEmitter.prototype.addListener = EventEmitter.prototype.on;
    EventEmitter.prefixed = prefix;
    EventEmitter.EventEmitter = EventEmitter;
    if (typeof module !== "undefined") {
      module.exports = EventEmitter;
    }
  });

  // node_modules/earcut/src/earcut.js
  var require_earcut = __commonJS((exports, module) => {
    "use strict";
    module.exports = earcut;
    module.exports.default = earcut;
    function earcut(data, holeIndices, dim) {
      dim = dim || 2;
      var hasHoles = holeIndices && holeIndices.length, outerLen = hasHoles ? holeIndices[0] * dim : data.length, outerNode = linkedList(data, 0, outerLen, dim, true), triangles = [];
      if (!outerNode || outerNode.next === outerNode.prev)
        return triangles;
      var minX, minY, maxX, maxY, x, y, invSize;
      if (hasHoles)
        outerNode = eliminateHoles(data, holeIndices, outerNode, dim);
      if (data.length > 80 * dim) {
        minX = maxX = data[0];
        minY = maxY = data[1];
        for (var i = dim; i < outerLen; i += dim) {
          x = data[i];
          y = data[i + 1];
          if (x < minX)
            minX = x;
          if (y < minY)
            minY = y;
          if (x > maxX)
            maxX = x;
          if (y > maxY)
            maxY = y;
        }
        invSize = Math.max(maxX - minX, maxY - minY);
        invSize = invSize !== 0 ? 1 / invSize : 0;
      }
      earcutLinked(outerNode, triangles, dim, minX, minY, invSize);
      return triangles;
    }
    function linkedList(data, start, end, dim, clockwise) {
      var i, last;
      if (clockwise === signedArea(data, start, end, dim) > 0) {
        for (i = start; i < end; i += dim)
          last = insertNode(i, data[i], data[i + 1], last);
      } else {
        for (i = end - dim; i >= start; i -= dim)
          last = insertNode(i, data[i], data[i + 1], last);
      }
      if (last && equals(last, last.next)) {
        removeNode(last);
        last = last.next;
      }
      return last;
    }
    function filterPoints(start, end) {
      if (!start)
        return start;
      if (!end)
        end = start;
      var p = start, again;
      do {
        again = false;
        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {
          removeNode(p);
          p = end = p.prev;
          if (p === p.next)
            break;
          again = true;
        } else {
          p = p.next;
        }
      } while (again || p !== end);
      return end;
    }
    function earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {
      if (!ear)
        return;
      if (!pass && invSize)
        indexCurve(ear, minX, minY, invSize);
      var stop = ear, prev, next;
      while (ear.prev !== ear.next) {
        prev = ear.prev;
        next = ear.next;
        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {
          triangles.push(prev.i / dim);
          triangles.push(ear.i / dim);
          triangles.push(next.i / dim);
          removeNode(ear);
          ear = next.next;
          stop = next.next;
          continue;
        }
        ear = next;
        if (ear === stop) {
          if (!pass) {
            earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);
          } else if (pass === 1) {
            ear = cureLocalIntersections(filterPoints(ear), triangles, dim);
            earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);
          } else if (pass === 2) {
            splitEarcut(ear, triangles, dim, minX, minY, invSize);
          }
          break;
        }
      }
    }
    function isEar(ear) {
      var a = ear.prev, b = ear, c = ear.next;
      if (area(a, b, c) >= 0)
        return false;
      var p = ear.next.next;
      while (p !== ear.prev) {
        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) && area(p.prev, p, p.next) >= 0)
          return false;
        p = p.next;
      }
      return true;
    }
    function isEarHashed(ear, minX, minY, invSize) {
      var a = ear.prev, b = ear, c = ear.next;
      if (area(a, b, c) >= 0)
        return false;
      var minTX = a.x < b.x ? a.x < c.x ? a.x : c.x : b.x < c.x ? b.x : c.x, minTY = a.y < b.y ? a.y < c.y ? a.y : c.y : b.y < c.y ? b.y : c.y, maxTX = a.x > b.x ? a.x > c.x ? a.x : c.x : b.x > c.x ? b.x : c.x, maxTY = a.y > b.y ? a.y > c.y ? a.y : c.y : b.y > c.y ? b.y : c.y;
      var minZ = zOrder(minTX, minTY, minX, minY, invSize), maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);
      var p = ear.prevZ, n = ear.nextZ;
      while (p && p.z >= minZ && n && n.z <= maxZ) {
        if (p !== ear.prev && p !== ear.next && pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) && area(p.prev, p, p.next) >= 0)
          return false;
        p = p.prevZ;
        if (n !== ear.prev && n !== ear.next && pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) && area(n.prev, n, n.next) >= 0)
          return false;
        n = n.nextZ;
      }
      while (p && p.z >= minZ) {
        if (p !== ear.prev && p !== ear.next && pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) && area(p.prev, p, p.next) >= 0)
          return false;
        p = p.prevZ;
      }
      while (n && n.z <= maxZ) {
        if (n !== ear.prev && n !== ear.next && pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) && area(n.prev, n, n.next) >= 0)
          return false;
        n = n.nextZ;
      }
      return true;
    }
    function cureLocalIntersections(start, triangles, dim) {
      var p = start;
      do {
        var a = p.prev, b = p.next.next;
        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {
          triangles.push(a.i / dim);
          triangles.push(p.i / dim);
          triangles.push(b.i / dim);
          removeNode(p);
          removeNode(p.next);
          p = start = b;
        }
        p = p.next;
      } while (p !== start);
      return filterPoints(p);
    }
    function splitEarcut(start, triangles, dim, minX, minY, invSize) {
      var a = start;
      do {
        var b = a.next.next;
        while (b !== a.prev) {
          if (a.i !== b.i && isValidDiagonal(a, b)) {
            var c = splitPolygon(a, b);
            a = filterPoints(a, a.next);
            c = filterPoints(c, c.next);
            earcutLinked(a, triangles, dim, minX, minY, invSize);
            earcutLinked(c, triangles, dim, minX, minY, invSize);
            return;
          }
          b = b.next;
        }
        a = a.next;
      } while (a !== start);
    }
    function eliminateHoles(data, holeIndices, outerNode, dim) {
      var queue2 = [], i, len, start, end, list;
      for (i = 0, len = holeIndices.length; i < len; i++) {
        start = holeIndices[i] * dim;
        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;
        list = linkedList(data, start, end, dim, false);
        if (list === list.next)
          list.steiner = true;
        queue2.push(getLeftmost(list));
      }
      queue2.sort(compareX);
      for (i = 0; i < queue2.length; i++) {
        eliminateHole(queue2[i], outerNode);
        outerNode = filterPoints(outerNode, outerNode.next);
      }
      return outerNode;
    }
    function compareX(a, b) {
      return a.x - b.x;
    }
    function eliminateHole(hole, outerNode) {
      outerNode = findHoleBridge(hole, outerNode);
      if (outerNode) {
        var b = splitPolygon(outerNode, hole);
        filterPoints(outerNode, outerNode.next);
        filterPoints(b, b.next);
      }
    }
    function findHoleBridge(hole, outerNode) {
      var p = outerNode, hx = hole.x, hy = hole.y, qx = -Infinity, m;
      do {
        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {
          var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);
          if (x <= hx && x > qx) {
            qx = x;
            if (x === hx) {
              if (hy === p.y)
                return p;
              if (hy === p.next.y)
                return p.next;
            }
            m = p.x < p.next.x ? p : p.next;
          }
        }
        p = p.next;
      } while (p !== outerNode);
      if (!m)
        return null;
      if (hx === qx)
        return m;
      var stop = m, mx = m.x, my = m.y, tanMin = Infinity, tan;
      p = m;
      do {
        if (hx >= p.x && p.x >= mx && hx !== p.x && pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {
          tan = Math.abs(hy - p.y) / (hx - p.x);
          if (locallyInside(p, hole) && (tan < tanMin || tan === tanMin && (p.x > m.x || p.x === m.x && sectorContainsSector(m, p)))) {
            m = p;
            tanMin = tan;
          }
        }
        p = p.next;
      } while (p !== stop);
      return m;
    }
    function sectorContainsSector(m, p) {
      return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;
    }
    function indexCurve(start, minX, minY, invSize) {
      var p = start;
      do {
        if (p.z === null)
          p.z = zOrder(p.x, p.y, minX, minY, invSize);
        p.prevZ = p.prev;
        p.nextZ = p.next;
        p = p.next;
      } while (p !== start);
      p.prevZ.nextZ = null;
      p.prevZ = null;
      sortLinked(p);
    }
    function sortLinked(list) {
      var i, p, q, e, tail, numMerges, pSize, qSize, inSize = 1;
      do {
        p = list;
        list = null;
        tail = null;
        numMerges = 0;
        while (p) {
          numMerges++;
          q = p;
          pSize = 0;
          for (i = 0; i < inSize; i++) {
            pSize++;
            q = q.nextZ;
            if (!q)
              break;
          }
          qSize = inSize;
          while (pSize > 0 || qSize > 0 && q) {
            if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {
              e = p;
              p = p.nextZ;
              pSize--;
            } else {
              e = q;
              q = q.nextZ;
              qSize--;
            }
            if (tail)
              tail.nextZ = e;
            else
              list = e;
            e.prevZ = tail;
            tail = e;
          }
          p = q;
        }
        tail.nextZ = null;
        inSize *= 2;
      } while (numMerges > 1);
      return list;
    }
    function zOrder(x, y, minX, minY, invSize) {
      x = 32767 * (x - minX) * invSize;
      y = 32767 * (y - minY) * invSize;
      x = (x | x << 8) & 16711935;
      x = (x | x << 4) & 252645135;
      x = (x | x << 2) & 858993459;
      x = (x | x << 1) & 1431655765;
      y = (y | y << 8) & 16711935;
      y = (y | y << 4) & 252645135;
      y = (y | y << 2) & 858993459;
      y = (y | y << 1) & 1431655765;
      return x | y << 1;
    }
    function getLeftmost(start) {
      var p = start, leftmost = start;
      do {
        if (p.x < leftmost.x || p.x === leftmost.x && p.y < leftmost.y)
          leftmost = p;
        p = p.next;
      } while (p !== start);
      return leftmost;
    }
    function pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {
      return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 && (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 && (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;
    }
    function isValidDiagonal(a, b) {
      return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && (area(a.prev, a, b.prev) || area(a, b.prev, b)) || equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0);
    }
    function area(p, q, r) {
      return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);
    }
    function equals(p1, p2) {
      return p1.x === p2.x && p1.y === p2.y;
    }
    function intersects(p1, q1, p2, q2) {
      var o1 = sign2(area(p1, q1, p2));
      var o2 = sign2(area(p1, q1, q2));
      var o3 = sign2(area(p2, q2, p1));
      var o4 = sign2(area(p2, q2, q1));
      if (o1 !== o2 && o3 !== o4)
        return true;
      if (o1 === 0 && onSegment(p1, p2, q1))
        return true;
      if (o2 === 0 && onSegment(p1, q2, q1))
        return true;
      if (o3 === 0 && onSegment(p2, p1, q2))
        return true;
      if (o4 === 0 && onSegment(p2, q1, q2))
        return true;
      return false;
    }
    function onSegment(p, q, r) {
      return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);
    }
    function sign2(num) {
      return num > 0 ? 1 : num < 0 ? -1 : 0;
    }
    function intersectsPolygon(a, b) {
      var p = a;
      do {
        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i && intersects(p, p.next, a, b))
          return true;
        p = p.next;
      } while (p !== a);
      return false;
    }
    function locallyInside(a, b) {
      return area(a.prev, a, a.next) < 0 ? area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 : area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;
    }
    function middleInside(a, b) {
      var p = a, inside = false, px = (a.x + b.x) / 2, py = (a.y + b.y) / 2;
      do {
        if (p.y > py !== p.next.y > py && p.next.y !== p.y && px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x)
          inside = !inside;
        p = p.next;
      } while (p !== a);
      return inside;
    }
    function splitPolygon(a, b) {
      var a2 = new Node(a.i, a.x, a.y), b2 = new Node(b.i, b.x, b.y), an = a.next, bp = b.prev;
      a.next = b;
      b.prev = a;
      a2.next = an;
      an.prev = a2;
      b2.next = a2;
      a2.prev = b2;
      bp.next = b2;
      b2.prev = bp;
      return b2;
    }
    function insertNode(i, x, y, last) {
      var p = new Node(i, x, y);
      if (!last) {
        p.prev = p;
        p.next = p;
      } else {
        p.next = last.next;
        p.prev = last;
        last.next.prev = p;
        last.next = p;
      }
      return p;
    }
    function removeNode(p) {
      p.next.prev = p.prev;
      p.prev.next = p.next;
      if (p.prevZ)
        p.prevZ.nextZ = p.nextZ;
      if (p.nextZ)
        p.nextZ.prevZ = p.prevZ;
    }
    function Node(i, x, y) {
      this.i = i;
      this.x = x;
      this.y = y;
      this.prev = null;
      this.next = null;
      this.z = null;
      this.prevZ = null;
      this.nextZ = null;
      this.steiner = false;
    }
    earcut.deviation = function(data, holeIndices, dim, triangles) {
      var hasHoles = holeIndices && holeIndices.length;
      var outerLen = hasHoles ? holeIndices[0] * dim : data.length;
      var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));
      if (hasHoles) {
        for (var i = 0, len = holeIndices.length; i < len; i++) {
          var start = holeIndices[i] * dim;
          var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;
          polygonArea -= Math.abs(signedArea(data, start, end, dim));
        }
      }
      var trianglesArea = 0;
      for (i = 0; i < triangles.length; i += 3) {
        var a = triangles[i] * dim;
        var b = triangles[i + 1] * dim;
        var c = triangles[i + 2] * dim;
        trianglesArea += Math.abs((data[a] - data[c]) * (data[b + 1] - data[a + 1]) - (data[a] - data[b]) * (data[c + 1] - data[a + 1]));
      }
      return polygonArea === 0 && trianglesArea === 0 ? 0 : Math.abs((trianglesArea - polygonArea) / polygonArea);
    };
    function signedArea(data, start, end, dim) {
      var sum = 0;
      for (var i = start, j = end - dim; i < end; i += dim) {
        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);
        j = i;
      }
      return sum;
    }
    earcut.flatten = function(data) {
      var dim = data[0][0].length, result = {vertices: [], holes: [], dimensions: dim}, holeIndex = 0;
      for (var i = 0; i < data.length; i++) {
        for (var j = 0; j < data[i].length; j++) {
          for (var d = 0; d < dim; d++)
            result.vertices.push(data[i][j][d]);
        }
        if (i > 0) {
          holeIndex += data[i - 1].length;
          result.holes.push(holeIndex);
        }
      }
      return result;
    };
  });

  // node_modules/punycode/punycode.js
  var require_punycode = __commonJS((exports, module) => {
    /*! https://mths.be/punycode v1.3.2 by @mathias */
    (function(root) {
      var freeExports = typeof exports == "object" && exports && !exports.nodeType && exports;
      var freeModule = typeof module == "object" && module && !module.nodeType && module;
      var freeGlobal = typeof global == "object" && global;
      if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal) {
        root = freeGlobal;
      }
      var punycode, maxInt = 2147483647, base = 36, tMin = 1, tMax = 26, skew = 38, damp = 700, initialBias = 72, initialN = 128, delimiter = "-", regexPunycode = /^xn--/, regexNonASCII = /[^\x20-\x7E]/, regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g, errors = {
        overflow: "Overflow: input needs wider integers to process",
        "not-basic": "Illegal input >= 0x80 (not a basic code point)",
        "invalid-input": "Invalid input"
      }, baseMinusTMin = base - tMin, floor = Math.floor, stringFromCharCode = String.fromCharCode, key;
      function error(type) {
        throw RangeError(errors[type]);
      }
      function map3(array, fn) {
        var length = array.length;
        var result = [];
        while (length--) {
          result[length] = fn(array[length]);
        }
        return result;
      }
      function mapDomain(string, fn) {
        var parts = string.split("@");
        var result = "";
        if (parts.length > 1) {
          result = parts[0] + "@";
          string = parts[1];
        }
        string = string.replace(regexSeparators, ".");
        var labels = string.split(".");
        var encoded = map3(labels, fn).join(".");
        return result + encoded;
      }
      function ucs2decode(string) {
        var output = [], counter = 0, length = string.length, value, extra;
        while (counter < length) {
          value = string.charCodeAt(counter++);
          if (value >= 55296 && value <= 56319 && counter < length) {
            extra = string.charCodeAt(counter++);
            if ((extra & 64512) == 56320) {
              output.push(((value & 1023) << 10) + (extra & 1023) + 65536);
            } else {
              output.push(value);
              counter--;
            }
          } else {
            output.push(value);
          }
        }
        return output;
      }
      function ucs2encode(array) {
        return map3(array, function(value) {
          var output = "";
          if (value > 65535) {
            value -= 65536;
            output += stringFromCharCode(value >>> 10 & 1023 | 55296);
            value = 56320 | value & 1023;
          }
          output += stringFromCharCode(value);
          return output;
        }).join("");
      }
      function basicToDigit(codePoint) {
        if (codePoint - 48 < 10) {
          return codePoint - 22;
        }
        if (codePoint - 65 < 26) {
          return codePoint - 65;
        }
        if (codePoint - 97 < 26) {
          return codePoint - 97;
        }
        return base;
      }
      function digitToBasic(digit, flag) {
        return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
      }
      function adapt(delta, numPoints, firstTime) {
        var k = 0;
        delta = firstTime ? floor(delta / damp) : delta >> 1;
        delta += floor(delta / numPoints);
        for (; delta > baseMinusTMin * tMax >> 1; k += base) {
          delta = floor(delta / baseMinusTMin);
        }
        return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
      }
      function decode(input) {
        var output = [], inputLength = input.length, out, i = 0, n = initialN, bias = initialBias, basic, j, index2, oldi, w, k, digit, t, baseMinusT;
        basic = input.lastIndexOf(delimiter);
        if (basic < 0) {
          basic = 0;
        }
        for (j = 0; j < basic; ++j) {
          if (input.charCodeAt(j) >= 128) {
            error("not-basic");
          }
          output.push(input.charCodeAt(j));
        }
        for (index2 = basic > 0 ? basic + 1 : 0; index2 < inputLength; ) {
          for (oldi = i, w = 1, k = base; ; k += base) {
            if (index2 >= inputLength) {
              error("invalid-input");
            }
            digit = basicToDigit(input.charCodeAt(index2++));
            if (digit >= base || digit > floor((maxInt - i) / w)) {
              error("overflow");
            }
            i += digit * w;
            t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;
            if (digit < t) {
              break;
            }
            baseMinusT = base - t;
            if (w > floor(maxInt / baseMinusT)) {
              error("overflow");
            }
            w *= baseMinusT;
          }
          out = output.length + 1;
          bias = adapt(i - oldi, out, oldi == 0);
          if (floor(i / out) > maxInt - n) {
            error("overflow");
          }
          n += floor(i / out);
          i %= out;
          output.splice(i++, 0, n);
        }
        return ucs2encode(output);
      }
      function encode(input) {
        var n, delta, handledCPCount, basicLength, bias, j, m, q, k, t, currentValue, output = [], inputLength, handledCPCountPlusOne, baseMinusT, qMinusT;
        input = ucs2decode(input);
        inputLength = input.length;
        n = initialN;
        delta = 0;
        bias = initialBias;
        for (j = 0; j < inputLength; ++j) {
          currentValue = input[j];
          if (currentValue < 128) {
            output.push(stringFromCharCode(currentValue));
          }
        }
        handledCPCount = basicLength = output.length;
        if (basicLength) {
          output.push(delimiter);
        }
        while (handledCPCount < inputLength) {
          for (m = maxInt, j = 0; j < inputLength; ++j) {
            currentValue = input[j];
            if (currentValue >= n && currentValue < m) {
              m = currentValue;
            }
          }
          handledCPCountPlusOne = handledCPCount + 1;
          if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
            error("overflow");
          }
          delta += (m - n) * handledCPCountPlusOne;
          n = m;
          for (j = 0; j < inputLength; ++j) {
            currentValue = input[j];
            if (currentValue < n && ++delta > maxInt) {
              error("overflow");
            }
            if (currentValue == n) {
              for (q = delta, k = base; ; k += base) {
                t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;
                if (q < t) {
                  break;
                }
                qMinusT = q - t;
                baseMinusT = base - t;
                output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0)));
                q = floor(qMinusT / baseMinusT);
              }
              output.push(stringFromCharCode(digitToBasic(q, 0)));
              bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
              delta = 0;
              ++handledCPCount;
            }
          }
          ++delta;
          ++n;
        }
        return output.join("");
      }
      function toUnicode(input) {
        return mapDomain(input, function(string) {
          return regexPunycode.test(string) ? decode(string.slice(4).toLowerCase()) : string;
        });
      }
      function toASCII(input) {
        return mapDomain(input, function(string) {
          return regexNonASCII.test(string) ? "xn--" + encode(string) : string;
        });
      }
      punycode = {
        version: "1.3.2",
        ucs2: {
          decode: ucs2decode,
          encode: ucs2encode
        },
        decode,
        encode,
        toASCII,
        toUnicode
      };
      if (typeof define == "function" && typeof define.amd == "object" && define.amd) {
        define("punycode", function() {
          return punycode;
        });
      } else if (freeExports && freeModule) {
        if (module.exports == freeExports) {
          freeModule.exports = punycode;
        } else {
          for (key in punycode) {
            punycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);
          }
        }
      } else {
        root.punycode = punycode;
      }
    })(exports);
  });

  // node_modules/url/util.js
  var require_util = __commonJS((exports, module) => {
    "use strict";
    module.exports = {
      isString: function(arg) {
        return typeof arg === "string";
      },
      isObject: function(arg) {
        return typeof arg === "object" && arg !== null;
      },
      isNull: function(arg) {
        return arg === null;
      },
      isNullOrUndefined: function(arg) {
        return arg == null;
      }
    };
  });

  // node_modules/querystring/decode.js
  var require_decode = __commonJS((exports, module) => {
    "use strict";
    function hasOwnProperty(obj, prop) {
      return Object.prototype.hasOwnProperty.call(obj, prop);
    }
    module.exports = function(qs, sep, eq, options) {
      sep = sep || "&";
      eq = eq || "=";
      var obj = {};
      if (typeof qs !== "string" || qs.length === 0) {
        return obj;
      }
      var regexp = /\+/g;
      qs = qs.split(sep);
      var maxKeys = 1e3;
      if (options && typeof options.maxKeys === "number") {
        maxKeys = options.maxKeys;
      }
      var len = qs.length;
      if (maxKeys > 0 && len > maxKeys) {
        len = maxKeys;
      }
      for (var i = 0; i < len; ++i) {
        var x = qs[i].replace(regexp, "%20"), idx = x.indexOf(eq), kstr, vstr, k, v;
        if (idx >= 0) {
          kstr = x.substr(0, idx);
          vstr = x.substr(idx + 1);
        } else {
          kstr = x;
          vstr = "";
        }
        k = decodeURIComponent(kstr);
        v = decodeURIComponent(vstr);
        if (!hasOwnProperty(obj, k)) {
          obj[k] = v;
        } else if (Array.isArray(obj[k])) {
          obj[k].push(v);
        } else {
          obj[k] = [obj[k], v];
        }
      }
      return obj;
    };
  });

  // node_modules/querystring/encode.js
  var require_encode = __commonJS((exports, module) => {
    "use strict";
    var stringifyPrimitive = function(v) {
      switch (typeof v) {
        case "string":
          return v;
        case "boolean":
          return v ? "true" : "false";
        case "number":
          return isFinite(v) ? v : "";
        default:
          return "";
      }
    };
    module.exports = function(obj, sep, eq, name) {
      sep = sep || "&";
      eq = eq || "=";
      if (obj === null) {
        obj = void 0;
      }
      if (typeof obj === "object") {
        return Object.keys(obj).map(function(k) {
          var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
          if (Array.isArray(obj[k])) {
            return obj[k].map(function(v) {
              return ks + encodeURIComponent(stringifyPrimitive(v));
            }).join(sep);
          } else {
            return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
          }
        }).join(sep);
      }
      if (!name)
        return "";
      return encodeURIComponent(stringifyPrimitive(name)) + eq + encodeURIComponent(stringifyPrimitive(obj));
    };
  });

  // node_modules/querystring/index.js
  var require_querystring = __commonJS((exports) => {
    "use strict";
    exports.decode = exports.parse = require_decode();
    exports.encode = exports.stringify = require_encode();
  });

  // node_modules/url/url.js
  var require_url = __commonJS((exports) => {
    "use strict";
    var punycode = require_punycode();
    var util = require_util();
    exports.parse = urlParse;
    exports.resolve = urlResolve;
    exports.resolveObject = urlResolveObject;
    exports.format = urlFormat;
    exports.Url = Url2;
    function Url2() {
      this.protocol = null;
      this.slashes = null;
      this.auth = null;
      this.host = null;
      this.port = null;
      this.hostname = null;
      this.hash = null;
      this.search = null;
      this.query = null;
      this.pathname = null;
      this.path = null;
      this.href = null;
    }
    var protocolPattern = /^([a-z0-9.+-]+:)/i;
    var portPattern = /:[0-9]*$/;
    var simplePathPattern = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/;
    var delims = ["<", ">", '"', "`", " ", "\r", "\n", "	"];
    var unwise = ["{", "}", "|", "\\", "^", "`"].concat(delims);
    var autoEscape = ["'"].concat(unwise);
    var nonHostChars = ["%", "/", "?", ";", "#"].concat(autoEscape);
    var hostEndingChars = ["/", "?", "#"];
    var hostnameMaxLen = 255;
    var hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/;
    var hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/;
    var unsafeProtocol = {
      javascript: true,
      "javascript:": true
    };
    var hostlessProtocol = {
      javascript: true,
      "javascript:": true
    };
    var slashedProtocol = {
      http: true,
      https: true,
      ftp: true,
      gopher: true,
      file: true,
      "http:": true,
      "https:": true,
      "ftp:": true,
      "gopher:": true,
      "file:": true
    };
    var querystring = require_querystring();
    function urlParse(url, parseQueryString, slashesDenoteHost) {
      if (url && util.isObject(url) && url instanceof Url2)
        return url;
      var u = new Url2();
      u.parse(url, parseQueryString, slashesDenoteHost);
      return u;
    }
    Url2.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {
      if (!util.isString(url)) {
        throw new TypeError("Parameter 'url' must be a string, not " + typeof url);
      }
      var queryIndex = url.indexOf("?"), splitter = queryIndex !== -1 && queryIndex < url.indexOf("#") ? "?" : "#", uSplit = url.split(splitter), slashRegex = /\\/g;
      uSplit[0] = uSplit[0].replace(slashRegex, "/");
      url = uSplit.join(splitter);
      var rest = url;
      rest = rest.trim();
      if (!slashesDenoteHost && url.split("#").length === 1) {
        var simplePath = simplePathPattern.exec(rest);
        if (simplePath) {
          this.path = rest;
          this.href = rest;
          this.pathname = simplePath[1];
          if (simplePath[2]) {
            this.search = simplePath[2];
            if (parseQueryString) {
              this.query = querystring.parse(this.search.substr(1));
            } else {
              this.query = this.search.substr(1);
            }
          } else if (parseQueryString) {
            this.search = "";
            this.query = {};
          }
          return this;
        }
      }
      var proto = protocolPattern.exec(rest);
      if (proto) {
        proto = proto[0];
        var lowerProto = proto.toLowerCase();
        this.protocol = lowerProto;
        rest = rest.substr(proto.length);
      }
      if (slashesDenoteHost || proto || rest.match(/^\/\/[^@\/]+@[^@\/]+/)) {
        var slashes = rest.substr(0, 2) === "//";
        if (slashes && !(proto && hostlessProtocol[proto])) {
          rest = rest.substr(2);
          this.slashes = true;
        }
      }
      if (!hostlessProtocol[proto] && (slashes || proto && !slashedProtocol[proto])) {
        var hostEnd = -1;
        for (var i = 0; i < hostEndingChars.length; i++) {
          var hec = rest.indexOf(hostEndingChars[i]);
          if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
            hostEnd = hec;
        }
        var auth, atSign;
        if (hostEnd === -1) {
          atSign = rest.lastIndexOf("@");
        } else {
          atSign = rest.lastIndexOf("@", hostEnd);
        }
        if (atSign !== -1) {
          auth = rest.slice(0, atSign);
          rest = rest.slice(atSign + 1);
          this.auth = decodeURIComponent(auth);
        }
        hostEnd = -1;
        for (var i = 0; i < nonHostChars.length; i++) {
          var hec = rest.indexOf(nonHostChars[i]);
          if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
            hostEnd = hec;
        }
        if (hostEnd === -1)
          hostEnd = rest.length;
        this.host = rest.slice(0, hostEnd);
        rest = rest.slice(hostEnd);
        this.parseHost();
        this.hostname = this.hostname || "";
        var ipv6Hostname = this.hostname[0] === "[" && this.hostname[this.hostname.length - 1] === "]";
        if (!ipv6Hostname) {
          var hostparts = this.hostname.split(/\./);
          for (var i = 0, l = hostparts.length; i < l; i++) {
            var part = hostparts[i];
            if (!part)
              continue;
            if (!part.match(hostnamePartPattern)) {
              var newpart = "";
              for (var j = 0, k = part.length; j < k; j++) {
                if (part.charCodeAt(j) > 127) {
                  newpart += "x";
                } else {
                  newpart += part[j];
                }
              }
              if (!newpart.match(hostnamePartPattern)) {
                var validParts = hostparts.slice(0, i);
                var notHost = hostparts.slice(i + 1);
                var bit = part.match(hostnamePartStart);
                if (bit) {
                  validParts.push(bit[1]);
                  notHost.unshift(bit[2]);
                }
                if (notHost.length) {
                  rest = "/" + notHost.join(".") + rest;
                }
                this.hostname = validParts.join(".");
                break;
              }
            }
          }
        }
        if (this.hostname.length > hostnameMaxLen) {
          this.hostname = "";
        } else {
          this.hostname = this.hostname.toLowerCase();
        }
        if (!ipv6Hostname) {
          this.hostname = punycode.toASCII(this.hostname);
        }
        var p = this.port ? ":" + this.port : "";
        var h = this.hostname || "";
        this.host = h + p;
        this.href += this.host;
        if (ipv6Hostname) {
          this.hostname = this.hostname.substr(1, this.hostname.length - 2);
          if (rest[0] !== "/") {
            rest = "/" + rest;
          }
        }
      }
      if (!unsafeProtocol[lowerProto]) {
        for (var i = 0, l = autoEscape.length; i < l; i++) {
          var ae = autoEscape[i];
          if (rest.indexOf(ae) === -1)
            continue;
          var esc = encodeURIComponent(ae);
          if (esc === ae) {
            esc = escape(ae);
          }
          rest = rest.split(ae).join(esc);
        }
      }
      var hash = rest.indexOf("#");
      if (hash !== -1) {
        this.hash = rest.substr(hash);
        rest = rest.slice(0, hash);
      }
      var qm = rest.indexOf("?");
      if (qm !== -1) {
        this.search = rest.substr(qm);
        this.query = rest.substr(qm + 1);
        if (parseQueryString) {
          this.query = querystring.parse(this.query);
        }
        rest = rest.slice(0, qm);
      } else if (parseQueryString) {
        this.search = "";
        this.query = {};
      }
      if (rest)
        this.pathname = rest;
      if (slashedProtocol[lowerProto] && this.hostname && !this.pathname) {
        this.pathname = "/";
      }
      if (this.pathname || this.search) {
        var p = this.pathname || "";
        var s = this.search || "";
        this.path = p + s;
      }
      this.href = this.format();
      return this;
    };
    function urlFormat(obj) {
      if (util.isString(obj))
        obj = urlParse(obj);
      if (!(obj instanceof Url2))
        return Url2.prototype.format.call(obj);
      return obj.format();
    }
    Url2.prototype.format = function() {
      var auth = this.auth || "";
      if (auth) {
        auth = encodeURIComponent(auth);
        auth = auth.replace(/%3A/i, ":");
        auth += "@";
      }
      var protocol = this.protocol || "", pathname = this.pathname || "", hash = this.hash || "", host = false, query = "";
      if (this.host) {
        host = auth + this.host;
      } else if (this.hostname) {
        host = auth + (this.hostname.indexOf(":") === -1 ? this.hostname : "[" + this.hostname + "]");
        if (this.port) {
          host += ":" + this.port;
        }
      }
      if (this.query && util.isObject(this.query) && Object.keys(this.query).length) {
        query = querystring.stringify(this.query);
      }
      var search = this.search || query && "?" + query || "";
      if (protocol && protocol.substr(-1) !== ":")
        protocol += ":";
      if (this.slashes || (!protocol || slashedProtocol[protocol]) && host !== false) {
        host = "//" + (host || "");
        if (pathname && pathname.charAt(0) !== "/")
          pathname = "/" + pathname;
      } else if (!host) {
        host = "";
      }
      if (hash && hash.charAt(0) !== "#")
        hash = "#" + hash;
      if (search && search.charAt(0) !== "?")
        search = "?" + search;
      pathname = pathname.replace(/[?#]/g, function(match) {
        return encodeURIComponent(match);
      });
      search = search.replace("#", "%23");
      return protocol + host + pathname + search + hash;
    };
    function urlResolve(source, relative) {
      return urlParse(source, false, true).resolve(relative);
    }
    Url2.prototype.resolve = function(relative) {
      return this.resolveObject(urlParse(relative, false, true)).format();
    };
    function urlResolveObject(source, relative) {
      if (!source)
        return relative;
      return urlParse(source, false, true).resolveObject(relative);
    }
    Url2.prototype.resolveObject = function(relative) {
      if (util.isString(relative)) {
        var rel = new Url2();
        rel.parse(relative, false, true);
        relative = rel;
      }
      var result = new Url2();
      var tkeys = Object.keys(this);
      for (var tk = 0; tk < tkeys.length; tk++) {
        var tkey = tkeys[tk];
        result[tkey] = this[tkey];
      }
      result.hash = relative.hash;
      if (relative.href === "") {
        result.href = result.format();
        return result;
      }
      if (relative.slashes && !relative.protocol) {
        var rkeys = Object.keys(relative);
        for (var rk = 0; rk < rkeys.length; rk++) {
          var rkey = rkeys[rk];
          if (rkey !== "protocol")
            result[rkey] = relative[rkey];
        }
        if (slashedProtocol[result.protocol] && result.hostname && !result.pathname) {
          result.path = result.pathname = "/";
        }
        result.href = result.format();
        return result;
      }
      if (relative.protocol && relative.protocol !== result.protocol) {
        if (!slashedProtocol[relative.protocol]) {
          var keys2 = Object.keys(relative);
          for (var v = 0; v < keys2.length; v++) {
            var k = keys2[v];
            result[k] = relative[k];
          }
          result.href = result.format();
          return result;
        }
        result.protocol = relative.protocol;
        if (!relative.host && !hostlessProtocol[relative.protocol]) {
          var relPath = (relative.pathname || "").split("/");
          while (relPath.length && !(relative.host = relPath.shift()))
            ;
          if (!relative.host)
            relative.host = "";
          if (!relative.hostname)
            relative.hostname = "";
          if (relPath[0] !== "")
            relPath.unshift("");
          if (relPath.length < 2)
            relPath.unshift("");
          result.pathname = relPath.join("/");
        } else {
          result.pathname = relative.pathname;
        }
        result.search = relative.search;
        result.query = relative.query;
        result.host = relative.host || "";
        result.auth = relative.auth;
        result.hostname = relative.hostname || relative.host;
        result.port = relative.port;
        if (result.pathname || result.search) {
          var p = result.pathname || "";
          var s = result.search || "";
          result.path = p + s;
        }
        result.slashes = result.slashes || relative.slashes;
        result.href = result.format();
        return result;
      }
      var isSourceAbs = result.pathname && result.pathname.charAt(0) === "/", isRelAbs = relative.host || relative.pathname && relative.pathname.charAt(0) === "/", mustEndAbs = isRelAbs || isSourceAbs || result.host && relative.pathname, removeAllDots = mustEndAbs, srcPath = result.pathname && result.pathname.split("/") || [], relPath = relative.pathname && relative.pathname.split("/") || [], psychotic = result.protocol && !slashedProtocol[result.protocol];
      if (psychotic) {
        result.hostname = "";
        result.port = null;
        if (result.host) {
          if (srcPath[0] === "")
            srcPath[0] = result.host;
          else
            srcPath.unshift(result.host);
        }
        result.host = "";
        if (relative.protocol) {
          relative.hostname = null;
          relative.port = null;
          if (relative.host) {
            if (relPath[0] === "")
              relPath[0] = relative.host;
            else
              relPath.unshift(relative.host);
          }
          relative.host = null;
        }
        mustEndAbs = mustEndAbs && (relPath[0] === "" || srcPath[0] === "");
      }
      if (isRelAbs) {
        result.host = relative.host || relative.host === "" ? relative.host : result.host;
        result.hostname = relative.hostname || relative.hostname === "" ? relative.hostname : result.hostname;
        result.search = relative.search;
        result.query = relative.query;
        srcPath = relPath;
      } else if (relPath.length) {
        if (!srcPath)
          srcPath = [];
        srcPath.pop();
        srcPath = srcPath.concat(relPath);
        result.search = relative.search;
        result.query = relative.query;
      } else if (!util.isNullOrUndefined(relative.search)) {
        if (psychotic) {
          result.hostname = result.host = srcPath.shift();
          var authInHost = result.host && result.host.indexOf("@") > 0 ? result.host.split("@") : false;
          if (authInHost) {
            result.auth = authInHost.shift();
            result.host = result.hostname = authInHost.shift();
          }
        }
        result.search = relative.search;
        result.query = relative.query;
        if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
          result.path = (result.pathname ? result.pathname : "") + (result.search ? result.search : "");
        }
        result.href = result.format();
        return result;
      }
      if (!srcPath.length) {
        result.pathname = null;
        if (result.search) {
          result.path = "/" + result.search;
        } else {
          result.path = null;
        }
        result.href = result.format();
        return result;
      }
      var last = srcPath.slice(-1)[0];
      var hasTrailingSlash = (result.host || relative.host || srcPath.length > 1) && (last === "." || last === "..") || last === "";
      var up2 = 0;
      for (var i = srcPath.length; i >= 0; i--) {
        last = srcPath[i];
        if (last === ".") {
          srcPath.splice(i, 1);
        } else if (last === "..") {
          srcPath.splice(i, 1);
          up2++;
        } else if (up2) {
          srcPath.splice(i, 1);
          up2--;
        }
      }
      if (!mustEndAbs && !removeAllDots) {
        for (; up2--; up2) {
          srcPath.unshift("..");
        }
      }
      if (mustEndAbs && srcPath[0] !== "" && (!srcPath[0] || srcPath[0].charAt(0) !== "/")) {
        srcPath.unshift("");
      }
      if (hasTrailingSlash && srcPath.join("/").substr(-1) !== "/") {
        srcPath.push("");
      }
      var isAbsolute = srcPath[0] === "" || srcPath[0] && srcPath[0].charAt(0) === "/";
      if (psychotic) {
        result.hostname = result.host = isAbsolute ? "" : srcPath.length ? srcPath.shift() : "";
        var authInHost = result.host && result.host.indexOf("@") > 0 ? result.host.split("@") : false;
        if (authInHost) {
          result.auth = authInHost.shift();
          result.host = result.hostname = authInHost.shift();
        }
      }
      mustEndAbs = mustEndAbs || result.host && srcPath.length;
      if (mustEndAbs && !isAbsolute) {
        srcPath.unshift("");
      }
      if (!srcPath.length) {
        result.pathname = null;
        result.path = null;
      } else {
        result.pathname = srcPath.join("/");
      }
      if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
        result.path = (result.pathname ? result.pathname : "") + (result.search ? result.search : "");
      }
      result.auth = relative.auth || result.auth;
      result.slashes = result.slashes || relative.slashes;
      result.href = result.format();
      return result;
    };
    Url2.prototype.parseHost = function() {
      var host = this.host;
      var port = portPattern.exec(host);
      if (port) {
        port = port[0];
        if (port !== ":") {
          this.port = port.substr(1);
        }
        host = host.substr(0, host.length - port.length);
      }
      if (host)
        this.hostname = host;
    };
  });

  // node_modules/parse-uri/index.js
  var require_parse_uri = __commonJS((exports, module) => {
    "use strict";
    function parseURI(str, opts) {
      if (!str)
        return void 0;
      opts = opts || {};
      var o = {
        key: [
          "source",
          "protocol",
          "authority",
          "userInfo",
          "user",
          "password",
          "host",
          "port",
          "relative",
          "path",
          "directory",
          "file",
          "query",
          "anchor"
        ],
        q: {
          name: "queryKey",
          parser: /(?:^|&)([^&=]*)=?([^&]*)/g
        },
        parser: {
          strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
          loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        }
      };
      var m = o.parser[opts.strictMode ? "strict" : "loose"].exec(str);
      var uri = {};
      var i = 14;
      while (i--)
        uri[o.key[i]] = m[i] || "";
      uri[o.q.name] = {};
      uri[o.key[12]].replace(o.q.parser, function($0, $1, $2) {
        if ($1)
          uri[o.q.name][$1] = $2;
      });
      return uri;
    }
    module.exports = parseURI;
  });

  // node_modules/mini-signals/lib/mini-signals.js
  var require_mini_signals = __commonJS((exports, module) => {
    "use strict";
    Object.defineProperty(exports, "__esModule", {
      value: true
    });
    var _createClass2 = function() {
      function defineProperties(target, props) {
        for (var i = 0; i < props.length; i++) {
          var descriptor = props[i];
          descriptor.enumerable = descriptor.enumerable || false;
          descriptor.configurable = true;
          if ("value" in descriptor)
            descriptor.writable = true;
          Object.defineProperty(target, descriptor.key, descriptor);
        }
      }
      return function(Constructor, protoProps, staticProps) {
        if (protoProps)
          defineProperties(Constructor.prototype, protoProps);
        if (staticProps)
          defineProperties(Constructor, staticProps);
        return Constructor;
      };
    }();
    function _classCallCheck(instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    }
    var MiniSignalBinding = function() {
      function MiniSignalBinding2(fn, once, thisArg) {
        if (once === void 0)
          once = false;
        _classCallCheck(this, MiniSignalBinding2);
        this._fn = fn;
        this._once = once;
        this._thisArg = thisArg;
        this._next = this._prev = this._owner = null;
      }
      _createClass2(MiniSignalBinding2, [{
        key: "detach",
        value: function detach() {
          if (this._owner === null)
            return false;
          this._owner.detach(this);
          return true;
        }
      }]);
      return MiniSignalBinding2;
    }();
    function _addMiniSignalBinding(self2, node) {
      if (!self2._head) {
        self2._head = node;
        self2._tail = node;
      } else {
        self2._tail._next = node;
        node._prev = self2._tail;
        self2._tail = node;
      }
      node._owner = self2;
      return node;
    }
    var MiniSignal = function() {
      function MiniSignal2() {
        _classCallCheck(this, MiniSignal2);
        this._head = this._tail = void 0;
      }
      _createClass2(MiniSignal2, [{
        key: "handlers",
        value: function handlers() {
          var exists = arguments.length <= 0 || arguments[0] === void 0 ? false : arguments[0];
          var node = this._head;
          if (exists)
            return !!node;
          var ee = [];
          while (node) {
            ee.push(node);
            node = node._next;
          }
          return ee;
        }
      }, {
        key: "has",
        value: function has(node) {
          if (!(node instanceof MiniSignalBinding)) {
            throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");
          }
          return node._owner === this;
        }
      }, {
        key: "dispatch",
        value: function dispatch() {
          var node = this._head;
          if (!node)
            return false;
          while (node) {
            if (node._once)
              this.detach(node);
            node._fn.apply(node._thisArg, arguments);
            node = node._next;
          }
          return true;
        }
      }, {
        key: "add",
        value: function add(fn) {
          var thisArg = arguments.length <= 1 || arguments[1] === void 0 ? null : arguments[1];
          if (typeof fn !== "function") {
            throw new Error("MiniSignal#add(): First arg must be a Function.");
          }
          return _addMiniSignalBinding(this, new MiniSignalBinding(fn, false, thisArg));
        }
      }, {
        key: "once",
        value: function once(fn) {
          var thisArg = arguments.length <= 1 || arguments[1] === void 0 ? null : arguments[1];
          if (typeof fn !== "function") {
            throw new Error("MiniSignal#once(): First arg must be a Function.");
          }
          return _addMiniSignalBinding(this, new MiniSignalBinding(fn, true, thisArg));
        }
      }, {
        key: "detach",
        value: function detach(node) {
          if (!(node instanceof MiniSignalBinding)) {
            throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");
          }
          if (node._owner !== this)
            return this;
          if (node._prev)
            node._prev._next = node._next;
          if (node._next)
            node._next._prev = node._prev;
          if (node === this._head) {
            this._head = node._next;
            if (node._next === null) {
              this._tail = null;
            }
          } else if (node === this._tail) {
            this._tail = node._prev;
            this._tail._next = null;
          }
          node._owner = null;
          return this;
        }
      }, {
        key: "detachAll",
        value: function detachAll() {
          var node = this._head;
          if (!node)
            return this;
          this._head = this._tail = null;
          while (node) {
            node._owner = null;
            node = node._next;
          }
          return this;
        }
      }]);
      return MiniSignal2;
    }();
    MiniSignal.MiniSignalBinding = MiniSignalBinding;
    exports["default"] = MiniSignal;
    module.exports = exports["default"];
  });

  // node_modules/@pixi/polyfill/lib/polyfill.es.js
  var import_es6_promise_polyfill = __toModule(require_promise());
  var import_object_assign = __toModule(require_object_assign());
  /*!
   * @pixi/polyfill - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/polyfill is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  if (!window.Promise) {
    window.Promise = import_es6_promise_polyfill.Polyfill;
  }
  if (!Object.assign) {
    Object.assign = import_object_assign.default;
  }
  var ONE_FRAME_TIME = 16;
  if (!(Date.now && Date.prototype.getTime)) {
    Date.now = function now() {
      return new Date().getTime();
    };
  }
  if (!(window.performance && window.performance.now)) {
    startTime_1 = Date.now();
    if (!window.performance) {
      window.performance = {};
    }
    window.performance.now = function() {
      return Date.now() - startTime_1;
    };
  }
  var startTime_1;
  var lastTime = Date.now();
  var vendors = ["ms", "moz", "webkit", "o"];
  for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
    p = vendors[x];
    window.requestAnimationFrame = window[p + "RequestAnimationFrame"];
    window.cancelAnimationFrame = window[p + "CancelAnimationFrame"] || window[p + "CancelRequestAnimationFrame"];
  }
  var p;
  if (!window.requestAnimationFrame) {
    window.requestAnimationFrame = function(callback) {
      if (typeof callback !== "function") {
        throw new TypeError(callback + "is not a function");
      }
      var currentTime = Date.now();
      var delay = ONE_FRAME_TIME + lastTime - currentTime;
      if (delay < 0) {
        delay = 0;
      }
      lastTime = currentTime;
      return window.setTimeout(function() {
        lastTime = Date.now();
        callback(performance.now());
      }, delay);
    };
  }
  if (!window.cancelAnimationFrame) {
    window.cancelAnimationFrame = function(id) {
      return clearTimeout(id);
    };
  }
  if (!Math.sign) {
    Math.sign = function mathSign(x) {
      x = Number(x);
      if (x === 0 || isNaN(x)) {
        return x;
      }
      return x > 0 ? 1 : -1;
    };
  }
  if (!Number.isInteger) {
    Number.isInteger = function numberIsInteger(value) {
      return typeof value === "number" && isFinite(value) && Math.floor(value) === value;
    };
  }
  if (!window.ArrayBuffer) {
    window.ArrayBuffer = Array;
  }
  if (!window.Float32Array) {
    window.Float32Array = Array;
  }
  if (!window.Uint32Array) {
    window.Uint32Array = Array;
  }
  if (!window.Uint16Array) {
    window.Uint16Array = Array;
  }
  if (!window.Uint8Array) {
    window.Uint8Array = Array;
  }
  if (!window.Int32Array) {
    window.Int32Array = Array;
  }

  // node_modules/@pixi/utils/lib/utils.es.js
  var utils_es_exports = {};
  __export(utils_es_exports, {
    BaseTextureCache: () => BaseTextureCache,
    CanvasRenderTarget: () => CanvasRenderTarget,
    DATA_URI: () => DATA_URI,
    EventEmitter: () => import_eventemitter3.default,
    ProgramCache: () => ProgramCache,
    TextureCache: () => TextureCache,
    clearTextureCache: () => clearTextureCache,
    correctBlendMode: () => correctBlendMode,
    createIndicesForQuads: () => createIndicesForQuads,
    decomposeDataUri: () => decomposeDataUri,
    deprecation: () => deprecation,
    destroyTextureCache: () => destroyTextureCache,
    determineCrossOrigin: () => determineCrossOrigin,
    earcut: () => import_earcut.default,
    getBufferType: () => getBufferType,
    getResolutionOfUrl: () => getResolutionOfUrl,
    hex2rgb: () => hex2rgb,
    hex2string: () => hex2string,
    interleaveTypedArrays: () => interleaveTypedArrays,
    isMobile: () => isMobile2,
    isPow2: () => isPow2,
    isWebGLSupported: () => isWebGLSupported,
    log2: () => log2,
    nextPow2: () => nextPow2,
    premultiplyBlendMode: () => premultiplyBlendMode,
    premultiplyRgba: () => premultiplyRgba,
    premultiplyTint: () => premultiplyTint,
    premultiplyTintToRgba: () => premultiplyTintToRgba,
    removeItems: () => removeItems,
    rgb2hex: () => rgb2hex,
    sayHello: () => sayHello,
    sign: () => sign,
    skipHello: () => skipHello,
    string2hex: () => string2hex,
    trimCanvas: () => trimCanvas,
    uid: () => uid,
    url: () => import_url2.default
  });

  // node_modules/ismobilejs/esm/isMobile.js
  var appleIphone = /iPhone/i;
  var appleIpod = /iPod/i;
  var appleTablet = /iPad/i;
  var appleUniversal = /\biOS-universal(?:.+)Mac\b/i;
  var androidPhone = /\bAndroid(?:.+)Mobile\b/i;
  var androidTablet = /Android/i;
  var amazonPhone = /(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i;
  var amazonTablet = /Silk/i;
  var windowsPhone = /Windows Phone/i;
  var windowsTablet = /\bWindows(?:.+)ARM\b/i;
  var otherBlackBerry = /BlackBerry/i;
  var otherBlackBerry10 = /BB10/i;
  var otherOpera = /Opera Mini/i;
  var otherChrome = /\b(CriOS|Chrome)(?:.+)Mobile/i;
  var otherFirefox = /Mobile(?:.+)Firefox\b/i;
  var isAppleTabletOnIos13 = function(navigator2) {
    return typeof navigator2 !== "undefined" && navigator2.platform === "MacIntel" && typeof navigator2.maxTouchPoints === "number" && navigator2.maxTouchPoints > 1 && typeof MSStream === "undefined";
  };
  function createMatch(userAgent) {
    return function(regex) {
      return regex.test(userAgent);
    };
  }
  function isMobile(param) {
    var nav = {
      userAgent: "",
      platform: "",
      maxTouchPoints: 0
    };
    if (!param && typeof navigator !== "undefined") {
      nav = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        maxTouchPoints: navigator.maxTouchPoints || 0
      };
    } else if (typeof param === "string") {
      nav.userAgent = param;
    } else if (param && param.userAgent) {
      nav = {
        userAgent: param.userAgent,
        platform: param.platform,
        maxTouchPoints: param.maxTouchPoints || 0
      };
    }
    var userAgent = nav.userAgent;
    var tmp = userAgent.split("[FBAN");
    if (typeof tmp[1] !== "undefined") {
      userAgent = tmp[0];
    }
    tmp = userAgent.split("Twitter");
    if (typeof tmp[1] !== "undefined") {
      userAgent = tmp[0];
    }
    var match = createMatch(userAgent);
    var result = {
      apple: {
        phone: match(appleIphone) && !match(windowsPhone),
        ipod: match(appleIpod),
        tablet: !match(appleIphone) && (match(appleTablet) || isAppleTabletOnIos13(nav)) && !match(windowsPhone),
        universal: match(appleUniversal),
        device: (match(appleIphone) || match(appleIpod) || match(appleTablet) || match(appleUniversal) || isAppleTabletOnIos13(nav)) && !match(windowsPhone)
      },
      amazon: {
        phone: match(amazonPhone),
        tablet: !match(amazonPhone) && match(amazonTablet),
        device: match(amazonPhone) || match(amazonTablet)
      },
      android: {
        phone: !match(windowsPhone) && match(amazonPhone) || !match(windowsPhone) && match(androidPhone),
        tablet: !match(windowsPhone) && !match(amazonPhone) && !match(androidPhone) && (match(amazonTablet) || match(androidTablet)),
        device: !match(windowsPhone) && (match(amazonPhone) || match(amazonTablet) || match(androidPhone) || match(androidTablet)) || match(/\bokhttp\b/i)
      },
      windows: {
        phone: match(windowsPhone),
        tablet: match(windowsTablet),
        device: match(windowsPhone) || match(windowsTablet)
      },
      other: {
        blackberry: match(otherBlackBerry),
        blackberry10: match(otherBlackBerry10),
        opera: match(otherOpera),
        firefox: match(otherFirefox),
        chrome: match(otherChrome),
        device: match(otherBlackBerry) || match(otherBlackBerry10) || match(otherOpera) || match(otherFirefox) || match(otherChrome)
      },
      any: false,
      phone: false,
      tablet: false
    };
    result.any = result.apple.device || result.android.device || result.windows.device || result.other.device;
    result.phone = result.apple.phone || result.android.phone || result.windows.phone;
    result.tablet = result.apple.tablet || result.android.tablet || result.windows.tablet;
    return result;
  }

  // node_modules/@pixi/settings/lib/settings.es.js
  /*!
   * @pixi/settings - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/settings is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var isMobile2 = isMobile(window.navigator);
  function maxRecommendedTextures(max) {
    var allowMax = true;
    if (isMobile2.tablet || isMobile2.phone) {
      if (isMobile2.apple.device) {
        var match = navigator.userAgent.match(/OS (\d+)_(\d+)?/);
        if (match) {
          var majorVersion = parseInt(match[1], 10);
          if (majorVersion < 11) {
            allowMax = false;
          }
        }
      }
      if (isMobile2.android.device) {
        var match = navigator.userAgent.match(/Android\s([0-9.]*)/);
        if (match) {
          var majorVersion = parseInt(match[1], 10);
          if (majorVersion < 7) {
            allowMax = false;
          }
        }
      }
    }
    return allowMax ? max : 4;
  }
  function canUploadSameBuffer() {
    return !isMobile2.apple.device;
  }
  var settings = {
    MIPMAP_TEXTURES: 1,
    ANISOTROPIC_LEVEL: 0,
    RESOLUTION: 1,
    FILTER_RESOLUTION: 1,
    SPRITE_MAX_TEXTURES: maxRecommendedTextures(32),
    SPRITE_BATCH_SIZE: 4096,
    RENDER_OPTIONS: {
      view: null,
      antialias: false,
      autoDensity: false,
      transparent: false,
      backgroundColor: 0,
      clearBeforeRender: true,
      preserveDrawingBuffer: false,
      width: 800,
      height: 600,
      legacy: false
    },
    GC_MODE: 0,
    GC_MAX_IDLE: 60 * 60,
    GC_MAX_CHECK_COUNT: 60 * 10,
    WRAP_MODE: 33071,
    SCALE_MODE: 1,
    PRECISION_VERTEX: "highp",
    PRECISION_FRAGMENT: isMobile2.apple.device ? "highp" : "mediump",
    CAN_UPLOAD_SAME_BUFFER: canUploadSameBuffer(),
    CREATE_IMAGE_BITMAP: false,
    ROUND_PIXELS: false
  };

  // node_modules/@pixi/utils/lib/utils.es.js
  var import_eventemitter3 = __toModule(require_eventemitter3());
  var import_earcut = __toModule(require_earcut());
  var import_url = __toModule(require_url());
  var import_url2 = __toModule(require_url());

  // node_modules/@pixi/constants/lib/constants.es.js
  /*!
   * @pixi/constants - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/constants is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var ENV;
  (function(ENV3) {
    ENV3[ENV3["WEBGL_LEGACY"] = 0] = "WEBGL_LEGACY";
    ENV3[ENV3["WEBGL"] = 1] = "WEBGL";
    ENV3[ENV3["WEBGL2"] = 2] = "WEBGL2";
  })(ENV || (ENV = {}));
  var RENDERER_TYPE;
  (function(RENDERER_TYPE3) {
    RENDERER_TYPE3[RENDERER_TYPE3["UNKNOWN"] = 0] = "UNKNOWN";
    RENDERER_TYPE3[RENDERER_TYPE3["WEBGL"] = 1] = "WEBGL";
    RENDERER_TYPE3[RENDERER_TYPE3["CANVAS"] = 2] = "CANVAS";
  })(RENDERER_TYPE || (RENDERER_TYPE = {}));
  var BUFFER_BITS;
  (function(BUFFER_BITS3) {
    BUFFER_BITS3[BUFFER_BITS3["COLOR"] = 16384] = "COLOR";
    BUFFER_BITS3[BUFFER_BITS3["DEPTH"] = 256] = "DEPTH";
    BUFFER_BITS3[BUFFER_BITS3["STENCIL"] = 1024] = "STENCIL";
  })(BUFFER_BITS || (BUFFER_BITS = {}));
  var BLEND_MODES;
  (function(BLEND_MODES3) {
    BLEND_MODES3[BLEND_MODES3["NORMAL"] = 0] = "NORMAL";
    BLEND_MODES3[BLEND_MODES3["ADD"] = 1] = "ADD";
    BLEND_MODES3[BLEND_MODES3["MULTIPLY"] = 2] = "MULTIPLY";
    BLEND_MODES3[BLEND_MODES3["SCREEN"] = 3] = "SCREEN";
    BLEND_MODES3[BLEND_MODES3["OVERLAY"] = 4] = "OVERLAY";
    BLEND_MODES3[BLEND_MODES3["DARKEN"] = 5] = "DARKEN";
    BLEND_MODES3[BLEND_MODES3["LIGHTEN"] = 6] = "LIGHTEN";
    BLEND_MODES3[BLEND_MODES3["COLOR_DODGE"] = 7] = "COLOR_DODGE";
    BLEND_MODES3[BLEND_MODES3["COLOR_BURN"] = 8] = "COLOR_BURN";
    BLEND_MODES3[BLEND_MODES3["HARD_LIGHT"] = 9] = "HARD_LIGHT";
    BLEND_MODES3[BLEND_MODES3["SOFT_LIGHT"] = 10] = "SOFT_LIGHT";
    BLEND_MODES3[BLEND_MODES3["DIFFERENCE"] = 11] = "DIFFERENCE";
    BLEND_MODES3[BLEND_MODES3["EXCLUSION"] = 12] = "EXCLUSION";
    BLEND_MODES3[BLEND_MODES3["HUE"] = 13] = "HUE";
    BLEND_MODES3[BLEND_MODES3["SATURATION"] = 14] = "SATURATION";
    BLEND_MODES3[BLEND_MODES3["COLOR"] = 15] = "COLOR";
    BLEND_MODES3[BLEND_MODES3["LUMINOSITY"] = 16] = "LUMINOSITY";
    BLEND_MODES3[BLEND_MODES3["NORMAL_NPM"] = 17] = "NORMAL_NPM";
    BLEND_MODES3[BLEND_MODES3["ADD_NPM"] = 18] = "ADD_NPM";
    BLEND_MODES3[BLEND_MODES3["SCREEN_NPM"] = 19] = "SCREEN_NPM";
    BLEND_MODES3[BLEND_MODES3["NONE"] = 20] = "NONE";
    BLEND_MODES3[BLEND_MODES3["SRC_OVER"] = 0] = "SRC_OVER";
    BLEND_MODES3[BLEND_MODES3["SRC_IN"] = 21] = "SRC_IN";
    BLEND_MODES3[BLEND_MODES3["SRC_OUT"] = 22] = "SRC_OUT";
    BLEND_MODES3[BLEND_MODES3["SRC_ATOP"] = 23] = "SRC_ATOP";
    BLEND_MODES3[BLEND_MODES3["DST_OVER"] = 24] = "DST_OVER";
    BLEND_MODES3[BLEND_MODES3["DST_IN"] = 25] = "DST_IN";
    BLEND_MODES3[BLEND_MODES3["DST_OUT"] = 26] = "DST_OUT";
    BLEND_MODES3[BLEND_MODES3["DST_ATOP"] = 27] = "DST_ATOP";
    BLEND_MODES3[BLEND_MODES3["ERASE"] = 26] = "ERASE";
    BLEND_MODES3[BLEND_MODES3["SUBTRACT"] = 28] = "SUBTRACT";
    BLEND_MODES3[BLEND_MODES3["XOR"] = 29] = "XOR";
  })(BLEND_MODES || (BLEND_MODES = {}));
  var DRAW_MODES;
  (function(DRAW_MODES3) {
    DRAW_MODES3[DRAW_MODES3["POINTS"] = 0] = "POINTS";
    DRAW_MODES3[DRAW_MODES3["LINES"] = 1] = "LINES";
    DRAW_MODES3[DRAW_MODES3["LINE_LOOP"] = 2] = "LINE_LOOP";
    DRAW_MODES3[DRAW_MODES3["LINE_STRIP"] = 3] = "LINE_STRIP";
    DRAW_MODES3[DRAW_MODES3["TRIANGLES"] = 4] = "TRIANGLES";
    DRAW_MODES3[DRAW_MODES3["TRIANGLE_STRIP"] = 5] = "TRIANGLE_STRIP";
    DRAW_MODES3[DRAW_MODES3["TRIANGLE_FAN"] = 6] = "TRIANGLE_FAN";
  })(DRAW_MODES || (DRAW_MODES = {}));
  var FORMATS;
  (function(FORMATS3) {
    FORMATS3[FORMATS3["RGBA"] = 6408] = "RGBA";
    FORMATS3[FORMATS3["RGB"] = 6407] = "RGB";
    FORMATS3[FORMATS3["ALPHA"] = 6406] = "ALPHA";
    FORMATS3[FORMATS3["LUMINANCE"] = 6409] = "LUMINANCE";
    FORMATS3[FORMATS3["LUMINANCE_ALPHA"] = 6410] = "LUMINANCE_ALPHA";
    FORMATS3[FORMATS3["DEPTH_COMPONENT"] = 6402] = "DEPTH_COMPONENT";
    FORMATS3[FORMATS3["DEPTH_STENCIL"] = 34041] = "DEPTH_STENCIL";
  })(FORMATS || (FORMATS = {}));
  var TARGETS;
  (function(TARGETS3) {
    TARGETS3[TARGETS3["TEXTURE_2D"] = 3553] = "TEXTURE_2D";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP"] = 34067] = "TEXTURE_CUBE_MAP";
    TARGETS3[TARGETS3["TEXTURE_2D_ARRAY"] = 35866] = "TEXTURE_2D_ARRAY";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_X"] = 34069] = "TEXTURE_CUBE_MAP_POSITIVE_X";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_X"] = 34070] = "TEXTURE_CUBE_MAP_NEGATIVE_X";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_Y"] = 34071] = "TEXTURE_CUBE_MAP_POSITIVE_Y";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_Y"] = 34072] = "TEXTURE_CUBE_MAP_NEGATIVE_Y";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_Z"] = 34073] = "TEXTURE_CUBE_MAP_POSITIVE_Z";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_Z"] = 34074] = "TEXTURE_CUBE_MAP_NEGATIVE_Z";
  })(TARGETS || (TARGETS = {}));
  var TYPES;
  (function(TYPES3) {
    TYPES3[TYPES3["UNSIGNED_BYTE"] = 5121] = "UNSIGNED_BYTE";
    TYPES3[TYPES3["UNSIGNED_SHORT"] = 5123] = "UNSIGNED_SHORT";
    TYPES3[TYPES3["UNSIGNED_SHORT_5_6_5"] = 33635] = "UNSIGNED_SHORT_5_6_5";
    TYPES3[TYPES3["UNSIGNED_SHORT_4_4_4_4"] = 32819] = "UNSIGNED_SHORT_4_4_4_4";
    TYPES3[TYPES3["UNSIGNED_SHORT_5_5_5_1"] = 32820] = "UNSIGNED_SHORT_5_5_5_1";
    TYPES3[TYPES3["FLOAT"] = 5126] = "FLOAT";
    TYPES3[TYPES3["HALF_FLOAT"] = 36193] = "HALF_FLOAT";
  })(TYPES || (TYPES = {}));
  var SCALE_MODES;
  (function(SCALE_MODES3) {
    SCALE_MODES3[SCALE_MODES3["NEAREST"] = 0] = "NEAREST";
    SCALE_MODES3[SCALE_MODES3["LINEAR"] = 1] = "LINEAR";
  })(SCALE_MODES || (SCALE_MODES = {}));
  var WRAP_MODES;
  (function(WRAP_MODES3) {
    WRAP_MODES3[WRAP_MODES3["CLAMP"] = 33071] = "CLAMP";
    WRAP_MODES3[WRAP_MODES3["REPEAT"] = 10497] = "REPEAT";
    WRAP_MODES3[WRAP_MODES3["MIRRORED_REPEAT"] = 33648] = "MIRRORED_REPEAT";
  })(WRAP_MODES || (WRAP_MODES = {}));
  var MIPMAP_MODES;
  (function(MIPMAP_MODES3) {
    MIPMAP_MODES3[MIPMAP_MODES3["OFF"] = 0] = "OFF";
    MIPMAP_MODES3[MIPMAP_MODES3["POW2"] = 1] = "POW2";
    MIPMAP_MODES3[MIPMAP_MODES3["ON"] = 2] = "ON";
  })(MIPMAP_MODES || (MIPMAP_MODES = {}));
  var ALPHA_MODES;
  (function(ALPHA_MODES3) {
    ALPHA_MODES3[ALPHA_MODES3["NPM"] = 0] = "NPM";
    ALPHA_MODES3[ALPHA_MODES3["UNPACK"] = 1] = "UNPACK";
    ALPHA_MODES3[ALPHA_MODES3["PMA"] = 2] = "PMA";
    ALPHA_MODES3[ALPHA_MODES3["NO_PREMULTIPLIED_ALPHA"] = 0] = "NO_PREMULTIPLIED_ALPHA";
    ALPHA_MODES3[ALPHA_MODES3["PREMULTIPLY_ON_UPLOAD"] = 1] = "PREMULTIPLY_ON_UPLOAD";
    ALPHA_MODES3[ALPHA_MODES3["PREMULTIPLY_ALPHA"] = 2] = "PREMULTIPLY_ALPHA";
  })(ALPHA_MODES || (ALPHA_MODES = {}));
  var CLEAR_MODES;
  (function(CLEAR_MODES3) {
    CLEAR_MODES3[CLEAR_MODES3["NO"] = 0] = "NO";
    CLEAR_MODES3[CLEAR_MODES3["YES"] = 1] = "YES";
    CLEAR_MODES3[CLEAR_MODES3["AUTO"] = 2] = "AUTO";
    CLEAR_MODES3[CLEAR_MODES3["BLEND"] = 0] = "BLEND";
    CLEAR_MODES3[CLEAR_MODES3["CLEAR"] = 1] = "CLEAR";
    CLEAR_MODES3[CLEAR_MODES3["BLIT"] = 2] = "BLIT";
  })(CLEAR_MODES || (CLEAR_MODES = {}));
  var GC_MODES;
  (function(GC_MODES3) {
    GC_MODES3[GC_MODES3["AUTO"] = 0] = "AUTO";
    GC_MODES3[GC_MODES3["MANUAL"] = 1] = "MANUAL";
  })(GC_MODES || (GC_MODES = {}));
  var PRECISION;
  (function(PRECISION3) {
    PRECISION3["LOW"] = "lowp";
    PRECISION3["MEDIUM"] = "mediump";
    PRECISION3["HIGH"] = "highp";
  })(PRECISION || (PRECISION = {}));
  var MASK_TYPES;
  (function(MASK_TYPES3) {
    MASK_TYPES3[MASK_TYPES3["NONE"] = 0] = "NONE";
    MASK_TYPES3[MASK_TYPES3["SCISSOR"] = 1] = "SCISSOR";
    MASK_TYPES3[MASK_TYPES3["STENCIL"] = 2] = "STENCIL";
    MASK_TYPES3[MASK_TYPES3["SPRITE"] = 3] = "SPRITE";
  })(MASK_TYPES || (MASK_TYPES = {}));
  var MSAA_QUALITY;
  (function(MSAA_QUALITY3) {
    MSAA_QUALITY3[MSAA_QUALITY3["NONE"] = 0] = "NONE";
    MSAA_QUALITY3[MSAA_QUALITY3["LOW"] = 2] = "LOW";
    MSAA_QUALITY3[MSAA_QUALITY3["MEDIUM"] = 4] = "MEDIUM";
    MSAA_QUALITY3[MSAA_QUALITY3["HIGH"] = 8] = "HIGH";
  })(MSAA_QUALITY || (MSAA_QUALITY = {}));

  // node_modules/@pixi/utils/lib/utils.es.js
  /*!
   * @pixi/utils - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/utils is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  settings.RETINA_PREFIX = /@([0-9\.]+)x/;
  settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT = true;
  var saidHello = false;
  var VERSION = "5.3.7";
  function skipHello() {
    saidHello = true;
  }
  function sayHello(type) {
    var _a2;
    if (saidHello) {
      return;
    }
    if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
      var args = [
        "\n %c %c %c PixiJS " + VERSION + " - \u2730 " + type + " \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n",
        "background: #ff66a5; padding:5px 0;",
        "background: #ff66a5; padding:5px 0;",
        "color: #ff66a5; background: #030307; padding:5px 0;",
        "background: #ff66a5; padding:5px 0;",
        "background: #ffc3dc; padding:5px 0;",
        "background: #ff66a5; padding:5px 0;",
        "color: #ff2424; background: #fff; padding:5px 0;",
        "color: #ff2424; background: #fff; padding:5px 0;",
        "color: #ff2424; background: #fff; padding:5px 0;"
      ];
      (_a2 = window.console).log.apply(_a2, args);
    } else if (window.console) {
      window.console.log("PixiJS " + VERSION + " - " + type + " - http://www.pixijs.com/");
    }
    saidHello = true;
  }
  var supported;
  function isWebGLSupported() {
    if (typeof supported === "undefined") {
      supported = function supported2() {
        var contextOptions = {
          stencil: true,
          failIfMajorPerformanceCaveat: settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT
        };
        try {
          if (!window.WebGLRenderingContext) {
            return false;
          }
          var canvas2 = document.createElement("canvas");
          var gl = canvas2.getContext("webgl", contextOptions) || canvas2.getContext("experimental-webgl", contextOptions);
          var success = !!(gl && gl.getContextAttributes().stencil);
          if (gl) {
            var loseContext = gl.getExtension("WEBGL_lose_context");
            if (loseContext) {
              loseContext.loseContext();
            }
          }
          gl = null;
          return success;
        } catch (e) {
          return false;
        }
      }();
    }
    return supported;
  }
  function hex2rgb(hex, out) {
    if (out === void 0) {
      out = [];
    }
    out[0] = (hex >> 16 & 255) / 255;
    out[1] = (hex >> 8 & 255) / 255;
    out[2] = (hex & 255) / 255;
    return out;
  }
  function hex2string(hex) {
    var hexString = hex.toString(16);
    hexString = "000000".substr(0, 6 - hexString.length) + hexString;
    return "#" + hexString;
  }
  function string2hex(string) {
    if (typeof string === "string" && string[0] === "#") {
      string = string.substr(1);
    }
    return parseInt(string, 16);
  }
  function rgb2hex(rgb) {
    return (rgb[0] * 255 << 16) + (rgb[1] * 255 << 8) + (rgb[2] * 255 | 0);
  }
  function mapPremultipliedBlendModes() {
    var pm = [];
    var npm = [];
    for (var i = 0; i < 32; i++) {
      pm[i] = i;
      npm[i] = i;
    }
    pm[BLEND_MODES.NORMAL_NPM] = BLEND_MODES.NORMAL;
    pm[BLEND_MODES.ADD_NPM] = BLEND_MODES.ADD;
    pm[BLEND_MODES.SCREEN_NPM] = BLEND_MODES.SCREEN;
    npm[BLEND_MODES.NORMAL] = BLEND_MODES.NORMAL_NPM;
    npm[BLEND_MODES.ADD] = BLEND_MODES.ADD_NPM;
    npm[BLEND_MODES.SCREEN] = BLEND_MODES.SCREEN_NPM;
    var array = [];
    array.push(npm);
    array.push(pm);
    return array;
  }
  var premultiplyBlendMode = mapPremultipliedBlendModes();
  function correctBlendMode(blendMode, premultiplied) {
    return premultiplyBlendMode[premultiplied ? 1 : 0][blendMode];
  }
  function premultiplyRgba(rgb, alpha, out, premultiply) {
    out = out || new Float32Array(4);
    if (premultiply || premultiply === void 0) {
      out[0] = rgb[0] * alpha;
      out[1] = rgb[1] * alpha;
      out[2] = rgb[2] * alpha;
    } else {
      out[0] = rgb[0];
      out[1] = rgb[1];
      out[2] = rgb[2];
    }
    out[3] = alpha;
    return out;
  }
  function premultiplyTint(tint, alpha) {
    if (alpha === 1) {
      return (alpha * 255 << 24) + tint;
    }
    if (alpha === 0) {
      return 0;
    }
    var R = tint >> 16 & 255;
    var G = tint >> 8 & 255;
    var B = tint & 255;
    R = R * alpha + 0.5 | 0;
    G = G * alpha + 0.5 | 0;
    B = B * alpha + 0.5 | 0;
    return (alpha * 255 << 24) + (R << 16) + (G << 8) + B;
  }
  function premultiplyTintToRgba(tint, alpha, out, premultiply) {
    out = out || new Float32Array(4);
    out[0] = (tint >> 16 & 255) / 255;
    out[1] = (tint >> 8 & 255) / 255;
    out[2] = (tint & 255) / 255;
    if (premultiply || premultiply === void 0) {
      out[0] *= alpha;
      out[1] *= alpha;
      out[2] *= alpha;
    }
    out[3] = alpha;
    return out;
  }
  function createIndicesForQuads(size, outBuffer) {
    if (outBuffer === void 0) {
      outBuffer = null;
    }
    var totalIndices = size * 6;
    outBuffer = outBuffer || new Uint16Array(totalIndices);
    if (outBuffer.length !== totalIndices) {
      throw new Error("Out buffer length is incorrect, got " + outBuffer.length + " and expected " + totalIndices);
    }
    for (var i = 0, j = 0; i < totalIndices; i += 6, j += 4) {
      outBuffer[i + 0] = j + 0;
      outBuffer[i + 1] = j + 1;
      outBuffer[i + 2] = j + 2;
      outBuffer[i + 3] = j + 0;
      outBuffer[i + 4] = j + 2;
      outBuffer[i + 5] = j + 3;
    }
    return outBuffer;
  }
  function getBufferType(array) {
    if (array.BYTES_PER_ELEMENT === 4) {
      if (array instanceof Float32Array) {
        return "Float32Array";
      } else if (array instanceof Uint32Array) {
        return "Uint32Array";
      }
      return "Int32Array";
    } else if (array.BYTES_PER_ELEMENT === 2) {
      if (array instanceof Uint16Array) {
        return "Uint16Array";
      }
    } else if (array.BYTES_PER_ELEMENT === 1) {
      if (array instanceof Uint8Array) {
        return "Uint8Array";
      }
    }
    return null;
  }
  var map = {Float32Array, Uint32Array, Int32Array, Uint8Array};
  function interleaveTypedArrays(arrays, sizes) {
    var outSize = 0;
    var stride = 0;
    var views = {};
    for (var i = 0; i < arrays.length; i++) {
      stride += sizes[i];
      outSize += arrays[i].length;
    }
    var buffer = new ArrayBuffer(outSize * 4);
    var out = null;
    var littleOffset = 0;
    for (var i = 0; i < arrays.length; i++) {
      var size = sizes[i];
      var array = arrays[i];
      var type = getBufferType(array);
      if (!views[type]) {
        views[type] = new map[type](buffer);
      }
      out = views[type];
      for (var j = 0; j < array.length; j++) {
        var indexStart = (j / size | 0) * stride + littleOffset;
        var index2 = j % size;
        out[indexStart + index2] = array[j];
      }
      littleOffset += size;
    }
    return new Float32Array(buffer);
  }
  function nextPow2(v) {
    v += v === 0 ? 1 : 0;
    --v;
    v |= v >>> 1;
    v |= v >>> 2;
    v |= v >>> 4;
    v |= v >>> 8;
    v |= v >>> 16;
    return v + 1;
  }
  function isPow2(v) {
    return !(v & v - 1) && !!v;
  }
  function log2(v) {
    var r = (v > 65535 ? 1 : 0) << 4;
    v >>>= r;
    var shift = (v > 255 ? 1 : 0) << 3;
    v >>>= shift;
    r |= shift;
    shift = (v > 15 ? 1 : 0) << 2;
    v >>>= shift;
    r |= shift;
    shift = (v > 3 ? 1 : 0) << 1;
    v >>>= shift;
    r |= shift;
    return r | v >> 1;
  }
  function removeItems(arr, startIdx, removeCount) {
    var length = arr.length;
    var i;
    if (startIdx >= length || removeCount === 0) {
      return;
    }
    removeCount = startIdx + removeCount > length ? length - startIdx : removeCount;
    var len = length - removeCount;
    for (i = startIdx; i < len; ++i) {
      arr[i] = arr[i + removeCount];
    }
    arr.length = len;
  }
  function sign(n) {
    if (n === 0) {
      return 0;
    }
    return n < 0 ? -1 : 1;
  }
  var nextUid = 0;
  function uid() {
    return ++nextUid;
  }
  var warnings = {};
  function deprecation(version, message, ignoreDepth) {
    if (ignoreDepth === void 0) {
      ignoreDepth = 3;
    }
    if (warnings[message]) {
      return;
    }
    var stack = new Error().stack;
    if (typeof stack === "undefined") {
      console.warn("PixiJS Deprecation Warning: ", message + "\nDeprecated since v" + version);
    } else {
      stack = stack.split("\n").splice(ignoreDepth).join("\n");
      if (console.groupCollapsed) {
        console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s", "color:#614108;background:#fffbe6", "font-weight:normal;color:#614108;background:#fffbe6", message + "\nDeprecated since v" + version);
        console.warn(stack);
        console.groupEnd();
      } else {
        console.warn("PixiJS Deprecation Warning: ", message + "\nDeprecated since v" + version);
        console.warn(stack);
      }
    }
    warnings[message] = true;
  }
  var ProgramCache = {};
  var TextureCache = Object.create(null);
  var BaseTextureCache = Object.create(null);
  function destroyTextureCache() {
    var key;
    for (key in TextureCache) {
      TextureCache[key].destroy();
    }
    for (key in BaseTextureCache) {
      BaseTextureCache[key].destroy();
    }
  }
  function clearTextureCache() {
    var key;
    for (key in TextureCache) {
      delete TextureCache[key];
    }
    for (key in BaseTextureCache) {
      delete BaseTextureCache[key];
    }
  }
  var CanvasRenderTarget = function() {
    function CanvasRenderTarget2(width, height, resolution) {
      this.canvas = document.createElement("canvas");
      this.context = this.canvas.getContext("2d");
      this.resolution = resolution || settings.RESOLUTION;
      this.resize(width, height);
    }
    CanvasRenderTarget2.prototype.clear = function() {
      this.context.setTransform(1, 0, 0, 1, 0, 0);
      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    };
    CanvasRenderTarget2.prototype.resize = function(width, height) {
      this.canvas.width = width * this.resolution;
      this.canvas.height = height * this.resolution;
    };
    CanvasRenderTarget2.prototype.destroy = function() {
      this.context = null;
      this.canvas = null;
    };
    Object.defineProperty(CanvasRenderTarget2.prototype, "width", {
      get: function() {
        return this.canvas.width;
      },
      set: function(val) {
        this.canvas.width = val;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(CanvasRenderTarget2.prototype, "height", {
      get: function() {
        return this.canvas.height;
      },
      set: function(val) {
        this.canvas.height = val;
      },
      enumerable: false,
      configurable: true
    });
    return CanvasRenderTarget2;
  }();
  function trimCanvas(canvas2) {
    var width = canvas2.width;
    var height = canvas2.height;
    var context2 = canvas2.getContext("2d");
    var imageData = context2.getImageData(0, 0, width, height);
    var pixels = imageData.data;
    var len = pixels.length;
    var bound = {
      top: null,
      left: null,
      right: null,
      bottom: null
    };
    var data = null;
    var i;
    var x;
    var y;
    for (i = 0; i < len; i += 4) {
      if (pixels[i + 3] !== 0) {
        x = i / 4 % width;
        y = ~~(i / 4 / width);
        if (bound.top === null) {
          bound.top = y;
        }
        if (bound.left === null) {
          bound.left = x;
        } else if (x < bound.left) {
          bound.left = x;
        }
        if (bound.right === null) {
          bound.right = x + 1;
        } else if (bound.right < x) {
          bound.right = x + 1;
        }
        if (bound.bottom === null) {
          bound.bottom = y;
        } else if (bound.bottom < y) {
          bound.bottom = y;
        }
      }
    }
    if (bound.top !== null) {
      width = bound.right - bound.left;
      height = bound.bottom - bound.top + 1;
      data = context2.getImageData(bound.left, bound.top, width, height);
    }
    return {
      height,
      width,
      data
    };
  }
  var DATA_URI = /^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;
  function decomposeDataUri(dataUri) {
    var dataUriMatch = DATA_URI.exec(dataUri);
    if (dataUriMatch) {
      return {
        mediaType: dataUriMatch[1] ? dataUriMatch[1].toLowerCase() : void 0,
        subType: dataUriMatch[2] ? dataUriMatch[2].toLowerCase() : void 0,
        charset: dataUriMatch[3] ? dataUriMatch[3].toLowerCase() : void 0,
        encoding: dataUriMatch[4] ? dataUriMatch[4].toLowerCase() : void 0,
        data: dataUriMatch[5]
      };
    }
    return void 0;
  }
  var tempAnchor;
  function determineCrossOrigin(url, loc) {
    if (loc === void 0) {
      loc = window.location;
    }
    if (url.indexOf("data:") === 0) {
      return "";
    }
    loc = loc || window.location;
    if (!tempAnchor) {
      tempAnchor = document.createElement("a");
    }
    tempAnchor.href = url;
    var parsedUrl = import_url.parse(tempAnchor.href);
    var samePort = !parsedUrl.port && loc.port === "" || parsedUrl.port === loc.port;
    if (parsedUrl.hostname !== loc.hostname || !samePort || parsedUrl.protocol !== loc.protocol) {
      return "anonymous";
    }
    return "";
  }
  function getResolutionOfUrl(url, defaultValue2) {
    var resolution = settings.RETINA_PREFIX.exec(url);
    if (resolution) {
      return parseFloat(resolution[1]);
    }
    return defaultValue2 !== void 0 ? defaultValue2 : 1;
  }

  // node_modules/@pixi/math/lib/math.es.js
  /*!
   * @pixi/math - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/math is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var PI_2 = Math.PI * 2;
  var RAD_TO_DEG = 180 / Math.PI;
  var DEG_TO_RAD = Math.PI / 180;
  var SHAPES;
  (function(SHAPES2) {
    SHAPES2[SHAPES2["POLY"] = 0] = "POLY";
    SHAPES2[SHAPES2["RECT"] = 1] = "RECT";
    SHAPES2[SHAPES2["CIRC"] = 2] = "CIRC";
    SHAPES2[SHAPES2["ELIP"] = 3] = "ELIP";
    SHAPES2[SHAPES2["RREC"] = 4] = "RREC";
  })(SHAPES || (SHAPES = {}));
  var Rectangle = function() {
    function Rectangle3(x, y, width, height) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (width === void 0) {
        width = 0;
      }
      if (height === void 0) {
        height = 0;
      }
      this.x = Number(x);
      this.y = Number(y);
      this.width = Number(width);
      this.height = Number(height);
      this.type = SHAPES.RECT;
    }
    Object.defineProperty(Rectangle3.prototype, "left", {
      get: function() {
        return this.x;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Rectangle3.prototype, "right", {
      get: function() {
        return this.x + this.width;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Rectangle3.prototype, "top", {
      get: function() {
        return this.y;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Rectangle3.prototype, "bottom", {
      get: function() {
        return this.y + this.height;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Rectangle3, "EMPTY", {
      get: function() {
        return new Rectangle3(0, 0, 0, 0);
      },
      enumerable: false,
      configurable: true
    });
    Rectangle3.prototype.clone = function() {
      return new Rectangle3(this.x, this.y, this.width, this.height);
    };
    Rectangle3.prototype.copyFrom = function(rectangle) {
      this.x = rectangle.x;
      this.y = rectangle.y;
      this.width = rectangle.width;
      this.height = rectangle.height;
      return this;
    };
    Rectangle3.prototype.copyTo = function(rectangle) {
      rectangle.x = this.x;
      rectangle.y = this.y;
      rectangle.width = this.width;
      rectangle.height = this.height;
      return rectangle;
    };
    Rectangle3.prototype.contains = function(x, y) {
      if (this.width <= 0 || this.height <= 0) {
        return false;
      }
      if (x >= this.x && x < this.x + this.width) {
        if (y >= this.y && y < this.y + this.height) {
          return true;
        }
      }
      return false;
    };
    Rectangle3.prototype.pad = function(paddingX, paddingY) {
      if (paddingX === void 0) {
        paddingX = 0;
      }
      if (paddingY === void 0) {
        paddingY = paddingX;
      }
      this.x -= paddingX;
      this.y -= paddingY;
      this.width += paddingX * 2;
      this.height += paddingY * 2;
      return this;
    };
    Rectangle3.prototype.fit = function(rectangle) {
      var x1 = Math.max(this.x, rectangle.x);
      var x2 = Math.min(this.x + this.width, rectangle.x + rectangle.width);
      var y1 = Math.max(this.y, rectangle.y);
      var y2 = Math.min(this.y + this.height, rectangle.y + rectangle.height);
      this.x = x1;
      this.width = Math.max(x2 - x1, 0);
      this.y = y1;
      this.height = Math.max(y2 - y1, 0);
      return this;
    };
    Rectangle3.prototype.ceil = function(resolution, eps) {
      if (resolution === void 0) {
        resolution = 1;
      }
      if (eps === void 0) {
        eps = 1e-3;
      }
      var x2 = Math.ceil((this.x + this.width - eps) * resolution) / resolution;
      var y2 = Math.ceil((this.y + this.height - eps) * resolution) / resolution;
      this.x = Math.floor((this.x + eps) * resolution) / resolution;
      this.y = Math.floor((this.y + eps) * resolution) / resolution;
      this.width = x2 - this.x;
      this.height = y2 - this.y;
      return this;
    };
    Rectangle3.prototype.enlarge = function(rectangle) {
      var x1 = Math.min(this.x, rectangle.x);
      var x2 = Math.max(this.x + this.width, rectangle.x + rectangle.width);
      var y1 = Math.min(this.y, rectangle.y);
      var y2 = Math.max(this.y + this.height, rectangle.y + rectangle.height);
      this.x = x1;
      this.width = x2 - x1;
      this.y = y1;
      this.height = y2 - y1;
      return this;
    };
    return Rectangle3;
  }();
  var Circle = function() {
    function Circle2(x, y, radius) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (radius === void 0) {
        radius = 0;
      }
      this.x = x;
      this.y = y;
      this.radius = radius;
      this.type = SHAPES.CIRC;
    }
    Circle2.prototype.clone = function() {
      return new Circle2(this.x, this.y, this.radius);
    };
    Circle2.prototype.contains = function(x, y) {
      if (this.radius <= 0) {
        return false;
      }
      var r2 = this.radius * this.radius;
      var dx = this.x - x;
      var dy = this.y - y;
      dx *= dx;
      dy *= dy;
      return dx + dy <= r2;
    };
    Circle2.prototype.getBounds = function() {
      return new Rectangle(this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2);
    };
    return Circle2;
  }();
  var Ellipse = function() {
    function Ellipse2(x, y, halfWidth, halfHeight) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (halfWidth === void 0) {
        halfWidth = 0;
      }
      if (halfHeight === void 0) {
        halfHeight = 0;
      }
      this.x = x;
      this.y = y;
      this.width = halfWidth;
      this.height = halfHeight;
      this.type = SHAPES.ELIP;
    }
    Ellipse2.prototype.clone = function() {
      return new Ellipse2(this.x, this.y, this.width, this.height);
    };
    Ellipse2.prototype.contains = function(x, y) {
      if (this.width <= 0 || this.height <= 0) {
        return false;
      }
      var normx = (x - this.x) / this.width;
      var normy = (y - this.y) / this.height;
      normx *= normx;
      normy *= normy;
      return normx + normy <= 1;
    };
    Ellipse2.prototype.getBounds = function() {
      return new Rectangle(this.x - this.width, this.y - this.height, this.width, this.height);
    };
    return Ellipse2;
  }();
  var Polygon = function() {
    function Polygon2() {
      var arguments$1 = arguments;
      var points = [];
      for (var _i = 0; _i < arguments.length; _i++) {
        points[_i] = arguments$1[_i];
      }
      var flat = Array.isArray(points[0]) ? points[0] : points;
      if (typeof flat[0] !== "number") {
        var p = [];
        for (var i = 0, il = flat.length; i < il; i++) {
          p.push(flat[i].x, flat[i].y);
        }
        flat = p;
      }
      this.points = flat;
      this.type = SHAPES.POLY;
      this.closeStroke = true;
    }
    Polygon2.prototype.clone = function() {
      var points = this.points.slice();
      var polygon = new Polygon2(points);
      polygon.closeStroke = this.closeStroke;
      return polygon;
    };
    Polygon2.prototype.contains = function(x, y) {
      var inside = false;
      var length = this.points.length / 2;
      for (var i = 0, j = length - 1; i < length; j = i++) {
        var xi = this.points[i * 2];
        var yi = this.points[i * 2 + 1];
        var xj = this.points[j * 2];
        var yj = this.points[j * 2 + 1];
        var intersect = yi > y !== yj > y && x < (xj - xi) * ((y - yi) / (yj - yi)) + xi;
        if (intersect) {
          inside = !inside;
        }
      }
      return inside;
    };
    return Polygon2;
  }();
  var RoundedRectangle = function() {
    function RoundedRectangle2(x, y, width, height, radius) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (width === void 0) {
        width = 0;
      }
      if (height === void 0) {
        height = 0;
      }
      if (radius === void 0) {
        radius = 20;
      }
      this.x = x;
      this.y = y;
      this.width = width;
      this.height = height;
      this.radius = radius;
      this.type = SHAPES.RREC;
    }
    RoundedRectangle2.prototype.clone = function() {
      return new RoundedRectangle2(this.x, this.y, this.width, this.height, this.radius);
    };
    RoundedRectangle2.prototype.contains = function(x, y) {
      if (this.width <= 0 || this.height <= 0) {
        return false;
      }
      if (x >= this.x && x <= this.x + this.width) {
        if (y >= this.y && y <= this.y + this.height) {
          if (y >= this.y + this.radius && y <= this.y + this.height - this.radius || x >= this.x + this.radius && x <= this.x + this.width - this.radius) {
            return true;
          }
          var dx = x - (this.x + this.radius);
          var dy = y - (this.y + this.radius);
          var radius2 = this.radius * this.radius;
          if (dx * dx + dy * dy <= radius2) {
            return true;
          }
          dx = x - (this.x + this.width - this.radius);
          if (dx * dx + dy * dy <= radius2) {
            return true;
          }
          dy = y - (this.y + this.height - this.radius);
          if (dx * dx + dy * dy <= radius2) {
            return true;
          }
          dx = x - (this.x + this.radius);
          if (dx * dx + dy * dy <= radius2) {
            return true;
          }
        }
      }
      return false;
    };
    return RoundedRectangle2;
  }();
  var Point = function() {
    function Point2(x, y) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      this.x = x;
      this.y = y;
    }
    Point2.prototype.clone = function() {
      return new Point2(this.x, this.y);
    };
    Point2.prototype.copyFrom = function(p) {
      this.set(p.x, p.y);
      return this;
    };
    Point2.prototype.copyTo = function(p) {
      p.set(this.x, this.y);
      return p;
    };
    Point2.prototype.equals = function(p) {
      return p.x === this.x && p.y === this.y;
    };
    Point2.prototype.set = function(x, y) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = x;
      }
      this.x = x;
      this.y = y;
      return this;
    };
    return Point2;
  }();
  var ObservablePoint = function() {
    function ObservablePoint2(cb, scope, x, y) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      this._x = x;
      this._y = y;
      this.cb = cb;
      this.scope = scope;
    }
    ObservablePoint2.prototype.clone = function(cb, scope) {
      if (cb === void 0) {
        cb = this.cb;
      }
      if (scope === void 0) {
        scope = this.scope;
      }
      return new ObservablePoint2(cb, scope, this._x, this._y);
    };
    ObservablePoint2.prototype.set = function(x, y) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = x;
      }
      if (this._x !== x || this._y !== y) {
        this._x = x;
        this._y = y;
        this.cb.call(this.scope);
      }
      return this;
    };
    ObservablePoint2.prototype.copyFrom = function(p) {
      if (this._x !== p.x || this._y !== p.y) {
        this._x = p.x;
        this._y = p.y;
        this.cb.call(this.scope);
      }
      return this;
    };
    ObservablePoint2.prototype.copyTo = function(p) {
      p.set(this._x, this._y);
      return p;
    };
    ObservablePoint2.prototype.equals = function(p) {
      return p.x === this._x && p.y === this._y;
    };
    Object.defineProperty(ObservablePoint2.prototype, "x", {
      get: function() {
        return this._x;
      },
      set: function(value) {
        if (this._x !== value) {
          this._x = value;
          this.cb.call(this.scope);
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ObservablePoint2.prototype, "y", {
      get: function() {
        return this._y;
      },
      set: function(value) {
        if (this._y !== value) {
          this._y = value;
          this.cb.call(this.scope);
        }
      },
      enumerable: false,
      configurable: true
    });
    return ObservablePoint2;
  }();
  var Matrix = function() {
    function Matrix2(a, b, c, d, tx, ty) {
      if (a === void 0) {
        a = 1;
      }
      if (b === void 0) {
        b = 0;
      }
      if (c === void 0) {
        c = 0;
      }
      if (d === void 0) {
        d = 1;
      }
      if (tx === void 0) {
        tx = 0;
      }
      if (ty === void 0) {
        ty = 0;
      }
      this.array = null;
      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.tx = tx;
      this.ty = ty;
    }
    Matrix2.prototype.fromArray = function(array) {
      this.a = array[0];
      this.b = array[1];
      this.c = array[3];
      this.d = array[4];
      this.tx = array[2];
      this.ty = array[5];
    };
    Matrix2.prototype.set = function(a, b, c, d, tx, ty) {
      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.tx = tx;
      this.ty = ty;
      return this;
    };
    Matrix2.prototype.toArray = function(transpose, out) {
      if (!this.array) {
        this.array = new Float32Array(9);
      }
      var array = out || this.array;
      if (transpose) {
        array[0] = this.a;
        array[1] = this.b;
        array[2] = 0;
        array[3] = this.c;
        array[4] = this.d;
        array[5] = 0;
        array[6] = this.tx;
        array[7] = this.ty;
        array[8] = 1;
      } else {
        array[0] = this.a;
        array[1] = this.c;
        array[2] = this.tx;
        array[3] = this.b;
        array[4] = this.d;
        array[5] = this.ty;
        array[6] = 0;
        array[7] = 0;
        array[8] = 1;
      }
      return array;
    };
    Matrix2.prototype.apply = function(pos, newPos) {
      newPos = newPos || new Point();
      var x = pos.x;
      var y = pos.y;
      newPos.x = this.a * x + this.c * y + this.tx;
      newPos.y = this.b * x + this.d * y + this.ty;
      return newPos;
    };
    Matrix2.prototype.applyInverse = function(pos, newPos) {
      newPos = newPos || new Point();
      var id = 1 / (this.a * this.d + this.c * -this.b);
      var x = pos.x;
      var y = pos.y;
      newPos.x = this.d * id * x + -this.c * id * y + (this.ty * this.c - this.tx * this.d) * id;
      newPos.y = this.a * id * y + -this.b * id * x + (-this.ty * this.a + this.tx * this.b) * id;
      return newPos;
    };
    Matrix2.prototype.translate = function(x, y) {
      this.tx += x;
      this.ty += y;
      return this;
    };
    Matrix2.prototype.scale = function(x, y) {
      this.a *= x;
      this.d *= y;
      this.c *= x;
      this.b *= y;
      this.tx *= x;
      this.ty *= y;
      return this;
    };
    Matrix2.prototype.rotate = function(angle) {
      var cos = Math.cos(angle);
      var sin = Math.sin(angle);
      var a1 = this.a;
      var c1 = this.c;
      var tx1 = this.tx;
      this.a = a1 * cos - this.b * sin;
      this.b = a1 * sin + this.b * cos;
      this.c = c1 * cos - this.d * sin;
      this.d = c1 * sin + this.d * cos;
      this.tx = tx1 * cos - this.ty * sin;
      this.ty = tx1 * sin + this.ty * cos;
      return this;
    };
    Matrix2.prototype.append = function(matrix) {
      var a1 = this.a;
      var b1 = this.b;
      var c1 = this.c;
      var d1 = this.d;
      this.a = matrix.a * a1 + matrix.b * c1;
      this.b = matrix.a * b1 + matrix.b * d1;
      this.c = matrix.c * a1 + matrix.d * c1;
      this.d = matrix.c * b1 + matrix.d * d1;
      this.tx = matrix.tx * a1 + matrix.ty * c1 + this.tx;
      this.ty = matrix.tx * b1 + matrix.ty * d1 + this.ty;
      return this;
    };
    Matrix2.prototype.setTransform = function(x, y, pivotX, pivotY, scaleX, scaleY, rotation, skewX, skewY) {
      this.a = Math.cos(rotation + skewY) * scaleX;
      this.b = Math.sin(rotation + skewY) * scaleX;
      this.c = -Math.sin(rotation - skewX) * scaleY;
      this.d = Math.cos(rotation - skewX) * scaleY;
      this.tx = x - (pivotX * this.a + pivotY * this.c);
      this.ty = y - (pivotX * this.b + pivotY * this.d);
      return this;
    };
    Matrix2.prototype.prepend = function(matrix) {
      var tx1 = this.tx;
      if (matrix.a !== 1 || matrix.b !== 0 || matrix.c !== 0 || matrix.d !== 1) {
        var a1 = this.a;
        var c1 = this.c;
        this.a = a1 * matrix.a + this.b * matrix.c;
        this.b = a1 * matrix.b + this.b * matrix.d;
        this.c = c1 * matrix.a + this.d * matrix.c;
        this.d = c1 * matrix.b + this.d * matrix.d;
      }
      this.tx = tx1 * matrix.a + this.ty * matrix.c + matrix.tx;
      this.ty = tx1 * matrix.b + this.ty * matrix.d + matrix.ty;
      return this;
    };
    Matrix2.prototype.decompose = function(transform) {
      var a = this.a;
      var b = this.b;
      var c = this.c;
      var d = this.d;
      var skewX = -Math.atan2(-c, d);
      var skewY = Math.atan2(b, a);
      var delta = Math.abs(skewX + skewY);
      if (delta < 1e-5 || Math.abs(PI_2 - delta) < 1e-5) {
        transform.rotation = skewY;
        transform.skew.x = transform.skew.y = 0;
      } else {
        transform.rotation = 0;
        transform.skew.x = skewX;
        transform.skew.y = skewY;
      }
      transform.scale.x = Math.sqrt(a * a + b * b);
      transform.scale.y = Math.sqrt(c * c + d * d);
      transform.position.x = this.tx;
      transform.position.y = this.ty;
      return transform;
    };
    Matrix2.prototype.invert = function() {
      var a1 = this.a;
      var b1 = this.b;
      var c1 = this.c;
      var d1 = this.d;
      var tx1 = this.tx;
      var n = a1 * d1 - b1 * c1;
      this.a = d1 / n;
      this.b = -b1 / n;
      this.c = -c1 / n;
      this.d = a1 / n;
      this.tx = (c1 * this.ty - d1 * tx1) / n;
      this.ty = -(a1 * this.ty - b1 * tx1) / n;
      return this;
    };
    Matrix2.prototype.identity = function() {
      this.a = 1;
      this.b = 0;
      this.c = 0;
      this.d = 1;
      this.tx = 0;
      this.ty = 0;
      return this;
    };
    Matrix2.prototype.clone = function() {
      var matrix = new Matrix2();
      matrix.a = this.a;
      matrix.b = this.b;
      matrix.c = this.c;
      matrix.d = this.d;
      matrix.tx = this.tx;
      matrix.ty = this.ty;
      return matrix;
    };
    Matrix2.prototype.copyTo = function(matrix) {
      matrix.a = this.a;
      matrix.b = this.b;
      matrix.c = this.c;
      matrix.d = this.d;
      matrix.tx = this.tx;
      matrix.ty = this.ty;
      return matrix;
    };
    Matrix2.prototype.copyFrom = function(matrix) {
      this.a = matrix.a;
      this.b = matrix.b;
      this.c = matrix.c;
      this.d = matrix.d;
      this.tx = matrix.tx;
      this.ty = matrix.ty;
      return this;
    };
    Object.defineProperty(Matrix2, "IDENTITY", {
      get: function() {
        return new Matrix2();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Matrix2, "TEMP_MATRIX", {
      get: function() {
        return new Matrix2();
      },
      enumerable: false,
      configurable: true
    });
    return Matrix2;
  }();
  var ux = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1];
  var uy = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1];
  var vx = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1];
  var vy = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1];
  var rotationCayley = [];
  var rotationMatrices = [];
  var signum = Math.sign;
  function init() {
    for (var i = 0; i < 16; i++) {
      var row = [];
      rotationCayley.push(row);
      for (var j = 0; j < 16; j++) {
        var _ux = signum(ux[i] * ux[j] + vx[i] * uy[j]);
        var _uy = signum(uy[i] * ux[j] + vy[i] * uy[j]);
        var _vx = signum(ux[i] * vx[j] + vx[i] * vy[j]);
        var _vy = signum(uy[i] * vx[j] + vy[i] * vy[j]);
        for (var k = 0; k < 16; k++) {
          if (ux[k] === _ux && uy[k] === _uy && vx[k] === _vx && vy[k] === _vy) {
            row.push(k);
            break;
          }
        }
      }
    }
    for (var i = 0; i < 16; i++) {
      var mat = new Matrix();
      mat.set(ux[i], uy[i], vx[i], vy[i], 0, 0);
      rotationMatrices.push(mat);
    }
  }
  init();
  var groupD8 = {
    E: 0,
    SE: 1,
    S: 2,
    SW: 3,
    W: 4,
    NW: 5,
    N: 6,
    NE: 7,
    MIRROR_VERTICAL: 8,
    MAIN_DIAGONAL: 10,
    MIRROR_HORIZONTAL: 12,
    REVERSE_DIAGONAL: 14,
    uX: function(ind) {
      return ux[ind];
    },
    uY: function(ind) {
      return uy[ind];
    },
    vX: function(ind) {
      return vx[ind];
    },
    vY: function(ind) {
      return vy[ind];
    },
    inv: function(rotation) {
      if (rotation & 8) {
        return rotation & 15;
      }
      return -rotation & 7;
    },
    add: function(rotationSecond, rotationFirst) {
      return rotationCayley[rotationSecond][rotationFirst];
    },
    sub: function(rotationSecond, rotationFirst) {
      return rotationCayley[rotationSecond][groupD8.inv(rotationFirst)];
    },
    rotate180: function(rotation) {
      return rotation ^ 4;
    },
    isVertical: function(rotation) {
      return (rotation & 3) === 2;
    },
    byDirection: function(dx, dy) {
      if (Math.abs(dx) * 2 <= Math.abs(dy)) {
        if (dy >= 0) {
          return groupD8.S;
        }
        return groupD8.N;
      } else if (Math.abs(dy) * 2 <= Math.abs(dx)) {
        if (dx > 0) {
          return groupD8.E;
        }
        return groupD8.W;
      } else if (dy > 0) {
        if (dx > 0) {
          return groupD8.SE;
        }
        return groupD8.SW;
      } else if (dx > 0) {
        return groupD8.NE;
      }
      return groupD8.NW;
    },
    matrixAppendRotationInv: function(matrix, rotation, tx, ty) {
      if (tx === void 0) {
        tx = 0;
      }
      if (ty === void 0) {
        ty = 0;
      }
      var mat = rotationMatrices[groupD8.inv(rotation)];
      mat.tx = tx;
      mat.ty = ty;
      matrix.append(mat);
    }
  };
  var Transform = function() {
    function Transform2() {
      this.worldTransform = new Matrix();
      this.localTransform = new Matrix();
      this.position = new ObservablePoint(this.onChange, this, 0, 0);
      this.scale = new ObservablePoint(this.onChange, this, 1, 1);
      this.pivot = new ObservablePoint(this.onChange, this, 0, 0);
      this.skew = new ObservablePoint(this.updateSkew, this, 0, 0);
      this._rotation = 0;
      this._cx = 1;
      this._sx = 0;
      this._cy = 0;
      this._sy = 1;
      this._localID = 0;
      this._currentLocalID = 0;
      this._worldID = 0;
      this._parentID = 0;
    }
    Transform2.prototype.onChange = function() {
      this._localID++;
    };
    Transform2.prototype.updateSkew = function() {
      this._cx = Math.cos(this._rotation + this.skew.y);
      this._sx = Math.sin(this._rotation + this.skew.y);
      this._cy = -Math.sin(this._rotation - this.skew.x);
      this._sy = Math.cos(this._rotation - this.skew.x);
      this._localID++;
    };
    Transform2.prototype.updateLocalTransform = function() {
      var lt = this.localTransform;
      if (this._localID !== this._currentLocalID) {
        lt.a = this._cx * this.scale.x;
        lt.b = this._sx * this.scale.x;
        lt.c = this._cy * this.scale.y;
        lt.d = this._sy * this.scale.y;
        lt.tx = this.position.x - (this.pivot.x * lt.a + this.pivot.y * lt.c);
        lt.ty = this.position.y - (this.pivot.x * lt.b + this.pivot.y * lt.d);
        this._currentLocalID = this._localID;
        this._parentID = -1;
      }
    };
    Transform2.prototype.updateTransform = function(parentTransform) {
      var lt = this.localTransform;
      if (this._localID !== this._currentLocalID) {
        lt.a = this._cx * this.scale.x;
        lt.b = this._sx * this.scale.x;
        lt.c = this._cy * this.scale.y;
        lt.d = this._sy * this.scale.y;
        lt.tx = this.position.x - (this.pivot.x * lt.a + this.pivot.y * lt.c);
        lt.ty = this.position.y - (this.pivot.x * lt.b + this.pivot.y * lt.d);
        this._currentLocalID = this._localID;
        this._parentID = -1;
      }
      if (this._parentID !== parentTransform._worldID) {
        var pt = parentTransform.worldTransform;
        var wt = this.worldTransform;
        wt.a = lt.a * pt.a + lt.b * pt.c;
        wt.b = lt.a * pt.b + lt.b * pt.d;
        wt.c = lt.c * pt.a + lt.d * pt.c;
        wt.d = lt.c * pt.b + lt.d * pt.d;
        wt.tx = lt.tx * pt.a + lt.ty * pt.c + pt.tx;
        wt.ty = lt.tx * pt.b + lt.ty * pt.d + pt.ty;
        this._parentID = parentTransform._worldID;
        this._worldID++;
      }
    };
    Transform2.prototype.setFromMatrix = function(matrix) {
      matrix.decompose(this);
      this._localID++;
    };
    Object.defineProperty(Transform2.prototype, "rotation", {
      get: function() {
        return this._rotation;
      },
      set: function(value) {
        if (this._rotation !== value) {
          this._rotation = value;
          this.updateSkew();
        }
      },
      enumerable: false,
      configurable: true
    });
    Transform2.IDENTITY = new Transform2();
    return Transform2;
  }();

  // node_modules/@pixi/display/lib/display.es.js
  /*!
   * @pixi/display - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/display is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  settings.SORTABLE_CHILDREN = false;
  var Bounds = function() {
    function Bounds2() {
      this.minX = Infinity;
      this.minY = Infinity;
      this.maxX = -Infinity;
      this.maxY = -Infinity;
      this.rect = null;
      this.updateID = -1;
    }
    Bounds2.prototype.isEmpty = function() {
      return this.minX > this.maxX || this.minY > this.maxY;
    };
    Bounds2.prototype.clear = function() {
      this.minX = Infinity;
      this.minY = Infinity;
      this.maxX = -Infinity;
      this.maxY = -Infinity;
    };
    Bounds2.prototype.getRectangle = function(rect) {
      if (this.minX > this.maxX || this.minY > this.maxY) {
        return Rectangle.EMPTY;
      }
      rect = rect || new Rectangle(0, 0, 1, 1);
      rect.x = this.minX;
      rect.y = this.minY;
      rect.width = this.maxX - this.minX;
      rect.height = this.maxY - this.minY;
      return rect;
    };
    Bounds2.prototype.addPoint = function(point) {
      this.minX = Math.min(this.minX, point.x);
      this.maxX = Math.max(this.maxX, point.x);
      this.minY = Math.min(this.minY, point.y);
      this.maxY = Math.max(this.maxY, point.y);
    };
    Bounds2.prototype.addQuad = function(vertices) {
      var minX = this.minX;
      var minY = this.minY;
      var maxX = this.maxX;
      var maxY = this.maxY;
      var x = vertices[0];
      var y = vertices[1];
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = vertices[2];
      y = vertices[3];
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = vertices[4];
      y = vertices[5];
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = vertices[6];
      y = vertices[7];
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      this.minX = minX;
      this.minY = minY;
      this.maxX = maxX;
      this.maxY = maxY;
    };
    Bounds2.prototype.addFrame = function(transform, x0, y0, x1, y1) {
      this.addFrameMatrix(transform.worldTransform, x0, y0, x1, y1);
    };
    Bounds2.prototype.addFrameMatrix = function(matrix, x0, y0, x1, y1) {
      var a = matrix.a;
      var b = matrix.b;
      var c = matrix.c;
      var d = matrix.d;
      var tx = matrix.tx;
      var ty = matrix.ty;
      var minX = this.minX;
      var minY = this.minY;
      var maxX = this.maxX;
      var maxY = this.maxY;
      var x = a * x0 + c * y0 + tx;
      var y = b * x0 + d * y0 + ty;
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = a * x1 + c * y0 + tx;
      y = b * x1 + d * y0 + ty;
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = a * x0 + c * y1 + tx;
      y = b * x0 + d * y1 + ty;
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      x = a * x1 + c * y1 + tx;
      y = b * x1 + d * y1 + ty;
      minX = x < minX ? x : minX;
      minY = y < minY ? y : minY;
      maxX = x > maxX ? x : maxX;
      maxY = y > maxY ? y : maxY;
      this.minX = minX;
      this.minY = minY;
      this.maxX = maxX;
      this.maxY = maxY;
    };
    Bounds2.prototype.addVertexData = function(vertexData, beginOffset, endOffset) {
      var minX = this.minX;
      var minY = this.minY;
      var maxX = this.maxX;
      var maxY = this.maxY;
      for (var i = beginOffset; i < endOffset; i += 2) {
        var x = vertexData[i];
        var y = vertexData[i + 1];
        minX = x < minX ? x : minX;
        minY = y < minY ? y : minY;
        maxX = x > maxX ? x : maxX;
        maxY = y > maxY ? y : maxY;
      }
      this.minX = minX;
      this.minY = minY;
      this.maxX = maxX;
      this.maxY = maxY;
    };
    Bounds2.prototype.addVertices = function(transform, vertices, beginOffset, endOffset) {
      this.addVerticesMatrix(transform.worldTransform, vertices, beginOffset, endOffset);
    };
    Bounds2.prototype.addVerticesMatrix = function(matrix, vertices, beginOffset, endOffset, padX, padY) {
      if (padX === void 0) {
        padX = 0;
      }
      if (padY === void 0) {
        padY = padX;
      }
      var a = matrix.a;
      var b = matrix.b;
      var c = matrix.c;
      var d = matrix.d;
      var tx = matrix.tx;
      var ty = matrix.ty;
      var minX = this.minX;
      var minY = this.minY;
      var maxX = this.maxX;
      var maxY = this.maxY;
      for (var i = beginOffset; i < endOffset; i += 2) {
        var rawX = vertices[i];
        var rawY = vertices[i + 1];
        var x = a * rawX + c * rawY + tx;
        var y = d * rawY + b * rawX + ty;
        minX = Math.min(minX, x - padX);
        maxX = Math.max(maxX, x + padX);
        minY = Math.min(minY, y - padY);
        maxY = Math.max(maxY, y + padY);
      }
      this.minX = minX;
      this.minY = minY;
      this.maxX = maxX;
      this.maxY = maxY;
    };
    Bounds2.prototype.addBounds = function(bounds) {
      var minX = this.minX;
      var minY = this.minY;
      var maxX = this.maxX;
      var maxY = this.maxY;
      this.minX = bounds.minX < minX ? bounds.minX : minX;
      this.minY = bounds.minY < minY ? bounds.minY : minY;
      this.maxX = bounds.maxX > maxX ? bounds.maxX : maxX;
      this.maxY = bounds.maxY > maxY ? bounds.maxY : maxY;
    };
    Bounds2.prototype.addBoundsMask = function(bounds, mask) {
      var _minX = bounds.minX > mask.minX ? bounds.minX : mask.minX;
      var _minY = bounds.minY > mask.minY ? bounds.minY : mask.minY;
      var _maxX = bounds.maxX < mask.maxX ? bounds.maxX : mask.maxX;
      var _maxY = bounds.maxY < mask.maxY ? bounds.maxY : mask.maxY;
      if (_minX <= _maxX && _minY <= _maxY) {
        var minX = this.minX;
        var minY = this.minY;
        var maxX = this.maxX;
        var maxY = this.maxY;
        this.minX = _minX < minX ? _minX : minX;
        this.minY = _minY < minY ? _minY : minY;
        this.maxX = _maxX > maxX ? _maxX : maxX;
        this.maxY = _maxY > maxY ? _maxY : maxY;
      }
    };
    Bounds2.prototype.addBoundsMatrix = function(bounds, matrix) {
      this.addFrameMatrix(matrix, bounds.minX, bounds.minY, bounds.maxX, bounds.maxY);
    };
    Bounds2.prototype.addBoundsArea = function(bounds, area) {
      var _minX = bounds.minX > area.x ? bounds.minX : area.x;
      var _minY = bounds.minY > area.y ? bounds.minY : area.y;
      var _maxX = bounds.maxX < area.x + area.width ? bounds.maxX : area.x + area.width;
      var _maxY = bounds.maxY < area.y + area.height ? bounds.maxY : area.y + area.height;
      if (_minX <= _maxX && _minY <= _maxY) {
        var minX = this.minX;
        var minY = this.minY;
        var maxX = this.maxX;
        var maxY = this.maxY;
        this.minX = _minX < minX ? _minX : minX;
        this.minY = _minY < minY ? _minY : minY;
        this.maxX = _maxX > maxX ? _maxX : maxX;
        this.maxY = _maxY > maxY ? _maxY : maxY;
      }
    };
    Bounds2.prototype.pad = function(paddingX, paddingY) {
      if (paddingX === void 0) {
        paddingX = 0;
      }
      if (paddingY === void 0) {
        paddingY = paddingX;
      }
      if (!this.isEmpty()) {
        this.minX -= paddingX;
        this.maxX += paddingX;
        this.minY -= paddingY;
        this.maxY += paddingY;
      }
    };
    Bounds2.prototype.addFramePad = function(x0, y0, x1, y1, padX, padY) {
      x0 -= padX;
      y0 -= padY;
      x1 += padX;
      y1 += padY;
      this.minX = this.minX < x0 ? this.minX : x0;
      this.maxX = this.maxX > x1 ? this.maxX : x1;
      this.minY = this.minY < y0 ? this.minY : y0;
      this.maxY = this.maxY > y1 ? this.maxY : y1;
    };
    return Bounds2;
  }();
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics(d, b);
  };
  function __extends(d, b) {
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var DisplayObject = function(_super) {
    __extends(DisplayObject2, _super);
    function DisplayObject2() {
      var _this = _super.call(this) || this;
      _this.tempDisplayObjectParent = null;
      _this.transform = new Transform();
      _this.alpha = 1;
      _this.visible = true;
      _this.renderable = true;
      _this.parent = null;
      _this.worldAlpha = 1;
      _this._lastSortedIndex = 0;
      _this._zIndex = 0;
      _this.filterArea = null;
      _this.filters = null;
      _this._enabledFilters = null;
      _this._bounds = new Bounds();
      _this._localBounds = null;
      _this._boundsID = 0;
      _this._boundsRect = null;
      _this._localBoundsRect = null;
      _this._mask = null;
      _this._destroyed = false;
      _this.isSprite = false;
      _this.isMask = false;
      return _this;
    }
    DisplayObject2.mixin = function(source) {
      var keys2 = Object.keys(source);
      for (var i = 0; i < keys2.length; ++i) {
        var propertyName = keys2[i];
        Object.defineProperty(DisplayObject2.prototype, propertyName, Object.getOwnPropertyDescriptor(source, propertyName));
      }
    };
    DisplayObject2.prototype._recursivePostUpdateTransform = function() {
      if (this.parent) {
        this.parent._recursivePostUpdateTransform();
        this.transform.updateTransform(this.parent.transform);
      } else {
        this.transform.updateTransform(this._tempDisplayObjectParent.transform);
      }
    };
    DisplayObject2.prototype.updateTransform = function() {
      this._boundsID++;
      this.transform.updateTransform(this.parent.transform);
      this.worldAlpha = this.alpha * this.parent.worldAlpha;
    };
    DisplayObject2.prototype.getBounds = function(skipUpdate, rect) {
      if (!skipUpdate) {
        if (!this.parent) {
          this.parent = this._tempDisplayObjectParent;
          this.updateTransform();
          this.parent = null;
        } else {
          this._recursivePostUpdateTransform();
          this.updateTransform();
        }
      }
      if (this._bounds.updateID !== this._boundsID) {
        this.calculateBounds();
        this._bounds.updateID = this._boundsID;
      }
      if (!rect) {
        if (!this._boundsRect) {
          this._boundsRect = new Rectangle();
        }
        rect = this._boundsRect;
      }
      return this._bounds.getRectangle(rect);
    };
    DisplayObject2.prototype.getLocalBounds = function(rect) {
      if (!rect) {
        if (!this._localBoundsRect) {
          this._localBoundsRect = new Rectangle();
        }
        rect = this._localBoundsRect;
      }
      if (!this._localBounds) {
        this._localBounds = new Bounds();
      }
      var transformRef = this.transform;
      var parentRef = this.parent;
      this.parent = null;
      this.transform = this._tempDisplayObjectParent.transform;
      var worldBounds = this._bounds;
      var worldBoundsID = this._boundsID;
      this._bounds = this._localBounds;
      var bounds = this.getBounds(false, rect);
      this.parent = parentRef;
      this.transform = transformRef;
      this._bounds = worldBounds;
      this._bounds.updateID += this._boundsID - worldBoundsID;
      return bounds;
    };
    DisplayObject2.prototype.toGlobal = function(position, point, skipUpdate) {
      if (skipUpdate === void 0) {
        skipUpdate = false;
      }
      if (!skipUpdate) {
        this._recursivePostUpdateTransform();
        if (!this.parent) {
          this.parent = this._tempDisplayObjectParent;
          this.displayObjectUpdateTransform();
          this.parent = null;
        } else {
          this.displayObjectUpdateTransform();
        }
      }
      return this.worldTransform.apply(position, point);
    };
    DisplayObject2.prototype.toLocal = function(position, from, point, skipUpdate) {
      if (from) {
        position = from.toGlobal(position, point, skipUpdate);
      }
      if (!skipUpdate) {
        this._recursivePostUpdateTransform();
        if (!this.parent) {
          this.parent = this._tempDisplayObjectParent;
          this.displayObjectUpdateTransform();
          this.parent = null;
        } else {
          this.displayObjectUpdateTransform();
        }
      }
      return this.worldTransform.applyInverse(position, point);
    };
    DisplayObject2.prototype.setParent = function(container) {
      if (!container || !container.addChild) {
        throw new Error("setParent: Argument must be a Container");
      }
      container.addChild(this);
      return container;
    };
    DisplayObject2.prototype.setTransform = function(x, y, scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (scaleX === void 0) {
        scaleX = 1;
      }
      if (scaleY === void 0) {
        scaleY = 1;
      }
      if (rotation === void 0) {
        rotation = 0;
      }
      if (skewX === void 0) {
        skewX = 0;
      }
      if (skewY === void 0) {
        skewY = 0;
      }
      if (pivotX === void 0) {
        pivotX = 0;
      }
      if (pivotY === void 0) {
        pivotY = 0;
      }
      this.position.x = x;
      this.position.y = y;
      this.scale.x = !scaleX ? 1 : scaleX;
      this.scale.y = !scaleY ? 1 : scaleY;
      this.rotation = rotation;
      this.skew.x = skewX;
      this.skew.y = skewY;
      this.pivot.x = pivotX;
      this.pivot.y = pivotY;
      return this;
    };
    DisplayObject2.prototype.destroy = function(_options) {
      if (this.parent) {
        this.parent.removeChild(this);
      }
      this.removeAllListeners();
      this.transform = null;
      this.parent = null;
      this._bounds = null;
      this._mask = null;
      this.filters = null;
      this.filterArea = null;
      this.hitArea = null;
      this.interactive = false;
      this.interactiveChildren = false;
      this._destroyed = true;
    };
    Object.defineProperty(DisplayObject2.prototype, "_tempDisplayObjectParent", {
      get: function() {
        if (this.tempDisplayObjectParent === null) {
          this.tempDisplayObjectParent = new TemporaryDisplayObject();
        }
        return this.tempDisplayObjectParent;
      },
      enumerable: false,
      configurable: true
    });
    DisplayObject2.prototype.enableTempParent = function() {
      var myParent = this.parent;
      this.parent = this._tempDisplayObjectParent;
      return myParent;
    };
    DisplayObject2.prototype.disableTempParent = function(cacheParent) {
      this.parent = cacheParent;
    };
    Object.defineProperty(DisplayObject2.prototype, "x", {
      get: function() {
        return this.position.x;
      },
      set: function(value) {
        this.transform.position.x = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "y", {
      get: function() {
        return this.position.y;
      },
      set: function(value) {
        this.transform.position.y = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "worldTransform", {
      get: function() {
        return this.transform.worldTransform;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "localTransform", {
      get: function() {
        return this.transform.localTransform;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "position", {
      get: function() {
        return this.transform.position;
      },
      set: function(value) {
        this.transform.position.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "scale", {
      get: function() {
        return this.transform.scale;
      },
      set: function(value) {
        this.transform.scale.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "pivot", {
      get: function() {
        return this.transform.pivot;
      },
      set: function(value) {
        this.transform.pivot.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "skew", {
      get: function() {
        return this.transform.skew;
      },
      set: function(value) {
        this.transform.skew.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "rotation", {
      get: function() {
        return this.transform.rotation;
      },
      set: function(value) {
        this.transform.rotation = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "angle", {
      get: function() {
        return this.transform.rotation * RAD_TO_DEG;
      },
      set: function(value) {
        this.transform.rotation = value * DEG_TO_RAD;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "zIndex", {
      get: function() {
        return this._zIndex;
      },
      set: function(value) {
        this._zIndex = value;
        if (this.parent) {
          this.parent.sortDirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "worldVisible", {
      get: function() {
        var item = this;
        do {
          if (!item.visible) {
            return false;
          }
          item = item.parent;
        } while (item);
        return true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(DisplayObject2.prototype, "mask", {
      get: function() {
        return this._mask;
      },
      set: function(value) {
        if (this._mask) {
          var maskObject = this._mask.maskObject || this._mask;
          maskObject.renderable = true;
          maskObject.isMask = false;
        }
        this._mask = value;
        if (this._mask) {
          var maskObject = this._mask.maskObject || this._mask;
          maskObject.renderable = false;
          maskObject.isMask = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    return DisplayObject2;
  }(import_eventemitter3.default);
  var TemporaryDisplayObject = function(_super) {
    __extends(TemporaryDisplayObject2, _super);
    function TemporaryDisplayObject2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.sortDirty = null;
      return _this;
    }
    return TemporaryDisplayObject2;
  }(DisplayObject);
  DisplayObject.prototype.displayObjectUpdateTransform = DisplayObject.prototype.updateTransform;
  function sortChildren(a, b) {
    if (a.zIndex === b.zIndex) {
      return a._lastSortedIndex - b._lastSortedIndex;
    }
    return a.zIndex - b.zIndex;
  }
  var Container = function(_super) {
    __extends(Container2, _super);
    function Container2() {
      var _this = _super.call(this) || this;
      _this.children = [];
      _this.sortableChildren = settings.SORTABLE_CHILDREN;
      _this.sortDirty = false;
      return _this;
    }
    Container2.prototype.onChildrenChange = function(_length) {
    };
    Container2.prototype.addChild = function() {
      var arguments$1 = arguments;
      var children = [];
      for (var _i = 0; _i < arguments.length; _i++) {
        children[_i] = arguments$1[_i];
      }
      if (children.length > 1) {
        for (var i = 0; i < children.length; i++) {
          this.addChild(children[i]);
        }
      } else {
        var child = children[0];
        if (child.parent) {
          child.parent.removeChild(child);
        }
        child.parent = this;
        this.sortDirty = true;
        child.transform._parentID = -1;
        this.children.push(child);
        this._boundsID++;
        this.onChildrenChange(this.children.length - 1);
        this.emit("childAdded", child, this, this.children.length - 1);
        child.emit("added", this);
      }
      return children[0];
    };
    Container2.prototype.addChildAt = function(child, index2) {
      if (index2 < 0 || index2 > this.children.length) {
        throw new Error(child + "addChildAt: The index " + index2 + " supplied is out of bounds " + this.children.length);
      }
      if (child.parent) {
        child.parent.removeChild(child);
      }
      child.parent = this;
      this.sortDirty = true;
      child.transform._parentID = -1;
      this.children.splice(index2, 0, child);
      this._boundsID++;
      this.onChildrenChange(index2);
      child.emit("added", this);
      this.emit("childAdded", child, this, index2);
      return child;
    };
    Container2.prototype.swapChildren = function(child, child2) {
      if (child === child2) {
        return;
      }
      var index1 = this.getChildIndex(child);
      var index2 = this.getChildIndex(child2);
      this.children[index1] = child2;
      this.children[index2] = child;
      this.onChildrenChange(index1 < index2 ? index1 : index2);
    };
    Container2.prototype.getChildIndex = function(child) {
      var index2 = this.children.indexOf(child);
      if (index2 === -1) {
        throw new Error("The supplied DisplayObject must be a child of the caller");
      }
      return index2;
    };
    Container2.prototype.setChildIndex = function(child, index2) {
      if (index2 < 0 || index2 >= this.children.length) {
        throw new Error("The index " + index2 + " supplied is out of bounds " + this.children.length);
      }
      var currentIndex = this.getChildIndex(child);
      removeItems(this.children, currentIndex, 1);
      this.children.splice(index2, 0, child);
      this.onChildrenChange(index2);
    };
    Container2.prototype.getChildAt = function(index2) {
      if (index2 < 0 || index2 >= this.children.length) {
        throw new Error("getChildAt: Index (" + index2 + ") does not exist.");
      }
      return this.children[index2];
    };
    Container2.prototype.removeChild = function() {
      var arguments$1 = arguments;
      var children = [];
      for (var _i = 0; _i < arguments.length; _i++) {
        children[_i] = arguments$1[_i];
      }
      if (children.length > 1) {
        for (var i = 0; i < children.length; i++) {
          this.removeChild(children[i]);
        }
      } else {
        var child = children[0];
        var index2 = this.children.indexOf(child);
        if (index2 === -1) {
          return null;
        }
        child.parent = null;
        child.transform._parentID = -1;
        removeItems(this.children, index2, 1);
        this._boundsID++;
        this.onChildrenChange(index2);
        child.emit("removed", this);
        this.emit("childRemoved", child, this, index2);
      }
      return children[0];
    };
    Container2.prototype.removeChildAt = function(index2) {
      var child = this.getChildAt(index2);
      child.parent = null;
      child.transform._parentID = -1;
      removeItems(this.children, index2, 1);
      this._boundsID++;
      this.onChildrenChange(index2);
      child.emit("removed", this);
      this.emit("childRemoved", child, this, index2);
      return child;
    };
    Container2.prototype.removeChildren = function(beginIndex, endIndex) {
      if (beginIndex === void 0) {
        beginIndex = 0;
      }
      if (endIndex === void 0) {
        endIndex = this.children.length;
      }
      var begin = beginIndex;
      var end = endIndex;
      var range = end - begin;
      var removed;
      if (range > 0 && range <= end) {
        removed = this.children.splice(begin, range);
        for (var i = 0; i < removed.length; ++i) {
          removed[i].parent = null;
          if (removed[i].transform) {
            removed[i].transform._parentID = -1;
          }
        }
        this._boundsID++;
        this.onChildrenChange(beginIndex);
        for (var i = 0; i < removed.length; ++i) {
          removed[i].emit("removed", this);
          this.emit("childRemoved", removed[i], this, i);
        }
        return removed;
      } else if (range === 0 && this.children.length === 0) {
        return [];
      }
      throw new RangeError("removeChildren: numeric values are outside the acceptable range.");
    };
    Container2.prototype.sortChildren = function() {
      var sortRequired = false;
      for (var i = 0, j = this.children.length; i < j; ++i) {
        var child = this.children[i];
        child._lastSortedIndex = i;
        if (!sortRequired && child.zIndex !== 0) {
          sortRequired = true;
        }
      }
      if (sortRequired && this.children.length > 1) {
        this.children.sort(sortChildren);
      }
      this.sortDirty = false;
    };
    Container2.prototype.updateTransform = function() {
      if (this.sortableChildren && this.sortDirty) {
        this.sortChildren();
      }
      this._boundsID++;
      this.transform.updateTransform(this.parent.transform);
      this.worldAlpha = this.alpha * this.parent.worldAlpha;
      for (var i = 0, j = this.children.length; i < j; ++i) {
        var child = this.children[i];
        if (child.visible) {
          child.updateTransform();
        }
      }
    };
    Container2.prototype.calculateBounds = function() {
      this._bounds.clear();
      this._calculateBounds();
      for (var i = 0; i < this.children.length; i++) {
        var child = this.children[i];
        if (!child.visible || !child.renderable) {
          continue;
        }
        child.calculateBounds();
        if (child._mask) {
          var maskObject = child._mask.maskObject || child._mask;
          maskObject.calculateBounds();
          this._bounds.addBoundsMask(child._bounds, maskObject._bounds);
        } else if (child.filterArea) {
          this._bounds.addBoundsArea(child._bounds, child.filterArea);
        } else {
          this._bounds.addBounds(child._bounds);
        }
      }
      this._bounds.updateID = this._boundsID;
    };
    Container2.prototype.getLocalBounds = function(rect, skipChildrenUpdate) {
      if (skipChildrenUpdate === void 0) {
        skipChildrenUpdate = false;
      }
      var result = _super.prototype.getLocalBounds.call(this, rect);
      if (!skipChildrenUpdate) {
        for (var i = 0, j = this.children.length; i < j; ++i) {
          var child = this.children[i];
          if (child.visible) {
            child.updateTransform();
          }
        }
      }
      return result;
    };
    Container2.prototype._calculateBounds = function() {
    };
    Container2.prototype.render = function(renderer) {
      if (!this.visible || this.worldAlpha <= 0 || !this.renderable) {
        return;
      }
      if (this._mask || this.filters && this.filters.length) {
        this.renderAdvanced(renderer);
      } else {
        this._render(renderer);
        for (var i = 0, j = this.children.length; i < j; ++i) {
          this.children[i].render(renderer);
        }
      }
    };
    Container2.prototype.renderAdvanced = function(renderer) {
      renderer.batch.flush();
      var filters = this.filters;
      var mask = this._mask;
      if (filters) {
        if (!this._enabledFilters) {
          this._enabledFilters = [];
        }
        this._enabledFilters.length = 0;
        for (var i = 0; i < filters.length; i++) {
          if (filters[i].enabled) {
            this._enabledFilters.push(filters[i]);
          }
        }
        if (this._enabledFilters.length) {
          renderer.filter.push(this, this._enabledFilters);
        }
      }
      if (mask) {
        renderer.mask.push(this, this._mask);
      }
      this._render(renderer);
      for (var i = 0, j = this.children.length; i < j; i++) {
        this.children[i].render(renderer);
      }
      renderer.batch.flush();
      if (mask) {
        renderer.mask.pop(this);
      }
      if (filters && this._enabledFilters && this._enabledFilters.length) {
        renderer.filter.pop();
      }
    };
    Container2.prototype._render = function(_renderer) {
    };
    Container2.prototype.destroy = function(options) {
      _super.prototype.destroy.call(this);
      this.sortDirty = false;
      var destroyChildren = typeof options === "boolean" ? options : options && options.children;
      var oldChildren = this.removeChildren(0, this.children.length);
      if (destroyChildren) {
        for (var i = 0; i < oldChildren.length; ++i) {
          oldChildren[i].destroy(options);
        }
      }
    };
    Object.defineProperty(Container2.prototype, "width", {
      get: function() {
        return this.scale.x * this.getLocalBounds().width;
      },
      set: function(value) {
        var width = this.getLocalBounds().width;
        if (width !== 0) {
          this.scale.x = value / width;
        } else {
          this.scale.x = 1;
        }
        this._width = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Container2.prototype, "height", {
      get: function() {
        return this.scale.y * this.getLocalBounds().height;
      },
      set: function(value) {
        var height = this.getLocalBounds().height;
        if (height !== 0) {
          this.scale.y = value / height;
        } else {
          this.scale.y = 1;
        }
        this._height = value;
      },
      enumerable: false,
      configurable: true
    });
    return Container2;
  }(DisplayObject);
  Container.prototype.containerUpdateTransform = Container.prototype.updateTransform;

  // node_modules/@pixi/accessibility/lib/accessibility.es.js
  /*!
   * @pixi/accessibility - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/accessibility is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var accessibleTarget = {
    accessible: false,
    accessibleTitle: null,
    accessibleHint: null,
    tabIndex: 0,
    _accessibleActive: false,
    _accessibleDiv: null,
    accessibleType: "button",
    accessiblePointerEvents: "auto",
    accessibleChildren: true,
    renderId: -1
  };
  DisplayObject.mixin(accessibleTarget);
  var KEY_CODE_TAB = 9;
  var DIV_TOUCH_SIZE = 100;
  var DIV_TOUCH_POS_X = 0;
  var DIV_TOUCH_POS_Y = 0;
  var DIV_TOUCH_ZINDEX = 2;
  var DIV_HOOK_SIZE = 1;
  var DIV_HOOK_POS_X = -1e3;
  var DIV_HOOK_POS_Y = -1e3;
  var DIV_HOOK_ZINDEX = 2;
  var AccessibilityManager = function() {
    function AccessibilityManager2(renderer) {
      this._hookDiv = null;
      if (isMobile2.tablet || isMobile2.phone) {
        this.createTouchHook();
      }
      var div = document.createElement("div");
      div.style.width = DIV_TOUCH_SIZE + "px";
      div.style.height = DIV_TOUCH_SIZE + "px";
      div.style.position = "absolute";
      div.style.top = DIV_TOUCH_POS_X + "px";
      div.style.left = DIV_TOUCH_POS_Y + "px";
      div.style.zIndex = DIV_TOUCH_ZINDEX.toString();
      this.div = div;
      this.pool = [];
      this.renderId = 0;
      this.debug = false;
      this.renderer = renderer;
      this.children = [];
      this._onKeyDown = this._onKeyDown.bind(this);
      this._onMouseMove = this._onMouseMove.bind(this);
      this._isActive = false;
      this._isMobileAccessibility = false;
      this.androidUpdateCount = 0;
      this.androidUpdateFrequency = 500;
      window.addEventListener("keydown", this._onKeyDown, false);
    }
    Object.defineProperty(AccessibilityManager2.prototype, "isActive", {
      get: function() {
        return this._isActive;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AccessibilityManager2.prototype, "isMobileAccessibility", {
      get: function() {
        return this._isMobileAccessibility;
      },
      enumerable: false,
      configurable: true
    });
    AccessibilityManager2.prototype.createTouchHook = function() {
      var _this = this;
      var hookDiv = document.createElement("button");
      hookDiv.style.width = DIV_HOOK_SIZE + "px";
      hookDiv.style.height = DIV_HOOK_SIZE + "px";
      hookDiv.style.position = "absolute";
      hookDiv.style.top = DIV_HOOK_POS_X + "px";
      hookDiv.style.left = DIV_HOOK_POS_Y + "px";
      hookDiv.style.zIndex = DIV_HOOK_ZINDEX.toString();
      hookDiv.style.backgroundColor = "#FF0000";
      hookDiv.title = "select to enable accessability for this content";
      hookDiv.addEventListener("focus", function() {
        _this._isMobileAccessibility = true;
        _this.activate();
        _this.destroyTouchHook();
      });
      document.body.appendChild(hookDiv);
      this._hookDiv = hookDiv;
    };
    AccessibilityManager2.prototype.destroyTouchHook = function() {
      if (!this._hookDiv) {
        return;
      }
      document.body.removeChild(this._hookDiv);
      this._hookDiv = null;
    };
    AccessibilityManager2.prototype.activate = function() {
      if (this._isActive) {
        return;
      }
      this._isActive = true;
      window.document.addEventListener("mousemove", this._onMouseMove, true);
      window.removeEventListener("keydown", this._onKeyDown, false);
      this.renderer.on("postrender", this.update, this);
      if (this.renderer.view.parentNode) {
        this.renderer.view.parentNode.appendChild(this.div);
      }
    };
    AccessibilityManager2.prototype.deactivate = function() {
      if (!this._isActive || this._isMobileAccessibility) {
        return;
      }
      this._isActive = false;
      window.document.removeEventListener("mousemove", this._onMouseMove, true);
      window.addEventListener("keydown", this._onKeyDown, false);
      this.renderer.off("postrender", this.update);
      if (this.div.parentNode) {
        this.div.parentNode.removeChild(this.div);
      }
    };
    AccessibilityManager2.prototype.updateAccessibleObjects = function(displayObject) {
      if (!displayObject.visible || !displayObject.accessibleChildren) {
        return;
      }
      if (displayObject.accessible && displayObject.interactive) {
        if (!displayObject._accessibleActive) {
          this.addChild(displayObject);
        }
        displayObject.renderId = this.renderId;
      }
      var children = displayObject.children;
      for (var i = 0; i < children.length; i++) {
        this.updateAccessibleObjects(children[i]);
      }
    };
    AccessibilityManager2.prototype.update = function() {
      var now = performance.now();
      if (isMobile2.android.device && now < this.androidUpdateCount) {
        return;
      }
      this.androidUpdateCount = now + this.androidUpdateFrequency;
      if (!this.renderer.renderingToScreen) {
        return;
      }
      if (this.renderer._lastObjectRendered) {
        this.updateAccessibleObjects(this.renderer._lastObjectRendered);
      }
      var rect = this.renderer.view.getBoundingClientRect();
      var resolution = this.renderer.resolution;
      var sx = rect.width / this.renderer.width * resolution;
      var sy = rect.height / this.renderer.height * resolution;
      var div = this.div;
      div.style.left = rect.left + "px";
      div.style.top = rect.top + "px";
      div.style.width = this.renderer.width + "px";
      div.style.height = this.renderer.height + "px";
      for (var i = 0; i < this.children.length; i++) {
        var child = this.children[i];
        if (child.renderId !== this.renderId) {
          child._accessibleActive = false;
          removeItems(this.children, i, 1);
          this.div.removeChild(child._accessibleDiv);
          this.pool.push(child._accessibleDiv);
          child._accessibleDiv = null;
          i--;
        } else {
          div = child._accessibleDiv;
          var hitArea = child.hitArea;
          var wt = child.worldTransform;
          if (child.hitArea) {
            div.style.left = (wt.tx + hitArea.x * wt.a) * sx + "px";
            div.style.top = (wt.ty + hitArea.y * wt.d) * sy + "px";
            div.style.width = hitArea.width * wt.a * sx + "px";
            div.style.height = hitArea.height * wt.d * sy + "px";
          } else {
            hitArea = child.getBounds();
            this.capHitArea(hitArea);
            div.style.left = hitArea.x * sx + "px";
            div.style.top = hitArea.y * sy + "px";
            div.style.width = hitArea.width * sx + "px";
            div.style.height = hitArea.height * sy + "px";
            if (div.title !== child.accessibleTitle && child.accessibleTitle !== null) {
              div.title = child.accessibleTitle;
            }
            if (div.getAttribute("aria-label") !== child.accessibleHint && child.accessibleHint !== null) {
              div.setAttribute("aria-label", child.accessibleHint);
            }
          }
          if (child.accessibleTitle !== div.title || child.tabIndex !== div.tabIndex) {
            div.title = child.accessibleTitle;
            div.tabIndex = child.tabIndex;
            if (this.debug) {
              this.updateDebugHTML(div);
            }
          }
        }
      }
      this.renderId++;
    };
    AccessibilityManager2.prototype.updateDebugHTML = function(div) {
      div.innerHTML = "type: " + div.type + "</br> title : " + div.title + "</br> tabIndex: " + div.tabIndex;
    };
    AccessibilityManager2.prototype.capHitArea = function(hitArea) {
      if (hitArea.x < 0) {
        hitArea.width += hitArea.x;
        hitArea.x = 0;
      }
      if (hitArea.y < 0) {
        hitArea.height += hitArea.y;
        hitArea.y = 0;
      }
      if (hitArea.x + hitArea.width > this.renderer.width) {
        hitArea.width = this.renderer.width - hitArea.x;
      }
      if (hitArea.y + hitArea.height > this.renderer.height) {
        hitArea.height = this.renderer.height - hitArea.y;
      }
    };
    AccessibilityManager2.prototype.addChild = function(displayObject) {
      var div = this.pool.pop();
      if (!div) {
        div = document.createElement("button");
        div.style.width = DIV_TOUCH_SIZE + "px";
        div.style.height = DIV_TOUCH_SIZE + "px";
        div.style.backgroundColor = this.debug ? "rgba(255,255,255,0.5)" : "transparent";
        div.style.position = "absolute";
        div.style.zIndex = DIV_TOUCH_ZINDEX.toString();
        div.style.borderStyle = "none";
        if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
          div.setAttribute("aria-live", "off");
        } else {
          div.setAttribute("aria-live", "polite");
        }
        if (navigator.userAgent.match(/rv:.*Gecko\//)) {
          div.setAttribute("aria-relevant", "additions");
        } else {
          div.setAttribute("aria-relevant", "text");
        }
        div.addEventListener("click", this._onClick.bind(this));
        div.addEventListener("focus", this._onFocus.bind(this));
        div.addEventListener("focusout", this._onFocusOut.bind(this));
      }
      div.style.pointerEvents = displayObject.accessiblePointerEvents;
      div.type = displayObject.accessibleType;
      if (displayObject.accessibleTitle && displayObject.accessibleTitle !== null) {
        div.title = displayObject.accessibleTitle;
      } else if (!displayObject.accessibleHint || displayObject.accessibleHint === null) {
        div.title = "displayObject " + displayObject.tabIndex;
      }
      if (displayObject.accessibleHint && displayObject.accessibleHint !== null) {
        div.setAttribute("aria-label", displayObject.accessibleHint);
      }
      if (this.debug) {
        this.updateDebugHTML(div);
      }
      displayObject._accessibleActive = true;
      displayObject._accessibleDiv = div;
      div.displayObject = displayObject;
      this.children.push(displayObject);
      this.div.appendChild(displayObject._accessibleDiv);
      displayObject._accessibleDiv.tabIndex = displayObject.tabIndex;
    };
    AccessibilityManager2.prototype._onClick = function(e) {
      var interactionManager = this.renderer.plugins.interaction;
      interactionManager.dispatchEvent(e.target.displayObject, "click", interactionManager.eventData);
      interactionManager.dispatchEvent(e.target.displayObject, "pointertap", interactionManager.eventData);
      interactionManager.dispatchEvent(e.target.displayObject, "tap", interactionManager.eventData);
    };
    AccessibilityManager2.prototype._onFocus = function(e) {
      if (!e.target.getAttribute("aria-live")) {
        e.target.setAttribute("aria-live", "assertive");
      }
      var interactionManager = this.renderer.plugins.interaction;
      interactionManager.dispatchEvent(e.target.displayObject, "mouseover", interactionManager.eventData);
    };
    AccessibilityManager2.prototype._onFocusOut = function(e) {
      if (!e.target.getAttribute("aria-live")) {
        e.target.setAttribute("aria-live", "polite");
      }
      var interactionManager = this.renderer.plugins.interaction;
      interactionManager.dispatchEvent(e.target.displayObject, "mouseout", interactionManager.eventData);
    };
    AccessibilityManager2.prototype._onKeyDown = function(e) {
      if (e.keyCode !== KEY_CODE_TAB) {
        return;
      }
      this.activate();
    };
    AccessibilityManager2.prototype._onMouseMove = function(e) {
      if (e.movementX === 0 && e.movementY === 0) {
        return;
      }
      this.deactivate();
    };
    AccessibilityManager2.prototype.destroy = function() {
      this.destroyTouchHook();
      this.div = null;
      window.document.removeEventListener("mousemove", this._onMouseMove, true);
      window.removeEventListener("keydown", this._onKeyDown);
      this.pool = null;
      this.children = null;
      this.renderer = null;
    };
    return AccessibilityManager2;
  }();

  // node_modules/@pixi/ticker/lib/ticker.es.js
  /*!
   * @pixi/ticker - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/ticker is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  settings.TARGET_FPMS = 0.06;
  var UPDATE_PRIORITY;
  (function(UPDATE_PRIORITY2) {
    UPDATE_PRIORITY2[UPDATE_PRIORITY2["INTERACTION"] = 50] = "INTERACTION";
    UPDATE_PRIORITY2[UPDATE_PRIORITY2["HIGH"] = 25] = "HIGH";
    UPDATE_PRIORITY2[UPDATE_PRIORITY2["NORMAL"] = 0] = "NORMAL";
    UPDATE_PRIORITY2[UPDATE_PRIORITY2["LOW"] = -25] = "LOW";
    UPDATE_PRIORITY2[UPDATE_PRIORITY2["UTILITY"] = -50] = "UTILITY";
  })(UPDATE_PRIORITY || (UPDATE_PRIORITY = {}));
  var TickerListener = function() {
    function TickerListener2(fn, context2, priority, once) {
      if (context2 === void 0) {
        context2 = null;
      }
      if (priority === void 0) {
        priority = 0;
      }
      if (once === void 0) {
        once = false;
      }
      this.fn = fn;
      this.context = context2;
      this.priority = priority;
      this.once = once;
      this.next = null;
      this.previous = null;
      this._destroyed = false;
    }
    TickerListener2.prototype.match = function(fn, context2) {
      if (context2 === void 0) {
        context2 = null;
      }
      return this.fn === fn && this.context === context2;
    };
    TickerListener2.prototype.emit = function(deltaTime) {
      if (this.fn) {
        if (this.context) {
          this.fn.call(this.context, deltaTime);
        } else {
          this.fn(deltaTime);
        }
      }
      var redirect = this.next;
      if (this.once) {
        this.destroy(true);
      }
      if (this._destroyed) {
        this.next = null;
      }
      return redirect;
    };
    TickerListener2.prototype.connect = function(previous) {
      this.previous = previous;
      if (previous.next) {
        previous.next.previous = this;
      }
      this.next = previous.next;
      previous.next = this;
    };
    TickerListener2.prototype.destroy = function(hard) {
      if (hard === void 0) {
        hard = false;
      }
      this._destroyed = true;
      this.fn = null;
      this.context = null;
      if (this.previous) {
        this.previous.next = this.next;
      }
      if (this.next) {
        this.next.previous = this.previous;
      }
      var redirect = this.next;
      this.next = hard ? null : redirect;
      this.previous = null;
      return redirect;
    };
    return TickerListener2;
  }();
  var Ticker = function() {
    function Ticker2() {
      var _this = this;
      this._head = new TickerListener(null, null, Infinity);
      this._requestId = null;
      this._maxElapsedMS = 100;
      this._minElapsedMS = 0;
      this.autoStart = false;
      this.deltaTime = 1;
      this.deltaMS = 1 / settings.TARGET_FPMS;
      this.elapsedMS = 1 / settings.TARGET_FPMS;
      this.lastTime = -1;
      this.speed = 1;
      this.started = false;
      this._protected = false;
      this._lastFrame = -1;
      this._tick = function(time) {
        _this._requestId = null;
        if (_this.started) {
          _this.update(time);
          if (_this.started && _this._requestId === null && _this._head.next) {
            _this._requestId = requestAnimationFrame(_this._tick);
          }
        }
      };
    }
    Ticker2.prototype._requestIfNeeded = function() {
      if (this._requestId === null && this._head.next) {
        this.lastTime = performance.now();
        this._lastFrame = this.lastTime;
        this._requestId = requestAnimationFrame(this._tick);
      }
    };
    Ticker2.prototype._cancelIfNeeded = function() {
      if (this._requestId !== null) {
        cancelAnimationFrame(this._requestId);
        this._requestId = null;
      }
    };
    Ticker2.prototype._startIfPossible = function() {
      if (this.started) {
        this._requestIfNeeded();
      } else if (this.autoStart) {
        this.start();
      }
    };
    Ticker2.prototype.add = function(fn, context2, priority) {
      if (priority === void 0) {
        priority = UPDATE_PRIORITY.NORMAL;
      }
      return this._addListener(new TickerListener(fn, context2, priority));
    };
    Ticker2.prototype.addOnce = function(fn, context2, priority) {
      if (priority === void 0) {
        priority = UPDATE_PRIORITY.NORMAL;
      }
      return this._addListener(new TickerListener(fn, context2, priority, true));
    };
    Ticker2.prototype._addListener = function(listener) {
      var current = this._head.next;
      var previous = this._head;
      if (!current) {
        listener.connect(previous);
      } else {
        while (current) {
          if (listener.priority > current.priority) {
            listener.connect(previous);
            break;
          }
          previous = current;
          current = current.next;
        }
        if (!listener.previous) {
          listener.connect(previous);
        }
      }
      this._startIfPossible();
      return this;
    };
    Ticker2.prototype.remove = function(fn, context2) {
      var listener = this._head.next;
      while (listener) {
        if (listener.match(fn, context2)) {
          listener = listener.destroy();
        } else {
          listener = listener.next;
        }
      }
      if (!this._head.next) {
        this._cancelIfNeeded();
      }
      return this;
    };
    Object.defineProperty(Ticker2.prototype, "count", {
      get: function() {
        if (!this._head) {
          return 0;
        }
        var count = 0;
        var current = this._head;
        while (current = current.next) {
          count++;
        }
        return count;
      },
      enumerable: false,
      configurable: true
    });
    Ticker2.prototype.start = function() {
      if (!this.started) {
        this.started = true;
        this._requestIfNeeded();
      }
    };
    Ticker2.prototype.stop = function() {
      if (this.started) {
        this.started = false;
        this._cancelIfNeeded();
      }
    };
    Ticker2.prototype.destroy = function() {
      if (!this._protected) {
        this.stop();
        var listener = this._head.next;
        while (listener) {
          listener = listener.destroy(true);
        }
        this._head.destroy();
        this._head = null;
      }
    };
    Ticker2.prototype.update = function(currentTime) {
      if (currentTime === void 0) {
        currentTime = performance.now();
      }
      var elapsedMS;
      if (currentTime > this.lastTime) {
        elapsedMS = this.elapsedMS = currentTime - this.lastTime;
        if (elapsedMS > this._maxElapsedMS) {
          elapsedMS = this._maxElapsedMS;
        }
        elapsedMS *= this.speed;
        if (this._minElapsedMS) {
          var delta = currentTime - this._lastFrame | 0;
          if (delta < this._minElapsedMS) {
            return;
          }
          this._lastFrame = currentTime - delta % this._minElapsedMS;
        }
        this.deltaMS = elapsedMS;
        this.deltaTime = this.deltaMS * settings.TARGET_FPMS;
        var head = this._head;
        var listener = head.next;
        while (listener) {
          listener = listener.emit(this.deltaTime);
        }
        if (!head.next) {
          this._cancelIfNeeded();
        }
      } else {
        this.deltaTime = this.deltaMS = this.elapsedMS = 0;
      }
      this.lastTime = currentTime;
    };
    Object.defineProperty(Ticker2.prototype, "FPS", {
      get: function() {
        return 1e3 / this.elapsedMS;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Ticker2.prototype, "minFPS", {
      get: function() {
        return 1e3 / this._maxElapsedMS;
      },
      set: function(fps) {
        var minFPS = Math.min(this.maxFPS, fps);
        var minFPMS = Math.min(Math.max(0, minFPS) / 1e3, settings.TARGET_FPMS);
        this._maxElapsedMS = 1 / minFPMS;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Ticker2.prototype, "maxFPS", {
      get: function() {
        if (this._minElapsedMS) {
          return Math.round(1e3 / this._minElapsedMS);
        }
        return 0;
      },
      set: function(fps) {
        if (fps === 0) {
          this._minElapsedMS = 0;
        } else {
          var maxFPS = Math.max(this.minFPS, fps);
          this._minElapsedMS = 1 / (maxFPS / 1e3);
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Ticker2, "shared", {
      get: function() {
        if (!Ticker2._shared) {
          var shared = Ticker2._shared = new Ticker2();
          shared.autoStart = true;
          shared._protected = true;
        }
        return Ticker2._shared;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Ticker2, "system", {
      get: function() {
        if (!Ticker2._system) {
          var system = Ticker2._system = new Ticker2();
          system.autoStart = true;
          system._protected = true;
        }
        return Ticker2._system;
      },
      enumerable: false,
      configurable: true
    });
    return Ticker2;
  }();
  var TickerPlugin = function() {
    function TickerPlugin2() {
    }
    TickerPlugin2.init = function(options) {
      var _this = this;
      options = Object.assign({
        autoStart: true,
        sharedTicker: false
      }, options);
      Object.defineProperty(this, "ticker", {
        set: function(ticker) {
          if (this._ticker) {
            this._ticker.remove(this.render, this);
          }
          this._ticker = ticker;
          if (ticker) {
            ticker.add(this.render, this, UPDATE_PRIORITY.LOW);
          }
        },
        get: function() {
          return this._ticker;
        }
      });
      this.stop = function() {
        _this._ticker.stop();
      };
      this.start = function() {
        _this._ticker.start();
      };
      this._ticker = null;
      this.ticker = options.sharedTicker ? Ticker.shared : new Ticker();
      if (options.autoStart) {
        this.start();
      }
    };
    TickerPlugin2.destroy = function() {
      if (this._ticker) {
        var oldTicker = this._ticker;
        this.ticker = null;
        oldTicker.destroy();
      }
    };
    return TickerPlugin2;
  }();

  // node_modules/@pixi/interaction/lib/interaction.es.js
  /*!
   * @pixi/interaction - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/interaction is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var InteractionData = function() {
    function InteractionData2() {
      this.pressure = 0;
      this.rotationAngle = 0;
      this.twist = 0;
      this.tangentialPressure = 0;
      this.global = new Point();
      this.target = null;
      this.originalEvent = null;
      this.identifier = null;
      this.isPrimary = false;
      this.button = 0;
      this.buttons = 0;
      this.width = 0;
      this.height = 0;
      this.tiltX = 0;
      this.tiltY = 0;
      this.pointerType = null;
      this.pressure = 0;
      this.rotationAngle = 0;
      this.twist = 0;
      this.tangentialPressure = 0;
    }
    Object.defineProperty(InteractionData2.prototype, "pointerId", {
      get: function() {
        return this.identifier;
      },
      enumerable: false,
      configurable: true
    });
    InteractionData2.prototype.getLocalPosition = function(displayObject, point, globalPos) {
      return displayObject.worldTransform.applyInverse(globalPos || this.global, point);
    };
    InteractionData2.prototype.copyEvent = function(event) {
      if ("isPrimary" in event && event.isPrimary) {
        this.isPrimary = true;
      }
      this.button = "button" in event && event.button;
      var buttons = "buttons" in event && event.buttons;
      this.buttons = Number.isInteger(buttons) ? buttons : "which" in event && event.which;
      this.width = "width" in event && event.width;
      this.height = "height" in event && event.height;
      this.tiltX = "tiltX" in event && event.tiltX;
      this.tiltY = "tiltY" in event && event.tiltY;
      this.pointerType = "pointerType" in event && event.pointerType;
      this.pressure = "pressure" in event && event.pressure;
      this.rotationAngle = "rotationAngle" in event && event.rotationAngle;
      this.twist = "twist" in event && event.twist || 0;
      this.tangentialPressure = "tangentialPressure" in event && event.tangentialPressure || 0;
    };
    InteractionData2.prototype.reset = function() {
      this.isPrimary = false;
    };
    return InteractionData2;
  }();
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics2 = function(d, b) {
    extendStatics2 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics2(d, b);
  };
  function __extends2(d, b) {
    extendStatics2(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var InteractionEvent = function() {
    function InteractionEvent2() {
      this.stopped = false;
      this.stopsPropagatingAt = null;
      this.stopPropagationHint = false;
      this.target = null;
      this.currentTarget = null;
      this.type = null;
      this.data = null;
    }
    InteractionEvent2.prototype.stopPropagation = function() {
      this.stopped = true;
      this.stopPropagationHint = true;
      this.stopsPropagatingAt = this.currentTarget;
    };
    InteractionEvent2.prototype.reset = function() {
      this.stopped = false;
      this.stopsPropagatingAt = null;
      this.stopPropagationHint = false;
      this.currentTarget = null;
      this.target = null;
    };
    return InteractionEvent2;
  }();
  var InteractionTrackingData = function() {
    function InteractionTrackingData2(pointerId) {
      this._pointerId = pointerId;
      this._flags = InteractionTrackingData2.FLAGS.NONE;
    }
    InteractionTrackingData2.prototype._doSet = function(flag, yn) {
      if (yn) {
        this._flags = this._flags | flag;
      } else {
        this._flags = this._flags & ~flag;
      }
    };
    Object.defineProperty(InteractionTrackingData2.prototype, "pointerId", {
      get: function() {
        return this._pointerId;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionTrackingData2.prototype, "flags", {
      get: function() {
        return this._flags;
      },
      set: function(flags) {
        this._flags = flags;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionTrackingData2.prototype, "none", {
      get: function() {
        return this._flags === InteractionTrackingData2.FLAGS.NONE;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionTrackingData2.prototype, "over", {
      get: function() {
        return (this._flags & InteractionTrackingData2.FLAGS.OVER) !== 0;
      },
      set: function(yn) {
        this._doSet(InteractionTrackingData2.FLAGS.OVER, yn);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionTrackingData2.prototype, "rightDown", {
      get: function() {
        return (this._flags & InteractionTrackingData2.FLAGS.RIGHT_DOWN) !== 0;
      },
      set: function(yn) {
        this._doSet(InteractionTrackingData2.FLAGS.RIGHT_DOWN, yn);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionTrackingData2.prototype, "leftDown", {
      get: function() {
        return (this._flags & InteractionTrackingData2.FLAGS.LEFT_DOWN) !== 0;
      },
      set: function(yn) {
        this._doSet(InteractionTrackingData2.FLAGS.LEFT_DOWN, yn);
      },
      enumerable: false,
      configurable: true
    });
    InteractionTrackingData2.FLAGS = Object.freeze({
      NONE: 0,
      OVER: 1 << 0,
      LEFT_DOWN: 1 << 1,
      RIGHT_DOWN: 1 << 2
    });
    return InteractionTrackingData2;
  }();
  var TreeSearch = function() {
    function TreeSearch2() {
      this._tempPoint = new Point();
    }
    TreeSearch2.prototype.recursiveFindHit = function(interactionEvent, displayObject, func, hitTest, interactive) {
      if (!displayObject || !displayObject.visible) {
        return false;
      }
      var point = interactionEvent.data.global;
      interactive = displayObject.interactive || interactive;
      var hit = false;
      var interactiveParent = interactive;
      var hitTestChildren = true;
      if (displayObject.hitArea) {
        if (hitTest) {
          displayObject.worldTransform.applyInverse(point, this._tempPoint);
          if (!displayObject.hitArea.contains(this._tempPoint.x, this._tempPoint.y)) {
            hitTest = false;
            hitTestChildren = false;
          } else {
            hit = true;
          }
        }
        interactiveParent = false;
      } else if (displayObject._mask) {
        if (hitTest) {
          if (!(displayObject._mask.containsPoint && displayObject._mask.containsPoint(point))) {
            hitTest = false;
          }
        }
      }
      if (hitTestChildren && displayObject.interactiveChildren && displayObject.children) {
        var children = displayObject.children;
        for (var i = children.length - 1; i >= 0; i--) {
          var child = children[i];
          var childHit = this.recursiveFindHit(interactionEvent, child, func, hitTest, interactiveParent);
          if (childHit) {
            if (!child.parent) {
              continue;
            }
            interactiveParent = false;
            if (childHit) {
              if (interactionEvent.target) {
                hitTest = false;
              }
              hit = true;
            }
          }
        }
      }
      if (interactive) {
        if (hitTest && !interactionEvent.target) {
          if (!displayObject.hitArea && displayObject.containsPoint) {
            if (displayObject.containsPoint(point)) {
              hit = true;
            }
          }
        }
        if (displayObject.interactive) {
          if (hit && !interactionEvent.target) {
            interactionEvent.target = displayObject;
          }
          if (func) {
            func(interactionEvent, displayObject, !!hit);
          }
        }
      }
      return hit;
    };
    TreeSearch2.prototype.findHit = function(interactionEvent, displayObject, func, hitTest) {
      this.recursiveFindHit(interactionEvent, displayObject, func, hitTest, false);
    };
    return TreeSearch2;
  }();
  var interactiveTarget = {
    interactive: false,
    interactiveChildren: true,
    hitArea: null,
    get buttonMode() {
      return this.cursor === "pointer";
    },
    set buttonMode(value) {
      if (value) {
        this.cursor = "pointer";
      } else if (this.cursor === "pointer") {
        this.cursor = null;
      }
    },
    cursor: null,
    get trackedPointers() {
      if (this._trackedPointers === void 0) {
        this._trackedPointers = {};
      }
      return this._trackedPointers;
    },
    _trackedPointers: void 0
  };
  DisplayObject.mixin(interactiveTarget);
  var MOUSE_POINTER_ID = 1;
  var hitTestEvent = {
    target: null,
    data: {
      global: null
    }
  };
  var InteractionManager = function(_super) {
    __extends2(InteractionManager2, _super);
    function InteractionManager2(renderer, options) {
      var _this = _super.call(this) || this;
      options = options || {};
      _this.renderer = renderer;
      _this.autoPreventDefault = options.autoPreventDefault !== void 0 ? options.autoPreventDefault : true;
      _this.interactionFrequency = options.interactionFrequency || 10;
      _this.mouse = new InteractionData();
      _this.mouse.identifier = MOUSE_POINTER_ID;
      _this.mouse.global.set(-999999);
      _this.activeInteractionData = {};
      _this.activeInteractionData[MOUSE_POINTER_ID] = _this.mouse;
      _this.interactionDataPool = [];
      _this.eventData = new InteractionEvent();
      _this.interactionDOMElement = null;
      _this.moveWhenInside = false;
      _this.eventsAdded = false;
      _this.tickerAdded = false;
      _this.mouseOverRenderer = false;
      _this.supportsTouchEvents = "ontouchstart" in window;
      _this.supportsPointerEvents = !!window.PointerEvent;
      _this.onPointerUp = _this.onPointerUp.bind(_this);
      _this.processPointerUp = _this.processPointerUp.bind(_this);
      _this.onPointerCancel = _this.onPointerCancel.bind(_this);
      _this.processPointerCancel = _this.processPointerCancel.bind(_this);
      _this.onPointerDown = _this.onPointerDown.bind(_this);
      _this.processPointerDown = _this.processPointerDown.bind(_this);
      _this.onPointerMove = _this.onPointerMove.bind(_this);
      _this.processPointerMove = _this.processPointerMove.bind(_this);
      _this.onPointerOut = _this.onPointerOut.bind(_this);
      _this.processPointerOverOut = _this.processPointerOverOut.bind(_this);
      _this.onPointerOver = _this.onPointerOver.bind(_this);
      _this.cursorStyles = {
        default: "inherit",
        pointer: "pointer"
      };
      _this.currentCursorMode = null;
      _this.cursor = null;
      _this.resolution = 1;
      _this.delayedEvents = [];
      _this.search = new TreeSearch();
      _this._tempDisplayObject = new TemporaryDisplayObject();
      _this._useSystemTicker = options.useSystemTicker !== void 0 ? options.useSystemTicker : true;
      _this.setTargetElement(_this.renderer.view, _this.renderer.resolution);
      return _this;
    }
    Object.defineProperty(InteractionManager2.prototype, "useSystemTicker", {
      get: function() {
        return this._useSystemTicker;
      },
      set: function(useSystemTicker) {
        this._useSystemTicker = useSystemTicker;
        if (useSystemTicker) {
          this.addTickerListener();
        } else {
          this.removeTickerListener();
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(InteractionManager2.prototype, "lastObjectRendered", {
      get: function() {
        return this.renderer._lastObjectRendered || this._tempDisplayObject;
      },
      enumerable: false,
      configurable: true
    });
    InteractionManager2.prototype.hitTest = function(globalPoint, root) {
      hitTestEvent.target = null;
      hitTestEvent.data.global = globalPoint;
      if (!root) {
        root = this.lastObjectRendered;
      }
      this.processInteractive(hitTestEvent, root, null, true);
      return hitTestEvent.target;
    };
    InteractionManager2.prototype.setTargetElement = function(element, resolution) {
      if (resolution === void 0) {
        resolution = 1;
      }
      this.removeTickerListener();
      this.removeEvents();
      this.interactionDOMElement = element;
      this.resolution = resolution;
      this.addEvents();
      this.addTickerListener();
    };
    InteractionManager2.prototype.addTickerListener = function() {
      if (this.tickerAdded || !this.interactionDOMElement || !this._useSystemTicker) {
        return;
      }
      Ticker.system.add(this.tickerUpdate, this, UPDATE_PRIORITY.INTERACTION);
      this.tickerAdded = true;
    };
    InteractionManager2.prototype.removeTickerListener = function() {
      if (!this.tickerAdded) {
        return;
      }
      Ticker.system.remove(this.tickerUpdate, this);
      this.tickerAdded = false;
    };
    InteractionManager2.prototype.addEvents = function() {
      if (this.eventsAdded || !this.interactionDOMElement) {
        return;
      }
      var style = this.interactionDOMElement.style;
      if (window.navigator.msPointerEnabled) {
        style.msContentZooming = "none";
        style.msTouchAction = "none";
      } else if (this.supportsPointerEvents) {
        style.touchAction = "none";
      }
      if (this.supportsPointerEvents) {
        window.document.addEventListener("pointermove", this.onPointerMove, true);
        this.interactionDOMElement.addEventListener("pointerdown", this.onPointerDown, true);
        this.interactionDOMElement.addEventListener("pointerleave", this.onPointerOut, true);
        this.interactionDOMElement.addEventListener("pointerover", this.onPointerOver, true);
        window.addEventListener("pointercancel", this.onPointerCancel, true);
        window.addEventListener("pointerup", this.onPointerUp, true);
      } else {
        window.document.addEventListener("mousemove", this.onPointerMove, true);
        this.interactionDOMElement.addEventListener("mousedown", this.onPointerDown, true);
        this.interactionDOMElement.addEventListener("mouseout", this.onPointerOut, true);
        this.interactionDOMElement.addEventListener("mouseover", this.onPointerOver, true);
        window.addEventListener("mouseup", this.onPointerUp, true);
      }
      if (this.supportsTouchEvents) {
        this.interactionDOMElement.addEventListener("touchstart", this.onPointerDown, true);
        this.interactionDOMElement.addEventListener("touchcancel", this.onPointerCancel, true);
        this.interactionDOMElement.addEventListener("touchend", this.onPointerUp, true);
        this.interactionDOMElement.addEventListener("touchmove", this.onPointerMove, true);
      }
      this.eventsAdded = true;
    };
    InteractionManager2.prototype.removeEvents = function() {
      if (!this.eventsAdded || !this.interactionDOMElement) {
        return;
      }
      var style = this.interactionDOMElement.style;
      if (window.navigator.msPointerEnabled) {
        style.msContentZooming = "";
        style.msTouchAction = "";
      } else if (this.supportsPointerEvents) {
        style.touchAction = "";
      }
      if (this.supportsPointerEvents) {
        window.document.removeEventListener("pointermove", this.onPointerMove, true);
        this.interactionDOMElement.removeEventListener("pointerdown", this.onPointerDown, true);
        this.interactionDOMElement.removeEventListener("pointerleave", this.onPointerOut, true);
        this.interactionDOMElement.removeEventListener("pointerover", this.onPointerOver, true);
        window.removeEventListener("pointercancel", this.onPointerCancel, true);
        window.removeEventListener("pointerup", this.onPointerUp, true);
      } else {
        window.document.removeEventListener("mousemove", this.onPointerMove, true);
        this.interactionDOMElement.removeEventListener("mousedown", this.onPointerDown, true);
        this.interactionDOMElement.removeEventListener("mouseout", this.onPointerOut, true);
        this.interactionDOMElement.removeEventListener("mouseover", this.onPointerOver, true);
        window.removeEventListener("mouseup", this.onPointerUp, true);
      }
      if (this.supportsTouchEvents) {
        this.interactionDOMElement.removeEventListener("touchstart", this.onPointerDown, true);
        this.interactionDOMElement.removeEventListener("touchcancel", this.onPointerCancel, true);
        this.interactionDOMElement.removeEventListener("touchend", this.onPointerUp, true);
        this.interactionDOMElement.removeEventListener("touchmove", this.onPointerMove, true);
      }
      this.interactionDOMElement = null;
      this.eventsAdded = false;
    };
    InteractionManager2.prototype.tickerUpdate = function(deltaTime) {
      this._deltaTime += deltaTime;
      if (this._deltaTime < this.interactionFrequency) {
        return;
      }
      this._deltaTime = 0;
      this.update();
    };
    InteractionManager2.prototype.update = function() {
      if (!this.interactionDOMElement) {
        return;
      }
      if (this._didMove) {
        this._didMove = false;
        return;
      }
      this.cursor = null;
      for (var k in this.activeInteractionData) {
        if (this.activeInteractionData.hasOwnProperty(k)) {
          var interactionData = this.activeInteractionData[k];
          if (interactionData.originalEvent && interactionData.pointerType !== "touch") {
            var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, interactionData.originalEvent, interactionData);
            this.processInteractive(interactionEvent, this.lastObjectRendered, this.processPointerOverOut, true);
          }
        }
      }
      this.setCursorMode(this.cursor);
    };
    InteractionManager2.prototype.setCursorMode = function(mode) {
      mode = mode || "default";
      if (this.currentCursorMode === mode) {
        return;
      }
      this.currentCursorMode = mode;
      var style = this.cursorStyles[mode];
      if (style) {
        switch (typeof style) {
          case "string":
            this.interactionDOMElement.style.cursor = style;
            break;
          case "function":
            style(mode);
            break;
          case "object":
            Object.assign(this.interactionDOMElement.style, style);
            break;
        }
      } else if (typeof mode === "string" && !Object.prototype.hasOwnProperty.call(this.cursorStyles, mode)) {
        this.interactionDOMElement.style.cursor = mode;
      }
    };
    InteractionManager2.prototype.dispatchEvent = function(displayObject, eventString, eventData) {
      if (!eventData.stopPropagationHint || displayObject === eventData.stopsPropagatingAt) {
        eventData.currentTarget = displayObject;
        eventData.type = eventString;
        displayObject.emit(eventString, eventData);
        if (displayObject[eventString]) {
          displayObject[eventString](eventData);
        }
      }
    };
    InteractionManager2.prototype.delayDispatchEvent = function(displayObject, eventString, eventData) {
      this.delayedEvents.push({displayObject, eventString, eventData});
    };
    InteractionManager2.prototype.mapPositionToPoint = function(point, x, y) {
      var rect;
      if (!this.interactionDOMElement.parentElement) {
        rect = {x: 0, y: 0, width: 0, height: 0};
      } else {
        rect = this.interactionDOMElement.getBoundingClientRect();
      }
      var resolutionMultiplier = 1 / this.resolution;
      point.x = (x - rect.left) * (this.interactionDOMElement.width / rect.width) * resolutionMultiplier;
      point.y = (y - rect.top) * (this.interactionDOMElement.height / rect.height) * resolutionMultiplier;
    };
    InteractionManager2.prototype.processInteractive = function(interactionEvent, displayObject, func, hitTest) {
      var hit = this.search.findHit(interactionEvent, displayObject, func, hitTest);
      var delayedEvents = this.delayedEvents;
      if (!delayedEvents.length) {
        return hit;
      }
      interactionEvent.stopPropagationHint = false;
      var delayedLen = delayedEvents.length;
      this.delayedEvents = [];
      for (var i = 0; i < delayedLen; i++) {
        var _a2 = delayedEvents[i], displayObject_1 = _a2.displayObject, eventString = _a2.eventString, eventData = _a2.eventData;
        if (eventData.stopsPropagatingAt === displayObject_1) {
          eventData.stopPropagationHint = true;
        }
        this.dispatchEvent(displayObject_1, eventString, eventData);
      }
      return hit;
    };
    InteractionManager2.prototype.onPointerDown = function(originalEvent) {
      if (this.supportsTouchEvents && originalEvent.pointerType === "touch") {
        return;
      }
      var events = this.normalizeToPointerData(originalEvent);
      if (this.autoPreventDefault && events[0].isNormalized) {
        var cancelable = originalEvent.cancelable || !("cancelable" in originalEvent);
        if (cancelable) {
          originalEvent.preventDefault();
        }
      }
      var eventLen = events.length;
      for (var i = 0; i < eventLen; i++) {
        var event = events[i];
        var interactionData = this.getInteractionDataForPointerId(event);
        var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);
        interactionEvent.data.originalEvent = originalEvent;
        this.processInteractive(interactionEvent, this.lastObjectRendered, this.processPointerDown, true);
        this.emit("pointerdown", interactionEvent);
        if (event.pointerType === "touch") {
          this.emit("touchstart", interactionEvent);
        } else if (event.pointerType === "mouse" || event.pointerType === "pen") {
          var isRightButton = event.button === 2;
          this.emit(isRightButton ? "rightdown" : "mousedown", this.eventData);
        }
      }
    };
    InteractionManager2.prototype.processPointerDown = function(interactionEvent, displayObject, hit) {
      var data = interactionEvent.data;
      var id = interactionEvent.data.identifier;
      if (hit) {
        if (!displayObject.trackedPointers[id]) {
          displayObject.trackedPointers[id] = new InteractionTrackingData(id);
        }
        this.dispatchEvent(displayObject, "pointerdown", interactionEvent);
        if (data.pointerType === "touch") {
          this.dispatchEvent(displayObject, "touchstart", interactionEvent);
        } else if (data.pointerType === "mouse" || data.pointerType === "pen") {
          var isRightButton = data.button === 2;
          if (isRightButton) {
            displayObject.trackedPointers[id].rightDown = true;
          } else {
            displayObject.trackedPointers[id].leftDown = true;
          }
          this.dispatchEvent(displayObject, isRightButton ? "rightdown" : "mousedown", interactionEvent);
        }
      }
    };
    InteractionManager2.prototype.onPointerComplete = function(originalEvent, cancelled, func) {
      var events = this.normalizeToPointerData(originalEvent);
      var eventLen = events.length;
      var eventAppend = originalEvent.target !== this.interactionDOMElement ? "outside" : "";
      for (var i = 0; i < eventLen; i++) {
        var event = events[i];
        var interactionData = this.getInteractionDataForPointerId(event);
        var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);
        interactionEvent.data.originalEvent = originalEvent;
        this.processInteractive(interactionEvent, this.lastObjectRendered, func, cancelled || !eventAppend);
        this.emit(cancelled ? "pointercancel" : "pointerup" + eventAppend, interactionEvent);
        if (event.pointerType === "mouse" || event.pointerType === "pen") {
          var isRightButton = event.button === 2;
          this.emit(isRightButton ? "rightup" + eventAppend : "mouseup" + eventAppend, interactionEvent);
        } else if (event.pointerType === "touch") {
          this.emit(cancelled ? "touchcancel" : "touchend" + eventAppend, interactionEvent);
          this.releaseInteractionDataForPointerId(event.pointerId);
        }
      }
    };
    InteractionManager2.prototype.onPointerCancel = function(event) {
      if (this.supportsTouchEvents && event.pointerType === "touch") {
        return;
      }
      this.onPointerComplete(event, true, this.processPointerCancel);
    };
    InteractionManager2.prototype.processPointerCancel = function(interactionEvent, displayObject) {
      var data = interactionEvent.data;
      var id = interactionEvent.data.identifier;
      if (displayObject.trackedPointers[id] !== void 0) {
        delete displayObject.trackedPointers[id];
        this.dispatchEvent(displayObject, "pointercancel", interactionEvent);
        if (data.pointerType === "touch") {
          this.dispatchEvent(displayObject, "touchcancel", interactionEvent);
        }
      }
    };
    InteractionManager2.prototype.onPointerUp = function(event) {
      if (this.supportsTouchEvents && event.pointerType === "touch") {
        return;
      }
      this.onPointerComplete(event, false, this.processPointerUp);
    };
    InteractionManager2.prototype.processPointerUp = function(interactionEvent, displayObject, hit) {
      var data = interactionEvent.data;
      var id = interactionEvent.data.identifier;
      var trackingData = displayObject.trackedPointers[id];
      var isTouch = data.pointerType === "touch";
      var isMouse = data.pointerType === "mouse" || data.pointerType === "pen";
      var isMouseTap = false;
      if (isMouse) {
        var isRightButton = data.button === 2;
        var flags = InteractionTrackingData.FLAGS;
        var test = isRightButton ? flags.RIGHT_DOWN : flags.LEFT_DOWN;
        var isDown = trackingData !== void 0 && trackingData.flags & test;
        if (hit) {
          this.dispatchEvent(displayObject, isRightButton ? "rightup" : "mouseup", interactionEvent);
          if (isDown) {
            this.dispatchEvent(displayObject, isRightButton ? "rightclick" : "click", interactionEvent);
            isMouseTap = true;
          }
        } else if (isDown) {
          this.dispatchEvent(displayObject, isRightButton ? "rightupoutside" : "mouseupoutside", interactionEvent);
        }
        if (trackingData) {
          if (isRightButton) {
            trackingData.rightDown = false;
          } else {
            trackingData.leftDown = false;
          }
        }
      }
      if (hit) {
        this.dispatchEvent(displayObject, "pointerup", interactionEvent);
        if (isTouch) {
          this.dispatchEvent(displayObject, "touchend", interactionEvent);
        }
        if (trackingData) {
          if (!isMouse || isMouseTap) {
            this.dispatchEvent(displayObject, "pointertap", interactionEvent);
          }
          if (isTouch) {
            this.dispatchEvent(displayObject, "tap", interactionEvent);
            trackingData.over = false;
          }
        }
      } else if (trackingData) {
        this.dispatchEvent(displayObject, "pointerupoutside", interactionEvent);
        if (isTouch) {
          this.dispatchEvent(displayObject, "touchendoutside", interactionEvent);
        }
      }
      if (trackingData && trackingData.none) {
        delete displayObject.trackedPointers[id];
      }
    };
    InteractionManager2.prototype.onPointerMove = function(originalEvent) {
      if (this.supportsTouchEvents && originalEvent.pointerType === "touch") {
        return;
      }
      var events = this.normalizeToPointerData(originalEvent);
      if (events[0].pointerType === "mouse" || events[0].pointerType === "pen") {
        this._didMove = true;
        this.cursor = null;
      }
      var eventLen = events.length;
      for (var i = 0; i < eventLen; i++) {
        var event = events[i];
        var interactionData = this.getInteractionDataForPointerId(event);
        var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);
        interactionEvent.data.originalEvent = originalEvent;
        this.processInteractive(interactionEvent, this.lastObjectRendered, this.processPointerMove, true);
        this.emit("pointermove", interactionEvent);
        if (event.pointerType === "touch") {
          this.emit("touchmove", interactionEvent);
        }
        if (event.pointerType === "mouse" || event.pointerType === "pen") {
          this.emit("mousemove", interactionEvent);
        }
      }
      if (events[0].pointerType === "mouse") {
        this.setCursorMode(this.cursor);
      }
    };
    InteractionManager2.prototype.processPointerMove = function(interactionEvent, displayObject, hit) {
      var data = interactionEvent.data;
      var isTouch = data.pointerType === "touch";
      var isMouse = data.pointerType === "mouse" || data.pointerType === "pen";
      if (isMouse) {
        this.processPointerOverOut(interactionEvent, displayObject, hit);
      }
      if (!this.moveWhenInside || hit) {
        this.dispatchEvent(displayObject, "pointermove", interactionEvent);
        if (isTouch) {
          this.dispatchEvent(displayObject, "touchmove", interactionEvent);
        }
        if (isMouse) {
          this.dispatchEvent(displayObject, "mousemove", interactionEvent);
        }
      }
    };
    InteractionManager2.prototype.onPointerOut = function(originalEvent) {
      if (this.supportsTouchEvents && originalEvent.pointerType === "touch") {
        return;
      }
      var events = this.normalizeToPointerData(originalEvent);
      var event = events[0];
      if (event.pointerType === "mouse") {
        this.mouseOverRenderer = false;
        this.setCursorMode(null);
      }
      var interactionData = this.getInteractionDataForPointerId(event);
      var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);
      interactionEvent.data.originalEvent = event;
      this.processInteractive(interactionEvent, this.lastObjectRendered, this.processPointerOverOut, false);
      this.emit("pointerout", interactionEvent);
      if (event.pointerType === "mouse" || event.pointerType === "pen") {
        this.emit("mouseout", interactionEvent);
      } else {
        this.releaseInteractionDataForPointerId(interactionData.identifier);
      }
    };
    InteractionManager2.prototype.processPointerOverOut = function(interactionEvent, displayObject, hit) {
      var data = interactionEvent.data;
      var id = interactionEvent.data.identifier;
      var isMouse = data.pointerType === "mouse" || data.pointerType === "pen";
      var trackingData = displayObject.trackedPointers[id];
      if (hit && !trackingData) {
        trackingData = displayObject.trackedPointers[id] = new InteractionTrackingData(id);
      }
      if (trackingData === void 0) {
        return;
      }
      if (hit && this.mouseOverRenderer) {
        if (!trackingData.over) {
          trackingData.over = true;
          this.delayDispatchEvent(displayObject, "pointerover", interactionEvent);
          if (isMouse) {
            this.delayDispatchEvent(displayObject, "mouseover", interactionEvent);
          }
        }
        if (isMouse && this.cursor === null) {
          this.cursor = displayObject.cursor;
        }
      } else if (trackingData.over) {
        trackingData.over = false;
        this.dispatchEvent(displayObject, "pointerout", this.eventData);
        if (isMouse) {
          this.dispatchEvent(displayObject, "mouseout", interactionEvent);
        }
        if (trackingData.none) {
          delete displayObject.trackedPointers[id];
        }
      }
    };
    InteractionManager2.prototype.onPointerOver = function(originalEvent) {
      var events = this.normalizeToPointerData(originalEvent);
      var event = events[0];
      var interactionData = this.getInteractionDataForPointerId(event);
      var interactionEvent = this.configureInteractionEventForDOMEvent(this.eventData, event, interactionData);
      interactionEvent.data.originalEvent = event;
      if (event.pointerType === "mouse") {
        this.mouseOverRenderer = true;
      }
      this.emit("pointerover", interactionEvent);
      if (event.pointerType === "mouse" || event.pointerType === "pen") {
        this.emit("mouseover", interactionEvent);
      }
    };
    InteractionManager2.prototype.getInteractionDataForPointerId = function(event) {
      var pointerId = event.pointerId;
      var interactionData;
      if (pointerId === MOUSE_POINTER_ID || event.pointerType === "mouse") {
        interactionData = this.mouse;
      } else if (this.activeInteractionData[pointerId]) {
        interactionData = this.activeInteractionData[pointerId];
      } else {
        interactionData = this.interactionDataPool.pop() || new InteractionData();
        interactionData.identifier = pointerId;
        this.activeInteractionData[pointerId] = interactionData;
      }
      interactionData.copyEvent(event);
      return interactionData;
    };
    InteractionManager2.prototype.releaseInteractionDataForPointerId = function(pointerId) {
      var interactionData = this.activeInteractionData[pointerId];
      if (interactionData) {
        delete this.activeInteractionData[pointerId];
        interactionData.reset();
        this.interactionDataPool.push(interactionData);
      }
    };
    InteractionManager2.prototype.configureInteractionEventForDOMEvent = function(interactionEvent, pointerEvent, interactionData) {
      interactionEvent.data = interactionData;
      this.mapPositionToPoint(interactionData.global, pointerEvent.clientX, pointerEvent.clientY);
      if (pointerEvent.pointerType === "touch") {
        pointerEvent.globalX = interactionData.global.x;
        pointerEvent.globalY = interactionData.global.y;
      }
      interactionData.originalEvent = pointerEvent;
      interactionEvent.reset();
      return interactionEvent;
    };
    InteractionManager2.prototype.normalizeToPointerData = function(event) {
      var normalizedEvents = [];
      if (this.supportsTouchEvents && event instanceof TouchEvent) {
        for (var i = 0, li = event.changedTouches.length; i < li; i++) {
          var touch = event.changedTouches[i];
          if (typeof touch.button === "undefined") {
            touch.button = event.touches.length ? 1 : 0;
          }
          if (typeof touch.buttons === "undefined") {
            touch.buttons = event.touches.length ? 1 : 0;
          }
          if (typeof touch.isPrimary === "undefined") {
            touch.isPrimary = event.touches.length === 1 && event.type === "touchstart";
          }
          if (typeof touch.width === "undefined") {
            touch.width = touch.radiusX || 1;
          }
          if (typeof touch.height === "undefined") {
            touch.height = touch.radiusY || 1;
          }
          if (typeof touch.tiltX === "undefined") {
            touch.tiltX = 0;
          }
          if (typeof touch.tiltY === "undefined") {
            touch.tiltY = 0;
          }
          if (typeof touch.pointerType === "undefined") {
            touch.pointerType = "touch";
          }
          if (typeof touch.pointerId === "undefined") {
            touch.pointerId = touch.identifier || 0;
          }
          if (typeof touch.pressure === "undefined") {
            touch.pressure = touch.force || 0.5;
          }
          if (typeof touch.twist === "undefined") {
            touch.twist = 0;
          }
          if (typeof touch.tangentialPressure === "undefined") {
            touch.tangentialPressure = 0;
          }
          if (typeof touch.layerX === "undefined") {
            touch.layerX = touch.offsetX = touch.clientX;
          }
          if (typeof touch.layerY === "undefined") {
            touch.layerY = touch.offsetY = touch.clientY;
          }
          touch.isNormalized = true;
          normalizedEvents.push(touch);
        }
      } else if (event instanceof MouseEvent && (!this.supportsPointerEvents || !(event instanceof window.PointerEvent))) {
        var tempEvent = event;
        if (typeof tempEvent.isPrimary === "undefined") {
          tempEvent.isPrimary = true;
        }
        if (typeof tempEvent.width === "undefined") {
          tempEvent.width = 1;
        }
        if (typeof tempEvent.height === "undefined") {
          tempEvent.height = 1;
        }
        if (typeof tempEvent.tiltX === "undefined") {
          tempEvent.tiltX = 0;
        }
        if (typeof tempEvent.tiltY === "undefined") {
          tempEvent.tiltY = 0;
        }
        if (typeof tempEvent.pointerType === "undefined") {
          tempEvent.pointerType = "mouse";
        }
        if (typeof tempEvent.pointerId === "undefined") {
          tempEvent.pointerId = MOUSE_POINTER_ID;
        }
        if (typeof tempEvent.pressure === "undefined") {
          tempEvent.pressure = 0.5;
        }
        if (typeof tempEvent.twist === "undefined") {
          tempEvent.twist = 0;
        }
        if (typeof tempEvent.tangentialPressure === "undefined") {
          tempEvent.tangentialPressure = 0;
        }
        tempEvent.isNormalized = true;
        normalizedEvents.push(tempEvent);
      } else {
        normalizedEvents.push(event);
      }
      return normalizedEvents;
    };
    InteractionManager2.prototype.destroy = function() {
      this.removeEvents();
      this.removeTickerListener();
      this.removeAllListeners();
      this.renderer = null;
      this.mouse = null;
      this.eventData = null;
      this.interactionDOMElement = null;
      this.onPointerDown = null;
      this.processPointerDown = null;
      this.onPointerUp = null;
      this.processPointerUp = null;
      this.onPointerCancel = null;
      this.processPointerCancel = null;
      this.onPointerMove = null;
      this.processPointerMove = null;
      this.onPointerOut = null;
      this.processPointerOverOut = null;
      this.onPointerOver = null;
      this.search = null;
    };
    return InteractionManager2;
  }(import_eventemitter3.default);

  // node_modules/@pixi/runner/lib/runner.es.js
  /*!
   * @pixi/runner - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/runner is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var Runner = function() {
    function Runner2(name) {
      this.items = [];
      this._name = name;
      this._aliasCount = 0;
    }
    Runner2.prototype.emit = function(a0, a1, a2, a3, a4, a5, a6, a7) {
      if (arguments.length > 8) {
        throw new Error("max arguments reached");
      }
      var _a2 = this, name = _a2.name, items = _a2.items;
      this._aliasCount++;
      for (var i = 0, len = items.length; i < len; i++) {
        items[i][name](a0, a1, a2, a3, a4, a5, a6, a7);
      }
      if (items === this.items) {
        this._aliasCount--;
      }
      return this;
    };
    Runner2.prototype.ensureNonAliasedItems = function() {
      if (this._aliasCount > 0 && this.items.length > 1) {
        this._aliasCount = 0;
        this.items = this.items.slice(0);
      }
    };
    Runner2.prototype.add = function(item) {
      if (item[this._name]) {
        this.ensureNonAliasedItems();
        this.remove(item);
        this.items.push(item);
      }
      return this;
    };
    Runner2.prototype.remove = function(item) {
      var index2 = this.items.indexOf(item);
      if (index2 !== -1) {
        this.ensureNonAliasedItems();
        this.items.splice(index2, 1);
      }
      return this;
    };
    Runner2.prototype.contains = function(item) {
      return this.items.indexOf(item) !== -1;
    };
    Runner2.prototype.removeAll = function() {
      this.ensureNonAliasedItems();
      this.items.length = 0;
      return this;
    };
    Runner2.prototype.destroy = function() {
      this.removeAll();
      this.items = null;
      this._name = null;
    };
    Object.defineProperty(Runner2.prototype, "empty", {
      get: function() {
        return this.items.length === 0;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Runner2.prototype, "name", {
      get: function() {
        return this._name;
      },
      enumerable: false,
      configurable: true
    });
    return Runner2;
  }();
  Object.defineProperties(Runner.prototype, {
    dispatch: {value: Runner.prototype.emit},
    run: {value: Runner.prototype.emit}
  });

  // node_modules/@pixi/core/lib/core.es.js
  /*!
   * @pixi/core - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/core is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  settings.PREFER_ENV = isMobile2.any ? ENV.WEBGL : ENV.WEBGL2;
  settings.STRICT_TEXTURE_CACHE = false;
  var INSTALLED = [];
  function autoDetectResource(source, options) {
    if (!source) {
      return null;
    }
    var extension = "";
    if (typeof source === "string") {
      var result = /\.(\w{3,4})(?:$|\?|#)/i.exec(source);
      if (result) {
        extension = result[1].toLowerCase();
      }
    }
    for (var i = INSTALLED.length - 1; i >= 0; --i) {
      var ResourcePlugin = INSTALLED[i];
      if (ResourcePlugin.test && ResourcePlugin.test(source, extension)) {
        return new ResourcePlugin(source, options);
      }
    }
    throw new Error("Unrecognized source type to auto-detect Resource");
  }
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics3 = function(d, b) {
    extendStatics3 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics3(d, b);
  };
  function __extends3(d, b) {
    extendStatics3(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var Resource = function() {
    function Resource3(width, height) {
      if (width === void 0) {
        width = 0;
      }
      if (height === void 0) {
        height = 0;
      }
      this._width = width;
      this._height = height;
      this.destroyed = false;
      this.internal = false;
      this.onResize = new Runner("setRealSize");
      this.onUpdate = new Runner("update");
      this.onError = new Runner("onError");
    }
    Resource3.prototype.bind = function(baseTexture) {
      this.onResize.add(baseTexture);
      this.onUpdate.add(baseTexture);
      this.onError.add(baseTexture);
      if (this._width || this._height) {
        this.onResize.emit(this._width, this._height);
      }
    };
    Resource3.prototype.unbind = function(baseTexture) {
      this.onResize.remove(baseTexture);
      this.onUpdate.remove(baseTexture);
      this.onError.remove(baseTexture);
    };
    Resource3.prototype.resize = function(width, height) {
      if (width !== this._width || height !== this._height) {
        this._width = width;
        this._height = height;
        this.onResize.emit(width, height);
      }
    };
    Object.defineProperty(Resource3.prototype, "valid", {
      get: function() {
        return !!this._width && !!this._height;
      },
      enumerable: false,
      configurable: true
    });
    Resource3.prototype.update = function() {
      if (!this.destroyed) {
        this.onUpdate.emit();
      }
    };
    Resource3.prototype.load = function() {
      return Promise.resolve(this);
    };
    Object.defineProperty(Resource3.prototype, "width", {
      get: function() {
        return this._width;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Resource3.prototype, "height", {
      get: function() {
        return this._height;
      },
      enumerable: false,
      configurable: true
    });
    Resource3.prototype.style = function(_renderer, _baseTexture, _glTexture) {
      return false;
    };
    Resource3.prototype.dispose = function() {
    };
    Resource3.prototype.destroy = function() {
      if (!this.destroyed) {
        this.destroyed = true;
        this.dispose();
        this.onError.removeAll();
        this.onError = null;
        this.onResize.removeAll();
        this.onResize = null;
        this.onUpdate.removeAll();
        this.onUpdate = null;
      }
    };
    Resource3.test = function(_source, _extension) {
      return false;
    };
    return Resource3;
  }();
  var BufferResource = function(_super) {
    __extends3(BufferResource2, _super);
    function BufferResource2(source, options) {
      var _this = this;
      var _a2 = options || {}, width = _a2.width, height = _a2.height;
      if (!width || !height) {
        throw new Error("BufferResource width or height invalid");
      }
      _this = _super.call(this, width, height) || this;
      _this.data = source;
      return _this;
    }
    BufferResource2.prototype.upload = function(renderer, baseTexture, glTexture) {
      var gl = renderer.gl;
      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, baseTexture.alphaMode === ALPHA_MODES.UNPACK);
      if (glTexture.width === baseTexture.width && glTexture.height === baseTexture.height) {
        gl.texSubImage2D(baseTexture.target, 0, 0, 0, baseTexture.width, baseTexture.height, baseTexture.format, baseTexture.type, this.data);
      } else {
        glTexture.width = baseTexture.width;
        glTexture.height = baseTexture.height;
        gl.texImage2D(baseTexture.target, 0, glTexture.internalFormat, baseTexture.width, baseTexture.height, 0, baseTexture.format, glTexture.type, this.data);
      }
      return true;
    };
    BufferResource2.prototype.dispose = function() {
      this.data = null;
    };
    BufferResource2.test = function(source) {
      return source instanceof Float32Array || source instanceof Uint8Array || source instanceof Uint32Array;
    };
    return BufferResource2;
  }(Resource);
  var defaultBufferOptions = {
    scaleMode: SCALE_MODES.NEAREST,
    format: FORMATS.RGBA,
    alphaMode: ALPHA_MODES.NPM
  };
  var BaseTexture = function(_super) {
    __extends3(BaseTexture2, _super);
    function BaseTexture2(resource, options) {
      if (resource === void 0) {
        resource = null;
      }
      if (options === void 0) {
        options = null;
      }
      var _this = _super.call(this) || this;
      options = options || {};
      var alphaMode = options.alphaMode, mipmap = options.mipmap, anisotropicLevel = options.anisotropicLevel, scaleMode = options.scaleMode, width = options.width, height = options.height, wrapMode = options.wrapMode, format = options.format, type = options.type, target = options.target, resolution = options.resolution, resourceOptions = options.resourceOptions;
      if (resource && !(resource instanceof Resource)) {
        resource = autoDetectResource(resource, resourceOptions);
        resource.internal = true;
      }
      _this.width = width || 0;
      _this.height = height || 0;
      _this.resolution = resolution || settings.RESOLUTION;
      _this.mipmap = mipmap !== void 0 ? mipmap : settings.MIPMAP_TEXTURES;
      _this.anisotropicLevel = anisotropicLevel !== void 0 ? anisotropicLevel : settings.ANISOTROPIC_LEVEL;
      _this.wrapMode = wrapMode || settings.WRAP_MODE;
      _this.scaleMode = scaleMode !== void 0 ? scaleMode : settings.SCALE_MODE;
      _this.format = format || FORMATS.RGBA;
      _this.type = type || TYPES.UNSIGNED_BYTE;
      _this.target = target || TARGETS.TEXTURE_2D;
      _this.alphaMode = alphaMode !== void 0 ? alphaMode : ALPHA_MODES.UNPACK;
      if (options.premultiplyAlpha !== void 0) {
        _this.premultiplyAlpha = options.premultiplyAlpha;
      }
      _this.uid = uid();
      _this.touched = 0;
      _this.isPowerOfTwo = false;
      _this._refreshPOT();
      _this._glTextures = {};
      _this.dirtyId = 0;
      _this.dirtyStyleId = 0;
      _this.cacheId = null;
      _this.valid = width > 0 && height > 0;
      _this.textureCacheIds = [];
      _this.destroyed = false;
      _this.resource = null;
      _this._batchEnabled = 0;
      _this._batchLocation = 0;
      _this.parentTextureArray = null;
      _this.setResource(resource);
      return _this;
    }
    Object.defineProperty(BaseTexture2.prototype, "realWidth", {
      get: function() {
        return Math.ceil(this.width * this.resolution - 1e-4);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BaseTexture2.prototype, "realHeight", {
      get: function() {
        return Math.ceil(this.height * this.resolution - 1e-4);
      },
      enumerable: false,
      configurable: true
    });
    BaseTexture2.prototype.setStyle = function(scaleMode, mipmap) {
      var dirty;
      if (scaleMode !== void 0 && scaleMode !== this.scaleMode) {
        this.scaleMode = scaleMode;
        dirty = true;
      }
      if (mipmap !== void 0 && mipmap !== this.mipmap) {
        this.mipmap = mipmap;
        dirty = true;
      }
      if (dirty) {
        this.dirtyStyleId++;
      }
      return this;
    };
    BaseTexture2.prototype.setSize = function(width, height, resolution) {
      this.resolution = resolution || this.resolution;
      this.width = width;
      this.height = height;
      this._refreshPOT();
      this.update();
      return this;
    };
    BaseTexture2.prototype.setRealSize = function(realWidth, realHeight, resolution) {
      this.resolution = resolution || this.resolution;
      this.width = realWidth / this.resolution;
      this.height = realHeight / this.resolution;
      this._refreshPOT();
      this.update();
      return this;
    };
    BaseTexture2.prototype._refreshPOT = function() {
      this.isPowerOfTwo = isPow2(this.realWidth) && isPow2(this.realHeight);
    };
    BaseTexture2.prototype.setResolution = function(resolution) {
      var oldResolution = this.resolution;
      if (oldResolution === resolution) {
        return this;
      }
      this.resolution = resolution;
      if (this.valid) {
        this.width = this.width * oldResolution / resolution;
        this.height = this.height * oldResolution / resolution;
        this.emit("update", this);
      }
      this._refreshPOT();
      return this;
    };
    BaseTexture2.prototype.setResource = function(resource) {
      if (this.resource === resource) {
        return this;
      }
      if (this.resource) {
        throw new Error("Resource can be set only once");
      }
      resource.bind(this);
      this.resource = resource;
      return this;
    };
    BaseTexture2.prototype.update = function() {
      if (!this.valid) {
        if (this.width > 0 && this.height > 0) {
          this.valid = true;
          this.emit("loaded", this);
          this.emit("update", this);
        }
      } else {
        this.dirtyId++;
        this.dirtyStyleId++;
        this.emit("update", this);
      }
    };
    BaseTexture2.prototype.onError = function(event) {
      this.emit("error", this, event);
    };
    BaseTexture2.prototype.destroy = function() {
      if (this.resource) {
        this.resource.unbind(this);
        if (this.resource.internal) {
          this.resource.destroy();
        }
        this.resource = null;
      }
      if (this.cacheId) {
        delete BaseTextureCache[this.cacheId];
        delete TextureCache[this.cacheId];
        this.cacheId = null;
      }
      this.dispose();
      BaseTexture2.removeFromCache(this);
      this.textureCacheIds = null;
      this.destroyed = true;
    };
    BaseTexture2.prototype.dispose = function() {
      this.emit("dispose", this);
    };
    BaseTexture2.prototype.castToBaseTexture = function() {
      return this;
    };
    BaseTexture2.from = function(source, options, strict) {
      if (strict === void 0) {
        strict = settings.STRICT_TEXTURE_CACHE;
      }
      var isFrame = typeof source === "string";
      var cacheId = null;
      if (isFrame) {
        cacheId = source;
      } else {
        if (!source._pixiId) {
          source._pixiId = "pixiid_" + uid();
        }
        cacheId = source._pixiId;
      }
      var baseTexture = BaseTextureCache[cacheId];
      if (isFrame && strict && !baseTexture) {
        throw new Error('The cacheId "' + cacheId + '" does not exist in BaseTextureCache.');
      }
      if (!baseTexture) {
        baseTexture = new BaseTexture2(source, options);
        baseTexture.cacheId = cacheId;
        BaseTexture2.addToCache(baseTexture, cacheId);
      }
      return baseTexture;
    };
    BaseTexture2.fromBuffer = function(buffer, width, height, options) {
      buffer = buffer || new Float32Array(width * height * 4);
      var resource = new BufferResource(buffer, {width, height});
      var type = buffer instanceof Float32Array ? TYPES.FLOAT : TYPES.UNSIGNED_BYTE;
      return new BaseTexture2(resource, Object.assign(defaultBufferOptions, options || {width, height, type}));
    };
    BaseTexture2.addToCache = function(baseTexture, id) {
      if (id) {
        if (baseTexture.textureCacheIds.indexOf(id) === -1) {
          baseTexture.textureCacheIds.push(id);
        }
        if (BaseTextureCache[id]) {
          console.warn("BaseTexture added to the cache with an id [" + id + "] that already had an entry");
        }
        BaseTextureCache[id] = baseTexture;
      }
    };
    BaseTexture2.removeFromCache = function(baseTexture) {
      if (typeof baseTexture === "string") {
        var baseTextureFromCache = BaseTextureCache[baseTexture];
        if (baseTextureFromCache) {
          var index2 = baseTextureFromCache.textureCacheIds.indexOf(baseTexture);
          if (index2 > -1) {
            baseTextureFromCache.textureCacheIds.splice(index2, 1);
          }
          delete BaseTextureCache[baseTexture];
          return baseTextureFromCache;
        }
      } else if (baseTexture && baseTexture.textureCacheIds) {
        for (var i = 0; i < baseTexture.textureCacheIds.length; ++i) {
          delete BaseTextureCache[baseTexture.textureCacheIds[i]];
        }
        baseTexture.textureCacheIds.length = 0;
        return baseTexture;
      }
      return null;
    };
    BaseTexture2._globalBatch = 0;
    return BaseTexture2;
  }(import_eventemitter3.default);
  var AbstractMultiResource = function(_super) {
    __extends3(AbstractMultiResource2, _super);
    function AbstractMultiResource2(length, options) {
      var _this = this;
      var _a2 = options || {}, width = _a2.width, height = _a2.height;
      _this = _super.call(this, width, height) || this;
      _this.items = [];
      _this.itemDirtyIds = [];
      for (var i = 0; i < length; i++) {
        var partTexture = new BaseTexture();
        _this.items.push(partTexture);
        _this.itemDirtyIds.push(-2);
      }
      _this.length = length;
      _this._load = null;
      _this.baseTexture = null;
      return _this;
    }
    AbstractMultiResource2.prototype.initFromArray = function(resources, options) {
      for (var i = 0; i < this.length; i++) {
        if (!resources[i]) {
          continue;
        }
        if (resources[i].castToBaseTexture) {
          this.addBaseTextureAt(resources[i].castToBaseTexture(), i);
        } else if (resources[i] instanceof Resource) {
          this.addResourceAt(resources[i], i);
        } else {
          this.addResourceAt(autoDetectResource(resources[i], options), i);
        }
      }
    };
    AbstractMultiResource2.prototype.dispose = function() {
      for (var i = 0, len = this.length; i < len; i++) {
        this.items[i].destroy();
      }
      this.items = null;
      this.itemDirtyIds = null;
      this._load = null;
    };
    AbstractMultiResource2.prototype.addResourceAt = function(resource, index2) {
      if (!this.items[index2]) {
        throw new Error("Index " + index2 + " is out of bounds");
      }
      if (resource.valid && !this.valid) {
        this.resize(resource.width, resource.height);
      }
      this.items[index2].setResource(resource);
      return this;
    };
    AbstractMultiResource2.prototype.bind = function(baseTexture) {
      if (this.baseTexture !== null) {
        throw new Error("Only one base texture per TextureArray is allowed");
      }
      _super.prototype.bind.call(this, baseTexture);
      for (var i = 0; i < this.length; i++) {
        this.items[i].parentTextureArray = baseTexture;
        this.items[i].on("update", baseTexture.update, baseTexture);
      }
    };
    AbstractMultiResource2.prototype.unbind = function(baseTexture) {
      _super.prototype.unbind.call(this, baseTexture);
      for (var i = 0; i < this.length; i++) {
        this.items[i].parentTextureArray = null;
        this.items[i].off("update", baseTexture.update, baseTexture);
      }
    };
    AbstractMultiResource2.prototype.load = function() {
      var _this = this;
      if (this._load) {
        return this._load;
      }
      var resources = this.items.map(function(item) {
        return item.resource;
      }).filter(function(item) {
        return item;
      });
      var promises = resources.map(function(item) {
        return item.load();
      });
      this._load = Promise.all(promises).then(function() {
        var _a2 = _this.items[0], realWidth = _a2.realWidth, realHeight = _a2.realHeight;
        _this.resize(realWidth, realHeight);
        return Promise.resolve(_this);
      });
      return this._load;
    };
    return AbstractMultiResource2;
  }(Resource);
  var ArrayResource = function(_super) {
    __extends3(ArrayResource2, _super);
    function ArrayResource2(source, options) {
      var _this = this;
      var _a2 = options || {}, width = _a2.width, height = _a2.height;
      var urls;
      var length;
      if (Array.isArray(source)) {
        urls = source;
        length = source.length;
      } else {
        length = source;
      }
      _this = _super.call(this, length, {width, height}) || this;
      if (urls) {
        _this.initFromArray(urls, options);
      }
      return _this;
    }
    ArrayResource2.prototype.addBaseTextureAt = function(baseTexture, index2) {
      if (baseTexture.resource) {
        this.addResourceAt(baseTexture.resource, index2);
      } else {
        throw new Error("ArrayResource does not support RenderTexture");
      }
      return this;
    };
    ArrayResource2.prototype.bind = function(baseTexture) {
      _super.prototype.bind.call(this, baseTexture);
      baseTexture.target = TARGETS.TEXTURE_2D_ARRAY;
    };
    ArrayResource2.prototype.upload = function(renderer, texture, glTexture) {
      var _a2 = this, length = _a2.length, itemDirtyIds = _a2.itemDirtyIds, items = _a2.items;
      var gl = renderer.gl;
      if (glTexture.dirtyId < 0) {
        gl.texImage3D(gl.TEXTURE_2D_ARRAY, 0, texture.format, this._width, this._height, length, 0, texture.format, texture.type, null);
      }
      for (var i = 0; i < length; i++) {
        var item = items[i];
        if (itemDirtyIds[i] < item.dirtyId) {
          itemDirtyIds[i] = item.dirtyId;
          if (item.valid) {
            gl.texSubImage3D(gl.TEXTURE_2D_ARRAY, 0, 0, 0, i, item.resource.width, item.resource.height, 1, texture.format, texture.type, item.resource.source);
          }
        }
      }
      return true;
    };
    return ArrayResource2;
  }(AbstractMultiResource);
  var BaseImageResource = function(_super) {
    __extends3(BaseImageResource2, _super);
    function BaseImageResource2(source) {
      var _this = this;
      var sourceAny = source;
      var width = sourceAny.naturalWidth || sourceAny.videoWidth || sourceAny.width;
      var height = sourceAny.naturalHeight || sourceAny.videoHeight || sourceAny.height;
      _this = _super.call(this, width, height) || this;
      _this.source = source;
      _this.noSubImage = false;
      return _this;
    }
    BaseImageResource2.crossOrigin = function(element, url, crossorigin) {
      if (crossorigin === void 0 && url.indexOf("data:") !== 0) {
        element.crossOrigin = determineCrossOrigin(url);
      } else if (crossorigin !== false) {
        element.crossOrigin = typeof crossorigin === "string" ? crossorigin : "anonymous";
      }
    };
    BaseImageResource2.prototype.upload = function(renderer, baseTexture, glTexture, source) {
      var gl = renderer.gl;
      var width = baseTexture.realWidth;
      var height = baseTexture.realHeight;
      source = source || this.source;
      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, baseTexture.alphaMode === ALPHA_MODES.UNPACK);
      if (!this.noSubImage && baseTexture.target === gl.TEXTURE_2D && glTexture.width === width && glTexture.height === height) {
        gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, baseTexture.format, baseTexture.type, source);
      } else {
        glTexture.width = width;
        glTexture.height = height;
        gl.texImage2D(baseTexture.target, 0, baseTexture.format, baseTexture.format, baseTexture.type, source);
      }
      return true;
    };
    BaseImageResource2.prototype.update = function() {
      if (this.destroyed) {
        return;
      }
      var source = this.source;
      var width = source.naturalWidth || source.videoWidth || source.width;
      var height = source.naturalHeight || source.videoHeight || source.height;
      this.resize(width, height);
      _super.prototype.update.call(this);
    };
    BaseImageResource2.prototype.dispose = function() {
      this.source = null;
    };
    return BaseImageResource2;
  }(Resource);
  var CanvasResource = function(_super) {
    __extends3(CanvasResource2, _super);
    function CanvasResource2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CanvasResource2.test = function(source) {
      var OffscreenCanvas2 = window.OffscreenCanvas;
      if (OffscreenCanvas2 && source instanceof OffscreenCanvas2) {
        return true;
      }
      return source instanceof HTMLCanvasElement;
    };
    return CanvasResource2;
  }(BaseImageResource);
  var CubeResource = function(_super) {
    __extends3(CubeResource2, _super);
    function CubeResource2(source, options) {
      var _this = this;
      var _a2 = options || {}, width = _a2.width, height = _a2.height, autoLoad = _a2.autoLoad, linkBaseTexture = _a2.linkBaseTexture;
      if (source && source.length !== CubeResource2.SIDES) {
        throw new Error("Invalid length. Got " + source.length + ", expected 6");
      }
      _this = _super.call(this, 6, {width, height}) || this;
      for (var i = 0; i < CubeResource2.SIDES; i++) {
        _this.items[i].target = TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + i;
      }
      _this.linkBaseTexture = linkBaseTexture !== false;
      if (source) {
        _this.initFromArray(source, options);
      }
      if (autoLoad !== false) {
        _this.load();
      }
      return _this;
    }
    CubeResource2.prototype.bind = function(baseTexture) {
      _super.prototype.bind.call(this, baseTexture);
      baseTexture.target = TARGETS.TEXTURE_CUBE_MAP;
    };
    CubeResource2.prototype.addBaseTextureAt = function(baseTexture, index2, linkBaseTexture) {
      if (linkBaseTexture === void 0) {
        linkBaseTexture = this.linkBaseTexture;
      }
      if (!this.items[index2]) {
        throw new Error("Index " + index2 + " is out of bounds");
      }
      if (!this.linkBaseTexture || baseTexture.parentTextureArray || Object.keys(baseTexture._glTextures).length > 0) {
        if (baseTexture.resource) {
          this.addResourceAt(baseTexture.resource, index2);
        } else {
          throw new Error("CubeResource does not support copying of renderTexture.");
        }
      } else {
        baseTexture.target = TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + index2;
        baseTexture.parentTextureArray = this.baseTexture;
        this.items[index2] = baseTexture;
      }
      if (baseTexture.valid && !this.valid) {
        this.resize(baseTexture.realWidth, baseTexture.realHeight);
      }
      this.items[index2] = baseTexture;
      return this;
    };
    CubeResource2.prototype.upload = function(renderer, _baseTexture, glTexture) {
      var dirty = this.itemDirtyIds;
      for (var i = 0; i < CubeResource2.SIDES; i++) {
        var side = this.items[i];
        if (dirty[i] < side.dirtyId) {
          if (side.valid && side.resource) {
            side.resource.upload(renderer, side, glTexture);
            dirty[i] = side.dirtyId;
          } else if (dirty[i] < -1) {
            renderer.gl.texImage2D(side.target, 0, glTexture.internalFormat, _baseTexture.realWidth, _baseTexture.realHeight, 0, _baseTexture.format, glTexture.type, null);
            dirty[i] = -1;
          }
        }
      }
      return true;
    };
    CubeResource2.test = function(source) {
      return Array.isArray(source) && source.length === CubeResource2.SIDES;
    };
    CubeResource2.SIDES = 6;
    return CubeResource2;
  }(AbstractMultiResource);
  var ImageResource = function(_super) {
    __extends3(ImageResource2, _super);
    function ImageResource2(source, options) {
      var _this = this;
      options = options || {};
      if (!(source instanceof HTMLImageElement)) {
        var imageElement = new Image();
        BaseImageResource.crossOrigin(imageElement, source, options.crossorigin);
        imageElement.src = source;
        source = imageElement;
      }
      _this = _super.call(this, source) || this;
      if (!source.complete && !!_this._width && !!_this._height) {
        _this._width = 0;
        _this._height = 0;
      }
      _this.url = source.src;
      _this._process = null;
      _this.preserveBitmap = false;
      _this.createBitmap = (options.createBitmap !== void 0 ? options.createBitmap : settings.CREATE_IMAGE_BITMAP) && !!window.createImageBitmap;
      _this.alphaMode = typeof options.alphaMode === "number" ? options.alphaMode : null;
      if (options.premultiplyAlpha !== void 0) {
        _this.premultiplyAlpha = options.premultiplyAlpha;
      }
      _this.bitmap = null;
      _this._load = null;
      if (options.autoLoad !== false) {
        _this.load();
      }
      return _this;
    }
    ImageResource2.prototype.load = function(createBitmap) {
      var _this = this;
      if (this._load) {
        return this._load;
      }
      if (createBitmap !== void 0) {
        this.createBitmap = createBitmap;
      }
      this._load = new Promise(function(resolve, reject) {
        var source = _this.source;
        _this.url = source.src;
        var completed = function() {
          if (_this.destroyed) {
            return;
          }
          source.onload = null;
          source.onerror = null;
          _this.resize(source.width, source.height);
          _this._load = null;
          if (_this.createBitmap) {
            resolve(_this.process());
          } else {
            resolve(_this);
          }
        };
        if (source.complete && source.src) {
          completed();
        } else {
          source.onload = completed;
          source.onerror = function(event) {
            reject(event);
            _this.onError.emit(event);
          };
        }
      });
      return this._load;
    };
    ImageResource2.prototype.process = function() {
      var _this = this;
      var source = this.source;
      if (this._process !== null) {
        return this._process;
      }
      if (this.bitmap !== null || !window.createImageBitmap) {
        return Promise.resolve(this);
      }
      this._process = window.createImageBitmap(source, 0, 0, source.width, source.height, {
        premultiplyAlpha: this.alphaMode === ALPHA_MODES.UNPACK ? "premultiply" : "none"
      }).then(function(bitmap) {
        if (_this.destroyed) {
          return Promise.reject();
        }
        _this.bitmap = bitmap;
        _this.update();
        _this._process = null;
        return Promise.resolve(_this);
      });
      return this._process;
    };
    ImageResource2.prototype.upload = function(renderer, baseTexture, glTexture) {
      if (typeof this.alphaMode === "number") {
        baseTexture.alphaMode = this.alphaMode;
      }
      if (!this.createBitmap) {
        return _super.prototype.upload.call(this, renderer, baseTexture, glTexture);
      }
      if (!this.bitmap) {
        this.process();
        if (!this.bitmap) {
          return false;
        }
      }
      _super.prototype.upload.call(this, renderer, baseTexture, glTexture, this.bitmap);
      if (!this.preserveBitmap) {
        var flag = true;
        var glTextures = baseTexture._glTextures;
        for (var key in glTextures) {
          var otherTex = glTextures[key];
          if (otherTex !== glTexture && otherTex.dirtyId !== baseTexture.dirtyId) {
            flag = false;
            break;
          }
        }
        if (flag) {
          if (this.bitmap.close) {
            this.bitmap.close();
          }
          this.bitmap = null;
        }
      }
      return true;
    };
    ImageResource2.prototype.dispose = function() {
      this.source.onload = null;
      this.source.onerror = null;
      _super.prototype.dispose.call(this);
      if (this.bitmap) {
        this.bitmap.close();
        this.bitmap = null;
      }
      this._process = null;
      this._load = null;
    };
    ImageResource2.test = function(source) {
      return typeof source === "string" || source instanceof HTMLImageElement;
    };
    return ImageResource2;
  }(BaseImageResource);
  var SVGResource = function(_super) {
    __extends3(SVGResource2, _super);
    function SVGResource2(sourceBase64, options) {
      var _this = this;
      options = options || {};
      _this = _super.call(this, document.createElement("canvas")) || this;
      _this._width = 0;
      _this._height = 0;
      _this.svg = sourceBase64;
      _this.scale = options.scale || 1;
      _this._overrideWidth = options.width;
      _this._overrideHeight = options.height;
      _this._resolve = null;
      _this._crossorigin = options.crossorigin;
      _this._load = null;
      if (options.autoLoad !== false) {
        _this.load();
      }
      return _this;
    }
    SVGResource2.prototype.load = function() {
      var _this = this;
      if (this._load) {
        return this._load;
      }
      this._load = new Promise(function(resolve) {
        _this._resolve = function() {
          _this.resize(_this.source.width, _this.source.height);
          resolve(_this);
        };
        if (/^\<svg/.test(_this.svg.trim())) {
          if (!btoa) {
            throw new Error("Your browser doesn't support base64 conversions.");
          }
          _this.svg = "data:image/svg+xml;base64," + btoa(unescape(encodeURIComponent(_this.svg)));
        }
        _this._loadSvg();
      });
      return this._load;
    };
    SVGResource2.prototype._loadSvg = function() {
      var _this = this;
      var tempImage = new Image();
      BaseImageResource.crossOrigin(tempImage, this.svg, this._crossorigin);
      tempImage.src = this.svg;
      tempImage.onerror = function(event) {
        if (!_this._resolve) {
          return;
        }
        tempImage.onerror = null;
        _this.onError.emit(event);
      };
      tempImage.onload = function() {
        if (!_this._resolve) {
          return;
        }
        var svgWidth = tempImage.width;
        var svgHeight = tempImage.height;
        if (!svgWidth || !svgHeight) {
          throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");
        }
        var width = svgWidth * _this.scale;
        var height = svgHeight * _this.scale;
        if (_this._overrideWidth || _this._overrideHeight) {
          width = _this._overrideWidth || _this._overrideHeight / svgHeight * svgWidth;
          height = _this._overrideHeight || _this._overrideWidth / svgWidth * svgHeight;
        }
        width = Math.round(width);
        height = Math.round(height);
        var canvas2 = _this.source;
        canvas2.width = width;
        canvas2.height = height;
        canvas2._pixiId = "canvas_" + uid();
        canvas2.getContext("2d").drawImage(tempImage, 0, 0, svgWidth, svgHeight, 0, 0, width, height);
        _this._resolve();
        _this._resolve = null;
      };
    };
    SVGResource2.getSize = function(svgString) {
      var sizeMatch = SVGResource2.SVG_SIZE.exec(svgString);
      var size = {};
      if (sizeMatch) {
        size[sizeMatch[1]] = Math.round(parseFloat(sizeMatch[3]));
        size[sizeMatch[5]] = Math.round(parseFloat(sizeMatch[7]));
      }
      return size;
    };
    SVGResource2.prototype.dispose = function() {
      _super.prototype.dispose.call(this);
      this._resolve = null;
      this._crossorigin = null;
    };
    SVGResource2.test = function(source, extension) {
      return extension === "svg" || typeof source === "string" && /^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(source) || typeof source === "string" && source.indexOf("<svg") === 0;
    };
    SVGResource2.SVG_SIZE = /<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;
    return SVGResource2;
  }(BaseImageResource);
  var VideoResource = function(_super) {
    __extends3(VideoResource2, _super);
    function VideoResource2(source, options) {
      var _this = this;
      options = options || {};
      if (!(source instanceof HTMLVideoElement)) {
        var videoElement = document.createElement("video");
        videoElement.setAttribute("preload", "auto");
        videoElement.setAttribute("webkit-playsinline", "");
        videoElement.setAttribute("playsinline", "");
        if (typeof source === "string") {
          source = [source];
        }
        var firstSrc = source[0].src || source[0];
        BaseImageResource.crossOrigin(videoElement, firstSrc, options.crossorigin);
        for (var i = 0; i < source.length; ++i) {
          var sourceElement = document.createElement("source");
          var _a2 = source[i], src = _a2.src, mime = _a2.mime;
          src = src || source[i];
          var baseSrc = src.split("?").shift().toLowerCase();
          var ext = baseSrc.substr(baseSrc.lastIndexOf(".") + 1);
          mime = mime || VideoResource2.MIME_TYPES[ext] || "video/" + ext;
          sourceElement.src = src;
          sourceElement.type = mime;
          videoElement.appendChild(sourceElement);
        }
        source = videoElement;
      }
      _this = _super.call(this, source) || this;
      _this.noSubImage = true;
      _this._autoUpdate = true;
      _this._isConnectedToTicker = false;
      _this._updateFPS = options.updateFPS || 0;
      _this._msToNextUpdate = 0;
      _this.autoPlay = options.autoPlay !== false;
      _this._load = null;
      _this._resolve = null;
      _this._onCanPlay = _this._onCanPlay.bind(_this);
      _this._onError = _this._onError.bind(_this);
      if (options.autoLoad !== false) {
        _this.load();
      }
      return _this;
    }
    VideoResource2.prototype.update = function(_deltaTime) {
      if (_deltaTime === void 0) {
        _deltaTime = 0;
      }
      if (!this.destroyed) {
        var elapsedMS = Ticker.shared.elapsedMS * this.source.playbackRate;
        this._msToNextUpdate = Math.floor(this._msToNextUpdate - elapsedMS);
        if (!this._updateFPS || this._msToNextUpdate <= 0) {
          _super.prototype.update.call(this);
          this._msToNextUpdate = this._updateFPS ? Math.floor(1e3 / this._updateFPS) : 0;
        }
      }
    };
    VideoResource2.prototype.load = function() {
      var _this = this;
      if (this._load) {
        return this._load;
      }
      var source = this.source;
      if ((source.readyState === source.HAVE_ENOUGH_DATA || source.readyState === source.HAVE_FUTURE_DATA) && source.width && source.height) {
        source.complete = true;
      }
      source.addEventListener("play", this._onPlayStart.bind(this));
      source.addEventListener("pause", this._onPlayStop.bind(this));
      if (!this._isSourceReady()) {
        source.addEventListener("canplay", this._onCanPlay);
        source.addEventListener("canplaythrough", this._onCanPlay);
        source.addEventListener("error", this._onError, true);
      } else {
        this._onCanPlay();
      }
      this._load = new Promise(function(resolve) {
        if (_this.valid) {
          resolve(_this);
        } else {
          _this._resolve = resolve;
          source.load();
        }
      });
      return this._load;
    };
    VideoResource2.prototype._onError = function(event) {
      this.source.removeEventListener("error", this._onError, true);
      this.onError.emit(event);
    };
    VideoResource2.prototype._isSourcePlaying = function() {
      var source = this.source;
      return source.currentTime > 0 && source.paused === false && source.ended === false && source.readyState > 2;
    };
    VideoResource2.prototype._isSourceReady = function() {
      var source = this.source;
      return source.readyState === 3 || source.readyState === 4;
    };
    VideoResource2.prototype._onPlayStart = function() {
      if (!this.valid) {
        this._onCanPlay();
      }
      if (this.autoUpdate && !this._isConnectedToTicker) {
        Ticker.shared.add(this.update, this);
        this._isConnectedToTicker = true;
      }
    };
    VideoResource2.prototype._onPlayStop = function() {
      if (this._isConnectedToTicker) {
        Ticker.shared.remove(this.update, this);
        this._isConnectedToTicker = false;
      }
    };
    VideoResource2.prototype._onCanPlay = function() {
      var source = this.source;
      source.removeEventListener("canplay", this._onCanPlay);
      source.removeEventListener("canplaythrough", this._onCanPlay);
      var valid = this.valid;
      this.resize(source.videoWidth, source.videoHeight);
      if (!valid && this._resolve) {
        this._resolve(this);
        this._resolve = null;
      }
      if (this._isSourcePlaying()) {
        this._onPlayStart();
      } else if (this.autoPlay) {
        source.play();
      }
    };
    VideoResource2.prototype.dispose = function() {
      if (this._isConnectedToTicker) {
        Ticker.shared.remove(this.update, this);
      }
      var source = this.source;
      if (source) {
        source.removeEventListener("error", this._onError, true);
        source.pause();
        source.src = "";
        source.load();
      }
      _super.prototype.dispose.call(this);
    };
    Object.defineProperty(VideoResource2.prototype, "autoUpdate", {
      get: function() {
        return this._autoUpdate;
      },
      set: function(value) {
        if (value !== this._autoUpdate) {
          this._autoUpdate = value;
          if (!this._autoUpdate && this._isConnectedToTicker) {
            Ticker.shared.remove(this.update, this);
            this._isConnectedToTicker = false;
          } else if (this._autoUpdate && !this._isConnectedToTicker && this._isSourcePlaying()) {
            Ticker.shared.add(this.update, this);
            this._isConnectedToTicker = true;
          }
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(VideoResource2.prototype, "updateFPS", {
      get: function() {
        return this._updateFPS;
      },
      set: function(value) {
        if (value !== this._updateFPS) {
          this._updateFPS = value;
        }
      },
      enumerable: false,
      configurable: true
    });
    VideoResource2.test = function(source, extension) {
      return source instanceof HTMLVideoElement || VideoResource2.TYPES.indexOf(extension) > -1;
    };
    VideoResource2.TYPES = ["mp4", "m4v", "webm", "ogg", "ogv", "h264", "avi", "mov"];
    VideoResource2.MIME_TYPES = {
      ogv: "video/ogg",
      mov: "video/quicktime",
      m4v: "video/mp4"
    };
    return VideoResource2;
  }(BaseImageResource);
  var ImageBitmapResource = function(_super) {
    __extends3(ImageBitmapResource2, _super);
    function ImageBitmapResource2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ImageBitmapResource2.test = function(source) {
      return !!window.createImageBitmap && source instanceof ImageBitmap;
    };
    return ImageBitmapResource2;
  }(BaseImageResource);
  INSTALLED.push(ImageResource, ImageBitmapResource, CanvasResource, VideoResource, SVGResource, BufferResource, CubeResource, ArrayResource);
  var System = function() {
    function System2(renderer) {
      this.renderer = renderer;
    }
    System2.prototype.destroy = function() {
      this.renderer = null;
    };
    return System2;
  }();
  var DepthResource = function(_super) {
    __extends3(DepthResource2, _super);
    function DepthResource2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    DepthResource2.prototype.upload = function(renderer, baseTexture, glTexture) {
      var gl = renderer.gl;
      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, baseTexture.alphaMode === ALPHA_MODES.UNPACK);
      if (glTexture.width === baseTexture.width && glTexture.height === baseTexture.height) {
        gl.texSubImage2D(baseTexture.target, 0, 0, 0, baseTexture.width, baseTexture.height, baseTexture.format, baseTexture.type, this.data);
      } else {
        glTexture.width = baseTexture.width;
        glTexture.height = baseTexture.height;
        gl.texImage2D(baseTexture.target, 0, renderer.context.webGLVersion === 1 ? gl.DEPTH_COMPONENT : gl.DEPTH_COMPONENT16, baseTexture.width, baseTexture.height, 0, baseTexture.format, baseTexture.type, this.data);
      }
      return true;
    };
    return DepthResource2;
  }(BufferResource);
  var Framebuffer = function() {
    function Framebuffer2(width, height) {
      this.width = Math.ceil(width || 100);
      this.height = Math.ceil(height || 100);
      this.stencil = false;
      this.depth = false;
      this.dirtyId = 0;
      this.dirtyFormat = 0;
      this.dirtySize = 0;
      this.depthTexture = null;
      this.colorTextures = [];
      this.glFramebuffers = {};
      this.disposeRunner = new Runner("disposeFramebuffer");
      this.multisample = MSAA_QUALITY.NONE;
    }
    Object.defineProperty(Framebuffer2.prototype, "colorTexture", {
      get: function() {
        return this.colorTextures[0];
      },
      enumerable: false,
      configurable: true
    });
    Framebuffer2.prototype.addColorTexture = function(index2, texture) {
      if (index2 === void 0) {
        index2 = 0;
      }
      this.colorTextures[index2] = texture || new BaseTexture(null, {
        scaleMode: SCALE_MODES.NEAREST,
        resolution: 1,
        mipmap: MIPMAP_MODES.OFF,
        width: this.width,
        height: this.height
      });
      this.dirtyId++;
      this.dirtyFormat++;
      return this;
    };
    Framebuffer2.prototype.addDepthTexture = function(texture) {
      this.depthTexture = texture || new BaseTexture(new DepthResource(null, {width: this.width, height: this.height}), {
        scaleMode: SCALE_MODES.NEAREST,
        resolution: 1,
        width: this.width,
        height: this.height,
        mipmap: MIPMAP_MODES.OFF,
        format: FORMATS.DEPTH_COMPONENT,
        type: TYPES.UNSIGNED_SHORT
      });
      this.dirtyId++;
      this.dirtyFormat++;
      return this;
    };
    Framebuffer2.prototype.enableDepth = function() {
      this.depth = true;
      this.dirtyId++;
      this.dirtyFormat++;
      return this;
    };
    Framebuffer2.prototype.enableStencil = function() {
      this.stencil = true;
      this.dirtyId++;
      this.dirtyFormat++;
      return this;
    };
    Framebuffer2.prototype.resize = function(width, height) {
      width = Math.ceil(width);
      height = Math.ceil(height);
      if (width === this.width && height === this.height) {
        return;
      }
      this.width = width;
      this.height = height;
      this.dirtyId++;
      this.dirtySize++;
      for (var i = 0; i < this.colorTextures.length; i++) {
        var texture = this.colorTextures[i];
        var resolution = texture.resolution;
        texture.setSize(width / resolution, height / resolution);
      }
      if (this.depthTexture) {
        var resolution = this.depthTexture.resolution;
        this.depthTexture.setSize(width / resolution, height / resolution);
      }
    };
    Framebuffer2.prototype.dispose = function() {
      this.disposeRunner.emit(this, false);
    };
    Framebuffer2.prototype.destroyDepthTexture = function() {
      if (this.depthTexture) {
        this.depthTexture.destroy();
        this.depthTexture = null;
        ++this.dirtyId;
        ++this.dirtyFormat;
      }
    };
    return Framebuffer2;
  }();
  var BaseRenderTexture = function(_super) {
    __extends3(BaseRenderTexture2, _super);
    function BaseRenderTexture2(options) {
      var _this = this;
      if (typeof options === "number") {
        var width_1 = arguments[0];
        var height_1 = arguments[1];
        var scaleMode = arguments[2];
        var resolution = arguments[3];
        options = {width: width_1, height: height_1, scaleMode, resolution};
      }
      _this = _super.call(this, null, options) || this;
      var _a2 = options || {}, width = _a2.width, height = _a2.height;
      _this.mipmap = 0;
      _this.width = Math.ceil(width) || 100;
      _this.height = Math.ceil(height) || 100;
      _this.valid = true;
      _this.clearColor = [0, 0, 0, 0];
      _this.framebuffer = new Framebuffer(_this.width * _this.resolution, _this.height * _this.resolution).addColorTexture(0, _this);
      _this.maskStack = [];
      _this.filterStack = [{}];
      return _this;
    }
    BaseRenderTexture2.prototype.resize = function(width, height) {
      width = Math.ceil(width);
      height = Math.ceil(height);
      this.framebuffer.resize(width * this.resolution, height * this.resolution);
    };
    BaseRenderTexture2.prototype.dispose = function() {
      this.framebuffer.dispose();
      _super.prototype.dispose.call(this);
    };
    BaseRenderTexture2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      this.framebuffer.destroyDepthTexture();
      this.framebuffer = null;
    };
    return BaseRenderTexture2;
  }(BaseTexture);
  var TextureUvs = function() {
    function TextureUvs2() {
      this.x0 = 0;
      this.y0 = 0;
      this.x1 = 1;
      this.y1 = 0;
      this.x2 = 1;
      this.y2 = 1;
      this.x3 = 0;
      this.y3 = 1;
      this.uvsFloat32 = new Float32Array(8);
    }
    TextureUvs2.prototype.set = function(frame, baseFrame, rotate) {
      var tw = baseFrame.width;
      var th = baseFrame.height;
      if (rotate) {
        var w2 = frame.width / 2 / tw;
        var h2 = frame.height / 2 / th;
        var cX = frame.x / tw + w2;
        var cY = frame.y / th + h2;
        rotate = groupD8.add(rotate, groupD8.NW);
        this.x0 = cX + w2 * groupD8.uX(rotate);
        this.y0 = cY + h2 * groupD8.uY(rotate);
        rotate = groupD8.add(rotate, 2);
        this.x1 = cX + w2 * groupD8.uX(rotate);
        this.y1 = cY + h2 * groupD8.uY(rotate);
        rotate = groupD8.add(rotate, 2);
        this.x2 = cX + w2 * groupD8.uX(rotate);
        this.y2 = cY + h2 * groupD8.uY(rotate);
        rotate = groupD8.add(rotate, 2);
        this.x3 = cX + w2 * groupD8.uX(rotate);
        this.y3 = cY + h2 * groupD8.uY(rotate);
      } else {
        this.x0 = frame.x / tw;
        this.y0 = frame.y / th;
        this.x1 = (frame.x + frame.width) / tw;
        this.y1 = frame.y / th;
        this.x2 = (frame.x + frame.width) / tw;
        this.y2 = (frame.y + frame.height) / th;
        this.x3 = frame.x / tw;
        this.y3 = (frame.y + frame.height) / th;
      }
      this.uvsFloat32[0] = this.x0;
      this.uvsFloat32[1] = this.y0;
      this.uvsFloat32[2] = this.x1;
      this.uvsFloat32[3] = this.y1;
      this.uvsFloat32[4] = this.x2;
      this.uvsFloat32[5] = this.y2;
      this.uvsFloat32[6] = this.x3;
      this.uvsFloat32[7] = this.y3;
    };
    return TextureUvs2;
  }();
  var DEFAULT_UVS = new TextureUvs();
  var Texture = function(_super) {
    __extends3(Texture2, _super);
    function Texture2(baseTexture, frame, orig, trim, rotate, anchor) {
      var _this = _super.call(this) || this;
      _this.noFrame = false;
      if (!frame) {
        _this.noFrame = true;
        frame = new Rectangle(0, 0, 1, 1);
      }
      if (baseTexture instanceof Texture2) {
        baseTexture = baseTexture.baseTexture;
      }
      _this.baseTexture = baseTexture;
      _this._frame = frame;
      _this.trim = trim;
      _this.valid = false;
      _this._uvs = DEFAULT_UVS;
      _this.uvMatrix = null;
      _this.orig = orig || frame;
      _this._rotate = Number(rotate || 0);
      if (rotate === true) {
        _this._rotate = 2;
      } else if (_this._rotate % 2 !== 0) {
        throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");
      }
      _this.defaultAnchor = anchor ? new Point(anchor.x, anchor.y) : new Point(0, 0);
      _this._updateID = 0;
      _this.textureCacheIds = [];
      if (!baseTexture.valid) {
        baseTexture.once("loaded", _this.onBaseTextureUpdated, _this);
      } else if (_this.noFrame) {
        if (baseTexture.valid) {
          _this.onBaseTextureUpdated(baseTexture);
        }
      } else {
        _this.frame = frame;
      }
      if (_this.noFrame) {
        baseTexture.on("update", _this.onBaseTextureUpdated, _this);
      }
      return _this;
    }
    Texture2.prototype.update = function() {
      if (this.baseTexture.resource) {
        this.baseTexture.resource.update();
      }
    };
    Texture2.prototype.onBaseTextureUpdated = function(baseTexture) {
      if (this.noFrame) {
        if (!this.baseTexture.valid) {
          return;
        }
        this._frame.width = baseTexture.width;
        this._frame.height = baseTexture.height;
        this.valid = true;
        this.updateUvs();
      } else {
        this.frame = this._frame;
      }
      this.emit("update", this);
    };
    Texture2.prototype.destroy = function(destroyBase) {
      if (this.baseTexture) {
        if (destroyBase) {
          var resource = this.baseTexture;
          if (resource && resource.url && TextureCache[resource.url]) {
            Texture2.removeFromCache(resource.url);
          }
          this.baseTexture.destroy();
        }
        this.baseTexture.off("loaded", this.onBaseTextureUpdated, this);
        this.baseTexture.off("update", this.onBaseTextureUpdated, this);
        this.baseTexture = null;
      }
      this._frame = null;
      this._uvs = null;
      this.trim = null;
      this.orig = null;
      this.valid = false;
      Texture2.removeFromCache(this);
      this.textureCacheIds = null;
    };
    Texture2.prototype.clone = function() {
      return new Texture2(this.baseTexture, this.frame.clone(), this.orig.clone(), this.trim && this.trim.clone(), this.rotate, this.defaultAnchor);
    };
    Texture2.prototype.updateUvs = function() {
      if (this._uvs === DEFAULT_UVS) {
        this._uvs = new TextureUvs();
      }
      this._uvs.set(this._frame, this.baseTexture, this.rotate);
      this._updateID++;
    };
    Texture2.from = function(source, options, strict) {
      if (options === void 0) {
        options = {};
      }
      if (strict === void 0) {
        strict = settings.STRICT_TEXTURE_CACHE;
      }
      var isFrame = typeof source === "string";
      var cacheId = null;
      if (isFrame) {
        cacheId = source;
      } else {
        if (!source._pixiId) {
          source._pixiId = "pixiid_" + uid();
        }
        cacheId = source._pixiId;
      }
      var texture = TextureCache[cacheId];
      if (isFrame && strict && !texture) {
        throw new Error('The cacheId "' + cacheId + '" does not exist in TextureCache.');
      }
      if (!texture) {
        if (!options.resolution) {
          options.resolution = getResolutionOfUrl(source);
        }
        texture = new Texture2(new BaseTexture(source, options));
        texture.baseTexture.cacheId = cacheId;
        BaseTexture.addToCache(texture.baseTexture, cacheId);
        Texture2.addToCache(texture, cacheId);
      }
      return texture;
    };
    Texture2.fromURL = function(url, options) {
      var resourceOptions = Object.assign({autoLoad: false}, options === null || options === void 0 ? void 0 : options.resourceOptions);
      var texture = Texture2.from(url, Object.assign({resourceOptions}, options), false);
      var resource = texture.baseTexture.resource;
      if (texture.baseTexture.valid) {
        return Promise.resolve(texture);
      }
      return resource.load().then(function() {
        return Promise.resolve(texture);
      });
    };
    Texture2.fromBuffer = function(buffer, width, height, options) {
      return new Texture2(BaseTexture.fromBuffer(buffer, width, height, options));
    };
    Texture2.fromLoader = function(source, imageUrl, name) {
      var resource = new ImageResource(source);
      resource.url = imageUrl;
      var baseTexture = new BaseTexture(resource, {
        scaleMode: settings.SCALE_MODE,
        resolution: getResolutionOfUrl(imageUrl)
      });
      var texture = new Texture2(baseTexture);
      if (!name) {
        name = imageUrl;
      }
      BaseTexture.addToCache(texture.baseTexture, name);
      Texture2.addToCache(texture, name);
      if (name !== imageUrl) {
        BaseTexture.addToCache(texture.baseTexture, imageUrl);
        Texture2.addToCache(texture, imageUrl);
      }
      return texture;
    };
    Texture2.addToCache = function(texture, id) {
      if (id) {
        if (texture.textureCacheIds.indexOf(id) === -1) {
          texture.textureCacheIds.push(id);
        }
        if (TextureCache[id]) {
          console.warn("Texture added to the cache with an id [" + id + "] that already had an entry");
        }
        TextureCache[id] = texture;
      }
    };
    Texture2.removeFromCache = function(texture) {
      if (typeof texture === "string") {
        var textureFromCache = TextureCache[texture];
        if (textureFromCache) {
          var index2 = textureFromCache.textureCacheIds.indexOf(texture);
          if (index2 > -1) {
            textureFromCache.textureCacheIds.splice(index2, 1);
          }
          delete TextureCache[texture];
          return textureFromCache;
        }
      } else if (texture && texture.textureCacheIds) {
        for (var i = 0; i < texture.textureCacheIds.length; ++i) {
          if (TextureCache[texture.textureCacheIds[i]] === texture) {
            delete TextureCache[texture.textureCacheIds[i]];
          }
        }
        texture.textureCacheIds.length = 0;
        return texture;
      }
      return null;
    };
    Object.defineProperty(Texture2.prototype, "resolution", {
      get: function() {
        return this.baseTexture.resolution;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Texture2.prototype, "frame", {
      get: function() {
        return this._frame;
      },
      set: function(frame) {
        this._frame = frame;
        this.noFrame = false;
        var x = frame.x, y = frame.y, width = frame.width, height = frame.height;
        var xNotFit = x + width > this.baseTexture.width;
        var yNotFit = y + height > this.baseTexture.height;
        if (xNotFit || yNotFit) {
          var relationship = xNotFit && yNotFit ? "and" : "or";
          var errorX = "X: " + x + " + " + width + " = " + (x + width) + " > " + this.baseTexture.width;
          var errorY = "Y: " + y + " + " + height + " = " + (y + height) + " > " + this.baseTexture.height;
          throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: " + (errorX + " " + relationship + " " + errorY));
        }
        this.valid = width && height && this.baseTexture.valid;
        if (!this.trim && !this.rotate) {
          this.orig = frame;
        }
        if (this.valid) {
          this.updateUvs();
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Texture2.prototype, "rotate", {
      get: function() {
        return this._rotate;
      },
      set: function(rotate) {
        this._rotate = rotate;
        if (this.valid) {
          this.updateUvs();
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Texture2.prototype, "width", {
      get: function() {
        return this.orig.width;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Texture2.prototype, "height", {
      get: function() {
        return this.orig.height;
      },
      enumerable: false,
      configurable: true
    });
    Texture2.prototype.castToBaseTexture = function() {
      return this.baseTexture;
    };
    return Texture2;
  }(import_eventemitter3.default);
  function createWhiteTexture() {
    var canvas2 = document.createElement("canvas");
    canvas2.width = 16;
    canvas2.height = 16;
    var context2 = canvas2.getContext("2d");
    context2.fillStyle = "white";
    context2.fillRect(0, 0, 16, 16);
    return new Texture(new BaseTexture(new CanvasResource(canvas2)));
  }
  function removeAllHandlers(tex) {
    tex.destroy = function _emptyDestroy() {
    };
    tex.on = function _emptyOn() {
    };
    tex.once = function _emptyOnce() {
    };
    tex.emit = function _emptyEmit() {
    };
  }
  Texture.EMPTY = new Texture(new BaseTexture());
  removeAllHandlers(Texture.EMPTY);
  removeAllHandlers(Texture.EMPTY.baseTexture);
  Texture.WHITE = createWhiteTexture();
  removeAllHandlers(Texture.WHITE);
  removeAllHandlers(Texture.WHITE.baseTexture);
  var RenderTexture = function(_super) {
    __extends3(RenderTexture2, _super);
    function RenderTexture2(baseRenderTexture, frame) {
      var _this = this;
      var _legacyRenderer = null;
      if (!(baseRenderTexture instanceof BaseRenderTexture)) {
        var width = arguments[1];
        var height = arguments[2];
        var scaleMode = arguments[3];
        var resolution = arguments[4];
        console.warn("Please use RenderTexture.create(" + width + ", " + height + ") instead of the ctor directly.");
        _legacyRenderer = arguments[0];
        frame = null;
        baseRenderTexture = new BaseRenderTexture({
          width,
          height,
          scaleMode,
          resolution
        });
      }
      _this = _super.call(this, baseRenderTexture, frame) || this;
      _this.legacyRenderer = _legacyRenderer;
      _this.valid = true;
      _this.filterFrame = null;
      _this.filterPoolKey = null;
      _this.updateUvs();
      return _this;
    }
    Object.defineProperty(RenderTexture2.prototype, "framebuffer", {
      get: function() {
        return this.baseTexture.framebuffer;
      },
      enumerable: false,
      configurable: true
    });
    RenderTexture2.prototype.resize = function(width, height, resizeBaseTexture) {
      if (resizeBaseTexture === void 0) {
        resizeBaseTexture = true;
      }
      width = Math.ceil(width);
      height = Math.ceil(height);
      this.valid = width > 0 && height > 0;
      this._frame.width = this.orig.width = width;
      this._frame.height = this.orig.height = height;
      if (resizeBaseTexture) {
        this.baseTexture.resize(width, height);
      }
      this.updateUvs();
    };
    RenderTexture2.prototype.setResolution = function(resolution) {
      var baseTexture = this.baseTexture;
      if (baseTexture.resolution === resolution) {
        return;
      }
      baseTexture.setResolution(resolution);
      this.resize(baseTexture.width, baseTexture.height, false);
    };
    RenderTexture2.create = function(options) {
      if (typeof options === "number") {
        options = {
          width: options,
          height: arguments[1],
          scaleMode: arguments[2],
          resolution: arguments[3]
        };
      }
      return new RenderTexture2(new BaseRenderTexture(options));
    };
    return RenderTexture2;
  }(Texture);
  var RenderTexturePool = function() {
    function RenderTexturePool2(textureOptions) {
      this.texturePool = {};
      this.textureOptions = textureOptions || {};
      this.enableFullScreen = false;
      this._pixelsWidth = 0;
      this._pixelsHeight = 0;
    }
    RenderTexturePool2.prototype.createTexture = function(realWidth, realHeight) {
      var baseRenderTexture = new BaseRenderTexture(Object.assign({
        width: realWidth,
        height: realHeight,
        resolution: 1
      }, this.textureOptions));
      return new RenderTexture(baseRenderTexture);
    };
    RenderTexturePool2.prototype.getOptimalTexture = function(minWidth, minHeight, resolution) {
      if (resolution === void 0) {
        resolution = 1;
      }
      var key = RenderTexturePool2.SCREEN_KEY;
      minWidth *= resolution;
      minHeight *= resolution;
      if (!this.enableFullScreen || minWidth !== this._pixelsWidth || minHeight !== this._pixelsHeight) {
        minWidth = nextPow2(minWidth);
        minHeight = nextPow2(minHeight);
        key = (minWidth & 65535) << 16 | minHeight & 65535;
      }
      if (!this.texturePool[key]) {
        this.texturePool[key] = [];
      }
      var renderTexture = this.texturePool[key].pop();
      if (!renderTexture) {
        renderTexture = this.createTexture(minWidth, minHeight);
      }
      renderTexture.filterPoolKey = key;
      renderTexture.setResolution(resolution);
      return renderTexture;
    };
    RenderTexturePool2.prototype.getFilterTexture = function(input, resolution) {
      var filterTexture = this.getOptimalTexture(input.width, input.height, resolution || input.resolution);
      filterTexture.filterFrame = input.filterFrame;
      return filterTexture;
    };
    RenderTexturePool2.prototype.returnTexture = function(renderTexture) {
      var key = renderTexture.filterPoolKey;
      renderTexture.filterFrame = null;
      this.texturePool[key].push(renderTexture);
    };
    RenderTexturePool2.prototype.returnFilterTexture = function(renderTexture) {
      this.returnTexture(renderTexture);
    };
    RenderTexturePool2.prototype.clear = function(destroyTextures) {
      destroyTextures = destroyTextures !== false;
      if (destroyTextures) {
        for (var i in this.texturePool) {
          var textures = this.texturePool[i];
          if (textures) {
            for (var j = 0; j < textures.length; j++) {
              textures[j].destroy(true);
            }
          }
        }
      }
      this.texturePool = {};
    };
    RenderTexturePool2.prototype.setScreenSize = function(size) {
      if (size.width === this._pixelsWidth && size.height === this._pixelsHeight) {
        return;
      }
      var screenKey = RenderTexturePool2.SCREEN_KEY;
      var textures = this.texturePool[screenKey];
      this.enableFullScreen = size.width > 0 && size.height > 0;
      if (textures) {
        for (var j = 0; j < textures.length; j++) {
          textures[j].destroy(true);
        }
      }
      this.texturePool[screenKey] = [];
      this._pixelsWidth = size.width;
      this._pixelsHeight = size.height;
    };
    RenderTexturePool2.SCREEN_KEY = "screen";
    return RenderTexturePool2;
  }();
  var Attribute = function() {
    function Attribute2(buffer, size, normalized, type, stride, start, instance) {
      if (size === void 0) {
        size = 0;
      }
      if (normalized === void 0) {
        normalized = false;
      }
      if (type === void 0) {
        type = 5126;
      }
      this.buffer = buffer;
      this.size = size;
      this.normalized = normalized;
      this.type = type;
      this.stride = stride;
      this.start = start;
      this.instance = instance;
    }
    Attribute2.prototype.destroy = function() {
      this.buffer = null;
    };
    Attribute2.from = function(buffer, size, normalized, type, stride) {
      return new Attribute2(buffer, size, normalized, type, stride);
    };
    return Attribute2;
  }();
  var UID = 0;
  var Buffer2 = function() {
    function Buffer3(data, _static, index2) {
      if (_static === void 0) {
        _static = true;
      }
      if (index2 === void 0) {
        index2 = false;
      }
      this.data = data || new Float32Array(1);
      this._glBuffers = {};
      this._updateID = 0;
      this.index = index2;
      this.static = _static;
      this.id = UID++;
      this.disposeRunner = new Runner("disposeBuffer");
    }
    Buffer3.prototype.update = function(data) {
      this.data = data || this.data;
      this._updateID++;
    };
    Buffer3.prototype.dispose = function() {
      this.disposeRunner.emit(this, false);
    };
    Buffer3.prototype.destroy = function() {
      this.dispose();
      this.data = null;
    };
    Buffer3.from = function(data) {
      if (data instanceof Array) {
        data = new Float32Array(data);
      }
      return new Buffer3(data);
    };
    return Buffer3;
  }();
  function getBufferType2(array) {
    if (array.BYTES_PER_ELEMENT === 4) {
      if (array instanceof Float32Array) {
        return "Float32Array";
      } else if (array instanceof Uint32Array) {
        return "Uint32Array";
      }
      return "Int32Array";
    } else if (array.BYTES_PER_ELEMENT === 2) {
      if (array instanceof Uint16Array) {
        return "Uint16Array";
      }
    } else if (array.BYTES_PER_ELEMENT === 1) {
      if (array instanceof Uint8Array) {
        return "Uint8Array";
      }
    }
    return null;
  }
  var map2 = {
    Float32Array,
    Uint32Array,
    Int32Array,
    Uint8Array
  };
  function interleaveTypedArrays2(arrays, sizes) {
    var outSize = 0;
    var stride = 0;
    var views = {};
    for (var i = 0; i < arrays.length; i++) {
      stride += sizes[i];
      outSize += arrays[i].length;
    }
    var buffer = new ArrayBuffer(outSize * 4);
    var out = null;
    var littleOffset = 0;
    for (var i = 0; i < arrays.length; i++) {
      var size = sizes[i];
      var array = arrays[i];
      var type = getBufferType2(array);
      if (!views[type]) {
        views[type] = new map2[type](buffer);
      }
      out = views[type];
      for (var j = 0; j < array.length; j++) {
        var indexStart = (j / size | 0) * stride + littleOffset;
        var index2 = j % size;
        out[indexStart + index2] = array[j];
      }
      littleOffset += size;
    }
    return new Float32Array(buffer);
  }
  var byteSizeMap = {5126: 4, 5123: 2, 5121: 1};
  var UID$1 = 0;
  var map$1 = {
    Float32Array,
    Uint32Array,
    Int32Array,
    Uint8Array,
    Uint16Array
  };
  var Geometry = function() {
    function Geometry2(buffers, attributes) {
      if (buffers === void 0) {
        buffers = [];
      }
      if (attributes === void 0) {
        attributes = {};
      }
      this.buffers = buffers;
      this.indexBuffer = null;
      this.attributes = attributes;
      this.glVertexArrayObjects = {};
      this.id = UID$1++;
      this.instanced = false;
      this.instanceCount = 1;
      this.disposeRunner = new Runner("disposeGeometry");
      this.refCount = 0;
    }
    Geometry2.prototype.addAttribute = function(id, buffer, size, normalized, type, stride, start, instance) {
      if (size === void 0) {
        size = 0;
      }
      if (normalized === void 0) {
        normalized = false;
      }
      if (instance === void 0) {
        instance = false;
      }
      if (!buffer) {
        throw new Error("You must pass a buffer when creating an attribute");
      }
      if (!(buffer instanceof Buffer2)) {
        if (buffer instanceof Array) {
          buffer = new Float32Array(buffer);
        }
        buffer = new Buffer2(buffer);
      }
      var ids = id.split("|");
      if (ids.length > 1) {
        for (var i = 0; i < ids.length; i++) {
          this.addAttribute(ids[i], buffer, size, normalized, type);
        }
        return this;
      }
      var bufferIndex = this.buffers.indexOf(buffer);
      if (bufferIndex === -1) {
        this.buffers.push(buffer);
        bufferIndex = this.buffers.length - 1;
      }
      this.attributes[id] = new Attribute(bufferIndex, size, normalized, type, stride, start, instance);
      this.instanced = this.instanced || instance;
      return this;
    };
    Geometry2.prototype.getAttribute = function(id) {
      return this.attributes[id];
    };
    Geometry2.prototype.getBuffer = function(id) {
      return this.buffers[this.getAttribute(id).buffer];
    };
    Geometry2.prototype.addIndex = function(buffer) {
      if (!(buffer instanceof Buffer2)) {
        if (buffer instanceof Array) {
          buffer = new Uint16Array(buffer);
        }
        buffer = new Buffer2(buffer);
      }
      buffer.index = true;
      this.indexBuffer = buffer;
      if (this.buffers.indexOf(buffer) === -1) {
        this.buffers.push(buffer);
      }
      return this;
    };
    Geometry2.prototype.getIndex = function() {
      return this.indexBuffer;
    };
    Geometry2.prototype.interleave = function() {
      if (this.buffers.length === 1 || this.buffers.length === 2 && this.indexBuffer) {
        return this;
      }
      var arrays = [];
      var sizes = [];
      var interleavedBuffer = new Buffer2();
      var i;
      for (i in this.attributes) {
        var attribute = this.attributes[i];
        var buffer = this.buffers[attribute.buffer];
        arrays.push(buffer.data);
        sizes.push(attribute.size * byteSizeMap[attribute.type] / 4);
        attribute.buffer = 0;
      }
      interleavedBuffer.data = interleaveTypedArrays2(arrays, sizes);
      for (i = 0; i < this.buffers.length; i++) {
        if (this.buffers[i] !== this.indexBuffer) {
          this.buffers[i].destroy();
        }
      }
      this.buffers = [interleavedBuffer];
      if (this.indexBuffer) {
        this.buffers.push(this.indexBuffer);
      }
      return this;
    };
    Geometry2.prototype.getSize = function() {
      for (var i in this.attributes) {
        var attribute = this.attributes[i];
        var buffer = this.buffers[attribute.buffer];
        return buffer.data.length / (attribute.stride / 4 || attribute.size);
      }
      return 0;
    };
    Geometry2.prototype.dispose = function() {
      this.disposeRunner.emit(this, false);
    };
    Geometry2.prototype.destroy = function() {
      this.dispose();
      this.buffers = null;
      this.indexBuffer = null;
      this.attributes = null;
    };
    Geometry2.prototype.clone = function() {
      var geometry = new Geometry2();
      for (var i = 0; i < this.buffers.length; i++) {
        geometry.buffers[i] = new Buffer2(this.buffers[i].data.slice(0));
      }
      for (var i in this.attributes) {
        var attrib = this.attributes[i];
        geometry.attributes[i] = new Attribute(attrib.buffer, attrib.size, attrib.normalized, attrib.type, attrib.stride, attrib.start, attrib.instance);
      }
      if (this.indexBuffer) {
        geometry.indexBuffer = geometry.buffers[this.buffers.indexOf(this.indexBuffer)];
        geometry.indexBuffer.index = true;
      }
      return geometry;
    };
    Geometry2.merge = function(geometries) {
      var geometryOut = new Geometry2();
      var arrays = [];
      var sizes = [];
      var offsets = [];
      var geometry;
      for (var i = 0; i < geometries.length; i++) {
        geometry = geometries[i];
        for (var j = 0; j < geometry.buffers.length; j++) {
          sizes[j] = sizes[j] || 0;
          sizes[j] += geometry.buffers[j].data.length;
          offsets[j] = 0;
        }
      }
      for (var i = 0; i < geometry.buffers.length; i++) {
        arrays[i] = new map$1[getBufferType2(geometry.buffers[i].data)](sizes[i]);
        geometryOut.buffers[i] = new Buffer2(arrays[i]);
      }
      for (var i = 0; i < geometries.length; i++) {
        geometry = geometries[i];
        for (var j = 0; j < geometry.buffers.length; j++) {
          arrays[j].set(geometry.buffers[j].data, offsets[j]);
          offsets[j] += geometry.buffers[j].data.length;
        }
      }
      geometryOut.attributes = geometry.attributes;
      if (geometry.indexBuffer) {
        geometryOut.indexBuffer = geometryOut.buffers[geometry.buffers.indexOf(geometry.indexBuffer)];
        geometryOut.indexBuffer.index = true;
        var offset = 0;
        var stride = 0;
        var offset2 = 0;
        var bufferIndexToCount = 0;
        for (var i = 0; i < geometry.buffers.length; i++) {
          if (geometry.buffers[i] !== geometry.indexBuffer) {
            bufferIndexToCount = i;
            break;
          }
        }
        for (var i in geometry.attributes) {
          var attribute = geometry.attributes[i];
          if ((attribute.buffer | 0) === bufferIndexToCount) {
            stride += attribute.size * byteSizeMap[attribute.type] / 4;
          }
        }
        for (var i = 0; i < geometries.length; i++) {
          var indexBufferData = geometries[i].indexBuffer.data;
          for (var j = 0; j < indexBufferData.length; j++) {
            geometryOut.indexBuffer.data[j + offset2] += offset;
          }
          offset += geometry.buffers[bufferIndexToCount].data.length / stride;
          offset2 += indexBufferData.length;
        }
      }
      return geometryOut;
    };
    return Geometry2;
  }();
  var Quad = function(_super) {
    __extends3(Quad2, _super);
    function Quad2() {
      var _this = _super.call(this) || this;
      _this.addAttribute("aVertexPosition", new Float32Array([
        0,
        0,
        1,
        0,
        1,
        1,
        0,
        1
      ])).addIndex([0, 1, 3, 2]);
      return _this;
    }
    return Quad2;
  }(Geometry);
  var QuadUv = function(_super) {
    __extends3(QuadUv2, _super);
    function QuadUv2() {
      var _this = _super.call(this) || this;
      _this.vertices = new Float32Array([
        -1,
        -1,
        1,
        -1,
        1,
        1,
        -1,
        1
      ]);
      _this.uvs = new Float32Array([
        0,
        0,
        1,
        0,
        1,
        1,
        0,
        1
      ]);
      _this.vertexBuffer = new Buffer2(_this.vertices);
      _this.uvBuffer = new Buffer2(_this.uvs);
      _this.addAttribute("aVertexPosition", _this.vertexBuffer).addAttribute("aTextureCoord", _this.uvBuffer).addIndex([0, 1, 2, 0, 2, 3]);
      return _this;
    }
    QuadUv2.prototype.map = function(targetTextureFrame, destinationFrame) {
      var x = 0;
      var y = 0;
      this.uvs[0] = x;
      this.uvs[1] = y;
      this.uvs[2] = x + destinationFrame.width / targetTextureFrame.width;
      this.uvs[3] = y;
      this.uvs[4] = x + destinationFrame.width / targetTextureFrame.width;
      this.uvs[5] = y + destinationFrame.height / targetTextureFrame.height;
      this.uvs[6] = x;
      this.uvs[7] = y + destinationFrame.height / targetTextureFrame.height;
      x = destinationFrame.x;
      y = destinationFrame.y;
      this.vertices[0] = x;
      this.vertices[1] = y;
      this.vertices[2] = x + destinationFrame.width;
      this.vertices[3] = y;
      this.vertices[4] = x + destinationFrame.width;
      this.vertices[5] = y + destinationFrame.height;
      this.vertices[6] = x;
      this.vertices[7] = y + destinationFrame.height;
      this.invalidate();
      return this;
    };
    QuadUv2.prototype.invalidate = function() {
      this.vertexBuffer._updateID++;
      this.uvBuffer._updateID++;
      return this;
    };
    return QuadUv2;
  }(Geometry);
  var UID$2 = 0;
  var UniformGroup = function() {
    function UniformGroup2(uniforms, _static) {
      this.uniforms = uniforms;
      this.group = true;
      this.syncUniforms = {};
      this.dirtyId = 0;
      this.id = UID$2++;
      this.static = !!_static;
    }
    UniformGroup2.prototype.update = function() {
      this.dirtyId++;
    };
    UniformGroup2.prototype.add = function(name, uniforms, _static) {
      this.uniforms[name] = new UniformGroup2(uniforms, _static);
    };
    UniformGroup2.from = function(uniforms, _static) {
      return new UniformGroup2(uniforms, _static);
    };
    return UniformGroup2;
  }();
  var FilterState = function() {
    function FilterState2() {
      this.renderTexture = null;
      this.target = null;
      this.legacy = false;
      this.resolution = 1;
      this.sourceFrame = new Rectangle();
      this.destinationFrame = new Rectangle();
      this.filters = [];
    }
    FilterState2.prototype.clear = function() {
      this.target = null;
      this.filters = null;
      this.renderTexture = null;
    };
    return FilterState2;
  }();
  var FilterSystem = function(_super) {
    __extends3(FilterSystem2, _super);
    function FilterSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.defaultFilterStack = [{}];
      _this.texturePool = new RenderTexturePool();
      _this.texturePool.setScreenSize(renderer.view);
      _this.statePool = [];
      _this.quad = new Quad();
      _this.quadUv = new QuadUv();
      _this.tempRect = new Rectangle();
      _this.activeState = {};
      _this.globalUniforms = new UniformGroup({
        outputFrame: _this.tempRect,
        inputSize: new Float32Array(4),
        inputPixel: new Float32Array(4),
        inputClamp: new Float32Array(4),
        resolution: 1,
        filterArea: new Float32Array(4),
        filterClamp: new Float32Array(4)
      }, true);
      _this.forceClear = false;
      _this.useMaxPadding = false;
      return _this;
    }
    FilterSystem2.prototype.push = function(target, filters) {
      var renderer = this.renderer;
      var filterStack = this.defaultFilterStack;
      var state = this.statePool.pop() || new FilterState();
      var resolution = filters[0].resolution;
      var padding = filters[0].padding;
      var autoFit = filters[0].autoFit;
      var legacy = filters[0].legacy;
      for (var i = 1; i < filters.length; i++) {
        var filter = filters[i];
        resolution = Math.min(resolution, filter.resolution);
        padding = this.useMaxPadding ? Math.max(padding, filter.padding) : padding + filter.padding;
        autoFit = autoFit && filter.autoFit;
        legacy = legacy || filter.legacy;
      }
      if (filterStack.length === 1) {
        this.defaultFilterStack[0].renderTexture = renderer.renderTexture.current;
      }
      filterStack.push(state);
      state.resolution = resolution;
      state.legacy = legacy;
      state.target = target;
      state.sourceFrame.copyFrom(target.filterArea || target.getBounds(true));
      state.sourceFrame.pad(padding);
      if (autoFit) {
        state.sourceFrame.fit(this.renderer.renderTexture.sourceFrame);
      }
      state.sourceFrame.ceil(resolution);
      state.renderTexture = this.getOptimalFilterTexture(state.sourceFrame.width, state.sourceFrame.height, resolution);
      state.filters = filters;
      state.destinationFrame.width = state.renderTexture.width;
      state.destinationFrame.height = state.renderTexture.height;
      var destinationFrame = this.tempRect;
      destinationFrame.width = state.sourceFrame.width;
      destinationFrame.height = state.sourceFrame.height;
      state.renderTexture.filterFrame = state.sourceFrame;
      renderer.renderTexture.bind(state.renderTexture, state.sourceFrame, destinationFrame);
      renderer.renderTexture.clear();
    };
    FilterSystem2.prototype.pop = function() {
      var filterStack = this.defaultFilterStack;
      var state = filterStack.pop();
      var filters = state.filters;
      this.activeState = state;
      var globalUniforms = this.globalUniforms.uniforms;
      globalUniforms.outputFrame = state.sourceFrame;
      globalUniforms.resolution = state.resolution;
      var inputSize = globalUniforms.inputSize;
      var inputPixel = globalUniforms.inputPixel;
      var inputClamp = globalUniforms.inputClamp;
      inputSize[0] = state.destinationFrame.width;
      inputSize[1] = state.destinationFrame.height;
      inputSize[2] = 1 / inputSize[0];
      inputSize[3] = 1 / inputSize[1];
      inputPixel[0] = inputSize[0] * state.resolution;
      inputPixel[1] = inputSize[1] * state.resolution;
      inputPixel[2] = 1 / inputPixel[0];
      inputPixel[3] = 1 / inputPixel[1];
      inputClamp[0] = 0.5 * inputPixel[2];
      inputClamp[1] = 0.5 * inputPixel[3];
      inputClamp[2] = state.sourceFrame.width * inputSize[2] - 0.5 * inputPixel[2];
      inputClamp[3] = state.sourceFrame.height * inputSize[3] - 0.5 * inputPixel[3];
      if (state.legacy) {
        var filterArea = globalUniforms.filterArea;
        filterArea[0] = state.destinationFrame.width;
        filterArea[1] = state.destinationFrame.height;
        filterArea[2] = state.sourceFrame.x;
        filterArea[3] = state.sourceFrame.y;
        globalUniforms.filterClamp = globalUniforms.inputClamp;
      }
      this.globalUniforms.update();
      var lastState = filterStack[filterStack.length - 1];
      if (state.renderTexture.framebuffer.multisample > 1) {
        this.renderer.framebuffer.blit();
      }
      if (filters.length === 1) {
        filters[0].apply(this, state.renderTexture, lastState.renderTexture, CLEAR_MODES.BLEND, state);
        this.returnFilterTexture(state.renderTexture);
      } else {
        var flip = state.renderTexture;
        var flop = this.getOptimalFilterTexture(flip.width, flip.height, state.resolution);
        flop.filterFrame = flip.filterFrame;
        var i = 0;
        for (i = 0; i < filters.length - 1; ++i) {
          filters[i].apply(this, flip, flop, CLEAR_MODES.CLEAR, state);
          var t = flip;
          flip = flop;
          flop = t;
        }
        filters[i].apply(this, flip, lastState.renderTexture, CLEAR_MODES.BLEND, state);
        this.returnFilterTexture(flip);
        this.returnFilterTexture(flop);
      }
      state.clear();
      this.statePool.push(state);
    };
    FilterSystem2.prototype.bindAndClear = function(filterTexture, clearMode) {
      if (clearMode === void 0) {
        clearMode = CLEAR_MODES.CLEAR;
      }
      if (filterTexture && filterTexture.filterFrame) {
        var destinationFrame = this.tempRect;
        destinationFrame.width = filterTexture.filterFrame.width;
        destinationFrame.height = filterTexture.filterFrame.height;
        this.renderer.renderTexture.bind(filterTexture, filterTexture.filterFrame, destinationFrame);
      } else {
        this.renderer.renderTexture.bind(filterTexture);
      }
      if (typeof clearMode === "boolean") {
        clearMode = clearMode ? CLEAR_MODES.CLEAR : CLEAR_MODES.BLEND;
        deprecation("5.2.1", "Use CLEAR_MODES when using clear applyFilter option");
      }
      if (clearMode === CLEAR_MODES.CLEAR || clearMode === CLEAR_MODES.BLIT && this.forceClear) {
        this.renderer.renderTexture.clear();
      }
    };
    FilterSystem2.prototype.applyFilter = function(filter, input, output, clearMode) {
      var renderer = this.renderer;
      this.bindAndClear(output, clearMode);
      filter.uniforms.uSampler = input;
      filter.uniforms.filterGlobals = this.globalUniforms;
      renderer.state.set(filter.state);
      renderer.shader.bind(filter);
      if (filter.legacy) {
        this.quadUv.map(input._frame, input.filterFrame);
        renderer.geometry.bind(this.quadUv);
        renderer.geometry.draw(DRAW_MODES.TRIANGLES);
      } else {
        renderer.geometry.bind(this.quad);
        renderer.geometry.draw(DRAW_MODES.TRIANGLE_STRIP);
      }
    };
    FilterSystem2.prototype.calculateSpriteMatrix = function(outputMatrix, sprite) {
      var _a2 = this.activeState, sourceFrame = _a2.sourceFrame, destinationFrame = _a2.destinationFrame;
      var orig = sprite._texture.orig;
      var mappedMatrix = outputMatrix.set(destinationFrame.width, 0, 0, destinationFrame.height, sourceFrame.x, sourceFrame.y);
      var worldTransform = sprite.worldTransform.copyTo(Matrix.TEMP_MATRIX);
      worldTransform.invert();
      mappedMatrix.prepend(worldTransform);
      mappedMatrix.scale(1 / orig.width, 1 / orig.height);
      mappedMatrix.translate(sprite.anchor.x, sprite.anchor.y);
      return mappedMatrix;
    };
    FilterSystem2.prototype.destroy = function() {
      this.texturePool.clear(false);
    };
    FilterSystem2.prototype.getOptimalFilterTexture = function(minWidth, minHeight, resolution) {
      if (resolution === void 0) {
        resolution = 1;
      }
      return this.texturePool.getOptimalTexture(minWidth, minHeight, resolution);
    };
    FilterSystem2.prototype.getFilterTexture = function(input, resolution) {
      if (typeof input === "number") {
        var swap = input;
        input = resolution;
        resolution = swap;
      }
      input = input || this.activeState.renderTexture;
      var filterTexture = this.texturePool.getOptimalTexture(input.width, input.height, resolution || input.resolution);
      filterTexture.filterFrame = input.filterFrame;
      return filterTexture;
    };
    FilterSystem2.prototype.returnFilterTexture = function(renderTexture) {
      this.texturePool.returnTexture(renderTexture);
    };
    FilterSystem2.prototype.emptyPool = function() {
      this.texturePool.clear(true);
    };
    FilterSystem2.prototype.resize = function() {
      this.texturePool.setScreenSize(this.renderer.view);
    };
    return FilterSystem2;
  }(System);
  var ObjectRenderer = function() {
    function ObjectRenderer2(renderer) {
      this.renderer = renderer;
    }
    ObjectRenderer2.prototype.flush = function() {
    };
    ObjectRenderer2.prototype.destroy = function() {
      this.renderer = null;
    };
    ObjectRenderer2.prototype.start = function() {
    };
    ObjectRenderer2.prototype.stop = function() {
      this.flush();
    };
    ObjectRenderer2.prototype.render = function(_object) {
    };
    return ObjectRenderer2;
  }();
  var BatchSystem = function(_super) {
    __extends3(BatchSystem2, _super);
    function BatchSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.emptyRenderer = new ObjectRenderer(renderer);
      _this.currentRenderer = _this.emptyRenderer;
      return _this;
    }
    BatchSystem2.prototype.setObjectRenderer = function(objectRenderer) {
      if (this.currentRenderer === objectRenderer) {
        return;
      }
      this.currentRenderer.stop();
      this.currentRenderer = objectRenderer;
      this.currentRenderer.start();
    };
    BatchSystem2.prototype.flush = function() {
      this.setObjectRenderer(this.emptyRenderer);
    };
    BatchSystem2.prototype.reset = function() {
      this.setObjectRenderer(this.emptyRenderer);
    };
    BatchSystem2.prototype.copyBoundTextures = function(arr, maxTextures) {
      var boundTextures = this.renderer.texture.boundTextures;
      for (var i = maxTextures - 1; i >= 0; --i) {
        arr[i] = boundTextures[i] || null;
        if (arr[i]) {
          arr[i]._batchLocation = i;
        }
      }
    };
    BatchSystem2.prototype.boundArray = function(texArray, boundTextures, batchId, maxTextures) {
      var elements = texArray.elements, ids = texArray.ids, count = texArray.count;
      var j = 0;
      for (var i = 0; i < count; i++) {
        var tex = elements[i];
        var loc = tex._batchLocation;
        if (loc >= 0 && loc < maxTextures && boundTextures[loc] === tex) {
          ids[i] = loc;
          continue;
        }
        while (j < maxTextures) {
          var bound = boundTextures[j];
          if (bound && bound._batchEnabled === batchId && bound._batchLocation === j) {
            j++;
            continue;
          }
          ids[i] = j;
          tex._batchLocation = j;
          boundTextures[j] = tex;
          break;
        }
      }
    };
    return BatchSystem2;
  }(System);
  var CONTEXT_UID_COUNTER = 0;
  var ContextSystem = function(_super) {
    __extends3(ContextSystem2, _super);
    function ContextSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.webGLVersion = 1;
      _this.extensions = {};
      _this.supports = {
        uint32Indices: false
      };
      _this.handleContextLost = _this.handleContextLost.bind(_this);
      _this.handleContextRestored = _this.handleContextRestored.bind(_this);
      renderer.view.addEventListener("webglcontextlost", _this.handleContextLost, false);
      renderer.view.addEventListener("webglcontextrestored", _this.handleContextRestored, false);
      return _this;
    }
    Object.defineProperty(ContextSystem2.prototype, "isLost", {
      get: function() {
        return !this.gl || this.gl.isContextLost();
      },
      enumerable: false,
      configurable: true
    });
    ContextSystem2.prototype.contextChange = function(gl) {
      this.gl = gl;
      this.renderer.gl = gl;
      this.renderer.CONTEXT_UID = CONTEXT_UID_COUNTER++;
      if (gl.isContextLost() && gl.getExtension("WEBGL_lose_context")) {
        gl.getExtension("WEBGL_lose_context").restoreContext();
      }
    };
    ContextSystem2.prototype.initFromContext = function(gl) {
      this.gl = gl;
      this.validateContext(gl);
      this.renderer.gl = gl;
      this.renderer.CONTEXT_UID = CONTEXT_UID_COUNTER++;
      this.renderer.runners.contextChange.emit(gl);
    };
    ContextSystem2.prototype.initFromOptions = function(options) {
      var gl = this.createContext(this.renderer.view, options);
      this.initFromContext(gl);
    };
    ContextSystem2.prototype.createContext = function(canvas2, options) {
      var gl;
      if (settings.PREFER_ENV >= ENV.WEBGL2) {
        gl = canvas2.getContext("webgl2", options);
      }
      if (gl) {
        this.webGLVersion = 2;
      } else {
        this.webGLVersion = 1;
        gl = canvas2.getContext("webgl", options) || canvas2.getContext("experimental-webgl", options);
        if (!gl) {
          throw new Error("This browser does not support WebGL. Try using the canvas renderer");
        }
      }
      this.gl = gl;
      this.getExtensions();
      return this.gl;
    };
    ContextSystem2.prototype.getExtensions = function() {
      var gl = this.gl;
      if (this.webGLVersion === 1) {
        Object.assign(this.extensions, {
          drawBuffers: gl.getExtension("WEBGL_draw_buffers"),
          depthTexture: gl.getExtension("WEBGL_depth_texture"),
          loseContext: gl.getExtension("WEBGL_lose_context"),
          vertexArrayObject: gl.getExtension("OES_vertex_array_object") || gl.getExtension("MOZ_OES_vertex_array_object") || gl.getExtension("WEBKIT_OES_vertex_array_object"),
          anisotropicFiltering: gl.getExtension("EXT_texture_filter_anisotropic"),
          uint32ElementIndex: gl.getExtension("OES_element_index_uint"),
          floatTexture: gl.getExtension("OES_texture_float"),
          floatTextureLinear: gl.getExtension("OES_texture_float_linear"),
          textureHalfFloat: gl.getExtension("OES_texture_half_float"),
          textureHalfFloatLinear: gl.getExtension("OES_texture_half_float_linear")
        });
      } else if (this.webGLVersion === 2) {
        Object.assign(this.extensions, {
          anisotropicFiltering: gl.getExtension("EXT_texture_filter_anisotropic"),
          colorBufferFloat: gl.getExtension("EXT_color_buffer_float"),
          floatTextureLinear: gl.getExtension("OES_texture_float_linear")
        });
      }
    };
    ContextSystem2.prototype.handleContextLost = function(event) {
      event.preventDefault();
    };
    ContextSystem2.prototype.handleContextRestored = function() {
      this.renderer.runners.contextChange.emit(this.gl);
    };
    ContextSystem2.prototype.destroy = function() {
      var view = this.renderer.view;
      view.removeEventListener("webglcontextlost", this.handleContextLost);
      view.removeEventListener("webglcontextrestored", this.handleContextRestored);
      this.gl.useProgram(null);
      if (this.extensions.loseContext) {
        this.extensions.loseContext.loseContext();
      }
    };
    ContextSystem2.prototype.postrender = function() {
      if (this.renderer.renderingToScreen) {
        this.gl.flush();
      }
    };
    ContextSystem2.prototype.validateContext = function(gl) {
      var attributes = gl.getContextAttributes();
      var isWebGl2 = "WebGL2RenderingContext" in window && gl instanceof window.WebGL2RenderingContext;
      if (isWebGl2) {
        this.webGLVersion = 2;
      }
      if (!attributes.stencil) {
        console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");
      }
      var hasuint32 = isWebGl2 || !!gl.getExtension("OES_element_index_uint");
      this.supports.uint32Indices = hasuint32;
      if (!hasuint32) {
        console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly");
      }
    };
    return ContextSystem2;
  }(System);
  var GLFramebuffer = function() {
    function GLFramebuffer2(framebuffer) {
      this.framebuffer = framebuffer;
      this.stencil = null;
      this.dirtyId = 0;
      this.dirtyFormat = 0;
      this.dirtySize = 0;
      this.multisample = MSAA_QUALITY.NONE;
      this.msaaBuffer = null;
      this.blitFramebuffer = null;
    }
    return GLFramebuffer2;
  }();
  var tempRectangle = new Rectangle();
  var FramebufferSystem = function(_super) {
    __extends3(FramebufferSystem2, _super);
    function FramebufferSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.managedFramebuffers = [];
      _this.unknownFramebuffer = new Framebuffer(10, 10);
      _this.msaaSamples = null;
      return _this;
    }
    FramebufferSystem2.prototype.contextChange = function() {
      var gl = this.gl = this.renderer.gl;
      this.CONTEXT_UID = this.renderer.CONTEXT_UID;
      this.current = this.unknownFramebuffer;
      this.viewport = new Rectangle();
      this.hasMRT = true;
      this.writeDepthTexture = true;
      this.disposeAll(true);
      if (this.renderer.context.webGLVersion === 1) {
        var nativeDrawBuffersExtension_1 = this.renderer.context.extensions.drawBuffers;
        var nativeDepthTextureExtension = this.renderer.context.extensions.depthTexture;
        if (settings.PREFER_ENV === ENV.WEBGL_LEGACY) {
          nativeDrawBuffersExtension_1 = null;
          nativeDepthTextureExtension = null;
        }
        if (nativeDrawBuffersExtension_1) {
          gl.drawBuffers = function(activeTextures) {
            return nativeDrawBuffersExtension_1.drawBuffersWEBGL(activeTextures);
          };
        } else {
          this.hasMRT = false;
          gl.drawBuffers = function() {
          };
        }
        if (!nativeDepthTextureExtension) {
          this.writeDepthTexture = false;
        }
      } else {
        this.msaaSamples = gl.getInternalformatParameter(gl.RENDERBUFFER, gl.RGBA8, gl.SAMPLES);
      }
    };
    FramebufferSystem2.prototype.bind = function(framebuffer, frame) {
      var gl = this.gl;
      if (framebuffer) {
        var fbo = framebuffer.glFramebuffers[this.CONTEXT_UID] || this.initFramebuffer(framebuffer);
        if (this.current !== framebuffer) {
          this.current = framebuffer;
          gl.bindFramebuffer(gl.FRAMEBUFFER, fbo.framebuffer);
        }
        if (fbo.dirtyId !== framebuffer.dirtyId) {
          fbo.dirtyId = framebuffer.dirtyId;
          if (fbo.dirtyFormat !== framebuffer.dirtyFormat) {
            fbo.dirtyFormat = framebuffer.dirtyFormat;
            this.updateFramebuffer(framebuffer);
          } else if (fbo.dirtySize !== framebuffer.dirtySize) {
            fbo.dirtySize = framebuffer.dirtySize;
            this.resizeFramebuffer(framebuffer);
          }
        }
        for (var i = 0; i < framebuffer.colorTextures.length; i++) {
          var tex = framebuffer.colorTextures[i];
          this.renderer.texture.unbind(tex.parentTextureArray || tex);
        }
        if (framebuffer.depthTexture) {
          this.renderer.texture.unbind(framebuffer.depthTexture);
        }
        if (frame) {
          this.setViewport(frame.x, frame.y, frame.width, frame.height);
        } else {
          this.setViewport(0, 0, framebuffer.width, framebuffer.height);
        }
      } else {
        if (this.current) {
          this.current = null;
          gl.bindFramebuffer(gl.FRAMEBUFFER, null);
        }
        if (frame) {
          this.setViewport(frame.x, frame.y, frame.width, frame.height);
        } else {
          this.setViewport(0, 0, this.renderer.width, this.renderer.height);
        }
      }
    };
    FramebufferSystem2.prototype.setViewport = function(x, y, width, height) {
      var v = this.viewport;
      if (v.width !== width || v.height !== height || v.x !== x || v.y !== y) {
        v.x = x;
        v.y = y;
        v.width = width;
        v.height = height;
        this.gl.viewport(x, y, width, height);
      }
    };
    Object.defineProperty(FramebufferSystem2.prototype, "size", {
      get: function() {
        if (this.current) {
          return {x: 0, y: 0, width: this.current.width, height: this.current.height};
        }
        return {x: 0, y: 0, width: this.renderer.width, height: this.renderer.height};
      },
      enumerable: false,
      configurable: true
    });
    FramebufferSystem2.prototype.clear = function(r, g, b, a, mask) {
      if (mask === void 0) {
        mask = BUFFER_BITS.COLOR | BUFFER_BITS.DEPTH;
      }
      var gl = this.gl;
      gl.clearColor(r, g, b, a);
      gl.clear(mask);
    };
    FramebufferSystem2.prototype.initFramebuffer = function(framebuffer) {
      var gl = this.gl;
      var fbo = new GLFramebuffer(gl.createFramebuffer());
      fbo.multisample = this.detectSamples(framebuffer.multisample);
      framebuffer.glFramebuffers[this.CONTEXT_UID] = fbo;
      this.managedFramebuffers.push(framebuffer);
      framebuffer.disposeRunner.add(this);
      return fbo;
    };
    FramebufferSystem2.prototype.resizeFramebuffer = function(framebuffer) {
      var gl = this.gl;
      var fbo = framebuffer.glFramebuffers[this.CONTEXT_UID];
      if (fbo.stencil) {
        gl.bindRenderbuffer(gl.RENDERBUFFER, fbo.stencil);
        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, framebuffer.width, framebuffer.height);
      }
      var colorTextures = framebuffer.colorTextures;
      for (var i = 0; i < colorTextures.length; i++) {
        this.renderer.texture.bind(colorTextures[i], 0);
      }
      if (framebuffer.depthTexture) {
        this.renderer.texture.bind(framebuffer.depthTexture, 0);
      }
    };
    FramebufferSystem2.prototype.updateFramebuffer = function(framebuffer) {
      var gl = this.gl;
      var fbo = framebuffer.glFramebuffers[this.CONTEXT_UID];
      var colorTextures = framebuffer.colorTextures;
      var count = colorTextures.length;
      if (!gl.drawBuffers) {
        count = Math.min(count, 1);
      }
      if (fbo.multisample > 1) {
        fbo.msaaBuffer = gl.createRenderbuffer();
        gl.bindRenderbuffer(gl.RENDERBUFFER, fbo.msaaBuffer);
        gl.renderbufferStorageMultisample(gl.RENDERBUFFER, fbo.multisample, gl.RGBA8, framebuffer.width, framebuffer.height);
        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.RENDERBUFFER, fbo.msaaBuffer);
      }
      var activeTextures = [];
      for (var i = 0; i < count; i++) {
        if (i === 0 && fbo.multisample > 1) {
          continue;
        }
        var texture = framebuffer.colorTextures[i];
        var parentTexture = texture.parentTextureArray || texture;
        this.renderer.texture.bind(parentTexture, 0);
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + i, texture.target, parentTexture._glTextures[this.CONTEXT_UID].texture, 0);
        activeTextures.push(gl.COLOR_ATTACHMENT0 + i);
      }
      if (activeTextures.length > 1) {
        gl.drawBuffers(activeTextures);
      }
      if (framebuffer.depthTexture) {
        var writeDepthTexture = this.writeDepthTexture;
        if (writeDepthTexture) {
          var depthTexture = framebuffer.depthTexture;
          this.renderer.texture.bind(depthTexture, 0);
          gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, depthTexture._glTextures[this.CONTEXT_UID].texture, 0);
        }
      }
      if (!fbo.stencil && (framebuffer.stencil || framebuffer.depth)) {
        fbo.stencil = gl.createRenderbuffer();
        gl.bindRenderbuffer(gl.RENDERBUFFER, fbo.stencil);
        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, framebuffer.width, framebuffer.height);
        if (!framebuffer.depthTexture) {
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, fbo.stencil);
        }
      }
    };
    FramebufferSystem2.prototype.detectSamples = function(samples) {
      var msaaSamples = this.msaaSamples;
      var res = MSAA_QUALITY.NONE;
      if (samples <= 1 || msaaSamples === null) {
        return res;
      }
      for (var i = 0; i < msaaSamples.length; i++) {
        if (msaaSamples[i] <= samples) {
          res = msaaSamples[i];
          break;
        }
      }
      if (res === 1) {
        res = MSAA_QUALITY.NONE;
      }
      return res;
    };
    FramebufferSystem2.prototype.blit = function(framebuffer, sourcePixels, destPixels) {
      var _a2 = this, current = _a2.current, renderer = _a2.renderer, gl = _a2.gl, CONTEXT_UID = _a2.CONTEXT_UID;
      if (renderer.context.webGLVersion !== 2) {
        return;
      }
      if (!current) {
        return;
      }
      var fbo = current.glFramebuffers[CONTEXT_UID];
      if (!fbo) {
        return;
      }
      if (!framebuffer) {
        if (fbo.multisample <= 1) {
          return;
        }
        if (!fbo.blitFramebuffer) {
          fbo.blitFramebuffer = new Framebuffer(current.width, current.height);
          fbo.blitFramebuffer.addColorTexture(0, current.colorTextures[0]);
        }
        framebuffer = fbo.blitFramebuffer;
        framebuffer.width = current.width;
        framebuffer.height = current.height;
      }
      if (!sourcePixels) {
        sourcePixels = tempRectangle;
        sourcePixels.width = current.width;
        sourcePixels.height = current.height;
      }
      if (!destPixels) {
        destPixels = sourcePixels;
      }
      var sameSize = sourcePixels.width === destPixels.width && sourcePixels.height === destPixels.height;
      this.bind(framebuffer);
      gl.bindFramebuffer(gl.READ_FRAMEBUFFER, fbo.framebuffer);
      gl.blitFramebuffer(sourcePixels.x, sourcePixels.y, sourcePixels.width, sourcePixels.height, destPixels.x, destPixels.y, destPixels.width, destPixels.height, gl.COLOR_BUFFER_BIT, sameSize ? gl.NEAREST : gl.LINEAR);
    };
    FramebufferSystem2.prototype.disposeFramebuffer = function(framebuffer, contextLost) {
      var fbo = framebuffer.glFramebuffers[this.CONTEXT_UID];
      var gl = this.gl;
      if (!fbo) {
        return;
      }
      delete framebuffer.glFramebuffers[this.CONTEXT_UID];
      var index2 = this.managedFramebuffers.indexOf(framebuffer);
      if (index2 >= 0) {
        this.managedFramebuffers.splice(index2, 1);
      }
      framebuffer.disposeRunner.remove(this);
      if (!contextLost) {
        gl.deleteFramebuffer(fbo.framebuffer);
        if (fbo.stencil) {
          gl.deleteRenderbuffer(fbo.stencil);
        }
      }
    };
    FramebufferSystem2.prototype.disposeAll = function(contextLost) {
      var list = this.managedFramebuffers;
      this.managedFramebuffers = [];
      for (var i = 0; i < list.length; i++) {
        this.disposeFramebuffer(list[i], contextLost);
      }
    };
    FramebufferSystem2.prototype.forceStencil = function() {
      var framebuffer = this.current;
      if (!framebuffer) {
        return;
      }
      var fbo = framebuffer.glFramebuffers[this.CONTEXT_UID];
      if (!fbo || fbo.stencil) {
        return;
      }
      framebuffer.enableStencil();
      var w = framebuffer.width;
      var h = framebuffer.height;
      var gl = this.gl;
      var stencil = gl.createRenderbuffer();
      gl.bindRenderbuffer(gl.RENDERBUFFER, stencil);
      gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, w, h);
      fbo.stencil = stencil;
      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, stencil);
    };
    FramebufferSystem2.prototype.reset = function() {
      this.current = this.unknownFramebuffer;
      this.viewport = new Rectangle();
    };
    return FramebufferSystem2;
  }(System);
  var GLBuffer = function() {
    function GLBuffer2(buffer) {
      this.buffer = buffer || null;
      this.updateID = -1;
      this.byteLength = -1;
      this.refCount = 0;
    }
    return GLBuffer2;
  }();
  var byteSizeMap$1 = {5126: 4, 5123: 2, 5121: 1};
  var GeometrySystem = function(_super) {
    __extends3(GeometrySystem2, _super);
    function GeometrySystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this._activeGeometry = null;
      _this._activeVao = null;
      _this.hasVao = true;
      _this.hasInstance = true;
      _this.canUseUInt32ElementIndex = false;
      _this.managedGeometries = {};
      _this.managedBuffers = {};
      return _this;
    }
    GeometrySystem2.prototype.contextChange = function() {
      this.disposeAll(true);
      var gl = this.gl = this.renderer.gl;
      var context2 = this.renderer.context;
      this.CONTEXT_UID = this.renderer.CONTEXT_UID;
      if (context2.webGLVersion !== 2) {
        var nativeVaoExtension_1 = this.renderer.context.extensions.vertexArrayObject;
        if (settings.PREFER_ENV === ENV.WEBGL_LEGACY) {
          nativeVaoExtension_1 = null;
        }
        if (nativeVaoExtension_1) {
          gl.createVertexArray = function() {
            return nativeVaoExtension_1.createVertexArrayOES();
          };
          gl.bindVertexArray = function(vao) {
            return nativeVaoExtension_1.bindVertexArrayOES(vao);
          };
          gl.deleteVertexArray = function(vao) {
            return nativeVaoExtension_1.deleteVertexArrayOES(vao);
          };
        } else {
          this.hasVao = false;
          gl.createVertexArray = function() {
            return null;
          };
          gl.bindVertexArray = function() {
            return null;
          };
          gl.deleteVertexArray = function() {
            return null;
          };
        }
      }
      if (context2.webGLVersion !== 2) {
        var instanceExt_1 = gl.getExtension("ANGLE_instanced_arrays");
        if (instanceExt_1) {
          gl.vertexAttribDivisor = function(a, b) {
            return instanceExt_1.vertexAttribDivisorANGLE(a, b);
          };
          gl.drawElementsInstanced = function(a, b, c, d, e) {
            return instanceExt_1.drawElementsInstancedANGLE(a, b, c, d, e);
          };
          gl.drawArraysInstanced = function(a, b, c, d) {
            return instanceExt_1.drawArraysInstancedANGLE(a, b, c, d);
          };
        } else {
          this.hasInstance = false;
        }
      }
      this.canUseUInt32ElementIndex = context2.webGLVersion === 2 || !!context2.extensions.uint32ElementIndex;
    };
    GeometrySystem2.prototype.bind = function(geometry, shader) {
      shader = shader || this.renderer.shader.shader;
      var gl = this.gl;
      var vaos = geometry.glVertexArrayObjects[this.CONTEXT_UID];
      var incRefCount = false;
      if (!vaos) {
        this.managedGeometries[geometry.id] = geometry;
        geometry.disposeRunner.add(this);
        geometry.glVertexArrayObjects[this.CONTEXT_UID] = vaos = {};
        incRefCount = true;
      }
      var vao = vaos[shader.program.id] || this.initGeometryVao(geometry, shader.program, incRefCount);
      this._activeGeometry = geometry;
      if (this._activeVao !== vao) {
        this._activeVao = vao;
        if (this.hasVao) {
          gl.bindVertexArray(vao);
        } else {
          this.activateVao(geometry, shader.program);
        }
      }
      this.updateBuffers();
    };
    GeometrySystem2.prototype.reset = function() {
      this.unbind();
    };
    GeometrySystem2.prototype.updateBuffers = function() {
      var geometry = this._activeGeometry;
      var gl = this.gl;
      for (var i = 0; i < geometry.buffers.length; i++) {
        var buffer = geometry.buffers[i];
        var glBuffer = buffer._glBuffers[this.CONTEXT_UID];
        if (buffer._updateID !== glBuffer.updateID) {
          glBuffer.updateID = buffer._updateID;
          var type = buffer.index ? gl.ELEMENT_ARRAY_BUFFER : gl.ARRAY_BUFFER;
          gl.bindBuffer(type, glBuffer.buffer);
          this._boundBuffer = glBuffer;
          if (glBuffer.byteLength >= buffer.data.byteLength) {
            gl.bufferSubData(type, 0, buffer.data);
          } else {
            var drawType = buffer.static ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW;
            glBuffer.byteLength = buffer.data.byteLength;
            gl.bufferData(type, buffer.data, drawType);
          }
        }
      }
    };
    GeometrySystem2.prototype.checkCompatibility = function(geometry, program) {
      var geometryAttributes = geometry.attributes;
      var shaderAttributes = program.attributeData;
      for (var j in shaderAttributes) {
        if (!geometryAttributes[j]) {
          throw new Error('shader and geometry incompatible, geometry missing the "' + j + '" attribute');
        }
      }
    };
    GeometrySystem2.prototype.getSignature = function(geometry, program) {
      var attribs = geometry.attributes;
      var shaderAttributes = program.attributeData;
      var strings = ["g", geometry.id];
      for (var i in attribs) {
        if (shaderAttributes[i]) {
          strings.push(i);
        }
      }
      return strings.join("-");
    };
    GeometrySystem2.prototype.initGeometryVao = function(geometry, program, incRefCount) {
      if (incRefCount === void 0) {
        incRefCount = true;
      }
      this.checkCompatibility(geometry, program);
      var gl = this.gl;
      var CONTEXT_UID = this.CONTEXT_UID;
      var signature = this.getSignature(geometry, program);
      var vaoObjectHash = geometry.glVertexArrayObjects[this.CONTEXT_UID];
      var vao = vaoObjectHash[signature];
      if (vao) {
        vaoObjectHash[program.id] = vao;
        return vao;
      }
      var buffers = geometry.buffers;
      var attributes = geometry.attributes;
      var tempStride = {};
      var tempStart = {};
      for (var j in buffers) {
        tempStride[j] = 0;
        tempStart[j] = 0;
      }
      for (var j in attributes) {
        if (!attributes[j].size && program.attributeData[j]) {
          attributes[j].size = program.attributeData[j].size;
        } else if (!attributes[j].size) {
          console.warn("PIXI Geometry attribute '" + j + "' size cannot be determined (likely the bound shader does not have the attribute)");
        }
        tempStride[attributes[j].buffer] += attributes[j].size * byteSizeMap$1[attributes[j].type];
      }
      for (var j in attributes) {
        var attribute = attributes[j];
        var attribSize = attribute.size;
        if (attribute.stride === void 0) {
          if (tempStride[attribute.buffer] === attribSize * byteSizeMap$1[attribute.type]) {
            attribute.stride = 0;
          } else {
            attribute.stride = tempStride[attribute.buffer];
          }
        }
        if (attribute.start === void 0) {
          attribute.start = tempStart[attribute.buffer];
          tempStart[attribute.buffer] += attribSize * byteSizeMap$1[attribute.type];
        }
      }
      vao = gl.createVertexArray();
      gl.bindVertexArray(vao);
      for (var i = 0; i < buffers.length; i++) {
        var buffer = buffers[i];
        if (!buffer._glBuffers[CONTEXT_UID]) {
          buffer._glBuffers[CONTEXT_UID] = new GLBuffer(gl.createBuffer());
          this.managedBuffers[buffer.id] = buffer;
          buffer.disposeRunner.add(this);
        }
        if (incRefCount) {
          buffer._glBuffers[CONTEXT_UID].refCount++;
        }
      }
      this.activateVao(geometry, program);
      this._activeVao = vao;
      vaoObjectHash[program.id] = vao;
      vaoObjectHash[signature] = vao;
      return vao;
    };
    GeometrySystem2.prototype.disposeBuffer = function(buffer, contextLost) {
      if (!this.managedBuffers[buffer.id]) {
        return;
      }
      delete this.managedBuffers[buffer.id];
      var glBuffer = buffer._glBuffers[this.CONTEXT_UID];
      var gl = this.gl;
      buffer.disposeRunner.remove(this);
      if (!glBuffer) {
        return;
      }
      if (!contextLost) {
        gl.deleteBuffer(glBuffer.buffer);
      }
      delete buffer._glBuffers[this.CONTEXT_UID];
    };
    GeometrySystem2.prototype.disposeGeometry = function(geometry, contextLost) {
      if (!this.managedGeometries[geometry.id]) {
        return;
      }
      delete this.managedGeometries[geometry.id];
      var vaos = geometry.glVertexArrayObjects[this.CONTEXT_UID];
      var gl = this.gl;
      var buffers = geometry.buffers;
      geometry.disposeRunner.remove(this);
      if (!vaos) {
        return;
      }
      for (var i = 0; i < buffers.length; i++) {
        var buf = buffers[i]._glBuffers[this.CONTEXT_UID];
        buf.refCount--;
        if (buf.refCount === 0 && !contextLost) {
          this.disposeBuffer(buffers[i], contextLost);
        }
      }
      if (!contextLost) {
        for (var vaoId in vaos) {
          if (vaoId[0] === "g") {
            var vao = vaos[vaoId];
            if (this._activeVao === vao) {
              this.unbind();
            }
            gl.deleteVertexArray(vao);
          }
        }
      }
      delete geometry.glVertexArrayObjects[this.CONTEXT_UID];
    };
    GeometrySystem2.prototype.disposeAll = function(contextLost) {
      var all = Object.keys(this.managedGeometries);
      for (var i = 0; i < all.length; i++) {
        this.disposeGeometry(this.managedGeometries[all[i]], contextLost);
      }
      all = Object.keys(this.managedBuffers);
      for (var i = 0; i < all.length; i++) {
        this.disposeBuffer(this.managedBuffers[all[i]], contextLost);
      }
    };
    GeometrySystem2.prototype.activateVao = function(geometry, program) {
      var gl = this.gl;
      var CONTEXT_UID = this.CONTEXT_UID;
      var buffers = geometry.buffers;
      var attributes = geometry.attributes;
      if (geometry.indexBuffer) {
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, geometry.indexBuffer._glBuffers[CONTEXT_UID].buffer);
      }
      var lastBuffer = null;
      for (var j in attributes) {
        var attribute = attributes[j];
        var buffer = buffers[attribute.buffer];
        var glBuffer = buffer._glBuffers[CONTEXT_UID];
        if (program.attributeData[j]) {
          if (lastBuffer !== glBuffer) {
            gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer.buffer);
            lastBuffer = glBuffer;
          }
          var location = program.attributeData[j].location;
          gl.enableVertexAttribArray(location);
          gl.vertexAttribPointer(location, attribute.size, attribute.type || gl.FLOAT, attribute.normalized, attribute.stride, attribute.start);
          if (attribute.instance) {
            if (this.hasInstance) {
              gl.vertexAttribDivisor(location, 1);
            } else {
              throw new Error("geometry error, GPU Instancing is not supported on this device");
            }
          }
        }
      }
    };
    GeometrySystem2.prototype.draw = function(type, size, start, instanceCount) {
      var gl = this.gl;
      var geometry = this._activeGeometry;
      if (geometry.indexBuffer) {
        var byteSize = geometry.indexBuffer.data.BYTES_PER_ELEMENT;
        var glType = byteSize === 2 ? gl.UNSIGNED_SHORT : gl.UNSIGNED_INT;
        if (byteSize === 2 || byteSize === 4 && this.canUseUInt32ElementIndex) {
          if (geometry.instanced) {
            gl.drawElementsInstanced(type, size || geometry.indexBuffer.data.length, glType, (start || 0) * byteSize, instanceCount || 1);
          } else {
            gl.drawElements(type, size || geometry.indexBuffer.data.length, glType, (start || 0) * byteSize);
          }
        } else {
          console.warn("unsupported index buffer type: uint32");
        }
      } else if (geometry.instanced) {
        gl.drawArraysInstanced(type, start, size || geometry.getSize(), instanceCount || 1);
      } else {
        gl.drawArrays(type, start, size || geometry.getSize());
      }
      return this;
    };
    GeometrySystem2.prototype.unbind = function() {
      this.gl.bindVertexArray(null);
      this._activeVao = null;
      this._activeGeometry = null;
    };
    return GeometrySystem2;
  }(System);
  var MaskData = function() {
    function MaskData2(maskObject) {
      if (maskObject === void 0) {
        maskObject = null;
      }
      this.type = MASK_TYPES.NONE;
      this.autoDetect = true;
      this.maskObject = maskObject || null;
      this.pooled = false;
      this.isMaskData = true;
      this._stencilCounter = 0;
      this._scissorCounter = 0;
      this._scissorRect = null;
      this._target = null;
    }
    MaskData2.prototype.reset = function() {
      if (this.pooled) {
        this.maskObject = null;
        this.type = MASK_TYPES.NONE;
        this.autoDetect = true;
      }
      this._target = null;
    };
    MaskData2.prototype.copyCountersOrReset = function(maskAbove) {
      if (maskAbove) {
        this._stencilCounter = maskAbove._stencilCounter;
        this._scissorCounter = maskAbove._scissorCounter;
        this._scissorRect = maskAbove._scissorRect;
      } else {
        this._stencilCounter = 0;
        this._scissorCounter = 0;
        this._scissorRect = null;
      }
    };
    return MaskData2;
  }();
  function compileShader(gl, type, src) {
    var shader = gl.createShader(type);
    gl.shaderSource(shader, src);
    gl.compileShader(shader);
    return shader;
  }
  function compileProgram(gl, vertexSrc, fragmentSrc, attributeLocations) {
    var glVertShader = compileShader(gl, gl.VERTEX_SHADER, vertexSrc);
    var glFragShader = compileShader(gl, gl.FRAGMENT_SHADER, fragmentSrc);
    var program = gl.createProgram();
    gl.attachShader(program, glVertShader);
    gl.attachShader(program, glFragShader);
    if (attributeLocations) {
      for (var i in attributeLocations) {
        gl.bindAttribLocation(program, attributeLocations[i], i);
      }
    }
    gl.linkProgram(program);
    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
      if (!gl.getShaderParameter(glVertShader, gl.COMPILE_STATUS)) {
        console.warn(vertexSrc);
        console.error(gl.getShaderInfoLog(glVertShader));
      }
      if (!gl.getShaderParameter(glFragShader, gl.COMPILE_STATUS)) {
        console.warn(fragmentSrc);
        console.error(gl.getShaderInfoLog(glFragShader));
      }
      console.error("Pixi.js Error: Could not initialize shader.");
      console.error("gl.VALIDATE_STATUS", gl.getProgramParameter(program, gl.VALIDATE_STATUS));
      console.error("gl.getError()", gl.getError());
      if (gl.getProgramInfoLog(program) !== "") {
        console.warn("Pixi.js Warning: gl.getProgramInfoLog()", gl.getProgramInfoLog(program));
      }
      gl.deleteProgram(program);
      program = null;
    }
    gl.deleteShader(glVertShader);
    gl.deleteShader(glFragShader);
    return program;
  }
  function booleanArray(size) {
    var array = new Array(size);
    for (var i = 0; i < array.length; i++) {
      array[i] = false;
    }
    return array;
  }
  function defaultValue(type, size) {
    switch (type) {
      case "float":
        return 0;
      case "vec2":
        return new Float32Array(2 * size);
      case "vec3":
        return new Float32Array(3 * size);
      case "vec4":
        return new Float32Array(4 * size);
      case "int":
      case "sampler2D":
      case "sampler2DArray":
        return 0;
      case "ivec2":
        return new Int32Array(2 * size);
      case "ivec3":
        return new Int32Array(3 * size);
      case "ivec4":
        return new Int32Array(4 * size);
      case "bool":
        return false;
      case "bvec2":
        return booleanArray(2 * size);
      case "bvec3":
        return booleanArray(3 * size);
      case "bvec4":
        return booleanArray(4 * size);
      case "mat2":
        return new Float32Array([
          1,
          0,
          0,
          1
        ]);
      case "mat3":
        return new Float32Array([
          1,
          0,
          0,
          0,
          1,
          0,
          0,
          0,
          1
        ]);
      case "mat4":
        return new Float32Array([
          1,
          0,
          0,
          0,
          0,
          1,
          0,
          0,
          0,
          0,
          1,
          0,
          0,
          0,
          0,
          1
        ]);
    }
    return null;
  }
  var unknownContext = {};
  var context = unknownContext;
  function getTestContext() {
    if (context === unknownContext || context && context.isContextLost()) {
      var canvas2 = document.createElement("canvas");
      var gl = void 0;
      if (settings.PREFER_ENV >= ENV.WEBGL2) {
        gl = canvas2.getContext("webgl2", {});
      }
      if (!gl) {
        gl = canvas2.getContext("webgl", {}) || canvas2.getContext("experimental-webgl", {});
        if (!gl) {
          gl = null;
        } else {
          gl.getExtension("WEBGL_draw_buffers");
        }
      }
      context = gl;
    }
    return context;
  }
  var maxFragmentPrecision;
  function getMaxFragmentPrecision() {
    if (!maxFragmentPrecision) {
      maxFragmentPrecision = PRECISION.MEDIUM;
      var gl = getTestContext();
      if (gl) {
        if (gl.getShaderPrecisionFormat) {
          var shaderFragment = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);
          maxFragmentPrecision = shaderFragment.precision ? PRECISION.HIGH : PRECISION.MEDIUM;
        }
      }
    }
    return maxFragmentPrecision;
  }
  function setPrecision(src, requestedPrecision, maxSupportedPrecision) {
    if (src.substring(0, 9) !== "precision") {
      var precision = requestedPrecision;
      if (requestedPrecision === PRECISION.HIGH && maxSupportedPrecision !== PRECISION.HIGH) {
        precision = PRECISION.MEDIUM;
      }
      return "precision " + precision + " float;\n" + src;
    } else if (maxSupportedPrecision !== PRECISION.HIGH && src.substring(0, 15) === "precision highp") {
      return src.replace("precision highp", "precision mediump");
    }
    return src;
  }
  var GLSL_TO_SIZE = {
    float: 1,
    vec2: 2,
    vec3: 3,
    vec4: 4,
    int: 1,
    ivec2: 2,
    ivec3: 3,
    ivec4: 4,
    bool: 1,
    bvec2: 2,
    bvec3: 3,
    bvec4: 4,
    mat2: 4,
    mat3: 9,
    mat4: 16,
    sampler2D: 1
  };
  function mapSize(type) {
    return GLSL_TO_SIZE[type];
  }
  var GL_TABLE = null;
  var GL_TO_GLSL_TYPES = {
    FLOAT: "float",
    FLOAT_VEC2: "vec2",
    FLOAT_VEC3: "vec3",
    FLOAT_VEC4: "vec4",
    INT: "int",
    INT_VEC2: "ivec2",
    INT_VEC3: "ivec3",
    INT_VEC4: "ivec4",
    BOOL: "bool",
    BOOL_VEC2: "bvec2",
    BOOL_VEC3: "bvec3",
    BOOL_VEC4: "bvec4",
    FLOAT_MAT2: "mat2",
    FLOAT_MAT3: "mat3",
    FLOAT_MAT4: "mat4",
    SAMPLER_2D: "sampler2D",
    INT_SAMPLER_2D: "sampler2D",
    UNSIGNED_INT_SAMPLER_2D: "sampler2D",
    SAMPLER_CUBE: "samplerCube",
    INT_SAMPLER_CUBE: "samplerCube",
    UNSIGNED_INT_SAMPLER_CUBE: "samplerCube",
    SAMPLER_2D_ARRAY: "sampler2DArray",
    INT_SAMPLER_2D_ARRAY: "sampler2DArray",
    UNSIGNED_INT_SAMPLER_2D_ARRAY: "sampler2DArray"
  };
  function mapType(gl, type) {
    if (!GL_TABLE) {
      var typeNames = Object.keys(GL_TO_GLSL_TYPES);
      GL_TABLE = {};
      for (var i = 0; i < typeNames.length; ++i) {
        var tn = typeNames[i];
        GL_TABLE[gl[tn]] = GL_TO_GLSL_TYPES[tn];
      }
    }
    return GL_TABLE[type];
  }
  var uniformParsers = [
    {
      test: function(data) {
        return data.type === "float" && data.size === 1;
      },
      code: function(name) {
        return '\n            if(uv["' + name + '"] !== ud["' + name + '"].value)\n            {\n                ud["' + name + '"].value = uv["' + name + '"]\n                gl.uniform1f(ud["' + name + '"].location, uv["' + name + '"])\n            }\n            ';
      }
    },
    {
      test: function(data) {
        return (data.type === "sampler2D" || data.type === "samplerCube" || data.type === "sampler2DArray") && data.size === 1 && !data.isArray;
      },
      code: function(name) {
        return 't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["' + name + '"], t);\n\n            if(ud["' + name + '"].value !== t)\n            {\n                ud["' + name + '"].value = t;\n                gl.uniform1i(ud["' + name + '"].location, t);\n; // eslint-disable-line max-len\n            }';
      }
    },
    {
      test: function(data, uniform) {
        return data.type === "mat3" && data.size === 1 && uniform.a !== void 0;
      },
      code: function(name) {
        return '\n            gl.uniformMatrix3fv(ud["' + name + '"].location, false, uv["' + name + '"].toArray(true));\n            ';
      }
    },
    {
      test: function(data, uniform) {
        return data.type === "vec2" && data.size === 1 && uniform.x !== void 0;
      },
      code: function(name) {
        return '\n                cv = ud["' + name + '"].value;\n                v = uv["' + name + '"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["' + name + '"].location, v.x, v.y);\n                }';
      }
    },
    {
      test: function(data) {
        return data.type === "vec2" && data.size === 1;
      },
      code: function(name) {
        return '\n                cv = ud["' + name + '"].value;\n                v = uv["' + name + '"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["' + name + '"].location, v[0], v[1]);\n                }\n            ';
      }
    },
    {
      test: function(data, uniform) {
        return data.type === "vec4" && data.size === 1 && uniform.width !== void 0;
      },
      code: function(name) {
        return '\n                cv = ud["' + name + '"].value;\n                v = uv["' + name + '"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["' + name + '"].location, v.x, v.y, v.width, v.height)\n                }';
      }
    },
    {
      test: function(data) {
        return data.type === "vec4" && data.size === 1;
      },
      code: function(name) {
        return '\n                cv = ud["' + name + '"].value;\n                v = uv["' + name + '"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["' + name + '"].location, v[0], v[1], v[2], v[3])\n                }';
      }
    }
  ];
  var GLSL_TO_SINGLE_SETTERS_CACHED = {
    float: "\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
    vec2: "\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
    vec3: "\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
    vec4: "gl.uniform4f(location, v[0], v[1], v[2], v[3])",
    int: "gl.uniform1i(location, v)",
    ivec2: "gl.uniform2i(location, v[0], v[1])",
    ivec3: "gl.uniform3i(location, v[0], v[1], v[2])",
    ivec4: "gl.uniform4i(location, v[0], v[1], v[2], v[3])",
    bool: "gl.uniform1i(location, v)",
    bvec2: "gl.uniform2i(location, v[0], v[1])",
    bvec3: "gl.uniform3i(location, v[0], v[1], v[2])",
    bvec4: "gl.uniform4i(location, v[0], v[1], v[2], v[3])",
    mat2: "gl.uniformMatrix2fv(location, false, v)",
    mat3: "gl.uniformMatrix3fv(location, false, v)",
    mat4: "gl.uniformMatrix4fv(location, false, v)",
    sampler2D: "gl.uniform1i(location, v)",
    samplerCube: "gl.uniform1i(location, v)",
    sampler2DArray: "gl.uniform1i(location, v)"
  };
  var GLSL_TO_ARRAY_SETTERS = {
    float: "gl.uniform1fv(location, v)",
    vec2: "gl.uniform2fv(location, v)",
    vec3: "gl.uniform3fv(location, v)",
    vec4: "gl.uniform4fv(location, v)",
    mat4: "gl.uniformMatrix4fv(location, false, v)",
    mat3: "gl.uniformMatrix3fv(location, false, v)",
    mat2: "gl.uniformMatrix2fv(location, false, v)",
    int: "gl.uniform1iv(location, v)",
    ivec2: "gl.uniform2iv(location, v)",
    ivec3: "gl.uniform3iv(location, v)",
    ivec4: "gl.uniform4iv(location, v)",
    bool: "gl.uniform1iv(location, v)",
    bvec2: "gl.uniform2iv(location, v)",
    bvec3: "gl.uniform3iv(location, v)",
    bvec4: "gl.uniform4iv(location, v)",
    sampler2D: "gl.uniform1iv(location, v)",
    samplerCube: "gl.uniform1iv(location, v)",
    sampler2DArray: "gl.uniform1iv(location, v)"
  };
  function generateUniformsSync(group, uniformData) {
    var funcFragments = ["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];
    for (var i in group.uniforms) {
      var data = uniformData[i];
      if (!data) {
        if (group.uniforms[i].group) {
          funcFragments.push('\n                    renderer.shader.syncUniformGroup(uv["' + i + '"], syncData);\n                ');
        }
        continue;
      }
      var uniform = group.uniforms[i];
      var parsed = false;
      for (var j = 0; j < uniformParsers.length; j++) {
        if (uniformParsers[j].test(data, uniform)) {
          funcFragments.push(uniformParsers[j].code(i, uniform));
          parsed = true;
          break;
        }
      }
      if (!parsed) {
        var templateType = data.size === 1 ? GLSL_TO_SINGLE_SETTERS_CACHED : GLSL_TO_ARRAY_SETTERS;
        var template = templateType[data.type].replace("location", 'ud["' + i + '"].location');
        funcFragments.push('\n            cv = ud["' + i + '"].value;\n            v = uv["' + i + '"];\n            ' + template + ";");
      }
    }
    return new Function("ud", "uv", "renderer", "syncData", funcFragments.join("\n"));
  }
  var fragTemplate = [
    "precision mediump float;",
    "void main(void){",
    "float test = 0.1;",
    "%forloop%",
    "gl_FragColor = vec4(0.0);",
    "}"
  ].join("\n");
  function generateIfTestSrc(maxIfs) {
    var src = "";
    for (var i = 0; i < maxIfs; ++i) {
      if (i > 0) {
        src += "\nelse ";
      }
      if (i < maxIfs - 1) {
        src += "if(test == " + i + ".0){}";
      }
    }
    return src;
  }
  function checkMaxIfStatementsInShader(maxIfs, gl) {
    if (maxIfs === 0) {
      throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");
    }
    var shader = gl.createShader(gl.FRAGMENT_SHADER);
    while (true) {
      var fragmentSrc = fragTemplate.replace(/%forloop%/gi, generateIfTestSrc(maxIfs));
      gl.shaderSource(shader, fragmentSrc);
      gl.compileShader(shader);
      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        maxIfs = maxIfs / 2 | 0;
      } else {
        break;
      }
    }
    return maxIfs;
  }
  var unsafeEval;
  function unsafeEvalSupported() {
    if (typeof unsafeEval === "boolean") {
      return unsafeEval;
    }
    try {
      var func = new Function("param1", "param2", "param3", "return param1[param2] === param3;");
      unsafeEval = func({a: "b"}, "a", "b") === true;
    } catch (e) {
      unsafeEval = false;
    }
    return unsafeEval;
  }
  var defaultFragment = "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}";
  var defaultVertex = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n";
  var UID$3 = 0;
  var nameCache = {};
  var Program = function() {
    function Program2(vertexSrc, fragmentSrc, name) {
      if (name === void 0) {
        name = "pixi-shader";
      }
      this.id = UID$3++;
      this.vertexSrc = vertexSrc || Program2.defaultVertexSrc;
      this.fragmentSrc = fragmentSrc || Program2.defaultFragmentSrc;
      this.vertexSrc = this.vertexSrc.trim();
      this.fragmentSrc = this.fragmentSrc.trim();
      if (this.vertexSrc.substring(0, 8) !== "#version") {
        name = name.replace(/\s+/g, "-");
        if (nameCache[name]) {
          nameCache[name]++;
          name += "-" + nameCache[name];
        } else {
          nameCache[name] = 1;
        }
        this.vertexSrc = "#define SHADER_NAME " + name + "\n" + this.vertexSrc;
        this.fragmentSrc = "#define SHADER_NAME " + name + "\n" + this.fragmentSrc;
        this.vertexSrc = setPrecision(this.vertexSrc, settings.PRECISION_VERTEX, PRECISION.HIGH);
        this.fragmentSrc = setPrecision(this.fragmentSrc, settings.PRECISION_FRAGMENT, getMaxFragmentPrecision());
      }
      this.extractData(this.vertexSrc, this.fragmentSrc);
      this.glPrograms = {};
      this.syncUniforms = null;
    }
    Program2.prototype.extractData = function(vertexSrc, fragmentSrc) {
      var gl = getTestContext();
      if (gl) {
        var program = compileProgram(gl, vertexSrc, fragmentSrc);
        this.attributeData = this.getAttributeData(program, gl);
        this.uniformData = this.getUniformData(program, gl);
        gl.deleteProgram(program);
      } else {
        this.uniformData = {};
        this.attributeData = {};
      }
    };
    Program2.prototype.getAttributeData = function(program, gl) {
      var attributes = {};
      var attributesArray = [];
      var totalAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);
      for (var i = 0; i < totalAttributes; i++) {
        var attribData = gl.getActiveAttrib(program, i);
        var type = mapType(gl, attribData.type);
        var data = {
          type,
          name: attribData.name,
          size: mapSize(type),
          location: 0
        };
        attributes[attribData.name] = data;
        attributesArray.push(data);
      }
      attributesArray.sort(function(a, b) {
        return a.name > b.name ? 1 : -1;
      });
      for (var i = 0; i < attributesArray.length; i++) {
        attributesArray[i].location = i;
      }
      return attributes;
    };
    Program2.prototype.getUniformData = function(program, gl) {
      var uniforms = {};
      var totalUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);
      for (var i = 0; i < totalUniforms; i++) {
        var uniformData = gl.getActiveUniform(program, i);
        var name = uniformData.name.replace(/\[.*?\]$/, "");
        var isArray = uniformData.name.match(/\[.*?\]$/);
        var type = mapType(gl, uniformData.type);
        uniforms[name] = {
          type,
          size: uniformData.size,
          isArray,
          value: defaultValue(type, uniformData.size)
        };
      }
      return uniforms;
    };
    Object.defineProperty(Program2, "defaultVertexSrc", {
      get: function() {
        return defaultVertex;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Program2, "defaultFragmentSrc", {
      get: function() {
        return defaultFragment;
      },
      enumerable: false,
      configurable: true
    });
    Program2.from = function(vertexSrc, fragmentSrc, name) {
      var key = vertexSrc + fragmentSrc;
      var program = ProgramCache[key];
      if (!program) {
        ProgramCache[key] = program = new Program2(vertexSrc, fragmentSrc, name);
      }
      return program;
    };
    return Program2;
  }();
  var Shader = function() {
    function Shader2(program, uniforms) {
      this.program = program;
      if (uniforms) {
        if (uniforms instanceof UniformGroup) {
          this.uniformGroup = uniforms;
        } else {
          this.uniformGroup = new UniformGroup(uniforms);
        }
      } else {
        this.uniformGroup = new UniformGroup({});
      }
      for (var i in program.uniformData) {
        if (this.uniformGroup.uniforms[i] instanceof Array) {
          this.uniformGroup.uniforms[i] = new Float32Array(this.uniformGroup.uniforms[i]);
        }
      }
    }
    Shader2.prototype.checkUniformExists = function(name, group) {
      if (group.uniforms[name]) {
        return true;
      }
      for (var i in group.uniforms) {
        var uniform = group.uniforms[i];
        if (uniform.group) {
          if (this.checkUniformExists(name, uniform)) {
            return true;
          }
        }
      }
      return false;
    };
    Shader2.prototype.destroy = function() {
      this.uniformGroup = null;
    };
    Object.defineProperty(Shader2.prototype, "uniforms", {
      get: function() {
        return this.uniformGroup.uniforms;
      },
      enumerable: false,
      configurable: true
    });
    Shader2.from = function(vertexSrc, fragmentSrc, uniforms) {
      var program = Program.from(vertexSrc, fragmentSrc);
      return new Shader2(program, uniforms);
    };
    return Shader2;
  }();
  var BLEND = 0;
  var OFFSET = 1;
  var CULLING = 2;
  var DEPTH_TEST = 3;
  var WINDING = 4;
  var State = function() {
    function State2() {
      this.data = 0;
      this.blendMode = BLEND_MODES.NORMAL;
      this.polygonOffset = 0;
      this.blend = true;
    }
    Object.defineProperty(State2.prototype, "blend", {
      get: function() {
        return !!(this.data & 1 << BLEND);
      },
      set: function(value) {
        if (!!(this.data & 1 << BLEND) !== value) {
          this.data ^= 1 << BLEND;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "offsets", {
      get: function() {
        return !!(this.data & 1 << OFFSET);
      },
      set: function(value) {
        if (!!(this.data & 1 << OFFSET) !== value) {
          this.data ^= 1 << OFFSET;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "culling", {
      get: function() {
        return !!(this.data & 1 << CULLING);
      },
      set: function(value) {
        if (!!(this.data & 1 << CULLING) !== value) {
          this.data ^= 1 << CULLING;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "depthTest", {
      get: function() {
        return !!(this.data & 1 << DEPTH_TEST);
      },
      set: function(value) {
        if (!!(this.data & 1 << DEPTH_TEST) !== value) {
          this.data ^= 1 << DEPTH_TEST;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "clockwiseFrontFace", {
      get: function() {
        return !!(this.data & 1 << WINDING);
      },
      set: function(value) {
        if (!!(this.data & 1 << WINDING) !== value) {
          this.data ^= 1 << WINDING;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "blendMode", {
      get: function() {
        return this._blendMode;
      },
      set: function(value) {
        this.blend = value !== BLEND_MODES.NONE;
        this._blendMode = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(State2.prototype, "polygonOffset", {
      get: function() {
        return this._polygonOffset;
      },
      set: function(value) {
        this.offsets = !!value;
        this._polygonOffset = value;
      },
      enumerable: false,
      configurable: true
    });
    State2.for2d = function() {
      var state = new State2();
      state.depthTest = false;
      state.blend = true;
      return state;
    };
    return State2;
  }();
  var defaultVertex$1 = "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";
  var defaultFragment$1 = "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n";
  var Filter = function(_super) {
    __extends3(Filter2, _super);
    function Filter2(vertexSrc, fragmentSrc, uniforms) {
      var _this = this;
      var program = Program.from(vertexSrc || Filter2.defaultVertexSrc, fragmentSrc || Filter2.defaultFragmentSrc);
      _this = _super.call(this, program, uniforms) || this;
      _this.padding = 0;
      _this.resolution = settings.FILTER_RESOLUTION;
      _this.enabled = true;
      _this.autoFit = true;
      _this.legacy = !!_this.program.attributeData.aTextureCoord;
      _this.state = new State();
      return _this;
    }
    Filter2.prototype.apply = function(filterManager, input, output, clearMode, _currentState) {
      filterManager.applyFilter(this, input, output, clearMode);
    };
    Object.defineProperty(Filter2.prototype, "blendMode", {
      get: function() {
        return this.state.blendMode;
      },
      set: function(value) {
        this.state.blendMode = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Filter2, "defaultVertexSrc", {
      get: function() {
        return defaultVertex$1;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Filter2, "defaultFragmentSrc", {
      get: function() {
        return defaultFragment$1;
      },
      enumerable: false,
      configurable: true
    });
    return Filter2;
  }(Shader);
  var vertex = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n";
  var fragment = "varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n";
  var tempMat = new Matrix();
  var TextureMatrix = function() {
    function TextureMatrix2(texture, clampMargin) {
      this._texture = texture;
      this.mapCoord = new Matrix();
      this.uClampFrame = new Float32Array(4);
      this.uClampOffset = new Float32Array(2);
      this._textureID = -1;
      this._updateID = 0;
      this.clampOffset = 0;
      this.clampMargin = typeof clampMargin === "undefined" ? 0.5 : clampMargin;
      this.isSimple = false;
    }
    Object.defineProperty(TextureMatrix2.prototype, "texture", {
      get: function() {
        return this._texture;
      },
      set: function(value) {
        this._texture = value;
        this._textureID = -1;
      },
      enumerable: false,
      configurable: true
    });
    TextureMatrix2.prototype.multiplyUvs = function(uvs, out) {
      if (out === void 0) {
        out = uvs;
      }
      var mat = this.mapCoord;
      for (var i = 0; i < uvs.length; i += 2) {
        var x = uvs[i];
        var y = uvs[i + 1];
        out[i] = x * mat.a + y * mat.c + mat.tx;
        out[i + 1] = x * mat.b + y * mat.d + mat.ty;
      }
      return out;
    };
    TextureMatrix2.prototype.update = function(forceUpdate) {
      var tex = this._texture;
      if (!tex || !tex.valid) {
        return false;
      }
      if (!forceUpdate && this._textureID === tex._updateID) {
        return false;
      }
      this._textureID = tex._updateID;
      this._updateID++;
      var uvs = tex._uvs;
      this.mapCoord.set(uvs.x1 - uvs.x0, uvs.y1 - uvs.y0, uvs.x3 - uvs.x0, uvs.y3 - uvs.y0, uvs.x0, uvs.y0);
      var orig = tex.orig;
      var trim = tex.trim;
      if (trim) {
        tempMat.set(orig.width / trim.width, 0, 0, orig.height / trim.height, -trim.x / trim.width, -trim.y / trim.height);
        this.mapCoord.append(tempMat);
      }
      var texBase = tex.baseTexture;
      var frame = this.uClampFrame;
      var margin = this.clampMargin / texBase.resolution;
      var offset = this.clampOffset;
      frame[0] = (tex._frame.x + margin + offset) / texBase.width;
      frame[1] = (tex._frame.y + margin + offset) / texBase.height;
      frame[2] = (tex._frame.x + tex._frame.width - margin + offset) / texBase.width;
      frame[3] = (tex._frame.y + tex._frame.height - margin + offset) / texBase.height;
      this.uClampOffset[0] = offset / texBase.realWidth;
      this.uClampOffset[1] = offset / texBase.realHeight;
      this.isSimple = tex._frame.width === texBase.width && tex._frame.height === texBase.height && tex.rotate === 0;
      return true;
    };
    return TextureMatrix2;
  }();
  var SpriteMaskFilter = function(_super) {
    __extends3(SpriteMaskFilter2, _super);
    function SpriteMaskFilter2(sprite) {
      var _this = this;
      var maskMatrix = new Matrix();
      _this = _super.call(this, vertex, fragment) || this;
      sprite.renderable = false;
      _this.maskSprite = sprite;
      _this.maskMatrix = maskMatrix;
      return _this;
    }
    SpriteMaskFilter2.prototype.apply = function(filterManager, input, output, clearMode) {
      var maskSprite = this.maskSprite;
      var tex = maskSprite._texture;
      if (!tex.valid) {
        return;
      }
      if (!tex.uvMatrix) {
        tex.uvMatrix = new TextureMatrix(tex, 0);
      }
      tex.uvMatrix.update();
      this.uniforms.npmAlpha = tex.baseTexture.alphaMode ? 0 : 1;
      this.uniforms.mask = tex;
      this.uniforms.otherMatrix = filterManager.calculateSpriteMatrix(this.maskMatrix, maskSprite).prepend(tex.uvMatrix.mapCoord);
      this.uniforms.alpha = maskSprite.worldAlpha;
      this.uniforms.maskClamp = tex.uvMatrix.uClampFrame;
      filterManager.applyFilter(this, input, output, clearMode);
    };
    return SpriteMaskFilter2;
  }(Filter);
  var MaskSystem = function(_super) {
    __extends3(MaskSystem2, _super);
    function MaskSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.enableScissor = false;
      _this.alphaMaskPool = [];
      _this.maskDataPool = [];
      _this.maskStack = [];
      _this.alphaMaskIndex = 0;
      return _this;
    }
    MaskSystem2.prototype.setMaskStack = function(maskStack) {
      this.maskStack = maskStack;
      this.renderer.scissor.setMaskStack(maskStack);
      this.renderer.stencil.setMaskStack(maskStack);
    };
    MaskSystem2.prototype.push = function(target, maskDataOrTarget) {
      var maskData = maskDataOrTarget;
      if (!maskData.isMaskData) {
        var d = this.maskDataPool.pop() || new MaskData();
        d.pooled = true;
        d.maskObject = maskDataOrTarget;
        maskData = d;
      }
      if (maskData.autoDetect) {
        this.detect(maskData);
      }
      maskData.copyCountersOrReset(this.maskStack[this.maskStack.length - 1]);
      maskData._target = target;
      switch (maskData.type) {
        case MASK_TYPES.SCISSOR:
          this.maskStack.push(maskData);
          this.renderer.scissor.push(maskData);
          break;
        case MASK_TYPES.STENCIL:
          this.maskStack.push(maskData);
          this.renderer.stencil.push(maskData);
          break;
        case MASK_TYPES.SPRITE:
          maskData.copyCountersOrReset(null);
          this.pushSpriteMask(maskData);
          this.maskStack.push(maskData);
          break;
        default:
          break;
      }
    };
    MaskSystem2.prototype.pop = function(target) {
      var maskData = this.maskStack.pop();
      if (!maskData || maskData._target !== target) {
        return;
      }
      switch (maskData.type) {
        case MASK_TYPES.SCISSOR:
          this.renderer.scissor.pop();
          break;
        case MASK_TYPES.STENCIL:
          this.renderer.stencil.pop(maskData.maskObject);
          break;
        case MASK_TYPES.SPRITE:
          this.popSpriteMask();
          break;
        default:
          break;
      }
      maskData.reset();
      if (maskData.pooled) {
        this.maskDataPool.push(maskData);
      }
    };
    MaskSystem2.prototype.detect = function(maskData) {
      var maskObject = maskData.maskObject;
      if (maskObject.isSprite) {
        maskData.type = MASK_TYPES.SPRITE;
        return;
      }
      maskData.type = MASK_TYPES.STENCIL;
      if (this.enableScissor && maskObject.isFastRect && maskObject.isFastRect()) {
        var matrix = maskObject.worldTransform;
        var rotX = Math.atan2(matrix.b, matrix.a);
        var rotXY = Math.atan2(matrix.d, matrix.c);
        rotX = Math.round(rotX * (180 / Math.PI) * 100);
        rotXY = Math.round(rotXY * (180 / Math.PI) * 100) - rotX;
        rotX = (rotX % 9e3 + 9e3) % 9e3;
        rotXY = (rotXY % 18e3 + 18e3) % 18e3;
        if (rotX === 0 && rotXY === 9e3) {
          maskData.type = MASK_TYPES.SCISSOR;
        }
      }
    };
    MaskSystem2.prototype.pushSpriteMask = function(maskData) {
      var maskObject = maskData.maskObject;
      var target = maskData._target;
      var alphaMaskFilter = this.alphaMaskPool[this.alphaMaskIndex];
      if (!alphaMaskFilter) {
        alphaMaskFilter = this.alphaMaskPool[this.alphaMaskIndex] = [new SpriteMaskFilter(maskObject)];
      }
      alphaMaskFilter[0].resolution = this.renderer.resolution;
      alphaMaskFilter[0].maskSprite = maskObject;
      var stashFilterArea = target.filterArea;
      target.filterArea = maskObject.getBounds(true);
      this.renderer.filter.push(target, alphaMaskFilter);
      target.filterArea = stashFilterArea;
      this.alphaMaskIndex++;
    };
    MaskSystem2.prototype.popSpriteMask = function() {
      this.renderer.filter.pop();
      this.alphaMaskIndex--;
    };
    return MaskSystem2;
  }(System);
  var AbstractMaskSystem = function(_super) {
    __extends3(AbstractMaskSystem2, _super);
    function AbstractMaskSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.maskStack = [];
      _this.glConst = 0;
      return _this;
    }
    AbstractMaskSystem2.prototype.getStackLength = function() {
      return this.maskStack.length;
    };
    AbstractMaskSystem2.prototype.setMaskStack = function(maskStack) {
      var gl = this.renderer.gl;
      var curStackLen = this.getStackLength();
      this.maskStack = maskStack;
      var newStackLen = this.getStackLength();
      if (newStackLen !== curStackLen) {
        if (newStackLen === 0) {
          gl.disable(this.glConst);
        } else {
          gl.enable(this.glConst);
          this._useCurrent();
        }
      }
    };
    AbstractMaskSystem2.prototype._useCurrent = function() {
    };
    AbstractMaskSystem2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      this.maskStack = null;
    };
    return AbstractMaskSystem2;
  }(System);
  var ScissorSystem = function(_super) {
    __extends3(ScissorSystem2, _super);
    function ScissorSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.glConst = WebGLRenderingContext.SCISSOR_TEST;
      return _this;
    }
    ScissorSystem2.prototype.getStackLength = function() {
      var maskData = this.maskStack[this.maskStack.length - 1];
      if (maskData) {
        return maskData._scissorCounter;
      }
      return 0;
    };
    ScissorSystem2.prototype.push = function(maskData) {
      var maskObject = maskData.maskObject;
      maskObject.renderable = true;
      var prevData = maskData._scissorRect;
      var bounds = maskObject.getBounds(true);
      var gl = this.renderer.gl;
      maskObject.renderable = false;
      if (prevData) {
        bounds.fit(prevData);
      } else {
        gl.enable(gl.SCISSOR_TEST);
      }
      maskData._scissorCounter++;
      maskData._scissorRect = bounds;
      this._useCurrent();
    };
    ScissorSystem2.prototype.pop = function() {
      var gl = this.renderer.gl;
      if (this.getStackLength() > 0) {
        this._useCurrent();
      } else {
        gl.disable(gl.SCISSOR_TEST);
      }
    };
    ScissorSystem2.prototype._useCurrent = function() {
      var rect = this.maskStack[this.maskStack.length - 1]._scissorRect;
      var rt = this.renderer.renderTexture.current;
      var _a2 = this.renderer.projection, transform = _a2.transform, sourceFrame = _a2.sourceFrame, destinationFrame = _a2.destinationFrame;
      var resolution = rt ? rt.resolution : this.renderer.resolution;
      var x = (rect.x - sourceFrame.x) * resolution + destinationFrame.x;
      var y = (rect.y - sourceFrame.y) * resolution + destinationFrame.y;
      var width = rect.width * resolution;
      var height = rect.height * resolution;
      if (transform) {
        x += transform.tx * resolution;
        y += transform.ty * resolution;
      }
      if (!rt) {
        y = this.renderer.height - height - y;
      }
      this.renderer.gl.scissor(x, y, width, height);
    };
    return ScissorSystem2;
  }(AbstractMaskSystem);
  var StencilSystem = function(_super) {
    __extends3(StencilSystem2, _super);
    function StencilSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.glConst = WebGLRenderingContext.STENCIL_TEST;
      return _this;
    }
    StencilSystem2.prototype.getStackLength = function() {
      var maskData = this.maskStack[this.maskStack.length - 1];
      if (maskData) {
        return maskData._stencilCounter;
      }
      return 0;
    };
    StencilSystem2.prototype.push = function(maskData) {
      var maskObject = maskData.maskObject;
      var gl = this.renderer.gl;
      var prevMaskCount = maskData._stencilCounter;
      if (prevMaskCount === 0) {
        this.renderer.framebuffer.forceStencil();
        gl.enable(gl.STENCIL_TEST);
      }
      maskData._stencilCounter++;
      gl.colorMask(false, false, false, false);
      gl.stencilFunc(gl.EQUAL, prevMaskCount, this._getBitwiseMask());
      gl.stencilOp(gl.KEEP, gl.KEEP, gl.INCR);
      maskObject.renderable = true;
      maskObject.render(this.renderer);
      this.renderer.batch.flush();
      maskObject.renderable = false;
      this._useCurrent();
    };
    StencilSystem2.prototype.pop = function(maskObject) {
      var gl = this.renderer.gl;
      if (this.getStackLength() === 0) {
        gl.disable(gl.STENCIL_TEST);
        gl.clear(gl.STENCIL_BUFFER_BIT);
        gl.clearStencil(0);
      } else {
        gl.colorMask(false, false, false, false);
        gl.stencilOp(gl.KEEP, gl.KEEP, gl.DECR);
        maskObject.renderable = true;
        maskObject.render(this.renderer);
        this.renderer.batch.flush();
        maskObject.renderable = false;
        this._useCurrent();
      }
    };
    StencilSystem2.prototype._useCurrent = function() {
      var gl = this.renderer.gl;
      gl.colorMask(true, true, true, true);
      gl.stencilFunc(gl.EQUAL, this.getStackLength(), this._getBitwiseMask());
      gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);
    };
    StencilSystem2.prototype._getBitwiseMask = function() {
      return (1 << this.getStackLength()) - 1;
    };
    return StencilSystem2;
  }(AbstractMaskSystem);
  var ProjectionSystem = function(_super) {
    __extends3(ProjectionSystem2, _super);
    function ProjectionSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.destinationFrame = null;
      _this.sourceFrame = null;
      _this.defaultFrame = null;
      _this.projectionMatrix = new Matrix();
      _this.transform = null;
      return _this;
    }
    ProjectionSystem2.prototype.update = function(destinationFrame, sourceFrame, resolution, root) {
      this.destinationFrame = destinationFrame || this.destinationFrame || this.defaultFrame;
      this.sourceFrame = sourceFrame || this.sourceFrame || destinationFrame;
      this.calculateProjection(this.destinationFrame, this.sourceFrame, resolution, root);
      if (this.transform) {
        this.projectionMatrix.append(this.transform);
      }
      var renderer = this.renderer;
      renderer.globalUniforms.uniforms.projectionMatrix = this.projectionMatrix;
      renderer.globalUniforms.update();
      if (renderer.shader.shader) {
        renderer.shader.syncUniformGroup(renderer.shader.shader.uniforms.globals);
      }
    };
    ProjectionSystem2.prototype.calculateProjection = function(_destinationFrame, sourceFrame, _resolution, root) {
      var pm = this.projectionMatrix;
      var sign2 = !root ? 1 : -1;
      pm.identity();
      pm.a = 1 / sourceFrame.width * 2;
      pm.d = sign2 * (1 / sourceFrame.height * 2);
      pm.tx = -1 - sourceFrame.x * pm.a;
      pm.ty = -sign2 - sourceFrame.y * pm.d;
    };
    ProjectionSystem2.prototype.setTransform = function(_matrix) {
    };
    return ProjectionSystem2;
  }(System);
  var tempRect = new Rectangle();
  var tempRect2 = new Rectangle();
  var viewportFrame = new Rectangle();
  var RenderTextureSystem = function(_super) {
    __extends3(RenderTextureSystem2, _super);
    function RenderTextureSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.clearColor = renderer._backgroundColorRgba;
      _this.defaultMaskStack = [];
      _this.current = null;
      _this.sourceFrame = new Rectangle();
      _this.destinationFrame = new Rectangle();
      return _this;
    }
    RenderTextureSystem2.prototype.bind = function(renderTexture, sourceFrame, destinationFrame) {
      if (renderTexture === void 0) {
        renderTexture = null;
      }
      var renderer = this.renderer;
      this.current = renderTexture;
      var baseTexture;
      var framebuffer;
      var resolution;
      if (renderTexture) {
        baseTexture = renderTexture.baseTexture;
        resolution = baseTexture.resolution;
        if (!sourceFrame) {
          tempRect.width = renderTexture.frame.width;
          tempRect.height = renderTexture.frame.height;
          sourceFrame = tempRect;
        }
        if (!destinationFrame) {
          tempRect2.x = renderTexture.frame.x;
          tempRect2.y = renderTexture.frame.y;
          tempRect2.width = sourceFrame.width;
          tempRect2.height = sourceFrame.height;
          destinationFrame = tempRect2;
        }
        framebuffer = baseTexture.framebuffer;
      } else {
        resolution = renderer.resolution;
        if (!sourceFrame) {
          tempRect.width = renderer.screen.width;
          tempRect.height = renderer.screen.height;
          sourceFrame = tempRect;
        }
        if (!destinationFrame) {
          destinationFrame = tempRect;
          destinationFrame.width = sourceFrame.width;
          destinationFrame.height = sourceFrame.height;
        }
      }
      viewportFrame.x = destinationFrame.x * resolution;
      viewportFrame.y = destinationFrame.y * resolution;
      viewportFrame.width = destinationFrame.width * resolution;
      viewportFrame.height = destinationFrame.height * resolution;
      this.renderer.framebuffer.bind(framebuffer, viewportFrame);
      this.renderer.projection.update(destinationFrame, sourceFrame, resolution, !framebuffer);
      if (renderTexture) {
        this.renderer.mask.setMaskStack(baseTexture.maskStack);
      } else {
        this.renderer.mask.setMaskStack(this.defaultMaskStack);
      }
      this.sourceFrame.copyFrom(sourceFrame);
      this.destinationFrame.copyFrom(destinationFrame);
    };
    RenderTextureSystem2.prototype.clear = function(clearColor, mask) {
      if (this.current) {
        clearColor = clearColor || this.current.baseTexture.clearColor;
      } else {
        clearColor = clearColor || this.clearColor;
      }
      this.renderer.framebuffer.clear(clearColor[0], clearColor[1], clearColor[2], clearColor[3], mask);
    };
    RenderTextureSystem2.prototype.resize = function() {
      this.bind(null);
    };
    RenderTextureSystem2.prototype.reset = function() {
      this.bind(null);
    };
    return RenderTextureSystem2;
  }(System);
  var IGLUniformData = function() {
    function IGLUniformData2() {
    }
    return IGLUniformData2;
  }();
  var GLProgram = function() {
    function GLProgram2(program, uniformData) {
      this.program = program;
      this.uniformData = uniformData;
      this.uniformGroups = {};
    }
    GLProgram2.prototype.destroy = function() {
      this.uniformData = null;
      this.uniformGroups = null;
      this.program = null;
    };
    return GLProgram2;
  }();
  var UID$4 = 0;
  var defaultSyncData = {textureCount: 0};
  var ShaderSystem = function(_super) {
    __extends3(ShaderSystem2, _super);
    function ShaderSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.destroyed = false;
      _this.systemCheck();
      _this.gl = null;
      _this.shader = null;
      _this.program = null;
      _this.cache = {};
      _this.id = UID$4++;
      return _this;
    }
    ShaderSystem2.prototype.systemCheck = function() {
      if (!unsafeEvalSupported()) {
        throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.");
      }
    };
    ShaderSystem2.prototype.contextChange = function(gl) {
      this.gl = gl;
      this.reset();
    };
    ShaderSystem2.prototype.bind = function(shader, dontSync) {
      shader.uniforms.globals = this.renderer.globalUniforms;
      var program = shader.program;
      var glProgram = program.glPrograms[this.renderer.CONTEXT_UID] || this.generateShader(shader);
      this.shader = shader;
      if (this.program !== program) {
        this.program = program;
        this.gl.useProgram(glProgram.program);
      }
      if (!dontSync) {
        defaultSyncData.textureCount = 0;
        this.syncUniformGroup(shader.uniformGroup, defaultSyncData);
      }
      return glProgram;
    };
    ShaderSystem2.prototype.setUniforms = function(uniforms) {
      var shader = this.shader.program;
      var glProgram = shader.glPrograms[this.renderer.CONTEXT_UID];
      shader.syncUniforms(glProgram.uniformData, uniforms, this.renderer);
    };
    ShaderSystem2.prototype.syncUniformGroup = function(group, syncData) {
      var glProgram = this.getglProgram();
      if (!group.static || group.dirtyId !== glProgram.uniformGroups[group.id]) {
        glProgram.uniformGroups[group.id] = group.dirtyId;
        this.syncUniforms(group, glProgram, syncData);
      }
    };
    ShaderSystem2.prototype.syncUniforms = function(group, glProgram, syncData) {
      var syncFunc = group.syncUniforms[this.shader.program.id] || this.createSyncGroups(group);
      syncFunc(glProgram.uniformData, group.uniforms, this.renderer, syncData);
    };
    ShaderSystem2.prototype.createSyncGroups = function(group) {
      var id = this.getSignature(group, this.shader.program.uniformData);
      if (!this.cache[id]) {
        this.cache[id] = generateUniformsSync(group, this.shader.program.uniformData);
      }
      group.syncUniforms[this.shader.program.id] = this.cache[id];
      return group.syncUniforms[this.shader.program.id];
    };
    ShaderSystem2.prototype.getSignature = function(group, uniformData) {
      var uniforms = group.uniforms;
      var strings = [];
      for (var i in uniforms) {
        strings.push(i);
        if (uniformData[i]) {
          strings.push(uniformData[i].type);
        }
      }
      return strings.join("-");
    };
    ShaderSystem2.prototype.getglProgram = function() {
      if (this.shader) {
        return this.shader.program.glPrograms[this.renderer.CONTEXT_UID];
      }
      return null;
    };
    ShaderSystem2.prototype.generateShader = function(shader) {
      var gl = this.gl;
      var program = shader.program;
      var attribMap = {};
      for (var i in program.attributeData) {
        attribMap[i] = program.attributeData[i].location;
      }
      var shaderProgram = compileProgram(gl, program.vertexSrc, program.fragmentSrc, attribMap);
      var uniformData = {};
      for (var i in program.uniformData) {
        var data = program.uniformData[i];
        uniformData[i] = {
          location: gl.getUniformLocation(shaderProgram, i),
          value: defaultValue(data.type, data.size)
        };
      }
      var glProgram = new GLProgram(shaderProgram, uniformData);
      program.glPrograms[this.renderer.CONTEXT_UID] = glProgram;
      return glProgram;
    };
    ShaderSystem2.prototype.reset = function() {
      this.program = null;
      this.shader = null;
    };
    ShaderSystem2.prototype.destroy = function() {
      this.destroyed = true;
    };
    return ShaderSystem2;
  }(System);
  function mapWebGLBlendModesToPixi(gl, array) {
    if (array === void 0) {
      array = [];
    }
    array[BLEND_MODES.NORMAL] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.ADD] = [gl.ONE, gl.ONE];
    array[BLEND_MODES.MULTIPLY] = [gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.SCREEN] = [gl.ONE, gl.ONE_MINUS_SRC_COLOR, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.OVERLAY] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.DARKEN] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.LIGHTEN] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.COLOR_DODGE] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.COLOR_BURN] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.HARD_LIGHT] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.SOFT_LIGHT] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.DIFFERENCE] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.EXCLUSION] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.HUE] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.SATURATION] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.COLOR] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.LUMINOSITY] = [gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.NONE] = [0, 0];
    array[BLEND_MODES.NORMAL_NPM] = [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.ADD_NPM] = [gl.SRC_ALPHA, gl.ONE, gl.ONE, gl.ONE];
    array[BLEND_MODES.SCREEN_NPM] = [gl.SRC_ALPHA, gl.ONE_MINUS_SRC_COLOR, gl.ONE, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.SRC_IN] = [gl.DST_ALPHA, gl.ZERO];
    array[BLEND_MODES.SRC_OUT] = [gl.ONE_MINUS_DST_ALPHA, gl.ZERO];
    array[BLEND_MODES.SRC_ATOP] = [gl.DST_ALPHA, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.DST_OVER] = [gl.ONE_MINUS_DST_ALPHA, gl.ONE];
    array[BLEND_MODES.DST_IN] = [gl.ZERO, gl.SRC_ALPHA];
    array[BLEND_MODES.DST_OUT] = [gl.ZERO, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.DST_ATOP] = [gl.ONE_MINUS_DST_ALPHA, gl.SRC_ALPHA];
    array[BLEND_MODES.XOR] = [gl.ONE_MINUS_DST_ALPHA, gl.ONE_MINUS_SRC_ALPHA];
    array[BLEND_MODES.SUBTRACT] = [gl.ONE, gl.ONE, gl.ONE, gl.ONE, gl.FUNC_REVERSE_SUBTRACT, gl.FUNC_ADD];
    return array;
  }
  var BLEND$1 = 0;
  var OFFSET$1 = 1;
  var CULLING$1 = 2;
  var DEPTH_TEST$1 = 3;
  var WINDING$1 = 4;
  var StateSystem = function(_super) {
    __extends3(StateSystem2, _super);
    function StateSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.gl = null;
      _this.stateId = 0;
      _this.polygonOffset = 0;
      _this.blendMode = BLEND_MODES.NONE;
      _this._blendEq = false;
      _this.map = [];
      _this.map[BLEND$1] = _this.setBlend;
      _this.map[OFFSET$1] = _this.setOffset;
      _this.map[CULLING$1] = _this.setCullFace;
      _this.map[DEPTH_TEST$1] = _this.setDepthTest;
      _this.map[WINDING$1] = _this.setFrontFace;
      _this.checks = [];
      _this.defaultState = new State();
      _this.defaultState.blend = true;
      return _this;
    }
    StateSystem2.prototype.contextChange = function(gl) {
      this.gl = gl;
      this.blendModes = mapWebGLBlendModesToPixi(gl);
      this.set(this.defaultState);
      this.reset();
    };
    StateSystem2.prototype.set = function(state) {
      state = state || this.defaultState;
      if (this.stateId !== state.data) {
        var diff = this.stateId ^ state.data;
        var i = 0;
        while (diff) {
          if (diff & 1) {
            this.map[i].call(this, !!(state.data & 1 << i));
          }
          diff = diff >> 1;
          i++;
        }
        this.stateId = state.data;
      }
      for (var i = 0; i < this.checks.length; i++) {
        this.checks[i](this, state);
      }
    };
    StateSystem2.prototype.forceState = function(state) {
      state = state || this.defaultState;
      for (var i = 0; i < this.map.length; i++) {
        this.map[i].call(this, !!(state.data & 1 << i));
      }
      for (var i = 0; i < this.checks.length; i++) {
        this.checks[i](this, state);
      }
      this.stateId = state.data;
    };
    StateSystem2.prototype.setBlend = function(value) {
      this.updateCheck(StateSystem2.checkBlendMode, value);
      this.gl[value ? "enable" : "disable"](this.gl.BLEND);
    };
    StateSystem2.prototype.setOffset = function(value) {
      this.updateCheck(StateSystem2.checkPolygonOffset, value);
      this.gl[value ? "enable" : "disable"](this.gl.POLYGON_OFFSET_FILL);
    };
    StateSystem2.prototype.setDepthTest = function(value) {
      this.gl[value ? "enable" : "disable"](this.gl.DEPTH_TEST);
    };
    StateSystem2.prototype.setCullFace = function(value) {
      this.gl[value ? "enable" : "disable"](this.gl.CULL_FACE);
    };
    StateSystem2.prototype.setFrontFace = function(value) {
      this.gl.frontFace(this.gl[value ? "CW" : "CCW"]);
    };
    StateSystem2.prototype.setBlendMode = function(value) {
      if (value === this.blendMode) {
        return;
      }
      this.blendMode = value;
      var mode = this.blendModes[value];
      var gl = this.gl;
      if (mode.length === 2) {
        gl.blendFunc(mode[0], mode[1]);
      } else {
        gl.blendFuncSeparate(mode[0], mode[1], mode[2], mode[3]);
      }
      if (mode.length === 6) {
        this._blendEq = true;
        gl.blendEquationSeparate(mode[4], mode[5]);
      } else if (this._blendEq) {
        this._blendEq = false;
        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
      }
    };
    StateSystem2.prototype.setPolygonOffset = function(value, scale) {
      this.gl.polygonOffset(value, scale);
    };
    StateSystem2.prototype.reset = function() {
      this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, false);
      this.forceState(this.defaultState);
      this._blendEq = true;
      this.blendMode = -1;
      this.setBlendMode(0);
    };
    StateSystem2.prototype.updateCheck = function(func, value) {
      var index2 = this.checks.indexOf(func);
      if (value && index2 === -1) {
        this.checks.push(func);
      } else if (!value && index2 !== -1) {
        this.checks.splice(index2, 1);
      }
    };
    StateSystem2.checkBlendMode = function(system, state) {
      system.setBlendMode(state.blendMode);
    };
    StateSystem2.checkPolygonOffset = function(system, state) {
      system.setPolygonOffset(1, state.polygonOffset);
    };
    return StateSystem2;
  }(System);
  var TextureGCSystem = function(_super) {
    __extends3(TextureGCSystem2, _super);
    function TextureGCSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.count = 0;
      _this.checkCount = 0;
      _this.maxIdle = settings.GC_MAX_IDLE;
      _this.checkCountMax = settings.GC_MAX_CHECK_COUNT;
      _this.mode = settings.GC_MODE;
      return _this;
    }
    TextureGCSystem2.prototype.postrender = function() {
      if (!this.renderer.renderingToScreen) {
        return;
      }
      this.count++;
      if (this.mode === GC_MODES.MANUAL) {
        return;
      }
      this.checkCount++;
      if (this.checkCount > this.checkCountMax) {
        this.checkCount = 0;
        this.run();
      }
    };
    TextureGCSystem2.prototype.run = function() {
      var tm = this.renderer.texture;
      var managedTextures = tm.managedTextures;
      var wasRemoved = false;
      for (var i = 0; i < managedTextures.length; i++) {
        var texture = managedTextures[i];
        if (!texture.framebuffer && this.count - texture.touched > this.maxIdle) {
          tm.destroyTexture(texture, true);
          managedTextures[i] = null;
          wasRemoved = true;
        }
      }
      if (wasRemoved) {
        var j = 0;
        for (var i = 0; i < managedTextures.length; i++) {
          if (managedTextures[i] !== null) {
            managedTextures[j++] = managedTextures[i];
          }
        }
        managedTextures.length = j;
      }
    };
    TextureGCSystem2.prototype.unload = function(displayObject) {
      var _a2;
      var tm = this.renderer.texture;
      if ((_a2 = displayObject._texture) === null || _a2 === void 0 ? void 0 : _a2.framebuffer) {
        tm.destroyTexture(displayObject._texture);
      }
      for (var i = displayObject.children.length - 1; i >= 0; i--) {
        this.unload(displayObject.children[i]);
      }
    };
    return TextureGCSystem2;
  }(System);
  var GLTexture = function() {
    function GLTexture2(texture) {
      this.texture = texture;
      this.width = -1;
      this.height = -1;
      this.dirtyId = -1;
      this.dirtyStyleId = -1;
      this.mipmap = false;
      this.wrapMode = 33071;
      this.type = 6408;
      this.internalFormat = 5121;
    }
    return GLTexture2;
  }();
  var TextureSystem = function(_super) {
    __extends3(TextureSystem2, _super);
    function TextureSystem2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.boundTextures = [];
      _this.currentLocation = -1;
      _this.managedTextures = [];
      _this._unknownBoundTextures = false;
      _this.unknownTexture = new BaseTexture();
      return _this;
    }
    TextureSystem2.prototype.contextChange = function() {
      var gl = this.gl = this.renderer.gl;
      this.CONTEXT_UID = this.renderer.CONTEXT_UID;
      this.webGLVersion = this.renderer.context.webGLVersion;
      var maxTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);
      this.boundTextures.length = maxTextures;
      for (var i = 0; i < maxTextures; i++) {
        this.boundTextures[i] = null;
      }
      this.emptyTextures = {};
      var emptyTexture2D = new GLTexture(gl.createTexture());
      gl.bindTexture(gl.TEXTURE_2D, emptyTexture2D.texture);
      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array(4));
      this.emptyTextures[gl.TEXTURE_2D] = emptyTexture2D;
      this.emptyTextures[gl.TEXTURE_CUBE_MAP] = new GLTexture(gl.createTexture());
      gl.bindTexture(gl.TEXTURE_CUBE_MAP, this.emptyTextures[gl.TEXTURE_CUBE_MAP].texture);
      for (var i = 0; i < 6; i++) {
        gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);
      }
      gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
      gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
      for (var i = 0; i < this.boundTextures.length; i++) {
        this.bind(null, i);
      }
    };
    TextureSystem2.prototype.bind = function(texture, location) {
      if (location === void 0) {
        location = 0;
      }
      var gl = this.gl;
      if (texture) {
        texture = texture.castToBaseTexture();
        if (texture.parentTextureArray) {
          return;
        }
        if (texture.valid) {
          texture.touched = this.renderer.textureGC.count;
          var glTexture = texture._glTextures[this.CONTEXT_UID] || this.initTexture(texture);
          if (this.boundTextures[location] !== texture) {
            if (this.currentLocation !== location) {
              this.currentLocation = location;
              gl.activeTexture(gl.TEXTURE0 + location);
            }
            gl.bindTexture(texture.target, glTexture.texture);
          }
          if (glTexture.dirtyId !== texture.dirtyId) {
            if (this.currentLocation !== location) {
              this.currentLocation = location;
              gl.activeTexture(gl.TEXTURE0 + location);
            }
            this.updateTexture(texture);
          }
          this.boundTextures[location] = texture;
        }
      } else {
        if (this.currentLocation !== location) {
          this.currentLocation = location;
          gl.activeTexture(gl.TEXTURE0 + location);
        }
        gl.bindTexture(gl.TEXTURE_2D, this.emptyTextures[gl.TEXTURE_2D].texture);
        this.boundTextures[location] = null;
      }
    };
    TextureSystem2.prototype.reset = function() {
      this._unknownBoundTextures = true;
      this.currentLocation = -1;
      for (var i = 0; i < this.boundTextures.length; i++) {
        this.boundTextures[i] = this.unknownTexture;
      }
    };
    TextureSystem2.prototype.unbind = function(texture) {
      var _a2 = this, gl = _a2.gl, boundTextures = _a2.boundTextures;
      if (this._unknownBoundTextures) {
        this._unknownBoundTextures = false;
        for (var i = 0; i < boundTextures.length; i++) {
          if (boundTextures[i] === this.unknownTexture) {
            this.bind(null, i);
          }
        }
      }
      for (var i = 0; i < boundTextures.length; i++) {
        if (boundTextures[i] === texture) {
          if (this.currentLocation !== i) {
            gl.activeTexture(gl.TEXTURE0 + i);
            this.currentLocation = i;
          }
          gl.bindTexture(texture.target, this.emptyTextures[texture.target].texture);
          boundTextures[i] = null;
        }
      }
    };
    TextureSystem2.prototype.initTexture = function(texture) {
      var glTexture = new GLTexture(this.gl.createTexture());
      glTexture.dirtyId = -1;
      texture._glTextures[this.CONTEXT_UID] = glTexture;
      this.managedTextures.push(texture);
      texture.on("dispose", this.destroyTexture, this);
      return glTexture;
    };
    TextureSystem2.prototype.initTextureType = function(texture, glTexture) {
      glTexture.internalFormat = texture.format;
      glTexture.type = texture.type;
      if (this.webGLVersion !== 2) {
        return;
      }
      var gl = this.renderer.gl;
      if (texture.type === gl.FLOAT && texture.format === gl.RGBA) {
        glTexture.internalFormat = gl.RGBA32F;
      }
      if (texture.type === TYPES.HALF_FLOAT) {
        glTexture.type = gl.HALF_FLOAT;
      }
      if (glTexture.type === gl.HALF_FLOAT && texture.format === gl.RGBA) {
        glTexture.internalFormat = gl.RGBA16F;
      }
    };
    TextureSystem2.prototype.updateTexture = function(texture) {
      var glTexture = texture._glTextures[this.CONTEXT_UID];
      if (!glTexture) {
        return;
      }
      var renderer = this.renderer;
      this.initTextureType(texture, glTexture);
      if (texture.resource && texture.resource.upload(renderer, texture, glTexture))
        ;
      else {
        var width = texture.realWidth;
        var height = texture.realHeight;
        var gl = renderer.gl;
        if (glTexture.width !== width || glTexture.height !== height || glTexture.dirtyId < 0) {
          glTexture.width = width;
          glTexture.height = height;
          gl.texImage2D(texture.target, 0, glTexture.internalFormat, width, height, 0, texture.format, glTexture.type, null);
        }
      }
      if (texture.dirtyStyleId !== glTexture.dirtyStyleId) {
        this.updateTextureStyle(texture);
      }
      glTexture.dirtyId = texture.dirtyId;
    };
    TextureSystem2.prototype.destroyTexture = function(texture, skipRemove) {
      var gl = this.gl;
      texture = texture.castToBaseTexture();
      if (texture._glTextures[this.CONTEXT_UID]) {
        this.unbind(texture);
        gl.deleteTexture(texture._glTextures[this.CONTEXT_UID].texture);
        texture.off("dispose", this.destroyTexture, this);
        delete texture._glTextures[this.CONTEXT_UID];
        if (!skipRemove) {
          var i = this.managedTextures.indexOf(texture);
          if (i !== -1) {
            removeItems(this.managedTextures, i, 1);
          }
        }
      }
    };
    TextureSystem2.prototype.updateTextureStyle = function(texture) {
      var glTexture = texture._glTextures[this.CONTEXT_UID];
      if (!glTexture) {
        return;
      }
      if ((texture.mipmap === MIPMAP_MODES.POW2 || this.webGLVersion !== 2) && !texture.isPowerOfTwo) {
        glTexture.mipmap = false;
      } else {
        glTexture.mipmap = texture.mipmap >= 1;
      }
      if (this.webGLVersion !== 2 && !texture.isPowerOfTwo) {
        glTexture.wrapMode = WRAP_MODES.CLAMP;
      } else {
        glTexture.wrapMode = texture.wrapMode;
      }
      if (texture.resource && texture.resource.style(this.renderer, texture, glTexture))
        ;
      else {
        this.setStyle(texture, glTexture);
      }
      glTexture.dirtyStyleId = texture.dirtyStyleId;
    };
    TextureSystem2.prototype.setStyle = function(texture, glTexture) {
      var gl = this.gl;
      if (glTexture.mipmap) {
        gl.generateMipmap(texture.target);
      }
      gl.texParameteri(texture.target, gl.TEXTURE_WRAP_S, glTexture.wrapMode);
      gl.texParameteri(texture.target, gl.TEXTURE_WRAP_T, glTexture.wrapMode);
      if (glTexture.mipmap) {
        gl.texParameteri(texture.target, gl.TEXTURE_MIN_FILTER, texture.scaleMode === SCALE_MODES.LINEAR ? gl.LINEAR_MIPMAP_LINEAR : gl.NEAREST_MIPMAP_NEAREST);
        var anisotropicExt = this.renderer.context.extensions.anisotropicFiltering;
        if (anisotropicExt && texture.anisotropicLevel > 0 && texture.scaleMode === SCALE_MODES.LINEAR) {
          var level = Math.min(texture.anisotropicLevel, gl.getParameter(anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));
          gl.texParameterf(texture.target, anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT, level);
        }
      } else {
        gl.texParameteri(texture.target, gl.TEXTURE_MIN_FILTER, texture.scaleMode === SCALE_MODES.LINEAR ? gl.LINEAR : gl.NEAREST);
      }
      gl.texParameteri(texture.target, gl.TEXTURE_MAG_FILTER, texture.scaleMode === SCALE_MODES.LINEAR ? gl.LINEAR : gl.NEAREST);
    };
    return TextureSystem2;
  }(System);
  var tempMatrix = new Matrix();
  var AbstractRenderer = function(_super) {
    __extends3(AbstractRenderer2, _super);
    function AbstractRenderer2(type, options) {
      if (type === void 0) {
        type = RENDERER_TYPE.UNKNOWN;
      }
      var _this = _super.call(this) || this;
      options = Object.assign({}, settings.RENDER_OPTIONS, options);
      if (options.roundPixels) {
        settings.ROUND_PIXELS = options.roundPixels;
        deprecation("5.0.0", "Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS", 2);
      }
      _this.options = options;
      _this.type = type;
      _this.screen = new Rectangle(0, 0, options.width, options.height);
      _this.view = options.view || document.createElement("canvas");
      _this.resolution = options.resolution || settings.RESOLUTION;
      _this.transparent = options.transparent;
      _this.autoDensity = options.autoDensity || options.autoResize || false;
      _this.preserveDrawingBuffer = options.preserveDrawingBuffer;
      _this.clearBeforeRender = options.clearBeforeRender;
      _this._backgroundColor = 0;
      _this._backgroundColorRgba = [0, 0, 0, 0];
      _this._backgroundColorString = "#000000";
      _this.backgroundColor = options.backgroundColor || _this._backgroundColor;
      _this._lastObjectRendered = null;
      _this.plugins = {};
      return _this;
    }
    AbstractRenderer2.prototype.initPlugins = function(staticMap) {
      for (var o in staticMap) {
        this.plugins[o] = new staticMap[o](this);
      }
    };
    Object.defineProperty(AbstractRenderer2.prototype, "width", {
      get: function() {
        return this.view.width;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AbstractRenderer2.prototype, "height", {
      get: function() {
        return this.view.height;
      },
      enumerable: false,
      configurable: true
    });
    AbstractRenderer2.prototype.resize = function(screenWidth, screenHeight) {
      this.screen.width = screenWidth;
      this.screen.height = screenHeight;
      this.view.width = screenWidth * this.resolution;
      this.view.height = screenHeight * this.resolution;
      if (this.autoDensity) {
        this.view.style.width = screenWidth + "px";
        this.view.style.height = screenHeight + "px";
      }
      this.emit("resize", screenWidth, screenHeight);
    };
    AbstractRenderer2.prototype.generateTexture = function(displayObject, scaleMode, resolution, region) {
      region = region || displayObject.getLocalBounds(null, true);
      if (region.width === 0) {
        region.width = 1;
      }
      if (region.height === 0) {
        region.height = 1;
      }
      var renderTexture = RenderTexture.create({
        width: region.width | 0,
        height: region.height | 0,
        scaleMode,
        resolution
      });
      tempMatrix.tx = -region.x;
      tempMatrix.ty = -region.y;
      this.render(displayObject, renderTexture, false, tempMatrix, !!displayObject.parent);
      return renderTexture;
    };
    AbstractRenderer2.prototype.destroy = function(removeView) {
      for (var o in this.plugins) {
        this.plugins[o].destroy();
        this.plugins[o] = null;
      }
      if (removeView && this.view.parentNode) {
        this.view.parentNode.removeChild(this.view);
      }
      var thisAny = this;
      thisAny.plugins = null;
      thisAny.type = RENDERER_TYPE.UNKNOWN;
      thisAny.view = null;
      thisAny.screen = null;
      thisAny._tempDisplayObjectParent = null;
      thisAny.options = null;
      this._backgroundColorRgba = null;
      this._backgroundColorString = null;
      this._lastObjectRendered = null;
    };
    Object.defineProperty(AbstractRenderer2.prototype, "backgroundColor", {
      get: function() {
        return this._backgroundColor;
      },
      set: function(value) {
        this._backgroundColor = value;
        this._backgroundColorString = hex2string(value);
        hex2rgb(value, this._backgroundColorRgba);
      },
      enumerable: false,
      configurable: true
    });
    return AbstractRenderer2;
  }(import_eventemitter3.default);
  var Renderer = function(_super) {
    __extends3(Renderer2, _super);
    function Renderer2(options) {
      var _this = _super.call(this, RENDERER_TYPE.WEBGL, options) || this;
      options = _this.options;
      _this.gl = null;
      _this.CONTEXT_UID = 0;
      _this.runners = {
        destroy: new Runner("destroy"),
        contextChange: new Runner("contextChange"),
        reset: new Runner("reset"),
        update: new Runner("update"),
        postrender: new Runner("postrender"),
        prerender: new Runner("prerender"),
        resize: new Runner("resize")
      };
      _this.globalUniforms = new UniformGroup({
        projectionMatrix: new Matrix()
      }, true);
      _this.addSystem(MaskSystem, "mask").addSystem(ContextSystem, "context").addSystem(StateSystem, "state").addSystem(ShaderSystem, "shader").addSystem(TextureSystem, "texture").addSystem(GeometrySystem, "geometry").addSystem(FramebufferSystem, "framebuffer").addSystem(ScissorSystem, "scissor").addSystem(StencilSystem, "stencil").addSystem(ProjectionSystem, "projection").addSystem(TextureGCSystem, "textureGC").addSystem(FilterSystem, "filter").addSystem(RenderTextureSystem, "renderTexture").addSystem(BatchSystem, "batch");
      _this.initPlugins(Renderer2.__plugins);
      if (options.context) {
        _this.context.initFromContext(options.context);
      } else {
        _this.context.initFromOptions({
          alpha: !!_this.transparent,
          antialias: options.antialias,
          premultipliedAlpha: _this.transparent && _this.transparent !== "notMultiplied",
          stencil: true,
          preserveDrawingBuffer: options.preserveDrawingBuffer,
          powerPreference: _this.options.powerPreference
        });
      }
      _this.renderingToScreen = true;
      sayHello(_this.context.webGLVersion === 2 ? "WebGL 2" : "WebGL 1");
      _this.resize(_this.options.width, _this.options.height);
      return _this;
    }
    Renderer2.create = function(options) {
      if (isWebGLSupported()) {
        return new Renderer2(options);
      }
      throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.');
    };
    Renderer2.prototype.addSystem = function(ClassRef, name) {
      if (!name) {
        name = ClassRef.name;
      }
      var system = new ClassRef(this);
      if (this[name]) {
        throw new Error('Whoops! The name "' + name + '" is already in use');
      }
      this[name] = system;
      for (var i in this.runners) {
        this.runners[i].add(system);
      }
      return this;
    };
    Renderer2.prototype.render = function(displayObject, renderTexture, clear, transform, skipUpdateTransform) {
      this.renderingToScreen = !renderTexture;
      this.runners.prerender.emit();
      this.emit("prerender");
      this.projection.transform = transform;
      if (this.context.isLost) {
        return;
      }
      if (!renderTexture) {
        this._lastObjectRendered = displayObject;
      }
      if (!skipUpdateTransform) {
        var cacheParent = displayObject.enableTempParent();
        displayObject.updateTransform();
        displayObject.disableTempParent(cacheParent);
      }
      this.renderTexture.bind(renderTexture);
      this.batch.currentRenderer.start();
      if (clear !== void 0 ? clear : this.clearBeforeRender) {
        this.renderTexture.clear();
      }
      displayObject.render(this);
      this.batch.currentRenderer.flush();
      if (renderTexture) {
        renderTexture.baseTexture.update();
      }
      this.runners.postrender.emit();
      this.projection.transform = null;
      this.emit("postrender");
    };
    Renderer2.prototype.resize = function(screenWidth, screenHeight) {
      _super.prototype.resize.call(this, screenWidth, screenHeight);
      this.runners.resize.emit(screenWidth, screenHeight);
    };
    Renderer2.prototype.reset = function() {
      this.runners.reset.emit();
      return this;
    };
    Renderer2.prototype.clear = function() {
      this.renderTexture.bind();
      this.renderTexture.clear();
    };
    Renderer2.prototype.destroy = function(removeView) {
      this.runners.destroy.emit();
      for (var r in this.runners) {
        this.runners[r].destroy();
      }
      _super.prototype.destroy.call(this, removeView);
      this.gl = null;
    };
    Renderer2.registerPlugin = function(pluginName, ctor) {
      Renderer2.__plugins = Renderer2.__plugins || {};
      Renderer2.__plugins[pluginName] = ctor;
    };
    return Renderer2;
  }(AbstractRenderer);
  function autoDetectRenderer(options) {
    return Renderer.create(options);
  }
  var _default = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";
  var defaultFilter = "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";
  var BatchDrawCall = function() {
    function BatchDrawCall2() {
      this.texArray = null;
      this.blend = 0;
      this.type = DRAW_MODES.TRIANGLES;
      this.start = 0;
      this.size = 0;
      this.data = null;
    }
    return BatchDrawCall2;
  }();
  var BatchTextureArray = function() {
    function BatchTextureArray2() {
      this.elements = [];
      this.ids = [];
      this.count = 0;
    }
    BatchTextureArray2.prototype.clear = function() {
      for (var i = 0; i < this.count; i++) {
        this.elements[i] = null;
      }
      this.count = 0;
    };
    return BatchTextureArray2;
  }();
  var ViewableBuffer = function() {
    function ViewableBuffer2(size) {
      this.rawBinaryData = new ArrayBuffer(size);
      this.uint32View = new Uint32Array(this.rawBinaryData);
      this.float32View = new Float32Array(this.rawBinaryData);
    }
    Object.defineProperty(ViewableBuffer2.prototype, "int8View", {
      get: function() {
        if (!this._int8View) {
          this._int8View = new Int8Array(this.rawBinaryData);
        }
        return this._int8View;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ViewableBuffer2.prototype, "uint8View", {
      get: function() {
        if (!this._uint8View) {
          this._uint8View = new Uint8Array(this.rawBinaryData);
        }
        return this._uint8View;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ViewableBuffer2.prototype, "int16View", {
      get: function() {
        if (!this._int16View) {
          this._int16View = new Int16Array(this.rawBinaryData);
        }
        return this._int16View;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ViewableBuffer2.prototype, "uint16View", {
      get: function() {
        if (!this._uint16View) {
          this._uint16View = new Uint16Array(this.rawBinaryData);
        }
        return this._uint16View;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ViewableBuffer2.prototype, "int32View", {
      get: function() {
        if (!this._int32View) {
          this._int32View = new Int32Array(this.rawBinaryData);
        }
        return this._int32View;
      },
      enumerable: false,
      configurable: true
    });
    ViewableBuffer2.prototype.view = function(type) {
      return this[type + "View"];
    };
    ViewableBuffer2.prototype.destroy = function() {
      this.rawBinaryData = null;
      this._int8View = null;
      this._uint8View = null;
      this._int16View = null;
      this._uint16View = null;
      this._int32View = null;
      this.uint32View = null;
      this.float32View = null;
    };
    ViewableBuffer2.sizeOf = function(type) {
      switch (type) {
        case "int8":
        case "uint8":
          return 1;
        case "int16":
        case "uint16":
          return 2;
        case "int32":
        case "uint32":
        case "float32":
          return 4;
        default:
          throw new Error(type + " isn't a valid view type");
      }
    };
    return ViewableBuffer2;
  }();
  var AbstractBatchRenderer = function(_super) {
    __extends3(AbstractBatchRenderer2, _super);
    function AbstractBatchRenderer2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.shaderGenerator = null;
      _this.geometryClass = null;
      _this.vertexSize = null;
      _this.state = State.for2d();
      _this.size = settings.SPRITE_BATCH_SIZE * 4;
      _this._vertexCount = 0;
      _this._indexCount = 0;
      _this._bufferedElements = [];
      _this._bufferedTextures = [];
      _this._bufferSize = 0;
      _this._shader = null;
      _this._packedGeometries = [];
      _this._packedGeometryPoolSize = 2;
      _this._flushId = 0;
      _this._aBuffers = {};
      _this._iBuffers = {};
      _this.MAX_TEXTURES = 1;
      _this.renderer.on("prerender", _this.onPrerender, _this);
      renderer.runners.contextChange.add(_this);
      _this._dcIndex = 0;
      _this._aIndex = 0;
      _this._iIndex = 0;
      _this._attributeBuffer = null;
      _this._indexBuffer = null;
      _this._tempBoundTextures = [];
      return _this;
    }
    AbstractBatchRenderer2.prototype.contextChange = function() {
      var gl = this.renderer.gl;
      if (settings.PREFER_ENV === ENV.WEBGL_LEGACY) {
        this.MAX_TEXTURES = 1;
      } else {
        this.MAX_TEXTURES = Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS), settings.SPRITE_MAX_TEXTURES);
        this.MAX_TEXTURES = checkMaxIfStatementsInShader(this.MAX_TEXTURES, gl);
      }
      this._shader = this.shaderGenerator.generateShader(this.MAX_TEXTURES);
      for (var i = 0; i < this._packedGeometryPoolSize; i++) {
        this._packedGeometries[i] = new this.geometryClass();
      }
      this.initFlushBuffers();
    };
    AbstractBatchRenderer2.prototype.initFlushBuffers = function() {
      var _drawCallPool = AbstractBatchRenderer2._drawCallPool, _textureArrayPool = AbstractBatchRenderer2._textureArrayPool;
      var MAX_SPRITES = this.size / 4;
      var MAX_TA = Math.floor(MAX_SPRITES / this.MAX_TEXTURES) + 1;
      while (_drawCallPool.length < MAX_SPRITES) {
        _drawCallPool.push(new BatchDrawCall());
      }
      while (_textureArrayPool.length < MAX_TA) {
        _textureArrayPool.push(new BatchTextureArray());
      }
      for (var i = 0; i < this.MAX_TEXTURES; i++) {
        this._tempBoundTextures[i] = null;
      }
    };
    AbstractBatchRenderer2.prototype.onPrerender = function() {
      this._flushId = 0;
    };
    AbstractBatchRenderer2.prototype.render = function(element) {
      if (!element._texture.valid) {
        return;
      }
      if (this._vertexCount + element.vertexData.length / 2 > this.size) {
        this.flush();
      }
      this._vertexCount += element.vertexData.length / 2;
      this._indexCount += element.indices.length;
      this._bufferedTextures[this._bufferSize] = element._texture.baseTexture;
      this._bufferedElements[this._bufferSize++] = element;
    };
    AbstractBatchRenderer2.prototype.buildTexturesAndDrawCalls = function() {
      var _a2 = this, textures = _a2._bufferedTextures, MAX_TEXTURES = _a2.MAX_TEXTURES;
      var textureArrays = AbstractBatchRenderer2._textureArrayPool;
      var batch = this.renderer.batch;
      var boundTextures = this._tempBoundTextures;
      var touch = this.renderer.textureGC.count;
      var TICK = ++BaseTexture._globalBatch;
      var countTexArrays = 0;
      var texArray = textureArrays[0];
      var start = 0;
      batch.copyBoundTextures(boundTextures, MAX_TEXTURES);
      for (var i = 0; i < this._bufferSize; ++i) {
        var tex = textures[i];
        textures[i] = null;
        if (tex._batchEnabled === TICK) {
          continue;
        }
        if (texArray.count >= MAX_TEXTURES) {
          batch.boundArray(texArray, boundTextures, TICK, MAX_TEXTURES);
          this.buildDrawCalls(texArray, start, i);
          start = i;
          texArray = textureArrays[++countTexArrays];
          ++TICK;
        }
        tex._batchEnabled = TICK;
        tex.touched = touch;
        texArray.elements[texArray.count++] = tex;
      }
      if (texArray.count > 0) {
        batch.boundArray(texArray, boundTextures, TICK, MAX_TEXTURES);
        this.buildDrawCalls(texArray, start, this._bufferSize);
        ++countTexArrays;
        ++TICK;
      }
      for (var i = 0; i < boundTextures.length; i++) {
        boundTextures[i] = null;
      }
      BaseTexture._globalBatch = TICK;
    };
    AbstractBatchRenderer2.prototype.buildDrawCalls = function(texArray, start, finish) {
      var _a2 = this, elements = _a2._bufferedElements, _attributeBuffer = _a2._attributeBuffer, _indexBuffer = _a2._indexBuffer, vertexSize = _a2.vertexSize;
      var drawCalls = AbstractBatchRenderer2._drawCallPool;
      var dcIndex = this._dcIndex;
      var aIndex = this._aIndex;
      var iIndex = this._iIndex;
      var drawCall = drawCalls[dcIndex];
      drawCall.start = this._iIndex;
      drawCall.texArray = texArray;
      for (var i = start; i < finish; ++i) {
        var sprite = elements[i];
        var tex = sprite._texture.baseTexture;
        var spriteBlendMode = premultiplyBlendMode[tex.alphaMode ? 1 : 0][sprite.blendMode];
        elements[i] = null;
        if (start < i && drawCall.blend !== spriteBlendMode) {
          drawCall.size = iIndex - drawCall.start;
          start = i;
          drawCall = drawCalls[++dcIndex];
          drawCall.texArray = texArray;
          drawCall.start = iIndex;
        }
        this.packInterleavedGeometry(sprite, _attributeBuffer, _indexBuffer, aIndex, iIndex);
        aIndex += sprite.vertexData.length / 2 * vertexSize;
        iIndex += sprite.indices.length;
        drawCall.blend = spriteBlendMode;
      }
      if (start < finish) {
        drawCall.size = iIndex - drawCall.start;
        ++dcIndex;
      }
      this._dcIndex = dcIndex;
      this._aIndex = aIndex;
      this._iIndex = iIndex;
    };
    AbstractBatchRenderer2.prototype.bindAndClearTexArray = function(texArray) {
      var textureSystem = this.renderer.texture;
      for (var j = 0; j < texArray.count; j++) {
        textureSystem.bind(texArray.elements[j], texArray.ids[j]);
        texArray.elements[j] = null;
      }
      texArray.count = 0;
    };
    AbstractBatchRenderer2.prototype.updateGeometry = function() {
      var _a2 = this, packedGeometries = _a2._packedGeometries, attributeBuffer = _a2._attributeBuffer, indexBuffer = _a2._indexBuffer;
      if (!settings.CAN_UPLOAD_SAME_BUFFER) {
        if (this._packedGeometryPoolSize <= this._flushId) {
          this._packedGeometryPoolSize++;
          packedGeometries[this._flushId] = new this.geometryClass();
        }
        packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData);
        packedGeometries[this._flushId]._indexBuffer.update(indexBuffer);
        this.renderer.geometry.bind(packedGeometries[this._flushId]);
        this.renderer.geometry.updateBuffers();
        this._flushId++;
      } else {
        packedGeometries[this._flushId]._buffer.update(attributeBuffer.rawBinaryData);
        packedGeometries[this._flushId]._indexBuffer.update(indexBuffer);
        this.renderer.geometry.updateBuffers();
      }
    };
    AbstractBatchRenderer2.prototype.drawBatches = function() {
      var dcCount = this._dcIndex;
      var _a2 = this.renderer, gl = _a2.gl, stateSystem = _a2.state;
      var drawCalls = AbstractBatchRenderer2._drawCallPool;
      var curTexArray = null;
      for (var i = 0; i < dcCount; i++) {
        var _b = drawCalls[i], texArray = _b.texArray, type = _b.type, size = _b.size, start = _b.start, blend = _b.blend;
        if (curTexArray !== texArray) {
          curTexArray = texArray;
          this.bindAndClearTexArray(texArray);
        }
        this.state.blendMode = blend;
        stateSystem.set(this.state);
        gl.drawElements(type, size, gl.UNSIGNED_SHORT, start * 2);
      }
    };
    AbstractBatchRenderer2.prototype.flush = function() {
      if (this._vertexCount === 0) {
        return;
      }
      this._attributeBuffer = this.getAttributeBuffer(this._vertexCount);
      this._indexBuffer = this.getIndexBuffer(this._indexCount);
      this._aIndex = 0;
      this._iIndex = 0;
      this._dcIndex = 0;
      this.buildTexturesAndDrawCalls();
      this.updateGeometry();
      this.drawBatches();
      this._bufferSize = 0;
      this._vertexCount = 0;
      this._indexCount = 0;
    };
    AbstractBatchRenderer2.prototype.start = function() {
      this.renderer.state.set(this.state);
      this.renderer.shader.bind(this._shader);
      if (settings.CAN_UPLOAD_SAME_BUFFER) {
        this.renderer.geometry.bind(this._packedGeometries[this._flushId]);
      }
    };
    AbstractBatchRenderer2.prototype.stop = function() {
      this.flush();
    };
    AbstractBatchRenderer2.prototype.destroy = function() {
      for (var i = 0; i < this._packedGeometryPoolSize; i++) {
        if (this._packedGeometries[i]) {
          this._packedGeometries[i].destroy();
        }
      }
      this.renderer.off("prerender", this.onPrerender, this);
      this._aBuffers = null;
      this._iBuffers = null;
      this._packedGeometries = null;
      this._attributeBuffer = null;
      this._indexBuffer = null;
      if (this._shader) {
        this._shader.destroy();
        this._shader = null;
      }
      _super.prototype.destroy.call(this);
    };
    AbstractBatchRenderer2.prototype.getAttributeBuffer = function(size) {
      var roundedP2 = nextPow2(Math.ceil(size / 8));
      var roundedSizeIndex = log2(roundedP2);
      var roundedSize = roundedP2 * 8;
      if (this._aBuffers.length <= roundedSizeIndex) {
        this._iBuffers.length = roundedSizeIndex + 1;
      }
      var buffer = this._aBuffers[roundedSize];
      if (!buffer) {
        this._aBuffers[roundedSize] = buffer = new ViewableBuffer(roundedSize * this.vertexSize * 4);
      }
      return buffer;
    };
    AbstractBatchRenderer2.prototype.getIndexBuffer = function(size) {
      var roundedP2 = nextPow2(Math.ceil(size / 12));
      var roundedSizeIndex = log2(roundedP2);
      var roundedSize = roundedP2 * 12;
      if (this._iBuffers.length <= roundedSizeIndex) {
        this._iBuffers.length = roundedSizeIndex + 1;
      }
      var buffer = this._iBuffers[roundedSizeIndex];
      if (!buffer) {
        this._iBuffers[roundedSizeIndex] = buffer = new Uint16Array(roundedSize);
      }
      return buffer;
    };
    AbstractBatchRenderer2.prototype.packInterleavedGeometry = function(element, attributeBuffer, indexBuffer, aIndex, iIndex) {
      var uint32View = attributeBuffer.uint32View, float32View = attributeBuffer.float32View;
      var packedVertices = aIndex / this.vertexSize;
      var uvs = element.uvs;
      var indicies = element.indices;
      var vertexData = element.vertexData;
      var textureId = element._texture.baseTexture._batchLocation;
      var alpha = Math.min(element.worldAlpha, 1);
      var argb = alpha < 1 && element._texture.baseTexture.alphaMode ? premultiplyTint(element._tintRGB, alpha) : element._tintRGB + (alpha * 255 << 24);
      for (var i = 0; i < vertexData.length; i += 2) {
        float32View[aIndex++] = vertexData[i];
        float32View[aIndex++] = vertexData[i + 1];
        float32View[aIndex++] = uvs[i];
        float32View[aIndex++] = uvs[i + 1];
        uint32View[aIndex++] = argb;
        float32View[aIndex++] = textureId;
      }
      for (var i = 0; i < indicies.length; i++) {
        indexBuffer[iIndex++] = packedVertices + indicies[i];
      }
    };
    AbstractBatchRenderer2._drawCallPool = [];
    AbstractBatchRenderer2._textureArrayPool = [];
    return AbstractBatchRenderer2;
  }(ObjectRenderer);
  var BatchShaderGenerator = function() {
    function BatchShaderGenerator2(vertexSrc, fragTemplate3) {
      this.vertexSrc = vertexSrc;
      this.fragTemplate = fragTemplate3;
      this.programCache = {};
      this.defaultGroupCache = {};
      if (fragTemplate3.indexOf("%count%") < 0) {
        throw new Error('Fragment template must contain "%count%".');
      }
      if (fragTemplate3.indexOf("%forloop%") < 0) {
        throw new Error('Fragment template must contain "%forloop%".');
      }
    }
    BatchShaderGenerator2.prototype.generateShader = function(maxTextures) {
      if (!this.programCache[maxTextures]) {
        var sampleValues = new Int32Array(maxTextures);
        for (var i = 0; i < maxTextures; i++) {
          sampleValues[i] = i;
        }
        this.defaultGroupCache[maxTextures] = UniformGroup.from({uSamplers: sampleValues}, true);
        var fragmentSrc = this.fragTemplate;
        fragmentSrc = fragmentSrc.replace(/%count%/gi, "" + maxTextures);
        fragmentSrc = fragmentSrc.replace(/%forloop%/gi, this.generateSampleSrc(maxTextures));
        this.programCache[maxTextures] = new Program(this.vertexSrc, fragmentSrc);
      }
      var uniforms = {
        tint: new Float32Array([1, 1, 1, 1]),
        translationMatrix: new Matrix(),
        default: this.defaultGroupCache[maxTextures]
      };
      return new Shader(this.programCache[maxTextures], uniforms);
    };
    BatchShaderGenerator2.prototype.generateSampleSrc = function(maxTextures) {
      var src = "";
      src += "\n";
      src += "\n";
      for (var i = 0; i < maxTextures; i++) {
        if (i > 0) {
          src += "\nelse ";
        }
        if (i < maxTextures - 1) {
          src += "if(vTextureId < " + i + ".5)";
        }
        src += "\n{";
        src += "\n	color = texture2D(uSamplers[" + i + "], vTextureCoord);";
        src += "\n}";
      }
      src += "\n";
      src += "\n";
      return src;
    };
    return BatchShaderGenerator2;
  }();
  var BatchGeometry = function(_super) {
    __extends3(BatchGeometry2, _super);
    function BatchGeometry2(_static) {
      if (_static === void 0) {
        _static = false;
      }
      var _this = _super.call(this) || this;
      _this._buffer = new Buffer2(null, _static, false);
      _this._indexBuffer = new Buffer2(null, _static, true);
      _this.addAttribute("aVertexPosition", _this._buffer, 2, false, TYPES.FLOAT).addAttribute("aTextureCoord", _this._buffer, 2, false, TYPES.FLOAT).addAttribute("aColor", _this._buffer, 4, true, TYPES.UNSIGNED_BYTE).addAttribute("aTextureId", _this._buffer, 1, true, TYPES.FLOAT).addIndex(_this._indexBuffer);
      return _this;
    }
    return BatchGeometry2;
  }(Geometry);
  var defaultVertex$2 = "precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n";
  var defaultFragment$2 = "varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n";
  var BatchPluginFactory = function() {
    function BatchPluginFactory2() {
    }
    BatchPluginFactory2.create = function(options) {
      var _a2 = Object.assign({
        vertex: defaultVertex$2,
        fragment: defaultFragment$2,
        geometryClass: BatchGeometry,
        vertexSize: 6
      }, options), vertex7 = _a2.vertex, fragment10 = _a2.fragment, vertexSize = _a2.vertexSize, geometryClass = _a2.geometryClass;
      return function(_super) {
        __extends3(BatchPlugin, _super);
        function BatchPlugin(renderer) {
          var _this = _super.call(this, renderer) || this;
          _this.shaderGenerator = new BatchShaderGenerator(vertex7, fragment10);
          _this.geometryClass = geometryClass;
          _this.vertexSize = vertexSize;
          return _this;
        }
        return BatchPlugin;
      }(AbstractBatchRenderer);
    };
    Object.defineProperty(BatchPluginFactory2, "defaultVertexSrc", {
      get: function() {
        return defaultVertex$2;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BatchPluginFactory2, "defaultFragmentTemplate", {
      get: function() {
        return defaultFragment$2;
      },
      enumerable: false,
      configurable: true
    });
    return BatchPluginFactory2;
  }();
  var BatchRenderer = BatchPluginFactory.create();

  // node_modules/@pixi/app/lib/app.es.js
  /*!
   * @pixi/app - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/app is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var Application = function() {
    function Application2(options) {
      var _this = this;
      options = Object.assign({
        forceCanvas: false
      }, options);
      this.renderer = autoDetectRenderer(options);
      this.stage = new Container();
      Application2._plugins.forEach(function(plugin) {
        plugin.init.call(_this, options);
      });
    }
    Application2.registerPlugin = function(plugin) {
      Application2._plugins.push(plugin);
    };
    Application2.prototype.render = function() {
      this.renderer.render(this.stage);
    };
    Object.defineProperty(Application2.prototype, "view", {
      get: function() {
        return this.renderer.view;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Application2.prototype, "screen", {
      get: function() {
        return this.renderer.screen;
      },
      enumerable: false,
      configurable: true
    });
    Application2.prototype.destroy = function(removeView, stageOptions) {
      var _this = this;
      var plugins = Application2._plugins.slice(0);
      plugins.reverse();
      plugins.forEach(function(plugin) {
        plugin.destroy.call(_this);
      });
      this.stage.destroy(stageOptions);
      this.stage = null;
      this.renderer.destroy(removeView);
      this.renderer = null;
    };
    return Application2;
  }();
  Application._plugins = [];
  var ResizePlugin = function() {
    function ResizePlugin2() {
    }
    ResizePlugin2.init = function(options) {
      var _this = this;
      Object.defineProperty(this, "resizeTo", {
        set: function(dom) {
          window.removeEventListener("resize", this.queueResize);
          this._resizeTo = dom;
          if (dom) {
            window.addEventListener("resize", this.queueResize);
            this.resize();
          }
        },
        get: function() {
          return this._resizeTo;
        }
      });
      this.queueResize = function() {
        if (!_this._resizeTo) {
          return;
        }
        _this.cancelResize();
        _this._resizeId = requestAnimationFrame(function() {
          return _this.resize();
        });
      };
      this.cancelResize = function() {
        if (_this._resizeId) {
          cancelAnimationFrame(_this._resizeId);
          _this._resizeId = null;
        }
      };
      this.resize = function() {
        if (!_this._resizeTo) {
          return;
        }
        _this.cancelResize();
        var width;
        var height;
        if (_this._resizeTo === window) {
          width = window.innerWidth;
          height = window.innerHeight;
        } else {
          var _a2 = _this._resizeTo, clientWidth = _a2.clientWidth, clientHeight = _a2.clientHeight;
          width = clientWidth;
          height = clientHeight;
        }
        _this.renderer.resize(width, height);
      };
      this._resizeId = null;
      this._resizeTo = null;
      this.resizeTo = options.resizeTo || null;
    };
    ResizePlugin2.destroy = function() {
      this.cancelResize();
      this.cancelResize = null;
      this.queueResize = null;
      this.resizeTo = null;
      this.resize = null;
    };
    return ResizePlugin2;
  }();
  Application.registerPlugin(ResizePlugin);

  // node_modules/@pixi/extract/lib/extract.es.js
  /*!
   * @pixi/extract - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/extract is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var TEMP_RECT = new Rectangle();
  var BYTES_PER_PIXEL = 4;
  var Extract = function() {
    function Extract2(renderer) {
      this.renderer = renderer;
      renderer.extract = this;
    }
    Extract2.prototype.image = function(target, format, quality) {
      var image = new Image();
      image.src = this.base64(target, format, quality);
      return image;
    };
    Extract2.prototype.base64 = function(target, format, quality) {
      return this.canvas(target).toDataURL(format, quality);
    };
    Extract2.prototype.canvas = function(target) {
      var renderer = this.renderer;
      var resolution;
      var frame;
      var flipY = false;
      var renderTexture;
      var generated = false;
      if (target) {
        if (target instanceof RenderTexture) {
          renderTexture = target;
        } else {
          renderTexture = this.renderer.generateTexture(target);
          generated = true;
        }
      }
      if (renderTexture) {
        resolution = renderTexture.baseTexture.resolution;
        frame = renderTexture.frame;
        flipY = false;
        renderer.renderTexture.bind(renderTexture);
      } else {
        resolution = this.renderer.resolution;
        flipY = true;
        frame = TEMP_RECT;
        frame.width = this.renderer.width;
        frame.height = this.renderer.height;
        renderer.renderTexture.bind(null);
      }
      var width = Math.floor(frame.width * resolution + 1e-4);
      var height = Math.floor(frame.height * resolution + 1e-4);
      var canvasBuffer = new CanvasRenderTarget(width, height, 1);
      var webglPixels = new Uint8Array(BYTES_PER_PIXEL * width * height);
      var gl = renderer.gl;
      gl.readPixels(frame.x * resolution, frame.y * resolution, width, height, gl.RGBA, gl.UNSIGNED_BYTE, webglPixels);
      var canvasData = canvasBuffer.context.getImageData(0, 0, width, height);
      Extract2.arrayPostDivide(webglPixels, canvasData.data);
      canvasBuffer.context.putImageData(canvasData, 0, 0);
      if (flipY) {
        var target_1 = new CanvasRenderTarget(canvasBuffer.width, canvasBuffer.height, 1);
        target_1.context.scale(1, -1);
        target_1.context.drawImage(canvasBuffer.canvas, 0, -height);
        canvasBuffer.destroy();
        canvasBuffer = target_1;
      }
      if (generated) {
        renderTexture.destroy(true);
      }
      return canvasBuffer.canvas;
    };
    Extract2.prototype.pixels = function(target) {
      var renderer = this.renderer;
      var resolution;
      var frame;
      var renderTexture;
      var generated = false;
      if (target) {
        if (target instanceof RenderTexture) {
          renderTexture = target;
        } else {
          renderTexture = this.renderer.generateTexture(target);
          generated = true;
        }
      }
      if (renderTexture) {
        resolution = renderTexture.baseTexture.resolution;
        frame = renderTexture.frame;
        renderer.renderTexture.bind(renderTexture);
      } else {
        resolution = renderer.resolution;
        frame = TEMP_RECT;
        frame.width = renderer.width;
        frame.height = renderer.height;
        renderer.renderTexture.bind(null);
      }
      var width = frame.width * resolution;
      var height = frame.height * resolution;
      var webglPixels = new Uint8Array(BYTES_PER_PIXEL * width * height);
      var gl = renderer.gl;
      gl.readPixels(frame.x * resolution, frame.y * resolution, width, height, gl.RGBA, gl.UNSIGNED_BYTE, webglPixels);
      if (generated) {
        renderTexture.destroy(true);
      }
      Extract2.arrayPostDivide(webglPixels, webglPixels);
      return webglPixels;
    };
    Extract2.prototype.destroy = function() {
      this.renderer.extract = null;
      this.renderer = null;
    };
    Extract2.arrayPostDivide = function(pixels, out) {
      for (var i = 0; i < pixels.length; i += 4) {
        var alpha = out[i + 3] = pixels[i + 3];
        if (alpha !== 0) {
          out[i] = Math.round(Math.min(pixels[i] * 255 / alpha, 255));
          out[i + 1] = Math.round(Math.min(pixels[i + 1] * 255 / alpha, 255));
          out[i + 2] = Math.round(Math.min(pixels[i + 2] * 255 / alpha, 255));
        } else {
          out[i] = pixels[i];
          out[i + 1] = pixels[i + 1];
          out[i + 2] = pixels[i + 2];
        }
      }
    };
    return Extract2;
  }();

  // node_modules/resource-loader/dist/resource-loader.esm.js
  var import_parse_uri = __toModule(require_parse_uri());
  var import_mini_signals = __toModule(require_mini_signals());
  /*!
   * resource-loader - v3.0.1
   * https://github.com/pixijs/pixi-sound
   * Compiled Tue, 02 Jul 2019 14:06:18 UTC
   *
   * resource-loader is licensed under the MIT license.
   * http://www.opensource.org/licenses/mit-license
   */
  function _noop() {
  }
  function eachSeries(array, iterator, callback, deferNext) {
    var i = 0;
    var len = array.length;
    (function next(err) {
      if (err || i === len) {
        if (callback) {
          callback(err);
        }
        return;
      }
      if (deferNext) {
        setTimeout(function() {
          iterator(array[i++], next);
        }, 1);
      } else {
        iterator(array[i++], next);
      }
    })();
  }
  function onlyOnce(fn) {
    return function onceWrapper() {
      if (fn === null) {
        throw new Error("Callback was already called.");
      }
      var callFn = fn;
      fn = null;
      callFn.apply(this, arguments);
    };
  }
  function queue(worker, concurrency) {
    if (concurrency == null) {
      concurrency = 1;
    } else if (concurrency === 0) {
      throw new Error("Concurrency must not be zero");
    }
    var workers = 0;
    var q = {
      _tasks: [],
      concurrency,
      saturated: _noop,
      unsaturated: _noop,
      buffer: concurrency / 4,
      empty: _noop,
      drain: _noop,
      error: _noop,
      started: false,
      paused: false,
      push: function push(data, callback) {
        _insert(data, false, callback);
      },
      kill: function kill() {
        workers = 0;
        q.drain = _noop;
        q.started = false;
        q._tasks = [];
      },
      unshift: function unshift(data, callback) {
        _insert(data, true, callback);
      },
      process: function process() {
        while (!q.paused && workers < q.concurrency && q._tasks.length) {
          var task = q._tasks.shift();
          if (q._tasks.length === 0) {
            q.empty();
          }
          workers += 1;
          if (workers === q.concurrency) {
            q.saturated();
          }
          worker(task.data, onlyOnce(_next(task)));
        }
      },
      length: function length() {
        return q._tasks.length;
      },
      running: function running() {
        return workers;
      },
      idle: function idle() {
        return q._tasks.length + workers === 0;
      },
      pause: function pause() {
        if (q.paused === true) {
          return;
        }
        q.paused = true;
      },
      resume: function resume() {
        if (q.paused === false) {
          return;
        }
        q.paused = false;
        for (var w = 1; w <= q.concurrency; w++) {
          q.process();
        }
      }
    };
    function _insert(data, insertAtFront, callback) {
      if (callback != null && typeof callback !== "function") {
        throw new Error("task callback must be a function");
      }
      q.started = true;
      if (data == null && q.idle()) {
        setTimeout(function() {
          return q.drain();
        }, 1);
        return;
      }
      var item = {
        data,
        callback: typeof callback === "function" ? callback : _noop
      };
      if (insertAtFront) {
        q._tasks.unshift(item);
      } else {
        q._tasks.push(item);
      }
      setTimeout(function() {
        return q.process();
      }, 1);
    }
    function _next(task) {
      return function next() {
        workers -= 1;
        task.callback.apply(task, arguments);
        if (arguments[0] != null) {
          q.error(arguments[0], task.data);
        }
        if (workers <= q.concurrency - q.buffer) {
          q.unsaturated();
        }
        if (q.idle()) {
          q.drain();
        }
        q.process();
      };
    }
    return q;
  }
  var cache = {};
  function caching(resource, next) {
    var _this = this;
    if (cache[resource.url]) {
      resource.data = cache[resource.url];
      resource.complete();
    } else {
      resource.onComplete.once(function() {
        return cache[_this.url] = _this.data;
      });
    }
    next();
  }
  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor)
        descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }
  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps)
      _defineProperties(Constructor.prototype, protoProps);
    if (staticProps)
      _defineProperties(Constructor, staticProps);
    return Constructor;
  }
  var useXdr = !!(window.XDomainRequest && !("withCredentials" in new XMLHttpRequest()));
  var tempAnchor2 = null;
  var STATUS_NONE = 0;
  var STATUS_OK = 200;
  var STATUS_EMPTY = 204;
  var STATUS_IE_BUG_EMPTY = 1223;
  var STATUS_TYPE_OK = 2;
  function _noop$1() {
  }
  var Resource2 = /* @__PURE__ */ function() {
    Resource3.setExtensionLoadType = function setExtensionLoadType(extname, loadType) {
      setExtMap(Resource3._loadTypeMap, extname, loadType);
    };
    Resource3.setExtensionXhrType = function setExtensionXhrType(extname, xhrType) {
      setExtMap(Resource3._xhrTypeMap, extname, xhrType);
    };
    function Resource3(name, url, options) {
      if (typeof name !== "string" || typeof url !== "string") {
        throw new Error("Both name and url are required for constructing a resource.");
      }
      options = options || {};
      this._flags = 0;
      this._setFlag(Resource3.STATUS_FLAGS.DATA_URL, url.indexOf("data:") === 0);
      this.name = name;
      this.url = url;
      this.extension = this._getExtension();
      this.data = null;
      this.crossOrigin = options.crossOrigin === true ? "anonymous" : options.crossOrigin;
      this.timeout = options.timeout || 0;
      this.loadType = options.loadType || this._determineLoadType();
      this.xhrType = options.xhrType;
      this.metadata = options.metadata || {};
      this.error = null;
      this.xhr = null;
      this.children = [];
      this.type = Resource3.TYPE.UNKNOWN;
      this.progressChunk = 0;
      this._dequeue = _noop$1;
      this._onLoadBinding = null;
      this._elementTimer = 0;
      this._boundComplete = this.complete.bind(this);
      this._boundOnError = this._onError.bind(this);
      this._boundOnProgress = this._onProgress.bind(this);
      this._boundOnTimeout = this._onTimeout.bind(this);
      this._boundXhrOnError = this._xhrOnError.bind(this);
      this._boundXhrOnTimeout = this._xhrOnTimeout.bind(this);
      this._boundXhrOnAbort = this._xhrOnAbort.bind(this);
      this._boundXhrOnLoad = this._xhrOnLoad.bind(this);
      this.onStart = new import_mini_signals.default();
      this.onProgress = new import_mini_signals.default();
      this.onComplete = new import_mini_signals.default();
      this.onAfterMiddleware = new import_mini_signals.default();
    }
    var _proto = Resource3.prototype;
    _proto.complete = function complete() {
      this._clearEvents();
      this._finish();
    };
    _proto.abort = function abort(message) {
      if (this.error) {
        return;
      }
      this.error = new Error(message);
      this._clearEvents();
      if (this.xhr) {
        this.xhr.abort();
      } else if (this.xdr) {
        this.xdr.abort();
      } else if (this.data) {
        if (this.data.src) {
          this.data.src = Resource3.EMPTY_GIF;
        } else {
          while (this.data.firstChild) {
            this.data.removeChild(this.data.firstChild);
          }
        }
      }
      this._finish();
    };
    _proto.load = function load(cb) {
      var _this = this;
      if (this.isLoading) {
        return;
      }
      if (this.isComplete) {
        if (cb) {
          setTimeout(function() {
            return cb(_this);
          }, 1);
        }
        return;
      } else if (cb) {
        this.onComplete.once(cb);
      }
      this._setFlag(Resource3.STATUS_FLAGS.LOADING, true);
      this.onStart.dispatch(this);
      if (this.crossOrigin === false || typeof this.crossOrigin !== "string") {
        this.crossOrigin = this._determineCrossOrigin(this.url);
      }
      switch (this.loadType) {
        case Resource3.LOAD_TYPE.IMAGE:
          this.type = Resource3.TYPE.IMAGE;
          this._loadElement("image");
          break;
        case Resource3.LOAD_TYPE.AUDIO:
          this.type = Resource3.TYPE.AUDIO;
          this._loadSourceElement("audio");
          break;
        case Resource3.LOAD_TYPE.VIDEO:
          this.type = Resource3.TYPE.VIDEO;
          this._loadSourceElement("video");
          break;
        case Resource3.LOAD_TYPE.XHR:
        default:
          if (useXdr && this.crossOrigin) {
            this._loadXdr();
          } else {
            this._loadXhr();
          }
          break;
      }
    };
    _proto._hasFlag = function _hasFlag(flag) {
      return (this._flags & flag) !== 0;
    };
    _proto._setFlag = function _setFlag(flag, value) {
      this._flags = value ? this._flags | flag : this._flags & ~flag;
    };
    _proto._clearEvents = function _clearEvents() {
      clearTimeout(this._elementTimer);
      if (this.data && this.data.removeEventListener) {
        this.data.removeEventListener("error", this._boundOnError, false);
        this.data.removeEventListener("load", this._boundComplete, false);
        this.data.removeEventListener("progress", this._boundOnProgress, false);
        this.data.removeEventListener("canplaythrough", this._boundComplete, false);
      }
      if (this.xhr) {
        if (this.xhr.removeEventListener) {
          this.xhr.removeEventListener("error", this._boundXhrOnError, false);
          this.xhr.removeEventListener("timeout", this._boundXhrOnTimeout, false);
          this.xhr.removeEventListener("abort", this._boundXhrOnAbort, false);
          this.xhr.removeEventListener("progress", this._boundOnProgress, false);
          this.xhr.removeEventListener("load", this._boundXhrOnLoad, false);
        } else {
          this.xhr.onerror = null;
          this.xhr.ontimeout = null;
          this.xhr.onprogress = null;
          this.xhr.onload = null;
        }
      }
    };
    _proto._finish = function _finish() {
      if (this.isComplete) {
        throw new Error("Complete called again for an already completed resource.");
      }
      this._setFlag(Resource3.STATUS_FLAGS.COMPLETE, true);
      this._setFlag(Resource3.STATUS_FLAGS.LOADING, false);
      this.onComplete.dispatch(this);
    };
    _proto._loadElement = function _loadElement(type) {
      if (this.metadata.loadElement) {
        this.data = this.metadata.loadElement;
      } else if (type === "image" && typeof window.Image !== "undefined") {
        this.data = new Image();
      } else {
        this.data = document.createElement(type);
      }
      if (this.crossOrigin) {
        this.data.crossOrigin = this.crossOrigin;
      }
      if (!this.metadata.skipSource) {
        this.data.src = this.url;
      }
      this.data.addEventListener("error", this._boundOnError, false);
      this.data.addEventListener("load", this._boundComplete, false);
      this.data.addEventListener("progress", this._boundOnProgress, false);
      if (this.timeout) {
        this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout);
      }
    };
    _proto._loadSourceElement = function _loadSourceElement(type) {
      if (this.metadata.loadElement) {
        this.data = this.metadata.loadElement;
      } else if (type === "audio" && typeof window.Audio !== "undefined") {
        this.data = new Audio();
      } else {
        this.data = document.createElement(type);
      }
      if (this.data === null) {
        this.abort("Unsupported element: " + type);
        return;
      }
      if (this.crossOrigin) {
        this.data.crossOrigin = this.crossOrigin;
      }
      if (!this.metadata.skipSource) {
        if (navigator.isCocoonJS) {
          this.data.src = Array.isArray(this.url) ? this.url[0] : this.url;
        } else if (Array.isArray(this.url)) {
          var mimeTypes = this.metadata.mimeType;
          for (var i = 0; i < this.url.length; ++i) {
            this.data.appendChild(this._createSource(type, this.url[i], Array.isArray(mimeTypes) ? mimeTypes[i] : mimeTypes));
          }
        } else {
          var _mimeTypes = this.metadata.mimeType;
          this.data.appendChild(this._createSource(type, this.url, Array.isArray(_mimeTypes) ? _mimeTypes[0] : _mimeTypes));
        }
      }
      this.data.addEventListener("error", this._boundOnError, false);
      this.data.addEventListener("load", this._boundComplete, false);
      this.data.addEventListener("progress", this._boundOnProgress, false);
      this.data.addEventListener("canplaythrough", this._boundComplete, false);
      this.data.load();
      if (this.timeout) {
        this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout);
      }
    };
    _proto._loadXhr = function _loadXhr() {
      if (typeof this.xhrType !== "string") {
        this.xhrType = this._determineXhrType();
      }
      var xhr = this.xhr = new XMLHttpRequest();
      xhr.open("GET", this.url, true);
      xhr.timeout = this.timeout;
      if (this.xhrType === Resource3.XHR_RESPONSE_TYPE.JSON || this.xhrType === Resource3.XHR_RESPONSE_TYPE.DOCUMENT) {
        xhr.responseType = Resource3.XHR_RESPONSE_TYPE.TEXT;
      } else {
        xhr.responseType = this.xhrType;
      }
      xhr.addEventListener("error", this._boundXhrOnError, false);
      xhr.addEventListener("timeout", this._boundXhrOnTimeout, false);
      xhr.addEventListener("abort", this._boundXhrOnAbort, false);
      xhr.addEventListener("progress", this._boundOnProgress, false);
      xhr.addEventListener("load", this._boundXhrOnLoad, false);
      xhr.send();
    };
    _proto._loadXdr = function _loadXdr() {
      if (typeof this.xhrType !== "string") {
        this.xhrType = this._determineXhrType();
      }
      var xdr = this.xhr = new XDomainRequest();
      xdr.timeout = this.timeout || 5e3;
      xdr.onerror = this._boundXhrOnError;
      xdr.ontimeout = this._boundXhrOnTimeout;
      xdr.onprogress = this._boundOnProgress;
      xdr.onload = this._boundXhrOnLoad;
      xdr.open("GET", this.url, true);
      setTimeout(function() {
        return xdr.send();
      }, 1);
    };
    _proto._createSource = function _createSource(type, url, mime) {
      if (!mime) {
        mime = type + "/" + this._getExtension(url);
      }
      var source = document.createElement("source");
      source.src = url;
      source.type = mime;
      return source;
    };
    _proto._onError = function _onError(event) {
      this.abort("Failed to load element using: " + event.target.nodeName);
    };
    _proto._onProgress = function _onProgress(event) {
      if (event && event.lengthComputable) {
        this.onProgress.dispatch(this, event.loaded / event.total);
      }
    };
    _proto._onTimeout = function _onTimeout() {
      this.abort("Load timed out.");
    };
    _proto._xhrOnError = function _xhrOnError() {
      var xhr = this.xhr;
      this.abort(reqType(xhr) + " Request failed. Status: " + xhr.status + ', text: "' + xhr.statusText + '"');
    };
    _proto._xhrOnTimeout = function _xhrOnTimeout() {
      var xhr = this.xhr;
      this.abort(reqType(xhr) + " Request timed out.");
    };
    _proto._xhrOnAbort = function _xhrOnAbort() {
      var xhr = this.xhr;
      this.abort(reqType(xhr) + " Request was aborted by the user.");
    };
    _proto._xhrOnLoad = function _xhrOnLoad() {
      var xhr = this.xhr;
      var text = "";
      var status = typeof xhr.status === "undefined" ? STATUS_OK : xhr.status;
      if (xhr.responseType === "" || xhr.responseType === "text" || typeof xhr.responseType === "undefined") {
        text = xhr.responseText;
      }
      if (status === STATUS_NONE && (text.length > 0 || xhr.responseType === Resource3.XHR_RESPONSE_TYPE.BUFFER)) {
        status = STATUS_OK;
      } else if (status === STATUS_IE_BUG_EMPTY) {
        status = STATUS_EMPTY;
      }
      var statusType = status / 100 | 0;
      if (statusType === STATUS_TYPE_OK) {
        if (this.xhrType === Resource3.XHR_RESPONSE_TYPE.TEXT) {
          this.data = text;
          this.type = Resource3.TYPE.TEXT;
        } else if (this.xhrType === Resource3.XHR_RESPONSE_TYPE.JSON) {
          try {
            this.data = JSON.parse(text);
            this.type = Resource3.TYPE.JSON;
          } catch (e) {
            this.abort("Error trying to parse loaded json: " + e);
            return;
          }
        } else if (this.xhrType === Resource3.XHR_RESPONSE_TYPE.DOCUMENT) {
          try {
            if (window.DOMParser) {
              var domparser = new DOMParser();
              this.data = domparser.parseFromString(text, "text/xml");
            } else {
              var div = document.createElement("div");
              div.innerHTML = text;
              this.data = div;
            }
            this.type = Resource3.TYPE.XML;
          } catch (e) {
            this.abort("Error trying to parse loaded xml: " + e);
            return;
          }
        } else {
          this.data = xhr.response || text;
        }
      } else {
        this.abort("[" + xhr.status + "] " + xhr.statusText + ": " + xhr.responseURL);
        return;
      }
      this.complete();
    };
    _proto._determineCrossOrigin = function _determineCrossOrigin(url, loc) {
      if (url.indexOf("data:") === 0) {
        return "";
      }
      if (window.origin !== window.location.origin) {
        return "anonymous";
      }
      loc = loc || window.location;
      if (!tempAnchor2) {
        tempAnchor2 = document.createElement("a");
      }
      tempAnchor2.href = url;
      url = import_parse_uri.default(tempAnchor2.href, {
        strictMode: true
      });
      var samePort = !url.port && loc.port === "" || url.port === loc.port;
      var protocol = url.protocol ? url.protocol + ":" : "";
      if (url.host !== loc.hostname || !samePort || protocol !== loc.protocol) {
        return "anonymous";
      }
      return "";
    };
    _proto._determineXhrType = function _determineXhrType() {
      return Resource3._xhrTypeMap[this.extension] || Resource3.XHR_RESPONSE_TYPE.TEXT;
    };
    _proto._determineLoadType = function _determineLoadType() {
      return Resource3._loadTypeMap[this.extension] || Resource3.LOAD_TYPE.XHR;
    };
    _proto._getExtension = function _getExtension() {
      var url = this.url;
      var ext = "";
      if (this.isDataUrl) {
        var slashIndex = url.indexOf("/");
        ext = url.substring(slashIndex + 1, url.indexOf(";", slashIndex));
      } else {
        var queryStart = url.indexOf("?");
        var hashStart = url.indexOf("#");
        var index2 = Math.min(queryStart > -1 ? queryStart : url.length, hashStart > -1 ? hashStart : url.length);
        url = url.substring(0, index2);
        ext = url.substring(url.lastIndexOf(".") + 1);
      }
      return ext.toLowerCase();
    };
    _proto._getMimeFromXhrType = function _getMimeFromXhrType(type) {
      switch (type) {
        case Resource3.XHR_RESPONSE_TYPE.BUFFER:
          return "application/octet-binary";
        case Resource3.XHR_RESPONSE_TYPE.BLOB:
          return "application/blob";
        case Resource3.XHR_RESPONSE_TYPE.DOCUMENT:
          return "application/xml";
        case Resource3.XHR_RESPONSE_TYPE.JSON:
          return "application/json";
        case Resource3.XHR_RESPONSE_TYPE.DEFAULT:
        case Resource3.XHR_RESPONSE_TYPE.TEXT:
        default:
          return "text/plain";
      }
    };
    _createClass(Resource3, [{
      key: "isDataUrl",
      get: function get() {
        return this._hasFlag(Resource3.STATUS_FLAGS.DATA_URL);
      }
    }, {
      key: "isComplete",
      get: function get() {
        return this._hasFlag(Resource3.STATUS_FLAGS.COMPLETE);
      }
    }, {
      key: "isLoading",
      get: function get() {
        return this._hasFlag(Resource3.STATUS_FLAGS.LOADING);
      }
    }]);
    return Resource3;
  }();
  Resource2.STATUS_FLAGS = {
    NONE: 0,
    DATA_URL: 1 << 0,
    COMPLETE: 1 << 1,
    LOADING: 1 << 2
  };
  Resource2.TYPE = {
    UNKNOWN: 0,
    JSON: 1,
    XML: 2,
    IMAGE: 3,
    AUDIO: 4,
    VIDEO: 5,
    TEXT: 6
  };
  Resource2.LOAD_TYPE = {
    XHR: 1,
    IMAGE: 2,
    AUDIO: 3,
    VIDEO: 4
  };
  Resource2.XHR_RESPONSE_TYPE = {
    DEFAULT: "text",
    BUFFER: "arraybuffer",
    BLOB: "blob",
    DOCUMENT: "document",
    JSON: "json",
    TEXT: "text"
  };
  Resource2._loadTypeMap = {
    gif: Resource2.LOAD_TYPE.IMAGE,
    png: Resource2.LOAD_TYPE.IMAGE,
    bmp: Resource2.LOAD_TYPE.IMAGE,
    jpg: Resource2.LOAD_TYPE.IMAGE,
    jpeg: Resource2.LOAD_TYPE.IMAGE,
    tif: Resource2.LOAD_TYPE.IMAGE,
    tiff: Resource2.LOAD_TYPE.IMAGE,
    webp: Resource2.LOAD_TYPE.IMAGE,
    tga: Resource2.LOAD_TYPE.IMAGE,
    svg: Resource2.LOAD_TYPE.IMAGE,
    "svg+xml": Resource2.LOAD_TYPE.IMAGE,
    mp3: Resource2.LOAD_TYPE.AUDIO,
    ogg: Resource2.LOAD_TYPE.AUDIO,
    wav: Resource2.LOAD_TYPE.AUDIO,
    mp4: Resource2.LOAD_TYPE.VIDEO,
    webm: Resource2.LOAD_TYPE.VIDEO
  };
  Resource2._xhrTypeMap = {
    xhtml: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    html: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    htm: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    xml: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    tmx: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    svg: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    tsx: Resource2.XHR_RESPONSE_TYPE.DOCUMENT,
    gif: Resource2.XHR_RESPONSE_TYPE.BLOB,
    png: Resource2.XHR_RESPONSE_TYPE.BLOB,
    bmp: Resource2.XHR_RESPONSE_TYPE.BLOB,
    jpg: Resource2.XHR_RESPONSE_TYPE.BLOB,
    jpeg: Resource2.XHR_RESPONSE_TYPE.BLOB,
    tif: Resource2.XHR_RESPONSE_TYPE.BLOB,
    tiff: Resource2.XHR_RESPONSE_TYPE.BLOB,
    webp: Resource2.XHR_RESPONSE_TYPE.BLOB,
    tga: Resource2.XHR_RESPONSE_TYPE.BLOB,
    json: Resource2.XHR_RESPONSE_TYPE.JSON,
    text: Resource2.XHR_RESPONSE_TYPE.TEXT,
    txt: Resource2.XHR_RESPONSE_TYPE.TEXT,
    ttf: Resource2.XHR_RESPONSE_TYPE.BUFFER,
    otf: Resource2.XHR_RESPONSE_TYPE.BUFFER
  };
  Resource2.EMPTY_GIF = "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";
  function setExtMap(map3, extname, val) {
    if (extname && extname.indexOf(".") === 0) {
      extname = extname.substring(1);
    }
    if (!extname) {
      return;
    }
    map3[extname] = val;
  }
  function reqType(xhr) {
    return xhr.toString().replace("object ", "");
  }
  var _keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  function encodeBinary(input) {
    var output = "";
    var inx = 0;
    while (inx < input.length) {
      var bytebuffer = [0, 0, 0];
      var encodedCharIndexes = [0, 0, 0, 0];
      for (var jnx = 0; jnx < bytebuffer.length; ++jnx) {
        if (inx < input.length) {
          bytebuffer[jnx] = input.charCodeAt(inx++) & 255;
        } else {
          bytebuffer[jnx] = 0;
        }
      }
      encodedCharIndexes[0] = bytebuffer[0] >> 2;
      encodedCharIndexes[1] = (bytebuffer[0] & 3) << 4 | bytebuffer[1] >> 4;
      encodedCharIndexes[2] = (bytebuffer[1] & 15) << 2 | bytebuffer[2] >> 6;
      encodedCharIndexes[3] = bytebuffer[2] & 63;
      var paddingBytes = inx - (input.length - 1);
      switch (paddingBytes) {
        case 2:
          encodedCharIndexes[3] = 64;
          encodedCharIndexes[2] = 64;
          break;
        case 1:
          encodedCharIndexes[3] = 64;
          break;
        default:
          break;
      }
      for (var _jnx = 0; _jnx < encodedCharIndexes.length; ++_jnx) {
        output += _keyStr.charAt(encodedCharIndexes[_jnx]);
      }
    }
    return output;
  }
  var Url = window.URL || window.webkitURL;
  function parsing(resource, next) {
    if (!resource.data) {
      next();
      return;
    }
    if (resource.xhr && resource.xhrType === Resource2.XHR_RESPONSE_TYPE.BLOB) {
      if (!window.Blob || typeof resource.data === "string") {
        var type = resource.xhr.getResponseHeader("content-type");
        if (type && type.indexOf("image") === 0) {
          resource.data = new Image();
          resource.data.src = "data:" + type + ";base64," + encodeBinary(resource.xhr.responseText);
          resource.type = Resource2.TYPE.IMAGE;
          resource.data.onload = function() {
            resource.data.onload = null;
            next();
          };
          return;
        }
      } else if (resource.data.type.indexOf("image") === 0) {
        var src = Url.createObjectURL(resource.data);
        resource.blob = resource.data;
        resource.data = new Image();
        resource.data.src = src;
        resource.type = Resource2.TYPE.IMAGE;
        resource.data.onload = function() {
          Url.revokeObjectURL(src);
          resource.data.onload = null;
          next();
        };
        return;
      }
    }
    next();
  }
  var index = {
    caching,
    parsing
  };
  var MAX_PROGRESS = 100;
  var rgxExtractUrlHash = /(#[\w-]+)?$/;
  var Loader = /* @__PURE__ */ function() {
    function Loader3(baseUrl, concurrency) {
      var _this = this;
      if (baseUrl === void 0) {
        baseUrl = "";
      }
      if (concurrency === void 0) {
        concurrency = 10;
      }
      this.baseUrl = baseUrl;
      this.progress = 0;
      this.loading = false;
      this.defaultQueryString = "";
      this._beforeMiddleware = [];
      this._afterMiddleware = [];
      this._resourcesParsing = [];
      this._boundLoadResource = function(r, d) {
        return _this._loadResource(r, d);
      };
      this._queue = queue(this._boundLoadResource, concurrency);
      this._queue.pause();
      this.resources = {};
      this.onProgress = new import_mini_signals.default();
      this.onError = new import_mini_signals.default();
      this.onLoad = new import_mini_signals.default();
      this.onStart = new import_mini_signals.default();
      this.onComplete = new import_mini_signals.default();
      for (var i = 0; i < Loader3._defaultBeforeMiddleware.length; ++i) {
        this.pre(Loader3._defaultBeforeMiddleware[i]);
      }
      for (var _i = 0; _i < Loader3._defaultAfterMiddleware.length; ++_i) {
        this.use(Loader3._defaultAfterMiddleware[_i]);
      }
    }
    var _proto = Loader3.prototype;
    _proto.add = function add(name, url, options, cb) {
      if (Array.isArray(name)) {
        for (var i = 0; i < name.length; ++i) {
          this.add(name[i]);
        }
        return this;
      }
      if (typeof name === "object") {
        cb = url || name.callback || name.onComplete;
        options = name;
        url = name.url;
        name = name.name || name.key || name.url;
      }
      if (typeof url !== "string") {
        cb = options;
        options = url;
        url = name;
      }
      if (typeof url !== "string") {
        throw new Error("No url passed to add resource to loader.");
      }
      if (typeof options === "function") {
        cb = options;
        options = null;
      }
      if (this.loading && (!options || !options.parentResource)) {
        throw new Error("Cannot add resources while the loader is running.");
      }
      if (this.resources[name]) {
        throw new Error('Resource named "' + name + '" already exists.');
      }
      url = this._prepareUrl(url);
      this.resources[name] = new Resource2(name, url, options);
      if (typeof cb === "function") {
        this.resources[name].onAfterMiddleware.once(cb);
      }
      if (this.loading) {
        var parent = options.parentResource;
        var incompleteChildren = [];
        for (var _i2 = 0; _i2 < parent.children.length; ++_i2) {
          if (!parent.children[_i2].isComplete) {
            incompleteChildren.push(parent.children[_i2]);
          }
        }
        var fullChunk = parent.progressChunk * (incompleteChildren.length + 1);
        var eachChunk = fullChunk / (incompleteChildren.length + 2);
        parent.children.push(this.resources[name]);
        parent.progressChunk = eachChunk;
        for (var _i3 = 0; _i3 < incompleteChildren.length; ++_i3) {
          incompleteChildren[_i3].progressChunk = eachChunk;
        }
        this.resources[name].progressChunk = eachChunk;
      }
      this._queue.push(this.resources[name]);
      return this;
    };
    _proto.pre = function pre(fn) {
      this._beforeMiddleware.push(fn);
      return this;
    };
    _proto.use = function use(fn) {
      this._afterMiddleware.push(fn);
      return this;
    };
    _proto.reset = function reset() {
      this.progress = 0;
      this.loading = false;
      this._queue.kill();
      this._queue.pause();
      for (var k in this.resources) {
        var res = this.resources[k];
        if (res._onLoadBinding) {
          res._onLoadBinding.detach();
        }
        if (res.isLoading) {
          res.abort();
        }
      }
      this.resources = {};
      return this;
    };
    _proto.load = function load(cb) {
      if (typeof cb === "function") {
        this.onComplete.once(cb);
      }
      if (this.loading) {
        return this;
      }
      if (this._queue.idle()) {
        this._onStart();
        this._onComplete();
      } else {
        var numTasks = this._queue._tasks.length;
        var chunk = MAX_PROGRESS / numTasks;
        for (var i = 0; i < this._queue._tasks.length; ++i) {
          this._queue._tasks[i].data.progressChunk = chunk;
        }
        this._onStart();
        this._queue.resume();
      }
      return this;
    };
    _proto._prepareUrl = function _prepareUrl(url) {
      var parsedUrl = import_parse_uri.default(url, {
        strictMode: true
      });
      var result;
      if (parsedUrl.protocol || !parsedUrl.path || url.indexOf("//") === 0) {
        result = url;
      } else if (this.baseUrl.length && this.baseUrl.lastIndexOf("/") !== this.baseUrl.length - 1 && url.charAt(0) !== "/") {
        result = this.baseUrl + "/" + url;
      } else {
        result = this.baseUrl + url;
      }
      if (this.defaultQueryString) {
        var hash = rgxExtractUrlHash.exec(result)[0];
        result = result.substr(0, result.length - hash.length);
        if (result.indexOf("?") !== -1) {
          result += "&" + this.defaultQueryString;
        } else {
          result += "?" + this.defaultQueryString;
        }
        result += hash;
      }
      return result;
    };
    _proto._loadResource = function _loadResource(resource, dequeue) {
      var _this2 = this;
      resource._dequeue = dequeue;
      eachSeries(this._beforeMiddleware, function(fn, next) {
        fn.call(_this2, resource, function() {
          next(resource.isComplete ? {} : null);
        });
      }, function() {
        if (resource.isComplete) {
          _this2._onLoad(resource);
        } else {
          resource._onLoadBinding = resource.onComplete.once(_this2._onLoad, _this2);
          resource.load();
        }
      }, true);
    };
    _proto._onStart = function _onStart() {
      this.progress = 0;
      this.loading = true;
      this.onStart.dispatch(this);
    };
    _proto._onComplete = function _onComplete() {
      this.progress = MAX_PROGRESS;
      this.loading = false;
      this.onComplete.dispatch(this, this.resources);
    };
    _proto._onLoad = function _onLoad(resource) {
      var _this3 = this;
      resource._onLoadBinding = null;
      this._resourcesParsing.push(resource);
      resource._dequeue();
      eachSeries(this._afterMiddleware, function(fn, next) {
        fn.call(_this3, resource, next);
      }, function() {
        resource.onAfterMiddleware.dispatch(resource);
        _this3.progress = Math.min(MAX_PROGRESS, _this3.progress + resource.progressChunk);
        _this3.onProgress.dispatch(_this3, resource);
        if (resource.error) {
          _this3.onError.dispatch(resource.error, _this3, resource);
        } else {
          _this3.onLoad.dispatch(_this3, resource);
        }
        _this3._resourcesParsing.splice(_this3._resourcesParsing.indexOf(resource), 1);
        if (_this3._queue.idle() && _this3._resourcesParsing.length === 0) {
          _this3._onComplete();
        }
      }, true);
    };
    _createClass(Loader3, [{
      key: "concurrency",
      get: function get() {
        return this._queue.concurrency;
      },
      set: function set(concurrency) {
        this._queue.concurrency = concurrency;
      }
    }]);
    return Loader3;
  }();
  Loader._defaultBeforeMiddleware = [];
  Loader._defaultAfterMiddleware = [];
  Loader.pre = function LoaderPreStatic(fn) {
    Loader._defaultBeforeMiddleware.push(fn);
    return Loader;
  };
  Loader.use = function LoaderUseStatic(fn) {
    Loader._defaultAfterMiddleware.push(fn);
    return Loader;
  };

  // node_modules/@pixi/loaders/lib/loaders.es.js
  /*!
   * @pixi/loaders - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/loaders is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var LoaderResource = Resource2;
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics4 = function(d, b) {
    extendStatics4 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics4(d, b);
  };
  function __extends4(d, b) {
    extendStatics4(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var TextureLoader = function() {
    function TextureLoader2() {
    }
    TextureLoader2.use = function(resource, next) {
      if (resource.data && resource.type === Resource2.TYPE.IMAGE) {
        resource.texture = Texture.fromLoader(resource.data, resource.url, resource.name);
      }
      next();
    };
    return TextureLoader2;
  }();
  var Loader2 = function(_super) {
    __extends4(Loader3, _super);
    function Loader3(baseUrl, concurrency) {
      var _this = _super.call(this, baseUrl, concurrency) || this;
      for (var i = 0; i < Loader3._plugins.length; ++i) {
        var plugin = Loader3._plugins[i];
        var pre = plugin.pre, use = plugin.use;
        if (pre) {
          _this.pre(pre);
        }
        if (use) {
          _this.use(use);
        }
      }
      _this._protected = false;
      return _this;
    }
    Loader3.prototype.destroy = function() {
      if (!this._protected) {
        this.reset();
      }
    };
    Object.defineProperty(Loader3, "shared", {
      get: function() {
        var shared = Loader3._shared;
        if (!shared) {
          shared = new Loader3();
          shared._protected = true;
          Loader3._shared = shared;
        }
        return shared;
      },
      enumerable: false,
      configurable: true
    });
    Loader3.registerPlugin = function(plugin) {
      Loader3._plugins.push(plugin);
      if (plugin.add) {
        plugin.add();
      }
      return Loader3;
    };
    Loader3._plugins = [];
    return Loader3;
  }(Loader);
  Loader2.registerPlugin({use: index.parsing});
  Loader2.registerPlugin(TextureLoader);
  var AppLoaderPlugin = function() {
    function AppLoaderPlugin2() {
    }
    AppLoaderPlugin2.init = function(options) {
      options = Object.assign({
        sharedLoader: false
      }, options);
      this.loader = options.sharedLoader ? Loader2.shared : new Loader2();
    };
    AppLoaderPlugin2.destroy = function() {
      if (this.loader) {
        this.loader.destroy();
        this.loader = null;
      }
    };
    return AppLoaderPlugin2;
  }();

  // node_modules/@pixi/particles/lib/particles.es.js
  /*!
   * @pixi/particles - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/particles is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics5 = function(d, b) {
    extendStatics5 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics5(d, b);
  };
  function __extends5(d, b) {
    extendStatics5(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var ParticleContainer = function(_super) {
    __extends5(ParticleContainer2, _super);
    function ParticleContainer2(maxSize, properties, batchSize, autoResize) {
      if (maxSize === void 0) {
        maxSize = 1500;
      }
      if (batchSize === void 0) {
        batchSize = 16384;
      }
      if (autoResize === void 0) {
        autoResize = false;
      }
      var _this = _super.call(this) || this;
      var maxBatchSize = 16384;
      if (batchSize > maxBatchSize) {
        batchSize = maxBatchSize;
      }
      _this._properties = [false, true, false, false, false];
      _this._maxSize = maxSize;
      _this._batchSize = batchSize;
      _this._buffers = null;
      _this._bufferUpdateIDs = [];
      _this._updateID = 0;
      _this.interactiveChildren = false;
      _this.blendMode = BLEND_MODES.NORMAL;
      _this.autoResize = autoResize;
      _this.roundPixels = true;
      _this.baseTexture = null;
      _this.setProperties(properties);
      _this._tint = 0;
      _this.tintRgb = new Float32Array(4);
      _this.tint = 16777215;
      return _this;
    }
    ParticleContainer2.prototype.setProperties = function(properties) {
      if (properties) {
        this._properties[0] = "vertices" in properties || "scale" in properties ? !!properties.vertices || !!properties.scale : this._properties[0];
        this._properties[1] = "position" in properties ? !!properties.position : this._properties[1];
        this._properties[2] = "rotation" in properties ? !!properties.rotation : this._properties[2];
        this._properties[3] = "uvs" in properties ? !!properties.uvs : this._properties[3];
        this._properties[4] = "tint" in properties || "alpha" in properties ? !!properties.tint || !!properties.alpha : this._properties[4];
      }
    };
    ParticleContainer2.prototype.updateTransform = function() {
      this.displayObjectUpdateTransform();
    };
    Object.defineProperty(ParticleContainer2.prototype, "tint", {
      get: function() {
        return this._tint;
      },
      set: function(value) {
        this._tint = value;
        hex2rgb(value, this.tintRgb);
      },
      enumerable: false,
      configurable: true
    });
    ParticleContainer2.prototype.render = function(renderer) {
      var _this = this;
      if (!this.visible || this.worldAlpha <= 0 || !this.children.length || !this.renderable) {
        return;
      }
      if (!this.baseTexture) {
        this.baseTexture = this.children[0]._texture.baseTexture;
        if (!this.baseTexture.valid) {
          this.baseTexture.once("update", function() {
            return _this.onChildrenChange(0);
          });
        }
      }
      renderer.batch.setObjectRenderer(renderer.plugins.particle);
      renderer.plugins.particle.render(this);
    };
    ParticleContainer2.prototype.onChildrenChange = function(smallestChildIndex) {
      var bufferIndex = Math.floor(smallestChildIndex / this._batchSize);
      while (this._bufferUpdateIDs.length < bufferIndex) {
        this._bufferUpdateIDs.push(0);
      }
      this._bufferUpdateIDs[bufferIndex] = ++this._updateID;
    };
    ParticleContainer2.prototype.dispose = function() {
      if (this._buffers) {
        for (var i = 0; i < this._buffers.length; ++i) {
          this._buffers[i].destroy();
        }
        this._buffers = null;
      }
    };
    ParticleContainer2.prototype.destroy = function(options) {
      _super.prototype.destroy.call(this, options);
      this.dispose();
      this._properties = null;
      this._buffers = null;
      this._bufferUpdateIDs = null;
    };
    return ParticleContainer2;
  }(Container);
  var ParticleBuffer = function() {
    function ParticleBuffer2(properties, dynamicPropertyFlags, size) {
      this.geometry = new Geometry();
      this.indexBuffer = null;
      this.size = size;
      this.dynamicProperties = [];
      this.staticProperties = [];
      for (var i = 0; i < properties.length; ++i) {
        var property = properties[i];
        property = {
          attributeName: property.attributeName,
          size: property.size,
          uploadFunction: property.uploadFunction,
          type: property.type || TYPES.FLOAT,
          offset: property.offset
        };
        if (dynamicPropertyFlags[i]) {
          this.dynamicProperties.push(property);
        } else {
          this.staticProperties.push(property);
        }
      }
      this.staticStride = 0;
      this.staticBuffer = null;
      this.staticData = null;
      this.staticDataUint32 = null;
      this.dynamicStride = 0;
      this.dynamicBuffer = null;
      this.dynamicData = null;
      this.dynamicDataUint32 = null;
      this._updateID = 0;
      this.initBuffers();
    }
    ParticleBuffer2.prototype.initBuffers = function() {
      var geometry = this.geometry;
      var dynamicOffset = 0;
      this.indexBuffer = new Buffer2(createIndicesForQuads(this.size), true, true);
      geometry.addIndex(this.indexBuffer);
      this.dynamicStride = 0;
      for (var i = 0; i < this.dynamicProperties.length; ++i) {
        var property = this.dynamicProperties[i];
        property.offset = dynamicOffset;
        dynamicOffset += property.size;
        this.dynamicStride += property.size;
      }
      var dynBuffer = new ArrayBuffer(this.size * this.dynamicStride * 4 * 4);
      this.dynamicData = new Float32Array(dynBuffer);
      this.dynamicDataUint32 = new Uint32Array(dynBuffer);
      this.dynamicBuffer = new Buffer2(this.dynamicData, false, false);
      var staticOffset = 0;
      this.staticStride = 0;
      for (var i = 0; i < this.staticProperties.length; ++i) {
        var property = this.staticProperties[i];
        property.offset = staticOffset;
        staticOffset += property.size;
        this.staticStride += property.size;
      }
      var statBuffer = new ArrayBuffer(this.size * this.staticStride * 4 * 4);
      this.staticData = new Float32Array(statBuffer);
      this.staticDataUint32 = new Uint32Array(statBuffer);
      this.staticBuffer = new Buffer2(this.staticData, true, false);
      for (var i = 0; i < this.dynamicProperties.length; ++i) {
        var property = this.dynamicProperties[i];
        geometry.addAttribute(property.attributeName, this.dynamicBuffer, 0, property.type === TYPES.UNSIGNED_BYTE, property.type, this.dynamicStride * 4, property.offset * 4);
      }
      for (var i = 0; i < this.staticProperties.length; ++i) {
        var property = this.staticProperties[i];
        geometry.addAttribute(property.attributeName, this.staticBuffer, 0, property.type === TYPES.UNSIGNED_BYTE, property.type, this.staticStride * 4, property.offset * 4);
      }
    };
    ParticleBuffer2.prototype.uploadDynamic = function(children, startIndex, amount) {
      for (var i = 0; i < this.dynamicProperties.length; i++) {
        var property = this.dynamicProperties[i];
        property.uploadFunction(children, startIndex, amount, property.type === TYPES.UNSIGNED_BYTE ? this.dynamicDataUint32 : this.dynamicData, this.dynamicStride, property.offset);
      }
      this.dynamicBuffer._updateID++;
    };
    ParticleBuffer2.prototype.uploadStatic = function(children, startIndex, amount) {
      for (var i = 0; i < this.staticProperties.length; i++) {
        var property = this.staticProperties[i];
        property.uploadFunction(children, startIndex, amount, property.type === TYPES.UNSIGNED_BYTE ? this.staticDataUint32 : this.staticData, this.staticStride, property.offset);
      }
      this.staticBuffer._updateID++;
    };
    ParticleBuffer2.prototype.destroy = function() {
      this.indexBuffer = null;
      this.dynamicProperties = null;
      this.dynamicBuffer = null;
      this.dynamicData = null;
      this.dynamicDataUint32 = null;
      this.staticProperties = null;
      this.staticBuffer = null;
      this.staticData = null;
      this.staticDataUint32 = null;
      this.geometry.destroy();
    };
    return ParticleBuffer2;
  }();
  var fragment2 = "varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}";
  var vertex2 = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n";
  var ParticleRenderer = function(_super) {
    __extends5(ParticleRenderer2, _super);
    function ParticleRenderer2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.shader = null;
      _this.properties = null;
      _this.tempMatrix = new Matrix();
      _this.properties = [
        {
          attributeName: "aVertexPosition",
          size: 2,
          uploadFunction: _this.uploadVertices,
          offset: 0
        },
        {
          attributeName: "aPositionCoord",
          size: 2,
          uploadFunction: _this.uploadPosition,
          offset: 0
        },
        {
          attributeName: "aRotation",
          size: 1,
          uploadFunction: _this.uploadRotation,
          offset: 0
        },
        {
          attributeName: "aTextureCoord",
          size: 2,
          uploadFunction: _this.uploadUvs,
          offset: 0
        },
        {
          attributeName: "aColor",
          size: 1,
          type: TYPES.UNSIGNED_BYTE,
          uploadFunction: _this.uploadTint,
          offset: 0
        }
      ];
      _this.shader = Shader.from(vertex2, fragment2, {});
      _this.state = State.for2d();
      return _this;
    }
    ParticleRenderer2.prototype.render = function(container) {
      var children = container.children;
      var maxSize = container._maxSize;
      var batchSize = container._batchSize;
      var renderer = this.renderer;
      var totalChildren = children.length;
      if (totalChildren === 0) {
        return;
      } else if (totalChildren > maxSize && !container.autoResize) {
        totalChildren = maxSize;
      }
      var buffers = container._buffers;
      if (!buffers) {
        buffers = container._buffers = this.generateBuffers(container);
      }
      var baseTexture = children[0]._texture.baseTexture;
      this.state.blendMode = correctBlendMode(container.blendMode, baseTexture.alphaMode);
      renderer.state.set(this.state);
      var gl = renderer.gl;
      var m = container.worldTransform.copyTo(this.tempMatrix);
      m.prepend(renderer.globalUniforms.uniforms.projectionMatrix);
      this.shader.uniforms.translationMatrix = m.toArray(true);
      this.shader.uniforms.uColor = premultiplyRgba(container.tintRgb, container.worldAlpha, this.shader.uniforms.uColor, baseTexture.alphaMode);
      this.shader.uniforms.uSampler = baseTexture;
      this.renderer.shader.bind(this.shader);
      var updateStatic = false;
      for (var i = 0, j = 0; i < totalChildren; i += batchSize, j += 1) {
        var amount = totalChildren - i;
        if (amount > batchSize) {
          amount = batchSize;
        }
        if (j >= buffers.length) {
          buffers.push(this._generateOneMoreBuffer(container));
        }
        var buffer = buffers[j];
        buffer.uploadDynamic(children, i, amount);
        var bid = container._bufferUpdateIDs[j] || 0;
        updateStatic = updateStatic || buffer._updateID < bid;
        if (updateStatic) {
          buffer._updateID = container._updateID;
          buffer.uploadStatic(children, i, amount);
        }
        renderer.geometry.bind(buffer.geometry);
        gl.drawElements(gl.TRIANGLES, amount * 6, gl.UNSIGNED_SHORT, 0);
      }
    };
    ParticleRenderer2.prototype.generateBuffers = function(container) {
      var buffers = [];
      var size = container._maxSize;
      var batchSize = container._batchSize;
      var dynamicPropertyFlags = container._properties;
      for (var i = 0; i < size; i += batchSize) {
        buffers.push(new ParticleBuffer(this.properties, dynamicPropertyFlags, batchSize));
      }
      return buffers;
    };
    ParticleRenderer2.prototype._generateOneMoreBuffer = function(container) {
      var batchSize = container._batchSize;
      var dynamicPropertyFlags = container._properties;
      return new ParticleBuffer(this.properties, dynamicPropertyFlags, batchSize);
    };
    ParticleRenderer2.prototype.uploadVertices = function(children, startIndex, amount, array, stride, offset) {
      var w0 = 0;
      var w1 = 0;
      var h0 = 0;
      var h1 = 0;
      for (var i = 0; i < amount; ++i) {
        var sprite = children[startIndex + i];
        var texture = sprite._texture;
        var sx = sprite.scale.x;
        var sy = sprite.scale.y;
        var trim = texture.trim;
        var orig = texture.orig;
        if (trim) {
          w1 = trim.x - sprite.anchor.x * orig.width;
          w0 = w1 + trim.width;
          h1 = trim.y - sprite.anchor.y * orig.height;
          h0 = h1 + trim.height;
        } else {
          w0 = orig.width * (1 - sprite.anchor.x);
          w1 = orig.width * -sprite.anchor.x;
          h0 = orig.height * (1 - sprite.anchor.y);
          h1 = orig.height * -sprite.anchor.y;
        }
        array[offset] = w1 * sx;
        array[offset + 1] = h1 * sy;
        array[offset + stride] = w0 * sx;
        array[offset + stride + 1] = h1 * sy;
        array[offset + stride * 2] = w0 * sx;
        array[offset + stride * 2 + 1] = h0 * sy;
        array[offset + stride * 3] = w1 * sx;
        array[offset + stride * 3 + 1] = h0 * sy;
        offset += stride * 4;
      }
    };
    ParticleRenderer2.prototype.uploadPosition = function(children, startIndex, amount, array, stride, offset) {
      for (var i = 0; i < amount; i++) {
        var spritePosition = children[startIndex + i].position;
        array[offset] = spritePosition.x;
        array[offset + 1] = spritePosition.y;
        array[offset + stride] = spritePosition.x;
        array[offset + stride + 1] = spritePosition.y;
        array[offset + stride * 2] = spritePosition.x;
        array[offset + stride * 2 + 1] = spritePosition.y;
        array[offset + stride * 3] = spritePosition.x;
        array[offset + stride * 3 + 1] = spritePosition.y;
        offset += stride * 4;
      }
    };
    ParticleRenderer2.prototype.uploadRotation = function(children, startIndex, amount, array, stride, offset) {
      for (var i = 0; i < amount; i++) {
        var spriteRotation = children[startIndex + i].rotation;
        array[offset] = spriteRotation;
        array[offset + stride] = spriteRotation;
        array[offset + stride * 2] = spriteRotation;
        array[offset + stride * 3] = spriteRotation;
        offset += stride * 4;
      }
    };
    ParticleRenderer2.prototype.uploadUvs = function(children, startIndex, amount, array, stride, offset) {
      for (var i = 0; i < amount; ++i) {
        var textureUvs = children[startIndex + i]._texture._uvs;
        if (textureUvs) {
          array[offset] = textureUvs.x0;
          array[offset + 1] = textureUvs.y0;
          array[offset + stride] = textureUvs.x1;
          array[offset + stride + 1] = textureUvs.y1;
          array[offset + stride * 2] = textureUvs.x2;
          array[offset + stride * 2 + 1] = textureUvs.y2;
          array[offset + stride * 3] = textureUvs.x3;
          array[offset + stride * 3 + 1] = textureUvs.y3;
          offset += stride * 4;
        } else {
          array[offset] = 0;
          array[offset + 1] = 0;
          array[offset + stride] = 0;
          array[offset + stride + 1] = 0;
          array[offset + stride * 2] = 0;
          array[offset + stride * 2 + 1] = 0;
          array[offset + stride * 3] = 0;
          array[offset + stride * 3 + 1] = 0;
          offset += stride * 4;
        }
      }
    };
    ParticleRenderer2.prototype.uploadTint = function(children, startIndex, amount, array, stride, offset) {
      for (var i = 0; i < amount; ++i) {
        var sprite = children[startIndex + i];
        var premultiplied = sprite._texture.baseTexture.alphaMode > 0;
        var alpha = sprite.alpha;
        var argb = alpha < 1 && premultiplied ? premultiplyTint(sprite._tintRGB, alpha) : sprite._tintRGB + (alpha * 255 << 24);
        array[offset] = argb;
        array[offset + stride] = argb;
        array[offset + stride * 2] = argb;
        array[offset + stride * 3] = argb;
        offset += stride * 4;
      }
    };
    ParticleRenderer2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      if (this.shader) {
        this.shader.destroy();
        this.shader = null;
      }
      this.tempMatrix = null;
    };
    return ParticleRenderer2;
  }(ObjectRenderer);

  // node_modules/@pixi/graphics/lib/graphics.es.js
  /*!
   * @pixi/graphics - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/graphics is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var LINE_JOIN;
  (function(LINE_JOIN2) {
    LINE_JOIN2["MITER"] = "miter";
    LINE_JOIN2["BEVEL"] = "bevel";
    LINE_JOIN2["ROUND"] = "round";
  })(LINE_JOIN || (LINE_JOIN = {}));
  var LINE_CAP;
  (function(LINE_CAP2) {
    LINE_CAP2["BUTT"] = "butt";
    LINE_CAP2["ROUND"] = "round";
    LINE_CAP2["SQUARE"] = "square";
  })(LINE_CAP || (LINE_CAP = {}));
  var GRAPHICS_CURVES = {
    adaptive: true,
    maxLength: 10,
    minSegments: 8,
    maxSegments: 2048,
    epsilon: 1e-4,
    _segmentsCount: function(length, defaultSegments) {
      if (defaultSegments === void 0) {
        defaultSegments = 20;
      }
      if (!this.adaptive || !length || isNaN(length)) {
        return defaultSegments;
      }
      var result = Math.ceil(length / this.maxLength);
      if (result < this.minSegments) {
        result = this.minSegments;
      } else if (result > this.maxSegments) {
        result = this.maxSegments;
      }
      return result;
    }
  };
  var FillStyle = function() {
    function FillStyle2() {
      this.color = 16777215;
      this.alpha = 1;
      this.texture = Texture.WHITE;
      this.matrix = null;
      this.visible = false;
      this.reset();
    }
    FillStyle2.prototype.clone = function() {
      var obj = new FillStyle2();
      obj.color = this.color;
      obj.alpha = this.alpha;
      obj.texture = this.texture;
      obj.matrix = this.matrix;
      obj.visible = this.visible;
      return obj;
    };
    FillStyle2.prototype.reset = function() {
      this.color = 16777215;
      this.alpha = 1;
      this.texture = Texture.WHITE;
      this.matrix = null;
      this.visible = false;
    };
    FillStyle2.prototype.destroy = function() {
      this.texture = null;
      this.matrix = null;
    };
    return FillStyle2;
  }();
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics6 = function(d, b) {
    extendStatics6 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics6(d, b);
  };
  function __extends6(d, b) {
    extendStatics6(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var buildPoly = {
    build: function(graphicsData) {
      graphicsData.points = graphicsData.shape.points.slice();
    },
    triangulate: function(graphicsData, graphicsGeometry) {
      var points = graphicsData.points;
      var holes = graphicsData.holes;
      var verts = graphicsGeometry.points;
      var indices2 = graphicsGeometry.indices;
      if (points.length >= 6) {
        var holeArray = [];
        for (var i = 0; i < holes.length; i++) {
          var hole = holes[i];
          holeArray.push(points.length / 2);
          points = points.concat(hole.points);
        }
        var triangles = import_earcut.default(points, holeArray, 2);
        if (!triangles) {
          return;
        }
        var vertPos = verts.length / 2;
        for (var i = 0; i < triangles.length; i += 3) {
          indices2.push(triangles[i] + vertPos);
          indices2.push(triangles[i + 1] + vertPos);
          indices2.push(triangles[i + 2] + vertPos);
        }
        for (var i = 0; i < points.length; i++) {
          verts.push(points[i]);
        }
      }
    }
  };
  var buildCircle = {
    build: function(graphicsData) {
      var circleData = graphicsData.shape;
      var points = graphicsData.points;
      var x = circleData.x;
      var y = circleData.y;
      var width;
      var height;
      points.length = 0;
      if (graphicsData.type === SHAPES.CIRC) {
        width = circleData.radius;
        height = circleData.radius;
      } else {
        var ellipseData = graphicsData.shape;
        width = ellipseData.width;
        height = ellipseData.height;
      }
      if (width === 0 || height === 0) {
        return;
      }
      var totalSegs = Math.floor(30 * Math.sqrt(circleData.radius)) || Math.floor(15 * Math.sqrt(width + height));
      totalSegs /= 2.3;
      var seg = Math.PI * 2 / totalSegs;
      for (var i = 0; i < totalSegs - 0.5; i++) {
        points.push(x + Math.sin(-seg * i) * width, y + Math.cos(-seg * i) * height);
      }
      points.push(points[0], points[1]);
    },
    triangulate: function(graphicsData, graphicsGeometry) {
      var points = graphicsData.points;
      var verts = graphicsGeometry.points;
      var indices2 = graphicsGeometry.indices;
      var vertPos = verts.length / 2;
      var center = vertPos;
      var circle = graphicsData.shape;
      var matrix = graphicsData.matrix;
      var x = circle.x;
      var y = circle.y;
      verts.push(graphicsData.matrix ? matrix.a * x + matrix.c * y + matrix.tx : x, graphicsData.matrix ? matrix.b * x + matrix.d * y + matrix.ty : y);
      for (var i = 0; i < points.length; i += 2) {
        verts.push(points[i], points[i + 1]);
        indices2.push(vertPos++, center, vertPos);
      }
    }
  };
  var buildRectangle = {
    build: function(graphicsData) {
      var rectData = graphicsData.shape;
      var x = rectData.x;
      var y = rectData.y;
      var width = rectData.width;
      var height = rectData.height;
      var points = graphicsData.points;
      points.length = 0;
      points.push(x, y, x + width, y, x + width, y + height, x, y + height);
    },
    triangulate: function(graphicsData, graphicsGeometry) {
      var points = graphicsData.points;
      var verts = graphicsGeometry.points;
      var vertPos = verts.length / 2;
      verts.push(points[0], points[1], points[2], points[3], points[6], points[7], points[4], points[5]);
      graphicsGeometry.indices.push(vertPos, vertPos + 1, vertPos + 2, vertPos + 1, vertPos + 2, vertPos + 3);
    }
  };
  function getPt(n1, n2, perc) {
    var diff = n2 - n1;
    return n1 + diff * perc;
  }
  function quadraticBezierCurve(fromX, fromY, cpX, cpY, toX, toY, out) {
    if (out === void 0) {
      out = [];
    }
    var n = 20;
    var points = out;
    var xa = 0;
    var ya = 0;
    var xb = 0;
    var yb = 0;
    var x = 0;
    var y = 0;
    for (var i = 0, j = 0; i <= n; ++i) {
      j = i / n;
      xa = getPt(fromX, cpX, j);
      ya = getPt(fromY, cpY, j);
      xb = getPt(cpX, toX, j);
      yb = getPt(cpY, toY, j);
      x = getPt(xa, xb, j);
      y = getPt(ya, yb, j);
      points.push(x, y);
    }
    return points;
  }
  var buildRoundedRectangle = {
    build: function(graphicsData) {
      var rrectData = graphicsData.shape;
      var points = graphicsData.points;
      var x = rrectData.x;
      var y = rrectData.y;
      var width = rrectData.width;
      var height = rrectData.height;
      var radius = Math.max(0, Math.min(rrectData.radius, Math.min(width, height) / 2));
      points.length = 0;
      if (!radius) {
        points.push(x, y, x + width, y, x + width, y + height, x, y + height);
      } else {
        quadraticBezierCurve(x, y + radius, x, y, x + radius, y, points);
        quadraticBezierCurve(x + width - radius, y, x + width, y, x + width, y + radius, points);
        quadraticBezierCurve(x + width, y + height - radius, x + width, y + height, x + width - radius, y + height, points);
        quadraticBezierCurve(x + radius, y + height, x, y + height, x, y + height - radius, points);
      }
    },
    triangulate: function(graphicsData, graphicsGeometry) {
      var points = graphicsData.points;
      var verts = graphicsGeometry.points;
      var indices2 = graphicsGeometry.indices;
      var vecPos = verts.length / 2;
      var triangles = import_earcut.default(points, null, 2);
      for (var i = 0, j = triangles.length; i < j; i += 3) {
        indices2.push(triangles[i] + vecPos);
        indices2.push(triangles[i + 1] + vecPos);
        indices2.push(triangles[i + 2] + vecPos);
      }
      for (var i = 0, j = points.length; i < j; i++) {
        verts.push(points[i], points[++i]);
      }
    }
  };
  function square(x, y, nx, ny, innerWeight, outerWeight, clockwise, verts) {
    var ix = x - nx * innerWeight;
    var iy = y - ny * innerWeight;
    var ox = x + nx * outerWeight;
    var oy = y + ny * outerWeight;
    var exx;
    var eyy;
    if (clockwise) {
      exx = ny;
      eyy = -nx;
    } else {
      exx = -ny;
      eyy = nx;
    }
    var eix = ix + exx;
    var eiy = iy + eyy;
    var eox = ox + exx;
    var eoy = oy + eyy;
    verts.push(eix, eiy);
    verts.push(eox, eoy);
    return 2;
  }
  function round(cx, cy, sx, sy, ex, ey, verts, clockwise) {
    var cx2p0x = sx - cx;
    var cy2p0y = sy - cy;
    var angle0 = Math.atan2(cx2p0x, cy2p0y);
    var angle1 = Math.atan2(ex - cx, ey - cy);
    if (clockwise && angle0 < angle1) {
      angle0 += Math.PI * 2;
    } else if (!clockwise && angle0 > angle1) {
      angle1 += Math.PI * 2;
    }
    var startAngle = angle0;
    var angleDiff = angle1 - angle0;
    var absAngleDiff = Math.abs(angleDiff);
    var radius = Math.sqrt(cx2p0x * cx2p0x + cy2p0y * cy2p0y);
    var segCount = (15 * absAngleDiff * Math.sqrt(radius) / Math.PI >> 0) + 1;
    var angleInc = angleDiff / segCount;
    startAngle += angleInc;
    if (clockwise) {
      verts.push(cx, cy);
      verts.push(sx, sy);
      for (var i = 1, angle = startAngle; i < segCount; i++, angle += angleInc) {
        verts.push(cx, cy);
        verts.push(cx + Math.sin(angle) * radius, cy + Math.cos(angle) * radius);
      }
      verts.push(cx, cy);
      verts.push(ex, ey);
    } else {
      verts.push(sx, sy);
      verts.push(cx, cy);
      for (var i = 1, angle = startAngle; i < segCount; i++, angle += angleInc) {
        verts.push(cx + Math.sin(angle) * radius, cy + Math.cos(angle) * radius);
        verts.push(cx, cy);
      }
      verts.push(ex, ey);
      verts.push(cx, cy);
    }
    return segCount * 2;
  }
  function buildNonNativeLine(graphicsData, graphicsGeometry) {
    var shape = graphicsData.shape;
    var points = graphicsData.points || shape.points.slice();
    var eps = graphicsGeometry.closePointEps;
    if (points.length === 0) {
      return;
    }
    var style = graphicsData.lineStyle;
    var firstPoint = new Point(points[0], points[1]);
    var lastPoint = new Point(points[points.length - 2], points[points.length - 1]);
    var closedShape = shape.type !== SHAPES.POLY || shape.closeStroke;
    var closedPath = Math.abs(firstPoint.x - lastPoint.x) < eps && Math.abs(firstPoint.y - lastPoint.y) < eps;
    if (closedShape) {
      points = points.slice();
      if (closedPath) {
        points.pop();
        points.pop();
        lastPoint.set(points[points.length - 2], points[points.length - 1]);
      }
      var midPointX = (firstPoint.x + lastPoint.x) * 0.5;
      var midPointY = (lastPoint.y + firstPoint.y) * 0.5;
      points.unshift(midPointX, midPointY);
      points.push(midPointX, midPointY);
    }
    var verts = graphicsGeometry.points;
    var length = points.length / 2;
    var indexCount = points.length;
    var indexStart = verts.length / 2;
    var width = style.width / 2;
    var widthSquared = width * width;
    var miterLimitSquared = style.miterLimit * style.miterLimit;
    var x0 = points[0];
    var y0 = points[1];
    var x1 = points[2];
    var y1 = points[3];
    var x2 = 0;
    var y2 = 0;
    var perpx = -(y0 - y1);
    var perpy = x0 - x1;
    var perp1x = 0;
    var perp1y = 0;
    var dist = Math.sqrt(perpx * perpx + perpy * perpy);
    perpx /= dist;
    perpy /= dist;
    perpx *= width;
    perpy *= width;
    var ratio = style.alignment;
    var innerWeight = (1 - ratio) * 2;
    var outerWeight = ratio * 2;
    if (!closedShape) {
      if (style.cap === LINE_CAP.ROUND) {
        indexCount += round(x0 - perpx * (innerWeight - outerWeight) * 0.5, y0 - perpy * (innerWeight - outerWeight) * 0.5, x0 - perpx * innerWeight, y0 - perpy * innerWeight, x0 + perpx * outerWeight, y0 + perpy * outerWeight, verts, true) + 2;
      } else if (style.cap === LINE_CAP.SQUARE) {
        indexCount += square(x0, y0, perpx, perpy, innerWeight, outerWeight, true, verts);
      }
    }
    verts.push(x0 - perpx * innerWeight, y0 - perpy * innerWeight);
    verts.push(x0 + perpx * outerWeight, y0 + perpy * outerWeight);
    for (var i = 1; i < length - 1; ++i) {
      x0 = points[(i - 1) * 2];
      y0 = points[(i - 1) * 2 + 1];
      x1 = points[i * 2];
      y1 = points[i * 2 + 1];
      x2 = points[(i + 1) * 2];
      y2 = points[(i + 1) * 2 + 1];
      perpx = -(y0 - y1);
      perpy = x0 - x1;
      dist = Math.sqrt(perpx * perpx + perpy * perpy);
      perpx /= dist;
      perpy /= dist;
      perpx *= width;
      perpy *= width;
      perp1x = -(y1 - y2);
      perp1y = x1 - x2;
      dist = Math.sqrt(perp1x * perp1x + perp1y * perp1y);
      perp1x /= dist;
      perp1y /= dist;
      perp1x *= width;
      perp1y *= width;
      var dx0 = x1 - x0;
      var dy0 = y0 - y1;
      var dx1 = x1 - x2;
      var dy1 = y2 - y1;
      var cross = dy0 * dx1 - dy1 * dx0;
      var clockwise = cross < 0;
      if (Math.abs(cross) < 0.1) {
        verts.push(x1 - perpx * innerWeight, y1 - perpy * innerWeight);
        verts.push(x1 + perpx * outerWeight, y1 + perpy * outerWeight);
        continue;
      }
      var c1 = (-perpx + x0) * (-perpy + y1) - (-perpx + x1) * (-perpy + y0);
      var c2 = (-perp1x + x2) * (-perp1y + y1) - (-perp1x + x1) * (-perp1y + y2);
      var px = (dx0 * c2 - dx1 * c1) / cross;
      var py = (dy1 * c1 - dy0 * c2) / cross;
      var pdist = (px - x1) * (px - x1) + (py - y1) * (py - y1);
      var imx = x1 + (px - x1) * innerWeight;
      var imy = y1 + (py - y1) * innerWeight;
      var omx = x1 - (px - x1) * outerWeight;
      var omy = y1 - (py - y1) * outerWeight;
      var smallerInsideSegmentSq = Math.min(dx0 * dx0 + dy0 * dy0, dx1 * dx1 + dy1 * dy1);
      var insideWeight = clockwise ? innerWeight : outerWeight;
      var smallerInsideDiagonalSq = smallerInsideSegmentSq + insideWeight * insideWeight * widthSquared;
      var insideMiterOk = pdist <= smallerInsideDiagonalSq;
      if (insideMiterOk) {
        if (style.join === LINE_JOIN.BEVEL || pdist / widthSquared > miterLimitSquared) {
          if (clockwise) {
            verts.push(imx, imy);
            verts.push(x1 + perpx * outerWeight, y1 + perpy * outerWeight);
            verts.push(imx, imy);
            verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);
          } else {
            verts.push(x1 - perpx * innerWeight, y1 - perpy * innerWeight);
            verts.push(omx, omy);
            verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);
            verts.push(omx, omy);
          }
          indexCount += 2;
        } else if (style.join === LINE_JOIN.ROUND) {
          if (clockwise) {
            verts.push(imx, imy);
            verts.push(x1 + perpx * outerWeight, y1 + perpy * outerWeight);
            indexCount += round(x1, y1, x1 + perpx * outerWeight, y1 + perpy * outerWeight, x1 + perp1x * outerWeight, y1 + perp1y * outerWeight, verts, true) + 4;
            verts.push(imx, imy);
            verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);
          } else {
            verts.push(x1 - perpx * innerWeight, y1 - perpy * innerWeight);
            verts.push(omx, omy);
            indexCount += round(x1, y1, x1 - perpx * innerWeight, y1 - perpy * innerWeight, x1 - perp1x * innerWeight, y1 - perp1y * innerWeight, verts, false) + 4;
            verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);
            verts.push(omx, omy);
          }
        } else {
          verts.push(imx, imy);
          verts.push(omx, omy);
        }
      } else {
        verts.push(x1 - perpx * innerWeight, y1 - perpy * innerWeight);
        verts.push(x1 + perpx * outerWeight, y1 + perpy * outerWeight);
        if (style.join === LINE_JOIN.BEVEL || pdist / widthSquared > miterLimitSquared)
          ;
        else if (style.join === LINE_JOIN.ROUND) {
          if (clockwise) {
            indexCount += round(x1, y1, x1 + perpx * outerWeight, y1 + perpy * outerWeight, x1 + perp1x * outerWeight, y1 + perp1y * outerWeight, verts, true) + 2;
          } else {
            indexCount += round(x1, y1, x1 - perpx * innerWeight, y1 - perpy * innerWeight, x1 - perp1x * innerWeight, y1 - perp1y * innerWeight, verts, false) + 2;
          }
        } else {
          if (clockwise) {
            verts.push(omx, omy);
            verts.push(omx, omy);
          } else {
            verts.push(imx, imy);
            verts.push(imx, imy);
          }
          indexCount += 2;
        }
        verts.push(x1 - perp1x * innerWeight, y1 - perp1y * innerWeight);
        verts.push(x1 + perp1x * outerWeight, y1 + perp1y * outerWeight);
        indexCount += 2;
      }
    }
    x0 = points[(length - 2) * 2];
    y0 = points[(length - 2) * 2 + 1];
    x1 = points[(length - 1) * 2];
    y1 = points[(length - 1) * 2 + 1];
    perpx = -(y0 - y1);
    perpy = x0 - x1;
    dist = Math.sqrt(perpx * perpx + perpy * perpy);
    perpx /= dist;
    perpy /= dist;
    perpx *= width;
    perpy *= width;
    verts.push(x1 - perpx * innerWeight, y1 - perpy * innerWeight);
    verts.push(x1 + perpx * outerWeight, y1 + perpy * outerWeight);
    if (!closedShape) {
      if (style.cap === LINE_CAP.ROUND) {
        indexCount += round(x1 - perpx * (innerWeight - outerWeight) * 0.5, y1 - perpy * (innerWeight - outerWeight) * 0.5, x1 - perpx * innerWeight, y1 - perpy * innerWeight, x1 + perpx * outerWeight, y1 + perpy * outerWeight, verts, false) + 2;
      } else if (style.cap === LINE_CAP.SQUARE) {
        indexCount += square(x1, y1, perpx, perpy, innerWeight, outerWeight, false, verts);
      }
    }
    var indices2 = graphicsGeometry.indices;
    var eps2 = GRAPHICS_CURVES.epsilon * GRAPHICS_CURVES.epsilon;
    for (var i = indexStart; i < indexCount + indexStart - 2; ++i) {
      x0 = verts[i * 2];
      y0 = verts[i * 2 + 1];
      x1 = verts[(i + 1) * 2];
      y1 = verts[(i + 1) * 2 + 1];
      x2 = verts[(i + 2) * 2];
      y2 = verts[(i + 2) * 2 + 1];
      if (Math.abs(x0 * (y1 - y2) + x1 * (y2 - y0) + x2 * (y0 - y1)) < eps2) {
        continue;
      }
      indices2.push(i, i + 1, i + 2);
    }
  }
  function buildNativeLine(graphicsData, graphicsGeometry) {
    var i = 0;
    var shape = graphicsData.shape;
    var points = graphicsData.points || shape.points;
    var closedShape = shape.type !== SHAPES.POLY || shape.closeStroke;
    if (points.length === 0) {
      return;
    }
    var verts = graphicsGeometry.points;
    var indices2 = graphicsGeometry.indices;
    var length = points.length / 2;
    var startIndex = verts.length / 2;
    var currentIndex = startIndex;
    verts.push(points[0], points[1]);
    for (i = 1; i < length; i++) {
      verts.push(points[i * 2], points[i * 2 + 1]);
      indices2.push(currentIndex, currentIndex + 1);
      currentIndex++;
    }
    if (closedShape) {
      indices2.push(currentIndex, startIndex);
    }
  }
  function buildLine(graphicsData, graphicsGeometry) {
    if (graphicsData.lineStyle.native) {
      buildNativeLine(graphicsData, graphicsGeometry);
    } else {
      buildNonNativeLine(graphicsData, graphicsGeometry);
    }
  }
  var Star = function(_super) {
    __extends6(Star2, _super);
    function Star2(x, y, points, radius, innerRadius, rotation) {
      if (rotation === void 0) {
        rotation = 0;
      }
      var _this = this;
      innerRadius = innerRadius || radius / 2;
      var startAngle = -1 * Math.PI / 2 + rotation;
      var len = points * 2;
      var delta = PI_2 / len;
      var polygon = [];
      for (var i = 0; i < len; i++) {
        var r = i % 2 ? innerRadius : radius;
        var angle = i * delta + startAngle;
        polygon.push(x + r * Math.cos(angle), y + r * Math.sin(angle));
      }
      _this = _super.call(this, polygon) || this;
      return _this;
    }
    return Star2;
  }(Polygon);
  var ArcUtils = function() {
    function ArcUtils2() {
    }
    ArcUtils2.curveTo = function(x1, y1, x2, y2, radius, points) {
      var fromX = points[points.length - 2];
      var fromY = points[points.length - 1];
      var a1 = fromY - y1;
      var b1 = fromX - x1;
      var a2 = y2 - y1;
      var b2 = x2 - x1;
      var mm = Math.abs(a1 * b2 - b1 * a2);
      if (mm < 1e-8 || radius === 0) {
        if (points[points.length - 2] !== x1 || points[points.length - 1] !== y1) {
          points.push(x1, y1);
        }
        return null;
      }
      var dd = a1 * a1 + b1 * b1;
      var cc = a2 * a2 + b2 * b2;
      var tt = a1 * a2 + b1 * b2;
      var k1 = radius * Math.sqrt(dd) / mm;
      var k2 = radius * Math.sqrt(cc) / mm;
      var j1 = k1 * tt / dd;
      var j2 = k2 * tt / cc;
      var cx = k1 * b2 + k2 * b1;
      var cy = k1 * a2 + k2 * a1;
      var px = b1 * (k2 + j1);
      var py = a1 * (k2 + j1);
      var qx = b2 * (k1 + j2);
      var qy = a2 * (k1 + j2);
      var startAngle = Math.atan2(py - cy, px - cx);
      var endAngle = Math.atan2(qy - cy, qx - cx);
      return {
        cx: cx + x1,
        cy: cy + y1,
        radius,
        startAngle,
        endAngle,
        anticlockwise: b1 * a2 > b2 * a1
      };
    };
    ArcUtils2.arc = function(_startX, _startY, cx, cy, radius, startAngle, endAngle, _anticlockwise, points) {
      var sweep = endAngle - startAngle;
      var n = GRAPHICS_CURVES._segmentsCount(Math.abs(sweep) * radius, Math.ceil(Math.abs(sweep) / PI_2) * 40);
      var theta = sweep / (n * 2);
      var theta2 = theta * 2;
      var cTheta = Math.cos(theta);
      var sTheta = Math.sin(theta);
      var segMinus = n - 1;
      var remainder = segMinus % 1 / segMinus;
      for (var i = 0; i <= segMinus; ++i) {
        var real = i + remainder * i;
        var angle = theta + startAngle + theta2 * real;
        var c = Math.cos(angle);
        var s = -Math.sin(angle);
        points.push((cTheta * c + sTheta * s) * radius + cx, (cTheta * -s + sTheta * c) * radius + cy);
      }
    };
    return ArcUtils2;
  }();
  var BezierUtils = function() {
    function BezierUtils2() {
    }
    BezierUtils2.curveLength = function(fromX, fromY, cpX, cpY, cpX2, cpY2, toX, toY) {
      var n = 10;
      var result = 0;
      var t = 0;
      var t2 = 0;
      var t3 = 0;
      var nt = 0;
      var nt2 = 0;
      var nt3 = 0;
      var x = 0;
      var y = 0;
      var dx = 0;
      var dy = 0;
      var prevX = fromX;
      var prevY = fromY;
      for (var i = 1; i <= n; ++i) {
        t = i / n;
        t2 = t * t;
        t3 = t2 * t;
        nt = 1 - t;
        nt2 = nt * nt;
        nt3 = nt2 * nt;
        x = nt3 * fromX + 3 * nt2 * t * cpX + 3 * nt * t2 * cpX2 + t3 * toX;
        y = nt3 * fromY + 3 * nt2 * t * cpY + 3 * nt * t2 * cpY2 + t3 * toY;
        dx = prevX - x;
        dy = prevY - y;
        prevX = x;
        prevY = y;
        result += Math.sqrt(dx * dx + dy * dy);
      }
      return result;
    };
    BezierUtils2.curveTo = function(cpX, cpY, cpX2, cpY2, toX, toY, points) {
      var fromX = points[points.length - 2];
      var fromY = points[points.length - 1];
      points.length -= 2;
      var n = GRAPHICS_CURVES._segmentsCount(BezierUtils2.curveLength(fromX, fromY, cpX, cpY, cpX2, cpY2, toX, toY));
      var dt = 0;
      var dt2 = 0;
      var dt3 = 0;
      var t2 = 0;
      var t3 = 0;
      points.push(fromX, fromY);
      for (var i = 1, j = 0; i <= n; ++i) {
        j = i / n;
        dt = 1 - j;
        dt2 = dt * dt;
        dt3 = dt2 * dt;
        t2 = j * j;
        t3 = t2 * j;
        points.push(dt3 * fromX + 3 * dt2 * j * cpX + 3 * dt * t2 * cpX2 + t3 * toX, dt3 * fromY + 3 * dt2 * j * cpY + 3 * dt * t2 * cpY2 + t3 * toY);
      }
    };
    return BezierUtils2;
  }();
  var QuadraticUtils = function() {
    function QuadraticUtils2() {
    }
    QuadraticUtils2.curveLength = function(fromX, fromY, cpX, cpY, toX, toY) {
      var ax = fromX - 2 * cpX + toX;
      var ay = fromY - 2 * cpY + toY;
      var bx = 2 * cpX - 2 * fromX;
      var by = 2 * cpY - 2 * fromY;
      var a = 4 * (ax * ax + ay * ay);
      var b = 4 * (ax * bx + ay * by);
      var c = bx * bx + by * by;
      var s = 2 * Math.sqrt(a + b + c);
      var a2 = Math.sqrt(a);
      var a32 = 2 * a * a2;
      var c2 = 2 * Math.sqrt(c);
      var ba = b / a2;
      return (a32 * s + a2 * b * (s - c2) + (4 * c * a - b * b) * Math.log((2 * a2 + ba + s) / (ba + c2))) / (4 * a32);
    };
    QuadraticUtils2.curveTo = function(cpX, cpY, toX, toY, points) {
      var fromX = points[points.length - 2];
      var fromY = points[points.length - 1];
      var n = GRAPHICS_CURVES._segmentsCount(QuadraticUtils2.curveLength(fromX, fromY, cpX, cpY, toX, toY));
      var xa = 0;
      var ya = 0;
      for (var i = 1; i <= n; ++i) {
        var j = i / n;
        xa = fromX + (cpX - fromX) * j;
        ya = fromY + (cpY - fromY) * j;
        points.push(xa + (cpX + (toX - cpX) * j - xa) * j, ya + (cpY + (toY - cpY) * j - ya) * j);
      }
    };
    return QuadraticUtils2;
  }();
  var BatchPart = function() {
    function BatchPart2() {
      this.reset();
    }
    BatchPart2.prototype.begin = function(style, startIndex, attribStart) {
      this.reset();
      this.style = style;
      this.start = startIndex;
      this.attribStart = attribStart;
    };
    BatchPart2.prototype.end = function(endIndex, endAttrib) {
      this.attribSize = endAttrib - this.attribStart;
      this.size = endIndex - this.start;
    };
    BatchPart2.prototype.reset = function() {
      this.style = null;
      this.size = 0;
      this.start = 0;
      this.attribStart = 0;
      this.attribSize = 0;
    };
    return BatchPart2;
  }();
  var _a;
  var FILL_COMMANDS = (_a = {}, _a[SHAPES.POLY] = buildPoly, _a[SHAPES.CIRC] = buildCircle, _a[SHAPES.ELIP] = buildCircle, _a[SHAPES.RECT] = buildRectangle, _a[SHAPES.RREC] = buildRoundedRectangle, _a);
  var BATCH_POOL = [];
  var DRAW_CALL_POOL = [];
  var GraphicsData = function() {
    function GraphicsData2(shape, fillStyle, lineStyle, matrix) {
      if (fillStyle === void 0) {
        fillStyle = null;
      }
      if (lineStyle === void 0) {
        lineStyle = null;
      }
      if (matrix === void 0) {
        matrix = null;
      }
      this.shape = shape;
      this.lineStyle = lineStyle;
      this.fillStyle = fillStyle;
      this.matrix = matrix;
      this.type = shape.type;
      this.points = [];
      this.holes = [];
    }
    GraphicsData2.prototype.clone = function() {
      return new GraphicsData2(this.shape, this.fillStyle, this.lineStyle, this.matrix);
    };
    GraphicsData2.prototype.destroy = function() {
      this.shape = null;
      this.holes.length = 0;
      this.holes = null;
      this.points.length = 0;
      this.points = null;
      this.lineStyle = null;
      this.fillStyle = null;
    };
    return GraphicsData2;
  }();
  var tmpPoint = new Point();
  var tmpBounds = new Bounds();
  var GraphicsGeometry = function(_super) {
    __extends6(GraphicsGeometry2, _super);
    function GraphicsGeometry2() {
      var _this = _super.call(this) || this;
      _this.uvsFloat32 = null;
      _this.indicesUint16 = null;
      _this.points = [];
      _this.colors = [];
      _this.uvs = [];
      _this.indices = [];
      _this.textureIds = [];
      _this.graphicsData = [];
      _this.dirty = 0;
      _this.batchDirty = -1;
      _this.cacheDirty = -1;
      _this.clearDirty = 0;
      _this.drawCalls = [];
      _this.batches = [];
      _this.shapeIndex = 0;
      _this._bounds = new Bounds();
      _this.boundsDirty = -1;
      _this.boundsPadding = 0;
      _this.batchable = false;
      _this.indicesUint16 = null;
      _this.uvsFloat32 = null;
      _this.closePointEps = 1e-4;
      return _this;
    }
    Object.defineProperty(GraphicsGeometry2.prototype, "bounds", {
      get: function() {
        if (this.boundsDirty !== this.dirty) {
          this.boundsDirty = this.dirty;
          this.calculateBounds();
        }
        return this._bounds;
      },
      enumerable: false,
      configurable: true
    });
    GraphicsGeometry2.prototype.invalidate = function() {
      this.boundsDirty = -1;
      this.dirty++;
      this.batchDirty++;
      this.shapeIndex = 0;
      this.points.length = 0;
      this.colors.length = 0;
      this.uvs.length = 0;
      this.indices.length = 0;
      this.textureIds.length = 0;
      for (var i = 0; i < this.drawCalls.length; i++) {
        this.drawCalls[i].texArray.clear();
        DRAW_CALL_POOL.push(this.drawCalls[i]);
      }
      this.drawCalls.length = 0;
      for (var i = 0; i < this.batches.length; i++) {
        var batchPart = this.batches[i];
        batchPart.reset();
        BATCH_POOL.push(batchPart);
      }
      this.batches.length = 0;
    };
    GraphicsGeometry2.prototype.clear = function() {
      if (this.graphicsData.length > 0) {
        this.invalidate();
        this.clearDirty++;
        this.graphicsData.length = 0;
      }
      return this;
    };
    GraphicsGeometry2.prototype.drawShape = function(shape, fillStyle, lineStyle, matrix) {
      if (fillStyle === void 0) {
        fillStyle = null;
      }
      if (lineStyle === void 0) {
        lineStyle = null;
      }
      if (matrix === void 0) {
        matrix = null;
      }
      var data = new GraphicsData(shape, fillStyle, lineStyle, matrix);
      this.graphicsData.push(data);
      this.dirty++;
      return this;
    };
    GraphicsGeometry2.prototype.drawHole = function(shape, matrix) {
      if (matrix === void 0) {
        matrix = null;
      }
      if (!this.graphicsData.length) {
        return null;
      }
      var data = new GraphicsData(shape, null, null, matrix);
      var lastShape = this.graphicsData[this.graphicsData.length - 1];
      data.lineStyle = lastShape.lineStyle;
      lastShape.holes.push(data);
      this.dirty++;
      return this;
    };
    GraphicsGeometry2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      for (var i = 0; i < this.graphicsData.length; ++i) {
        this.graphicsData[i].destroy();
      }
      this.points.length = 0;
      this.points = null;
      this.colors.length = 0;
      this.colors = null;
      this.uvs.length = 0;
      this.uvs = null;
      this.indices.length = 0;
      this.indices = null;
      this.indexBuffer.destroy();
      this.indexBuffer = null;
      this.graphicsData.length = 0;
      this.graphicsData = null;
      this.drawCalls.length = 0;
      this.drawCalls = null;
      this.batches.length = 0;
      this.batches = null;
      this._bounds = null;
    };
    GraphicsGeometry2.prototype.containsPoint = function(point) {
      var graphicsData = this.graphicsData;
      for (var i = 0; i < graphicsData.length; ++i) {
        var data = graphicsData[i];
        if (!data.fillStyle.visible) {
          continue;
        }
        if (data.shape) {
          if (data.matrix) {
            data.matrix.applyInverse(point, tmpPoint);
          } else {
            tmpPoint.copyFrom(point);
          }
          if (data.shape.contains(tmpPoint.x, tmpPoint.y)) {
            var hitHole = false;
            if (data.holes) {
              for (var i_1 = 0; i_1 < data.holes.length; i_1++) {
                var hole = data.holes[i_1];
                if (hole.shape.contains(tmpPoint.x, tmpPoint.y)) {
                  hitHole = true;
                  break;
                }
              }
            }
            if (!hitHole) {
              return true;
            }
          }
        }
      }
      return false;
    };
    GraphicsGeometry2.prototype.updateBatches = function(allow32Indices) {
      if (!this.graphicsData.length) {
        this.batchable = true;
        return;
      }
      if (!this.validateBatching()) {
        return;
      }
      this.cacheDirty = this.dirty;
      var uvs = this.uvs;
      var graphicsData = this.graphicsData;
      var batchPart = null;
      var currentStyle = null;
      if (this.batches.length > 0) {
        batchPart = this.batches[this.batches.length - 1];
        currentStyle = batchPart.style;
      }
      for (var i = this.shapeIndex; i < graphicsData.length; i++) {
        this.shapeIndex++;
        var data = graphicsData[i];
        var fillStyle = data.fillStyle;
        var lineStyle = data.lineStyle;
        var command = FILL_COMMANDS[data.type];
        command.build(data);
        if (data.matrix) {
          this.transformPoints(data.points, data.matrix);
        }
        for (var j = 0; j < 2; j++) {
          var style = j === 0 ? fillStyle : lineStyle;
          if (!style.visible) {
            continue;
          }
          var nextTexture = style.texture.baseTexture;
          var index_1 = this.indices.length;
          var attribIndex = this.points.length / 2;
          nextTexture.wrapMode = WRAP_MODES.REPEAT;
          if (j === 0) {
            this.processFill(data);
          } else {
            this.processLine(data);
          }
          var size = this.points.length / 2 - attribIndex;
          if (size === 0) {
            continue;
          }
          if (batchPart && !this._compareStyles(currentStyle, style)) {
            batchPart.end(index_1, attribIndex);
            batchPart = null;
          }
          if (!batchPart) {
            batchPart = BATCH_POOL.pop() || new BatchPart();
            batchPart.begin(style, index_1, attribIndex);
            this.batches.push(batchPart);
            currentStyle = style;
          }
          this.addUvs(this.points, uvs, style.texture, attribIndex, size, style.matrix);
        }
      }
      var index2 = this.indices.length;
      var attrib = this.points.length / 2;
      if (batchPart) {
        batchPart.end(index2, attrib);
      }
      if (this.batches.length === 0) {
        this.batchable = true;
        return;
      }
      if (this.indicesUint16 && this.indices.length === this.indicesUint16.length) {
        this.indicesUint16.set(this.indices);
      } else {
        var need32 = attrib > 65535 && allow32Indices;
        this.indicesUint16 = need32 ? new Uint32Array(this.indices) : new Uint16Array(this.indices);
      }
      this.batchable = this.isBatchable();
      if (this.batchable) {
        this.packBatches();
      } else {
        this.buildDrawCalls();
      }
    };
    GraphicsGeometry2.prototype._compareStyles = function(styleA, styleB) {
      if (!styleA || !styleB) {
        return false;
      }
      if (styleA.texture.baseTexture !== styleB.texture.baseTexture) {
        return false;
      }
      if (styleA.color + styleA.alpha !== styleB.color + styleB.alpha) {
        return false;
      }
      if (!!styleA.native !== !!styleB.native) {
        return false;
      }
      return true;
    };
    GraphicsGeometry2.prototype.validateBatching = function() {
      if (this.dirty === this.cacheDirty || !this.graphicsData.length) {
        return false;
      }
      for (var i = 0, l = this.graphicsData.length; i < l; i++) {
        var data = this.graphicsData[i];
        var fill = data.fillStyle;
        var line = data.lineStyle;
        if (fill && !fill.texture.baseTexture.valid) {
          return false;
        }
        if (line && !line.texture.baseTexture.valid) {
          return false;
        }
      }
      return true;
    };
    GraphicsGeometry2.prototype.packBatches = function() {
      this.batchDirty++;
      this.uvsFloat32 = new Float32Array(this.uvs);
      var batches = this.batches;
      for (var i = 0, l = batches.length; i < l; i++) {
        var batch = batches[i];
        for (var j = 0; j < batch.size; j++) {
          var index2 = batch.start + j;
          this.indicesUint16[index2] = this.indicesUint16[index2] - batch.attribStart;
        }
      }
    };
    GraphicsGeometry2.prototype.isBatchable = function() {
      if (this.points.length > 65535 * 2) {
        return false;
      }
      var batches = this.batches;
      for (var i = 0; i < batches.length; i++) {
        if (batches[i].style.native) {
          return false;
        }
      }
      return this.points.length < GraphicsGeometry2.BATCHABLE_SIZE * 2;
    };
    GraphicsGeometry2.prototype.buildDrawCalls = function() {
      var TICK = ++BaseTexture._globalBatch;
      for (var i = 0; i < this.drawCalls.length; i++) {
        this.drawCalls[i].texArray.clear();
        DRAW_CALL_POOL.push(this.drawCalls[i]);
      }
      this.drawCalls.length = 0;
      var colors = this.colors;
      var textureIds = this.textureIds;
      var currentGroup = DRAW_CALL_POOL.pop();
      if (!currentGroup) {
        currentGroup = new BatchDrawCall();
        currentGroup.texArray = new BatchTextureArray();
      }
      currentGroup.texArray.count = 0;
      currentGroup.start = 0;
      currentGroup.size = 0;
      currentGroup.type = DRAW_MODES.TRIANGLES;
      var textureCount = 0;
      var currentTexture = null;
      var textureId = 0;
      var native = false;
      var drawMode = DRAW_MODES.TRIANGLES;
      var index2 = 0;
      this.drawCalls.push(currentGroup);
      for (var i = 0; i < this.batches.length; i++) {
        var data = this.batches[i];
        var MAX_TEXTURES = 8;
        var style = data.style;
        var nextTexture = style.texture.baseTexture;
        if (native !== !!style.native) {
          native = !!style.native;
          drawMode = native ? DRAW_MODES.LINES : DRAW_MODES.TRIANGLES;
          currentTexture = null;
          textureCount = MAX_TEXTURES;
          TICK++;
        }
        if (currentTexture !== nextTexture) {
          currentTexture = nextTexture;
          if (nextTexture._batchEnabled !== TICK) {
            if (textureCount === MAX_TEXTURES) {
              TICK++;
              textureCount = 0;
              if (currentGroup.size > 0) {
                currentGroup = DRAW_CALL_POOL.pop();
                if (!currentGroup) {
                  currentGroup = new BatchDrawCall();
                  currentGroup.texArray = new BatchTextureArray();
                }
                this.drawCalls.push(currentGroup);
              }
              currentGroup.start = index2;
              currentGroup.size = 0;
              currentGroup.texArray.count = 0;
              currentGroup.type = drawMode;
            }
            nextTexture.touched = 1;
            nextTexture._batchEnabled = TICK;
            nextTexture._batchLocation = textureCount;
            nextTexture.wrapMode = 10497;
            currentGroup.texArray.elements[currentGroup.texArray.count++] = nextTexture;
            textureCount++;
          }
        }
        currentGroup.size += data.size;
        index2 += data.size;
        textureId = nextTexture._batchLocation;
        this.addColors(colors, style.color, style.alpha, data.attribSize);
        this.addTextureIds(textureIds, textureId, data.attribSize);
      }
      BaseTexture._globalBatch = TICK;
      this.packAttributes();
    };
    GraphicsGeometry2.prototype.packAttributes = function() {
      var verts = this.points;
      var uvs = this.uvs;
      var colors = this.colors;
      var textureIds = this.textureIds;
      var glPoints = new ArrayBuffer(verts.length * 3 * 4);
      var f32 = new Float32Array(glPoints);
      var u32 = new Uint32Array(glPoints);
      var p = 0;
      for (var i = 0; i < verts.length / 2; i++) {
        f32[p++] = verts[i * 2];
        f32[p++] = verts[i * 2 + 1];
        f32[p++] = uvs[i * 2];
        f32[p++] = uvs[i * 2 + 1];
        u32[p++] = colors[i];
        f32[p++] = textureIds[i];
      }
      this._buffer.update(glPoints);
      this._indexBuffer.update(this.indicesUint16);
    };
    GraphicsGeometry2.prototype.processFill = function(data) {
      if (data.holes.length) {
        this.processHoles(data.holes);
        buildPoly.triangulate(data, this);
      } else {
        var command = FILL_COMMANDS[data.type];
        command.triangulate(data, this);
      }
    };
    GraphicsGeometry2.prototype.processLine = function(data) {
      buildLine(data, this);
      for (var i = 0; i < data.holes.length; i++) {
        buildLine(data.holes[i], this);
      }
    };
    GraphicsGeometry2.prototype.processHoles = function(holes) {
      for (var i = 0; i < holes.length; i++) {
        var hole = holes[i];
        var command = FILL_COMMANDS[hole.type];
        command.build(hole);
        if (hole.matrix) {
          this.transformPoints(hole.points, hole.matrix);
        }
      }
    };
    GraphicsGeometry2.prototype.calculateBounds = function() {
      var bounds = this._bounds;
      var sequenceBounds = tmpBounds;
      var curMatrix = Matrix.IDENTITY;
      this._bounds.clear();
      sequenceBounds.clear();
      for (var i = 0; i < this.graphicsData.length; i++) {
        var data = this.graphicsData[i];
        var shape = data.shape;
        var type = data.type;
        var lineStyle = data.lineStyle;
        var nextMatrix = data.matrix || Matrix.IDENTITY;
        var lineWidth = 0;
        if (lineStyle && lineStyle.visible) {
          var alignment = lineStyle.alignment;
          lineWidth = lineStyle.width;
          if (type === SHAPES.POLY) {
            lineWidth = lineWidth * (0.5 + Math.abs(0.5 - alignment));
          } else {
            lineWidth = lineWidth * Math.max(0, alignment);
          }
        }
        if (curMatrix !== nextMatrix) {
          if (!sequenceBounds.isEmpty()) {
            bounds.addBoundsMatrix(sequenceBounds, curMatrix);
            sequenceBounds.clear();
          }
          curMatrix = nextMatrix;
        }
        if (type === SHAPES.RECT || type === SHAPES.RREC) {
          var rect = shape;
          sequenceBounds.addFramePad(rect.x, rect.y, rect.x + rect.width, rect.y + rect.height, lineWidth, lineWidth);
        } else if (type === SHAPES.CIRC) {
          var circle = shape;
          sequenceBounds.addFramePad(circle.x, circle.y, circle.x, circle.y, circle.radius + lineWidth, circle.radius + lineWidth);
        } else if (type === SHAPES.ELIP) {
          var ellipse = shape;
          sequenceBounds.addFramePad(ellipse.x, ellipse.y, ellipse.x, ellipse.y, ellipse.width + lineWidth, ellipse.height + lineWidth);
        } else {
          var poly = shape;
          bounds.addVerticesMatrix(curMatrix, poly.points, 0, poly.points.length, lineWidth, lineWidth);
        }
      }
      if (!sequenceBounds.isEmpty()) {
        bounds.addBoundsMatrix(sequenceBounds, curMatrix);
      }
      bounds.pad(this.boundsPadding, this.boundsPadding);
    };
    GraphicsGeometry2.prototype.transformPoints = function(points, matrix) {
      for (var i = 0; i < points.length / 2; i++) {
        var x = points[i * 2];
        var y = points[i * 2 + 1];
        points[i * 2] = matrix.a * x + matrix.c * y + matrix.tx;
        points[i * 2 + 1] = matrix.b * x + matrix.d * y + matrix.ty;
      }
    };
    GraphicsGeometry2.prototype.addColors = function(colors, color, alpha, size) {
      var rgb = (color >> 16) + (color & 65280) + ((color & 255) << 16);
      var rgba = premultiplyTint(rgb, alpha);
      while (size-- > 0) {
        colors.push(rgba);
      }
    };
    GraphicsGeometry2.prototype.addTextureIds = function(textureIds, id, size) {
      while (size-- > 0) {
        textureIds.push(id);
      }
    };
    GraphicsGeometry2.prototype.addUvs = function(verts, uvs, texture, start, size, matrix) {
      if (matrix === void 0) {
        matrix = null;
      }
      var index2 = 0;
      var uvsStart = uvs.length;
      var frame = texture.frame;
      while (index2 < size) {
        var x = verts[(start + index2) * 2];
        var y = verts[(start + index2) * 2 + 1];
        if (matrix) {
          var nx = matrix.a * x + matrix.c * y + matrix.tx;
          y = matrix.b * x + matrix.d * y + matrix.ty;
          x = nx;
        }
        index2++;
        uvs.push(x / frame.width, y / frame.height);
      }
      var baseTexture = texture.baseTexture;
      if (frame.width < baseTexture.width || frame.height < baseTexture.height) {
        this.adjustUvs(uvs, texture, uvsStart, size);
      }
    };
    GraphicsGeometry2.prototype.adjustUvs = function(uvs, texture, start, size) {
      var baseTexture = texture.baseTexture;
      var eps = 1e-6;
      var finish = start + size * 2;
      var frame = texture.frame;
      var scaleX = frame.width / baseTexture.width;
      var scaleY = frame.height / baseTexture.height;
      var offsetX = frame.x / frame.width;
      var offsetY = frame.y / frame.height;
      var minX = Math.floor(uvs[start] + eps);
      var minY = Math.floor(uvs[start + 1] + eps);
      for (var i = start + 2; i < finish; i += 2) {
        minX = Math.min(minX, Math.floor(uvs[i] + eps));
        minY = Math.min(minY, Math.floor(uvs[i + 1] + eps));
      }
      offsetX -= minX;
      offsetY -= minY;
      for (var i = start; i < finish; i += 2) {
        uvs[i] = (uvs[i] + offsetX) * scaleX;
        uvs[i + 1] = (uvs[i + 1] + offsetY) * scaleY;
      }
    };
    GraphicsGeometry2.BATCHABLE_SIZE = 100;
    return GraphicsGeometry2;
  }(BatchGeometry);
  var LineStyle = function(_super) {
    __extends6(LineStyle2, _super);
    function LineStyle2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.width = 0;
      _this.alignment = 0.5;
      _this.native = false;
      _this.cap = LINE_CAP.BUTT;
      _this.join = LINE_JOIN.MITER;
      _this.miterLimit = 10;
      return _this;
    }
    LineStyle2.prototype.clone = function() {
      var obj = new LineStyle2();
      obj.color = this.color;
      obj.alpha = this.alpha;
      obj.texture = this.texture;
      obj.matrix = this.matrix;
      obj.visible = this.visible;
      obj.width = this.width;
      obj.alignment = this.alignment;
      obj.native = this.native;
      obj.cap = this.cap;
      obj.join = this.join;
      obj.miterLimit = this.miterLimit;
      return obj;
    };
    LineStyle2.prototype.reset = function() {
      _super.prototype.reset.call(this);
      this.color = 0;
      this.alignment = 0.5;
      this.width = 0;
      this.native = false;
    };
    return LineStyle2;
  }(FillStyle);
  var temp = new Float32Array(3);
  var DEFAULT_SHADERS = {};
  var Graphics = function(_super) {
    __extends6(Graphics2, _super);
    function Graphics2(geometry) {
      if (geometry === void 0) {
        geometry = null;
      }
      var _this = _super.call(this) || this;
      _this._geometry = geometry || new GraphicsGeometry();
      _this._geometry.refCount++;
      _this.shader = null;
      _this.state = State.for2d();
      _this._fillStyle = new FillStyle();
      _this._lineStyle = new LineStyle();
      _this._matrix = null;
      _this._holeMode = false;
      _this.currentPath = null;
      _this.batches = [];
      _this.batchTint = -1;
      _this.batchDirty = -1;
      _this.vertexData = null;
      _this.pluginName = "batch";
      _this._transformID = -1;
      _this.tint = 16777215;
      _this.blendMode = BLEND_MODES.NORMAL;
      return _this;
    }
    Object.defineProperty(Graphics2.prototype, "geometry", {
      get: function() {
        return this._geometry;
      },
      enumerable: false,
      configurable: true
    });
    Graphics2.prototype.clone = function() {
      this.finishPoly();
      return new Graphics2(this._geometry);
    };
    Object.defineProperty(Graphics2.prototype, "blendMode", {
      get: function() {
        return this.state.blendMode;
      },
      set: function(value) {
        this.state.blendMode = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Graphics2.prototype, "tint", {
      get: function() {
        return this._tint;
      },
      set: function(value) {
        this._tint = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Graphics2.prototype, "fill", {
      get: function() {
        return this._fillStyle;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Graphics2.prototype, "line", {
      get: function() {
        return this._lineStyle;
      },
      enumerable: false,
      configurable: true
    });
    Graphics2.prototype.lineStyle = function(options) {
      if (options === void 0) {
        options = null;
      }
      if (typeof options === "number") {
        var args = arguments;
        options = {
          width: args[0] || 0,
          color: args[1] || 0,
          alpha: args[2] !== void 0 ? args[2] : 1,
          alignment: args[3] !== void 0 ? args[3] : 0.5,
          native: !!args[4]
        };
      }
      return this.lineTextureStyle(options);
    };
    Graphics2.prototype.lineTextureStyle = function(options) {
      if (typeof options === "number") {
        deprecation("v5.2.0", "Please use object-based options for Graphics#lineTextureStyle");
        var _a2 = arguments, width = _a2[0], texture = _a2[1], color = _a2[2], alpha = _a2[3], matrix = _a2[4], alignment = _a2[5], native = _a2[6];
        options = {width, texture, color, alpha, matrix, alignment, native};
        Object.keys(options).forEach(function(key) {
          return options[key] === void 0 && delete options[key];
        });
      }
      options = Object.assign({
        width: 0,
        texture: Texture.WHITE,
        color: options && options.texture ? 16777215 : 0,
        alpha: 1,
        matrix: null,
        alignment: 0.5,
        native: false,
        cap: LINE_CAP.BUTT,
        join: LINE_JOIN.MITER,
        miterLimit: 10
      }, options);
      if (this.currentPath) {
        this.startPoly();
      }
      var visible = options.width > 0 && options.alpha > 0;
      if (!visible) {
        this._lineStyle.reset();
      } else {
        if (options.matrix) {
          options.matrix = options.matrix.clone();
          options.matrix.invert();
        }
        Object.assign(this._lineStyle, {visible}, options);
      }
      return this;
    };
    Graphics2.prototype.startPoly = function() {
      if (this.currentPath) {
        var points = this.currentPath.points;
        var len = this.currentPath.points.length;
        if (len > 2) {
          this.drawShape(this.currentPath);
          this.currentPath = new Polygon();
          this.currentPath.closeStroke = false;
          this.currentPath.points.push(points[len - 2], points[len - 1]);
        }
      } else {
        this.currentPath = new Polygon();
        this.currentPath.closeStroke = false;
      }
    };
    Graphics2.prototype.finishPoly = function() {
      if (this.currentPath) {
        if (this.currentPath.points.length > 2) {
          this.drawShape(this.currentPath);
          this.currentPath = null;
        } else {
          this.currentPath.points.length = 0;
        }
      }
    };
    Graphics2.prototype.moveTo = function(x, y) {
      this.startPoly();
      this.currentPath.points[0] = x;
      this.currentPath.points[1] = y;
      return this;
    };
    Graphics2.prototype.lineTo = function(x, y) {
      if (!this.currentPath) {
        this.moveTo(0, 0);
      }
      var points = this.currentPath.points;
      var fromX = points[points.length - 2];
      var fromY = points[points.length - 1];
      if (fromX !== x || fromY !== y) {
        points.push(x, y);
      }
      return this;
    };
    Graphics2.prototype._initCurve = function(x, y) {
      if (x === void 0) {
        x = 0;
      }
      if (y === void 0) {
        y = 0;
      }
      if (this.currentPath) {
        if (this.currentPath.points.length === 0) {
          this.currentPath.points = [x, y];
        }
      } else {
        this.moveTo(x, y);
      }
    };
    Graphics2.prototype.quadraticCurveTo = function(cpX, cpY, toX, toY) {
      this._initCurve();
      var points = this.currentPath.points;
      if (points.length === 0) {
        this.moveTo(0, 0);
      }
      QuadraticUtils.curveTo(cpX, cpY, toX, toY, points);
      return this;
    };
    Graphics2.prototype.bezierCurveTo = function(cpX, cpY, cpX2, cpY2, toX, toY) {
      this._initCurve();
      BezierUtils.curveTo(cpX, cpY, cpX2, cpY2, toX, toY, this.currentPath.points);
      return this;
    };
    Graphics2.prototype.arcTo = function(x1, y1, x2, y2, radius) {
      this._initCurve(x1, y1);
      var points = this.currentPath.points;
      var result = ArcUtils.curveTo(x1, y1, x2, y2, radius, points);
      if (result) {
        var cx = result.cx, cy = result.cy, radius_1 = result.radius, startAngle = result.startAngle, endAngle = result.endAngle, anticlockwise = result.anticlockwise;
        this.arc(cx, cy, radius_1, startAngle, endAngle, anticlockwise);
      }
      return this;
    };
    Graphics2.prototype.arc = function(cx, cy, radius, startAngle, endAngle, anticlockwise) {
      if (anticlockwise === void 0) {
        anticlockwise = false;
      }
      if (startAngle === endAngle) {
        return this;
      }
      if (!anticlockwise && endAngle <= startAngle) {
        endAngle += PI_2;
      } else if (anticlockwise && startAngle <= endAngle) {
        startAngle += PI_2;
      }
      var sweep = endAngle - startAngle;
      if (sweep === 0) {
        return this;
      }
      var startX = cx + Math.cos(startAngle) * radius;
      var startY = cy + Math.sin(startAngle) * radius;
      var eps = this._geometry.closePointEps;
      var points = this.currentPath ? this.currentPath.points : null;
      if (points) {
        var xDiff = Math.abs(points[points.length - 2] - startX);
        var yDiff = Math.abs(points[points.length - 1] - startY);
        if (xDiff < eps && yDiff < eps)
          ;
        else {
          points.push(startX, startY);
        }
      } else {
        this.moveTo(startX, startY);
        points = this.currentPath.points;
      }
      ArcUtils.arc(startX, startY, cx, cy, radius, startAngle, endAngle, anticlockwise, points);
      return this;
    };
    Graphics2.prototype.beginFill = function(color, alpha) {
      if (color === void 0) {
        color = 0;
      }
      if (alpha === void 0) {
        alpha = 1;
      }
      return this.beginTextureFill({texture: Texture.WHITE, color, alpha});
    };
    Graphics2.prototype.beginTextureFill = function(options) {
      if (options instanceof Texture) {
        deprecation("v5.2.0", "Please use object-based options for Graphics#beginTextureFill");
        var _a2 = arguments, texture = _a2[0], color = _a2[1], alpha = _a2[2], matrix = _a2[3];
        options = {texture, color, alpha, matrix};
        Object.keys(options).forEach(function(key) {
          return options[key] === void 0 && delete options[key];
        });
      }
      options = Object.assign({
        texture: Texture.WHITE,
        color: 16777215,
        alpha: 1,
        matrix: null
      }, options);
      if (this.currentPath) {
        this.startPoly();
      }
      var visible = options.alpha > 0;
      if (!visible) {
        this._fillStyle.reset();
      } else {
        if (options.matrix) {
          options.matrix = options.matrix.clone();
          options.matrix.invert();
        }
        Object.assign(this._fillStyle, {visible}, options);
      }
      return this;
    };
    Graphics2.prototype.endFill = function() {
      this.finishPoly();
      this._fillStyle.reset();
      return this;
    };
    Graphics2.prototype.drawRect = function(x, y, width, height) {
      return this.drawShape(new Rectangle(x, y, width, height));
    };
    Graphics2.prototype.drawRoundedRect = function(x, y, width, height, radius) {
      return this.drawShape(new RoundedRectangle(x, y, width, height, radius));
    };
    Graphics2.prototype.drawCircle = function(x, y, radius) {
      return this.drawShape(new Circle(x, y, radius));
    };
    Graphics2.prototype.drawEllipse = function(x, y, width, height) {
      return this.drawShape(new Ellipse(x, y, width, height));
    };
    Graphics2.prototype.drawPolygon = function() {
      var arguments$1 = arguments;
      var path = [];
      for (var _i = 0; _i < arguments.length; _i++) {
        path[_i] = arguments$1[_i];
      }
      var points;
      var closeStroke = true;
      var poly = path[0];
      if (poly.points) {
        closeStroke = poly.closeStroke;
        points = poly.points;
      } else if (Array.isArray(path[0])) {
        points = path[0];
      } else {
        points = path;
      }
      var shape = new Polygon(points);
      shape.closeStroke = closeStroke;
      this.drawShape(shape);
      return this;
    };
    Graphics2.prototype.drawShape = function(shape) {
      if (!this._holeMode) {
        this._geometry.drawShape(shape, this._fillStyle.clone(), this._lineStyle.clone(), this._matrix);
      } else {
        this._geometry.drawHole(shape, this._matrix);
      }
      return this;
    };
    Graphics2.prototype.drawStar = function(x, y, points, radius, innerRadius, rotation) {
      if (rotation === void 0) {
        rotation = 0;
      }
      return this.drawPolygon(new Star(x, y, points, radius, innerRadius, rotation));
    };
    Graphics2.prototype.clear = function() {
      this._geometry.clear();
      this._lineStyle.reset();
      this._fillStyle.reset();
      this._boundsID++;
      this._matrix = null;
      this._holeMode = false;
      this.currentPath = null;
      return this;
    };
    Graphics2.prototype.isFastRect = function() {
      var data = this._geometry.graphicsData;
      return data.length === 1 && data[0].shape.type === SHAPES.RECT && !(data[0].lineStyle.visible && data[0].lineStyle.width);
    };
    Graphics2.prototype._render = function(renderer) {
      this.finishPoly();
      var geometry = this._geometry;
      var hasuint32 = renderer.context.supports.uint32Indices;
      geometry.updateBatches(hasuint32);
      if (geometry.batchable) {
        if (this.batchDirty !== geometry.batchDirty) {
          this._populateBatches();
        }
        this._renderBatched(renderer);
      } else {
        renderer.batch.flush();
        this._renderDirect(renderer);
      }
    };
    Graphics2.prototype._populateBatches = function() {
      var geometry = this._geometry;
      var blendMode = this.blendMode;
      var len = geometry.batches.length;
      this.batchTint = -1;
      this._transformID = -1;
      this.batchDirty = geometry.batchDirty;
      this.batches.length = len;
      this.vertexData = new Float32Array(geometry.points);
      for (var i = 0; i < len; i++) {
        var gI = geometry.batches[i];
        var color = gI.style.color;
        var vertexData = new Float32Array(this.vertexData.buffer, gI.attribStart * 4 * 2, gI.attribSize * 2);
        var uvs = new Float32Array(geometry.uvsFloat32.buffer, gI.attribStart * 4 * 2, gI.attribSize * 2);
        var indices2 = new Uint16Array(geometry.indicesUint16.buffer, gI.start * 2, gI.size);
        var batch = {
          vertexData,
          blendMode,
          indices: indices2,
          uvs,
          _batchRGB: hex2rgb(color),
          _tintRGB: color,
          _texture: gI.style.texture,
          alpha: gI.style.alpha,
          worldAlpha: 1
        };
        this.batches[i] = batch;
      }
    };
    Graphics2.prototype._renderBatched = function(renderer) {
      if (!this.batches.length) {
        return;
      }
      renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);
      this.calculateVertices();
      this.calculateTints();
      for (var i = 0, l = this.batches.length; i < l; i++) {
        var batch = this.batches[i];
        batch.worldAlpha = this.worldAlpha * batch.alpha;
        renderer.plugins[this.pluginName].render(batch);
      }
    };
    Graphics2.prototype._renderDirect = function(renderer) {
      var shader = this._resolveDirectShader(renderer);
      var geometry = this._geometry;
      var tint = this.tint;
      var worldAlpha = this.worldAlpha;
      var uniforms = shader.uniforms;
      var drawCalls = geometry.drawCalls;
      uniforms.translationMatrix = this.transform.worldTransform;
      uniforms.tint[0] = (tint >> 16 & 255) / 255 * worldAlpha;
      uniforms.tint[1] = (tint >> 8 & 255) / 255 * worldAlpha;
      uniforms.tint[2] = (tint & 255) / 255 * worldAlpha;
      uniforms.tint[3] = worldAlpha;
      renderer.shader.bind(shader);
      renderer.geometry.bind(geometry, shader);
      renderer.state.set(this.state);
      for (var i = 0, l = drawCalls.length; i < l; i++) {
        this._renderDrawCallDirect(renderer, geometry.drawCalls[i]);
      }
    };
    Graphics2.prototype._renderDrawCallDirect = function(renderer, drawCall) {
      var texArray = drawCall.texArray, type = drawCall.type, size = drawCall.size, start = drawCall.start;
      var groupTextureCount = texArray.count;
      for (var j = 0; j < groupTextureCount; j++) {
        renderer.texture.bind(texArray.elements[j], j);
      }
      renderer.geometry.draw(type, size, start);
    };
    Graphics2.prototype._resolveDirectShader = function(renderer) {
      var shader = this.shader;
      var pluginName = this.pluginName;
      if (!shader) {
        if (!DEFAULT_SHADERS[pluginName]) {
          var MAX_TEXTURES = renderer.plugins.batch.MAX_TEXTURES;
          var sampleValues = new Int32Array(MAX_TEXTURES);
          for (var i = 0; i < MAX_TEXTURES; i++) {
            sampleValues[i] = i;
          }
          var uniforms = {
            tint: new Float32Array([1, 1, 1, 1]),
            translationMatrix: new Matrix(),
            default: UniformGroup.from({uSamplers: sampleValues}, true)
          };
          var program = renderer.plugins[pluginName]._shader.program;
          DEFAULT_SHADERS[pluginName] = new Shader(program, uniforms);
        }
        shader = DEFAULT_SHADERS[pluginName];
      }
      return shader;
    };
    Graphics2.prototype._calculateBounds = function() {
      this.finishPoly();
      var geometry = this._geometry;
      if (!geometry.graphicsData.length) {
        return;
      }
      var _a2 = geometry.bounds, minX = _a2.minX, minY = _a2.minY, maxX = _a2.maxX, maxY = _a2.maxY;
      this._bounds.addFrame(this.transform, minX, minY, maxX, maxY);
    };
    Graphics2.prototype.containsPoint = function(point) {
      this.worldTransform.applyInverse(point, Graphics2._TEMP_POINT);
      return this._geometry.containsPoint(Graphics2._TEMP_POINT);
    };
    Graphics2.prototype.calculateTints = function() {
      if (this.batchTint !== this.tint) {
        this.batchTint = this.tint;
        var tintRGB = hex2rgb(this.tint, temp);
        for (var i = 0; i < this.batches.length; i++) {
          var batch = this.batches[i];
          var batchTint = batch._batchRGB;
          var r = tintRGB[0] * batchTint[0] * 255;
          var g = tintRGB[1] * batchTint[1] * 255;
          var b = tintRGB[2] * batchTint[2] * 255;
          var color = (r << 16) + (g << 8) + (b | 0);
          batch._tintRGB = (color >> 16) + (color & 65280) + ((color & 255) << 16);
        }
      }
    };
    Graphics2.prototype.calculateVertices = function() {
      var wtID = this.transform._worldID;
      if (this._transformID === wtID) {
        return;
      }
      this._transformID = wtID;
      var wt = this.transform.worldTransform;
      var a = wt.a;
      var b = wt.b;
      var c = wt.c;
      var d = wt.d;
      var tx = wt.tx;
      var ty = wt.ty;
      var data = this._geometry.points;
      var vertexData = this.vertexData;
      var count = 0;
      for (var i = 0; i < data.length; i += 2) {
        var x = data[i];
        var y = data[i + 1];
        vertexData[count++] = a * x + c * y + tx;
        vertexData[count++] = d * y + b * x + ty;
      }
    };
    Graphics2.prototype.closePath = function() {
      var currentPath = this.currentPath;
      if (currentPath) {
        currentPath.closeStroke = true;
      }
      return this;
    };
    Graphics2.prototype.setMatrix = function(matrix) {
      this._matrix = matrix;
      return this;
    };
    Graphics2.prototype.beginHole = function() {
      this.finishPoly();
      this._holeMode = true;
      return this;
    };
    Graphics2.prototype.endHole = function() {
      this.finishPoly();
      this._holeMode = false;
      return this;
    };
    Graphics2.prototype.destroy = function(options) {
      this._geometry.refCount--;
      if (this._geometry.refCount === 0) {
        this._geometry.dispose();
      }
      this._matrix = null;
      this.currentPath = null;
      this._lineStyle.destroy();
      this._lineStyle = null;
      this._fillStyle.destroy();
      this._fillStyle = null;
      this._geometry = null;
      this.shader = null;
      this.vertexData = null;
      this.batches.length = 0;
      this.batches = null;
      _super.prototype.destroy.call(this, options);
    };
    Graphics2._TEMP_POINT = new Point();
    return Graphics2;
  }(Container);

  // node_modules/@pixi/sprite/lib/sprite.es.js
  /*!
   * @pixi/sprite - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/sprite is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics7 = function(d, b) {
    extendStatics7 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics7(d, b);
  };
  function __extends7(d, b) {
    extendStatics7(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var tempPoint = new Point();
  var indices = new Uint16Array([0, 1, 2, 0, 2, 3]);
  var Sprite = function(_super) {
    __extends7(Sprite2, _super);
    function Sprite2(texture) {
      var _this = _super.call(this) || this;
      _this._anchor = new ObservablePoint(_this._onAnchorUpdate, _this, texture ? texture.defaultAnchor.x : 0, texture ? texture.defaultAnchor.y : 0);
      _this._texture = null;
      _this._width = 0;
      _this._height = 0;
      _this._tint = null;
      _this._tintRGB = null;
      _this.tint = 16777215;
      _this.blendMode = BLEND_MODES.NORMAL;
      _this._cachedTint = 16777215;
      _this.uvs = null;
      _this.texture = texture || Texture.EMPTY;
      _this.vertexData = new Float32Array(8);
      _this.vertexTrimmedData = null;
      _this._transformID = -1;
      _this._textureID = -1;
      _this._transformTrimmedID = -1;
      _this._textureTrimmedID = -1;
      _this.indices = indices;
      _this.pluginName = "batch";
      _this.isSprite = true;
      _this._roundPixels = settings.ROUND_PIXELS;
      return _this;
    }
    Sprite2.prototype._onTextureUpdate = function() {
      this._textureID = -1;
      this._textureTrimmedID = -1;
      this._cachedTint = 16777215;
      if (this._width) {
        this.scale.x = sign(this.scale.x) * this._width / this._texture.orig.width;
      }
      if (this._height) {
        this.scale.y = sign(this.scale.y) * this._height / this._texture.orig.height;
      }
    };
    Sprite2.prototype._onAnchorUpdate = function() {
      this._transformID = -1;
      this._transformTrimmedID = -1;
    };
    Sprite2.prototype.calculateVertices = function() {
      var texture = this._texture;
      if (this._transformID === this.transform._worldID && this._textureID === texture._updateID) {
        return;
      }
      if (this._textureID !== texture._updateID) {
        this.uvs = this._texture._uvs.uvsFloat32;
      }
      this._transformID = this.transform._worldID;
      this._textureID = texture._updateID;
      var wt = this.transform.worldTransform;
      var a = wt.a;
      var b = wt.b;
      var c = wt.c;
      var d = wt.d;
      var tx = wt.tx;
      var ty = wt.ty;
      var vertexData = this.vertexData;
      var trim = texture.trim;
      var orig = texture.orig;
      var anchor = this._anchor;
      var w0 = 0;
      var w1 = 0;
      var h0 = 0;
      var h1 = 0;
      if (trim) {
        w1 = trim.x - anchor._x * orig.width;
        w0 = w1 + trim.width;
        h1 = trim.y - anchor._y * orig.height;
        h0 = h1 + trim.height;
      } else {
        w1 = -anchor._x * orig.width;
        w0 = w1 + orig.width;
        h1 = -anchor._y * orig.height;
        h0 = h1 + orig.height;
      }
      vertexData[0] = a * w1 + c * h1 + tx;
      vertexData[1] = d * h1 + b * w1 + ty;
      vertexData[2] = a * w0 + c * h1 + tx;
      vertexData[3] = d * h1 + b * w0 + ty;
      vertexData[4] = a * w0 + c * h0 + tx;
      vertexData[5] = d * h0 + b * w0 + ty;
      vertexData[6] = a * w1 + c * h0 + tx;
      vertexData[7] = d * h0 + b * w1 + ty;
      if (this._roundPixels) {
        var resolution = settings.RESOLUTION;
        for (var i = 0; i < vertexData.length; ++i) {
          vertexData[i] = Math.round((vertexData[i] * resolution | 0) / resolution);
        }
      }
    };
    Sprite2.prototype.calculateTrimmedVertices = function() {
      if (!this.vertexTrimmedData) {
        this.vertexTrimmedData = new Float32Array(8);
      } else if (this._transformTrimmedID === this.transform._worldID && this._textureTrimmedID === this._texture._updateID) {
        return;
      }
      this._transformTrimmedID = this.transform._worldID;
      this._textureTrimmedID = this._texture._updateID;
      var texture = this._texture;
      var vertexData = this.vertexTrimmedData;
      var orig = texture.orig;
      var anchor = this._anchor;
      var wt = this.transform.worldTransform;
      var a = wt.a;
      var b = wt.b;
      var c = wt.c;
      var d = wt.d;
      var tx = wt.tx;
      var ty = wt.ty;
      var w1 = -anchor._x * orig.width;
      var w0 = w1 + orig.width;
      var h1 = -anchor._y * orig.height;
      var h0 = h1 + orig.height;
      vertexData[0] = a * w1 + c * h1 + tx;
      vertexData[1] = d * h1 + b * w1 + ty;
      vertexData[2] = a * w0 + c * h1 + tx;
      vertexData[3] = d * h1 + b * w0 + ty;
      vertexData[4] = a * w0 + c * h0 + tx;
      vertexData[5] = d * h0 + b * w0 + ty;
      vertexData[6] = a * w1 + c * h0 + tx;
      vertexData[7] = d * h0 + b * w1 + ty;
    };
    Sprite2.prototype._render = function(renderer) {
      this.calculateVertices();
      renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);
      renderer.plugins[this.pluginName].render(this);
    };
    Sprite2.prototype._calculateBounds = function() {
      var trim = this._texture.trim;
      var orig = this._texture.orig;
      if (!trim || trim.width === orig.width && trim.height === orig.height) {
        this.calculateVertices();
        this._bounds.addQuad(this.vertexData);
      } else {
        this.calculateTrimmedVertices();
        this._bounds.addQuad(this.vertexTrimmedData);
      }
    };
    Sprite2.prototype.getLocalBounds = function(rect) {
      if (this.children.length === 0) {
        this._bounds.minX = this._texture.orig.width * -this._anchor._x;
        this._bounds.minY = this._texture.orig.height * -this._anchor._y;
        this._bounds.maxX = this._texture.orig.width * (1 - this._anchor._x);
        this._bounds.maxY = this._texture.orig.height * (1 - this._anchor._y);
        if (!rect) {
          if (!this._localBoundsRect) {
            this._localBoundsRect = new Rectangle();
          }
          rect = this._localBoundsRect;
        }
        return this._bounds.getRectangle(rect);
      }
      return _super.prototype.getLocalBounds.call(this, rect);
    };
    Sprite2.prototype.containsPoint = function(point) {
      this.worldTransform.applyInverse(point, tempPoint);
      var width = this._texture.orig.width;
      var height = this._texture.orig.height;
      var x1 = -width * this.anchor.x;
      var y1 = 0;
      if (tempPoint.x >= x1 && tempPoint.x < x1 + width) {
        y1 = -height * this.anchor.y;
        if (tempPoint.y >= y1 && tempPoint.y < y1 + height) {
          return true;
        }
      }
      return false;
    };
    Sprite2.prototype.destroy = function(options) {
      _super.prototype.destroy.call(this, options);
      this._texture.off("update", this._onTextureUpdate, this);
      this._anchor = null;
      var destroyTexture = typeof options === "boolean" ? options : options && options.texture;
      if (destroyTexture) {
        var destroyBaseTexture = typeof options === "boolean" ? options : options && options.baseTexture;
        this._texture.destroy(!!destroyBaseTexture);
      }
      this._texture = null;
    };
    Sprite2.from = function(source, options) {
      var texture = source instanceof Texture ? source : Texture.from(source, options);
      return new Sprite2(texture);
    };
    Object.defineProperty(Sprite2.prototype, "roundPixels", {
      get: function() {
        return this._roundPixels;
      },
      set: function(value) {
        if (this._roundPixels !== value) {
          this._transformID = -1;
        }
        this._roundPixels = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Sprite2.prototype, "width", {
      get: function() {
        return Math.abs(this.scale.x) * this._texture.orig.width;
      },
      set: function(value) {
        var s = sign(this.scale.x) || 1;
        this.scale.x = s * value / this._texture.orig.width;
        this._width = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Sprite2.prototype, "height", {
      get: function() {
        return Math.abs(this.scale.y) * this._texture.orig.height;
      },
      set: function(value) {
        var s = sign(this.scale.y) || 1;
        this.scale.y = s * value / this._texture.orig.height;
        this._height = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Sprite2.prototype, "anchor", {
      get: function() {
        return this._anchor;
      },
      set: function(value) {
        this._anchor.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Sprite2.prototype, "tint", {
      get: function() {
        return this._tint;
      },
      set: function(value) {
        this._tint = value;
        this._tintRGB = (value >> 16) + (value & 65280) + ((value & 255) << 16);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Sprite2.prototype, "texture", {
      get: function() {
        return this._texture;
      },
      set: function(value) {
        if (this._texture === value) {
          return;
        }
        if (this._texture) {
          this._texture.off("update", this._onTextureUpdate, this);
        }
        this._texture = value || Texture.EMPTY;
        this._cachedTint = 16777215;
        this._textureID = -1;
        this._textureTrimmedID = -1;
        if (value) {
          if (value.baseTexture.valid) {
            this._onTextureUpdate();
          } else {
            value.once("update", this._onTextureUpdate, this);
          }
        }
      },
      enumerable: false,
      configurable: true
    });
    return Sprite2;
  }(Container);

  // node_modules/@pixi/text/lib/text.es.js
  /*!
   * @pixi/text - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/text is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics8 = function(d, b) {
    extendStatics8 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics8(d, b);
  };
  function __extends8(d, b) {
    extendStatics8(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var TEXT_GRADIENT;
  (function(TEXT_GRADIENT2) {
    TEXT_GRADIENT2[TEXT_GRADIENT2["LINEAR_VERTICAL"] = 0] = "LINEAR_VERTICAL";
    TEXT_GRADIENT2[TEXT_GRADIENT2["LINEAR_HORIZONTAL"] = 1] = "LINEAR_HORIZONTAL";
  })(TEXT_GRADIENT || (TEXT_GRADIENT = {}));
  var defaultStyle = {
    align: "left",
    breakWords: false,
    dropShadow: false,
    dropShadowAlpha: 1,
    dropShadowAngle: Math.PI / 6,
    dropShadowBlur: 0,
    dropShadowColor: "black",
    dropShadowDistance: 5,
    fill: "black",
    fillGradientType: TEXT_GRADIENT.LINEAR_VERTICAL,
    fillGradientStops: [],
    fontFamily: "Arial",
    fontSize: 26,
    fontStyle: "normal",
    fontVariant: "normal",
    fontWeight: "normal",
    letterSpacing: 0,
    lineHeight: 0,
    lineJoin: "miter",
    miterLimit: 10,
    padding: 0,
    stroke: "black",
    strokeThickness: 0,
    textBaseline: "alphabetic",
    trim: false,
    whiteSpace: "pre",
    wordWrap: false,
    wordWrapWidth: 100,
    leading: 0
  };
  var genericFontFamilies = [
    "serif",
    "sans-serif",
    "monospace",
    "cursive",
    "fantasy",
    "system-ui"
  ];
  var TextStyle = function() {
    function TextStyle2(style) {
      this.styleID = 0;
      this.reset();
      deepCopyProperties(this, style, style);
    }
    TextStyle2.prototype.clone = function() {
      var clonedProperties = {};
      deepCopyProperties(clonedProperties, this, defaultStyle);
      return new TextStyle2(clonedProperties);
    };
    TextStyle2.prototype.reset = function() {
      deepCopyProperties(this, defaultStyle, defaultStyle);
    };
    Object.defineProperty(TextStyle2.prototype, "align", {
      get: function() {
        return this._align;
      },
      set: function(align) {
        if (this._align !== align) {
          this._align = align;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "breakWords", {
      get: function() {
        return this._breakWords;
      },
      set: function(breakWords) {
        if (this._breakWords !== breakWords) {
          this._breakWords = breakWords;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadow", {
      get: function() {
        return this._dropShadow;
      },
      set: function(dropShadow) {
        if (this._dropShadow !== dropShadow) {
          this._dropShadow = dropShadow;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadowAlpha", {
      get: function() {
        return this._dropShadowAlpha;
      },
      set: function(dropShadowAlpha) {
        if (this._dropShadowAlpha !== dropShadowAlpha) {
          this._dropShadowAlpha = dropShadowAlpha;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadowAngle", {
      get: function() {
        return this._dropShadowAngle;
      },
      set: function(dropShadowAngle) {
        if (this._dropShadowAngle !== dropShadowAngle) {
          this._dropShadowAngle = dropShadowAngle;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadowBlur", {
      get: function() {
        return this._dropShadowBlur;
      },
      set: function(dropShadowBlur) {
        if (this._dropShadowBlur !== dropShadowBlur) {
          this._dropShadowBlur = dropShadowBlur;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadowColor", {
      get: function() {
        return this._dropShadowColor;
      },
      set: function(dropShadowColor) {
        var outputColor = getColor(dropShadowColor);
        if (this._dropShadowColor !== outputColor) {
          this._dropShadowColor = outputColor;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "dropShadowDistance", {
      get: function() {
        return this._dropShadowDistance;
      },
      set: function(dropShadowDistance) {
        if (this._dropShadowDistance !== dropShadowDistance) {
          this._dropShadowDistance = dropShadowDistance;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fill", {
      get: function() {
        return this._fill;
      },
      set: function(fill) {
        var outputColor = getColor(fill);
        if (this._fill !== outputColor) {
          this._fill = outputColor;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fillGradientType", {
      get: function() {
        return this._fillGradientType;
      },
      set: function(fillGradientType) {
        if (this._fillGradientType !== fillGradientType) {
          this._fillGradientType = fillGradientType;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fillGradientStops", {
      get: function() {
        return this._fillGradientStops;
      },
      set: function(fillGradientStops) {
        if (!areArraysEqual(this._fillGradientStops, fillGradientStops)) {
          this._fillGradientStops = fillGradientStops;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fontFamily", {
      get: function() {
        return this._fontFamily;
      },
      set: function(fontFamily) {
        if (this.fontFamily !== fontFamily) {
          this._fontFamily = fontFamily;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fontSize", {
      get: function() {
        return this._fontSize;
      },
      set: function(fontSize) {
        if (this._fontSize !== fontSize) {
          this._fontSize = fontSize;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fontStyle", {
      get: function() {
        return this._fontStyle;
      },
      set: function(fontStyle) {
        if (this._fontStyle !== fontStyle) {
          this._fontStyle = fontStyle;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fontVariant", {
      get: function() {
        return this._fontVariant;
      },
      set: function(fontVariant) {
        if (this._fontVariant !== fontVariant) {
          this._fontVariant = fontVariant;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "fontWeight", {
      get: function() {
        return this._fontWeight;
      },
      set: function(fontWeight) {
        if (this._fontWeight !== fontWeight) {
          this._fontWeight = fontWeight;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "letterSpacing", {
      get: function() {
        return this._letterSpacing;
      },
      set: function(letterSpacing) {
        if (this._letterSpacing !== letterSpacing) {
          this._letterSpacing = letterSpacing;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "lineHeight", {
      get: function() {
        return this._lineHeight;
      },
      set: function(lineHeight) {
        if (this._lineHeight !== lineHeight) {
          this._lineHeight = lineHeight;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "leading", {
      get: function() {
        return this._leading;
      },
      set: function(leading) {
        if (this._leading !== leading) {
          this._leading = leading;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "lineJoin", {
      get: function() {
        return this._lineJoin;
      },
      set: function(lineJoin) {
        if (this._lineJoin !== lineJoin) {
          this._lineJoin = lineJoin;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "miterLimit", {
      get: function() {
        return this._miterLimit;
      },
      set: function(miterLimit) {
        if (this._miterLimit !== miterLimit) {
          this._miterLimit = miterLimit;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "padding", {
      get: function() {
        return this._padding;
      },
      set: function(padding) {
        if (this._padding !== padding) {
          this._padding = padding;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "stroke", {
      get: function() {
        return this._stroke;
      },
      set: function(stroke) {
        var outputColor = getColor(stroke);
        if (this._stroke !== outputColor) {
          this._stroke = outputColor;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "strokeThickness", {
      get: function() {
        return this._strokeThickness;
      },
      set: function(strokeThickness) {
        if (this._strokeThickness !== strokeThickness) {
          this._strokeThickness = strokeThickness;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "textBaseline", {
      get: function() {
        return this._textBaseline;
      },
      set: function(textBaseline) {
        if (this._textBaseline !== textBaseline) {
          this._textBaseline = textBaseline;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "trim", {
      get: function() {
        return this._trim;
      },
      set: function(trim) {
        if (this._trim !== trim) {
          this._trim = trim;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "whiteSpace", {
      get: function() {
        return this._whiteSpace;
      },
      set: function(whiteSpace) {
        if (this._whiteSpace !== whiteSpace) {
          this._whiteSpace = whiteSpace;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "wordWrap", {
      get: function() {
        return this._wordWrap;
      },
      set: function(wordWrap) {
        if (this._wordWrap !== wordWrap) {
          this._wordWrap = wordWrap;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TextStyle2.prototype, "wordWrapWidth", {
      get: function() {
        return this._wordWrapWidth;
      },
      set: function(wordWrapWidth) {
        if (this._wordWrapWidth !== wordWrapWidth) {
          this._wordWrapWidth = wordWrapWidth;
          this.styleID++;
        }
      },
      enumerable: false,
      configurable: true
    });
    TextStyle2.prototype.toFontString = function() {
      var fontSizeString = typeof this.fontSize === "number" ? this.fontSize + "px" : this.fontSize;
      var fontFamilies = this.fontFamily;
      if (!Array.isArray(this.fontFamily)) {
        fontFamilies = this.fontFamily.split(",");
      }
      for (var i = fontFamilies.length - 1; i >= 0; i--) {
        var fontFamily = fontFamilies[i].trim();
        if (!/([\"\'])[^\'\"]+\1/.test(fontFamily) && genericFontFamilies.indexOf(fontFamily) < 0) {
          fontFamily = '"' + fontFamily + '"';
        }
        fontFamilies[i] = fontFamily;
      }
      return this.fontStyle + " " + this.fontVariant + " " + this.fontWeight + " " + fontSizeString + " " + fontFamilies.join(",");
    };
    return TextStyle2;
  }();
  function getSingleColor(color) {
    if (typeof color === "number") {
      return hex2string(color);
    } else if (typeof color === "string") {
      if (color.indexOf("0x") === 0) {
        color = color.replace("0x", "#");
      }
    }
    return color;
  }
  function getColor(color) {
    if (!Array.isArray(color)) {
      return getSingleColor(color);
    } else {
      for (var i = 0; i < color.length; ++i) {
        color[i] = getSingleColor(color[i]);
      }
      return color;
    }
  }
  function areArraysEqual(array1, array2) {
    if (!Array.isArray(array1) || !Array.isArray(array2)) {
      return false;
    }
    if (array1.length !== array2.length) {
      return false;
    }
    for (var i = 0; i < array1.length; ++i) {
      if (array1[i] !== array2[i]) {
        return false;
      }
    }
    return true;
  }
  function deepCopyProperties(target, source, propertyObj) {
    for (var prop in propertyObj) {
      if (Array.isArray(source[prop])) {
        target[prop] = source[prop].slice();
      } else {
        target[prop] = source[prop];
      }
    }
  }
  var TextMetrics = function() {
    function TextMetrics2(text, style, width, height, lines, lineWidths, lineHeight, maxLineWidth, fontProperties) {
      this.text = text;
      this.style = style;
      this.width = width;
      this.height = height;
      this.lines = lines;
      this.lineWidths = lineWidths;
      this.lineHeight = lineHeight;
      this.maxLineWidth = maxLineWidth;
      this.fontProperties = fontProperties;
    }
    TextMetrics2.measureText = function(text, style, wordWrap, canvas2) {
      if (canvas2 === void 0) {
        canvas2 = TextMetrics2._canvas;
      }
      wordWrap = wordWrap === void 0 || wordWrap === null ? style.wordWrap : wordWrap;
      var font = style.toFontString();
      var fontProperties = TextMetrics2.measureFont(font);
      if (fontProperties.fontSize === 0) {
        fontProperties.fontSize = style.fontSize;
        fontProperties.ascent = style.fontSize;
      }
      var context2 = canvas2.getContext("2d");
      context2.font = font;
      var outputText = wordWrap ? TextMetrics2.wordWrap(text, style, canvas2) : text;
      var lines = outputText.split(/(?:\r\n|\r|\n)/);
      var lineWidths = new Array(lines.length);
      var maxLineWidth = 0;
      for (var i = 0; i < lines.length; i++) {
        var lineWidth = context2.measureText(lines[i]).width + (lines[i].length - 1) * style.letterSpacing;
        lineWidths[i] = lineWidth;
        maxLineWidth = Math.max(maxLineWidth, lineWidth);
      }
      var width = maxLineWidth + style.strokeThickness;
      if (style.dropShadow) {
        width += style.dropShadowDistance;
      }
      var lineHeight = style.lineHeight || fontProperties.fontSize + style.strokeThickness;
      var height = Math.max(lineHeight, fontProperties.fontSize + style.strokeThickness) + (lines.length - 1) * (lineHeight + style.leading);
      if (style.dropShadow) {
        height += style.dropShadowDistance;
      }
      return new TextMetrics2(text, style, width, height, lines, lineWidths, lineHeight + style.leading, maxLineWidth, fontProperties);
    };
    TextMetrics2.wordWrap = function(text, style, canvas2) {
      if (canvas2 === void 0) {
        canvas2 = TextMetrics2._canvas;
      }
      var context2 = canvas2.getContext("2d");
      var width = 0;
      var line = "";
      var lines = "";
      var cache2 = Object.create(null);
      var letterSpacing = style.letterSpacing, whiteSpace = style.whiteSpace;
      var collapseSpaces = TextMetrics2.collapseSpaces(whiteSpace);
      var collapseNewlines = TextMetrics2.collapseNewlines(whiteSpace);
      var canPrependSpaces = !collapseSpaces;
      var wordWrapWidth = style.wordWrapWidth + letterSpacing;
      var tokens = TextMetrics2.tokenize(text);
      for (var i = 0; i < tokens.length; i++) {
        var token = tokens[i];
        if (TextMetrics2.isNewline(token)) {
          if (!collapseNewlines) {
            lines += TextMetrics2.addLine(line);
            canPrependSpaces = !collapseSpaces;
            line = "";
            width = 0;
            continue;
          }
          token = " ";
        }
        if (collapseSpaces) {
          var currIsBreakingSpace = TextMetrics2.isBreakingSpace(token);
          var lastIsBreakingSpace = TextMetrics2.isBreakingSpace(line[line.length - 1]);
          if (currIsBreakingSpace && lastIsBreakingSpace) {
            continue;
          }
        }
        var tokenWidth = TextMetrics2.getFromCache(token, letterSpacing, cache2, context2);
        if (tokenWidth > wordWrapWidth) {
          if (line !== "") {
            lines += TextMetrics2.addLine(line);
            line = "";
            width = 0;
          }
          if (TextMetrics2.canBreakWords(token, style.breakWords)) {
            var characters = TextMetrics2.wordWrapSplit(token);
            for (var j = 0; j < characters.length; j++) {
              var char = characters[j];
              var k = 1;
              while (characters[j + k]) {
                var nextChar = characters[j + k];
                var lastChar = char[char.length - 1];
                if (!TextMetrics2.canBreakChars(lastChar, nextChar, token, j, style.breakWords)) {
                  char += nextChar;
                } else {
                  break;
                }
                k++;
              }
              j += char.length - 1;
              var characterWidth = TextMetrics2.getFromCache(char, letterSpacing, cache2, context2);
              if (characterWidth + width > wordWrapWidth) {
                lines += TextMetrics2.addLine(line);
                canPrependSpaces = false;
                line = "";
                width = 0;
              }
              line += char;
              width += characterWidth;
            }
          } else {
            if (line.length > 0) {
              lines += TextMetrics2.addLine(line);
              line = "";
              width = 0;
            }
            var isLastToken = i === tokens.length - 1;
            lines += TextMetrics2.addLine(token, !isLastToken);
            canPrependSpaces = false;
            line = "";
            width = 0;
          }
        } else {
          if (tokenWidth + width > wordWrapWidth) {
            canPrependSpaces = false;
            lines += TextMetrics2.addLine(line);
            line = "";
            width = 0;
          }
          if (line.length > 0 || !TextMetrics2.isBreakingSpace(token) || canPrependSpaces) {
            line += token;
            width += tokenWidth;
          }
        }
      }
      lines += TextMetrics2.addLine(line, false);
      return lines;
    };
    TextMetrics2.addLine = function(line, newLine) {
      if (newLine === void 0) {
        newLine = true;
      }
      line = TextMetrics2.trimRight(line);
      line = newLine ? line + "\n" : line;
      return line;
    };
    TextMetrics2.getFromCache = function(key, letterSpacing, cache2, context2) {
      var width = cache2[key];
      if (typeof width !== "number") {
        var spacing = key.length * letterSpacing;
        width = context2.measureText(key).width + spacing;
        cache2[key] = width;
      }
      return width;
    };
    TextMetrics2.collapseSpaces = function(whiteSpace) {
      return whiteSpace === "normal" || whiteSpace === "pre-line";
    };
    TextMetrics2.collapseNewlines = function(whiteSpace) {
      return whiteSpace === "normal";
    };
    TextMetrics2.trimRight = function(text) {
      if (typeof text !== "string") {
        return "";
      }
      for (var i = text.length - 1; i >= 0; i--) {
        var char = text[i];
        if (!TextMetrics2.isBreakingSpace(char)) {
          break;
        }
        text = text.slice(0, -1);
      }
      return text;
    };
    TextMetrics2.isNewline = function(char) {
      if (typeof char !== "string") {
        return false;
      }
      return TextMetrics2._newlines.indexOf(char.charCodeAt(0)) >= 0;
    };
    TextMetrics2.isBreakingSpace = function(char) {
      if (typeof char !== "string") {
        return false;
      }
      return TextMetrics2._breakingSpaces.indexOf(char.charCodeAt(0)) >= 0;
    };
    TextMetrics2.tokenize = function(text) {
      var tokens = [];
      var token = "";
      if (typeof text !== "string") {
        return tokens;
      }
      for (var i = 0; i < text.length; i++) {
        var char = text[i];
        if (TextMetrics2.isBreakingSpace(char) || TextMetrics2.isNewline(char)) {
          if (token !== "") {
            tokens.push(token);
            token = "";
          }
          tokens.push(char);
          continue;
        }
        token += char;
      }
      if (token !== "") {
        tokens.push(token);
      }
      return tokens;
    };
    TextMetrics2.canBreakWords = function(_token, breakWords) {
      return breakWords;
    };
    TextMetrics2.canBreakChars = function(_char, _nextChar, _token, _index, _breakWords) {
      return true;
    };
    TextMetrics2.wordWrapSplit = function(token) {
      return token.split("");
    };
    TextMetrics2.measureFont = function(font) {
      if (TextMetrics2._fonts[font]) {
        return TextMetrics2._fonts[font];
      }
      var properties = {
        ascent: 0,
        descent: 0,
        fontSize: 0
      };
      var canvas2 = TextMetrics2._canvas;
      var context2 = TextMetrics2._context;
      context2.font = font;
      var metricsString = TextMetrics2.METRICS_STRING + TextMetrics2.BASELINE_SYMBOL;
      var width = Math.ceil(context2.measureText(metricsString).width);
      var baseline = Math.ceil(context2.measureText(TextMetrics2.BASELINE_SYMBOL).width);
      var height = 2 * baseline;
      baseline = baseline * TextMetrics2.BASELINE_MULTIPLIER | 0;
      canvas2.width = width;
      canvas2.height = height;
      context2.fillStyle = "#f00";
      context2.fillRect(0, 0, width, height);
      context2.font = font;
      context2.textBaseline = "alphabetic";
      context2.fillStyle = "#000";
      context2.fillText(metricsString, 0, baseline);
      var imagedata = context2.getImageData(0, 0, width, height).data;
      var pixels = imagedata.length;
      var line = width * 4;
      var i = 0;
      var idx = 0;
      var stop = false;
      for (i = 0; i < baseline; ++i) {
        for (var j = 0; j < line; j += 4) {
          if (imagedata[idx + j] !== 255) {
            stop = true;
            break;
          }
        }
        if (!stop) {
          idx += line;
        } else {
          break;
        }
      }
      properties.ascent = baseline - i;
      idx = pixels - line;
      stop = false;
      for (i = height; i > baseline; --i) {
        for (var j = 0; j < line; j += 4) {
          if (imagedata[idx + j] !== 255) {
            stop = true;
            break;
          }
        }
        if (!stop) {
          idx -= line;
        } else {
          break;
        }
      }
      properties.descent = i - baseline;
      properties.fontSize = properties.ascent + properties.descent;
      TextMetrics2._fonts[font] = properties;
      return properties;
    };
    TextMetrics2.clearMetrics = function(font) {
      if (font === void 0) {
        font = "";
      }
      if (font) {
        delete TextMetrics2._fonts[font];
      } else {
        TextMetrics2._fonts = {};
      }
    };
    return TextMetrics2;
  }();
  var canvas = function() {
    try {
      var c = new OffscreenCanvas(0, 0);
      var context2 = c.getContext("2d");
      if (context2 && context2.measureText) {
        return c;
      }
      return document.createElement("canvas");
    } catch (ex) {
      return document.createElement("canvas");
    }
  }();
  canvas.width = canvas.height = 10;
  TextMetrics._canvas = canvas;
  TextMetrics._context = canvas.getContext("2d");
  TextMetrics._fonts = {};
  TextMetrics.METRICS_STRING = "|\xC9q\xC5";
  TextMetrics.BASELINE_SYMBOL = "M";
  TextMetrics.BASELINE_MULTIPLIER = 1.4;
  TextMetrics._newlines = [
    10,
    13
  ];
  TextMetrics._breakingSpaces = [
    9,
    32,
    8192,
    8193,
    8194,
    8195,
    8196,
    8197,
    8198,
    8200,
    8201,
    8202,
    8287,
    12288
  ];
  var defaultDestroyOptions = {
    texture: true,
    children: false,
    baseTexture: true
  };
  var Text = function(_super) {
    __extends8(Text2, _super);
    function Text2(text, style, canvas2) {
      var _this = this;
      var ownCanvas = false;
      if (!canvas2) {
        canvas2 = document.createElement("canvas");
        ownCanvas = true;
      }
      canvas2.width = 3;
      canvas2.height = 3;
      var texture = Texture.from(canvas2);
      texture.orig = new Rectangle();
      texture.trim = new Rectangle();
      _this = _super.call(this, texture) || this;
      _this._ownCanvas = ownCanvas;
      _this.canvas = canvas2;
      _this.context = _this.canvas.getContext("2d");
      _this._resolution = settings.RESOLUTION;
      _this._autoResolution = true;
      _this._text = null;
      _this._style = null;
      _this._styleListener = null;
      _this._font = "";
      _this.text = text;
      _this.style = style;
      _this.localStyleID = -1;
      return _this;
    }
    Text2.prototype.updateText = function(respectDirty) {
      var style = this._style;
      if (this.localStyleID !== style.styleID) {
        this.dirty = true;
        this.localStyleID = style.styleID;
      }
      if (!this.dirty && respectDirty) {
        return;
      }
      this._font = this._style.toFontString();
      var context2 = this.context;
      var measured = TextMetrics.measureText(this._text || " ", this._style, this._style.wordWrap, this.canvas);
      var width = measured.width;
      var height = measured.height;
      var lines = measured.lines;
      var lineHeight = measured.lineHeight;
      var lineWidths = measured.lineWidths;
      var maxLineWidth = measured.maxLineWidth;
      var fontProperties = measured.fontProperties;
      this.canvas.width = Math.ceil((Math.max(1, width) + style.padding * 2) * this._resolution);
      this.canvas.height = Math.ceil((Math.max(1, height) + style.padding * 2) * this._resolution);
      context2.scale(this._resolution, this._resolution);
      context2.clearRect(0, 0, this.canvas.width, this.canvas.height);
      context2.font = this._font;
      context2.lineWidth = style.strokeThickness;
      context2.textBaseline = style.textBaseline;
      context2.lineJoin = style.lineJoin;
      context2.miterLimit = style.miterLimit;
      var linePositionX;
      var linePositionY;
      var passesCount = style.dropShadow ? 2 : 1;
      for (var i = 0; i < passesCount; ++i) {
        var isShadowPass = style.dropShadow && i === 0;
        var dsOffsetText = isShadowPass ? Math.ceil(Math.max(1, height) + style.padding * 2) : 0;
        var dsOffsetShadow = dsOffsetText * this._resolution;
        if (isShadowPass) {
          context2.fillStyle = "black";
          context2.strokeStyle = "black";
          var dropShadowColor = style.dropShadowColor;
          var rgb = hex2rgb(typeof dropShadowColor === "number" ? dropShadowColor : string2hex(dropShadowColor));
          context2.shadowColor = "rgba(" + rgb[0] * 255 + "," + rgb[1] * 255 + "," + rgb[2] * 255 + "," + style.dropShadowAlpha + ")";
          context2.shadowBlur = style.dropShadowBlur;
          context2.shadowOffsetX = Math.cos(style.dropShadowAngle) * style.dropShadowDistance;
          context2.shadowOffsetY = Math.sin(style.dropShadowAngle) * style.dropShadowDistance + dsOffsetShadow;
        } else {
          context2.fillStyle = this._generateFillStyle(style, lines, measured);
          context2.strokeStyle = style.stroke;
          context2.shadowColor = "black";
          context2.shadowBlur = 0;
          context2.shadowOffsetX = 0;
          context2.shadowOffsetY = 0;
        }
        for (var i_1 = 0; i_1 < lines.length; i_1++) {
          linePositionX = style.strokeThickness / 2;
          linePositionY = style.strokeThickness / 2 + i_1 * lineHeight + fontProperties.ascent;
          if (style.align === "right") {
            linePositionX += maxLineWidth - lineWidths[i_1];
          } else if (style.align === "center") {
            linePositionX += (maxLineWidth - lineWidths[i_1]) / 2;
          }
          if (style.stroke && style.strokeThickness) {
            this.drawLetterSpacing(lines[i_1], linePositionX + style.padding, linePositionY + style.padding - dsOffsetText, true);
          }
          if (style.fill) {
            this.drawLetterSpacing(lines[i_1], linePositionX + style.padding, linePositionY + style.padding - dsOffsetText);
          }
        }
      }
      this.updateTexture();
    };
    Text2.prototype.drawLetterSpacing = function(text, x, y, isStroke) {
      if (isStroke === void 0) {
        isStroke = false;
      }
      var style = this._style;
      var letterSpacing = style.letterSpacing;
      if (letterSpacing === 0) {
        if (isStroke) {
          this.context.strokeText(text, x, y);
        } else {
          this.context.fillText(text, x, y);
        }
        return;
      }
      var currentPosition = x;
      var stringArray = Array.from ? Array.from(text) : text.split("");
      var previousWidth = this.context.measureText(text).width;
      var currentWidth = 0;
      for (var i = 0; i < stringArray.length; ++i) {
        var currentChar = stringArray[i];
        if (isStroke) {
          this.context.strokeText(currentChar, currentPosition, y);
        } else {
          this.context.fillText(currentChar, currentPosition, y);
        }
        currentWidth = this.context.measureText(text.substring(i + 1)).width;
        currentPosition += previousWidth - currentWidth + letterSpacing;
        previousWidth = currentWidth;
      }
    };
    Text2.prototype.updateTexture = function() {
      var canvas2 = this.canvas;
      if (this._style.trim) {
        var trimmed = trimCanvas(canvas2);
        if (trimmed.data) {
          canvas2.width = trimmed.width;
          canvas2.height = trimmed.height;
          this.context.putImageData(trimmed.data, 0, 0);
        }
      }
      var texture = this._texture;
      var style = this._style;
      var padding = style.trim ? 0 : style.padding;
      var baseTexture = texture.baseTexture;
      texture.trim.width = texture._frame.width = Math.ceil(canvas2.width / this._resolution);
      texture.trim.height = texture._frame.height = Math.ceil(canvas2.height / this._resolution);
      texture.trim.x = -padding;
      texture.trim.y = -padding;
      texture.orig.width = texture._frame.width - padding * 2;
      texture.orig.height = texture._frame.height - padding * 2;
      this._onTextureUpdate();
      baseTexture.setRealSize(canvas2.width, canvas2.height, this._resolution);
      this._recursivePostUpdateTransform();
      this.dirty = false;
    };
    Text2.prototype._render = function(renderer) {
      if (this._autoResolution && this._resolution !== renderer.resolution) {
        this._resolution = renderer.resolution;
        this.dirty = true;
      }
      this.updateText(true);
      _super.prototype._render.call(this, renderer);
    };
    Text2.prototype.getLocalBounds = function(rect) {
      this.updateText(true);
      return _super.prototype.getLocalBounds.call(this, rect);
    };
    Text2.prototype._calculateBounds = function() {
      this.updateText(true);
      this.calculateVertices();
      this._bounds.addQuad(this.vertexData);
    };
    Text2.prototype._generateFillStyle = function(style, lines, metrics) {
      var fillStyle = style.fill;
      if (!Array.isArray(fillStyle)) {
        return fillStyle;
      } else if (fillStyle.length === 1) {
        return fillStyle[0];
      }
      var gradient;
      var dropShadowCorrection = style.dropShadow ? style.dropShadowDistance : 0;
      var padding = style.padding || 0;
      var width = Math.ceil(this.canvas.width / this._resolution) - dropShadowCorrection - padding * 2;
      var height = Math.ceil(this.canvas.height / this._resolution) - dropShadowCorrection - padding * 2;
      var fill = fillStyle.slice();
      var fillGradientStops = style.fillGradientStops.slice();
      if (!fillGradientStops.length) {
        var lengthPlus1 = fill.length + 1;
        for (var i = 1; i < lengthPlus1; ++i) {
          fillGradientStops.push(i / lengthPlus1);
        }
      }
      fill.unshift(fillStyle[0]);
      fillGradientStops.unshift(0);
      fill.push(fillStyle[fillStyle.length - 1]);
      fillGradientStops.push(1);
      if (style.fillGradientType === TEXT_GRADIENT.LINEAR_VERTICAL) {
        gradient = this.context.createLinearGradient(width / 2, padding, width / 2, height + padding);
        var lastIterationStop = 0;
        var textHeight = metrics.fontProperties.fontSize + style.strokeThickness;
        var gradStopLineHeight = textHeight / height;
        for (var i = 0; i < lines.length; i++) {
          var thisLineTop = metrics.lineHeight * i;
          for (var j = 0; j < fill.length; j++) {
            var lineStop = 0;
            if (typeof fillGradientStops[j] === "number") {
              lineStop = fillGradientStops[j];
            } else {
              lineStop = j / fill.length;
            }
            var globalStop = thisLineTop / height + lineStop * gradStopLineHeight;
            var clampedStop = Math.max(lastIterationStop, globalStop);
            clampedStop = Math.min(clampedStop, 1);
            gradient.addColorStop(clampedStop, fill[j]);
            lastIterationStop = clampedStop;
          }
        }
      } else {
        gradient = this.context.createLinearGradient(padding, height / 2, width + padding, height / 2);
        var totalIterations = fill.length + 1;
        var currentIteration = 1;
        for (var i = 0; i < fill.length; i++) {
          var stop = void 0;
          if (typeof fillGradientStops[i] === "number") {
            stop = fillGradientStops[i];
          } else {
            stop = currentIteration / totalIterations;
          }
          gradient.addColorStop(stop, fill[i]);
          currentIteration++;
        }
      }
      return gradient;
    };
    Text2.prototype.destroy = function(options) {
      if (typeof options === "boolean") {
        options = {children: options};
      }
      options = Object.assign({}, defaultDestroyOptions, options);
      _super.prototype.destroy.call(this, options);
      if (this._ownCanvas) {
        this.canvas.height = this.canvas.width = 0;
      }
      this.context = null;
      this.canvas = null;
      this._style = null;
    };
    Object.defineProperty(Text2.prototype, "width", {
      get: function() {
        this.updateText(true);
        return Math.abs(this.scale.x) * this._texture.orig.width;
      },
      set: function(value) {
        this.updateText(true);
        var s = sign(this.scale.x) || 1;
        this.scale.x = s * value / this._texture.orig.width;
        this._width = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Text2.prototype, "height", {
      get: function() {
        this.updateText(true);
        return Math.abs(this.scale.y) * this._texture.orig.height;
      },
      set: function(value) {
        this.updateText(true);
        var s = sign(this.scale.y) || 1;
        this.scale.y = s * value / this._texture.orig.height;
        this._height = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Text2.prototype, "style", {
      get: function() {
        return this._style;
      },
      set: function(style) {
        style = style || {};
        if (style instanceof TextStyle) {
          this._style = style;
        } else {
          this._style = new TextStyle(style);
        }
        this.localStyleID = -1;
        this.dirty = true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Text2.prototype, "text", {
      get: function() {
        return this._text;
      },
      set: function(text) {
        text = String(text === null || text === void 0 ? "" : text);
        if (this._text === text) {
          return;
        }
        this._text = text;
        this.dirty = true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Text2.prototype, "resolution", {
      get: function() {
        return this._resolution;
      },
      set: function(value) {
        this._autoResolution = false;
        if (this._resolution === value) {
          return;
        }
        this._resolution = value;
        this.dirty = true;
      },
      enumerable: false,
      configurable: true
    });
    return Text2;
  }(Sprite);

  // node_modules/@pixi/prepare/lib/prepare.es.js
  /*!
   * @pixi/prepare - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/prepare is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  settings.UPLOADS_PER_FRAME = 4;
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics9 = function(d, b) {
    extendStatics9 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics9(d, b);
  };
  function __extends9(d, b) {
    extendStatics9(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var CountLimiter = function() {
    function CountLimiter2(maxItemsPerFrame) {
      this.maxItemsPerFrame = maxItemsPerFrame;
      this.itemsLeft = 0;
    }
    CountLimiter2.prototype.beginFrame = function() {
      this.itemsLeft = this.maxItemsPerFrame;
    };
    CountLimiter2.prototype.allowedToUpload = function() {
      return this.itemsLeft-- > 0;
    };
    return CountLimiter2;
  }();
  function findMultipleBaseTextures(item, queue2) {
    var result = false;
    if (item && item._textures && item._textures.length) {
      for (var i = 0; i < item._textures.length; i++) {
        if (item._textures[i] instanceof Texture) {
          var baseTexture = item._textures[i].baseTexture;
          if (queue2.indexOf(baseTexture) === -1) {
            queue2.push(baseTexture);
            result = true;
          }
        }
      }
    }
    return result;
  }
  function findBaseTexture(item, queue2) {
    if (item.baseTexture instanceof BaseTexture) {
      var texture = item.baseTexture;
      if (queue2.indexOf(texture) === -1) {
        queue2.push(texture);
      }
      return true;
    }
    return false;
  }
  function findTexture(item, queue2) {
    if (item._texture && item._texture instanceof Texture) {
      var texture = item._texture.baseTexture;
      if (queue2.indexOf(texture) === -1) {
        queue2.push(texture);
      }
      return true;
    }
    return false;
  }
  function drawText(_helper, item) {
    if (item instanceof Text) {
      item.updateText(true);
      return true;
    }
    return false;
  }
  function calculateTextStyle(_helper, item) {
    if (item instanceof TextStyle) {
      var font = item.toFontString();
      TextMetrics.measureFont(font);
      return true;
    }
    return false;
  }
  function findText(item, queue2) {
    if (item instanceof Text) {
      if (queue2.indexOf(item.style) === -1) {
        queue2.push(item.style);
      }
      if (queue2.indexOf(item) === -1) {
        queue2.push(item);
      }
      var texture = item._texture.baseTexture;
      if (queue2.indexOf(texture) === -1) {
        queue2.push(texture);
      }
      return true;
    }
    return false;
  }
  function findTextStyle(item, queue2) {
    if (item instanceof TextStyle) {
      if (queue2.indexOf(item) === -1) {
        queue2.push(item);
      }
      return true;
    }
    return false;
  }
  var BasePrepare = function() {
    function BasePrepare2(renderer) {
      var _this = this;
      this.limiter = new CountLimiter(settings.UPLOADS_PER_FRAME);
      this.renderer = renderer;
      this.uploadHookHelper = null;
      this.queue = [];
      this.addHooks = [];
      this.uploadHooks = [];
      this.completes = [];
      this.ticking = false;
      this.delayedTick = function() {
        if (!_this.queue) {
          return;
        }
        _this.prepareItems();
      };
      this.registerFindHook(findText);
      this.registerFindHook(findTextStyle);
      this.registerFindHook(findMultipleBaseTextures);
      this.registerFindHook(findBaseTexture);
      this.registerFindHook(findTexture);
      this.registerUploadHook(drawText);
      this.registerUploadHook(calculateTextStyle);
    }
    BasePrepare2.prototype.upload = function(item, done) {
      if (typeof item === "function") {
        done = item;
        item = null;
      }
      if (item) {
        this.add(item);
      }
      if (this.queue.length) {
        if (done) {
          this.completes.push(done);
        }
        if (!this.ticking) {
          this.ticking = true;
          Ticker.system.addOnce(this.tick, this, UPDATE_PRIORITY.UTILITY);
        }
      } else if (done) {
        done();
      }
    };
    BasePrepare2.prototype.tick = function() {
      setTimeout(this.delayedTick, 0);
    };
    BasePrepare2.prototype.prepareItems = function() {
      this.limiter.beginFrame();
      while (this.queue.length && this.limiter.allowedToUpload()) {
        var item = this.queue[0];
        var uploaded = false;
        if (item && !item._destroyed) {
          for (var i = 0, len = this.uploadHooks.length; i < len; i++) {
            if (this.uploadHooks[i](this.uploadHookHelper, item)) {
              this.queue.shift();
              uploaded = true;
              break;
            }
          }
        }
        if (!uploaded) {
          this.queue.shift();
        }
      }
      if (!this.queue.length) {
        this.ticking = false;
        var completes = this.completes.slice(0);
        this.completes.length = 0;
        for (var i = 0, len = completes.length; i < len; i++) {
          completes[i]();
        }
      } else {
        Ticker.system.addOnce(this.tick, this, UPDATE_PRIORITY.UTILITY);
      }
    };
    BasePrepare2.prototype.registerFindHook = function(addHook) {
      if (addHook) {
        this.addHooks.push(addHook);
      }
      return this;
    };
    BasePrepare2.prototype.registerUploadHook = function(uploadHook) {
      if (uploadHook) {
        this.uploadHooks.push(uploadHook);
      }
      return this;
    };
    BasePrepare2.prototype.add = function(item) {
      for (var i = 0, len = this.addHooks.length; i < len; i++) {
        if (this.addHooks[i](item, this.queue)) {
          break;
        }
      }
      if (item instanceof Container) {
        for (var i = item.children.length - 1; i >= 0; i--) {
          this.add(item.children[i]);
        }
      }
      return this;
    };
    BasePrepare2.prototype.destroy = function() {
      if (this.ticking) {
        Ticker.system.remove(this.tick, this);
      }
      this.ticking = false;
      this.addHooks = null;
      this.uploadHooks = null;
      this.renderer = null;
      this.completes = null;
      this.queue = null;
      this.limiter = null;
      this.uploadHookHelper = null;
    };
    return BasePrepare2;
  }();
  function uploadBaseTextures(renderer, item) {
    if (item instanceof BaseTexture) {
      if (!item._glTextures[renderer.CONTEXT_UID]) {
        renderer.texture.bind(item);
      }
      return true;
    }
    return false;
  }
  function uploadGraphics(renderer, item) {
    if (!(item instanceof Graphics)) {
      return false;
    }
    var geometry = item.geometry;
    item.finishPoly();
    geometry.updateBatches();
    var batches = geometry.batches;
    for (var i = 0; i < batches.length; i++) {
      var texture = batches[i].style.texture;
      if (texture) {
        uploadBaseTextures(renderer, texture.baseTexture);
      }
    }
    if (!geometry.batchable) {
      renderer.geometry.bind(geometry, item._resolveDirectShader(renderer));
    }
    return true;
  }
  function findGraphics(item, queue2) {
    if (item instanceof Graphics) {
      queue2.push(item);
      return true;
    }
    return false;
  }
  var Prepare = function(_super) {
    __extends9(Prepare2, _super);
    function Prepare2(renderer) {
      var _this = _super.call(this, renderer) || this;
      _this.uploadHookHelper = _this.renderer;
      _this.registerFindHook(findGraphics);
      _this.registerUploadHook(uploadBaseTextures);
      _this.registerUploadHook(uploadGraphics);
      return _this;
    }
    return Prepare2;
  }(BasePrepare);
  var TimeLimiter = function() {
    function TimeLimiter2(maxMilliseconds) {
      this.maxMilliseconds = maxMilliseconds;
      this.frameStart = 0;
    }
    TimeLimiter2.prototype.beginFrame = function() {
      this.frameStart = Date.now();
    };
    TimeLimiter2.prototype.allowedToUpload = function() {
      return Date.now() - this.frameStart < this.maxMilliseconds;
    };
    return TimeLimiter2;
  }();

  // node_modules/@pixi/spritesheet/lib/spritesheet.es.js
  /*!
   * @pixi/spritesheet - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/spritesheet is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var Spritesheet = function() {
    function Spritesheet2(texture, data, resolutionFilename) {
      if (resolutionFilename === void 0) {
        resolutionFilename = null;
      }
      this._texture = texture instanceof Texture ? texture : null;
      this.baseTexture = texture instanceof BaseTexture ? texture : this._texture.baseTexture;
      this.textures = {};
      this.animations = {};
      this.data = data;
      var resource = this.baseTexture.resource;
      this.resolution = this._updateResolution(resolutionFilename || (resource ? resource.url : null));
      this._frames = this.data.frames;
      this._frameKeys = Object.keys(this._frames);
      this._batchIndex = 0;
      this._callback = null;
    }
    Spritesheet2.prototype._updateResolution = function(resolutionFilename) {
      if (resolutionFilename === void 0) {
        resolutionFilename = null;
      }
      var scale = this.data.meta.scale;
      var resolution = getResolutionOfUrl(resolutionFilename, null);
      if (resolution === null) {
        resolution = scale !== void 0 ? parseFloat(scale) : 1;
      }
      if (resolution !== 1) {
        this.baseTexture.setResolution(resolution);
      }
      return resolution;
    };
    Spritesheet2.prototype.parse = function(callback) {
      this._batchIndex = 0;
      this._callback = callback;
      if (this._frameKeys.length <= Spritesheet2.BATCH_SIZE) {
        this._processFrames(0);
        this._processAnimations();
        this._parseComplete();
      } else {
        this._nextBatch();
      }
    };
    Spritesheet2.prototype._processFrames = function(initialFrameIndex) {
      var frameIndex = initialFrameIndex;
      var maxFrames = Spritesheet2.BATCH_SIZE;
      while (frameIndex - initialFrameIndex < maxFrames && frameIndex < this._frameKeys.length) {
        var i = this._frameKeys[frameIndex];
        var data = this._frames[i];
        var rect = data.frame;
        if (rect) {
          var frame = null;
          var trim = null;
          var sourceSize = data.trimmed !== false && data.sourceSize ? data.sourceSize : data.frame;
          var orig = new Rectangle(0, 0, Math.floor(sourceSize.w) / this.resolution, Math.floor(sourceSize.h) / this.resolution);
          if (data.rotated) {
            frame = new Rectangle(Math.floor(rect.x) / this.resolution, Math.floor(rect.y) / this.resolution, Math.floor(rect.h) / this.resolution, Math.floor(rect.w) / this.resolution);
          } else {
            frame = new Rectangle(Math.floor(rect.x) / this.resolution, Math.floor(rect.y) / this.resolution, Math.floor(rect.w) / this.resolution, Math.floor(rect.h) / this.resolution);
          }
          if (data.trimmed !== false && data.spriteSourceSize) {
            trim = new Rectangle(Math.floor(data.spriteSourceSize.x) / this.resolution, Math.floor(data.spriteSourceSize.y) / this.resolution, Math.floor(rect.w) / this.resolution, Math.floor(rect.h) / this.resolution);
          }
          this.textures[i] = new Texture(this.baseTexture, frame, orig, trim, data.rotated ? 2 : 0, data.anchor);
          Texture.addToCache(this.textures[i], i);
        }
        frameIndex++;
      }
    };
    Spritesheet2.prototype._processAnimations = function() {
      var animations = this.data.animations || {};
      for (var animName in animations) {
        this.animations[animName] = [];
        for (var i = 0; i < animations[animName].length; i++) {
          var frameName = animations[animName][i];
          this.animations[animName].push(this.textures[frameName]);
        }
      }
    };
    Spritesheet2.prototype._parseComplete = function() {
      var callback = this._callback;
      this._callback = null;
      this._batchIndex = 0;
      callback.call(this, this.textures);
    };
    Spritesheet2.prototype._nextBatch = function() {
      var _this = this;
      this._processFrames(this._batchIndex * Spritesheet2.BATCH_SIZE);
      this._batchIndex++;
      setTimeout(function() {
        if (_this._batchIndex * Spritesheet2.BATCH_SIZE < _this._frameKeys.length) {
          _this._nextBatch();
        } else {
          _this._processAnimations();
          _this._parseComplete();
        }
      }, 0);
    };
    Spritesheet2.prototype.destroy = function(destroyBase) {
      var _a2;
      if (destroyBase === void 0) {
        destroyBase = false;
      }
      for (var i in this.textures) {
        this.textures[i].destroy();
      }
      this._frames = null;
      this._frameKeys = null;
      this.data = null;
      this.textures = null;
      if (destroyBase) {
        (_a2 = this._texture) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        this.baseTexture.destroy();
      }
      this._texture = null;
      this.baseTexture = null;
    };
    Spritesheet2.BATCH_SIZE = 1e3;
    return Spritesheet2;
  }();
  var SpritesheetLoader = function() {
    function SpritesheetLoader2() {
    }
    SpritesheetLoader2.use = function(resource, next) {
      var loader = this;
      var imageResourceName = resource.name + "_image";
      if (!resource.data || resource.type !== LoaderResource.TYPE.JSON || !resource.data.frames || loader.resources[imageResourceName]) {
        next();
        return;
      }
      var loadOptions = {
        crossOrigin: resource.crossOrigin,
        metadata: resource.metadata.imageMetadata,
        parentResource: resource
      };
      var resourcePath = SpritesheetLoader2.getResourcePath(resource, loader.baseUrl);
      loader.add(imageResourceName, resourcePath, loadOptions, function onImageLoad(res) {
        if (res.error) {
          next(res.error);
          return;
        }
        var spritesheet = new Spritesheet(res.texture, resource.data, resource.url);
        spritesheet.parse(function() {
          resource.spritesheet = spritesheet;
          resource.textures = spritesheet.textures;
          next();
        });
      });
    };
    SpritesheetLoader2.getResourcePath = function(resource, baseUrl) {
      if (resource.isDataUrl) {
        return resource.data.meta.image;
      }
      return import_url2.default.resolve(resource.url.replace(baseUrl, ""), resource.data.meta.image);
    };
    return SpritesheetLoader2;
  }();

  // node_modules/@pixi/sprite-tiling/lib/sprite-tiling.es.js
  /*!
   * @pixi/sprite-tiling - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/sprite-tiling is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics10 = function(d, b) {
    extendStatics10 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics10(d, b);
  };
  function __extends10(d, b) {
    extendStatics10(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var tempPoint2 = new Point();
  var TilingSprite = function(_super) {
    __extends10(TilingSprite2, _super);
    function TilingSprite2(texture, width, height) {
      if (width === void 0) {
        width = 100;
      }
      if (height === void 0) {
        height = 100;
      }
      var _this = _super.call(this, texture) || this;
      _this.tileTransform = new Transform();
      _this._width = width;
      _this._height = height;
      _this.uvMatrix = _this.texture.uvMatrix || new TextureMatrix(texture);
      _this.pluginName = "tilingSprite";
      _this.uvRespectAnchor = false;
      return _this;
    }
    Object.defineProperty(TilingSprite2.prototype, "clampMargin", {
      get: function() {
        return this.uvMatrix.clampMargin;
      },
      set: function(value) {
        this.uvMatrix.clampMargin = value;
        this.uvMatrix.update(true);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TilingSprite2.prototype, "tileScale", {
      get: function() {
        return this.tileTransform.scale;
      },
      set: function(value) {
        this.tileTransform.scale.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TilingSprite2.prototype, "tilePosition", {
      get: function() {
        return this.tileTransform.position;
      },
      set: function(value) {
        this.tileTransform.position.copyFrom(value);
      },
      enumerable: false,
      configurable: true
    });
    TilingSprite2.prototype._onTextureUpdate = function() {
      if (this.uvMatrix) {
        this.uvMatrix.texture = this._texture;
      }
      this._cachedTint = 16777215;
    };
    TilingSprite2.prototype._render = function(renderer) {
      var texture = this._texture;
      if (!texture || !texture.valid) {
        return;
      }
      this.tileTransform.updateLocalTransform();
      this.uvMatrix.update();
      renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);
      renderer.plugins[this.pluginName].render(this);
    };
    TilingSprite2.prototype._calculateBounds = function() {
      var minX = this._width * -this._anchor._x;
      var minY = this._height * -this._anchor._y;
      var maxX = this._width * (1 - this._anchor._x);
      var maxY = this._height * (1 - this._anchor._y);
      this._bounds.addFrame(this.transform, minX, minY, maxX, maxY);
    };
    TilingSprite2.prototype.getLocalBounds = function(rect) {
      if (this.children.length === 0) {
        this._bounds.minX = this._width * -this._anchor._x;
        this._bounds.minY = this._height * -this._anchor._y;
        this._bounds.maxX = this._width * (1 - this._anchor._x);
        this._bounds.maxY = this._height * (1 - this._anchor._y);
        if (!rect) {
          if (!this._localBoundsRect) {
            this._localBoundsRect = new Rectangle();
          }
          rect = this._localBoundsRect;
        }
        return this._bounds.getRectangle(rect);
      }
      return _super.prototype.getLocalBounds.call(this, rect);
    };
    TilingSprite2.prototype.containsPoint = function(point) {
      this.worldTransform.applyInverse(point, tempPoint2);
      var width = this._width;
      var height = this._height;
      var x1 = -width * this.anchor._x;
      if (tempPoint2.x >= x1 && tempPoint2.x < x1 + width) {
        var y1 = -height * this.anchor._y;
        if (tempPoint2.y >= y1 && tempPoint2.y < y1 + height) {
          return true;
        }
      }
      return false;
    };
    TilingSprite2.prototype.destroy = function(options) {
      _super.prototype.destroy.call(this, options);
      this.tileTransform = null;
      this.uvMatrix = null;
    };
    TilingSprite2.from = function(source, options) {
      if (typeof options === "number") {
        deprecation("5.3.0", "TilingSprite.from use options instead of width and height args");
        options = {width: options, height: arguments[2]};
      }
      return new TilingSprite2(Texture.from(source, options), options.width, options.height);
    };
    Object.defineProperty(TilingSprite2.prototype, "width", {
      get: function() {
        return this._width;
      },
      set: function(value) {
        this._width = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(TilingSprite2.prototype, "height", {
      get: function() {
        return this._height;
      },
      set: function(value) {
        this._height = value;
      },
      enumerable: false,
      configurable: true
    });
    return TilingSprite2;
  }(Sprite);
  var vertex3 = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";
  var fragment3 = "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n";
  var fragmentSimple = "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n";
  var tempMat2 = new Matrix();
  var TilingSpriteRenderer = function(_super) {
    __extends10(TilingSpriteRenderer2, _super);
    function TilingSpriteRenderer2(renderer) {
      var _this = _super.call(this, renderer) || this;
      var uniforms = {globals: _this.renderer.globalUniforms};
      _this.shader = Shader.from(vertex3, fragment3, uniforms);
      _this.simpleShader = Shader.from(vertex3, fragmentSimple, uniforms);
      _this.quad = new QuadUv();
      _this.state = State.for2d();
      return _this;
    }
    TilingSpriteRenderer2.prototype.render = function(ts) {
      var renderer = this.renderer;
      var quad = this.quad;
      var vertices = quad.vertices;
      vertices[0] = vertices[6] = ts._width * -ts.anchor.x;
      vertices[1] = vertices[3] = ts._height * -ts.anchor.y;
      vertices[2] = vertices[4] = ts._width * (1 - ts.anchor.x);
      vertices[5] = vertices[7] = ts._height * (1 - ts.anchor.y);
      if (ts.uvRespectAnchor) {
        vertices = quad.uvs;
        vertices[0] = vertices[6] = -ts.anchor.x;
        vertices[1] = vertices[3] = -ts.anchor.y;
        vertices[2] = vertices[4] = 1 - ts.anchor.x;
        vertices[5] = vertices[7] = 1 - ts.anchor.y;
      }
      quad.invalidate();
      var tex = ts._texture;
      var baseTex = tex.baseTexture;
      var lt = ts.tileTransform.localTransform;
      var uv = ts.uvMatrix;
      var isSimple = baseTex.isPowerOfTwo && tex.frame.width === baseTex.width && tex.frame.height === baseTex.height;
      if (isSimple) {
        if (!baseTex._glTextures[renderer.CONTEXT_UID]) {
          if (baseTex.wrapMode === WRAP_MODES.CLAMP) {
            baseTex.wrapMode = WRAP_MODES.REPEAT;
          }
        } else {
          isSimple = baseTex.wrapMode !== WRAP_MODES.CLAMP;
        }
      }
      var shader = isSimple ? this.simpleShader : this.shader;
      var w = tex.width;
      var h = tex.height;
      var W = ts._width;
      var H = ts._height;
      tempMat2.set(lt.a * w / W, lt.b * w / H, lt.c * h / W, lt.d * h / H, lt.tx / W, lt.ty / H);
      tempMat2.invert();
      if (isSimple) {
        tempMat2.prepend(uv.mapCoord);
      } else {
        shader.uniforms.uMapCoord = uv.mapCoord.toArray(true);
        shader.uniforms.uClampFrame = uv.uClampFrame;
        shader.uniforms.uClampOffset = uv.uClampOffset;
      }
      shader.uniforms.uTransform = tempMat2.toArray(true);
      shader.uniforms.uColor = premultiplyTintToRgba(ts.tint, ts.worldAlpha, shader.uniforms.uColor, baseTex.alphaMode);
      shader.uniforms.translationMatrix = ts.transform.worldTransform.toArray(true);
      shader.uniforms.uSampler = tex;
      renderer.shader.bind(shader);
      renderer.geometry.bind(quad);
      this.state.blendMode = correctBlendMode(ts.blendMode, baseTex.alphaMode);
      renderer.state.set(this.state);
      renderer.geometry.draw(this.renderer.gl.TRIANGLES, 6, 0);
    };
    return TilingSpriteRenderer2;
  }(ObjectRenderer);

  // node_modules/@pixi/mesh/lib/mesh.es.js
  /*!
   * @pixi/mesh - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/mesh is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics11 = function(d, b) {
    extendStatics11 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics11(d, b);
  };
  function __extends11(d, b) {
    extendStatics11(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var MeshBatchUvs = function() {
    function MeshBatchUvs2(uvBuffer, uvMatrix) {
      this.uvBuffer = uvBuffer;
      this.uvMatrix = uvMatrix;
      this.data = null;
      this._bufferUpdateId = -1;
      this._textureUpdateId = -1;
      this._updateID = 0;
    }
    MeshBatchUvs2.prototype.update = function(forceUpdate) {
      if (!forceUpdate && this._bufferUpdateId === this.uvBuffer._updateID && this._textureUpdateId === this.uvMatrix._updateID) {
        return;
      }
      this._bufferUpdateId = this.uvBuffer._updateID;
      this._textureUpdateId = this.uvMatrix._updateID;
      var data = this.uvBuffer.data;
      if (!this.data || this.data.length !== data.length) {
        this.data = new Float32Array(data.length);
      }
      this.uvMatrix.multiplyUvs(data, this.data);
      this._updateID++;
    };
    return MeshBatchUvs2;
  }();
  var tempPoint3 = new Point();
  var tempPolygon = new Polygon();
  var Mesh = function(_super) {
    __extends11(Mesh2, _super);
    function Mesh2(geometry, shader, state, drawMode) {
      if (drawMode === void 0) {
        drawMode = DRAW_MODES.TRIANGLES;
      }
      var _this = _super.call(this) || this;
      _this.geometry = geometry;
      geometry.refCount++;
      _this.shader = shader;
      _this.state = state || State.for2d();
      _this.drawMode = drawMode;
      _this.start = 0;
      _this.size = 0;
      _this.uvs = null;
      _this.indices = null;
      _this.vertexData = new Float32Array(1);
      _this.vertexDirty = 0;
      _this._transformID = -1;
      _this._roundPixels = settings.ROUND_PIXELS;
      _this.batchUvs = null;
      return _this;
    }
    Object.defineProperty(Mesh2.prototype, "uvBuffer", {
      get: function() {
        return this.geometry.buffers[1];
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "verticesBuffer", {
      get: function() {
        return this.geometry.buffers[0];
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "material", {
      get: function() {
        return this.shader;
      },
      set: function(value) {
        this.shader = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "blendMode", {
      get: function() {
        return this.state.blendMode;
      },
      set: function(value) {
        this.state.blendMode = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "roundPixels", {
      get: function() {
        return this._roundPixels;
      },
      set: function(value) {
        if (this._roundPixels !== value) {
          this._transformID = -1;
        }
        this._roundPixels = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "tint", {
      get: function() {
        return this.shader.tint;
      },
      set: function(value) {
        this.shader.tint = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(Mesh2.prototype, "texture", {
      get: function() {
        return this.shader.texture;
      },
      set: function(value) {
        this.shader.texture = value;
      },
      enumerable: false,
      configurable: true
    });
    Mesh2.prototype._render = function(renderer) {
      var vertices = this.geometry.buffers[0].data;
      if (this.shader.batchable && this.drawMode === DRAW_MODES.TRIANGLES && vertices.length < Mesh2.BATCHABLE_SIZE * 2) {
        this._renderToBatch(renderer);
      } else {
        this._renderDefault(renderer);
      }
    };
    Mesh2.prototype._renderDefault = function(renderer) {
      var shader = this.shader;
      shader.alpha = this.worldAlpha;
      if (shader.update) {
        shader.update();
      }
      renderer.batch.flush();
      if (shader.program.uniformData.translationMatrix) {
        shader.uniforms.translationMatrix = this.transform.worldTransform.toArray(true);
      }
      renderer.shader.bind(shader);
      renderer.state.set(this.state);
      renderer.geometry.bind(this.geometry, shader);
      renderer.geometry.draw(this.drawMode, this.size, this.start, this.geometry.instanceCount);
    };
    Mesh2.prototype._renderToBatch = function(renderer) {
      var geometry = this.geometry;
      if (this.shader.uvMatrix) {
        this.shader.uvMatrix.update();
        this.calculateUvs();
      }
      this.calculateVertices();
      this.indices = geometry.indexBuffer.data;
      this._tintRGB = this.shader._tintRGB;
      this._texture = this.shader.texture;
      var pluginName = this.material.pluginName;
      renderer.batch.setObjectRenderer(renderer.plugins[pluginName]);
      renderer.plugins[pluginName].render(this);
    };
    Mesh2.prototype.calculateVertices = function() {
      var geometry = this.geometry;
      var vertices = geometry.buffers[0].data;
      if (geometry.vertexDirtyId === this.vertexDirty && this._transformID === this.transform._worldID) {
        return;
      }
      this._transformID = this.transform._worldID;
      if (this.vertexData.length !== vertices.length) {
        this.vertexData = new Float32Array(vertices.length);
      }
      var wt = this.transform.worldTransform;
      var a = wt.a;
      var b = wt.b;
      var c = wt.c;
      var d = wt.d;
      var tx = wt.tx;
      var ty = wt.ty;
      var vertexData = this.vertexData;
      for (var i = 0; i < vertexData.length / 2; i++) {
        var x = vertices[i * 2];
        var y = vertices[i * 2 + 1];
        vertexData[i * 2] = a * x + c * y + tx;
        vertexData[i * 2 + 1] = b * x + d * y + ty;
      }
      if (this._roundPixels) {
        var resolution = settings.RESOLUTION;
        for (var i = 0; i < vertexData.length; ++i) {
          vertexData[i] = Math.round((vertexData[i] * resolution | 0) / resolution);
        }
      }
      this.vertexDirty = geometry.vertexDirtyId;
    };
    Mesh2.prototype.calculateUvs = function() {
      var geomUvs = this.geometry.buffers[1];
      if (!this.shader.uvMatrix.isSimple) {
        if (!this.batchUvs) {
          this.batchUvs = new MeshBatchUvs(geomUvs, this.shader.uvMatrix);
        }
        this.batchUvs.update();
        this.uvs = this.batchUvs.data;
      } else {
        this.uvs = geomUvs.data;
      }
    };
    Mesh2.prototype._calculateBounds = function() {
      this.calculateVertices();
      this._bounds.addVertexData(this.vertexData, 0, this.vertexData.length);
    };
    Mesh2.prototype.containsPoint = function(point) {
      if (!this.getBounds().contains(point.x, point.y)) {
        return false;
      }
      this.worldTransform.applyInverse(point, tempPoint3);
      var vertices = this.geometry.getBuffer("aVertexPosition").data;
      var points = tempPolygon.points;
      var indices2 = this.geometry.getIndex().data;
      var len = indices2.length;
      var step = this.drawMode === 4 ? 3 : 1;
      for (var i = 0; i + 2 < len; i += step) {
        var ind0 = indices2[i] * 2;
        var ind1 = indices2[i + 1] * 2;
        var ind2 = indices2[i + 2] * 2;
        points[0] = vertices[ind0];
        points[1] = vertices[ind0 + 1];
        points[2] = vertices[ind1];
        points[3] = vertices[ind1 + 1];
        points[4] = vertices[ind2];
        points[5] = vertices[ind2 + 1];
        if (tempPolygon.contains(tempPoint3.x, tempPoint3.y)) {
          return true;
        }
      }
      return false;
    };
    Mesh2.prototype.destroy = function(options) {
      _super.prototype.destroy.call(this, options);
      this.geometry.refCount--;
      if (this.geometry.refCount === 0) {
        this.geometry.dispose();
      }
      this.geometry = null;
      this.shader = null;
      this.state = null;
      this.uvs = null;
      this.indices = null;
      this.vertexData = null;
    };
    Mesh2.BATCHABLE_SIZE = 100;
    return Mesh2;
  }(Container);
  var fragment4 = "varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n";
  var vertex4 = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n";
  var MeshMaterial = function(_super) {
    __extends11(MeshMaterial2, _super);
    function MeshMaterial2(uSampler, options) {
      var _this = this;
      var uniforms = {
        uSampler,
        alpha: 1,
        uTextureMatrix: Matrix.IDENTITY,
        uColor: new Float32Array([1, 1, 1, 1])
      };
      options = Object.assign({
        tint: 16777215,
        alpha: 1,
        pluginName: "batch"
      }, options);
      if (options.uniforms) {
        Object.assign(uniforms, options.uniforms);
      }
      _this = _super.call(this, options.program || Program.from(vertex4, fragment4), uniforms) || this;
      _this._colorDirty = false;
      _this.uvMatrix = new TextureMatrix(uSampler);
      _this.batchable = options.program === void 0;
      _this.pluginName = options.pluginName;
      _this.tint = options.tint;
      _this.alpha = options.alpha;
      return _this;
    }
    Object.defineProperty(MeshMaterial2.prototype, "texture", {
      get: function() {
        return this.uniforms.uSampler;
      },
      set: function(value) {
        if (this.uniforms.uSampler !== value) {
          this.uniforms.uSampler = value;
          this.uvMatrix.texture = value;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(MeshMaterial2.prototype, "alpha", {
      get: function() {
        return this._alpha;
      },
      set: function(value) {
        if (value === this._alpha) {
          return;
        }
        this._alpha = value;
        this._colorDirty = true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(MeshMaterial2.prototype, "tint", {
      get: function() {
        return this._tint;
      },
      set: function(value) {
        if (value === this._tint) {
          return;
        }
        this._tint = value;
        this._tintRGB = (value >> 16) + (value & 65280) + ((value & 255) << 16);
        this._colorDirty = true;
      },
      enumerable: false,
      configurable: true
    });
    MeshMaterial2.prototype.update = function() {
      if (this._colorDirty) {
        this._colorDirty = false;
        var baseTexture = this.texture.baseTexture;
        premultiplyTintToRgba(this._tint, this._alpha, this.uniforms.uColor, baseTexture.alphaMode);
      }
      if (this.uvMatrix.update()) {
        this.uniforms.uTextureMatrix = this.uvMatrix.mapCoord;
      }
    };
    return MeshMaterial2;
  }(Shader);
  var MeshGeometry = function(_super) {
    __extends11(MeshGeometry2, _super);
    function MeshGeometry2(vertices, uvs, index2) {
      var _this = _super.call(this) || this;
      var verticesBuffer = new Buffer2(vertices);
      var uvsBuffer = new Buffer2(uvs, true);
      var indexBuffer = new Buffer2(index2, true, true);
      _this.addAttribute("aVertexPosition", verticesBuffer, 2, false, TYPES.FLOAT).addAttribute("aTextureCoord", uvsBuffer, 2, false, TYPES.FLOAT).addIndex(indexBuffer);
      _this._updateId = -1;
      return _this;
    }
    Object.defineProperty(MeshGeometry2.prototype, "vertexDirtyId", {
      get: function() {
        return this.buffers[0]._updateID;
      },
      enumerable: false,
      configurable: true
    });
    return MeshGeometry2;
  }(Geometry);

  // node_modules/@pixi/text-bitmap/lib/text-bitmap.es.js
  /*!
   * @pixi/text-bitmap - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/text-bitmap is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics12 = function(d, b) {
    extendStatics12 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics12(d, b);
  };
  function __extends12(d, b) {
    extendStatics12(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var BitmapFontData = function() {
    function BitmapFontData2() {
      this.info = [];
      this.common = [];
      this.page = [];
      this.char = [];
      this.kerning = [];
    }
    return BitmapFontData2;
  }();
  var TextFormat = function() {
    function TextFormat2() {
    }
    TextFormat2.test = function(data) {
      return typeof data === "string" && data.indexOf("info face=") === 0;
    };
    TextFormat2.parse = function(txt) {
      var items = txt.match(/^[a-z]+\s+.+$/gm);
      var rawData = {
        info: [],
        common: [],
        page: [],
        char: [],
        chars: [],
        kerning: [],
        kernings: []
      };
      for (var i in items) {
        var name = items[i].match(/^[a-z]+/gm)[0];
        var attributeList = items[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm);
        var itemData = {};
        for (var i_1 in attributeList) {
          var split = attributeList[i_1].split("=");
          var key = split[0];
          var strValue = split[1].replace(/"/gm, "");
          var floatValue = parseFloat(strValue);
          var value = isNaN(floatValue) ? strValue : floatValue;
          itemData[key] = value;
        }
        rawData[name].push(itemData);
      }
      var font = new BitmapFontData();
      rawData.info.forEach(function(info) {
        return font.info.push({
          face: info.face,
          size: parseInt(info.size, 10)
        });
      });
      rawData.common.forEach(function(common) {
        return font.common.push({
          lineHeight: parseInt(common.lineHeight, 10)
        });
      });
      rawData.page.forEach(function(page) {
        return font.page.push({
          id: parseInt(page.id, 10),
          file: page.file
        });
      });
      rawData.char.forEach(function(char) {
        return font.char.push({
          id: parseInt(char.id, 10),
          page: parseInt(char.page, 10),
          x: parseInt(char.x, 10),
          y: parseInt(char.y, 10),
          width: parseInt(char.width, 10),
          height: parseInt(char.height, 10),
          xoffset: parseInt(char.xoffset, 10),
          yoffset: parseInt(char.yoffset, 10),
          xadvance: parseInt(char.xadvance, 10)
        });
      });
      rawData.kerning.forEach(function(kerning) {
        return font.kerning.push({
          first: parseInt(kerning.first, 10),
          second: parseInt(kerning.second, 10),
          amount: parseInt(kerning.amount, 10)
        });
      });
      return font;
    };
    return TextFormat2;
  }();
  var XMLFormat = function() {
    function XMLFormat2() {
    }
    XMLFormat2.test = function(data) {
      return data instanceof XMLDocument && data.getElementsByTagName("page").length && data.getElementsByTagName("info")[0].getAttribute("face") !== null;
    };
    XMLFormat2.parse = function(xml) {
      var data = new BitmapFontData();
      var info = xml.getElementsByTagName("info");
      var common = xml.getElementsByTagName("common");
      var page = xml.getElementsByTagName("page");
      var char = xml.getElementsByTagName("char");
      var kerning = xml.getElementsByTagName("kerning");
      for (var i = 0; i < info.length; i++) {
        data.info.push({
          face: info[i].getAttribute("face"),
          size: parseInt(info[i].getAttribute("size"), 10)
        });
      }
      for (var i = 0; i < common.length; i++) {
        data.common.push({
          lineHeight: parseInt(common[i].getAttribute("lineHeight"), 10)
        });
      }
      for (var i = 0; i < page.length; i++) {
        data.page.push({
          id: parseInt(page[i].getAttribute("id"), 10) || 0,
          file: page[i].getAttribute("file")
        });
      }
      for (var i = 0; i < char.length; i++) {
        var letter = char[i];
        data.char.push({
          id: parseInt(letter.getAttribute("id"), 10),
          page: parseInt(letter.getAttribute("page"), 10) || 0,
          x: parseInt(letter.getAttribute("x"), 10),
          y: parseInt(letter.getAttribute("y"), 10),
          width: parseInt(letter.getAttribute("width"), 10),
          height: parseInt(letter.getAttribute("height"), 10),
          xoffset: parseInt(letter.getAttribute("xoffset"), 10),
          yoffset: parseInt(letter.getAttribute("yoffset"), 10),
          xadvance: parseInt(letter.getAttribute("xadvance"), 10)
        });
      }
      for (var i = 0; i < kerning.length; i++) {
        data.kerning.push({
          first: parseInt(kerning[i].getAttribute("first"), 10),
          second: parseInt(kerning[i].getAttribute("second"), 10),
          amount: parseInt(kerning[i].getAttribute("amount"), 10)
        });
      }
      return data;
    };
    return XMLFormat2;
  }();
  var XMLStringFormat = function() {
    function XMLStringFormat2() {
    }
    XMLStringFormat2.test = function(data) {
      if (typeof data === "string" && data.indexOf("<font>") > -1) {
        var xml = new self.DOMParser().parseFromString(data, "text/xml");
        return XMLFormat.test(xml);
      }
      return false;
    };
    XMLStringFormat2.parse = function(xmlTxt) {
      var xml = new window.DOMParser().parseFromString(xmlTxt, "text/xml");
      return XMLFormat.parse(xml);
    };
    return XMLStringFormat2;
  }();
  var formats = [
    TextFormat,
    XMLFormat,
    XMLStringFormat
  ];
  function autoDetectFormat(data) {
    for (var i = 0; i < formats.length; i++) {
      if (formats[i].test(data)) {
        return formats[i];
      }
    }
    return null;
  }
  function generateFillStyle(canvas2, context2, style, resolution, lines, metrics) {
    var fillStyle = style.fill;
    if (!Array.isArray(fillStyle)) {
      return fillStyle;
    } else if (fillStyle.length === 1) {
      return fillStyle[0];
    }
    var gradient;
    var dropShadowCorrection = style.dropShadow ? style.dropShadowDistance : 0;
    var padding = style.padding || 0;
    var width = Math.ceil(canvas2.width / resolution) - dropShadowCorrection - padding * 2;
    var height = Math.ceil(canvas2.height / resolution) - dropShadowCorrection - padding * 2;
    var fill = fillStyle.slice();
    var fillGradientStops = style.fillGradientStops.slice();
    if (!fillGradientStops.length) {
      var lengthPlus1 = fill.length + 1;
      for (var i = 1; i < lengthPlus1; ++i) {
        fillGradientStops.push(i / lengthPlus1);
      }
    }
    fill.unshift(fillStyle[0]);
    fillGradientStops.unshift(0);
    fill.push(fillStyle[fillStyle.length - 1]);
    fillGradientStops.push(1);
    if (style.fillGradientType === TEXT_GRADIENT.LINEAR_VERTICAL) {
      gradient = context2.createLinearGradient(width / 2, padding, width / 2, height + padding);
      var lastIterationStop = 0;
      var textHeight = metrics.fontProperties.fontSize + style.strokeThickness;
      var gradStopLineHeight = textHeight / height;
      for (var i = 0; i < lines.length; i++) {
        var thisLineTop = metrics.lineHeight * i;
        for (var j = 0; j < fill.length; j++) {
          var lineStop = 0;
          if (typeof fillGradientStops[j] === "number") {
            lineStop = fillGradientStops[j];
          } else {
            lineStop = j / fill.length;
          }
          var globalStop = thisLineTop / height + lineStop * gradStopLineHeight;
          var clampedStop = Math.max(lastIterationStop, globalStop);
          clampedStop = Math.min(clampedStop, 1);
          gradient.addColorStop(clampedStop, fill[j]);
          lastIterationStop = clampedStop;
        }
      }
    } else {
      gradient = context2.createLinearGradient(padding, height / 2, width + padding, height / 2);
      var totalIterations = fill.length + 1;
      var currentIteration = 1;
      for (var i = 0; i < fill.length; i++) {
        var stop = void 0;
        if (typeof fillGradientStops[i] === "number") {
          stop = fillGradientStops[i];
        } else {
          stop = currentIteration / totalIterations;
        }
        gradient.addColorStop(stop, fill[i]);
        currentIteration++;
      }
    }
    return gradient;
  }
  function drawGlyph(canvas2, context2, metrics, x, y, resolution, style) {
    var char = metrics.text;
    var fontProperties = metrics.fontProperties;
    context2.translate(x, y);
    context2.scale(resolution, resolution);
    var tx = style.strokeThickness / 2;
    var ty = -(style.strokeThickness / 2);
    context2.font = style.toFontString();
    context2.lineWidth = style.strokeThickness;
    context2.textBaseline = style.textBaseline;
    context2.lineJoin = style.lineJoin;
    context2.miterLimit = style.miterLimit;
    context2.fillStyle = generateFillStyle(canvas2, context2, style, resolution, [char], metrics);
    context2.strokeStyle = style.stroke;
    context2.font = style.toFontString();
    context2.lineWidth = style.strokeThickness;
    context2.textBaseline = style.textBaseline;
    context2.lineJoin = style.lineJoin;
    context2.miterLimit = style.miterLimit;
    context2.fillStyle = generateFillStyle(canvas2, context2, style, resolution, [char], metrics);
    context2.strokeStyle = style.stroke;
    var dropShadowColor = style.dropShadowColor;
    var rgb = hex2rgb(typeof dropShadowColor === "number" ? dropShadowColor : string2hex(dropShadowColor));
    if (style.dropShadow) {
      context2.shadowColor = "rgba(" + rgb[0] * 255 + "," + rgb[1] * 255 + "," + rgb[2] * 255 + "," + style.dropShadowAlpha + ")";
      context2.shadowBlur = style.dropShadowBlur;
      context2.shadowOffsetX = Math.cos(style.dropShadowAngle) * style.dropShadowDistance;
      context2.shadowOffsetY = Math.sin(style.dropShadowAngle) * style.dropShadowDistance;
    } else {
      context2.shadowColor = "black";
      context2.shadowBlur = 0;
      context2.shadowOffsetX = 0;
      context2.shadowOffsetY = 0;
    }
    if (style.stroke && style.strokeThickness) {
      context2.strokeText(char, tx, ty + metrics.lineHeight - fontProperties.descent);
    }
    if (style.fill) {
      context2.fillText(char, tx, ty + metrics.lineHeight - fontProperties.descent);
    }
    context2.setTransform(1, 0, 0, 1, 0, 0);
    context2.fillStyle = "rgba(0, 0, 0, 0)";
  }
  function resolveCharacters(chars) {
    if (typeof chars === "string") {
      chars = [chars];
    }
    var result = [];
    for (var i = 0, j = chars.length; i < j; i++) {
      var item = chars[i];
      if (Array.isArray(item)) {
        if (item.length !== 2) {
          throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got " + item.length + ".");
        }
        var startCode = item[0].charCodeAt(0);
        var endCode = item[1].charCodeAt(0);
        if (endCode < startCode) {
          throw new Error("[BitmapFont]: Invalid character range.");
        }
        for (var i_1 = startCode, j_1 = endCode; i_1 <= j_1; i_1++) {
          result.push(String.fromCharCode(i_1));
        }
      } else {
        result.push.apply(result, item.split(""));
      }
    }
    if (result.length === 0) {
      throw new Error("[BitmapFont]: Empty set when resolving characters.");
    }
    return result;
  }
  var BitmapFont = function() {
    function BitmapFont2(data, textures) {
      var info = data.info[0];
      var common = data.common[0];
      var page = data.page[0];
      var res = getResolutionOfUrl(page.file);
      var pageTextures = {};
      this.font = info.face;
      this.size = info.size;
      this.lineHeight = common.lineHeight / res;
      this.chars = {};
      this.pageTextures = pageTextures;
      for (var i = 0; i < data.page.length; i++) {
        var _a2 = data.page[i], id = _a2.id, file = _a2.file;
        pageTextures[id] = textures instanceof Array ? textures[i] : textures[file];
      }
      for (var i = 0; i < data.char.length; i++) {
        var _b = data.char[i], id = _b.id, page_1 = _b.page;
        var _c = data.char[i], x = _c.x, y = _c.y, width = _c.width, height = _c.height, xoffset = _c.xoffset, yoffset = _c.yoffset, xadvance = _c.xadvance;
        x /= res;
        y /= res;
        width /= res;
        height /= res;
        xoffset /= res;
        yoffset /= res;
        xadvance /= res;
        var rect = new Rectangle(x + pageTextures[page_1].frame.x / res, y + pageTextures[page_1].frame.y / res, width, height);
        this.chars[id] = {
          xOffset: xoffset,
          yOffset: yoffset,
          xAdvance: xadvance,
          kerning: {},
          texture: new Texture(pageTextures[page_1].baseTexture, rect),
          page: page_1
        };
      }
      for (var i = 0; i < data.kerning.length; i++) {
        var _d = data.kerning[i], first = _d.first, second = _d.second, amount = _d.amount;
        first /= res;
        second /= res;
        amount /= res;
        if (this.chars[second]) {
          this.chars[second].kerning[first] = amount;
        }
      }
    }
    BitmapFont2.prototype.destroy = function() {
      for (var id in this.chars) {
        this.chars[id].texture.destroy();
        this.chars[id].texture = null;
      }
      for (var id in this.pageTextures) {
        this.pageTextures[id].destroy(true);
        this.pageTextures[id] = null;
      }
      this.chars = null;
      this.pageTextures = null;
    };
    BitmapFont2.install = function(data, textures) {
      var fontData;
      if (data instanceof BitmapFontData) {
        fontData = data;
      } else {
        var format = autoDetectFormat(data);
        if (!format) {
          throw new Error("Unrecognized data format for font.");
        }
        fontData = format.parse(data);
      }
      if (textures instanceof Texture) {
        textures = [textures];
      }
      var font = new BitmapFont2(fontData, textures);
      BitmapFont2.available[font.font] = font;
      return font;
    };
    BitmapFont2.uninstall = function(name) {
      var font = BitmapFont2.available[name];
      if (!font) {
        throw new Error("No font found named '" + name + "'");
      }
      font.destroy();
      delete BitmapFont2.available[name];
    };
    BitmapFont2.from = function(name, textStyle, options) {
      if (!name) {
        throw new Error("[BitmapFont] Property `name` is required.");
      }
      var _a2 = Object.assign({}, BitmapFont2.defaultOptions, options), chars = _a2.chars, padding = _a2.padding, resolution = _a2.resolution, textureWidth = _a2.textureWidth, textureHeight = _a2.textureHeight;
      var charsList = resolveCharacters(chars);
      var style = textStyle instanceof TextStyle ? textStyle : new TextStyle(textStyle);
      var lineWidth = textureWidth;
      var fontData = new BitmapFontData();
      fontData.info[0] = {
        face: style.fontFamily,
        size: style.fontSize
      };
      fontData.common[0] = {
        lineHeight: style.fontSize
      };
      var positionX = 0;
      var positionY = 0;
      var canvas2;
      var context2;
      var baseTexture;
      var maxCharHeight = 0;
      var textures = [];
      for (var i = 0; i < charsList.length; i++) {
        if (!canvas2) {
          canvas2 = document.createElement("canvas");
          canvas2.width = textureWidth;
          canvas2.height = textureHeight;
          context2 = canvas2.getContext("2d");
          baseTexture = new BaseTexture(canvas2, {resolution});
          textures.push(new Texture(baseTexture));
          fontData.page.push({
            id: textures.length - 1,
            file: ""
          });
        }
        var metrics = TextMetrics.measureText(charsList[i], style, false, canvas2);
        var width = metrics.width;
        var height = Math.ceil(metrics.height);
        var textureGlyphWidth = Math.ceil((style.fontStyle === "italic" ? 2 : 1) * width);
        if (positionY >= textureHeight - height * resolution) {
          if (positionY === 0) {
            throw new Error("[BitmapFont] textureHeight " + textureHeight + "px is " + ("too small for " + style.fontSize + "px fonts"));
          }
          --i;
          canvas2 = null;
          context2 = null;
          baseTexture = null;
          positionY = 0;
          positionX = 0;
          maxCharHeight = 0;
          continue;
        }
        maxCharHeight = Math.max(height + metrics.fontProperties.descent, maxCharHeight);
        if (textureGlyphWidth * resolution + positionX >= lineWidth) {
          --i;
          positionY += maxCharHeight * resolution;
          positionY = Math.ceil(positionY);
          positionX = 0;
          maxCharHeight = 0;
          continue;
        }
        drawGlyph(canvas2, context2, metrics, positionX, positionY, resolution, style);
        var id = metrics.text.charCodeAt(0);
        fontData.char.push({
          id,
          page: textures.length - 1,
          x: positionX / resolution,
          y: positionY / resolution,
          width: textureGlyphWidth,
          height,
          xoffset: 0,
          yoffset: 0,
          xadvance: Math.ceil(width - (style.dropShadow ? style.dropShadowDistance : 0) - (style.stroke ? style.strokeThickness : 0))
        });
        positionX += (textureGlyphWidth + 2 * padding) * resolution;
        positionX = Math.ceil(positionX);
      }
      var font = new BitmapFont2(fontData, textures);
      if (BitmapFont2.available[name] !== void 0) {
        BitmapFont2.uninstall(name);
      }
      BitmapFont2.available[name] = font;
      return font;
    };
    BitmapFont2.ALPHA = [["a", "z"], ["A", "Z"], " "];
    BitmapFont2.NUMERIC = [["0", "9"]];
    BitmapFont2.ALPHANUMERIC = [["a", "z"], ["A", "Z"], ["0", "9"], " "];
    BitmapFont2.ASCII = [[" ", "~"]];
    BitmapFont2.defaultOptions = {
      resolution: 1,
      textureWidth: 512,
      textureHeight: 512,
      padding: 4,
      chars: BitmapFont2.ALPHANUMERIC
    };
    BitmapFont2.available = {};
    return BitmapFont2;
  }();
  var pageMeshDataPool = [];
  var charRenderDataPool = [];
  var BitmapText = function(_super) {
    __extends12(BitmapText2, _super);
    function BitmapText2(text, style) {
      if (style === void 0) {
        style = {};
      }
      var _this = _super.call(this) || this;
      _this._tint = 16777215;
      if (style.font) {
        deprecation("5.3.0", "PIXI.BitmapText constructor style.font property is deprecated.");
        _this._upgradeStyle(style);
      }
      var _a2 = Object.assign({}, BitmapText2.styleDefaults, style), align = _a2.align, tint = _a2.tint, maxWidth = _a2.maxWidth, letterSpacing = _a2.letterSpacing, fontName = _a2.fontName, fontSize = _a2.fontSize;
      if (!BitmapFont.available[fontName]) {
        throw new Error('Missing BitmapFont "' + fontName + '"');
      }
      _this._activePagesMeshData = [];
      _this._textWidth = 0;
      _this._textHeight = 0;
      _this._align = align;
      _this._tint = tint;
      _this._fontName = fontName;
      _this._fontSize = fontSize || BitmapFont.available[fontName].size;
      _this._text = text;
      _this._maxWidth = maxWidth;
      _this._maxLineHeight = 0;
      _this._letterSpacing = letterSpacing;
      _this._anchor = new ObservablePoint(function() {
        _this.dirty = true;
      }, _this, 0, 0);
      _this._roundPixels = settings.ROUND_PIXELS;
      _this.dirty = true;
      _this._textureCache = {};
      return _this;
    }
    BitmapText2.prototype.updateText = function() {
      var _a2;
      var data = BitmapFont.available[this._fontName];
      var scale = this._fontSize / data.size;
      var pos = new Point();
      var chars = [];
      var lineWidths = [];
      var text = this._text.replace(/(?:\r\n|\r)/g, "\n") || " ";
      var textLength = text.length;
      var maxWidth = this._maxWidth * data.size / this._fontSize;
      var prevCharCode = null;
      var lastLineWidth = 0;
      var maxLineWidth = 0;
      var line = 0;
      var lastBreakPos = -1;
      var lastBreakWidth = 0;
      var spacesRemoved = 0;
      var maxLineHeight = 0;
      for (var i = 0; i < textLength; i++) {
        var charCode = text.charCodeAt(i);
        var char = text.charAt(i);
        if (/(?:\s)/.test(char)) {
          lastBreakPos = i;
          lastBreakWidth = lastLineWidth;
        }
        if (char === "\r" || char === "\n") {
          lineWidths.push(lastLineWidth);
          maxLineWidth = Math.max(maxLineWidth, lastLineWidth);
          ++line;
          ++spacesRemoved;
          pos.x = 0;
          pos.y += data.lineHeight;
          prevCharCode = null;
          continue;
        }
        var charData = data.chars[charCode];
        if (!charData) {
          continue;
        }
        if (prevCharCode && charData.kerning[prevCharCode]) {
          pos.x += charData.kerning[prevCharCode];
        }
        var charRenderData = charRenderDataPool.pop() || {
          texture: Texture.EMPTY,
          line: 0,
          charCode: 0,
          position: new Point()
        };
        charRenderData.texture = charData.texture;
        charRenderData.line = line;
        charRenderData.charCode = charCode;
        charRenderData.position.x = pos.x + charData.xOffset + this._letterSpacing / 2;
        charRenderData.position.y = pos.y + charData.yOffset;
        chars.push(charRenderData);
        pos.x += charData.xAdvance + this._letterSpacing;
        lastLineWidth = pos.x;
        maxLineHeight = Math.max(maxLineHeight, charData.yOffset + charData.texture.height);
        prevCharCode = charCode;
        if (lastBreakPos !== -1 && maxWidth > 0 && pos.x > maxWidth) {
          ++spacesRemoved;
          removeItems(chars, 1 + lastBreakPos - spacesRemoved, 1 + i - lastBreakPos);
          i = lastBreakPos;
          lastBreakPos = -1;
          lineWidths.push(lastBreakWidth);
          maxLineWidth = Math.max(maxLineWidth, lastBreakWidth);
          line++;
          pos.x = 0;
          pos.y += data.lineHeight;
          prevCharCode = null;
        }
      }
      var lastChar = text.charAt(text.length - 1);
      if (lastChar !== "\r" && lastChar !== "\n") {
        if (/(?:\s)/.test(lastChar)) {
          lastLineWidth = lastBreakWidth;
        }
        lineWidths.push(lastLineWidth);
        maxLineWidth = Math.max(maxLineWidth, lastLineWidth);
      }
      var lineAlignOffsets = [];
      for (var i = 0; i <= line; i++) {
        var alignOffset = 0;
        if (this._align === "right") {
          alignOffset = maxLineWidth - lineWidths[i];
        } else if (this._align === "center") {
          alignOffset = (maxLineWidth - lineWidths[i]) / 2;
        }
        lineAlignOffsets.push(alignOffset);
      }
      var lenChars = chars.length;
      var pagesMeshData = {};
      var newPagesMeshData = [];
      var activePagesMeshData = this._activePagesMeshData;
      for (var i = 0; i < activePagesMeshData.length; i++) {
        pageMeshDataPool.push(activePagesMeshData[i]);
      }
      for (var i = 0; i < lenChars; i++) {
        var texture = chars[i].texture;
        var baseTextureUid = texture.baseTexture.uid;
        if (!pagesMeshData[baseTextureUid]) {
          var pageMeshData = pageMeshDataPool.pop();
          if (!pageMeshData) {
            var geometry = new MeshGeometry();
            var material = new MeshMaterial(Texture.EMPTY);
            var mesh = new Mesh(geometry, material);
            pageMeshData = {
              index: 0,
              indexCount: 0,
              vertexCount: 0,
              uvsCount: 0,
              total: 0,
              mesh,
              vertices: null,
              uvs: null,
              indices: null
            };
          }
          pageMeshData.index = 0;
          pageMeshData.indexCount = 0;
          pageMeshData.vertexCount = 0;
          pageMeshData.uvsCount = 0;
          pageMeshData.total = 0;
          var _textureCache = this._textureCache;
          _textureCache[baseTextureUid] = _textureCache[baseTextureUid] || new Texture(texture.baseTexture);
          pageMeshData.mesh.texture = _textureCache[baseTextureUid];
          pageMeshData.mesh.tint = this._tint;
          newPagesMeshData.push(pageMeshData);
          pagesMeshData[baseTextureUid] = pageMeshData;
        }
        pagesMeshData[baseTextureUid].total++;
      }
      for (var i = 0; i < activePagesMeshData.length; i++) {
        if (newPagesMeshData.indexOf(activePagesMeshData[i]) === -1) {
          this.removeChild(activePagesMeshData[i].mesh);
        }
      }
      for (var i = 0; i < newPagesMeshData.length; i++) {
        if (newPagesMeshData[i].mesh.parent !== this) {
          this.addChild(newPagesMeshData[i].mesh);
        }
      }
      this._activePagesMeshData = newPagesMeshData;
      for (var i in pagesMeshData) {
        var pageMeshData = pagesMeshData[i];
        var total = pageMeshData.total;
        if (!(((_a2 = pageMeshData.indices) === null || _a2 === void 0 ? void 0 : _a2.length) > 6 * total) || pageMeshData.vertices.length < Mesh.BATCHABLE_SIZE * 2) {
          pageMeshData.vertices = new Float32Array(4 * 2 * total);
          pageMeshData.uvs = new Float32Array(4 * 2 * total);
          pageMeshData.indices = new Uint16Array(6 * total);
        } else {
          var total_1 = pageMeshData.total;
          var vertices = pageMeshData.vertices;
          for (var i_1 = total_1 * 4 * 2; i_1 < vertices.length; i_1++) {
            vertices[i_1] = 0;
          }
        }
        pageMeshData.mesh.size = 6 * total;
      }
      for (var i = 0; i < lenChars; i++) {
        var char = chars[i];
        var offset = char.position.x + lineAlignOffsets[char.line];
        if (this._roundPixels) {
          offset = Math.round(offset);
        }
        var xPos = offset * scale;
        var yPos = char.position.y * scale;
        var texture = char.texture;
        var pageMesh = pagesMeshData[texture.baseTexture.uid];
        var textureFrame = texture.frame;
        var textureUvs = texture._uvs;
        var index2 = pageMesh.index++;
        pageMesh.indices[index2 * 6 + 0] = 0 + index2 * 4;
        pageMesh.indices[index2 * 6 + 1] = 1 + index2 * 4;
        pageMesh.indices[index2 * 6 + 2] = 2 + index2 * 4;
        pageMesh.indices[index2 * 6 + 3] = 0 + index2 * 4;
        pageMesh.indices[index2 * 6 + 4] = 2 + index2 * 4;
        pageMesh.indices[index2 * 6 + 5] = 3 + index2 * 4;
        pageMesh.vertices[index2 * 8 + 0] = xPos;
        pageMesh.vertices[index2 * 8 + 1] = yPos;
        pageMesh.vertices[index2 * 8 + 2] = xPos + textureFrame.width * scale;
        pageMesh.vertices[index2 * 8 + 3] = yPos;
        pageMesh.vertices[index2 * 8 + 4] = xPos + textureFrame.width * scale;
        pageMesh.vertices[index2 * 8 + 5] = yPos + textureFrame.height * scale;
        pageMesh.vertices[index2 * 8 + 6] = xPos;
        pageMesh.vertices[index2 * 8 + 7] = yPos + textureFrame.height * scale;
        pageMesh.uvs[index2 * 8 + 0] = textureUvs.x0;
        pageMesh.uvs[index2 * 8 + 1] = textureUvs.y0;
        pageMesh.uvs[index2 * 8 + 2] = textureUvs.x1;
        pageMesh.uvs[index2 * 8 + 3] = textureUvs.y1;
        pageMesh.uvs[index2 * 8 + 4] = textureUvs.x2;
        pageMesh.uvs[index2 * 8 + 5] = textureUvs.y2;
        pageMesh.uvs[index2 * 8 + 6] = textureUvs.x3;
        pageMesh.uvs[index2 * 8 + 7] = textureUvs.y3;
      }
      this._textWidth = maxLineWidth * scale;
      this._textHeight = (pos.y + data.lineHeight) * scale;
      for (var i in pagesMeshData) {
        var pageMeshData = pagesMeshData[i];
        if (this.anchor.x !== 0 || this.anchor.y !== 0) {
          var vertexCount = 0;
          var anchorOffsetX = this._textWidth * this.anchor.x;
          var anchorOffsetY = this._textHeight * this.anchor.y;
          for (var i_2 = 0; i_2 < pageMeshData.total; i_2++) {
            pageMeshData.vertices[vertexCount++] -= anchorOffsetX;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetY;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetX;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetY;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetX;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetY;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetX;
            pageMeshData.vertices[vertexCount++] -= anchorOffsetY;
          }
        }
        this._maxLineHeight = maxLineHeight * scale;
        var vertexBuffer = pageMeshData.mesh.geometry.getBuffer("aVertexPosition");
        var textureBuffer = pageMeshData.mesh.geometry.getBuffer("aTextureCoord");
        var indexBuffer = pageMeshData.mesh.geometry.getIndex();
        vertexBuffer.data = pageMeshData.vertices;
        textureBuffer.data = pageMeshData.uvs;
        indexBuffer.data = pageMeshData.indices;
        vertexBuffer.update();
        textureBuffer.update();
        indexBuffer.update();
      }
      for (var i = 0; i < chars.length; i++) {
        charRenderDataPool.push(chars[i]);
      }
    };
    BitmapText2.prototype.updateTransform = function() {
      this.validate();
      this.containerUpdateTransform();
    };
    BitmapText2.prototype.getLocalBounds = function() {
      this.validate();
      return _super.prototype.getLocalBounds.call(this);
    };
    BitmapText2.prototype.validate = function() {
      if (this.dirty) {
        this.updateText();
        this.dirty = false;
      }
    };
    Object.defineProperty(BitmapText2.prototype, "tint", {
      get: function() {
        return this._tint;
      },
      set: function(value) {
        if (this._tint === value) {
          return;
        }
        this._tint = value;
        for (var i = 0; i < this._activePagesMeshData.length; i++) {
          this._activePagesMeshData[i].mesh.tint = value;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "align", {
      get: function() {
        return this._align;
      },
      set: function(value) {
        if (this._align !== value) {
          this._align = value;
          this.dirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "fontName", {
      get: function() {
        return this._fontName;
      },
      set: function(value) {
        if (!BitmapFont.available[value]) {
          throw new Error('Missing BitmapFont "' + value + '"');
        }
        if (this._fontName !== value) {
          this._fontName = value;
          this.dirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "fontSize", {
      get: function() {
        return this._fontSize;
      },
      set: function(value) {
        if (this._fontSize !== value) {
          this._fontSize = value;
          this.dirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "anchor", {
      get: function() {
        return this._anchor;
      },
      set: function(value) {
        if (typeof value === "number") {
          this._anchor.set(value);
        } else {
          this._anchor.copyFrom(value);
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "text", {
      get: function() {
        return this._text;
      },
      set: function(text) {
        text = String(text === null || text === void 0 ? "" : text);
        if (this._text === text) {
          return;
        }
        this._text = text;
        this.dirty = true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "maxWidth", {
      get: function() {
        return this._maxWidth;
      },
      set: function(value) {
        if (this._maxWidth === value) {
          return;
        }
        this._maxWidth = value;
        this.dirty = true;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "maxLineHeight", {
      get: function() {
        this.validate();
        return this._maxLineHeight;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "textWidth", {
      get: function() {
        this.validate();
        return this._textWidth;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "letterSpacing", {
      get: function() {
        return this._letterSpacing;
      },
      set: function(value) {
        if (this._letterSpacing !== value) {
          this._letterSpacing = value;
          this.dirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "roundPixels", {
      get: function() {
        return this._roundPixels;
      },
      set: function(value) {
        if (value !== this._roundPixels) {
          this._roundPixels = value;
          this.dirty = true;
        }
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BitmapText2.prototype, "textHeight", {
      get: function() {
        this.validate();
        return this._textHeight;
      },
      enumerable: false,
      configurable: true
    });
    BitmapText2.prototype._upgradeStyle = function(style) {
      if (typeof style.font === "string") {
        var valueSplit = style.font.split(" ");
        style.fontName = valueSplit.length === 1 ? valueSplit[0] : valueSplit.slice(1).join(" ");
        if (valueSplit.length >= 2) {
          style.fontSize = parseInt(valueSplit[0], 10);
        }
      } else {
        style.fontName = style.font.name;
        style.fontSize = typeof style.font.size === "number" ? style.font.size : parseInt(style.font.size, 10);
      }
    };
    BitmapText2.prototype.destroy = function(options) {
      var _textureCache = this._textureCache;
      for (var id in _textureCache) {
        var texture = _textureCache[id];
        texture.destroy();
        delete _textureCache[id];
      }
      this._textureCache = null;
      _super.prototype.destroy.call(this, options);
    };
    BitmapText2.registerFont = function(data, textures) {
      deprecation("5.3.0", "PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install");
      return BitmapFont.install(data, textures);
    };
    Object.defineProperty(BitmapText2, "fonts", {
      get: function() {
        deprecation("5.3.0", "PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available");
        return BitmapFont.available;
      },
      enumerable: false,
      configurable: true
    });
    BitmapText2.styleDefaults = {
      align: "left",
      tint: 16777215,
      maxWidth: 0,
      letterSpacing: 0
    };
    return BitmapText2;
  }(Container);
  var BitmapFontLoader = function() {
    function BitmapFontLoader2() {
    }
    BitmapFontLoader2.add = function() {
      LoaderResource.setExtensionXhrType("fnt", LoaderResource.XHR_RESPONSE_TYPE.TEXT);
    };
    BitmapFontLoader2.use = function(resource, next) {
      var format = autoDetectFormat(resource.data);
      if (!format) {
        next();
        return;
      }
      var baseUrl = BitmapFontLoader2.getBaseUrl(this, resource);
      var data = format.parse(resource.data);
      var textures = {};
      var completed = function(page) {
        textures[page.metadata.pageFile] = page.texture;
        if (Object.keys(textures).length === data.page.length) {
          resource.bitmapFont = BitmapFont.install(data, textures);
          next();
        }
      };
      for (var i = 0; i < data.page.length; ++i) {
        var pageFile = data.page[i].file;
        var url = baseUrl + pageFile;
        var exists = false;
        for (var name in this.resources) {
          var bitmapResource = this.resources[name];
          if (bitmapResource.url === url) {
            bitmapResource.metadata.pageFile = pageFile;
            if (bitmapResource.texture) {
              completed(bitmapResource);
            } else {
              bitmapResource.onAfterMiddleware.add(completed);
            }
            exists = true;
            break;
          }
        }
        if (!exists) {
          var options = {
            crossOrigin: resource.crossOrigin,
            loadType: LoaderResource.LOAD_TYPE.IMAGE,
            metadata: Object.assign({pageFile}, resource.metadata.imageMetadata),
            parentResource: resource
          };
          this.add(url, options, completed);
        }
      }
    };
    BitmapFontLoader2.getBaseUrl = function(loader, resource) {
      var resUrl = !resource.isDataUrl ? BitmapFontLoader2.dirname(resource.url) : "";
      if (resource.isDataUrl) {
        if (resUrl === ".") {
          resUrl = "";
        }
        if (loader.baseUrl && resUrl) {
          if (loader.baseUrl.charAt(loader.baseUrl.length - 1) === "/") {
            resUrl += "/";
          }
        }
      }
      resUrl = resUrl.replace(loader.baseUrl, "");
      if (resUrl && resUrl.charAt(resUrl.length - 1) !== "/") {
        resUrl += "/";
      }
      return resUrl;
    };
    BitmapFontLoader2.dirname = function(url) {
      var dir = url.replace(/\\/g, "/").replace(/\/$/, "").replace(/\/[^\/]*$/, "");
      if (dir === url) {
        return ".";
      } else if (dir === "") {
        return "/";
      }
      return dir;
    };
    return BitmapFontLoader2;
  }();

  // node_modules/@pixi/filter-alpha/lib/filter-alpha.es.js
  /*!
   * @pixi/filter-alpha - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-alpha is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics13 = function(d, b) {
    extendStatics13 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics13(d, b);
  };
  function __extends13(d, b) {
    extendStatics13(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var fragment5 = "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n";
  var AlphaFilter = function(_super) {
    __extends13(AlphaFilter2, _super);
    function AlphaFilter2(alpha) {
      if (alpha === void 0) {
        alpha = 1;
      }
      var _this = _super.call(this, _default, fragment5, {uAlpha: 1}) || this;
      _this.alpha = alpha;
      return _this;
    }
    Object.defineProperty(AlphaFilter2.prototype, "alpha", {
      get: function() {
        return this.uniforms.uAlpha;
      },
      set: function(value) {
        this.uniforms.uAlpha = value;
      },
      enumerable: false,
      configurable: true
    });
    return AlphaFilter2;
  }(Filter);

  // node_modules/@pixi/filter-blur/lib/filter-blur.es.js
  /*!
   * @pixi/filter-blur - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-blur is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics14 = function(d, b) {
    extendStatics14 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics14(d, b);
  };
  function __extends14(d, b) {
    extendStatics14(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var vertTemplate = "\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";
  function generateBlurVertSource(kernelSize, x) {
    var halfLength = Math.ceil(kernelSize / 2);
    var vertSource = vertTemplate;
    var blurLoop = "";
    var template;
    if (x) {
      template = "vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);";
    } else {
      template = "vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";
    }
    for (var i = 0; i < kernelSize; i++) {
      var blur = template.replace("%index%", i.toString());
      blur = blur.replace("%sampleIndex%", i - (halfLength - 1) + ".0");
      blurLoop += blur;
      blurLoop += "\n";
    }
    vertSource = vertSource.replace("%blur%", blurLoop);
    vertSource = vertSource.replace("%size%", kernelSize.toString());
    return vertSource;
  }
  var GAUSSIAN_VALUES = {
    5: [0.153388, 0.221461, 0.250301],
    7: [0.071303, 0.131514, 0.189879, 0.214607],
    9: [0.028532, 0.067234, 0.124009, 0.179044, 0.20236],
    11: [93e-4, 0.028002, 0.065984, 0.121703, 0.175713, 0.198596],
    13: [2406e-6, 9255e-6, 0.027867, 0.065666, 0.121117, 0.174868, 0.197641],
    15: [489e-6, 2403e-6, 9246e-6, 0.02784, 0.065602, 0.120999, 0.174697, 0.197448]
  };
  var fragTemplate2 = [
    "varying vec2 vBlurTexCoords[%size%];",
    "uniform sampler2D uSampler;",
    "void main(void)",
    "{",
    "    gl_FragColor = vec4(0.0);",
    "    %blur%",
    "}"
  ].join("\n");
  function generateBlurFragSource(kernelSize) {
    var kernel = GAUSSIAN_VALUES[kernelSize];
    var halfLength = kernel.length;
    var fragSource = fragTemplate2;
    var blurLoop = "";
    var template = "gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";
    var value;
    for (var i = 0; i < kernelSize; i++) {
      var blur = template.replace("%index%", i.toString());
      value = i;
      if (i >= halfLength) {
        value = kernelSize - i - 1;
      }
      blur = blur.replace("%value%", kernel[value].toString());
      blurLoop += blur;
      blurLoop += "\n";
    }
    fragSource = fragSource.replace("%blur%", blurLoop);
    fragSource = fragSource.replace("%size%", kernelSize.toString());
    return fragSource;
  }
  var ENV2;
  (function(ENV3) {
    ENV3[ENV3["WEBGL_LEGACY"] = 0] = "WEBGL_LEGACY";
    ENV3[ENV3["WEBGL"] = 1] = "WEBGL";
    ENV3[ENV3["WEBGL2"] = 2] = "WEBGL2";
  })(ENV2 || (ENV2 = {}));
  var RENDERER_TYPE2;
  (function(RENDERER_TYPE3) {
    RENDERER_TYPE3[RENDERER_TYPE3["UNKNOWN"] = 0] = "UNKNOWN";
    RENDERER_TYPE3[RENDERER_TYPE3["WEBGL"] = 1] = "WEBGL";
    RENDERER_TYPE3[RENDERER_TYPE3["CANVAS"] = 2] = "CANVAS";
  })(RENDERER_TYPE2 || (RENDERER_TYPE2 = {}));
  var BUFFER_BITS2;
  (function(BUFFER_BITS3) {
    BUFFER_BITS3[BUFFER_BITS3["COLOR"] = 16384] = "COLOR";
    BUFFER_BITS3[BUFFER_BITS3["DEPTH"] = 256] = "DEPTH";
    BUFFER_BITS3[BUFFER_BITS3["STENCIL"] = 1024] = "STENCIL";
  })(BUFFER_BITS2 || (BUFFER_BITS2 = {}));
  var BLEND_MODES2;
  (function(BLEND_MODES3) {
    BLEND_MODES3[BLEND_MODES3["NORMAL"] = 0] = "NORMAL";
    BLEND_MODES3[BLEND_MODES3["ADD"] = 1] = "ADD";
    BLEND_MODES3[BLEND_MODES3["MULTIPLY"] = 2] = "MULTIPLY";
    BLEND_MODES3[BLEND_MODES3["SCREEN"] = 3] = "SCREEN";
    BLEND_MODES3[BLEND_MODES3["OVERLAY"] = 4] = "OVERLAY";
    BLEND_MODES3[BLEND_MODES3["DARKEN"] = 5] = "DARKEN";
    BLEND_MODES3[BLEND_MODES3["LIGHTEN"] = 6] = "LIGHTEN";
    BLEND_MODES3[BLEND_MODES3["COLOR_DODGE"] = 7] = "COLOR_DODGE";
    BLEND_MODES3[BLEND_MODES3["COLOR_BURN"] = 8] = "COLOR_BURN";
    BLEND_MODES3[BLEND_MODES3["HARD_LIGHT"] = 9] = "HARD_LIGHT";
    BLEND_MODES3[BLEND_MODES3["SOFT_LIGHT"] = 10] = "SOFT_LIGHT";
    BLEND_MODES3[BLEND_MODES3["DIFFERENCE"] = 11] = "DIFFERENCE";
    BLEND_MODES3[BLEND_MODES3["EXCLUSION"] = 12] = "EXCLUSION";
    BLEND_MODES3[BLEND_MODES3["HUE"] = 13] = "HUE";
    BLEND_MODES3[BLEND_MODES3["SATURATION"] = 14] = "SATURATION";
    BLEND_MODES3[BLEND_MODES3["COLOR"] = 15] = "COLOR";
    BLEND_MODES3[BLEND_MODES3["LUMINOSITY"] = 16] = "LUMINOSITY";
    BLEND_MODES3[BLEND_MODES3["NORMAL_NPM"] = 17] = "NORMAL_NPM";
    BLEND_MODES3[BLEND_MODES3["ADD_NPM"] = 18] = "ADD_NPM";
    BLEND_MODES3[BLEND_MODES3["SCREEN_NPM"] = 19] = "SCREEN_NPM";
    BLEND_MODES3[BLEND_MODES3["NONE"] = 20] = "NONE";
    BLEND_MODES3[BLEND_MODES3["SRC_OVER"] = 0] = "SRC_OVER";
    BLEND_MODES3[BLEND_MODES3["SRC_IN"] = 21] = "SRC_IN";
    BLEND_MODES3[BLEND_MODES3["SRC_OUT"] = 22] = "SRC_OUT";
    BLEND_MODES3[BLEND_MODES3["SRC_ATOP"] = 23] = "SRC_ATOP";
    BLEND_MODES3[BLEND_MODES3["DST_OVER"] = 24] = "DST_OVER";
    BLEND_MODES3[BLEND_MODES3["DST_IN"] = 25] = "DST_IN";
    BLEND_MODES3[BLEND_MODES3["DST_OUT"] = 26] = "DST_OUT";
    BLEND_MODES3[BLEND_MODES3["DST_ATOP"] = 27] = "DST_ATOP";
    BLEND_MODES3[BLEND_MODES3["ERASE"] = 26] = "ERASE";
    BLEND_MODES3[BLEND_MODES3["SUBTRACT"] = 28] = "SUBTRACT";
    BLEND_MODES3[BLEND_MODES3["XOR"] = 29] = "XOR";
  })(BLEND_MODES2 || (BLEND_MODES2 = {}));
  var DRAW_MODES2;
  (function(DRAW_MODES3) {
    DRAW_MODES3[DRAW_MODES3["POINTS"] = 0] = "POINTS";
    DRAW_MODES3[DRAW_MODES3["LINES"] = 1] = "LINES";
    DRAW_MODES3[DRAW_MODES3["LINE_LOOP"] = 2] = "LINE_LOOP";
    DRAW_MODES3[DRAW_MODES3["LINE_STRIP"] = 3] = "LINE_STRIP";
    DRAW_MODES3[DRAW_MODES3["TRIANGLES"] = 4] = "TRIANGLES";
    DRAW_MODES3[DRAW_MODES3["TRIANGLE_STRIP"] = 5] = "TRIANGLE_STRIP";
    DRAW_MODES3[DRAW_MODES3["TRIANGLE_FAN"] = 6] = "TRIANGLE_FAN";
  })(DRAW_MODES2 || (DRAW_MODES2 = {}));
  var FORMATS2;
  (function(FORMATS3) {
    FORMATS3[FORMATS3["RGBA"] = 6408] = "RGBA";
    FORMATS3[FORMATS3["RGB"] = 6407] = "RGB";
    FORMATS3[FORMATS3["ALPHA"] = 6406] = "ALPHA";
    FORMATS3[FORMATS3["LUMINANCE"] = 6409] = "LUMINANCE";
    FORMATS3[FORMATS3["LUMINANCE_ALPHA"] = 6410] = "LUMINANCE_ALPHA";
    FORMATS3[FORMATS3["DEPTH_COMPONENT"] = 6402] = "DEPTH_COMPONENT";
    FORMATS3[FORMATS3["DEPTH_STENCIL"] = 34041] = "DEPTH_STENCIL";
  })(FORMATS2 || (FORMATS2 = {}));
  var TARGETS2;
  (function(TARGETS3) {
    TARGETS3[TARGETS3["TEXTURE_2D"] = 3553] = "TEXTURE_2D";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP"] = 34067] = "TEXTURE_CUBE_MAP";
    TARGETS3[TARGETS3["TEXTURE_2D_ARRAY"] = 35866] = "TEXTURE_2D_ARRAY";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_X"] = 34069] = "TEXTURE_CUBE_MAP_POSITIVE_X";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_X"] = 34070] = "TEXTURE_CUBE_MAP_NEGATIVE_X";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_Y"] = 34071] = "TEXTURE_CUBE_MAP_POSITIVE_Y";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_Y"] = 34072] = "TEXTURE_CUBE_MAP_NEGATIVE_Y";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_POSITIVE_Z"] = 34073] = "TEXTURE_CUBE_MAP_POSITIVE_Z";
    TARGETS3[TARGETS3["TEXTURE_CUBE_MAP_NEGATIVE_Z"] = 34074] = "TEXTURE_CUBE_MAP_NEGATIVE_Z";
  })(TARGETS2 || (TARGETS2 = {}));
  var TYPES2;
  (function(TYPES3) {
    TYPES3[TYPES3["UNSIGNED_BYTE"] = 5121] = "UNSIGNED_BYTE";
    TYPES3[TYPES3["UNSIGNED_SHORT"] = 5123] = "UNSIGNED_SHORT";
    TYPES3[TYPES3["UNSIGNED_SHORT_5_6_5"] = 33635] = "UNSIGNED_SHORT_5_6_5";
    TYPES3[TYPES3["UNSIGNED_SHORT_4_4_4_4"] = 32819] = "UNSIGNED_SHORT_4_4_4_4";
    TYPES3[TYPES3["UNSIGNED_SHORT_5_5_5_1"] = 32820] = "UNSIGNED_SHORT_5_5_5_1";
    TYPES3[TYPES3["FLOAT"] = 5126] = "FLOAT";
    TYPES3[TYPES3["HALF_FLOAT"] = 36193] = "HALF_FLOAT";
  })(TYPES2 || (TYPES2 = {}));
  var SCALE_MODES2;
  (function(SCALE_MODES3) {
    SCALE_MODES3[SCALE_MODES3["NEAREST"] = 0] = "NEAREST";
    SCALE_MODES3[SCALE_MODES3["LINEAR"] = 1] = "LINEAR";
  })(SCALE_MODES2 || (SCALE_MODES2 = {}));
  var WRAP_MODES2;
  (function(WRAP_MODES3) {
    WRAP_MODES3[WRAP_MODES3["CLAMP"] = 33071] = "CLAMP";
    WRAP_MODES3[WRAP_MODES3["REPEAT"] = 10497] = "REPEAT";
    WRAP_MODES3[WRAP_MODES3["MIRRORED_REPEAT"] = 33648] = "MIRRORED_REPEAT";
  })(WRAP_MODES2 || (WRAP_MODES2 = {}));
  var MIPMAP_MODES2;
  (function(MIPMAP_MODES3) {
    MIPMAP_MODES3[MIPMAP_MODES3["OFF"] = 0] = "OFF";
    MIPMAP_MODES3[MIPMAP_MODES3["POW2"] = 1] = "POW2";
    MIPMAP_MODES3[MIPMAP_MODES3["ON"] = 2] = "ON";
  })(MIPMAP_MODES2 || (MIPMAP_MODES2 = {}));
  var ALPHA_MODES2;
  (function(ALPHA_MODES3) {
    ALPHA_MODES3[ALPHA_MODES3["NPM"] = 0] = "NPM";
    ALPHA_MODES3[ALPHA_MODES3["UNPACK"] = 1] = "UNPACK";
    ALPHA_MODES3[ALPHA_MODES3["PMA"] = 2] = "PMA";
    ALPHA_MODES3[ALPHA_MODES3["NO_PREMULTIPLIED_ALPHA"] = 0] = "NO_PREMULTIPLIED_ALPHA";
    ALPHA_MODES3[ALPHA_MODES3["PREMULTIPLY_ON_UPLOAD"] = 1] = "PREMULTIPLY_ON_UPLOAD";
    ALPHA_MODES3[ALPHA_MODES3["PREMULTIPLY_ALPHA"] = 2] = "PREMULTIPLY_ALPHA";
  })(ALPHA_MODES2 || (ALPHA_MODES2 = {}));
  var CLEAR_MODES2;
  (function(CLEAR_MODES3) {
    CLEAR_MODES3[CLEAR_MODES3["NO"] = 0] = "NO";
    CLEAR_MODES3[CLEAR_MODES3["YES"] = 1] = "YES";
    CLEAR_MODES3[CLEAR_MODES3["AUTO"] = 2] = "AUTO";
    CLEAR_MODES3[CLEAR_MODES3["BLEND"] = 0] = "BLEND";
    CLEAR_MODES3[CLEAR_MODES3["CLEAR"] = 1] = "CLEAR";
    CLEAR_MODES3[CLEAR_MODES3["BLIT"] = 2] = "BLIT";
  })(CLEAR_MODES2 || (CLEAR_MODES2 = {}));
  var GC_MODES2;
  (function(GC_MODES3) {
    GC_MODES3[GC_MODES3["AUTO"] = 0] = "AUTO";
    GC_MODES3[GC_MODES3["MANUAL"] = 1] = "MANUAL";
  })(GC_MODES2 || (GC_MODES2 = {}));
  var PRECISION2;
  (function(PRECISION3) {
    PRECISION3["LOW"] = "lowp";
    PRECISION3["MEDIUM"] = "mediump";
    PRECISION3["HIGH"] = "highp";
  })(PRECISION2 || (PRECISION2 = {}));
  var MASK_TYPES2;
  (function(MASK_TYPES3) {
    MASK_TYPES3[MASK_TYPES3["NONE"] = 0] = "NONE";
    MASK_TYPES3[MASK_TYPES3["SCISSOR"] = 1] = "SCISSOR";
    MASK_TYPES3[MASK_TYPES3["STENCIL"] = 2] = "STENCIL";
    MASK_TYPES3[MASK_TYPES3["SPRITE"] = 3] = "SPRITE";
  })(MASK_TYPES2 || (MASK_TYPES2 = {}));
  var MSAA_QUALITY2;
  (function(MSAA_QUALITY3) {
    MSAA_QUALITY3[MSAA_QUALITY3["NONE"] = 0] = "NONE";
    MSAA_QUALITY3[MSAA_QUALITY3["LOW"] = 2] = "LOW";
    MSAA_QUALITY3[MSAA_QUALITY3["MEDIUM"] = 4] = "MEDIUM";
    MSAA_QUALITY3[MSAA_QUALITY3["HIGH"] = 8] = "HIGH";
  })(MSAA_QUALITY2 || (MSAA_QUALITY2 = {}));
  var BlurFilterPass = function(_super) {
    __extends14(BlurFilterPass2, _super);
    function BlurFilterPass2(horizontal, strength, quality, resolution, kernelSize) {
      if (strength === void 0) {
        strength = 8;
      }
      if (quality === void 0) {
        quality = 4;
      }
      if (resolution === void 0) {
        resolution = settings.FILTER_RESOLUTION;
      }
      if (kernelSize === void 0) {
        kernelSize = 5;
      }
      var _this = this;
      var vertSrc = generateBlurVertSource(kernelSize, horizontal);
      var fragSrc = generateBlurFragSource(kernelSize);
      _this = _super.call(this, vertSrc, fragSrc) || this;
      _this.horizontal = horizontal;
      _this.resolution = resolution;
      _this._quality = 0;
      _this.quality = quality;
      _this.blur = strength;
      return _this;
    }
    BlurFilterPass2.prototype.apply = function(filterManager, input, output, clearMode) {
      if (output) {
        if (this.horizontal) {
          this.uniforms.strength = 1 / output.width * (output.width / input.width);
        } else {
          this.uniforms.strength = 1 / output.height * (output.height / input.height);
        }
      } else {
        if (this.horizontal) {
          this.uniforms.strength = 1 / filterManager.renderer.width * (filterManager.renderer.width / input.width);
        } else {
          this.uniforms.strength = 1 / filterManager.renderer.height * (filterManager.renderer.height / input.height);
        }
      }
      this.uniforms.strength *= this.strength;
      this.uniforms.strength /= this.passes;
      if (this.passes === 1) {
        filterManager.applyFilter(this, input, output, clearMode);
      } else {
        var renderTarget = filterManager.getFilterTexture();
        var renderer = filterManager.renderer;
        var flip = input;
        var flop = renderTarget;
        this.state.blend = false;
        filterManager.applyFilter(this, flip, flop, CLEAR_MODES2.CLEAR);
        for (var i = 1; i < this.passes - 1; i++) {
          filterManager.bindAndClear(flip, CLEAR_MODES2.BLIT);
          this.uniforms.uSampler = flop;
          var temp2 = flop;
          flop = flip;
          flip = temp2;
          renderer.shader.bind(this);
          renderer.geometry.draw(5);
        }
        this.state.blend = true;
        filterManager.applyFilter(this, flop, output, clearMode);
        filterManager.returnFilterTexture(renderTarget);
      }
    };
    Object.defineProperty(BlurFilterPass2.prototype, "blur", {
      get: function() {
        return this.strength;
      },
      set: function(value) {
        this.padding = 1 + Math.abs(value) * 2;
        this.strength = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilterPass2.prototype, "quality", {
      get: function() {
        return this._quality;
      },
      set: function(value) {
        this._quality = value;
        this.passes = value;
      },
      enumerable: false,
      configurable: true
    });
    return BlurFilterPass2;
  }(Filter);
  var BlurFilter = function(_super) {
    __extends14(BlurFilter2, _super);
    function BlurFilter2(strength, quality, resolution, kernelSize) {
      if (strength === void 0) {
        strength = 8;
      }
      if (quality === void 0) {
        quality = 4;
      }
      if (resolution === void 0) {
        resolution = settings.FILTER_RESOLUTION;
      }
      if (kernelSize === void 0) {
        kernelSize = 5;
      }
      var _this = _super.call(this) || this;
      _this.blurXFilter = new BlurFilterPass(true, strength, quality, resolution, kernelSize);
      _this.blurYFilter = new BlurFilterPass(false, strength, quality, resolution, kernelSize);
      _this.resolution = resolution;
      _this.quality = quality;
      _this.blur = strength;
      _this.repeatEdgePixels = false;
      return _this;
    }
    BlurFilter2.prototype.apply = function(filterManager, input, output, clearMode) {
      var xStrength = Math.abs(this.blurXFilter.strength);
      var yStrength = Math.abs(this.blurYFilter.strength);
      if (xStrength && yStrength) {
        var renderTarget = filterManager.getFilterTexture();
        this.blurXFilter.apply(filterManager, input, renderTarget, CLEAR_MODES2.CLEAR);
        this.blurYFilter.apply(filterManager, renderTarget, output, clearMode);
        filterManager.returnFilterTexture(renderTarget);
      } else if (yStrength) {
        this.blurYFilter.apply(filterManager, input, output, clearMode);
      } else {
        this.blurXFilter.apply(filterManager, input, output, clearMode);
      }
    };
    BlurFilter2.prototype.updatePadding = function() {
      if (this._repeatEdgePixels) {
        this.padding = 0;
      } else {
        this.padding = Math.max(Math.abs(this.blurXFilter.strength), Math.abs(this.blurYFilter.strength)) * 2;
      }
    };
    Object.defineProperty(BlurFilter2.prototype, "blur", {
      get: function() {
        return this.blurXFilter.blur;
      },
      set: function(value) {
        this.blurXFilter.blur = this.blurYFilter.blur = value;
        this.updatePadding();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilter2.prototype, "quality", {
      get: function() {
        return this.blurXFilter.quality;
      },
      set: function(value) {
        this.blurXFilter.quality = this.blurYFilter.quality = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilter2.prototype, "blurX", {
      get: function() {
        return this.blurXFilter.blur;
      },
      set: function(value) {
        this.blurXFilter.blur = value;
        this.updatePadding();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilter2.prototype, "blurY", {
      get: function() {
        return this.blurYFilter.blur;
      },
      set: function(value) {
        this.blurYFilter.blur = value;
        this.updatePadding();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilter2.prototype, "blendMode", {
      get: function() {
        return this.blurYFilter.blendMode;
      },
      set: function(value) {
        this.blurYFilter.blendMode = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(BlurFilter2.prototype, "repeatEdgePixels", {
      get: function() {
        return this._repeatEdgePixels;
      },
      set: function(value) {
        this._repeatEdgePixels = value;
        this.updatePadding();
      },
      enumerable: false,
      configurable: true
    });
    return BlurFilter2;
  }(Filter);

  // node_modules/@pixi/filter-color-matrix/lib/filter-color-matrix.es.js
  /*!
   * @pixi/filter-color-matrix - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-color-matrix is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics15 = function(d, b) {
    extendStatics15 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics15(d, b);
  };
  function __extends15(d, b) {
    extendStatics15(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var fragment6 = "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n";
  var ColorMatrixFilter = function(_super) {
    __extends15(ColorMatrixFilter2, _super);
    function ColorMatrixFilter2() {
      var _this = this;
      var uniforms = {
        m: new Float32Array([
          1,
          0,
          0,
          0,
          0,
          0,
          1,
          0,
          0,
          0,
          0,
          0,
          1,
          0,
          0,
          0,
          0,
          0,
          1,
          0
        ]),
        uAlpha: 1
      };
      _this = _super.call(this, defaultFilter, fragment6, uniforms) || this;
      _this.alpha = 1;
      return _this;
    }
    ColorMatrixFilter2.prototype._loadMatrix = function(matrix, multiply) {
      if (multiply === void 0) {
        multiply = false;
      }
      var newMatrix = matrix;
      if (multiply) {
        this._multiply(newMatrix, this.uniforms.m, matrix);
        newMatrix = this._colorMatrix(newMatrix);
      }
      this.uniforms.m = newMatrix;
    };
    ColorMatrixFilter2.prototype._multiply = function(out, a, b) {
      out[0] = a[0] * b[0] + a[1] * b[5] + a[2] * b[10] + a[3] * b[15];
      out[1] = a[0] * b[1] + a[1] * b[6] + a[2] * b[11] + a[3] * b[16];
      out[2] = a[0] * b[2] + a[1] * b[7] + a[2] * b[12] + a[3] * b[17];
      out[3] = a[0] * b[3] + a[1] * b[8] + a[2] * b[13] + a[3] * b[18];
      out[4] = a[0] * b[4] + a[1] * b[9] + a[2] * b[14] + a[3] * b[19] + a[4];
      out[5] = a[5] * b[0] + a[6] * b[5] + a[7] * b[10] + a[8] * b[15];
      out[6] = a[5] * b[1] + a[6] * b[6] + a[7] * b[11] + a[8] * b[16];
      out[7] = a[5] * b[2] + a[6] * b[7] + a[7] * b[12] + a[8] * b[17];
      out[8] = a[5] * b[3] + a[6] * b[8] + a[7] * b[13] + a[8] * b[18];
      out[9] = a[5] * b[4] + a[6] * b[9] + a[7] * b[14] + a[8] * b[19] + a[9];
      out[10] = a[10] * b[0] + a[11] * b[5] + a[12] * b[10] + a[13] * b[15];
      out[11] = a[10] * b[1] + a[11] * b[6] + a[12] * b[11] + a[13] * b[16];
      out[12] = a[10] * b[2] + a[11] * b[7] + a[12] * b[12] + a[13] * b[17];
      out[13] = a[10] * b[3] + a[11] * b[8] + a[12] * b[13] + a[13] * b[18];
      out[14] = a[10] * b[4] + a[11] * b[9] + a[12] * b[14] + a[13] * b[19] + a[14];
      out[15] = a[15] * b[0] + a[16] * b[5] + a[17] * b[10] + a[18] * b[15];
      out[16] = a[15] * b[1] + a[16] * b[6] + a[17] * b[11] + a[18] * b[16];
      out[17] = a[15] * b[2] + a[16] * b[7] + a[17] * b[12] + a[18] * b[17];
      out[18] = a[15] * b[3] + a[16] * b[8] + a[17] * b[13] + a[18] * b[18];
      out[19] = a[15] * b[4] + a[16] * b[9] + a[17] * b[14] + a[18] * b[19] + a[19];
      return out;
    };
    ColorMatrixFilter2.prototype._colorMatrix = function(matrix) {
      var m = new Float32Array(matrix);
      m[4] /= 255;
      m[9] /= 255;
      m[14] /= 255;
      m[19] /= 255;
      return m;
    };
    ColorMatrixFilter2.prototype.brightness = function(b, multiply) {
      var matrix = [
        b,
        0,
        0,
        0,
        0,
        0,
        b,
        0,
        0,
        0,
        0,
        0,
        b,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.greyscale = function(scale, multiply) {
      var matrix = [
        scale,
        scale,
        scale,
        0,
        0,
        scale,
        scale,
        scale,
        0,
        0,
        scale,
        scale,
        scale,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.blackAndWhite = function(multiply) {
      var matrix = [
        0.3,
        0.6,
        0.1,
        0,
        0,
        0.3,
        0.6,
        0.1,
        0,
        0,
        0.3,
        0.6,
        0.1,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.hue = function(rotation, multiply) {
      rotation = (rotation || 0) / 180 * Math.PI;
      var cosR = Math.cos(rotation);
      var sinR = Math.sin(rotation);
      var sqrt = Math.sqrt;
      var w = 1 / 3;
      var sqrW = sqrt(w);
      var a00 = cosR + (1 - cosR) * w;
      var a01 = w * (1 - cosR) - sqrW * sinR;
      var a02 = w * (1 - cosR) + sqrW * sinR;
      var a10 = w * (1 - cosR) + sqrW * sinR;
      var a11 = cosR + w * (1 - cosR);
      var a12 = w * (1 - cosR) - sqrW * sinR;
      var a20 = w * (1 - cosR) - sqrW * sinR;
      var a21 = w * (1 - cosR) + sqrW * sinR;
      var a22 = cosR + w * (1 - cosR);
      var matrix = [
        a00,
        a01,
        a02,
        0,
        0,
        a10,
        a11,
        a12,
        0,
        0,
        a20,
        a21,
        a22,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.contrast = function(amount, multiply) {
      var v = (amount || 0) + 1;
      var o = -0.5 * (v - 1);
      var matrix = [
        v,
        0,
        0,
        0,
        o,
        0,
        v,
        0,
        0,
        o,
        0,
        0,
        v,
        0,
        o,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.saturate = function(amount, multiply) {
      if (amount === void 0) {
        amount = 0;
      }
      var x = amount * 2 / 3 + 1;
      var y = (x - 1) * -0.5;
      var matrix = [
        x,
        y,
        y,
        0,
        0,
        y,
        x,
        y,
        0,
        0,
        y,
        y,
        x,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.desaturate = function() {
      this.saturate(-1);
    };
    ColorMatrixFilter2.prototype.negative = function(multiply) {
      var matrix = [
        -1,
        0,
        0,
        1,
        0,
        0,
        -1,
        0,
        1,
        0,
        0,
        0,
        -1,
        1,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.sepia = function(multiply) {
      var matrix = [
        0.393,
        0.7689999,
        0.18899999,
        0,
        0,
        0.349,
        0.6859999,
        0.16799999,
        0,
        0,
        0.272,
        0.5339999,
        0.13099999,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.technicolor = function(multiply) {
      var matrix = [
        1.9125277891456083,
        -0.8545344976951645,
        -0.09155508482755585,
        0,
        11.793603434377337,
        -0.3087833385928097,
        1.7658908555458428,
        -0.10601743074722245,
        0,
        -70.35205161461398,
        -0.231103377548616,
        -0.7501899197440212,
        1.847597816108189,
        0,
        30.950940869491138,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.polaroid = function(multiply) {
      var matrix = [
        1.438,
        -0.062,
        -0.062,
        0,
        0,
        -0.122,
        1.378,
        -0.122,
        0,
        0,
        -0.016,
        -0.016,
        1.483,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.toBGR = function(multiply) {
      var matrix = [
        0,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.kodachrome = function(multiply) {
      var matrix = [
        1.1285582396593525,
        -0.3967382283601348,
        -0.03992559172921793,
        0,
        63.72958762196502,
        -0.16404339962244616,
        1.0835251566291304,
        -0.05498805115633132,
        0,
        24.732407896706203,
        -0.16786010706155763,
        -0.5603416277695248,
        1.6014850761964943,
        0,
        35.62982807460946,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.browni = function(multiply) {
      var matrix = [
        0.5997023498159715,
        0.34553243048391263,
        -0.2708298674538042,
        0,
        47.43192855600873,
        -0.037703249837783157,
        0.8609577587992641,
        0.15059552388459913,
        0,
        -36.96841498319127,
        0.24113635128153335,
        -0.07441037908422492,
        0.44972182064877153,
        0,
        -7.562075277591283,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.vintage = function(multiply) {
      var matrix = [
        0.6279345635605994,
        0.3202183420819367,
        -0.03965408211312453,
        0,
        9.651285835294123,
        0.02578397704808868,
        0.6441188644374771,
        0.03259127616149294,
        0,
        7.462829176470591,
        0.0466055556782719,
        -0.0851232987247891,
        0.5241648018700465,
        0,
        5.159190588235296,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.colorTone = function(desaturation, toned, lightColor, darkColor, multiply) {
      desaturation = desaturation || 0.2;
      toned = toned || 0.15;
      lightColor = lightColor || 16770432;
      darkColor = darkColor || 3375104;
      var lR = (lightColor >> 16 & 255) / 255;
      var lG = (lightColor >> 8 & 255) / 255;
      var lB = (lightColor & 255) / 255;
      var dR = (darkColor >> 16 & 255) / 255;
      var dG = (darkColor >> 8 & 255) / 255;
      var dB = (darkColor & 255) / 255;
      var matrix = [
        0.3,
        0.59,
        0.11,
        0,
        0,
        lR,
        lG,
        lB,
        desaturation,
        0,
        dR,
        dG,
        dB,
        toned,
        0,
        lR - dR,
        lG - dG,
        lB - dB,
        0,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.night = function(intensity, multiply) {
      intensity = intensity || 0.1;
      var matrix = [
        intensity * -2,
        -intensity,
        0,
        0,
        0,
        -intensity,
        0,
        intensity,
        0,
        0,
        0,
        intensity,
        intensity * 2,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.predator = function(amount, multiply) {
      var matrix = [
        11.224130630493164 * amount,
        -4.794486999511719 * amount,
        -2.8746118545532227 * amount,
        0 * amount,
        0.40342438220977783 * amount,
        -3.6330697536468506 * amount,
        9.193157196044922 * amount,
        -2.951810836791992 * amount,
        0 * amount,
        -1.316135048866272 * amount,
        -3.2184197902679443 * amount,
        -4.2375030517578125 * amount,
        7.476448059082031 * amount,
        0 * amount,
        0.8044459223747253 * amount,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.lsd = function(multiply) {
      var matrix = [
        2,
        -0.4,
        0.5,
        0,
        0,
        -0.5,
        2,
        -0.4,
        0,
        0,
        -0.4,
        -0.5,
        3,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, multiply);
    };
    ColorMatrixFilter2.prototype.reset = function() {
      var matrix = [
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0
      ];
      this._loadMatrix(matrix, false);
    };
    Object.defineProperty(ColorMatrixFilter2.prototype, "matrix", {
      get: function() {
        return this.uniforms.m;
      },
      set: function(value) {
        this.uniforms.m = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(ColorMatrixFilter2.prototype, "alpha", {
      get: function() {
        return this.uniforms.uAlpha;
      },
      set: function(value) {
        this.uniforms.uAlpha = value;
      },
      enumerable: false,
      configurable: true
    });
    return ColorMatrixFilter2;
  }(Filter);
  ColorMatrixFilter.prototype.grayscale = ColorMatrixFilter.prototype.greyscale;

  // node_modules/@pixi/filter-displacement/lib/filter-displacement.es.js
  /*!
   * @pixi/filter-displacement - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-displacement is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics16 = function(d, b) {
    extendStatics16 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics16(d, b);
  };
  function __extends16(d, b) {
    extendStatics16(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var fragment7 = "varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n";
  var vertex5 = "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n	gl_Position = filterVertexPosition();\n	vTextureCoord = filterTextureCoord();\n	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n";
  var DisplacementFilter = function(_super) {
    __extends16(DisplacementFilter2, _super);
    function DisplacementFilter2(sprite, scale) {
      var _this = this;
      var maskMatrix = new Matrix();
      sprite.renderable = false;
      _this = _super.call(this, vertex5, fragment7, {
        mapSampler: sprite._texture,
        filterMatrix: maskMatrix,
        scale: {x: 1, y: 1},
        rotation: new Float32Array([1, 0, 0, 1])
      }) || this;
      _this.maskSprite = sprite;
      _this.maskMatrix = maskMatrix;
      if (scale === null || scale === void 0) {
        scale = 20;
      }
      _this.scale = new Point(scale, scale);
      return _this;
    }
    DisplacementFilter2.prototype.apply = function(filterManager, input, output, clearMode) {
      this.uniforms.filterMatrix = filterManager.calculateSpriteMatrix(this.maskMatrix, this.maskSprite);
      this.uniforms.scale.x = this.scale.x;
      this.uniforms.scale.y = this.scale.y;
      var wt = this.maskSprite.worldTransform;
      var lenX = Math.sqrt(wt.a * wt.a + wt.b * wt.b);
      var lenY = Math.sqrt(wt.c * wt.c + wt.d * wt.d);
      if (lenX !== 0 && lenY !== 0) {
        this.uniforms.rotation[0] = wt.a / lenX;
        this.uniforms.rotation[1] = wt.b / lenX;
        this.uniforms.rotation[2] = wt.c / lenY;
        this.uniforms.rotation[3] = wt.d / lenY;
      }
      filterManager.applyFilter(this, input, output, clearMode);
    };
    Object.defineProperty(DisplacementFilter2.prototype, "map", {
      get: function() {
        return this.uniforms.mapSampler;
      },
      set: function(value) {
        this.uniforms.mapSampler = value;
      },
      enumerable: false,
      configurable: true
    });
    return DisplacementFilter2;
  }(Filter);

  // node_modules/@pixi/filter-fxaa/lib/filter-fxaa.es.js
  /*!
   * @pixi/filter-fxaa - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-fxaa is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics17 = function(d, b) {
    extendStatics17 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics17(d, b);
  };
  function __extends17(d, b) {
    extendStatics17(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var vertex6 = "\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n";
  var fragment8 = `varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputPixel;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;
  var FXAAFilter = function(_super) {
    __extends17(FXAAFilter2, _super);
    function FXAAFilter2() {
      return _super.call(this, vertex6, fragment8) || this;
    }
    return FXAAFilter2;
  }(Filter);

  // node_modules/@pixi/filter-noise/lib/filter-noise.es.js
  /*!
   * @pixi/filter-noise - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/filter-noise is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics18 = function(d, b) {
    extendStatics18 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics18(d, b);
  };
  function __extends18(d, b) {
    extendStatics18(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var fragment9 = "precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n";
  var NoiseFilter = function(_super) {
    __extends18(NoiseFilter2, _super);
    function NoiseFilter2(noise, seed) {
      if (noise === void 0) {
        noise = 0.5;
      }
      if (seed === void 0) {
        seed = Math.random();
      }
      var _this = _super.call(this, defaultFilter, fragment9, {
        uNoise: 0,
        uSeed: 0
      }) || this;
      _this.noise = noise;
      _this.seed = seed;
      return _this;
    }
    Object.defineProperty(NoiseFilter2.prototype, "noise", {
      get: function() {
        return this.uniforms.uNoise;
      },
      set: function(value) {
        this.uniforms.uNoise = value;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NoiseFilter2.prototype, "seed", {
      get: function() {
        return this.uniforms.uSeed;
      },
      set: function(value) {
        this.uniforms.uSeed = value;
      },
      enumerable: false,
      configurable: true
    });
    return NoiseFilter2;
  }(Filter);

  // node_modules/@pixi/mixin-cache-as-bitmap/lib/mixin-cache-as-bitmap.es.js
  /*!
   * @pixi/mixin-cache-as-bitmap - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  var _tempMatrix = new Matrix();
  DisplayObject.prototype._cacheAsBitmap = false;
  DisplayObject.prototype._cacheData = null;
  var CacheData = function() {
    function CacheData2() {
      this.textureCacheId = null;
      this.originalRender = null;
      this.originalRenderCanvas = null;
      this.originalCalculateBounds = null;
      this.originalGetLocalBounds = null;
      this.originalUpdateTransform = null;
      this.originalDestroy = null;
      this.originalMask = null;
      this.originalFilterArea = null;
      this.originalContainsPoint = null;
      this.sprite = null;
    }
    return CacheData2;
  }();
  Object.defineProperties(DisplayObject.prototype, {
    cacheAsBitmap: {
      get: function() {
        return this._cacheAsBitmap;
      },
      set: function(value) {
        if (this._cacheAsBitmap === value) {
          return;
        }
        this._cacheAsBitmap = value;
        var data;
        if (value) {
          if (!this._cacheData) {
            this._cacheData = new CacheData();
          }
          data = this._cacheData;
          data.originalRender = this.render;
          data.originalRenderCanvas = this.renderCanvas;
          data.originalUpdateTransform = this.updateTransform;
          data.originalCalculateBounds = this.calculateBounds;
          data.originalGetLocalBounds = this.getLocalBounds;
          data.originalDestroy = this.destroy;
          data.originalContainsPoint = this.containsPoint;
          data.originalMask = this._mask;
          data.originalFilterArea = this.filterArea;
          this.render = this._renderCached;
          this.renderCanvas = this._renderCachedCanvas;
          this.destroy = this._cacheAsBitmapDestroy;
        } else {
          data = this._cacheData;
          if (data.sprite) {
            this._destroyCachedDisplayObject();
          }
          this.render = data.originalRender;
          this.renderCanvas = data.originalRenderCanvas;
          this.calculateBounds = data.originalCalculateBounds;
          this.getLocalBounds = data.originalGetLocalBounds;
          this.destroy = data.originalDestroy;
          this.updateTransform = data.originalUpdateTransform;
          this.containsPoint = data.originalContainsPoint;
          this._mask = data.originalMask;
          this.filterArea = data.originalFilterArea;
        }
      }
    }
  });
  DisplayObject.prototype._renderCached = function _renderCached(renderer) {
    if (!this.visible || this.worldAlpha <= 0 || !this.renderable) {
      return;
    }
    this._initCachedDisplayObject(renderer);
    this._cacheData.sprite.transform._worldID = this.transform._worldID;
    this._cacheData.sprite.worldAlpha = this.worldAlpha;
    this._cacheData.sprite._render(renderer);
  };
  DisplayObject.prototype._initCachedDisplayObject = function _initCachedDisplayObject(renderer) {
    if (this._cacheData && this._cacheData.sprite) {
      return;
    }
    var cacheAlpha = this.alpha;
    this.alpha = 1;
    renderer.batch.flush();
    var bounds = this.getLocalBounds(null, true).clone();
    if (this.filters) {
      var padding = this.filters[0].padding;
      bounds.pad(padding);
    }
    bounds.ceil(settings.RESOLUTION);
    var cachedRenderTexture = renderer.renderTexture.current;
    var cachedSourceFrame = renderer.renderTexture.sourceFrame.clone();
    var cachedProjectionTransform = renderer.projection.transform;
    var renderTexture = RenderTexture.create({width: bounds.width, height: bounds.height});
    var textureCacheId = "cacheAsBitmap_" + uid();
    this._cacheData.textureCacheId = textureCacheId;
    BaseTexture.addToCache(renderTexture.baseTexture, textureCacheId);
    Texture.addToCache(renderTexture, textureCacheId);
    var m = this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-bounds.x, -bounds.y);
    this.render = this._cacheData.originalRender;
    renderer.render(this, renderTexture, true, m, false);
    renderer.projection.transform = cachedProjectionTransform;
    renderer.renderTexture.bind(cachedRenderTexture, cachedSourceFrame);
    this.render = this._renderCached;
    this.updateTransform = this.displayObjectUpdateTransform;
    this.calculateBounds = this._calculateCachedBounds;
    this.getLocalBounds = this._getCachedLocalBounds;
    this._mask = null;
    this.filterArea = null;
    var cachedSprite = new Sprite(renderTexture);
    cachedSprite.transform.worldTransform = this.transform.worldTransform;
    cachedSprite.anchor.x = -(bounds.x / bounds.width);
    cachedSprite.anchor.y = -(bounds.y / bounds.height);
    cachedSprite.alpha = cacheAlpha;
    cachedSprite._bounds = this._bounds;
    this._cacheData.sprite = cachedSprite;
    this.transform._parentID = -1;
    if (!this.parent) {
      this.enableTempParent();
      this.updateTransform();
      this.disableTempParent(null);
    } else {
      this.updateTransform();
    }
    this.containsPoint = cachedSprite.containsPoint.bind(cachedSprite);
  };
  DisplayObject.prototype._renderCachedCanvas = function _renderCachedCanvas(renderer) {
    if (!this.visible || this.worldAlpha <= 0 || !this.renderable) {
      return;
    }
    this._initCachedDisplayObjectCanvas(renderer);
    this._cacheData.sprite.worldAlpha = this.worldAlpha;
    this._cacheData.sprite._renderCanvas(renderer);
  };
  DisplayObject.prototype._initCachedDisplayObjectCanvas = function _initCachedDisplayObjectCanvas(renderer) {
    if (this._cacheData && this._cacheData.sprite) {
      return;
    }
    var bounds = this.getLocalBounds(null, true);
    var cacheAlpha = this.alpha;
    this.alpha = 1;
    var cachedRenderTarget = renderer.context;
    var cachedProjectionTransform = renderer._projTransform;
    bounds.ceil(settings.RESOLUTION);
    var renderTexture = RenderTexture.create({width: bounds.width, height: bounds.height});
    var textureCacheId = "cacheAsBitmap_" + uid();
    this._cacheData.textureCacheId = textureCacheId;
    BaseTexture.addToCache(renderTexture.baseTexture, textureCacheId);
    Texture.addToCache(renderTexture, textureCacheId);
    var m = _tempMatrix;
    this.transform.localTransform.copyTo(m);
    m.invert();
    m.tx -= bounds.x;
    m.ty -= bounds.y;
    this.renderCanvas = this._cacheData.originalRenderCanvas;
    renderer.render(this, renderTexture, true, m, false);
    renderer.context = cachedRenderTarget;
    renderer._projTransform = cachedProjectionTransform;
    this.renderCanvas = this._renderCachedCanvas;
    this.updateTransform = this.displayObjectUpdateTransform;
    this.calculateBounds = this._calculateCachedBounds;
    this.getLocalBounds = this._getCachedLocalBounds;
    this._mask = null;
    this.filterArea = null;
    var cachedSprite = new Sprite(renderTexture);
    cachedSprite.transform.worldTransform = this.transform.worldTransform;
    cachedSprite.anchor.x = -(bounds.x / bounds.width);
    cachedSprite.anchor.y = -(bounds.y / bounds.height);
    cachedSprite.alpha = cacheAlpha;
    cachedSprite._bounds = this._bounds;
    this._cacheData.sprite = cachedSprite;
    this.transform._parentID = -1;
    if (!this.parent) {
      this.parent = renderer._tempDisplayObjectParent;
      this.updateTransform();
      this.parent = null;
    } else {
      this.updateTransform();
    }
    this.containsPoint = cachedSprite.containsPoint.bind(cachedSprite);
  };
  DisplayObject.prototype._calculateCachedBounds = function _calculateCachedBounds() {
    this._bounds.clear();
    this._cacheData.sprite.transform._worldID = this.transform._worldID;
    this._cacheData.sprite._calculateBounds();
    this._bounds.updateID = this._boundsID;
  };
  DisplayObject.prototype._getCachedLocalBounds = function _getCachedLocalBounds() {
    return this._cacheData.sprite.getLocalBounds(null);
  };
  DisplayObject.prototype._destroyCachedDisplayObject = function _destroyCachedDisplayObject() {
    this._cacheData.sprite._texture.destroy(true);
    this._cacheData.sprite = null;
    BaseTexture.removeFromCache(this._cacheData.textureCacheId);
    Texture.removeFromCache(this._cacheData.textureCacheId);
    this._cacheData.textureCacheId = null;
  };
  DisplayObject.prototype._cacheAsBitmapDestroy = function _cacheAsBitmapDestroy(options) {
    this.cacheAsBitmap = false;
    this.destroy(options);
  };

  // node_modules/@pixi/mixin-get-child-by-name/lib/mixin-get-child-by-name.es.js
  /*!
   * @pixi/mixin-get-child-by-name - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/mixin-get-child-by-name is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  DisplayObject.prototype.name = null;
  Container.prototype.getChildByName = function getChildByName(name, deep) {
    for (var i = 0, j = this.children.length; i < j; i++) {
      if (this.children[i].name === name) {
        return this.children[i];
      }
    }
    if (deep) {
      for (var i = 0, j = this.children.length; i < j; i++) {
        var child = this.children[i];
        if (!child.getChildByName) {
          continue;
        }
        var target = this.children[i].getChildByName(name, true);
        if (target) {
          return target;
        }
      }
    }
    return null;
  };

  // node_modules/@pixi/mixin-get-global-position/lib/mixin-get-global-position.es.js
  /*!
   * @pixi/mixin-get-global-position - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/mixin-get-global-position is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  DisplayObject.prototype.getGlobalPosition = function getGlobalPosition(point, skipUpdate) {
    if (point === void 0) {
      point = new Point();
    }
    if (skipUpdate === void 0) {
      skipUpdate = false;
    }
    if (this.parent) {
      this.parent.toGlobal(this.position, point, skipUpdate);
    } else {
      point.x = this.position.x;
      point.y = this.position.y;
    }
    return point;
  };

  // node_modules/@pixi/mesh-extras/lib/mesh-extras.es.js
  /*!
   * @pixi/mesh-extras - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/mesh-extras is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics19 = function(d, b) {
    extendStatics19 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics19(d, b);
  };
  function __extends19(d, b) {
    extendStatics19(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var PlaneGeometry = function(_super) {
    __extends19(PlaneGeometry2, _super);
    function PlaneGeometry2(width, height, segWidth, segHeight) {
      if (width === void 0) {
        width = 100;
      }
      if (height === void 0) {
        height = 100;
      }
      if (segWidth === void 0) {
        segWidth = 10;
      }
      if (segHeight === void 0) {
        segHeight = 10;
      }
      var _this = _super.call(this) || this;
      _this.segWidth = segWidth;
      _this.segHeight = segHeight;
      _this.width = width;
      _this.height = height;
      _this.build();
      return _this;
    }
    PlaneGeometry2.prototype.build = function() {
      var total = this.segWidth * this.segHeight;
      var verts = [];
      var uvs = [];
      var indices2 = [];
      var segmentsX = this.segWidth - 1;
      var segmentsY = this.segHeight - 1;
      var sizeX = this.width / segmentsX;
      var sizeY = this.height / segmentsY;
      for (var i = 0; i < total; i++) {
        var x = i % this.segWidth;
        var y = i / this.segWidth | 0;
        verts.push(x * sizeX, y * sizeY);
        uvs.push(x / segmentsX, y / segmentsY);
      }
      var totalSub = segmentsX * segmentsY;
      for (var i = 0; i < totalSub; i++) {
        var xpos = i % segmentsX;
        var ypos = i / segmentsX | 0;
        var value = ypos * this.segWidth + xpos;
        var value2 = ypos * this.segWidth + xpos + 1;
        var value3 = (ypos + 1) * this.segWidth + xpos;
        var value4 = (ypos + 1) * this.segWidth + xpos + 1;
        indices2.push(value, value2, value3, value2, value4, value3);
      }
      this.buffers[0].data = new Float32Array(verts);
      this.buffers[1].data = new Float32Array(uvs);
      this.indexBuffer.data = new Uint16Array(indices2);
      this.buffers[0].update();
      this.buffers[1].update();
      this.indexBuffer.update();
    };
    return PlaneGeometry2;
  }(MeshGeometry);
  var RopeGeometry = function(_super) {
    __extends19(RopeGeometry2, _super);
    function RopeGeometry2(width, points, textureScale) {
      if (width === void 0) {
        width = 200;
      }
      if (textureScale === void 0) {
        textureScale = 0;
      }
      var _this = _super.call(this, new Float32Array(points.length * 4), new Float32Array(points.length * 4), new Uint16Array((points.length - 1) * 6)) || this;
      _this.points = points;
      _this._width = width;
      _this.textureScale = textureScale;
      _this.build();
      return _this;
    }
    Object.defineProperty(RopeGeometry2.prototype, "width", {
      get: function() {
        return this._width;
      },
      enumerable: false,
      configurable: true
    });
    RopeGeometry2.prototype.build = function() {
      var points = this.points;
      if (!points) {
        return;
      }
      var vertexBuffer = this.getBuffer("aVertexPosition");
      var uvBuffer = this.getBuffer("aTextureCoord");
      var indexBuffer = this.getIndex();
      if (points.length < 1) {
        return;
      }
      if (vertexBuffer.data.length / 4 !== points.length) {
        vertexBuffer.data = new Float32Array(points.length * 4);
        uvBuffer.data = new Float32Array(points.length * 4);
        indexBuffer.data = new Uint16Array((points.length - 1) * 6);
      }
      var uvs = uvBuffer.data;
      var indices2 = indexBuffer.data;
      uvs[0] = 0;
      uvs[1] = 0;
      uvs[2] = 0;
      uvs[3] = 1;
      var amount = 0;
      var prev = points[0];
      var textureWidth = this._width * this.textureScale;
      var total = points.length;
      for (var i = 0; i < total; i++) {
        var index2 = i * 4;
        if (this.textureScale > 0) {
          var dx = prev.x - points[i].x;
          var dy = prev.y - points[i].y;
          var distance = Math.sqrt(dx * dx + dy * dy);
          prev = points[i];
          amount += distance / textureWidth;
        } else {
          amount = i / (total - 1);
        }
        uvs[index2] = amount;
        uvs[index2 + 1] = 0;
        uvs[index2 + 2] = amount;
        uvs[index2 + 3] = 1;
      }
      var indexCount = 0;
      for (var i = 0; i < total - 1; i++) {
        var index2 = i * 2;
        indices2[indexCount++] = index2;
        indices2[indexCount++] = index2 + 1;
        indices2[indexCount++] = index2 + 2;
        indices2[indexCount++] = index2 + 2;
        indices2[indexCount++] = index2 + 1;
        indices2[indexCount++] = index2 + 3;
      }
      uvBuffer.update();
      indexBuffer.update();
      this.updateVertices();
    };
    RopeGeometry2.prototype.updateVertices = function() {
      var points = this.points;
      if (points.length < 1) {
        return;
      }
      var lastPoint = points[0];
      var nextPoint;
      var perpX = 0;
      var perpY = 0;
      var vertices = this.buffers[0].data;
      var total = points.length;
      for (var i = 0; i < total; i++) {
        var point = points[i];
        var index2 = i * 4;
        if (i < points.length - 1) {
          nextPoint = points[i + 1];
        } else {
          nextPoint = point;
        }
        perpY = -(nextPoint.x - lastPoint.x);
        perpX = nextPoint.y - lastPoint.y;
        var perpLength = Math.sqrt(perpX * perpX + perpY * perpY);
        var num = this.textureScale > 0 ? this.textureScale * this._width / 2 : this._width / 2;
        perpX /= perpLength;
        perpY /= perpLength;
        perpX *= num;
        perpY *= num;
        vertices[index2] = point.x + perpX;
        vertices[index2 + 1] = point.y + perpY;
        vertices[index2 + 2] = point.x - perpX;
        vertices[index2 + 3] = point.y - perpY;
        lastPoint = point;
      }
      this.buffers[0].update();
    };
    RopeGeometry2.prototype.update = function() {
      if (this.textureScale > 0) {
        this.build();
      } else {
        this.updateVertices();
      }
    };
    return RopeGeometry2;
  }(MeshGeometry);
  var SimpleRope = function(_super) {
    __extends19(SimpleRope2, _super);
    function SimpleRope2(texture, points, textureScale) {
      if (textureScale === void 0) {
        textureScale = 0;
      }
      var _this = this;
      var ropeGeometry = new RopeGeometry(texture.height, points, textureScale);
      var meshMaterial = new MeshMaterial(texture);
      if (textureScale > 0) {
        texture.baseTexture.wrapMode = WRAP_MODES.REPEAT;
      }
      _this = _super.call(this, ropeGeometry, meshMaterial) || this;
      _this.autoUpdate = true;
      return _this;
    }
    SimpleRope2.prototype._render = function(renderer) {
      var geometry = this.geometry;
      if (this.autoUpdate || geometry._width !== this.shader.texture.height) {
        geometry._width = this.shader.texture.height;
        geometry.update();
      }
      _super.prototype._render.call(this, renderer);
    };
    return SimpleRope2;
  }(Mesh);
  var SimplePlane = function(_super) {
    __extends19(SimplePlane2, _super);
    function SimplePlane2(texture, verticesX, verticesY) {
      var _this = this;
      var planeGeometry = new PlaneGeometry(texture.width, texture.height, verticesX, verticesY);
      var meshMaterial = new MeshMaterial(Texture.WHITE);
      _this = _super.call(this, planeGeometry, meshMaterial) || this;
      _this.texture = texture;
      return _this;
    }
    SimplePlane2.prototype.textureUpdated = function() {
      this._textureID = this.shader.texture._updateID;
      var geometry = this.geometry;
      geometry.width = this.shader.texture.width;
      geometry.height = this.shader.texture.height;
      geometry.build();
    };
    Object.defineProperty(SimplePlane2.prototype, "texture", {
      get: function() {
        return this.shader.texture;
      },
      set: function(value) {
        if (this.shader.texture === value) {
          return;
        }
        this.shader.texture = value;
        this._textureID = -1;
        if (value.baseTexture.valid) {
          this.textureUpdated();
        } else {
          value.once("update", this.textureUpdated, this);
        }
      },
      enumerable: false,
      configurable: true
    });
    SimplePlane2.prototype._render = function(renderer) {
      if (this._textureID !== this.shader.texture._updateID) {
        this.textureUpdated();
      }
      _super.prototype._render.call(this, renderer);
    };
    SimplePlane2.prototype.destroy = function(options) {
      this.shader.texture.off("update", this.textureUpdated, this);
      _super.prototype.destroy.call(this, options);
    };
    return SimplePlane2;
  }(Mesh);
  var SimpleMesh = function(_super) {
    __extends19(SimpleMesh2, _super);
    function SimpleMesh2(texture, vertices, uvs, indices2, drawMode) {
      if (texture === void 0) {
        texture = Texture.EMPTY;
      }
      var _this = this;
      var geometry = new MeshGeometry(vertices, uvs, indices2);
      geometry.getBuffer("aVertexPosition").static = false;
      var meshMaterial = new MeshMaterial(texture);
      _this = _super.call(this, geometry, meshMaterial, null, drawMode) || this;
      _this.autoUpdate = true;
      return _this;
    }
    Object.defineProperty(SimpleMesh2.prototype, "vertices", {
      get: function() {
        return this.geometry.getBuffer("aVertexPosition").data;
      },
      set: function(value) {
        this.geometry.getBuffer("aVertexPosition").data = value;
      },
      enumerable: false,
      configurable: true
    });
    SimpleMesh2.prototype._render = function(renderer) {
      if (this.autoUpdate) {
        this.geometry.getBuffer("aVertexPosition").update();
      }
      _super.prototype._render.call(this, renderer);
    };
    return SimpleMesh2;
  }(Mesh);
  var DEFAULT_BORDER_SIZE = 10;
  var NineSlicePlane = function(_super) {
    __extends19(NineSlicePlane2, _super);
    function NineSlicePlane2(texture, leftWidth, topHeight, rightWidth, bottomHeight) {
      if (leftWidth === void 0) {
        leftWidth = DEFAULT_BORDER_SIZE;
      }
      if (topHeight === void 0) {
        topHeight = DEFAULT_BORDER_SIZE;
      }
      if (rightWidth === void 0) {
        rightWidth = DEFAULT_BORDER_SIZE;
      }
      if (bottomHeight === void 0) {
        bottomHeight = DEFAULT_BORDER_SIZE;
      }
      var _this = _super.call(this, Texture.WHITE, 4, 4) || this;
      _this._origWidth = texture.orig.width;
      _this._origHeight = texture.orig.height;
      _this._width = _this._origWidth;
      _this._height = _this._origHeight;
      _this._leftWidth = leftWidth;
      _this._rightWidth = rightWidth;
      _this._topHeight = topHeight;
      _this._bottomHeight = bottomHeight;
      _this.texture = texture;
      return _this;
    }
    NineSlicePlane2.prototype.textureUpdated = function() {
      this._textureID = this.shader.texture._updateID;
      this._refresh();
    };
    Object.defineProperty(NineSlicePlane2.prototype, "vertices", {
      get: function() {
        return this.geometry.getBuffer("aVertexPosition").data;
      },
      set: function(value) {
        this.geometry.getBuffer("aVertexPosition").data = value;
      },
      enumerable: false,
      configurable: true
    });
    NineSlicePlane2.prototype.updateHorizontalVertices = function() {
      var vertices = this.vertices;
      var scale = this._getMinScale();
      vertices[9] = vertices[11] = vertices[13] = vertices[15] = this._topHeight * scale;
      vertices[17] = vertices[19] = vertices[21] = vertices[23] = this._height - this._bottomHeight * scale;
      vertices[25] = vertices[27] = vertices[29] = vertices[31] = this._height;
    };
    NineSlicePlane2.prototype.updateVerticalVertices = function() {
      var vertices = this.vertices;
      var scale = this._getMinScale();
      vertices[2] = vertices[10] = vertices[18] = vertices[26] = this._leftWidth * scale;
      vertices[4] = vertices[12] = vertices[20] = vertices[28] = this._width - this._rightWidth * scale;
      vertices[6] = vertices[14] = vertices[22] = vertices[30] = this._width;
    };
    NineSlicePlane2.prototype._getMinScale = function() {
      var w = this._leftWidth + this._rightWidth;
      var scaleW = this._width > w ? 1 : this._width / w;
      var h = this._topHeight + this._bottomHeight;
      var scaleH = this._height > h ? 1 : this._height / h;
      var scale = Math.min(scaleW, scaleH);
      return scale;
    };
    Object.defineProperty(NineSlicePlane2.prototype, "width", {
      get: function() {
        return this._width;
      },
      set: function(value) {
        this._width = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NineSlicePlane2.prototype, "height", {
      get: function() {
        return this._height;
      },
      set: function(value) {
        this._height = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NineSlicePlane2.prototype, "leftWidth", {
      get: function() {
        return this._leftWidth;
      },
      set: function(value) {
        this._leftWidth = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NineSlicePlane2.prototype, "rightWidth", {
      get: function() {
        return this._rightWidth;
      },
      set: function(value) {
        this._rightWidth = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NineSlicePlane2.prototype, "topHeight", {
      get: function() {
        return this._topHeight;
      },
      set: function(value) {
        this._topHeight = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(NineSlicePlane2.prototype, "bottomHeight", {
      get: function() {
        return this._bottomHeight;
      },
      set: function(value) {
        this._bottomHeight = value;
        this._refresh();
      },
      enumerable: false,
      configurable: true
    });
    NineSlicePlane2.prototype._refresh = function() {
      var texture = this.texture;
      var uvs = this.geometry.buffers[1].data;
      this._origWidth = texture.orig.width;
      this._origHeight = texture.orig.height;
      var _uvw = 1 / this._origWidth;
      var _uvh = 1 / this._origHeight;
      uvs[0] = uvs[8] = uvs[16] = uvs[24] = 0;
      uvs[1] = uvs[3] = uvs[5] = uvs[7] = 0;
      uvs[6] = uvs[14] = uvs[22] = uvs[30] = 1;
      uvs[25] = uvs[27] = uvs[29] = uvs[31] = 1;
      uvs[2] = uvs[10] = uvs[18] = uvs[26] = _uvw * this._leftWidth;
      uvs[4] = uvs[12] = uvs[20] = uvs[28] = 1 - _uvw * this._rightWidth;
      uvs[9] = uvs[11] = uvs[13] = uvs[15] = _uvh * this._topHeight;
      uvs[17] = uvs[19] = uvs[21] = uvs[23] = 1 - _uvh * this._bottomHeight;
      this.updateHorizontalVertices();
      this.updateVerticalVertices();
      this.geometry.buffers[0].update();
      this.geometry.buffers[1].update();
    };
    return NineSlicePlane2;
  }(SimplePlane);

  // node_modules/@pixi/sprite-animated/lib/sprite-animated.es.js
  /*!
   * @pixi/sprite-animated - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * @pixi/sprite-animated is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  var extendStatics20 = function(d, b) {
    extendStatics20 = Object.setPrototypeOf || {__proto__: []} instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p in b2) {
        if (b2.hasOwnProperty(p)) {
          d2[p] = b2[p];
        }
      }
    };
    return extendStatics20(d, b);
  };
  function __extends20(d, b) {
    extendStatics20(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  }
  var AnimatedSprite = function(_super) {
    __extends20(AnimatedSprite2, _super);
    function AnimatedSprite2(textures, autoUpdate) {
      if (autoUpdate === void 0) {
        autoUpdate = true;
      }
      var _this = _super.call(this, textures[0] instanceof Texture ? textures[0] : textures[0].texture) || this;
      _this._textures = null;
      _this._durations = null;
      _this._autoUpdate = autoUpdate;
      _this._isConnectedToTicker = false;
      _this.animationSpeed = 1;
      _this.loop = true;
      _this.updateAnchor = false;
      _this.onComplete = null;
      _this.onFrameChange = null;
      _this.onLoop = null;
      _this._currentTime = 0;
      _this._playing = false;
      _this._previousFrame = null;
      _this.textures = textures;
      return _this;
    }
    AnimatedSprite2.prototype.stop = function() {
      if (!this._playing) {
        return;
      }
      this._playing = false;
      if (this._autoUpdate && this._isConnectedToTicker) {
        Ticker.shared.remove(this.update, this);
        this._isConnectedToTicker = false;
      }
    };
    AnimatedSprite2.prototype.play = function() {
      if (this._playing) {
        return;
      }
      this._playing = true;
      if (this._autoUpdate && !this._isConnectedToTicker) {
        Ticker.shared.add(this.update, this, UPDATE_PRIORITY.HIGH);
        this._isConnectedToTicker = true;
      }
    };
    AnimatedSprite2.prototype.gotoAndStop = function(frameNumber) {
      this.stop();
      var previousFrame = this.currentFrame;
      this._currentTime = frameNumber;
      if (previousFrame !== this.currentFrame) {
        this.updateTexture();
      }
    };
    AnimatedSprite2.prototype.gotoAndPlay = function(frameNumber) {
      var previousFrame = this.currentFrame;
      this._currentTime = frameNumber;
      if (previousFrame !== this.currentFrame) {
        this.updateTexture();
      }
      this.play();
    };
    AnimatedSprite2.prototype.update = function(deltaTime) {
      var elapsed = this.animationSpeed * deltaTime;
      var previousFrame = this.currentFrame;
      if (this._durations !== null) {
        var lag = this._currentTime % 1 * this._durations[this.currentFrame];
        lag += elapsed / 60 * 1e3;
        while (lag < 0) {
          this._currentTime--;
          lag += this._durations[this.currentFrame];
        }
        var sign2 = Math.sign(this.animationSpeed * deltaTime);
        this._currentTime = Math.floor(this._currentTime);
        while (lag >= this._durations[this.currentFrame]) {
          lag -= this._durations[this.currentFrame] * sign2;
          this._currentTime += sign2;
        }
        this._currentTime += lag / this._durations[this.currentFrame];
      } else {
        this._currentTime += elapsed;
      }
      if (this._currentTime < 0 && !this.loop) {
        this.gotoAndStop(0);
        if (this.onComplete) {
          this.onComplete();
        }
      } else if (this._currentTime >= this._textures.length && !this.loop) {
        this.gotoAndStop(this._textures.length - 1);
        if (this.onComplete) {
          this.onComplete();
        }
      } else if (previousFrame !== this.currentFrame) {
        if (this.loop && this.onLoop) {
          if (this.animationSpeed > 0 && this.currentFrame < previousFrame) {
            this.onLoop();
          } else if (this.animationSpeed < 0 && this.currentFrame > previousFrame) {
            this.onLoop();
          }
        }
        this.updateTexture();
      }
    };
    AnimatedSprite2.prototype.updateTexture = function() {
      var currentFrame = this.currentFrame;
      if (this._previousFrame === currentFrame) {
        return;
      }
      this._previousFrame = currentFrame;
      this._texture = this._textures[currentFrame];
      this._textureID = -1;
      this._textureTrimmedID = -1;
      this._cachedTint = 16777215;
      this.uvs = this._texture._uvs.uvsFloat32;
      if (this.updateAnchor) {
        this._anchor.copyFrom(this._texture.defaultAnchor);
      }
      if (this.onFrameChange) {
        this.onFrameChange(this.currentFrame);
      }
    };
    AnimatedSprite2.prototype.destroy = function(options) {
      this.stop();
      _super.prototype.destroy.call(this, options);
      this.onComplete = null;
      this.onFrameChange = null;
      this.onLoop = null;
    };
    AnimatedSprite2.fromFrames = function(frames) {
      var textures = [];
      for (var i = 0; i < frames.length; ++i) {
        textures.push(Texture.from(frames[i]));
      }
      return new AnimatedSprite2(textures);
    };
    AnimatedSprite2.fromImages = function(images) {
      var textures = [];
      for (var i = 0; i < images.length; ++i) {
        textures.push(Texture.from(images[i]));
      }
      return new AnimatedSprite2(textures);
    };
    Object.defineProperty(AnimatedSprite2.prototype, "totalFrames", {
      get: function() {
        return this._textures.length;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AnimatedSprite2.prototype, "textures", {
      get: function() {
        return this._textures;
      },
      set: function(value) {
        if (value[0] instanceof Texture) {
          this._textures = value;
          this._durations = null;
        } else {
          this._textures = [];
          this._durations = [];
          for (var i = 0; i < value.length; i++) {
            this._textures.push(value[i].texture);
            this._durations.push(value[i].time);
          }
        }
        this._previousFrame = null;
        this.gotoAndStop(0);
        this.updateTexture();
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AnimatedSprite2.prototype, "currentFrame", {
      get: function() {
        var currentFrame = Math.floor(this._currentTime) % this._textures.length;
        if (currentFrame < 0) {
          currentFrame += this._textures.length;
        }
        return currentFrame;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AnimatedSprite2.prototype, "playing", {
      get: function() {
        return this._playing;
      },
      enumerable: false,
      configurable: true
    });
    Object.defineProperty(AnimatedSprite2.prototype, "autoUpdate", {
      get: function() {
        return this._autoUpdate;
      },
      set: function(value) {
        if (value !== this._autoUpdate) {
          this._autoUpdate = value;
          if (!this._autoUpdate && this._isConnectedToTicker) {
            Ticker.shared.remove(this.update, this);
            this._isConnectedToTicker = false;
          } else if (this._autoUpdate && !this._isConnectedToTicker && this._playing) {
            Ticker.shared.add(this.update, this);
            this._isConnectedToTicker = true;
          }
        }
      },
      enumerable: false,
      configurable: true
    });
    return AnimatedSprite2;
  }(Sprite);

  // node_modules/pixi.js/lib/pixi.es.js
  /*!
   * pixi.js - v5.3.7
   * Compiled Tue, 29 Dec 2020 19:30:11 UTC
   *
   * pixi.js is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */
  /*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
  Renderer.registerPlugin("accessibility", AccessibilityManager);
  Renderer.registerPlugin("extract", Extract);
  Renderer.registerPlugin("interaction", InteractionManager);
  Renderer.registerPlugin("particle", ParticleRenderer);
  Renderer.registerPlugin("prepare", Prepare);
  Renderer.registerPlugin("batch", BatchRenderer);
  Renderer.registerPlugin("tilingSprite", TilingSpriteRenderer);
  Loader2.registerPlugin(BitmapFontLoader);
  Loader2.registerPlugin(SpritesheetLoader);
  Application.registerPlugin(TickerPlugin);
  Application.registerPlugin(AppLoaderPlugin);

  // src/client/InputManager.ts
  var keys = new Set();
  var Key = class extends utils_es_exports.EventEmitter {
    constructor(id) {
      super();
      this.id = id;
      this._pressedAt = 0;
      this._isPressed = false;
      keys.add(this);
    }
    get isPressed() {
      return this._isPressed;
    }
    get duration() {
      if (!this._isPressed)
        return 0;
      return Date.now() - this._pressedAt;
    }
    handle(event, action) {
      this.emit(action, event, this.duration);
      if (action === "down" || action === "keypressed") {
        this._isPressed = true;
        this._pressedAt = Date.now();
      } else {
        this._isPressed = false;
      }
    }
    on(event, fn, context2) {
      super.on(event, fn, context2);
      return this;
    }
    once(event, fn, context2) {
      super.once(event, fn, context2);
      return this;
    }
    isMineEvent(event) {
      if (typeof this.id === "string")
        return event.key === this.id;
      return event.keyCode === this.id;
    }
  };
  var Q = new Key("q");
  var D = new Key("d");
  var up = new Key("ArrowUp");
  var left = new Key("ArrowLeft");
  var right = new Key("ArrowRight");
  var down = new Key("ArrowDown");
  var space = new Key(" ");
  document.addEventListener("keydown", (event) => {
    keys.forEach((key) => {
      if (key.isMineEvent(event))
        key.handle(event, "down");
    });
  });
  document.addEventListener("keyup", (event) => {
    keys.forEach((key) => {
      if (key.isMineEvent(event))
        key.handle(event, "up");
    });
  });
  document.addEventListener("keypress", (event) => {
    keys.forEach((key) => {
      if (key.isMineEvent(event))
        key.handle(event, "keypressed");
    });
  });

  // src/utils/collisionsUtils.ts
  var Rectangle2 = class extends Rectangle {
    constructor(x, y, width, height, anchor) {
      super(x, y, width, height);
      this.anchor = anchor != null ? anchor : new Point();
      this.halfWidth = width / 2;
      this.halfHeight = height / 2;
      this.xAnchorOffset = this.width * this.anchor.x;
      this.yAnchorOffset = this.height * this.anchor.y;
    }
    static fromSprite(sprite) {
      return new Rectangle2(sprite.x, sprite.y, sprite.getBounds().width, sprite.getBounds().height);
    }
  };
  function isRectangleCollapse(rectangle1, rectangle2) {
    const rect1 = Rectangle2.fromSprite(rectangle1);
    const rect2 = Rectangle2.fromSprite(rectangle2);
    return rect1.x < rect2.x + rect2.width && rect1.x + rect1.width > rect2.x && rect1.y < rect2.y + rect2.height && rect1.height + rect1.y > rect2.y;
  }
  function manageRectangleCollisions(rectangle1, rectangle2) {
    const rect1 = Rectangle2.fromSprite(rectangle1);
    const rect2 = Rectangle2.fromSprite(rectangle2);
    const vx2 = rect1.x + Math.abs(rect1.halfWidth) - rect1.xAnchorOffset - (rect2.x + Math.abs(rect2.halfWidth) - rect2.xAnchorOffset);
    const vy2 = rect1.y + Math.abs(rect1.halfHeight) - rect1.yAnchorOffset - (rect2.y + Math.abs(rect2.halfHeight) - rect2.yAnchorOffset);
    const combinedHalfWidths = Math.abs(rect1.halfWidth) + Math.abs(rect2.halfWidth);
    const combinedHalfHeights = Math.abs(rect1.halfHeight) + Math.abs(rect2.halfHeight);
    let collision, overlapX, overlapY;
    if (Math.abs(vx2) < combinedHalfWidths) {
      if (Math.abs(vy2) < combinedHalfHeights) {
        overlapX = combinedHalfWidths - Math.abs(vx2);
        overlapY = combinedHalfHeights - Math.abs(vy2);
        if (overlapX >= overlapY) {
          if (vy2 > 0) {
            collision = "top";
            rect1.y = rect1.y + overlapY;
          } else {
            collision = "bottom";
            rect1.y = rect1.y - overlapY;
          }
        } else {
          if (vx2 > 0) {
            collision = "left";
            rect1.x = rect1.x + overlapX;
          } else {
            collision = "right";
            rect1.x = rect1.x - overlapX;
          }
        }
      }
    }
    return collision;
  }

  // src/entity/Entity.ts
  var Entity = class extends Sprite {
    constructor(texture, options) {
      var _a2, _b;
      let textureName;
      if (typeof texture === "string") {
        textureName = texture;
        texture = Loader2.shared.resources[texture].texture;
      }
      if (!texture)
        throw new Error(`Texture '${textureName}' not found.`);
      super(texture);
      this.setup();
      this.velocity = new Point(0, 0);
      this.hasGravity = (_a2 = options == null ? void 0 : options.hasGravity) != null ? _a2 : false;
      this.mass = (_b = options == null ? void 0 : options.mass) != null ? _b : 1;
      this.canFall = true;
      this.isOnGround = false;
      this.on("update", () => this.update());
    }
    update() {
      if (!this.canFall)
        this.velocity.y = 0;
      else if (this.hasGravity)
        this.velocity.y += 0.1;
      this.position.x += this.velocity.x;
      this.position.y += this.velocity.y;
      if (this.isOnGround)
        this.emit("onGround");
    }
    destroy(options) {
      super.destroy(options);
    }
  };
  var Entity_default = Entity;

  // src/entity/WallEntity.ts
  var WallEntity = class extends Entity_default {
    constructor(options) {
      super(Texture.WHITE, {
        mass: 1e3
      });
      this.position.set(options.x, options.y);
      this.width = options.width;
      this.height = options.height;
    }
    setup() {
    }
  };
  var WallEntity_default = WallEntity;

  // src/entity/Player.ts
  var Player = class extends Entity_default {
    constructor() {
      super("player", {
        hasGravity: true
      });
    }
    setup() {
    }
    update() {
      super.update();
      const walls = actualScene.children.filter((entity) => entity instanceof WallEntity_default);
      if (this.isOnGround) {
        if (Q.isPressed && this.velocity.x > -5)
          this.move(new Point(-1, 0), 1.7);
        if (D.isPressed && this.velocity.x < 5)
          this.move(new Point(1, 0), 1.7);
      } else {
        if (Q.isPressed && this.velocity.x > -5)
          this.move(new Point(-1, 0), 0.55);
        if (D.isPressed && this.velocity.x < 5)
          this.move(new Point(1, 0), 0.55);
        this.velocity.x *= 0.92;
      }
      if (space.isPressed && !this.canFall) {
        this.move(new Point(0, -1), 2.5);
        this.position.y += this.velocity.y;
      }
      if (walls.every((wall) => !isRectangleCollapse(this, wall))) {
        this.canFall = true;
        this.isOnGround = false;
      }
      walls.forEach((wall) => {
        if (isRectangleCollapse(this, wall)) {
          switch (manageRectangleCollisions(wall, this)) {
            case "bottom":
              this.move(new Point(this.velocity.x / 10, 1), 2);
              break;
            case "top":
              this.canFall = false;
              this.move(new Point(-this.velocity.x / 5, 1), 2);
              this.isOnGround = true;
              break;
            case "left":
            case "right":
              this.move(new Point(-this.velocity.x, 0), 1);
              break;
          }
        }
      });
    }
    move(direction, speed) {
      this.velocity.x += direction.x * speed;
      this.velocity.y += direction.y * speed;
    }
  };
  var Player_default = Player;

  // src/scenes/Scene.ts
  var Scene = class extends Container {
    constructor() {
      super();
      this.setup();
    }
    update() {
      this.children.forEach((child) => {
        if (child instanceof Entity_default)
          child.emit("update");
      });
    }
    destroy() {
      super.destroy();
      this.background.destroy();
    }
    addWall(options) {
      this.addChild(new WallEntity_default(options));
    }
  };
  var Scene_default = Scene;

  // src/scenes/ChamberScene.ts
  var ChamberScene = class extends Scene_default {
    spawnPlayer(position) {
      this.player = new Player_default();
      this.addChild(this.player);
      this.player.position.set(position.x, position.y);
    }
  };
  var ChamberScene_default = ChamberScene;

  // src/scenes/TestChamber.ts
  var TestChamber = class extends ChamberScene_default {
    constructor() {
      super();
    }
    setup() {
      this.spawnPlayer({
        x: 1600,
        y: 500
      });
      this.background = Sprite.from(Loader2.shared.resources["testChamberBackground"].texture);
      this.background.zIndex = -1e3;
      this.addChild(this.background);
    }
  };
  var TestChamber_default = TestChamber;

  // src/app.ts
  var actualScene;
  var app = new Application({
    antialias: true,
    resizeTo: window,
    backgroundColor: 14540253
  });
  async function loadTextures() {
    await new Promise((resolve) => {
      Loader2.shared.add("test", "assets/test.png");
      Loader2.shared.add("player", "assets/player.png");
      Loader2.shared.add("testChamberBackground", "assets/test level.png");
      Loader2.shared.load(resolve);
    });
  }
  function tests() {
    Loader2.shared.onComplete.add(() => {
      const sprite = Sprite.from(Loader2.shared.resources["test"].texture);
      sprite.position.set(window.innerWidth / 2, window.innerHeight / 2);
      app.stage.addChild(sprite);
    });
    Ticker.shared.add(() => {
      actualScene == null ? void 0 : actualScene.update();
    }, void 0, UPDATE_PRIORITY.HIGH);
    setScene(new TestChamber_default());
  }
  function setScene(scene) {
    actualScene = scene;
    app.stage.addChild(actualScene);
  }
  loadTextures().then(() => {
    tests();
  });
  document.body.appendChild(app.view);
})();
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibm9kZV9tb2R1bGVzL2VzNi1wcm9taXNlLXBvbHlmaWxsL3Byb21pc2UuanMiLCAibm9kZV9tb2R1bGVzL29iamVjdC1hc3NpZ24vaW5kZXguanMiLCAibm9kZV9tb2R1bGVzL2V2ZW50ZW1pdHRlcjMvaW5kZXguanMiLCAibm9kZV9tb2R1bGVzL2VhcmN1dC9zcmMvZWFyY3V0LmpzIiwgIm5vZGVfbW9kdWxlcy9wdW55Y29kZS9wdW55Y29kZS5qcyIsICJub2RlX21vZHVsZXMvdXJsL3V0aWwuanMiLCAibm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nL2RlY29kZS5qcyIsICJub2RlX21vZHVsZXMvcXVlcnlzdHJpbmcvZW5jb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9xdWVyeXN0cmluZy9pbmRleC5qcyIsICJub2RlX21vZHVsZXMvdXJsL3VybC5qcyIsICJub2RlX21vZHVsZXMvcGFyc2UtdXJpL2luZGV4LmpzIiwgIm5vZGVfbW9kdWxlcy9taW5pLXNpZ25hbHMvbGliL21pbmktc2lnbmFscy5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvcG9seWZpbGwvc3JjL1Byb21pc2UudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3BvbHlmaWxsL3NyYy9PYmplY3QuYXNzaWduLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wb2x5ZmlsbC9zcmMvcmVxdWVzdEFuaW1hdGlvbkZyYW1lLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wb2x5ZmlsbC9zcmMvTWF0aC5zaWduLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wb2x5ZmlsbC9zcmMvTnVtYmVyLmlzSW50ZWdlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvcG9seWZpbGwvc3JjL2luZGV4LnRzIiwgIm5vZGVfbW9kdWxlcy9pc21vYmlsZWpzL3NyYy9pc01vYmlsZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvc2V0dGluZ3Mvc3JjL3V0aWxzL2lzTW9iaWxlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9zZXR0aW5ncy9zcmMvdXRpbHMvbWF4UmVjb21tZW5kZWRUZXh0dXJlcy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvc2V0dGluZ3Mvc3JjL3V0aWxzL2NhblVwbG9hZFNhbWVCdWZmZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3NldHRpbmdzL3NyYy9zZXR0aW5ncy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29uc3RhbnRzL3NyYy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL3NldHRpbmdzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS91dGlscy9zcmMvYnJvd3Nlci9oZWxsby50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2Jyb3dzZXIvaXNXZWJHTFN1cHBvcnRlZC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2NvbG9yL2hleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2NvbG9yL3ByZW11bHRpcGx5LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS91dGlscy9zcmMvZGF0YS9jcmVhdGVJbmRpY2VzRm9yUXVhZHMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9kYXRhL2dldEJ1ZmZlclR5cGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9kYXRhL2ludGVybGVhdmVUeXBlZEFycmF5cy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2RhdGEvcG93Mi50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2RhdGEvcmVtb3ZlSXRlbXMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9kYXRhL3NpZ24udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9kYXRhL3VpZC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdXRpbHMvc3JjL2xvZ2dpbmcvZGVwcmVjYXRpb24udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9tZWRpYS9jYWNoZXMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9tZWRpYS9DYW52YXNSZW5kZXJUYXJnZXQudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9tZWRpYS90cmltQ2FudmFzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS91dGlscy9zcmMvY29uc3QudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9uZXR3b3JrL2RlY29tcG9zZURhdGFVcmkudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9uZXR3b3JrL2RldGVybWluZUNyb3NzT3JpZ2luLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS91dGlscy9zcmMvbmV0d29yay9nZXRSZXNvbHV0aW9uT2ZVcmwudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3V0aWxzL3NyYy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWF0aC9zcmMvY29uc3QudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL3NoYXBlcy9SZWN0YW5nbGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL3NoYXBlcy9DaXJjbGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL3NoYXBlcy9FbGxpcHNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tYXRoL3NyYy9zaGFwZXMvUG9seWdvbi50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWF0aC9zcmMvc2hhcGVzL1JvdW5kZWRSZWN0YW5nbGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL0lQb2ludERhdGEudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL0lQb2ludC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWF0aC9zcmMvUG9pbnQudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL09ic2VydmFibGVQb2ludC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWF0aC9zcmMvTWF0cml4LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tYXRoL3NyYy9ncm91cEQ4LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tYXRoL3NyYy9UcmFuc2Zvcm0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21hdGgvc3JjL2luZGV4LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9kaXNwbGF5L3NyYy9zZXR0aW5ncy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZGlzcGxheS9zcmMvQm91bmRzLnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9kaXNwbGF5L3NyYy9EaXNwbGF5T2JqZWN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9kaXNwbGF5L3NyYy9Db250YWluZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2FjY2Vzc2liaWxpdHkvc3JjL2FjY2Vzc2libGVUYXJnZXQudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2FjY2Vzc2liaWxpdHkvc3JjL0FjY2Vzc2liaWxpdHlNYW5hZ2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90aWNrZXIvc3JjL3NldHRpbmdzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90aWNrZXIvc3JjL2NvbnN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90aWNrZXIvc3JjL1RpY2tlckxpc3RlbmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90aWNrZXIvc3JjL1RpY2tlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdGlja2VyL3NyYy9UaWNrZXJQbHVnaW4udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ludGVyYWN0aW9uL3NyYy9JbnRlcmFjdGlvbkRhdGEudHMiLCAibm9kZV9tb2R1bGVzL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ludGVyYWN0aW9uL3NyYy9JbnRlcmFjdGlvbkV2ZW50LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9pbnRlcmFjdGlvbi9zcmMvSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ludGVyYWN0aW9uL3NyYy9UcmVlU2VhcmNoLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9pbnRlcmFjdGlvbi9zcmMvaW50ZXJhY3RpdmVUYXJnZXQudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ludGVyYWN0aW9uL3NyYy9JbnRlcmFjdGlvbk1hbmFnZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3J1bm5lci9zcmMvUnVubmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zZXR0aW5ncy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvcmVzb3VyY2VzL2F1dG9EZXRlY3RSZXNvdXJjZS50cyIsICJub2RlX21vZHVsZXMvbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvcmVzb3VyY2VzL1Jlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvQnVmZmVyUmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL0Jhc2VUZXh0dXJlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvQWJzdHJhY3RNdWx0aVJlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvQXJyYXlSZXNvdXJjZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvcmVzb3VyY2VzL0Jhc2VJbWFnZVJlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvQ2FudmFzUmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL3Jlc291cmNlcy9DdWJlUmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL3Jlc291cmNlcy9JbWFnZVJlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvU1ZHUmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL3Jlc291cmNlcy9WaWRlb1Jlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9yZXNvdXJjZXMvSW1hZ2VCaXRtYXBSZXNvdXJjZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvcmVzb3VyY2VzL2luZGV4LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9TeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL3Jlc291cmNlcy9EZXB0aFJlc291cmNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9mcmFtZWJ1ZmZlci9GcmFtZWJ1ZmZlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvcmVuZGVyVGV4dHVyZS9CYXNlUmVuZGVyVGV4dHVyZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvVGV4dHVyZVV2cy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvVGV4dHVyZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvcmVuZGVyVGV4dHVyZS9SZW5kZXJUZXh0dXJlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9yZW5kZXJUZXh0dXJlL1JlbmRlclRleHR1cmVQb29sLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9nZW9tZXRyeS9BdHRyaWJ1dGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2dlb21ldHJ5L0J1ZmZlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvZ2VvbWV0cnkvdXRpbHMvZ2V0QnVmZmVyVHlwZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvZ2VvbWV0cnkvdXRpbHMvaW50ZXJsZWF2ZVR5cGVkQXJyYXlzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9nZW9tZXRyeS9HZW9tZXRyeS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdXRpbHMvUXVhZC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdXRpbHMvUXVhZFV2LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zaGFkZXIvVW5pZm9ybUdyb3VwLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9maWx0ZXJzL0ZpbHRlclN0YXRlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9maWx0ZXJzL0ZpbHRlclN5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvYmF0Y2gvT2JqZWN0UmVuZGVyZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2JhdGNoL0JhdGNoU3lzdGVtLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9jb250ZXh0L0NvbnRleHRTeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2ZyYW1lYnVmZmVyL0dMRnJhbWVidWZmZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2ZyYW1lYnVmZmVyL0ZyYW1lYnVmZmVyU3lzdGVtLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9nZW9tZXRyeS9HTEJ1ZmZlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvZ2VvbWV0cnkvR2VvbWV0cnlTeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL21hc2svTWFza0RhdGEudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3NoYWRlci91dGlscy9jb21waWxlUHJvZ3JhbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL3V0aWxzL2RlZmF1bHRWYWx1ZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL3V0aWxzL2dldFRlc3RDb250ZXh0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zaGFkZXIvdXRpbHMvZ2V0TWF4RnJhZ21lbnRQcmVjaXNpb24udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3NoYWRlci91dGlscy9zZXRQcmVjaXNpb24udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3NoYWRlci91dGlscy9tYXBTaXplLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zaGFkZXIvdXRpbHMvbWFwVHlwZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL3V0aWxzL3VuaWZvcm1QYXJzZXJzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zaGFkZXIvdXRpbHMvZ2VuZXJhdGVVbmlmb3Jtc1N5bmMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3NoYWRlci91dGlscy9jaGVja01heElmU3RhdGVtZW50c0luU2hhZGVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zaGFkZXIvdXRpbHMvdW5zYWZlRXZhbFN1cHBvcnRlZC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL1Byb2dyYW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3NoYWRlci9TaGFkZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3N0YXRlL1N0YXRlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9maWx0ZXJzL0ZpbHRlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvVGV4dHVyZU1hdHJpeC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvZmlsdGVycy9zcHJpdGVNYXNrL1Nwcml0ZU1hc2tGaWx0ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL21hc2svTWFza1N5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvbWFzay9BYnN0cmFjdE1hc2tTeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL21hc2svU2Npc3NvclN5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvbWFzay9TdGVuY2lsU3lzdGVtLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9wcm9qZWN0aW9uL1Byb2plY3Rpb25TeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZVN5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL0dMUHJvZ3JhbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc2hhZGVyL1NoYWRlclN5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvc3RhdGUvdXRpbHMvbWFwV2ViR0xCbGVuZE1vZGVzVG9QaXhpLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9zdGF0ZS9TdGF0ZVN5c3RlbS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvdGV4dHVyZXMvVGV4dHVyZUdDU3lzdGVtLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy90ZXh0dXJlcy9HTFRleHR1cmUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3RleHR1cmVzL1RleHR1cmVTeXN0ZW0udHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL3N5c3RlbXMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL0Fic3RyYWN0UmVuZGVyZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL1JlbmRlcmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9hdXRvRGV0ZWN0UmVuZGVyZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2JhdGNoL0JhdGNoRHJhd0NhbGwudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2NvcmUvc3JjL2JhdGNoL0JhdGNoVGV4dHVyZUFycmF5LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9nZW9tZXRyeS9WaWV3YWJsZUJ1ZmZlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvYmF0Y2gvQWJzdHJhY3RCYXRjaFJlbmRlcmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9jb3JlL3NyYy9iYXRjaC9CYXRjaFNoYWRlckdlbmVyYXRvci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvYmF0Y2gvQmF0Y2hHZW9tZXRyeS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvY29yZS9zcmMvYmF0Y2gvQmF0Y2hQbHVnaW5GYWN0b3J5LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9hcHAvc3JjL0FwcGxpY2F0aW9uLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9hcHAvc3JjL1Jlc2l6ZVBsdWdpbi50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvYXBwL3NyYy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZXh0cmFjdC9zcmMvRXh0cmFjdC50cyIsICJub2RlX21vZHVsZXMvcmVzb3VyY2UtbG9hZGVyL3NyYy9hc3luYy5qcyIsICJub2RlX21vZHVsZXMvcmVzb3VyY2UtbG9hZGVyL3NyYy9taWRkbGV3YXJlL2NhY2hpbmcuanMiLCAibm9kZV9tb2R1bGVzL3Jlc291cmNlLWxvYWRlci9zcmMvUmVzb3VyY2UuanMiLCAibm9kZV9tb2R1bGVzL3Jlc291cmNlLWxvYWRlci9zcmMvZW5jb2RlQmluYXJ5LmpzIiwgIm5vZGVfbW9kdWxlcy9yZXNvdXJjZS1sb2FkZXIvc3JjL21pZGRsZXdhcmUvcGFyc2luZy5qcyIsICJub2RlX21vZHVsZXMvcmVzb3VyY2UtbG9hZGVyL3NyYy9taWRkbGV3YXJlL2luZGV4LmpzIiwgIm5vZGVfbW9kdWxlcy9yZXNvdXJjZS1sb2FkZXIvc3JjL0xvYWRlci5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvbG9hZGVycy9zcmMvTG9hZGVyUmVzb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2xvYWRlcnMvc3JjL1RleHR1cmVMb2FkZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2xvYWRlcnMvc3JjL0xvYWRlci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbG9hZGVycy9zcmMvQXBwTG9hZGVyUGx1Z2luLnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wYXJ0aWNsZXMvc3JjL1BhcnRpY2xlQ29udGFpbmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wYXJ0aWNsZXMvc3JjL1BhcnRpY2xlQnVmZmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wYXJ0aWNsZXMvc3JjL1BhcnRpY2xlUmVuZGVyZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2dyYXBoaWNzL3NyYy9jb25zdC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3N0eWxlcy9GaWxsU3R5bGUudHMiLCAibm9kZV9tb2R1bGVzL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2dyYXBoaWNzL3NyYy91dGlscy9idWlsZFBvbHkudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2dyYXBoaWNzL3NyYy91dGlscy9idWlsZENpcmNsZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3V0aWxzL2J1aWxkUmVjdGFuZ2xlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvdXRpbHMvYnVpbGRSb3VuZGVkUmVjdGFuZ2xlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvdXRpbHMvYnVpbGRMaW5lLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvdXRpbHMvU3Rhci50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3V0aWxzL0FyY1V0aWxzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvdXRpbHMvQmV6aWVyVXRpbHMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2dyYXBoaWNzL3NyYy91dGlscy9RdWFkcmF0aWNVdGlscy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3V0aWxzL0JhdGNoUGFydC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3V0aWxzL2luZGV4LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvR3JhcGhpY3NEYXRhLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9ncmFwaGljcy9zcmMvR3JhcGhpY3NHZW9tZXRyeS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZ3JhcGhpY3Mvc3JjL3N0eWxlcy9MaW5lU3R5bGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2dyYXBoaWNzL3NyYy9HcmFwaGljcy50cyIsICJub2RlX21vZHVsZXMvbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvc3ByaXRlL3NyYy9TcHJpdGUudHMiLCAibm9kZV9tb2R1bGVzL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3RleHQvc3JjL2NvbnN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0L3NyYy9UZXh0U3R5bGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3RleHQvc3JjL1RleHRNZXRyaWNzLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0L3NyYy9UZXh0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wcmVwYXJlL3NyYy9zZXR0aW5ncy50cyIsICJub2RlX21vZHVsZXMvbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvcHJlcGFyZS9zcmMvQ291bnRMaW1pdGVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9wcmVwYXJlL3NyYy9CYXNlUHJlcGFyZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvcHJlcGFyZS9zcmMvUHJlcGFyZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvcHJlcGFyZS9zcmMvVGltZUxpbWl0ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3Nwcml0ZXNoZWV0L3NyYy9TcHJpdGVzaGVldC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvc3ByaXRlc2hlZXQvc3JjL1Nwcml0ZXNoZWV0TG9hZGVyLnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9zcHJpdGUtdGlsaW5nL3NyYy9UaWxpbmdTcHJpdGUudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3Nwcml0ZS10aWxpbmcvc3JjL1RpbGluZ1Nwcml0ZVJlbmRlcmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tZXNoL3NyYy9NZXNoQmF0Y2hVdnMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21lc2gvc3JjL01lc2gudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21lc2gvc3JjL01lc2hNYXRlcmlhbC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWVzaC9zcmMvTWVzaEdlb21ldHJ5LnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0LWJpdG1hcC9zcmMvQml0bWFwRm9udERhdGEudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3RleHQtYml0bWFwL3NyYy9mb3JtYXRzL1RleHRGb3JtYXQudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3RleHQtYml0bWFwL3NyYy9mb3JtYXRzL1hNTEZvcm1hdC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdGV4dC1iaXRtYXAvc3JjL2Zvcm1hdHMvWE1MU3RyaW5nRm9ybWF0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0LWJpdG1hcC9zcmMvZm9ybWF0cy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdGV4dC1iaXRtYXAvc3JjL3V0aWxzL2dlbmVyYXRlRmlsbFN0eWxlLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0LWJpdG1hcC9zcmMvdXRpbHMvZHJhd0dseXBoLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0LWJpdG1hcC9zcmMvdXRpbHMvcmVzb2x2ZUNoYXJhY3RlcnMudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL3RleHQtYml0bWFwL3NyYy9CaXRtYXBGb250LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS90ZXh0LWJpdG1hcC9zcmMvQml0bWFwVGV4dC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvdGV4dC1iaXRtYXAvc3JjL0JpdG1hcEZvbnRMb2FkZXIudHMiLCAibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvZmlsdGVyLWFscGhhL3NyYy9BbHBoYUZpbHRlci50cyIsICJub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9maWx0ZXItYmx1ci9zcmMvZ2VuZXJhdGVCbHVyVmVydFNvdXJjZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZmlsdGVyLWJsdXIvc3JjL2dlbmVyYXRlQmx1ckZyYWdTb3VyY2UudHMiLCAibm9kZV9tb2R1bGVzL2NvbnN0YW50cy9zcmMvaW5kZXgudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ZpbHRlci1ibHVyL3NyYy9CbHVyRmlsdGVyUGFzcy50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvZmlsdGVyLWJsdXIvc3JjL0JsdXJGaWx0ZXIudHMiLCAibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvZmlsdGVyLWNvbG9yLW1hdHJpeC9zcmMvQ29sb3JNYXRyaXhGaWx0ZXIudHMiLCAibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsICJub2RlX21vZHVsZXMvQHBpeGkvZmlsdGVyLWRpc3BsYWNlbWVudC9zcmMvRGlzcGxhY2VtZW50RmlsdGVyLnRzIiwgIm5vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ZpbHRlci1meGFhL3NyYy9GWEFBRmlsdGVyLnRzIiwgIm5vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL2ZpbHRlci1ub2lzZS9zcmMvTm9pc2VGaWx0ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21peGluLWNhY2hlLWFzLWJpdG1hcC9zcmMvaW5kZXgudHMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21peGluLWdldC1jaGlsZC1ieS1uYW1lL3NyYy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWl4aW4tZ2V0LWdsb2JhbC1wb3NpdGlvbi9zcmMvaW5kZXgudHMiLCAibm9kZV9tb2R1bGVzL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL0BwaXhpL21lc2gtZXh0cmFzL3NyYy9nZW9tZXRyeS9QbGFuZUdlb21ldHJ5LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tZXNoLWV4dHJhcy9zcmMvZ2VvbWV0cnkvUm9wZUdlb21ldHJ5LnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tZXNoLWV4dHJhcy9zcmMvU2ltcGxlUm9wZS50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWVzaC1leHRyYXMvc3JjL1NpbXBsZVBsYW5lLnRzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9tZXNoLWV4dHJhcy9zcmMvU2ltcGxlTWVzaC50cyIsICJub2RlX21vZHVsZXMvQHBpeGkvbWVzaC1leHRyYXMvc3JjL05pbmVTbGljZVBsYW5lLnRzIiwgIm5vZGVfbW9kdWxlcy9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AcGl4aS9zcHJpdGUtYW5pbWF0ZWQvc3JjL0FuaW1hdGVkU3ByaXRlLnRzIiwgIm5vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCAibm9kZV9tb2R1bGVzL3BpeGkuanMvc3JjL3VzZURlcHJlY2F0ZWQudHMiLCAibm9kZV9tb2R1bGVzL3BpeGkuanMvc3JjL2luZGV4LnRzIiwgInNyYy9jbGllbnQvSW5wdXRNYW5hZ2VyLnRzIiwgInNyYy91dGlscy9jb2xsaXNpb25zVXRpbHMudHMiLCAic3JjL2VudGl0eS9FbnRpdHkudHMiLCAic3JjL2VudGl0eS9XYWxsRW50aXR5LnRzIiwgInNyYy9lbnRpdHkvUGxheWVyLnRzIiwgInNyYy9zY2VuZXMvU2NlbmUudHMiLCAic3JjL3NjZW5lcy9DaGFtYmVyU2NlbmUudHMiLCAic3JjL3NjZW5lcy9UZXN0Q2hhbWJlci50cyIsICJzcmMvYXBwLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIoZnVuY3Rpb24oZ2xvYmFsKXtcblxuLy9cbi8vIENoZWNrIGZvciBuYXRpdmUgUHJvbWlzZSBhbmQgaXQgaGFzIGNvcnJlY3QgaW50ZXJmYWNlXG4vL1xuXG52YXIgTmF0aXZlUHJvbWlzZSA9IGdsb2JhbFsnUHJvbWlzZSddO1xudmFyIG5hdGl2ZVByb21pc2VTdXBwb3J0ZWQgPVxuICBOYXRpdmVQcm9taXNlICYmXG4gIC8vIFNvbWUgb2YgdGhlc2UgbWV0aG9kcyBhcmUgbWlzc2luZyBmcm9tXG4gIC8vIEZpcmVmb3gvQ2hyb21lIGV4cGVyaW1lbnRhbCBpbXBsZW1lbnRhdGlvbnNcbiAgJ3Jlc29sdmUnIGluIE5hdGl2ZVByb21pc2UgJiZcbiAgJ3JlamVjdCcgaW4gTmF0aXZlUHJvbWlzZSAmJlxuICAnYWxsJyBpbiBOYXRpdmVQcm9taXNlICYmXG4gICdyYWNlJyBpbiBOYXRpdmVQcm9taXNlICYmXG4gIC8vIE9sZGVyIHZlcnNpb24gb2YgdGhlIHNwZWMgaGFkIGEgcmVzb2x2ZXIgb2JqZWN0XG4gIC8vIGFzIHRoZSBhcmcgcmF0aGVyIHRoYW4gYSBmdW5jdGlvblxuICAoZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVzb2x2ZTtcbiAgICBuZXcgTmF0aXZlUHJvbWlzZShmdW5jdGlvbihyKXsgcmVzb2x2ZSA9IHI7IH0pO1xuICAgIHJldHVybiB0eXBlb2YgcmVzb2x2ZSA9PT0gJ2Z1bmN0aW9uJztcbiAgfSkoKTtcblxuXG4vL1xuLy8gZXhwb3J0IGlmIG5lY2Vzc2FyeVxuLy9cblxuaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJyAmJiBleHBvcnRzKVxue1xuICAvLyBub2RlLmpzXG4gIGV4cG9ydHMuUHJvbWlzZSA9IG5hdGl2ZVByb21pc2VTdXBwb3J0ZWQgPyBOYXRpdmVQcm9taXNlIDogUHJvbWlzZTtcbiAgZXhwb3J0cy5Qb2x5ZmlsbCA9IFByb21pc2U7XG59XG5lbHNlXG57XG4gIC8vIEFNRFxuICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG4gIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBuYXRpdmVQcm9taXNlU3VwcG9ydGVkID8gTmF0aXZlUHJvbWlzZSA6IFByb21pc2U7XG4gICAgfSk7XG4gIH1cbiAgZWxzZVxuICB7XG4gICAgLy8gaW4gYnJvd3NlciBhZGQgdG8gZ2xvYmFsXG4gICAgaWYgKCFuYXRpdmVQcm9taXNlU3VwcG9ydGVkKVxuICAgICAgZ2xvYmFsWydQcm9taXNlJ10gPSBQcm9taXNlO1xuICB9XG59XG5cblxuLy9cbi8vIFBvbHlmaWxsXG4vL1xuXG52YXIgUEVORElORyA9ICdwZW5kaW5nJztcbnZhciBTRUFMRUQgPSAnc2VhbGVkJztcbnZhciBGVUxGSUxMRUQgPSAnZnVsZmlsbGVkJztcbnZhciBSRUpFQ1RFRCA9ICdyZWplY3RlZCc7XG52YXIgTk9PUCA9IGZ1bmN0aW9uKCl7fTtcblxuZnVuY3Rpb24gaXNBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn1cblxuLy8gYXN5bmMgY2FsbHNcbnZhciBhc3luY1NldFRpbWVyID0gdHlwZW9mIHNldEltbWVkaWF0ZSAhPT0gJ3VuZGVmaW5lZCcgPyBzZXRJbW1lZGlhdGUgOiBzZXRUaW1lb3V0O1xudmFyIGFzeW5jUXVldWUgPSBbXTtcbnZhciBhc3luY1RpbWVyO1xuXG5mdW5jdGlvbiBhc3luY0ZsdXNoKCl7XG4gIC8vIHJ1biBwcm9taXNlIGNhbGxiYWNrc1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFzeW5jUXVldWUubGVuZ3RoOyBpKyspXG4gICAgYXN5bmNRdWV1ZVtpXVswXShhc3luY1F1ZXVlW2ldWzFdKTtcblxuICAvLyByZXNldCBhc3luYyBhc3luY1F1ZXVlXG4gIGFzeW5jUXVldWUgPSBbXTtcbiAgYXN5bmNUaW1lciA9IGZhbHNlO1xufVxuXG5mdW5jdGlvbiBhc3luY0NhbGwoY2FsbGJhY2ssIGFyZyl7XG4gIGFzeW5jUXVldWUucHVzaChbY2FsbGJhY2ssIGFyZ10pO1xuXG4gIGlmICghYXN5bmNUaW1lcilcbiAge1xuICAgIGFzeW5jVGltZXIgPSB0cnVlO1xuICAgIGFzeW5jU2V0VGltZXIoYXN5bmNGbHVzaCwgMCk7XG4gIH1cbn1cblxuXG5mdW5jdGlvbiBpbnZva2VSZXNvbHZlcihyZXNvbHZlciwgcHJvbWlzZSkge1xuICBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWx1ZSkge1xuICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVqZWN0UHJvbWlzZShyZWFzb24pIHtcbiAgICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgcmVzb2x2ZXIocmVzb2x2ZVByb21pc2UsIHJlamVjdFByb21pc2UpO1xuICB9IGNhdGNoKGUpIHtcbiAgICByZWplY3RQcm9taXNlKGUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGludm9rZUNhbGxiYWNrKHN1YnNjcmliZXIpe1xuICB2YXIgb3duZXIgPSBzdWJzY3JpYmVyLm93bmVyO1xuICB2YXIgc2V0dGxlZCA9IG93bmVyLnN0YXRlXztcbiAgdmFyIHZhbHVlID0gb3duZXIuZGF0YV87ICBcbiAgdmFyIGNhbGxiYWNrID0gc3Vic2NyaWJlcltzZXR0bGVkXTtcbiAgdmFyIHByb21pc2UgPSBzdWJzY3JpYmVyLnRoZW47XG5cbiAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJylcbiAge1xuICAgIHNldHRsZWQgPSBGVUxGSUxMRUQ7XG4gICAgdHJ5IHtcbiAgICAgIHZhbHVlID0gY2FsbGJhY2sodmFsdWUpO1xuICAgIH0gY2F0Y2goZSkge1xuICAgICAgcmVqZWN0KHByb21pc2UsIGUpO1xuICAgIH1cbiAgfVxuXG4gIGlmICghaGFuZGxlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUpKVxuICB7XG4gICAgaWYgKHNldHRsZWQgPT09IEZVTEZJTExFRClcbiAgICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuXG4gICAgaWYgKHNldHRsZWQgPT09IFJFSkVDVEVEKVxuICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVUaGVuYWJsZShwcm9taXNlLCB2YWx1ZSkge1xuICB2YXIgcmVzb2x2ZWQ7XG5cbiAgdHJ5IHtcbiAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuJyk7XG5cbiAgICBpZiAodmFsdWUgJiYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSlcbiAgICB7XG4gICAgICB2YXIgdGhlbiA9IHZhbHVlLnRoZW47ICAvLyB0aGVuIHNob3VsZCBiZSByZXRyaXZlZCBvbmx5IG9uY2VcblxuICAgICAgaWYgKHR5cGVvZiB0aGVuID09PSAnZnVuY3Rpb24nKVxuICAgICAge1xuICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgaWYgKCFyZXNvbHZlZClcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZXNvbHZlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdmFsKVxuICAgICAgICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbCk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgICAgICAgaWYgKCFyZXNvbHZlZClcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZXNvbHZlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKCFyZXNvbHZlZClcbiAgICAgIHJlamVjdChwcm9taXNlLCBlKTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiByZXNvbHZlKHByb21pc2UsIHZhbHVlKXtcbiAgaWYgKHByb21pc2UgPT09IHZhbHVlIHx8ICFoYW5kbGVUaGVuYWJsZShwcm9taXNlLCB2YWx1ZSkpXG4gICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpe1xuICBpZiAocHJvbWlzZS5zdGF0ZV8gPT09IFBFTkRJTkcpXG4gIHtcbiAgICBwcm9taXNlLnN0YXRlXyA9IFNFQUxFRDtcbiAgICBwcm9taXNlLmRhdGFfID0gdmFsdWU7XG5cbiAgICBhc3luY0NhbGwocHVibGlzaEZ1bGZpbGxtZW50LCBwcm9taXNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWplY3QocHJvbWlzZSwgcmVhc29uKXtcbiAgaWYgKHByb21pc2Uuc3RhdGVfID09PSBQRU5ESU5HKVxuICB7XG4gICAgcHJvbWlzZS5zdGF0ZV8gPSBTRUFMRUQ7XG4gICAgcHJvbWlzZS5kYXRhXyA9IHJlYXNvbjtcblxuICAgIGFzeW5jQ2FsbChwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwdWJsaXNoKHByb21pc2UpIHtcbiAgdmFyIGNhbGxiYWNrcyA9IHByb21pc2UudGhlbl87XG4gIHByb21pc2UudGhlbl8gPSB1bmRlZmluZWQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICBpbnZva2VDYWxsYmFjayhjYWxsYmFja3NbaV0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hGdWxmaWxsbWVudChwcm9taXNlKXtcbiAgcHJvbWlzZS5zdGF0ZV8gPSBGVUxGSUxMRUQ7XG4gIHB1Ymxpc2gocHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSl7XG4gIHByb21pc2Uuc3RhdGVfID0gUkVKRUNURUQ7XG4gIHB1Ymxpc2gocHJvbWlzZSk7XG59XG5cbi8qKlxuKiBAY2xhc3NcbiovXG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKXtcbiAgaWYgKHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJylcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9taXNlIGNvbnN0cnVjdG9yIHRha2VzIGEgZnVuY3Rpb24gYXJndW1lbnQnKTtcblxuICBpZiAodGhpcyBpbnN0YW5jZW9mIFByb21pc2UgPT09IGZhbHNlKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZhaWxlZCB0byBjb25zdHJ1Y3QgXFwnUHJvbWlzZVxcJzogUGxlYXNlIHVzZSB0aGUgXFwnbmV3XFwnIG9wZXJhdG9yLCB0aGlzIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uJyk7XG5cbiAgdGhpcy50aGVuXyA9IFtdO1xuXG4gIGludm9rZVJlc29sdmVyKHJlc29sdmVyLCB0aGlzKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBQcm9taXNlLFxuXG4gIHN0YXRlXzogUEVORElORyxcbiAgdGhlbl86IG51bGwsXG4gIGRhdGFfOiB1bmRlZmluZWQsXG5cbiAgdGhlbjogZnVuY3Rpb24ob25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pe1xuICAgIHZhciBzdWJzY3JpYmVyID0ge1xuICAgICAgb3duZXI6IHRoaXMsXG4gICAgICB0aGVuOiBuZXcgdGhpcy5jb25zdHJ1Y3RvcihOT09QKSxcbiAgICAgIGZ1bGZpbGxlZDogb25GdWxmaWxsbWVudCxcbiAgICAgIHJlamVjdGVkOiBvblJlamVjdGlvblxuICAgIH07XG5cbiAgICBpZiAodGhpcy5zdGF0ZV8gPT09IEZVTEZJTExFRCB8fCB0aGlzLnN0YXRlXyA9PT0gUkVKRUNURUQpXG4gICAge1xuICAgICAgLy8gYWxyZWFkeSByZXNvbHZlZCwgY2FsbCBjYWxsYmFjayBhc3luY1xuICAgICAgYXN5bmNDYWxsKGludm9rZUNhbGxiYWNrLCBzdWJzY3JpYmVyKTtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgIC8vIHN1YnNjcmliZVxuICAgICAgdGhpcy50aGVuXy5wdXNoKHN1YnNjcmliZXIpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWJzY3JpYmVyLnRoZW47XG4gIH0sXG5cbiAgJ2NhdGNoJzogZnVuY3Rpb24ob25SZWplY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0aW9uKTtcbiAgfVxufTtcblxuUHJvbWlzZS5hbGwgPSBmdW5jdGlvbihwcm9taXNlcyl7XG4gIHZhciBDbGFzcyA9IHRoaXM7XG5cbiAgaWYgKCFpc0FycmF5KHByb21pc2VzKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIFByb21pc2UuYWxsKCkuJyk7XG5cbiAgcmV0dXJuIG5ldyBDbGFzcyhmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIHJlbWFpbmluZyA9IDA7XG5cbiAgICBmdW5jdGlvbiByZXNvbHZlcihpbmRleCl7XG4gICAgICByZW1haW5pbmcrKztcbiAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHJlc3VsdHNbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgIGlmICghLS1yZW1haW5pbmcpXG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDAsIHByb21pc2U7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKylcbiAgICB7XG4gICAgICBwcm9taXNlID0gcHJvbWlzZXNbaV07XG5cbiAgICAgIGlmIChwcm9taXNlICYmIHR5cGVvZiBwcm9taXNlLnRoZW4gPT09ICdmdW5jdGlvbicpXG4gICAgICAgIHByb21pc2UudGhlbihyZXNvbHZlcihpKSwgcmVqZWN0KTtcbiAgICAgIGVsc2VcbiAgICAgICAgcmVzdWx0c1tpXSA9IHByb21pc2U7XG4gICAgfVxuXG4gICAgaWYgKCFyZW1haW5pbmcpXG4gICAgICByZXNvbHZlKHJlc3VsdHMpO1xuICB9KTtcbn07XG5cblByb21pc2UucmFjZSA9IGZ1bmN0aW9uKHByb21pc2VzKXtcbiAgdmFyIENsYXNzID0gdGhpcztcblxuICBpZiAoIWlzQXJyYXkocHJvbWlzZXMpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gUHJvbWlzZS5yYWNlKCkuJyk7XG5cbiAgcmV0dXJuIG5ldyBDbGFzcyhmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgcHJvbWlzZTsgaSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKVxuICAgIHtcbiAgICAgIHByb21pc2UgPSBwcm9taXNlc1tpXTtcblxuICAgICAgaWYgKHByb21pc2UgJiYgdHlwZW9mIHByb21pc2UudGhlbiA9PT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgcHJvbWlzZS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICBlbHNlXG4gICAgICAgIHJlc29sdmUocHJvbWlzZSk7XG4gICAgfVxuICB9KTtcbn07XG5cblByb21pc2UucmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgdmFyIENsYXNzID0gdGhpcztcblxuICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZS5jb25zdHJ1Y3RvciA9PT0gQ2xhc3MpXG4gICAgcmV0dXJuIHZhbHVlO1xuXG4gIHJldHVybiBuZXcgQ2xhc3MoZnVuY3Rpb24ocmVzb2x2ZSl7XG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG4gIH0pO1xufTtcblxuUHJvbWlzZS5yZWplY3QgPSBmdW5jdGlvbihyZWFzb24pe1xuICB2YXIgQ2xhc3MgPSB0aGlzO1xuXG4gIHJldHVybiBuZXcgQ2xhc3MoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG59O1xuXG59KSh0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMpO1xuIiwgIi8qXG5vYmplY3QtYXNzaWduXG4oYykgU2luZHJlIFNvcmh1c1xuQGxpY2Vuc2UgTUlUXG4qL1xuXG4ndXNlIHN0cmljdCc7XG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtdmFycyAqL1xudmFyIGdldE93blByb3BlcnR5U3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIHByb3BJc0VudW1lcmFibGUgPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xuXG5mdW5jdGlvbiB0b09iamVjdCh2YWwpIHtcblx0aWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZCkge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5hc3NpZ24gY2Fubm90IGJlIGNhbGxlZCB3aXRoIG51bGwgb3IgdW5kZWZpbmVkJyk7XG5cdH1cblxuXHRyZXR1cm4gT2JqZWN0KHZhbCk7XG59XG5cbmZ1bmN0aW9uIHNob3VsZFVzZU5hdGl2ZSgpIHtcblx0dHJ5IHtcblx0XHRpZiAoIU9iamVjdC5hc3NpZ24pIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBEZXRlY3QgYnVnZ3kgcHJvcGVydHkgZW51bWVyYXRpb24gb3JkZXIgaW4gb2xkZXIgVjggdmVyc2lvbnMuXG5cblx0XHQvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD00MTE4XG5cdFx0dmFyIHRlc3QxID0gbmV3IFN0cmluZygnYWJjJyk7ICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldy13cmFwcGVyc1xuXHRcdHRlc3QxWzVdID0gJ2RlJztcblx0XHRpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGVzdDEpWzBdID09PSAnNScpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD0zMDU2XG5cdFx0dmFyIHRlc3QyID0ge307XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG5cdFx0XHR0ZXN0MlsnXycgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGkpXSA9IGk7XG5cdFx0fVxuXHRcdHZhciBvcmRlcjIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0ZXN0MikubWFwKGZ1bmN0aW9uIChuKSB7XG5cdFx0XHRyZXR1cm4gdGVzdDJbbl07XG5cdFx0fSk7XG5cdFx0aWYgKG9yZGVyMi5qb2luKCcnKSAhPT0gJzAxMjM0NTY3ODknKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MzA1NlxuXHRcdHZhciB0ZXN0MyA9IHt9O1xuXHRcdCdhYmNkZWZnaGlqa2xtbm9wcXJzdCcuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24gKGxldHRlcikge1xuXHRcdFx0dGVzdDNbbGV0dGVyXSA9IGxldHRlcjtcblx0XHR9KTtcblx0XHRpZiAoT2JqZWN0LmtleXMoT2JqZWN0LmFzc2lnbih7fSwgdGVzdDMpKS5qb2luKCcnKSAhPT1cblx0XHRcdFx0J2FiY2RlZmdoaWprbG1ub3BxcnN0Jykge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHQvLyBXZSBkb24ndCBleHBlY3QgYW55IG9mIHRoZSBhYm92ZSB0byB0aHJvdywgYnV0IGJldHRlciB0byBiZSBzYWZlLlxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHNob3VsZFVzZU5hdGl2ZSgpID8gT2JqZWN0LmFzc2lnbiA6IGZ1bmN0aW9uICh0YXJnZXQsIHNvdXJjZSkge1xuXHR2YXIgZnJvbTtcblx0dmFyIHRvID0gdG9PYmplY3QodGFyZ2V0KTtcblx0dmFyIHN5bWJvbHM7XG5cblx0Zm9yICh2YXIgcyA9IDE7IHMgPCBhcmd1bWVudHMubGVuZ3RoOyBzKyspIHtcblx0XHRmcm9tID0gT2JqZWN0KGFyZ3VtZW50c1tzXSk7XG5cblx0XHRmb3IgKHZhciBrZXkgaW4gZnJvbSkge1xuXHRcdFx0aWYgKGhhc093blByb3BlcnR5LmNhbGwoZnJvbSwga2V5KSkge1xuXHRcdFx0XHR0b1trZXldID0gZnJvbVtrZXldO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChnZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcblx0XHRcdHN5bWJvbHMgPSBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZnJvbSk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN5bWJvbHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKHByb3BJc0VudW1lcmFibGUuY2FsbChmcm9tLCBzeW1ib2xzW2ldKSkge1xuXHRcdFx0XHRcdHRvW3N5bWJvbHNbaV1dID0gZnJvbVtzeW1ib2xzW2ldXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiB0bztcbn07XG4iLCAiJ3VzZSBzdHJpY3QnO1xuXG52YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eVxuICAsIHByZWZpeCA9ICd+JztcblxuLyoqXG4gKiBDb25zdHJ1Y3RvciB0byBjcmVhdGUgYSBzdG9yYWdlIGZvciBvdXIgYEVFYCBvYmplY3RzLlxuICogQW4gYEV2ZW50c2AgaW5zdGFuY2UgaXMgYSBwbGFpbiBvYmplY3Qgd2hvc2UgcHJvcGVydGllcyBhcmUgZXZlbnQgbmFtZXMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBFdmVudHMoKSB7fVxuXG4vL1xuLy8gV2UgdHJ5IHRvIG5vdCBpbmhlcml0IGZyb20gYE9iamVjdC5wcm90b3R5cGVgLiBJbiBzb21lIGVuZ2luZXMgY3JlYXRpbmcgYW5cbi8vIGluc3RhbmNlIGluIHRoaXMgd2F5IGlzIGZhc3RlciB0aGFuIGNhbGxpbmcgYE9iamVjdC5jcmVhdGUobnVsbClgIGRpcmVjdGx5LlxuLy8gSWYgYE9iamVjdC5jcmVhdGUobnVsbClgIGlzIG5vdCBzdXBwb3J0ZWQgd2UgcHJlZml4IHRoZSBldmVudCBuYW1lcyB3aXRoIGFcbi8vIGNoYXJhY3RlciB0byBtYWtlIHN1cmUgdGhhdCB0aGUgYnVpbHQtaW4gb2JqZWN0IHByb3BlcnRpZXMgYXJlIG5vdFxuLy8gb3ZlcnJpZGRlbiBvciB1c2VkIGFzIGFuIGF0dGFjayB2ZWN0b3IuXG4vL1xuaWYgKE9iamVjdC5jcmVhdGUpIHtcbiAgRXZlbnRzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgLy9cbiAgLy8gVGhpcyBoYWNrIGlzIG5lZWRlZCBiZWNhdXNlIHRoZSBgX19wcm90b19fYCBwcm9wZXJ0eSBpcyBzdGlsbCBpbmhlcml0ZWQgaW5cbiAgLy8gc29tZSBvbGQgYnJvd3NlcnMgbGlrZSBBbmRyb2lkIDQsIGlQaG9uZSA1LjEsIE9wZXJhIDExIGFuZCBTYWZhcmkgNS5cbiAgLy9cbiAgaWYgKCFuZXcgRXZlbnRzKCkuX19wcm90b19fKSBwcmVmaXggPSBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRhdGlvbiBvZiBhIHNpbmdsZSBldmVudCBsaXN0ZW5lci5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgbGlzdGVuZXIgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyp9IGNvbnRleHQgVGhlIGNvbnRleHQgdG8gaW52b2tlIHRoZSBsaXN0ZW5lciB3aXRoLlxuICogQHBhcmFtIHtCb29sZWFufSBbb25jZT1mYWxzZV0gU3BlY2lmeSBpZiB0aGUgbGlzdGVuZXIgaXMgYSBvbmUtdGltZSBsaXN0ZW5lci5cbiAqIEBjb25zdHJ1Y3RvclxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gRUUoZm4sIGNvbnRleHQsIG9uY2UpIHtcbiAgdGhpcy5mbiA9IGZuO1xuICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICB0aGlzLm9uY2UgPSBvbmNlIHx8IGZhbHNlO1xufVxuXG4vKipcbiAqIEFkZCBhIGxpc3RlbmVyIGZvciBhIGdpdmVuIGV2ZW50LlxuICpcbiAqIEBwYXJhbSB7RXZlbnRFbWl0dGVyfSBlbWl0dGVyIFJlZmVyZW5jZSB0byB0aGUgYEV2ZW50RW1pdHRlcmAgaW5zdGFuY2UuXG4gKiBAcGFyYW0geyhTdHJpbmd8U3ltYm9sKX0gZXZlbnQgVGhlIGV2ZW50IG5hbWUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgbGlzdGVuZXIgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyp9IGNvbnRleHQgVGhlIGNvbnRleHQgdG8gaW52b2tlIHRoZSBsaXN0ZW5lciB3aXRoLlxuICogQHBhcmFtIHtCb29sZWFufSBvbmNlIFNwZWNpZnkgaWYgdGhlIGxpc3RlbmVyIGlzIGEgb25lLXRpbWUgbGlzdGVuZXIuXG4gKiBAcmV0dXJucyB7RXZlbnRFbWl0dGVyfVxuICogQHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gYWRkTGlzdGVuZXIoZW1pdHRlciwgZXZlbnQsIGZuLCBjb250ZXh0LCBvbmNlKSB7XG4gIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gIH1cblxuICB2YXIgbGlzdGVuZXIgPSBuZXcgRUUoZm4sIGNvbnRleHQgfHwgZW1pdHRlciwgb25jZSlcbiAgICAsIGV2dCA9IHByZWZpeCA/IHByZWZpeCArIGV2ZW50IDogZXZlbnQ7XG5cbiAgaWYgKCFlbWl0dGVyLl9ldmVudHNbZXZ0XSkgZW1pdHRlci5fZXZlbnRzW2V2dF0gPSBsaXN0ZW5lciwgZW1pdHRlci5fZXZlbnRzQ291bnQrKztcbiAgZWxzZSBpZiAoIWVtaXR0ZXIuX2V2ZW50c1tldnRdLmZuKSBlbWl0dGVyLl9ldmVudHNbZXZ0XS5wdXNoKGxpc3RlbmVyKTtcbiAgZWxzZSBlbWl0dGVyLl9ldmVudHNbZXZ0XSA9IFtlbWl0dGVyLl9ldmVudHNbZXZ0XSwgbGlzdGVuZXJdO1xuXG4gIHJldHVybiBlbWl0dGVyO1xufVxuXG4vKipcbiAqIENsZWFyIGV2ZW50IGJ5IG5hbWUuXG4gKlxuICogQHBhcmFtIHtFdmVudEVtaXR0ZXJ9IGVtaXR0ZXIgUmVmZXJlbmNlIHRvIHRoZSBgRXZlbnRFbWl0dGVyYCBpbnN0YW5jZS5cbiAqIEBwYXJhbSB7KFN0cmluZ3xTeW1ib2wpfSBldnQgVGhlIEV2ZW50IG5hbWUuXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBjbGVhckV2ZW50KGVtaXR0ZXIsIGV2dCkge1xuICBpZiAoLS1lbWl0dGVyLl9ldmVudHNDb3VudCA9PT0gMCkgZW1pdHRlci5fZXZlbnRzID0gbmV3IEV2ZW50cygpO1xuICBlbHNlIGRlbGV0ZSBlbWl0dGVyLl9ldmVudHNbZXZ0XTtcbn1cblxuLyoqXG4gKiBNaW5pbWFsIGBFdmVudEVtaXR0ZXJgIGludGVyZmFjZSB0aGF0IGlzIG1vbGRlZCBhZ2FpbnN0IHRoZSBOb2RlLmpzXG4gKiBgRXZlbnRFbWl0dGVyYCBpbnRlcmZhY2UuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgdGhpcy5fZXZlbnRzID0gbmV3IEV2ZW50cygpO1xuICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGFycmF5IGxpc3RpbmcgdGhlIGV2ZW50cyBmb3Igd2hpY2ggdGhlIGVtaXR0ZXIgaGFzIHJlZ2lzdGVyZWRcbiAqIGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyB7QXJyYXl9XG4gKiBAcHVibGljXG4gKi9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZXZlbnROYW1lcyA9IGZ1bmN0aW9uIGV2ZW50TmFtZXMoKSB7XG4gIHZhciBuYW1lcyA9IFtdXG4gICAgLCBldmVudHNcbiAgICAsIG5hbWU7XG5cbiAgaWYgKHRoaXMuX2V2ZW50c0NvdW50ID09PSAwKSByZXR1cm4gbmFtZXM7XG5cbiAgZm9yIChuYW1lIGluIChldmVudHMgPSB0aGlzLl9ldmVudHMpKSB7XG4gICAgaWYgKGhhcy5jYWxsKGV2ZW50cywgbmFtZSkpIG5hbWVzLnB1c2gocHJlZml4ID8gbmFtZS5zbGljZSgxKSA6IG5hbWUpO1xuICB9XG5cbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICByZXR1cm4gbmFtZXMuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZXZlbnRzKSk7XG4gIH1cblxuICByZXR1cm4gbmFtZXM7XG59O1xuXG4vKipcbiAqIFJldHVybiB0aGUgbGlzdGVuZXJzIHJlZ2lzdGVyZWQgZm9yIGEgZ2l2ZW4gZXZlbnQuXG4gKlxuICogQHBhcmFtIHsoU3RyaW5nfFN5bWJvbCl9IGV2ZW50IFRoZSBldmVudCBuYW1lLlxuICogQHJldHVybnMge0FycmF5fSBUaGUgcmVnaXN0ZXJlZCBsaXN0ZW5lcnMuXG4gKiBAcHVibGljXG4gKi9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gbGlzdGVuZXJzKGV2ZW50KSB7XG4gIHZhciBldnQgPSBwcmVmaXggPyBwcmVmaXggKyBldmVudCA6IGV2ZW50XG4gICAgLCBoYW5kbGVycyA9IHRoaXMuX2V2ZW50c1tldnRdO1xuXG4gIGlmICghaGFuZGxlcnMpIHJldHVybiBbXTtcbiAgaWYgKGhhbmRsZXJzLmZuKSByZXR1cm4gW2hhbmRsZXJzLmZuXTtcblxuICBmb3IgKHZhciBpID0gMCwgbCA9IGhhbmRsZXJzLmxlbmd0aCwgZWUgPSBuZXcgQXJyYXkobCk7IGkgPCBsOyBpKyspIHtcbiAgICBlZVtpXSA9IGhhbmRsZXJzW2ldLmZuO1xuICB9XG5cbiAgcmV0dXJuIGVlO1xufTtcblxuLyoqXG4gKiBSZXR1cm4gdGhlIG51bWJlciBvZiBsaXN0ZW5lcnMgbGlzdGVuaW5nIHRvIGEgZ2l2ZW4gZXZlbnQuXG4gKlxuICogQHBhcmFtIHsoU3RyaW5nfFN5bWJvbCl9IGV2ZW50IFRoZSBldmVudCBuYW1lLlxuICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWJlciBvZiBsaXN0ZW5lcnMuXG4gKiBAcHVibGljXG4gKi9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uIGxpc3RlbmVyQ291bnQoZXZlbnQpIHtcbiAgdmFyIGV2dCA9IHByZWZpeCA/IHByZWZpeCArIGV2ZW50IDogZXZlbnRcbiAgICAsIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1tldnRdO1xuXG4gIGlmICghbGlzdGVuZXJzKSByZXR1cm4gMDtcbiAgaWYgKGxpc3RlbmVycy5mbikgcmV0dXJuIDE7XG4gIHJldHVybiBsaXN0ZW5lcnMubGVuZ3RoO1xufTtcblxuLyoqXG4gKiBDYWxscyBlYWNoIG9mIHRoZSBsaXN0ZW5lcnMgcmVnaXN0ZXJlZCBmb3IgYSBnaXZlbiBldmVudC5cbiAqXG4gKiBAcGFyYW0geyhTdHJpbmd8U3ltYm9sKX0gZXZlbnQgVGhlIGV2ZW50IG5hbWUuXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBldmVudCBoYWQgbGlzdGVuZXJzLCBlbHNlIGBmYWxzZWAuXG4gKiBAcHVibGljXG4gKi9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIGVtaXQoZXZlbnQsIGExLCBhMiwgYTMsIGE0LCBhNSkge1xuICB2YXIgZXZ0ID0gcHJlZml4ID8gcHJlZml4ICsgZXZlbnQgOiBldmVudDtcblxuICBpZiAoIXRoaXMuX2V2ZW50c1tldnRdKSByZXR1cm4gZmFsc2U7XG5cbiAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1tldnRdXG4gICAgLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoXG4gICAgLCBhcmdzXG4gICAgLCBpO1xuXG4gIGlmIChsaXN0ZW5lcnMuZm4pIHtcbiAgICBpZiAobGlzdGVuZXJzLm9uY2UpIHRoaXMucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVycy5mbiwgdW5kZWZpbmVkLCB0cnVlKTtcblxuICAgIHN3aXRjaCAobGVuKSB7XG4gICAgICBjYXNlIDE6IHJldHVybiBsaXN0ZW5lcnMuZm4uY2FsbChsaXN0ZW5lcnMuY29udGV4dCksIHRydWU7XG4gICAgICBjYXNlIDI6IHJldHVybiBsaXN0ZW5lcnMuZm4uY2FsbChsaXN0ZW5lcnMuY29udGV4dCwgYTEpLCB0cnVlO1xuICAgICAgY2FzZSAzOiByZXR1cm4gbGlzdGVuZXJzLmZuLmNhbGwobGlzdGVuZXJzLmNvbnRleHQsIGExLCBhMiksIHRydWU7XG4gICAgICBjYXNlIDQ6IHJldHVybiBsaXN0ZW5lcnMuZm4uY2FsbChsaXN0ZW5lcnMuY29udGV4dCwgYTEsIGEyLCBhMyksIHRydWU7XG4gICAgICBjYXNlIDU6IHJldHVybiBsaXN0ZW5lcnMuZm4uY2FsbChsaXN0ZW5lcnMuY29udGV4dCwgYTEsIGEyLCBhMywgYTQpLCB0cnVlO1xuICAgICAgY2FzZSA2OiByZXR1cm4gbGlzdGVuZXJzLmZuLmNhbGwobGlzdGVuZXJzLmNvbnRleHQsIGExLCBhMiwgYTMsIGE0LCBhNSksIHRydWU7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMSwgYXJncyA9IG5ldyBBcnJheShsZW4gLTEpOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgIH1cblxuICAgIGxpc3RlbmVycy5mbi5hcHBseShsaXN0ZW5lcnMuY29udGV4dCwgYXJncyk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGxlbmd0aCA9IGxpc3RlbmVycy5sZW5ndGhcbiAgICAgICwgajtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGxpc3RlbmVyc1tpXS5vbmNlKSB0aGlzLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcnNbaV0uZm4sIHVuZGVmaW5lZCwgdHJ1ZSk7XG5cbiAgICAgIHN3aXRjaCAobGVuKSB7XG4gICAgICAgIGNhc2UgMTogbGlzdGVuZXJzW2ldLmZuLmNhbGwobGlzdGVuZXJzW2ldLmNvbnRleHQpOyBicmVhaztcbiAgICAgICAgY2FzZSAyOiBsaXN0ZW5lcnNbaV0uZm4uY2FsbChsaXN0ZW5lcnNbaV0uY29udGV4dCwgYTEpOyBicmVhaztcbiAgICAgICAgY2FzZSAzOiBsaXN0ZW5lcnNbaV0uZm4uY2FsbChsaXN0ZW5lcnNbaV0uY29udGV4dCwgYTEsIGEyKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgNDogbGlzdGVuZXJzW2ldLmZuLmNhbGwobGlzdGVuZXJzW2ldLmNvbnRleHQsIGExLCBhMiwgYTMpOyBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBpZiAoIWFyZ3MpIGZvciAoaiA9IDEsIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0xKTsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgICAgICBhcmdzW2ogLSAxXSA9IGFyZ3VtZW50c1tqXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsaXN0ZW5lcnNbaV0uZm4uYXBwbHkobGlzdGVuZXJzW2ldLmNvbnRleHQsIGFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuLyoqXG4gKiBBZGQgYSBsaXN0ZW5lciBmb3IgYSBnaXZlbiBldmVudC5cbiAqXG4gKiBAcGFyYW0geyhTdHJpbmd8U3ltYm9sKX0gZXZlbnQgVGhlIGV2ZW50IG5hbWUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgbGlzdGVuZXIgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyp9IFtjb250ZXh0PXRoaXNdIFRoZSBjb250ZXh0IHRvIGludm9rZSB0aGUgbGlzdGVuZXIgd2l0aC5cbiAqIEByZXR1cm5zIHtFdmVudEVtaXR0ZXJ9IGB0aGlzYC5cbiAqIEBwdWJsaWNcbiAqL1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIG9uKGV2ZW50LCBmbiwgY29udGV4dCkge1xuICByZXR1cm4gYWRkTGlzdGVuZXIodGhpcywgZXZlbnQsIGZuLCBjb250ZXh0LCBmYWxzZSk7XG59O1xuXG4vKipcbiAqIEFkZCBhIG9uZS10aW1lIGxpc3RlbmVyIGZvciBhIGdpdmVuIGV2ZW50LlxuICpcbiAqIEBwYXJhbSB7KFN0cmluZ3xTeW1ib2wpfSBldmVudCBUaGUgZXZlbnQgbmFtZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBsaXN0ZW5lciBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9dGhpc10gVGhlIGNvbnRleHQgdG8gaW52b2tlIHRoZSBsaXN0ZW5lciB3aXRoLlxuICogQHJldHVybnMge0V2ZW50RW1pdHRlcn0gYHRoaXNgLlxuICogQHB1YmxpY1xuICovXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKGV2ZW50LCBmbiwgY29udGV4dCkge1xuICByZXR1cm4gYWRkTGlzdGVuZXIodGhpcywgZXZlbnQsIGZuLCBjb250ZXh0LCB0cnVlKTtcbn07XG5cbi8qKlxuICogUmVtb3ZlIHRoZSBsaXN0ZW5lcnMgb2YgYSBnaXZlbiBldmVudC5cbiAqXG4gKiBAcGFyYW0geyhTdHJpbmd8U3ltYm9sKX0gZXZlbnQgVGhlIGV2ZW50IG5hbWUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBPbmx5IHJlbW92ZSB0aGUgbGlzdGVuZXJzIHRoYXQgbWF0Y2ggdGhpcyBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7Kn0gY29udGV4dCBPbmx5IHJlbW92ZSB0aGUgbGlzdGVuZXJzIHRoYXQgaGF2ZSB0aGlzIGNvbnRleHQuXG4gKiBAcGFyYW0ge0Jvb2xlYW59IG9uY2UgT25seSByZW1vdmUgb25lLXRpbWUgbGlzdGVuZXJzLlxuICogQHJldHVybnMge0V2ZW50RW1pdHRlcn0gYHRoaXNgLlxuICogQHB1YmxpY1xuICovXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGZuLCBjb250ZXh0LCBvbmNlKSB7XG4gIHZhciBldnQgPSBwcmVmaXggPyBwcmVmaXggKyBldmVudCA6IGV2ZW50O1xuXG4gIGlmICghdGhpcy5fZXZlbnRzW2V2dF0pIHJldHVybiB0aGlzO1xuICBpZiAoIWZuKSB7XG4gICAgY2xlYXJFdmVudCh0aGlzLCBldnQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1tldnRdO1xuXG4gIGlmIChsaXN0ZW5lcnMuZm4pIHtcbiAgICBpZiAoXG4gICAgICBsaXN0ZW5lcnMuZm4gPT09IGZuICYmXG4gICAgICAoIW9uY2UgfHwgbGlzdGVuZXJzLm9uY2UpICYmXG4gICAgICAoIWNvbnRleHQgfHwgbGlzdGVuZXJzLmNvbnRleHQgPT09IGNvbnRleHQpXG4gICAgKSB7XG4gICAgICBjbGVhckV2ZW50KHRoaXMsIGV2dCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgPSAwLCBldmVudHMgPSBbXSwgbGVuZ3RoID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGxpc3RlbmVyc1tpXS5mbiAhPT0gZm4gfHxcbiAgICAgICAgKG9uY2UgJiYgIWxpc3RlbmVyc1tpXS5vbmNlKSB8fFxuICAgICAgICAoY29udGV4dCAmJiBsaXN0ZW5lcnNbaV0uY29udGV4dCAhPT0gY29udGV4dClcbiAgICAgICkge1xuICAgICAgICBldmVudHMucHVzaChsaXN0ZW5lcnNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vXG4gICAgLy8gUmVzZXQgdGhlIGFycmF5LCBvciByZW1vdmUgaXQgY29tcGxldGVseSBpZiB3ZSBoYXZlIG5vIG1vcmUgbGlzdGVuZXJzLlxuICAgIC8vXG4gICAgaWYgKGV2ZW50cy5sZW5ndGgpIHRoaXMuX2V2ZW50c1tldnRdID0gZXZlbnRzLmxlbmd0aCA9PT0gMSA/IGV2ZW50c1swXSA6IGV2ZW50cztcbiAgICBlbHNlIGNsZWFyRXZlbnQodGhpcywgZXZ0KTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYWxsIGxpc3RlbmVycywgb3IgdGhvc2Ugb2YgdGhlIHNwZWNpZmllZCBldmVudC5cbiAqXG4gKiBAcGFyYW0geyhTdHJpbmd8U3ltYm9sKX0gW2V2ZW50XSBUaGUgZXZlbnQgbmFtZS5cbiAqIEByZXR1cm5zIHtFdmVudEVtaXR0ZXJ9IGB0aGlzYC5cbiAqIEBwdWJsaWNcbiAqL1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnQpIHtcbiAgdmFyIGV2dDtcblxuICBpZiAoZXZlbnQpIHtcbiAgICBldnQgPSBwcmVmaXggPyBwcmVmaXggKyBldmVudCA6IGV2ZW50O1xuICAgIGlmICh0aGlzLl9ldmVudHNbZXZ0XSkgY2xlYXJFdmVudCh0aGlzLCBldnQpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuX2V2ZW50cyA9IG5ldyBFdmVudHMoKTtcbiAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vXG4vLyBBbGlhcyBtZXRob2RzIG5hbWVzIGJlY2F1c2UgcGVvcGxlIHJvbGwgbGlrZSB0aGF0LlxuLy9cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcjtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uO1xuXG4vL1xuLy8gRXhwb3NlIHRoZSBwcmVmaXguXG4vL1xuRXZlbnRFbWl0dGVyLnByZWZpeGVkID0gcHJlZml4O1xuXG4vL1xuLy8gQWxsb3cgYEV2ZW50RW1pdHRlcmAgdG8gYmUgaW1wb3J0ZWQgYXMgbW9kdWxlIG5hbWVzcGFjZS5cbi8vXG5FdmVudEVtaXR0ZXIuRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyO1xuXG4vL1xuLy8gRXhwb3NlIHRoZSBtb2R1bGUuXG4vL1xuaWYgKCd1bmRlZmluZWQnICE9PSB0eXBlb2YgbW9kdWxlKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xufVxuIiwgIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBlYXJjdXQ7XG5tb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gZWFyY3V0O1xuXG5mdW5jdGlvbiBlYXJjdXQoZGF0YSwgaG9sZUluZGljZXMsIGRpbSkge1xuXG4gICAgZGltID0gZGltIHx8IDI7XG5cbiAgICB2YXIgaGFzSG9sZXMgPSBob2xlSW5kaWNlcyAmJiBob2xlSW5kaWNlcy5sZW5ndGgsXG4gICAgICAgIG91dGVyTGVuID0gaGFzSG9sZXMgPyBob2xlSW5kaWNlc1swXSAqIGRpbSA6IGRhdGEubGVuZ3RoLFxuICAgICAgICBvdXRlck5vZGUgPSBsaW5rZWRMaXN0KGRhdGEsIDAsIG91dGVyTGVuLCBkaW0sIHRydWUpLFxuICAgICAgICB0cmlhbmdsZXMgPSBbXTtcblxuICAgIGlmICghb3V0ZXJOb2RlIHx8IG91dGVyTm9kZS5uZXh0ID09PSBvdXRlck5vZGUucHJldikgcmV0dXJuIHRyaWFuZ2xlcztcblxuICAgIHZhciBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZLCB4LCB5LCBpbnZTaXplO1xuXG4gICAgaWYgKGhhc0hvbGVzKSBvdXRlck5vZGUgPSBlbGltaW5hdGVIb2xlcyhkYXRhLCBob2xlSW5kaWNlcywgb3V0ZXJOb2RlLCBkaW0pO1xuXG4gICAgLy8gaWYgdGhlIHNoYXBlIGlzIG5vdCB0b28gc2ltcGxlLCB3ZSdsbCB1c2Ugei1vcmRlciBjdXJ2ZSBoYXNoIGxhdGVyOyBjYWxjdWxhdGUgcG9seWdvbiBiYm94XG4gICAgaWYgKGRhdGEubGVuZ3RoID4gODAgKiBkaW0pIHtcbiAgICAgICAgbWluWCA9IG1heFggPSBkYXRhWzBdO1xuICAgICAgICBtaW5ZID0gbWF4WSA9IGRhdGFbMV07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IGRpbTsgaSA8IG91dGVyTGVuOyBpICs9IGRpbSkge1xuICAgICAgICAgICAgeCA9IGRhdGFbaV07XG4gICAgICAgICAgICB5ID0gZGF0YVtpICsgMV07XG4gICAgICAgICAgICBpZiAoeCA8IG1pblgpIG1pblggPSB4O1xuICAgICAgICAgICAgaWYgKHkgPCBtaW5ZKSBtaW5ZID0geTtcbiAgICAgICAgICAgIGlmICh4ID4gbWF4WCkgbWF4WCA9IHg7XG4gICAgICAgICAgICBpZiAoeSA+IG1heFkpIG1heFkgPSB5O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbWluWCwgbWluWSBhbmQgaW52U2l6ZSBhcmUgbGF0ZXIgdXNlZCB0byB0cmFuc2Zvcm0gY29vcmRzIGludG8gaW50ZWdlcnMgZm9yIHotb3JkZXIgY2FsY3VsYXRpb25cbiAgICAgICAgaW52U2l6ZSA9IE1hdGgubWF4KG1heFggLSBtaW5YLCBtYXhZIC0gbWluWSk7XG4gICAgICAgIGludlNpemUgPSBpbnZTaXplICE9PSAwID8gMSAvIGludlNpemUgOiAwO1xuICAgIH1cblxuICAgIGVhcmN1dExpbmtlZChvdXRlck5vZGUsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTtcblxuICAgIHJldHVybiB0cmlhbmdsZXM7XG59XG5cbi8vIGNyZWF0ZSBhIGNpcmN1bGFyIGRvdWJseSBsaW5rZWQgbGlzdCBmcm9tIHBvbHlnb24gcG9pbnRzIGluIHRoZSBzcGVjaWZpZWQgd2luZGluZyBvcmRlclxuZnVuY3Rpb24gbGlua2VkTGlzdChkYXRhLCBzdGFydCwgZW5kLCBkaW0sIGNsb2Nrd2lzZSkge1xuICAgIHZhciBpLCBsYXN0O1xuXG4gICAgaWYgKGNsb2Nrd2lzZSA9PT0gKHNpZ25lZEFyZWEoZGF0YSwgc3RhcnQsIGVuZCwgZGltKSA+IDApKSB7XG4gICAgICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IGRpbSkgbGFzdCA9IGluc2VydE5vZGUoaSwgZGF0YVtpXSwgZGF0YVtpICsgMV0sIGxhc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoaSA9IGVuZCAtIGRpbTsgaSA+PSBzdGFydDsgaSAtPSBkaW0pIGxhc3QgPSBpbnNlcnROb2RlKGksIGRhdGFbaV0sIGRhdGFbaSArIDFdLCBsYXN0KTtcbiAgICB9XG5cbiAgICBpZiAobGFzdCAmJiBlcXVhbHMobGFzdCwgbGFzdC5uZXh0KSkge1xuICAgICAgICByZW1vdmVOb2RlKGxhc3QpO1xuICAgICAgICBsYXN0ID0gbGFzdC5uZXh0O1xuICAgIH1cblxuICAgIHJldHVybiBsYXN0O1xufVxuXG4vLyBlbGltaW5hdGUgY29saW5lYXIgb3IgZHVwbGljYXRlIHBvaW50c1xuZnVuY3Rpb24gZmlsdGVyUG9pbnRzKHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoIXN0YXJ0KSByZXR1cm4gc3RhcnQ7XG4gICAgaWYgKCFlbmQpIGVuZCA9IHN0YXJ0O1xuXG4gICAgdmFyIHAgPSBzdGFydCxcbiAgICAgICAgYWdhaW47XG4gICAgZG8ge1xuICAgICAgICBhZ2FpbiA9IGZhbHNlO1xuXG4gICAgICAgIGlmICghcC5zdGVpbmVyICYmIChlcXVhbHMocCwgcC5uZXh0KSB8fCBhcmVhKHAucHJldiwgcCwgcC5uZXh0KSA9PT0gMCkpIHtcbiAgICAgICAgICAgIHJlbW92ZU5vZGUocCk7XG4gICAgICAgICAgICBwID0gZW5kID0gcC5wcmV2O1xuICAgICAgICAgICAgaWYgKHAgPT09IHAubmV4dCkgYnJlYWs7XG4gICAgICAgICAgICBhZ2FpbiA9IHRydWU7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHAgPSBwLm5leHQ7XG4gICAgICAgIH1cbiAgICB9IHdoaWxlIChhZ2FpbiB8fCBwICE9PSBlbmQpO1xuXG4gICAgcmV0dXJuIGVuZDtcbn1cblxuLy8gbWFpbiBlYXIgc2xpY2luZyBsb29wIHdoaWNoIHRyaWFuZ3VsYXRlcyBhIHBvbHlnb24gKGdpdmVuIGFzIGEgbGlua2VkIGxpc3QpXG5mdW5jdGlvbiBlYXJjdXRMaW5rZWQoZWFyLCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSwgcGFzcykge1xuICAgIGlmICghZWFyKSByZXR1cm47XG5cbiAgICAvLyBpbnRlcmxpbmsgcG9seWdvbiBub2RlcyBpbiB6LW9yZGVyXG4gICAgaWYgKCFwYXNzICYmIGludlNpemUpIGluZGV4Q3VydmUoZWFyLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTtcblxuICAgIHZhciBzdG9wID0gZWFyLFxuICAgICAgICBwcmV2LCBuZXh0O1xuXG4gICAgLy8gaXRlcmF0ZSB0aHJvdWdoIGVhcnMsIHNsaWNpbmcgdGhlbSBvbmUgYnkgb25lXG4gICAgd2hpbGUgKGVhci5wcmV2ICE9PSBlYXIubmV4dCkge1xuICAgICAgICBwcmV2ID0gZWFyLnByZXY7XG4gICAgICAgIG5leHQgPSBlYXIubmV4dDtcblxuICAgICAgICBpZiAoaW52U2l6ZSA/IGlzRWFySGFzaGVkKGVhciwgbWluWCwgbWluWSwgaW52U2l6ZSkgOiBpc0VhcihlYXIpKSB7XG4gICAgICAgICAgICAvLyBjdXQgb2ZmIHRoZSB0cmlhbmdsZVxuICAgICAgICAgICAgdHJpYW5nbGVzLnB1c2gocHJldi5pIC8gZGltKTtcbiAgICAgICAgICAgIHRyaWFuZ2xlcy5wdXNoKGVhci5pIC8gZGltKTtcbiAgICAgICAgICAgIHRyaWFuZ2xlcy5wdXNoKG5leHQuaSAvIGRpbSk7XG5cbiAgICAgICAgICAgIHJlbW92ZU5vZGUoZWFyKTtcblxuICAgICAgICAgICAgLy8gc2tpcHBpbmcgdGhlIG5leHQgdmVydGV4IGxlYWRzIHRvIGxlc3Mgc2xpdmVyIHRyaWFuZ2xlc1xuICAgICAgICAgICAgZWFyID0gbmV4dC5uZXh0O1xuICAgICAgICAgICAgc3RvcCA9IG5leHQubmV4dDtcblxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBlYXIgPSBuZXh0O1xuXG4gICAgICAgIC8vIGlmIHdlIGxvb3BlZCB0aHJvdWdoIHRoZSB3aG9sZSByZW1haW5pbmcgcG9seWdvbiBhbmQgY2FuJ3QgZmluZCBhbnkgbW9yZSBlYXJzXG4gICAgICAgIGlmIChlYXIgPT09IHN0b3ApIHtcbiAgICAgICAgICAgIC8vIHRyeSBmaWx0ZXJpbmcgcG9pbnRzIGFuZCBzbGljaW5nIGFnYWluXG4gICAgICAgICAgICBpZiAoIXBhc3MpIHtcbiAgICAgICAgICAgICAgICBlYXJjdXRMaW5rZWQoZmlsdGVyUG9pbnRzKGVhciksIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplLCAxKTtcblxuICAgICAgICAgICAgLy8gaWYgdGhpcyBkaWRuJ3Qgd29yaywgdHJ5IGN1cmluZyBhbGwgc21hbGwgc2VsZi1pbnRlcnNlY3Rpb25zIGxvY2FsbHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFzcyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGVhciA9IGN1cmVMb2NhbEludGVyc2VjdGlvbnMoZmlsdGVyUG9pbnRzKGVhciksIHRyaWFuZ2xlcywgZGltKTtcbiAgICAgICAgICAgICAgICBlYXJjdXRMaW5rZWQoZWFyLCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSwgMik7XG5cbiAgICAgICAgICAgIC8vIGFzIGEgbGFzdCByZXNvcnQsIHRyeSBzcGxpdHRpbmcgdGhlIHJlbWFpbmluZyBwb2x5Z29uIGludG8gdHdvXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhc3MgPT09IDIpIHtcbiAgICAgICAgICAgICAgICBzcGxpdEVhcmN1dChlYXIsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIGNoZWNrIHdoZXRoZXIgYSBwb2x5Z29uIG5vZGUgZm9ybXMgYSB2YWxpZCBlYXIgd2l0aCBhZGphY2VudCBub2Rlc1xuZnVuY3Rpb24gaXNFYXIoZWFyKSB7XG4gICAgdmFyIGEgPSBlYXIucHJldixcbiAgICAgICAgYiA9IGVhcixcbiAgICAgICAgYyA9IGVhci5uZXh0O1xuXG4gICAgaWYgKGFyZWEoYSwgYiwgYykgPj0gMCkgcmV0dXJuIGZhbHNlOyAvLyByZWZsZXgsIGNhbid0IGJlIGFuIGVhclxuXG4gICAgLy8gbm93IG1ha2Ugc3VyZSB3ZSBkb24ndCBoYXZlIG90aGVyIHBvaW50cyBpbnNpZGUgdGhlIHBvdGVudGlhbCBlYXJcbiAgICB2YXIgcCA9IGVhci5uZXh0Lm5leHQ7XG5cbiAgICB3aGlsZSAocCAhPT0gZWFyLnByZXYpIHtcbiAgICAgICAgaWYgKHBvaW50SW5UcmlhbmdsZShhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBwLngsIHAueSkgJiZcbiAgICAgICAgICAgIGFyZWEocC5wcmV2LCBwLCBwLm5leHQpID49IDApIHJldHVybiBmYWxzZTtcbiAgICAgICAgcCA9IHAubmV4dDtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gaXNFYXJIYXNoZWQoZWFyLCBtaW5YLCBtaW5ZLCBpbnZTaXplKSB7XG4gICAgdmFyIGEgPSBlYXIucHJldixcbiAgICAgICAgYiA9IGVhcixcbiAgICAgICAgYyA9IGVhci5uZXh0O1xuXG4gICAgaWYgKGFyZWEoYSwgYiwgYykgPj0gMCkgcmV0dXJuIGZhbHNlOyAvLyByZWZsZXgsIGNhbid0IGJlIGFuIGVhclxuXG4gICAgLy8gdHJpYW5nbGUgYmJveDsgbWluICYgbWF4IGFyZSBjYWxjdWxhdGVkIGxpa2UgdGhpcyBmb3Igc3BlZWRcbiAgICB2YXIgbWluVFggPSBhLnggPCBiLnggPyAoYS54IDwgYy54ID8gYS54IDogYy54KSA6IChiLnggPCBjLnggPyBiLnggOiBjLngpLFxuICAgICAgICBtaW5UWSA9IGEueSA8IGIueSA/IChhLnkgPCBjLnkgPyBhLnkgOiBjLnkpIDogKGIueSA8IGMueSA/IGIueSA6IGMueSksXG4gICAgICAgIG1heFRYID0gYS54ID4gYi54ID8gKGEueCA+IGMueCA/IGEueCA6IGMueCkgOiAoYi54ID4gYy54ID8gYi54IDogYy54KSxcbiAgICAgICAgbWF4VFkgPSBhLnkgPiBiLnkgPyAoYS55ID4gYy55ID8gYS55IDogYy55KSA6IChiLnkgPiBjLnkgPyBiLnkgOiBjLnkpO1xuXG4gICAgLy8gei1vcmRlciByYW5nZSBmb3IgdGhlIGN1cnJlbnQgdHJpYW5nbGUgYmJveDtcbiAgICB2YXIgbWluWiA9IHpPcmRlcihtaW5UWCwgbWluVFksIG1pblgsIG1pblksIGludlNpemUpLFxuICAgICAgICBtYXhaID0gek9yZGVyKG1heFRYLCBtYXhUWSwgbWluWCwgbWluWSwgaW52U2l6ZSk7XG5cbiAgICB2YXIgcCA9IGVhci5wcmV2WixcbiAgICAgICAgbiA9IGVhci5uZXh0WjtcblxuICAgIC8vIGxvb2sgZm9yIHBvaW50cyBpbnNpZGUgdGhlIHRyaWFuZ2xlIGluIGJvdGggZGlyZWN0aW9uc1xuICAgIHdoaWxlIChwICYmIHAueiA+PSBtaW5aICYmIG4gJiYgbi56IDw9IG1heFopIHtcbiAgICAgICAgaWYgKHAgIT09IGVhci5wcmV2ICYmIHAgIT09IGVhci5uZXh0ICYmXG4gICAgICAgICAgICBwb2ludEluVHJpYW5nbGUoYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgcC54LCBwLnkpICYmXG4gICAgICAgICAgICBhcmVhKHAucHJldiwgcCwgcC5uZXh0KSA+PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHAgPSBwLnByZXZaO1xuXG4gICAgICAgIGlmIChuICE9PSBlYXIucHJldiAmJiBuICE9PSBlYXIubmV4dCAmJlxuICAgICAgICAgICAgcG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIG4ueCwgbi55KSAmJlxuICAgICAgICAgICAgYXJlYShuLnByZXYsIG4sIG4ubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBuID0gbi5uZXh0WjtcbiAgICB9XG5cbiAgICAvLyBsb29rIGZvciByZW1haW5pbmcgcG9pbnRzIGluIGRlY3JlYXNpbmcgei1vcmRlclxuICAgIHdoaWxlIChwICYmIHAueiA+PSBtaW5aKSB7XG4gICAgICAgIGlmIChwICE9PSBlYXIucHJldiAmJiBwICE9PSBlYXIubmV4dCAmJlxuICAgICAgICAgICAgcG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIHAueCwgcC55KSAmJlxuICAgICAgICAgICAgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBwID0gcC5wcmV2WjtcbiAgICB9XG5cbiAgICAvLyBsb29rIGZvciByZW1haW5pbmcgcG9pbnRzIGluIGluY3JlYXNpbmcgei1vcmRlclxuICAgIHdoaWxlIChuICYmIG4ueiA8PSBtYXhaKSB7XG4gICAgICAgIGlmIChuICE9PSBlYXIucHJldiAmJiBuICE9PSBlYXIubmV4dCAmJlxuICAgICAgICAgICAgcG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIG4ueCwgbi55KSAmJlxuICAgICAgICAgICAgYXJlYShuLnByZXYsIG4sIG4ubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBuID0gbi5uZXh0WjtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gZ28gdGhyb3VnaCBhbGwgcG9seWdvbiBub2RlcyBhbmQgY3VyZSBzbWFsbCBsb2NhbCBzZWxmLWludGVyc2VjdGlvbnNcbmZ1bmN0aW9uIGN1cmVMb2NhbEludGVyc2VjdGlvbnMoc3RhcnQsIHRyaWFuZ2xlcywgZGltKSB7XG4gICAgdmFyIHAgPSBzdGFydDtcbiAgICBkbyB7XG4gICAgICAgIHZhciBhID0gcC5wcmV2LFxuICAgICAgICAgICAgYiA9IHAubmV4dC5uZXh0O1xuXG4gICAgICAgIGlmICghZXF1YWxzKGEsIGIpICYmIGludGVyc2VjdHMoYSwgcCwgcC5uZXh0LCBiKSAmJiBsb2NhbGx5SW5zaWRlKGEsIGIpICYmIGxvY2FsbHlJbnNpZGUoYiwgYSkpIHtcblxuICAgICAgICAgICAgdHJpYW5nbGVzLnB1c2goYS5pIC8gZGltKTtcbiAgICAgICAgICAgIHRyaWFuZ2xlcy5wdXNoKHAuaSAvIGRpbSk7XG4gICAgICAgICAgICB0cmlhbmdsZXMucHVzaChiLmkgLyBkaW0pO1xuXG4gICAgICAgICAgICAvLyByZW1vdmUgdHdvIG5vZGVzIGludm9sdmVkXG4gICAgICAgICAgICByZW1vdmVOb2RlKHApO1xuICAgICAgICAgICAgcmVtb3ZlTm9kZShwLm5leHQpO1xuXG4gICAgICAgICAgICBwID0gc3RhcnQgPSBiO1xuICAgICAgICB9XG4gICAgICAgIHAgPSBwLm5leHQ7XG4gICAgfSB3aGlsZSAocCAhPT0gc3RhcnQpO1xuXG4gICAgcmV0dXJuIGZpbHRlclBvaW50cyhwKTtcbn1cblxuLy8gdHJ5IHNwbGl0dGluZyBwb2x5Z29uIGludG8gdHdvIGFuZCB0cmlhbmd1bGF0ZSB0aGVtIGluZGVwZW5kZW50bHlcbmZ1bmN0aW9uIHNwbGl0RWFyY3V0KHN0YXJ0LCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSkge1xuICAgIC8vIGxvb2sgZm9yIGEgdmFsaWQgZGlhZ29uYWwgdGhhdCBkaXZpZGVzIHRoZSBwb2x5Z29uIGludG8gdHdvXG4gICAgdmFyIGEgPSBzdGFydDtcbiAgICBkbyB7XG4gICAgICAgIHZhciBiID0gYS5uZXh0Lm5leHQ7XG4gICAgICAgIHdoaWxlIChiICE9PSBhLnByZXYpIHtcbiAgICAgICAgICAgIGlmIChhLmkgIT09IGIuaSAmJiBpc1ZhbGlkRGlhZ29uYWwoYSwgYikpIHtcbiAgICAgICAgICAgICAgICAvLyBzcGxpdCB0aGUgcG9seWdvbiBpbiB0d28gYnkgdGhlIGRpYWdvbmFsXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBzcGxpdFBvbHlnb24oYSwgYik7XG5cbiAgICAgICAgICAgICAgICAvLyBmaWx0ZXIgY29saW5lYXIgcG9pbnRzIGFyb3VuZCB0aGUgY3V0c1xuICAgICAgICAgICAgICAgIGEgPSBmaWx0ZXJQb2ludHMoYSwgYS5uZXh0KTtcbiAgICAgICAgICAgICAgICBjID0gZmlsdGVyUG9pbnRzKGMsIGMubmV4dCk7XG5cbiAgICAgICAgICAgICAgICAvLyBydW4gZWFyY3V0IG9uIGVhY2ggaGFsZlxuICAgICAgICAgICAgICAgIGVhcmN1dExpbmtlZChhLCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSk7XG4gICAgICAgICAgICAgICAgZWFyY3V0TGlua2VkKGMsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBiID0gYi5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIGEgPSBhLm5leHQ7XG4gICAgfSB3aGlsZSAoYSAhPT0gc3RhcnQpO1xufVxuXG4vLyBsaW5rIGV2ZXJ5IGhvbGUgaW50byB0aGUgb3V0ZXIgbG9vcCwgcHJvZHVjaW5nIGEgc2luZ2xlLXJpbmcgcG9seWdvbiB3aXRob3V0IGhvbGVzXG5mdW5jdGlvbiBlbGltaW5hdGVIb2xlcyhkYXRhLCBob2xlSW5kaWNlcywgb3V0ZXJOb2RlLCBkaW0pIHtcbiAgICB2YXIgcXVldWUgPSBbXSxcbiAgICAgICAgaSwgbGVuLCBzdGFydCwgZW5kLCBsaXN0O1xuXG4gICAgZm9yIChpID0gMCwgbGVuID0gaG9sZUluZGljZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgc3RhcnQgPSBob2xlSW5kaWNlc1tpXSAqIGRpbTtcbiAgICAgICAgZW5kID0gaSA8IGxlbiAtIDEgPyBob2xlSW5kaWNlc1tpICsgMV0gKiBkaW0gOiBkYXRhLmxlbmd0aDtcbiAgICAgICAgbGlzdCA9IGxpbmtlZExpc3QoZGF0YSwgc3RhcnQsIGVuZCwgZGltLCBmYWxzZSk7XG4gICAgICAgIGlmIChsaXN0ID09PSBsaXN0Lm5leHQpIGxpc3Quc3RlaW5lciA9IHRydWU7XG4gICAgICAgIHF1ZXVlLnB1c2goZ2V0TGVmdG1vc3QobGlzdCkpO1xuICAgIH1cblxuICAgIHF1ZXVlLnNvcnQoY29tcGFyZVgpO1xuXG4gICAgLy8gcHJvY2VzcyBob2xlcyBmcm9tIGxlZnQgdG8gcmlnaHRcbiAgICBmb3IgKGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZWxpbWluYXRlSG9sZShxdWV1ZVtpXSwgb3V0ZXJOb2RlKTtcbiAgICAgICAgb3V0ZXJOb2RlID0gZmlsdGVyUG9pbnRzKG91dGVyTm9kZSwgb3V0ZXJOb2RlLm5leHQpO1xuICAgIH1cblxuICAgIHJldHVybiBvdXRlck5vZGU7XG59XG5cbmZ1bmN0aW9uIGNvbXBhcmVYKGEsIGIpIHtcbiAgICByZXR1cm4gYS54IC0gYi54O1xufVxuXG4vLyBmaW5kIGEgYnJpZGdlIGJldHdlZW4gdmVydGljZXMgdGhhdCBjb25uZWN0cyBob2xlIHdpdGggYW4gb3V0ZXIgcmluZyBhbmQgYW5kIGxpbmsgaXRcbmZ1bmN0aW9uIGVsaW1pbmF0ZUhvbGUoaG9sZSwgb3V0ZXJOb2RlKSB7XG4gICAgb3V0ZXJOb2RlID0gZmluZEhvbGVCcmlkZ2UoaG9sZSwgb3V0ZXJOb2RlKTtcbiAgICBpZiAob3V0ZXJOb2RlKSB7XG4gICAgICAgIHZhciBiID0gc3BsaXRQb2x5Z29uKG91dGVyTm9kZSwgaG9sZSk7XG5cbiAgICAgICAgLy8gZmlsdGVyIGNvbGxpbmVhciBwb2ludHMgYXJvdW5kIHRoZSBjdXRzXG4gICAgICAgIGZpbHRlclBvaW50cyhvdXRlck5vZGUsIG91dGVyTm9kZS5uZXh0KTtcbiAgICAgICAgZmlsdGVyUG9pbnRzKGIsIGIubmV4dCk7XG4gICAgfVxufVxuXG4vLyBEYXZpZCBFYmVybHkncyBhbGdvcml0aG0gZm9yIGZpbmRpbmcgYSBicmlkZ2UgYmV0d2VlbiBob2xlIGFuZCBvdXRlciBwb2x5Z29uXG5mdW5jdGlvbiBmaW5kSG9sZUJyaWRnZShob2xlLCBvdXRlck5vZGUpIHtcbiAgICB2YXIgcCA9IG91dGVyTm9kZSxcbiAgICAgICAgaHggPSBob2xlLngsXG4gICAgICAgIGh5ID0gaG9sZS55LFxuICAgICAgICBxeCA9IC1JbmZpbml0eSxcbiAgICAgICAgbTtcblxuICAgIC8vIGZpbmQgYSBzZWdtZW50IGludGVyc2VjdGVkIGJ5IGEgcmF5IGZyb20gdGhlIGhvbGUncyBsZWZ0bW9zdCBwb2ludCB0byB0aGUgbGVmdDtcbiAgICAvLyBzZWdtZW50J3MgZW5kcG9pbnQgd2l0aCBsZXNzZXIgeCB3aWxsIGJlIHBvdGVudGlhbCBjb25uZWN0aW9uIHBvaW50XG4gICAgZG8ge1xuICAgICAgICBpZiAoaHkgPD0gcC55ICYmIGh5ID49IHAubmV4dC55ICYmIHAubmV4dC55ICE9PSBwLnkpIHtcbiAgICAgICAgICAgIHZhciB4ID0gcC54ICsgKGh5IC0gcC55KSAqIChwLm5leHQueCAtIHAueCkgLyAocC5uZXh0LnkgLSBwLnkpO1xuICAgICAgICAgICAgaWYgKHggPD0gaHggJiYgeCA+IHF4KSB7XG4gICAgICAgICAgICAgICAgcXggPSB4O1xuICAgICAgICAgICAgICAgIGlmICh4ID09PSBoeCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaHkgPT09IHAueSkgcmV0dXJuIHA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoeSA9PT0gcC5uZXh0LnkpIHJldHVybiBwLm5leHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG0gPSBwLnggPCBwLm5leHQueCA/IHAgOiBwLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcCA9IHAubmV4dDtcbiAgICB9IHdoaWxlIChwICE9PSBvdXRlck5vZGUpO1xuXG4gICAgaWYgKCFtKSByZXR1cm4gbnVsbDtcblxuICAgIGlmIChoeCA9PT0gcXgpIHJldHVybiBtOyAvLyBob2xlIHRvdWNoZXMgb3V0ZXIgc2VnbWVudDsgcGljayBsZWZ0bW9zdCBlbmRwb2ludFxuXG4gICAgLy8gbG9vayBmb3IgcG9pbnRzIGluc2lkZSB0aGUgdHJpYW5nbGUgb2YgaG9sZSBwb2ludCwgc2VnbWVudCBpbnRlcnNlY3Rpb24gYW5kIGVuZHBvaW50O1xuICAgIC8vIGlmIHRoZXJlIGFyZSBubyBwb2ludHMgZm91bmQsIHdlIGhhdmUgYSB2YWxpZCBjb25uZWN0aW9uO1xuICAgIC8vIG90aGVyd2lzZSBjaG9vc2UgdGhlIHBvaW50IG9mIHRoZSBtaW5pbXVtIGFuZ2xlIHdpdGggdGhlIHJheSBhcyBjb25uZWN0aW9uIHBvaW50XG5cbiAgICB2YXIgc3RvcCA9IG0sXG4gICAgICAgIG14ID0gbS54LFxuICAgICAgICBteSA9IG0ueSxcbiAgICAgICAgdGFuTWluID0gSW5maW5pdHksXG4gICAgICAgIHRhbjtcblxuICAgIHAgPSBtO1xuXG4gICAgZG8ge1xuICAgICAgICBpZiAoaHggPj0gcC54ICYmIHAueCA+PSBteCAmJiBoeCAhPT0gcC54ICYmXG4gICAgICAgICAgICAgICAgcG9pbnRJblRyaWFuZ2xlKGh5IDwgbXkgPyBoeCA6IHF4LCBoeSwgbXgsIG15LCBoeSA8IG15ID8gcXggOiBoeCwgaHksIHAueCwgcC55KSkge1xuXG4gICAgICAgICAgICB0YW4gPSBNYXRoLmFicyhoeSAtIHAueSkgLyAoaHggLSBwLngpOyAvLyB0YW5nZW50aWFsXG5cbiAgICAgICAgICAgIGlmIChsb2NhbGx5SW5zaWRlKHAsIGhvbGUpICYmXG4gICAgICAgICAgICAgICAgKHRhbiA8IHRhbk1pbiB8fCAodGFuID09PSB0YW5NaW4gJiYgKHAueCA+IG0ueCB8fCAocC54ID09PSBtLnggJiYgc2VjdG9yQ29udGFpbnNTZWN0b3IobSwgcCkpKSkpKSB7XG4gICAgICAgICAgICAgICAgbSA9IHA7XG4gICAgICAgICAgICAgICAgdGFuTWluID0gdGFuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcCA9IHAubmV4dDtcbiAgICB9IHdoaWxlIChwICE9PSBzdG9wKTtcblxuICAgIHJldHVybiBtO1xufVxuXG4vLyB3aGV0aGVyIHNlY3RvciBpbiB2ZXJ0ZXggbSBjb250YWlucyBzZWN0b3IgaW4gdmVydGV4IHAgaW4gdGhlIHNhbWUgY29vcmRpbmF0ZXNcbmZ1bmN0aW9uIHNlY3RvckNvbnRhaW5zU2VjdG9yKG0sIHApIHtcbiAgICByZXR1cm4gYXJlYShtLnByZXYsIG0sIHAucHJldikgPCAwICYmIGFyZWEocC5uZXh0LCBtLCBtLm5leHQpIDwgMDtcbn1cblxuLy8gaW50ZXJsaW5rIHBvbHlnb24gbm9kZXMgaW4gei1vcmRlclxuZnVuY3Rpb24gaW5kZXhDdXJ2ZShzdGFydCwgbWluWCwgbWluWSwgaW52U2l6ZSkge1xuICAgIHZhciBwID0gc3RhcnQ7XG4gICAgZG8ge1xuICAgICAgICBpZiAocC56ID09PSBudWxsKSBwLnogPSB6T3JkZXIocC54LCBwLnksIG1pblgsIG1pblksIGludlNpemUpO1xuICAgICAgICBwLnByZXZaID0gcC5wcmV2O1xuICAgICAgICBwLm5leHRaID0gcC5uZXh0O1xuICAgICAgICBwID0gcC5uZXh0O1xuICAgIH0gd2hpbGUgKHAgIT09IHN0YXJ0KTtcblxuICAgIHAucHJldloubmV4dFogPSBudWxsO1xuICAgIHAucHJldlogPSBudWxsO1xuXG4gICAgc29ydExpbmtlZChwKTtcbn1cblxuLy8gU2ltb24gVGF0aGFtJ3MgbGlua2VkIGxpc3QgbWVyZ2Ugc29ydCBhbGdvcml0aG1cbi8vIGh0dHA6Ly93d3cuY2hpYXJrLmdyZWVuZW5kLm9yZy51ay9+c2d0YXRoYW0vYWxnb3JpdGhtcy9saXN0c29ydC5odG1sXG5mdW5jdGlvbiBzb3J0TGlua2VkKGxpc3QpIHtcbiAgICB2YXIgaSwgcCwgcSwgZSwgdGFpbCwgbnVtTWVyZ2VzLCBwU2l6ZSwgcVNpemUsXG4gICAgICAgIGluU2l6ZSA9IDE7XG5cbiAgICBkbyB7XG4gICAgICAgIHAgPSBsaXN0O1xuICAgICAgICBsaXN0ID0gbnVsbDtcbiAgICAgICAgdGFpbCA9IG51bGw7XG4gICAgICAgIG51bU1lcmdlcyA9IDA7XG5cbiAgICAgICAgd2hpbGUgKHApIHtcbiAgICAgICAgICAgIG51bU1lcmdlcysrO1xuICAgICAgICAgICAgcSA9IHA7XG4gICAgICAgICAgICBwU2l6ZSA9IDA7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaW5TaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwU2l6ZSsrO1xuICAgICAgICAgICAgICAgIHEgPSBxLm5leHRaO1xuICAgICAgICAgICAgICAgIGlmICghcSkgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxU2l6ZSA9IGluU2l6ZTtcblxuICAgICAgICAgICAgd2hpbGUgKHBTaXplID4gMCB8fCAocVNpemUgPiAwICYmIHEpKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAocFNpemUgIT09IDAgJiYgKHFTaXplID09PSAwIHx8ICFxIHx8IHAueiA8PSBxLnopKSB7XG4gICAgICAgICAgICAgICAgICAgIGUgPSBwO1xuICAgICAgICAgICAgICAgICAgICBwID0gcC5uZXh0WjtcbiAgICAgICAgICAgICAgICAgICAgcFNpemUtLTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlID0gcTtcbiAgICAgICAgICAgICAgICAgICAgcSA9IHEubmV4dFo7XG4gICAgICAgICAgICAgICAgICAgIHFTaXplLS07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRhaWwpIHRhaWwubmV4dFogPSBlO1xuICAgICAgICAgICAgICAgIGVsc2UgbGlzdCA9IGU7XG5cbiAgICAgICAgICAgICAgICBlLnByZXZaID0gdGFpbDtcbiAgICAgICAgICAgICAgICB0YWlsID0gZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcCA9IHE7XG4gICAgICAgIH1cblxuICAgICAgICB0YWlsLm5leHRaID0gbnVsbDtcbiAgICAgICAgaW5TaXplICo9IDI7XG5cbiAgICB9IHdoaWxlIChudW1NZXJnZXMgPiAxKTtcblxuICAgIHJldHVybiBsaXN0O1xufVxuXG4vLyB6LW9yZGVyIG9mIGEgcG9pbnQgZ2l2ZW4gY29vcmRzIGFuZCBpbnZlcnNlIG9mIHRoZSBsb25nZXIgc2lkZSBvZiBkYXRhIGJib3hcbmZ1bmN0aW9uIHpPcmRlcih4LCB5LCBtaW5YLCBtaW5ZLCBpbnZTaXplKSB7XG4gICAgLy8gY29vcmRzIGFyZSB0cmFuc2Zvcm1lZCBpbnRvIG5vbi1uZWdhdGl2ZSAxNS1iaXQgaW50ZWdlciByYW5nZVxuICAgIHggPSAzMjc2NyAqICh4IC0gbWluWCkgKiBpbnZTaXplO1xuICAgIHkgPSAzMjc2NyAqICh5IC0gbWluWSkgKiBpbnZTaXplO1xuXG4gICAgeCA9ICh4IHwgKHggPDwgOCkpICYgMHgwMEZGMDBGRjtcbiAgICB4ID0gKHggfCAoeCA8PCA0KSkgJiAweDBGMEYwRjBGO1xuICAgIHggPSAoeCB8ICh4IDw8IDIpKSAmIDB4MzMzMzMzMzM7XG4gICAgeCA9ICh4IHwgKHggPDwgMSkpICYgMHg1NTU1NTU1NTtcblxuICAgIHkgPSAoeSB8ICh5IDw8IDgpKSAmIDB4MDBGRjAwRkY7XG4gICAgeSA9ICh5IHwgKHkgPDwgNCkpICYgMHgwRjBGMEYwRjtcbiAgICB5ID0gKHkgfCAoeSA8PCAyKSkgJiAweDMzMzMzMzMzO1xuICAgIHkgPSAoeSB8ICh5IDw8IDEpKSAmIDB4NTU1NTU1NTU7XG5cbiAgICByZXR1cm4geCB8ICh5IDw8IDEpO1xufVxuXG4vLyBmaW5kIHRoZSBsZWZ0bW9zdCBub2RlIG9mIGEgcG9seWdvbiByaW5nXG5mdW5jdGlvbiBnZXRMZWZ0bW9zdChzdGFydCkge1xuICAgIHZhciBwID0gc3RhcnQsXG4gICAgICAgIGxlZnRtb3N0ID0gc3RhcnQ7XG4gICAgZG8ge1xuICAgICAgICBpZiAocC54IDwgbGVmdG1vc3QueCB8fCAocC54ID09PSBsZWZ0bW9zdC54ICYmIHAueSA8IGxlZnRtb3N0LnkpKSBsZWZ0bW9zdCA9IHA7XG4gICAgICAgIHAgPSBwLm5leHQ7XG4gICAgfSB3aGlsZSAocCAhPT0gc3RhcnQpO1xuXG4gICAgcmV0dXJuIGxlZnRtb3N0O1xufVxuXG4vLyBjaGVjayBpZiBhIHBvaW50IGxpZXMgd2l0aGluIGEgY29udmV4IHRyaWFuZ2xlXG5mdW5jdGlvbiBwb2ludEluVHJpYW5nbGUoYXgsIGF5LCBieCwgYnksIGN4LCBjeSwgcHgsIHB5KSB7XG4gICAgcmV0dXJuIChjeCAtIHB4KSAqIChheSAtIHB5KSAtIChheCAtIHB4KSAqIChjeSAtIHB5KSA+PSAwICYmXG4gICAgICAgICAgIChheCAtIHB4KSAqIChieSAtIHB5KSAtIChieCAtIHB4KSAqIChheSAtIHB5KSA+PSAwICYmXG4gICAgICAgICAgIChieCAtIHB4KSAqIChjeSAtIHB5KSAtIChjeCAtIHB4KSAqIChieSAtIHB5KSA+PSAwO1xufVxuXG4vLyBjaGVjayBpZiBhIGRpYWdvbmFsIGJldHdlZW4gdHdvIHBvbHlnb24gbm9kZXMgaXMgdmFsaWQgKGxpZXMgaW4gcG9seWdvbiBpbnRlcmlvcilcbmZ1bmN0aW9uIGlzVmFsaWREaWFnb25hbChhLCBiKSB7XG4gICAgcmV0dXJuIGEubmV4dC5pICE9PSBiLmkgJiYgYS5wcmV2LmkgIT09IGIuaSAmJiAhaW50ZXJzZWN0c1BvbHlnb24oYSwgYikgJiYgLy8gZG9uZXMndCBpbnRlcnNlY3Qgb3RoZXIgZWRnZXNcbiAgICAgICAgICAgKGxvY2FsbHlJbnNpZGUoYSwgYikgJiYgbG9jYWxseUluc2lkZShiLCBhKSAmJiBtaWRkbGVJbnNpZGUoYSwgYikgJiYgLy8gbG9jYWxseSB2aXNpYmxlXG4gICAgICAgICAgICAoYXJlYShhLnByZXYsIGEsIGIucHJldikgfHwgYXJlYShhLCBiLnByZXYsIGIpKSB8fCAvLyBkb2VzIG5vdCBjcmVhdGUgb3Bwb3NpdGUtZmFjaW5nIHNlY3RvcnNcbiAgICAgICAgICAgIGVxdWFscyhhLCBiKSAmJiBhcmVhKGEucHJldiwgYSwgYS5uZXh0KSA+IDAgJiYgYXJlYShiLnByZXYsIGIsIGIubmV4dCkgPiAwKTsgLy8gc3BlY2lhbCB6ZXJvLWxlbmd0aCBjYXNlXG59XG5cbi8vIHNpZ25lZCBhcmVhIG9mIGEgdHJpYW5nbGVcbmZ1bmN0aW9uIGFyZWEocCwgcSwgcikge1xuICAgIHJldHVybiAocS55IC0gcC55KSAqIChyLnggLSBxLngpIC0gKHEueCAtIHAueCkgKiAoci55IC0gcS55KTtcbn1cblxuLy8gY2hlY2sgaWYgdHdvIHBvaW50cyBhcmUgZXF1YWxcbmZ1bmN0aW9uIGVxdWFscyhwMSwgcDIpIHtcbiAgICByZXR1cm4gcDEueCA9PT0gcDIueCAmJiBwMS55ID09PSBwMi55O1xufVxuXG4vLyBjaGVjayBpZiB0d28gc2VnbWVudHMgaW50ZXJzZWN0XG5mdW5jdGlvbiBpbnRlcnNlY3RzKHAxLCBxMSwgcDIsIHEyKSB7XG4gICAgdmFyIG8xID0gc2lnbihhcmVhKHAxLCBxMSwgcDIpKTtcbiAgICB2YXIgbzIgPSBzaWduKGFyZWEocDEsIHExLCBxMikpO1xuICAgIHZhciBvMyA9IHNpZ24oYXJlYShwMiwgcTIsIHAxKSk7XG4gICAgdmFyIG80ID0gc2lnbihhcmVhKHAyLCBxMiwgcTEpKTtcblxuICAgIGlmIChvMSAhPT0gbzIgJiYgbzMgIT09IG80KSByZXR1cm4gdHJ1ZTsgLy8gZ2VuZXJhbCBjYXNlXG5cbiAgICBpZiAobzEgPT09IDAgJiYgb25TZWdtZW50KHAxLCBwMiwgcTEpKSByZXR1cm4gdHJ1ZTsgLy8gcDEsIHExIGFuZCBwMiBhcmUgY29sbGluZWFyIGFuZCBwMiBsaWVzIG9uIHAxcTFcbiAgICBpZiAobzIgPT09IDAgJiYgb25TZWdtZW50KHAxLCBxMiwgcTEpKSByZXR1cm4gdHJ1ZTsgLy8gcDEsIHExIGFuZCBxMiBhcmUgY29sbGluZWFyIGFuZCBxMiBsaWVzIG9uIHAxcTFcbiAgICBpZiAobzMgPT09IDAgJiYgb25TZWdtZW50KHAyLCBwMSwgcTIpKSByZXR1cm4gdHJ1ZTsgLy8gcDIsIHEyIGFuZCBwMSBhcmUgY29sbGluZWFyIGFuZCBwMSBsaWVzIG9uIHAycTJcbiAgICBpZiAobzQgPT09IDAgJiYgb25TZWdtZW50KHAyLCBxMSwgcTIpKSByZXR1cm4gdHJ1ZTsgLy8gcDIsIHEyIGFuZCBxMSBhcmUgY29sbGluZWFyIGFuZCBxMSBsaWVzIG9uIHAycTJcblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8gZm9yIGNvbGxpbmVhciBwb2ludHMgcCwgcSwgciwgY2hlY2sgaWYgcG9pbnQgcSBsaWVzIG9uIHNlZ21lbnQgcHJcbmZ1bmN0aW9uIG9uU2VnbWVudChwLCBxLCByKSB7XG4gICAgcmV0dXJuIHEueCA8PSBNYXRoLm1heChwLngsIHIueCkgJiYgcS54ID49IE1hdGgubWluKHAueCwgci54KSAmJiBxLnkgPD0gTWF0aC5tYXgocC55LCByLnkpICYmIHEueSA+PSBNYXRoLm1pbihwLnksIHIueSk7XG59XG5cbmZ1bmN0aW9uIHNpZ24obnVtKSB7XG4gICAgcmV0dXJuIG51bSA+IDAgPyAxIDogbnVtIDwgMCA/IC0xIDogMDtcbn1cblxuLy8gY2hlY2sgaWYgYSBwb2x5Z29uIGRpYWdvbmFsIGludGVyc2VjdHMgYW55IHBvbHlnb24gc2VnbWVudHNcbmZ1bmN0aW9uIGludGVyc2VjdHNQb2x5Z29uKGEsIGIpIHtcbiAgICB2YXIgcCA9IGE7XG4gICAgZG8ge1xuICAgICAgICBpZiAocC5pICE9PSBhLmkgJiYgcC5uZXh0LmkgIT09IGEuaSAmJiBwLmkgIT09IGIuaSAmJiBwLm5leHQuaSAhPT0gYi5pICYmXG4gICAgICAgICAgICAgICAgaW50ZXJzZWN0cyhwLCBwLm5leHQsIGEsIGIpKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcCA9IHAubmV4dDtcbiAgICB9IHdoaWxlIChwICE9PSBhKTtcblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLy8gY2hlY2sgaWYgYSBwb2x5Z29uIGRpYWdvbmFsIGlzIGxvY2FsbHkgaW5zaWRlIHRoZSBwb2x5Z29uXG5mdW5jdGlvbiBsb2NhbGx5SW5zaWRlKGEsIGIpIHtcbiAgICByZXR1cm4gYXJlYShhLnByZXYsIGEsIGEubmV4dCkgPCAwID9cbiAgICAgICAgYXJlYShhLCBiLCBhLm5leHQpID49IDAgJiYgYXJlYShhLCBhLnByZXYsIGIpID49IDAgOlxuICAgICAgICBhcmVhKGEsIGIsIGEucHJldikgPCAwIHx8IGFyZWEoYSwgYS5uZXh0LCBiKSA8IDA7XG59XG5cbi8vIGNoZWNrIGlmIHRoZSBtaWRkbGUgcG9pbnQgb2YgYSBwb2x5Z29uIGRpYWdvbmFsIGlzIGluc2lkZSB0aGUgcG9seWdvblxuZnVuY3Rpb24gbWlkZGxlSW5zaWRlKGEsIGIpIHtcbiAgICB2YXIgcCA9IGEsXG4gICAgICAgIGluc2lkZSA9IGZhbHNlLFxuICAgICAgICBweCA9IChhLnggKyBiLngpIC8gMixcbiAgICAgICAgcHkgPSAoYS55ICsgYi55KSAvIDI7XG4gICAgZG8ge1xuICAgICAgICBpZiAoKChwLnkgPiBweSkgIT09IChwLm5leHQueSA+IHB5KSkgJiYgcC5uZXh0LnkgIT09IHAueSAmJlxuICAgICAgICAgICAgICAgIChweCA8IChwLm5leHQueCAtIHAueCkgKiAocHkgLSBwLnkpIC8gKHAubmV4dC55IC0gcC55KSArIHAueCkpXG4gICAgICAgICAgICBpbnNpZGUgPSAhaW5zaWRlO1xuICAgICAgICBwID0gcC5uZXh0O1xuICAgIH0gd2hpbGUgKHAgIT09IGEpO1xuXG4gICAgcmV0dXJuIGluc2lkZTtcbn1cblxuLy8gbGluayB0d28gcG9seWdvbiB2ZXJ0aWNlcyB3aXRoIGEgYnJpZGdlOyBpZiB0aGUgdmVydGljZXMgYmVsb25nIHRvIHRoZSBzYW1lIHJpbmcsIGl0IHNwbGl0cyBwb2x5Z29uIGludG8gdHdvO1xuLy8gaWYgb25lIGJlbG9uZ3MgdG8gdGhlIG91dGVyIHJpbmcgYW5kIGFub3RoZXIgdG8gYSBob2xlLCBpdCBtZXJnZXMgaXQgaW50byBhIHNpbmdsZSByaW5nXG5mdW5jdGlvbiBzcGxpdFBvbHlnb24oYSwgYikge1xuICAgIHZhciBhMiA9IG5ldyBOb2RlKGEuaSwgYS54LCBhLnkpLFxuICAgICAgICBiMiA9IG5ldyBOb2RlKGIuaSwgYi54LCBiLnkpLFxuICAgICAgICBhbiA9IGEubmV4dCxcbiAgICAgICAgYnAgPSBiLnByZXY7XG5cbiAgICBhLm5leHQgPSBiO1xuICAgIGIucHJldiA9IGE7XG5cbiAgICBhMi5uZXh0ID0gYW47XG4gICAgYW4ucHJldiA9IGEyO1xuXG4gICAgYjIubmV4dCA9IGEyO1xuICAgIGEyLnByZXYgPSBiMjtcblxuICAgIGJwLm5leHQgPSBiMjtcbiAgICBiMi5wcmV2ID0gYnA7XG5cbiAgICByZXR1cm4gYjI7XG59XG5cbi8vIGNyZWF0ZSBhIG5vZGUgYW5kIG9wdGlvbmFsbHkgbGluayBpdCB3aXRoIHByZXZpb3VzIG9uZSAoaW4gYSBjaXJjdWxhciBkb3VibHkgbGlua2VkIGxpc3QpXG5mdW5jdGlvbiBpbnNlcnROb2RlKGksIHgsIHksIGxhc3QpIHtcbiAgICB2YXIgcCA9IG5ldyBOb2RlKGksIHgsIHkpO1xuXG4gICAgaWYgKCFsYXN0KSB7XG4gICAgICAgIHAucHJldiA9IHA7XG4gICAgICAgIHAubmV4dCA9IHA7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBwLm5leHQgPSBsYXN0Lm5leHQ7XG4gICAgICAgIHAucHJldiA9IGxhc3Q7XG4gICAgICAgIGxhc3QubmV4dC5wcmV2ID0gcDtcbiAgICAgICAgbGFzdC5uZXh0ID0gcDtcbiAgICB9XG4gICAgcmV0dXJuIHA7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZU5vZGUocCkge1xuICAgIHAubmV4dC5wcmV2ID0gcC5wcmV2O1xuICAgIHAucHJldi5uZXh0ID0gcC5uZXh0O1xuXG4gICAgaWYgKHAucHJldlopIHAucHJldloubmV4dFogPSBwLm5leHRaO1xuICAgIGlmIChwLm5leHRaKSBwLm5leHRaLnByZXZaID0gcC5wcmV2Wjtcbn1cblxuZnVuY3Rpb24gTm9kZShpLCB4LCB5KSB7XG4gICAgLy8gdmVydGV4IGluZGV4IGluIGNvb3JkaW5hdGVzIGFycmF5XG4gICAgdGhpcy5pID0gaTtcblxuICAgIC8vIHZlcnRleCBjb29yZGluYXRlc1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcblxuICAgIC8vIHByZXZpb3VzIGFuZCBuZXh0IHZlcnRleCBub2RlcyBpbiBhIHBvbHlnb24gcmluZ1xuICAgIHRoaXMucHJldiA9IG51bGw7XG4gICAgdGhpcy5uZXh0ID0gbnVsbDtcblxuICAgIC8vIHotb3JkZXIgY3VydmUgdmFsdWVcbiAgICB0aGlzLnogPSBudWxsO1xuXG4gICAgLy8gcHJldmlvdXMgYW5kIG5leHQgbm9kZXMgaW4gei1vcmRlclxuICAgIHRoaXMucHJldlogPSBudWxsO1xuICAgIHRoaXMubmV4dFogPSBudWxsO1xuXG4gICAgLy8gaW5kaWNhdGVzIHdoZXRoZXIgdGhpcyBpcyBhIHN0ZWluZXIgcG9pbnRcbiAgICB0aGlzLnN0ZWluZXIgPSBmYWxzZTtcbn1cblxuLy8gcmV0dXJuIGEgcGVyY2VudGFnZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHBvbHlnb24gYXJlYSBhbmQgaXRzIHRyaWFuZ3VsYXRpb24gYXJlYTtcbi8vIHVzZWQgdG8gdmVyaWZ5IGNvcnJlY3RuZXNzIG9mIHRyaWFuZ3VsYXRpb25cbmVhcmN1dC5kZXZpYXRpb24gPSBmdW5jdGlvbiAoZGF0YSwgaG9sZUluZGljZXMsIGRpbSwgdHJpYW5nbGVzKSB7XG4gICAgdmFyIGhhc0hvbGVzID0gaG9sZUluZGljZXMgJiYgaG9sZUluZGljZXMubGVuZ3RoO1xuICAgIHZhciBvdXRlckxlbiA9IGhhc0hvbGVzID8gaG9sZUluZGljZXNbMF0gKiBkaW0gOiBkYXRhLmxlbmd0aDtcblxuICAgIHZhciBwb2x5Z29uQXJlYSA9IE1hdGguYWJzKHNpZ25lZEFyZWEoZGF0YSwgMCwgb3V0ZXJMZW4sIGRpbSkpO1xuICAgIGlmIChoYXNIb2xlcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gaG9sZUluZGljZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGhvbGVJbmRpY2VzW2ldICogZGltO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGkgPCBsZW4gLSAxID8gaG9sZUluZGljZXNbaSArIDFdICogZGltIDogZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICBwb2x5Z29uQXJlYSAtPSBNYXRoLmFicyhzaWduZWRBcmVhKGRhdGEsIHN0YXJ0LCBlbmQsIGRpbSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRyaWFuZ2xlc0FyZWEgPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpICs9IDMpIHtcbiAgICAgICAgdmFyIGEgPSB0cmlhbmdsZXNbaV0gKiBkaW07XG4gICAgICAgIHZhciBiID0gdHJpYW5nbGVzW2kgKyAxXSAqIGRpbTtcbiAgICAgICAgdmFyIGMgPSB0cmlhbmdsZXNbaSArIDJdICogZGltO1xuICAgICAgICB0cmlhbmdsZXNBcmVhICs9IE1hdGguYWJzKFxuICAgICAgICAgICAgKGRhdGFbYV0gLSBkYXRhW2NdKSAqIChkYXRhW2IgKyAxXSAtIGRhdGFbYSArIDFdKSAtXG4gICAgICAgICAgICAoZGF0YVthXSAtIGRhdGFbYl0pICogKGRhdGFbYyArIDFdIC0gZGF0YVthICsgMV0pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcG9seWdvbkFyZWEgPT09IDAgJiYgdHJpYW5nbGVzQXJlYSA9PT0gMCA/IDAgOlxuICAgICAgICBNYXRoLmFicygodHJpYW5nbGVzQXJlYSAtIHBvbHlnb25BcmVhKSAvIHBvbHlnb25BcmVhKTtcbn07XG5cbmZ1bmN0aW9uIHNpZ25lZEFyZWEoZGF0YSwgc3RhcnQsIGVuZCwgZGltKSB7XG4gICAgdmFyIHN1bSA9IDA7XG4gICAgZm9yICh2YXIgaSA9IHN0YXJ0LCBqID0gZW5kIC0gZGltOyBpIDwgZW5kOyBpICs9IGRpbSkge1xuICAgICAgICBzdW0gKz0gKGRhdGFbal0gLSBkYXRhW2ldKSAqIChkYXRhW2kgKyAxXSArIGRhdGFbaiArIDFdKTtcbiAgICAgICAgaiA9IGk7XG4gICAgfVxuICAgIHJldHVybiBzdW07XG59XG5cbi8vIHR1cm4gYSBwb2x5Z29uIGluIGEgbXVsdGktZGltZW5zaW9uYWwgYXJyYXkgZm9ybSAoZS5nLiBhcyBpbiBHZW9KU09OKSBpbnRvIGEgZm9ybSBFYXJjdXQgYWNjZXB0c1xuZWFyY3V0LmZsYXR0ZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgIHZhciBkaW0gPSBkYXRhWzBdWzBdLmxlbmd0aCxcbiAgICAgICAgcmVzdWx0ID0ge3ZlcnRpY2VzOiBbXSwgaG9sZXM6IFtdLCBkaW1lbnNpb25zOiBkaW19LFxuICAgICAgICBob2xlSW5kZXggPSAwO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YVtpXS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBkaW07IGQrKykgcmVzdWx0LnZlcnRpY2VzLnB1c2goZGF0YVtpXVtqXVtkXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgICBob2xlSW5kZXggKz0gZGF0YVtpIC0gMV0ubGVuZ3RoO1xuICAgICAgICAgICAgcmVzdWx0LmhvbGVzLnB1c2goaG9sZUluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbiIsICIvKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjMuMiBieSBAbWF0aGlhcyAqL1xuOyhmdW5jdGlvbihyb290KSB7XG5cblx0LyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqL1xuXHR2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmXG5cdFx0IWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblx0dmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJlxuXHRcdCFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlO1xuXHR2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsO1xuXHRpZiAoXG5cdFx0ZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHxcblx0XHRmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fFxuXHRcdGZyZWVHbG9iYWwuc2VsZiA9PT0gZnJlZUdsb2JhbFxuXHQpIHtcblx0XHRyb290ID0gZnJlZUdsb2JhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuXG5cdCAqIEBuYW1lIHB1bnljb2RlXG5cdCAqIEB0eXBlIE9iamVjdFxuXHQgKi9cblx0dmFyIHB1bnljb2RlLFxuXG5cdC8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi9cblx0bWF4SW50ID0gMjE0NzQ4MzY0NywgLy8gYWthLiAweDdGRkZGRkZGIG9yIDJeMzEtMVxuXG5cdC8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi9cblx0YmFzZSA9IDM2LFxuXHR0TWluID0gMSxcblx0dE1heCA9IDI2LFxuXHRza2V3ID0gMzgsXG5cdGRhbXAgPSA3MDAsXG5cdGluaXRpYWxCaWFzID0gNzIsXG5cdGluaXRpYWxOID0gMTI4LCAvLyAweDgwXG5cdGRlbGltaXRlciA9ICctJywgLy8gJ1xceDJEJ1xuXG5cdC8qKiBSZWd1bGFyIGV4cHJlc3Npb25zICovXG5cdHJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLFxuXHRyZWdleE5vbkFTQ0lJID0gL1teXFx4MjAtXFx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnNcblx0cmVnZXhTZXBhcmF0b3JzID0gL1tcXHgyRVxcdTMwMDJcXHVGRjBFXFx1RkY2MV0vZywgLy8gUkZDIDM0OTAgc2VwYXJhdG9yc1xuXG5cdC8qKiBFcnJvciBtZXNzYWdlcyAqL1xuXHRlcnJvcnMgPSB7XG5cdFx0J292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJyxcblx0XHQnbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLFxuXHRcdCdpbnZhbGlkLWlucHV0JzogJ0ludmFsaWQgaW5wdXQnXG5cdH0sXG5cblx0LyoqIENvbnZlbmllbmNlIHNob3J0Y3V0cyAqL1xuXHRiYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sXG5cdGZsb29yID0gTWF0aC5mbG9vcixcblx0c3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZSxcblxuXHQvKiogVGVtcG9yYXJ5IHZhcmlhYmxlICovXG5cdGtleTtcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQvKipcblx0ICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLlxuXHQgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuXG5cdCAqL1xuXHRmdW5jdGlvbiBlcnJvcih0eXBlKSB7XG5cdFx0dGhyb3cgUmFuZ2VFcnJvcihlcnJvcnNbdHlwZV0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEEgZ2VuZXJpYyBgQXJyYXkjbWFwYCB1dGlsaXR5IGZ1bmN0aW9uLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgYXJyYXlcblx0ICogaXRlbS5cblx0ICogQHJldHVybnMge0FycmF5fSBBIG5ldyBhcnJheSBvZiB2YWx1ZXMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uLlxuXHQgKi9cblx0ZnVuY3Rpb24gbWFwKGFycmF5LCBmbikge1xuXHRcdHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG5cdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdHdoaWxlIChsZW5ndGgtLSkge1xuXHRcdFx0cmVzdWx0W2xlbmd0aF0gPSBmbihhcnJheVtsZW5ndGhdKTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWxcblx0ICogYWRkcmVzc2VzLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnlcblx0ICogY2hhcmFjdGVyLlxuXHQgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFja1xuXHQgKiBmdW5jdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7XG5cdFx0dmFyIHBhcnRzID0gc3RyaW5nLnNwbGl0KCdAJyk7XG5cdFx0dmFyIHJlc3VsdCA9ICcnO1xuXHRcdGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG5cdFx0XHQvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlXG5cdFx0XHQvLyB0aGUgbG9jYWwgcGFydCAoaS5lLiBldmVyeXRoaW5nIHVwIHRvIGBAYCkgaW50YWN0LlxuXHRcdFx0cmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7XG5cdFx0XHRzdHJpbmcgPSBwYXJ0c1sxXTtcblx0XHR9XG5cdFx0Ly8gQXZvaWQgYHNwbGl0KHJlZ2V4KWAgZm9yIElFOCBjb21wYXRpYmlsaXR5LiBTZWUgIzE3LlxuXHRcdHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1xceDJFJyk7XG5cdFx0dmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpO1xuXHRcdHZhciBlbmNvZGVkID0gbWFwKGxhYmVscywgZm4pLmpvaW4oJy4nKTtcblx0XHRyZXR1cm4gcmVzdWx0ICsgZW5jb2RlZDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIG51bWVyaWMgY29kZSBwb2ludHMgb2YgZWFjaCBVbmljb2RlXG5cdCAqIGNoYXJhY3RlciBpbiB0aGUgc3RyaW5nLiBXaGlsZSBKYXZhU2NyaXB0IHVzZXMgVUNTLTIgaW50ZXJuYWxseSxcblx0ICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2hcblx0ICogVUNTLTIgZXhwb3NlcyBhcyBzZXBhcmF0ZSBjaGFyYWN0ZXJzKSBpbnRvIGEgc2luZ2xlIGNvZGUgcG9pbnQsXG5cdCAqIG1hdGNoaW5nIFVURi0xNi5cblx0ICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgXG5cdCAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMlxuXHQgKiBAbmFtZSBkZWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IHN0cmluZyBUaGUgVW5pY29kZSBpbnB1dCBzdHJpbmcgKFVDUy0yKS5cblx0ICogQHJldHVybnMge0FycmF5fSBUaGUgbmV3IGFycmF5IG9mIGNvZGUgcG9pbnRzLlxuXHQgKi9cblx0ZnVuY3Rpb24gdWNzMmRlY29kZShzdHJpbmcpIHtcblx0XHR2YXIgb3V0cHV0ID0gW10sXG5cdFx0ICAgIGNvdW50ZXIgPSAwLFxuXHRcdCAgICBsZW5ndGggPSBzdHJpbmcubGVuZ3RoLFxuXHRcdCAgICB2YWx1ZSxcblx0XHQgICAgZXh0cmE7XG5cdFx0d2hpbGUgKGNvdW50ZXIgPCBsZW5ndGgpIHtcblx0XHRcdHZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdGlmICh2YWx1ZSA+PSAweEQ4MDAgJiYgdmFsdWUgPD0gMHhEQkZGICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcblx0XHRcdFx0Ly8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyXG5cdFx0XHRcdGV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdFx0aWYgKChleHRyYSAmIDB4RkMwMCkgPT0gMHhEQzAwKSB7IC8vIGxvdyBzdXJyb2dhdGVcblx0XHRcdFx0XHRvdXRwdXQucHVzaCgoKHZhbHVlICYgMHgzRkYpIDw8IDEwKSArIChleHRyYSAmIDB4M0ZGKSArIDB4MTAwMDApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlIHRoZSBuZXh0XG5cdFx0XHRcdFx0Ly8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyXG5cdFx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0XHRcdGNvdW50ZXItLTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBzdHJpbmcgYmFzZWQgb24gYW4gYXJyYXkgb2YgbnVtZXJpYyBjb2RlIHBvaW50cy5cblx0ICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyXG5cdCAqIEBuYW1lIGVuY29kZVxuXHQgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgbmV3IFVuaWNvZGUgc3RyaW5nIChVQ1MtMikuXG5cdCAqL1xuXHRmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7XG5cdFx0cmV0dXJuIG1hcChhcnJheSwgZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdHZhciBvdXRwdXQgPSAnJztcblx0XHRcdGlmICh2YWx1ZSA+IDB4RkZGRikge1xuXHRcdFx0XHR2YWx1ZSAtPSAweDEwMDAwO1xuXHRcdFx0XHRvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTtcblx0XHRcdFx0dmFsdWUgPSAweERDMDAgfCB2YWx1ZSAmIDB4M0ZGO1xuXHRcdFx0fVxuXHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSk7XG5cdFx0XHRyZXR1cm4gb3V0cHV0O1xuXHRcdH0pLmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgYmFzaWMgY29kZSBwb2ludCBpbnRvIGEgZGlnaXQvaW50ZWdlci5cblx0ICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlUG9pbnQgVGhlIGJhc2ljIG51bWVyaWMgY29kZSBwb2ludCB2YWx1ZS5cblx0ICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluXG5cdCAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaW4gdGhlIHJhbmdlIGAwYCB0byBgYmFzZSAtIDFgLCBvciBgYmFzZWAgaWZcblx0ICogdGhlIGNvZGUgcG9pbnQgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsdWUuXG5cdCAqL1xuXHRmdW5jdGlvbiBiYXNpY1RvRGlnaXQoY29kZVBvaW50KSB7XG5cdFx0aWYgKGNvZGVQb2ludCAtIDQ4IDwgMTApIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSAyMjtcblx0XHR9XG5cdFx0aWYgKGNvZGVQb2ludCAtIDY1IDwgMjYpIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSA2NTtcblx0XHR9XG5cdFx0aWYgKGNvZGVQb2ludCAtIDk3IDwgMjYpIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSA5Nztcblx0XHR9XG5cdFx0cmV0dXJuIGJhc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBkaWdpdC9pbnRlZ2VyIGludG8gYSBiYXNpYyBjb2RlIHBvaW50LlxuXHQgKiBAc2VlIGBiYXNpY1RvRGlnaXQoKWBcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtOdW1iZXJ9IGRpZ2l0IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludC5cblx0ICogQHJldHVybnMge051bWJlcn0gVGhlIGJhc2ljIGNvZGUgcG9pbnQgd2hvc2UgdmFsdWUgKHdoZW4gdXNlZCBmb3Jcblx0ICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2Vcblx0ICogYDBgIHRvIGBiYXNlIC0gMWAuIElmIGBmbGFnYCBpcyBub24temVybywgdGhlIHVwcGVyY2FzZSBmb3JtIGlzXG5cdCAqIHVzZWQ7IGVsc2UsIHRoZSBsb3dlcmNhc2UgZm9ybSBpcyB1c2VkLiBUaGUgYmVoYXZpb3IgaXMgdW5kZWZpbmVkXG5cdCAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uXG5cdCAqL1xuXHRmdW5jdGlvbiBkaWdpdFRvQmFzaWMoZGlnaXQsIGZsYWcpIHtcblx0XHQvLyAgMC4uMjUgbWFwIHRvIEFTQ0lJIGEuLnogb3IgQS4uWlxuXHRcdC8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOVxuXHRcdHJldHVybiBkaWdpdCArIDIyICsgNzUgKiAoZGlnaXQgPCAyNikgLSAoKGZsYWcgIT0gMCkgPDwgNSk7XG5cdH1cblxuXHQvKipcblx0ICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi5cblx0ICogaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0ZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7XG5cdFx0dmFyIGsgPSAwO1xuXHRcdGRlbHRhID0gZmlyc3RUaW1lID8gZmxvb3IoZGVsdGEgLyBkYW1wKSA6IGRlbHRhID4+IDE7XG5cdFx0ZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpO1xuXHRcdGZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7XG5cdFx0XHRkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7XG5cdFx0fVxuXHRcdHJldHVybiBmbG9vcihrICsgKGJhc2VNaW51c1RNaW4gKyAxKSAqIGRlbHRhIC8gKGRlbHRhICsgc2tldykpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scyB0byBhIHN0cmluZyBvZiBVbmljb2RlXG5cdCAqIHN5bWJvbHMuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy5cblx0ICovXG5cdGZ1bmN0aW9uIGRlY29kZShpbnB1dCkge1xuXHRcdC8vIERvbid0IHVzZSBVQ1MtMlxuXHRcdHZhciBvdXRwdXQgPSBbXSxcblx0XHQgICAgaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGgsXG5cdFx0ICAgIG91dCxcblx0XHQgICAgaSA9IDAsXG5cdFx0ICAgIG4gPSBpbml0aWFsTixcblx0XHQgICAgYmlhcyA9IGluaXRpYWxCaWFzLFxuXHRcdCAgICBiYXNpYyxcblx0XHQgICAgaixcblx0XHQgICAgaW5kZXgsXG5cdFx0ICAgIG9sZGksXG5cdFx0ICAgIHcsXG5cdFx0ICAgIGssXG5cdFx0ICAgIGRpZ2l0LFxuXHRcdCAgICB0LFxuXHRcdCAgICAvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi9cblx0XHQgICAgYmFzZU1pbnVzVDtcblxuXHRcdC8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZVxuXHRcdC8vIHBvaW50cyBiZWZvcmUgdGhlIGxhc3QgZGVsaW1pdGVyLCBvciBgMGAgaWYgdGhlcmUgaXMgbm9uZSwgdGhlbiBjb3B5XG5cdFx0Ly8gdGhlIGZpcnN0IGJhc2ljIGNvZGUgcG9pbnRzIHRvIHRoZSBvdXRwdXQuXG5cblx0XHRiYXNpYyA9IGlucHV0Lmxhc3RJbmRleE9mKGRlbGltaXRlcik7XG5cdFx0aWYgKGJhc2ljIDwgMCkge1xuXHRcdFx0YmFzaWMgPSAwO1xuXHRcdH1cblxuXHRcdGZvciAoaiA9IDA7IGogPCBiYXNpYzsgKytqKSB7XG5cdFx0XHQvLyBpZiBpdCdzIG5vdCBhIGJhc2ljIGNvZGUgcG9pbnRcblx0XHRcdGlmIChpbnB1dC5jaGFyQ29kZUF0KGopID49IDB4ODApIHtcblx0XHRcdFx0ZXJyb3IoJ25vdC1iYXNpYycpO1xuXHRcdFx0fVxuXHRcdFx0b3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7XG5cdFx0fVxuXG5cdFx0Ly8gTWFpbiBkZWNvZGluZyBsb29wOiBzdGFydCBqdXN0IGFmdGVyIHRoZSBsYXN0IGRlbGltaXRlciBpZiBhbnkgYmFzaWMgY29kZVxuXHRcdC8vIHBvaW50cyB3ZXJlIGNvcGllZDsgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvdGhlcndpc2UuXG5cblx0XHRmb3IgKGluZGV4ID0gYmFzaWMgPiAwID8gYmFzaWMgKyAxIDogMDsgaW5kZXggPCBpbnB1dExlbmd0aDsgLyogbm8gZmluYWwgZXhwcmVzc2lvbiAqLykge1xuXG5cdFx0XHQvLyBgaW5kZXhgIGlzIHRoZSBpbmRleCBvZiB0aGUgbmV4dCBjaGFyYWN0ZXIgdG8gYmUgY29uc3VtZWQuXG5cdFx0XHQvLyBEZWNvZGUgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlciBpbnRvIGBkZWx0YWAsXG5cdFx0XHQvLyB3aGljaCBnZXRzIGFkZGVkIHRvIGBpYC4gVGhlIG92ZXJmbG93IGNoZWNraW5nIGlzIGVhc2llclxuXHRcdFx0Ly8gaWYgd2UgaW5jcmVhc2UgYGlgIGFzIHdlIGdvLCB0aGVuIHN1YnRyYWN0IG9mZiBpdHMgc3RhcnRpbmdcblx0XHRcdC8vIHZhbHVlIGF0IHRoZSBlbmQgdG8gb2J0YWluIGBkZWx0YWAuXG5cdFx0XHRmb3IgKG9sZGkgPSBpLCB3ID0gMSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7XG5cblx0XHRcdFx0aWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRpZ2l0ID0gYmFzaWNUb0RpZ2l0KGlucHV0LmNoYXJDb2RlQXQoaW5kZXgrKykpO1xuXG5cdFx0XHRcdGlmIChkaWdpdCA+PSBiYXNlIHx8IGRpZ2l0ID4gZmxvb3IoKG1heEludCAtIGkpIC8gdykpIHtcblx0XHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGkgKz0gZGlnaXQgKiB3O1xuXHRcdFx0XHR0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTtcblxuXHRcdFx0XHRpZiAoZGlnaXQgPCB0KSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRiYXNlTWludXNUID0gYmFzZSAtIHQ7XG5cdFx0XHRcdGlmICh3ID4gZmxvb3IobWF4SW50IC8gYmFzZU1pbnVzVCkpIHtcblx0XHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHcgKj0gYmFzZU1pbnVzVDtcblxuXHRcdFx0fVxuXG5cdFx0XHRvdXQgPSBvdXRwdXQubGVuZ3RoICsgMTtcblx0XHRcdGJpYXMgPSBhZGFwdChpIC0gb2xkaSwgb3V0LCBvbGRpID09IDApO1xuXG5cdFx0XHQvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLFxuXHRcdFx0Ly8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzpcblx0XHRcdGlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHtcblx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHR9XG5cblx0XHRcdG4gKz0gZmxvb3IoaSAvIG91dCk7XG5cdFx0XHRpICU9IG91dDtcblxuXHRcdFx0Ly8gSW5zZXJ0IGBuYCBhdCBwb3NpdGlvbiBgaWAgb2YgdGhlIG91dHB1dFxuXHRcdFx0b3V0cHV0LnNwbGljZShpKyssIDAsIG4pO1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMgKGUuZy4gYSBkb21haW4gbmFtZSBsYWJlbCkgdG8gYVxuXHQgKiBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqL1xuXHRmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHtcblx0XHR2YXIgbixcblx0XHQgICAgZGVsdGEsXG5cdFx0ICAgIGhhbmRsZWRDUENvdW50LFxuXHRcdCAgICBiYXNpY0xlbmd0aCxcblx0XHQgICAgYmlhcyxcblx0XHQgICAgaixcblx0XHQgICAgbSxcblx0XHQgICAgcSxcblx0XHQgICAgayxcblx0XHQgICAgdCxcblx0XHQgICAgY3VycmVudFZhbHVlLFxuXHRcdCAgICBvdXRwdXQgPSBbXSxcblx0XHQgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi9cblx0XHQgICAgaW5wdXRMZW5ndGgsXG5cdFx0ICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xuXHRcdCAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsXG5cdFx0ICAgIGJhc2VNaW51c1QsXG5cdFx0ICAgIHFNaW51c1Q7XG5cblx0XHQvLyBDb252ZXJ0IHRoZSBpbnB1dCBpbiBVQ1MtMiB0byBVbmljb2RlXG5cdFx0aW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTtcblxuXHRcdC8vIENhY2hlIHRoZSBsZW5ndGhcblx0XHRpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblxuXHRcdC8vIEluaXRpYWxpemUgdGhlIHN0YXRlXG5cdFx0biA9IGluaXRpYWxOO1xuXHRcdGRlbHRhID0gMDtcblx0XHRiaWFzID0gaW5pdGlhbEJpYXM7XG5cblx0XHQvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzXG5cdFx0Zm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdGN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdO1xuXHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGhhbmRsZWRDUENvdW50ID0gYmFzaWNMZW5ndGggPSBvdXRwdXQubGVuZ3RoO1xuXG5cdFx0Ly8gYGhhbmRsZWRDUENvdW50YCBpcyB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIGhhbmRsZWQ7XG5cdFx0Ly8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLlxuXG5cdFx0Ly8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyXG5cdFx0aWYgKGJhc2ljTGVuZ3RoKSB7XG5cdFx0XHRvdXRwdXQucHVzaChkZWxpbWl0ZXIpO1xuXHRcdH1cblxuXHRcdC8vIE1haW4gZW5jb2RpbmcgbG9vcDpcblx0XHR3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkge1xuXG5cdFx0XHQvLyBBbGwgbm9uLWJhc2ljIGNvZGUgcG9pbnRzIDwgbiBoYXZlIGJlZW4gaGFuZGxlZCBhbHJlYWR5LiBGaW5kIHRoZSBuZXh0XG5cdFx0XHQvLyBsYXJnZXIgb25lOlxuXHRcdFx0Zm9yIChtID0gbWF4SW50LCBqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cdFx0XHRcdGlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7XG5cdFx0XHRcdFx0bSA9IGN1cnJlbnRWYWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sXG5cdFx0XHQvLyBidXQgZ3VhcmQgYWdhaW5zdCBvdmVyZmxvd1xuXHRcdFx0aGFuZGxlZENQQ291bnRQbHVzT25lID0gaGFuZGxlZENQQ291bnQgKyAxO1xuXHRcdFx0aWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHtcblx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHR9XG5cblx0XHRcdGRlbHRhICs9IChtIC0gbikgKiBoYW5kbGVkQ1BDb3VudFBsdXNPbmU7XG5cdFx0XHRuID0gbTtcblxuXHRcdFx0Zm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA8IG4gJiYgKytkZWx0YSA+IG1heEludCkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7XG5cdFx0XHRcdFx0Ly8gUmVwcmVzZW50IGRlbHRhIGFzIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXJcblx0XHRcdFx0XHRmb3IgKHEgPSBkZWx0YSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7XG5cdFx0XHRcdFx0XHR0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTtcblx0XHRcdFx0XHRcdGlmIChxIDwgdCkge1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHFNaW51c1QgPSBxIC0gdDtcblx0XHRcdFx0XHRcdGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcblx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKFxuXHRcdFx0XHRcdFx0XHRzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0cSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHEsIDApKSk7XG5cdFx0XHRcdFx0YmlhcyA9IGFkYXB0KGRlbHRhLCBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsIGhhbmRsZWRDUENvdW50ID09IGJhc2ljTGVuZ3RoKTtcblx0XHRcdFx0XHRkZWx0YSA9IDA7XG5cdFx0XHRcdFx0KytoYW5kbGVkQ1BDb3VudDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQrK2RlbHRhO1xuXHRcdFx0KytuO1xuXG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzc1xuXHQgKiB0byBVbmljb2RlLiBPbmx5IHRoZSBQdW55Y29kZWQgcGFydHMgb2YgdGhlIGlucHV0IHdpbGwgYmUgY29udmVydGVkLCBpLmUuXG5cdCAqIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IG9uIGEgc3RyaW5nIHRoYXQgaGFzIGFscmVhZHkgYmVlblxuXHQgKiBjb252ZXJ0ZWQgdG8gVW5pY29kZS5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGVkIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG9cblx0ICogY29udmVydCB0byBVbmljb2RlLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgVW5pY29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gUHVueWNvZGVcblx0ICogc3RyaW5nLlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9Vbmljb2RlKGlucHV0KSB7XG5cdFx0cmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24oc3RyaW5nKSB7XG5cdFx0XHRyZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZylcblx0XHRcdFx0PyBkZWNvZGUoc3RyaW5nLnNsaWNlKDQpLnRvTG93ZXJDYXNlKCkpXG5cdFx0XHRcdDogc3RyaW5nO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgVW5pY29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcyB0b1xuXHQgKiBQdW55Y29kZS4gT25seSB0aGUgbm9uLUFTQ0lJIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB3aWxsIGJlIGNvbnZlcnRlZCxcblx0ICogaS5lLiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQncyBhbHJlYWR5IGluXG5cdCAqIEFTQ0lJLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvIGNvbnZlcnQsIGFzIGFcblx0ICogVW5pY29kZSBzdHJpbmcuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBQdW55Y29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gZG9tYWluIG5hbWUgb3Jcblx0ICogZW1haWwgYWRkcmVzcy5cblx0ICovXG5cdGZ1bmN0aW9uIHRvQVNDSUkoaW5wdXQpIHtcblx0XHRyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHtcblx0XHRcdHJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKVxuXHRcdFx0XHQ/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpXG5cdFx0XHRcdDogc3RyaW5nO1xuXHRcdH0pO1xuXHR9XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0LyoqIERlZmluZSB0aGUgcHVibGljIEFQSSAqL1xuXHRwdW55Y29kZSA9IHtcblx0XHQvKipcblx0XHQgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgUHVueWNvZGUuanMgdmVyc2lvbiBudW1iZXIuXG5cdFx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdFx0ICogQHR5cGUgU3RyaW5nXG5cdFx0ICovXG5cdFx0J3ZlcnNpb24nOiAnMS4zLjInLFxuXHRcdC8qKlxuXHRcdCAqIEFuIG9iamVjdCBvZiBtZXRob2RzIHRvIGNvbnZlcnQgZnJvbSBKYXZhU2NyaXB0J3MgaW50ZXJuYWwgY2hhcmFjdGVyXG5cdFx0ICogcmVwcmVzZW50YXRpb24gKFVDUy0yKSB0byBVbmljb2RlIGNvZGUgcG9pbnRzLCBhbmQgYmFjay5cblx0XHQgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz5cblx0XHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0XHQgKiBAdHlwZSBPYmplY3Rcblx0XHQgKi9cblx0XHQndWNzMic6IHtcblx0XHRcdCdkZWNvZGUnOiB1Y3MyZGVjb2RlLFxuXHRcdFx0J2VuY29kZSc6IHVjczJlbmNvZGVcblx0XHR9LFxuXHRcdCdkZWNvZGUnOiBkZWNvZGUsXG5cdFx0J2VuY29kZSc6IGVuY29kZSxcblx0XHQndG9BU0NJSSc6IHRvQVNDSUksXG5cdFx0J3RvVW5pY29kZSc6IHRvVW5pY29kZVxuXHR9O1xuXG5cdC8qKiBFeHBvc2UgYHB1bnljb2RlYCAqL1xuXHQvLyBTb21lIEFNRCBidWlsZCBvcHRpbWl6ZXJzLCBsaWtlIHIuanMsIGNoZWNrIGZvciBzcGVjaWZpYyBjb25kaXRpb24gcGF0dGVybnNcblx0Ly8gbGlrZSB0aGUgZm9sbG93aW5nOlxuXHRpZiAoXG5cdFx0dHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmXG5cdFx0dHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiZcblx0XHRkZWZpbmUuYW1kXG5cdCkge1xuXHRcdGRlZmluZSgncHVueWNvZGUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBwdW55Y29kZTtcblx0XHR9KTtcblx0fSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG5cdFx0aWYgKG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzKSB7IC8vIGluIE5vZGUuanMgb3IgUmluZ29KUyB2MC44LjArXG5cdFx0XHRmcmVlTW9kdWxlLmV4cG9ydHMgPSBwdW55Y29kZTtcblx0XHR9IGVsc2UgeyAvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLVxuXHRcdFx0Zm9yIChrZXkgaW4gcHVueWNvZGUpIHtcblx0XHRcdFx0cHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHsgLy8gaW4gUmhpbm8gb3IgYSB3ZWIgYnJvd3NlclxuXHRcdHJvb3QucHVueWNvZGUgPSBwdW55Y29kZTtcblx0fVxuXG59KHRoaXMpKTtcbiIsICIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1N0cmluZzogZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHR5cGVvZihhcmcpID09PSAnc3RyaW5nJztcbiAgfSxcbiAgaXNPYmplY3Q6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xuICB9LFxuICBpc051bGw6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiBhcmcgPT09IG51bGw7XG4gIH0sXG4gIGlzTnVsbE9yVW5kZWZpbmVkOiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gYXJnID09IG51bGw7XG4gIH1cbn07XG4iLCAiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gSWYgb2JqLmhhc093blByb3BlcnR5IGhhcyBiZWVuIG92ZXJyaWRkZW4sIHRoZW4gY2FsbGluZ1xuLy8gb2JqLmhhc093blByb3BlcnR5KHByb3ApIHdpbGwgYnJlYWsuXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvMTcwN1xuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihxcywgc2VwLCBlcSwgb3B0aW9ucykge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgdmFyIG9iaiA9IHt9O1xuXG4gIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICB2YXIgcmVnZXhwID0gL1xcKy9nO1xuICBxcyA9IHFzLnNwbGl0KHNlcCk7XG5cbiAgdmFyIG1heEtleXMgPSAxMDAwO1xuICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykge1xuICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7XG4gIH1cblxuICB2YXIgbGVuID0gcXMubGVuZ3RoO1xuICAvLyBtYXhLZXlzIDw9IDAgbWVhbnMgdGhhdCB3ZSBzaG91bGQgbm90IGxpbWl0IGtleXMgY291bnRcbiAgaWYgKG1heEtleXMgPiAwICYmIGxlbiA+IG1heEtleXMpIHtcbiAgICBsZW4gPSBtYXhLZXlzO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIHZhciB4ID0gcXNbaV0ucmVwbGFjZShyZWdleHAsICclMjAnKSxcbiAgICAgICAgaWR4ID0geC5pbmRleE9mKGVxKSxcbiAgICAgICAga3N0ciwgdnN0ciwgaywgdjtcblxuICAgIGlmIChpZHggPj0gMCkge1xuICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7XG4gICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtzdHIgPSB4O1xuICAgICAgdnN0ciA9ICcnO1xuICAgIH1cblxuICAgIGsgPSBkZWNvZGVVUklDb21wb25lbnQoa3N0cik7XG4gICAgdiA9IGRlY29kZVVSSUNvbXBvbmVudCh2c3RyKTtcblxuICAgIGlmICghaGFzT3duUHJvcGVydHkob2JqLCBrKSkge1xuICAgICAgb2JqW2tdID0gdjtcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgb2JqW2tdLnB1c2godik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9ialtrXSA9IFtvYmpba10sIHZdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59O1xuIiwgIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7XG4gIHN3aXRjaCAodHlwZW9mIHYpIHtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIHY7XG5cbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiB2ID8gJ3RydWUnIDogJ2ZhbHNlJztcblxuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gaXNGaW5pdGUodikgPyB2IDogJyc7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICcnO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaiwgc2VwLCBlcSwgbmFtZSkge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgaWYgKG9iaiA9PT0gbnVsbCkge1xuICAgIG9iaiA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopLm1hcChmdW5jdGlvbihrKSB7XG4gICAgICB2YXIga3MgPSBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKGspKSArIGVxO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgICByZXR1cm4gb2JqW2tdLm1hcChmdW5jdGlvbih2KSB7XG4gICAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZSh2KSk7XG4gICAgICAgIH0pLmpvaW4oc2VwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqW2tdKSk7XG4gICAgICB9XG4gICAgfSkuam9pbihzZXApO1xuXG4gIH1cblxuICBpZiAoIW5hbWUpIHJldHVybiAnJztcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUobmFtZSkpICsgZXEgK1xuICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTtcbn07XG4iLCAiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSByZXF1aXJlKCcuL2RlY29kZScpO1xuZXhwb3J0cy5lbmNvZGUgPSBleHBvcnRzLnN0cmluZ2lmeSA9IHJlcXVpcmUoJy4vZW5jb2RlJyk7XG4iLCAiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHB1bnljb2RlID0gcmVxdWlyZSgncHVueWNvZGUnKTtcbnZhciB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyk7XG5cbmV4cG9ydHMucGFyc2UgPSB1cmxQYXJzZTtcbmV4cG9ydHMucmVzb2x2ZSA9IHVybFJlc29sdmU7XG5leHBvcnRzLnJlc29sdmVPYmplY3QgPSB1cmxSZXNvbHZlT2JqZWN0O1xuZXhwb3J0cy5mb3JtYXQgPSB1cmxGb3JtYXQ7XG5cbmV4cG9ydHMuVXJsID0gVXJsO1xuXG5mdW5jdGlvbiBVcmwoKSB7XG4gIHRoaXMucHJvdG9jb2wgPSBudWxsO1xuICB0aGlzLnNsYXNoZXMgPSBudWxsO1xuICB0aGlzLmF1dGggPSBudWxsO1xuICB0aGlzLmhvc3QgPSBudWxsO1xuICB0aGlzLnBvcnQgPSBudWxsO1xuICB0aGlzLmhvc3RuYW1lID0gbnVsbDtcbiAgdGhpcy5oYXNoID0gbnVsbDtcbiAgdGhpcy5zZWFyY2ggPSBudWxsO1xuICB0aGlzLnF1ZXJ5ID0gbnVsbDtcbiAgdGhpcy5wYXRobmFtZSA9IG51bGw7XG4gIHRoaXMucGF0aCA9IG51bGw7XG4gIHRoaXMuaHJlZiA9IG51bGw7XG59XG5cbi8vIFJlZmVyZW5jZTogUkZDIDM5ODYsIFJGQyAxODA4LCBSRkMgMjM5NlxuXG4vLyBkZWZpbmUgdGhlc2UgaGVyZSBzbyBhdCBsZWFzdCB0aGV5IG9ubHkgaGF2ZSB0byBiZVxuLy8gY29tcGlsZWQgb25jZSBvbiB0aGUgZmlyc3QgbW9kdWxlIGxvYWQuXG52YXIgcHJvdG9jb2xQYXR0ZXJuID0gL14oW2EtejAtOS4rLV0rOikvaSxcbiAgICBwb3J0UGF0dGVybiA9IC86WzAtOV0qJC8sXG5cbiAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGEgc2ltcGxlIHBhdGggVVJMXG4gICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcXC9cXC8/KD8hXFwvKVteXFw/XFxzXSopKFxcP1teXFxzXSopPyQvLFxuXG4gICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgcmVzZXJ2ZWQgZm9yIGRlbGltaXRpbmcgVVJMcy5cbiAgICAvLyBXZSBhY3R1YWxseSBqdXN0IGF1dG8tZXNjYXBlIHRoZXNlLlxuICAgIGRlbGltcyA9IFsnPCcsICc+JywgJ1wiJywgJ2AnLCAnICcsICdcXHInLCAnXFxuJywgJ1xcdCddLFxuXG4gICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgbm90IGFsbG93ZWQgZm9yIHZhcmlvdXMgcmVhc29ucy5cbiAgICB1bndpc2UgPSBbJ3snLCAnfScsICd8JywgJ1xcXFwnLCAnXicsICdgJ10uY29uY2F0KGRlbGltcyksXG5cbiAgICAvLyBBbGxvd2VkIGJ5IFJGQ3MsIGJ1dCBjYXVzZSBvZiBYU1MgYXR0YWNrcy4gIEFsd2F5cyBlc2NhcGUgdGhlc2UuXG4gICAgYXV0b0VzY2FwZSA9IFsnXFwnJ10uY29uY2F0KHVud2lzZSksXG4gICAgLy8gQ2hhcmFjdGVycyB0aGF0IGFyZSBuZXZlciBldmVyIGFsbG93ZWQgaW4gYSBob3N0bmFtZS5cbiAgICAvLyBOb3RlIHRoYXQgYW55IGludmFsaWQgY2hhcnMgYXJlIGFsc28gaGFuZGxlZCwgYnV0IHRoZXNlXG4gICAgLy8gYXJlIHRoZSBvbmVzIHRoYXQgYXJlICpleHBlY3RlZCogdG8gYmUgc2Vlbiwgc28gd2UgZmFzdC1wYXRoXG4gICAgLy8gdGhlbS5cbiAgICBub25Ib3N0Q2hhcnMgPSBbJyUnLCAnLycsICc/JywgJzsnLCAnIyddLmNvbmNhdChhdXRvRXNjYXBlKSxcbiAgICBob3N0RW5kaW5nQ2hhcnMgPSBbJy8nLCAnPycsICcjJ10sXG4gICAgaG9zdG5hbWVNYXhMZW4gPSAyNTUsXG4gICAgaG9zdG5hbWVQYXJ0UGF0dGVybiA9IC9eWythLXowLTlBLVpfLV17MCw2M30kLyxcbiAgICBob3N0bmFtZVBhcnRTdGFydCA9IC9eKFsrYS16MC05QS1aXy1dezAsNjN9KSguKikkLyxcbiAgICAvLyBwcm90b2NvbHMgdGhhdCBjYW4gYWxsb3cgXCJ1bnNhZmVcIiBhbmQgXCJ1bndpc2VcIiBjaGFycy5cbiAgICB1bnNhZmVQcm90b2NvbCA9IHtcbiAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSxcbiAgICAgICdqYXZhc2NyaXB0Oic6IHRydWVcbiAgICB9LFxuICAgIC8vIHByb3RvY29scyB0aGF0IG5ldmVyIGhhdmUgYSBob3N0bmFtZS5cbiAgICBob3N0bGVzc1Byb3RvY29sID0ge1xuICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLFxuICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZVxuICAgIH0sXG4gICAgLy8gcHJvdG9jb2xzIHRoYXQgYWx3YXlzIGNvbnRhaW4gYSAvLyBiaXQuXG4gICAgc2xhc2hlZFByb3RvY29sID0ge1xuICAgICAgJ2h0dHAnOiB0cnVlLFxuICAgICAgJ2h0dHBzJzogdHJ1ZSxcbiAgICAgICdmdHAnOiB0cnVlLFxuICAgICAgJ2dvcGhlcic6IHRydWUsXG4gICAgICAnZmlsZSc6IHRydWUsXG4gICAgICAnaHR0cDonOiB0cnVlLFxuICAgICAgJ2h0dHBzOic6IHRydWUsXG4gICAgICAnZnRwOic6IHRydWUsXG4gICAgICAnZ29waGVyOic6IHRydWUsXG4gICAgICAnZmlsZTonOiB0cnVlXG4gICAgfSxcbiAgICBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyk7XG5cbmZ1bmN0aW9uIHVybFBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHtcbiAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsO1xuXG4gIHZhciB1ID0gbmV3IFVybDtcbiAgdS5wYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KTtcbiAgcmV0dXJuIHU7XG59XG5cblVybC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbih1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KSB7XG4gIGlmICghdXRpbC5pc1N0cmluZyh1cmwpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgXCIgKyB0eXBlb2YgdXJsKTtcbiAgfVxuXG4gIC8vIENvcHkgY2hyb21lLCBJRSwgb3BlcmEgYmFja3NsYXNoLWhhbmRsaW5nIGJlaGF2aW9yLlxuICAvLyBCYWNrIHNsYXNoZXMgYmVmb3JlIHRoZSBxdWVyeSBzdHJpbmcgZ2V0IGNvbnZlcnRlZCB0byBmb3J3YXJkIHNsYXNoZXNcbiAgLy8gU2VlOiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjU5MTZcbiAgdmFyIHF1ZXJ5SW5kZXggPSB1cmwuaW5kZXhPZignPycpLFxuICAgICAgc3BsaXR0ZXIgPVxuICAgICAgICAgIChxdWVyeUluZGV4ICE9PSAtMSAmJiBxdWVyeUluZGV4IDwgdXJsLmluZGV4T2YoJyMnKSkgPyAnPycgOiAnIycsXG4gICAgICB1U3BsaXQgPSB1cmwuc3BsaXQoc3BsaXR0ZXIpLFxuICAgICAgc2xhc2hSZWdleCA9IC9cXFxcL2c7XG4gIHVTcGxpdFswXSA9IHVTcGxpdFswXS5yZXBsYWNlKHNsYXNoUmVnZXgsICcvJyk7XG4gIHVybCA9IHVTcGxpdC5qb2luKHNwbGl0dGVyKTtcblxuICB2YXIgcmVzdCA9IHVybDtcblxuICAvLyB0cmltIGJlZm9yZSBwcm9jZWVkaW5nLlxuICAvLyBUaGlzIGlzIHRvIHN1cHBvcnQgcGFyc2Ugc3R1ZmYgbGlrZSBcIiAgaHR0cDovL2Zvby5jb20gIFxcblwiXG4gIHJlc3QgPSByZXN0LnRyaW0oKTtcblxuICBpZiAoIXNsYXNoZXNEZW5vdGVIb3N0ICYmIHVybC5zcGxpdCgnIycpLmxlbmd0aCA9PT0gMSkge1xuICAgIC8vIFRyeSBmYXN0IHBhdGggcmVnZXhwXG4gICAgdmFyIHNpbXBsZVBhdGggPSBzaW1wbGVQYXRoUGF0dGVybi5leGVjKHJlc3QpO1xuICAgIGlmIChzaW1wbGVQYXRoKSB7XG4gICAgICB0aGlzLnBhdGggPSByZXN0O1xuICAgICAgdGhpcy5ocmVmID0gcmVzdDtcbiAgICAgIHRoaXMucGF0aG5hbWUgPSBzaW1wbGVQYXRoWzFdO1xuICAgICAgaWYgKHNpbXBsZVBhdGhbMl0pIHtcbiAgICAgICAgdGhpcy5zZWFyY2ggPSBzaW1wbGVQYXRoWzJdO1xuICAgICAgICBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnNlYXJjaC5zdWJzdHIoMSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucXVlcnkgPSB0aGlzLnNlYXJjaC5zdWJzdHIoMSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICB0aGlzLnNlYXJjaCA9ICcnO1xuICAgICAgICB0aGlzLnF1ZXJ5ID0ge307XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1cblxuICB2YXIgcHJvdG8gPSBwcm90b2NvbFBhdHRlcm4uZXhlYyhyZXN0KTtcbiAgaWYgKHByb3RvKSB7XG4gICAgcHJvdG8gPSBwcm90b1swXTtcbiAgICB2YXIgbG93ZXJQcm90byA9IHByb3RvLnRvTG93ZXJDYXNlKCk7XG4gICAgdGhpcy5wcm90b2NvbCA9IGxvd2VyUHJvdG87XG4gICAgcmVzdCA9IHJlc3Quc3Vic3RyKHByb3RvLmxlbmd0aCk7XG4gIH1cblxuICAvLyBmaWd1cmUgb3V0IGlmIGl0J3MgZ290IGEgaG9zdFxuICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsXG4gIC8vIHJlc29sdXRpb24gd2lsbCB0cmVhdCAvL2Zvby9iYXIgYXMgaG9zdD1mb28scGF0aD1iYXIgYmVjYXVzZSB0aGF0J3NcbiAgLy8gaG93IHRoZSBicm93c2VyIHJlc29sdmVzIHJlbGF0aXZlIFVSTHMuXG4gIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXFwvXFwvW15AXFwvXStAW15AXFwvXSsvKSkge1xuICAgIHZhciBzbGFzaGVzID0gcmVzdC5zdWJzdHIoMCwgMikgPT09ICcvLyc7XG4gICAgaWYgKHNsYXNoZXMgJiYgIShwcm90byAmJiBob3N0bGVzc1Byb3RvY29sW3Byb3RvXSkpIHtcbiAgICAgIHJlc3QgPSByZXN0LnN1YnN0cigyKTtcbiAgICAgIHRoaXMuc2xhc2hlcyA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFob3N0bGVzc1Byb3RvY29sW3Byb3RvXSAmJlxuICAgICAgKHNsYXNoZXMgfHwgKHByb3RvICYmICFzbGFzaGVkUHJvdG9jb2xbcHJvdG9dKSkpIHtcblxuICAgIC8vIHRoZXJlJ3MgYSBob3N0bmFtZS5cbiAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LlxuICAgIC8vXG4gICAgLy8gSWYgdGhlcmUgaXMgYW4gQCBpbiB0aGUgaG9zdG5hbWUsIHRoZW4gbm9uLWhvc3QgY2hhcnMgKmFyZSogYWxsb3dlZFxuICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyXG4gICAgLy8gY29tZXMgKmJlZm9yZSogdGhlIEAtc2lnbi5cbiAgICAvLyBVUkxzIGFyZSBvYm5veGlvdXMuXG4gICAgLy9cbiAgICAvLyBleDpcbiAgICAvLyBodHRwOi8vYUBiQGMvID0+IHVzZXI6YUBiIGhvc3Q6Y1xuICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGNcblxuICAgIC8vIHYwLjEyIFRPRE8oaXNhYWNzKTogVGhpcyBpcyBub3QgcXVpdGUgaG93IENocm9tZSBkb2VzIHRoaW5ncy5cbiAgICAvLyBSZXZpZXcgb3VyIHRlc3QgY2FzZSBhZ2FpbnN0IGJyb3dzZXJzIG1vcmUgY29tcHJlaGVuc2l2ZWx5LlxuXG4gICAgLy8gZmluZCB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgYW55IGhvc3RFbmRpbmdDaGFyc1xuICAgIHZhciBob3N0RW5kID0gLTE7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob3N0RW5kaW5nQ2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2YoaG9zdEVuZGluZ0NoYXJzW2ldKTtcbiAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSlcbiAgICAgICAgaG9zdEVuZCA9IGhlYztcbiAgICB9XG5cbiAgICAvLyBhdCB0aGlzIHBvaW50LCBlaXRoZXIgd2UgaGF2ZSBhbiBleHBsaWNpdCBwb2ludCB3aGVyZSB0aGVcbiAgICAvLyBhdXRoIHBvcnRpb24gY2Fubm90IGdvIHBhc3QsIG9yIHRoZSBsYXN0IEAgY2hhciBpcyB0aGUgZGVjaWRlci5cbiAgICB2YXIgYXV0aCwgYXRTaWduO1xuICAgIGlmIChob3N0RW5kID09PSAtMSkge1xuICAgICAgLy8gYXRTaWduIGNhbiBiZSBhbnl3aGVyZS5cbiAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYXRTaWduIG11c3QgYmUgaW4gYXV0aCBwb3J0aW9uLlxuICAgICAgLy8gaHR0cDovL2FAYi9jQGQgPT4gaG9zdDpiIGF1dGg6YSBwYXRoOi9jQGRcbiAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnLCBob3N0RW5kKTtcbiAgICB9XG5cbiAgICAvLyBOb3cgd2UgaGF2ZSBhIHBvcnRpb24gd2hpY2ggaXMgZGVmaW5pdGVseSB0aGUgYXV0aC5cbiAgICAvLyBQdWxsIHRoYXQgb2ZmLlxuICAgIGlmIChhdFNpZ24gIT09IC0xKSB7XG4gICAgICBhdXRoID0gcmVzdC5zbGljZSgwLCBhdFNpZ24pO1xuICAgICAgcmVzdCA9IHJlc3Quc2xpY2UoYXRTaWduICsgMSk7XG4gICAgICB0aGlzLmF1dGggPSBkZWNvZGVVUklDb21wb25lbnQoYXV0aCk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGhvc3QgaXMgdGhlIHJlbWFpbmluZyB0byB0aGUgbGVmdCBvZiB0aGUgZmlyc3Qgbm9uLWhvc3QgY2hhclxuICAgIGhvc3RFbmQgPSAtMTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vbkhvc3RDaGFycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihub25Ib3N0Q2hhcnNbaV0pO1xuICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKVxuICAgICAgICBob3N0RW5kID0gaGVjO1xuICAgIH1cbiAgICAvLyBpZiB3ZSBzdGlsbCBoYXZlIG5vdCBoaXQgaXQsIHRoZW4gdGhlIGVudGlyZSB0aGluZyBpcyBhIGhvc3QuXG4gICAgaWYgKGhvc3RFbmQgPT09IC0xKVxuICAgICAgaG9zdEVuZCA9IHJlc3QubGVuZ3RoO1xuXG4gICAgdGhpcy5ob3N0ID0gcmVzdC5zbGljZSgwLCBob3N0RW5kKTtcbiAgICByZXN0ID0gcmVzdC5zbGljZShob3N0RW5kKTtcblxuICAgIC8vIHB1bGwgb3V0IHBvcnQuXG4gICAgdGhpcy5wYXJzZUhvc3QoKTtcblxuICAgIC8vIHdlJ3ZlIGluZGljYXRlZCB0aGF0IHRoZXJlIGlzIGEgaG9zdG5hbWUsXG4gICAgLy8gc28gZXZlbiBpZiBpdCdzIGVtcHR5LCBpdCBoYXMgdG8gYmUgcHJlc2VudC5cbiAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZSB8fCAnJztcblxuICAgIC8vIGlmIGhvc3RuYW1lIGJlZ2lucyB3aXRoIFsgYW5kIGVuZHMgd2l0aCBdXG4gICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuXG4gICAgdmFyIGlwdjZIb3N0bmFtZSA9IHRoaXMuaG9zdG5hbWVbMF0gPT09ICdbJyAmJlxuICAgICAgICB0aGlzLmhvc3RuYW1lW3RoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMV0gPT09ICddJztcblxuICAgIC8vIHZhbGlkYXRlIGEgbGl0dGxlLlxuICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICB2YXIgaG9zdHBhcnRzID0gdGhpcy5ob3N0bmFtZS5zcGxpdCgvXFwuLyk7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGhvc3RwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgdmFyIHBhcnQgPSBob3N0cGFydHNbaV07XG4gICAgICAgIGlmICghcGFydCkgY29udGludWU7XG4gICAgICAgIGlmICghcGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkge1xuICAgICAgICAgIHZhciBuZXdwYXJ0ID0gJyc7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGsgPSBwYXJ0Lmxlbmd0aDsgaiA8IGs7IGorKykge1xuICAgICAgICAgICAgaWYgKHBhcnQuY2hhckNvZGVBdChqKSA+IDEyNykge1xuICAgICAgICAgICAgICAvLyB3ZSByZXBsYWNlIG5vbi1BU0NJSSBjaGFyIHdpdGggYSB0ZW1wb3JhcnkgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIG1ha2Ugc3VyZSBzaXplIG9mIGhvc3RuYW1lIGlzIG5vdFxuICAgICAgICAgICAgICAvLyBicm9rZW4gYnkgcmVwbGFjaW5nIG5vbi1BU0NJSSBieSBub3RoaW5nXG4gICAgICAgICAgICAgIG5ld3BhcnQgKz0gJ3gnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3cGFydCArPSBwYXJ0W2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyB3ZSB0ZXN0IGFnYWluIHdpdGggQVNDSUkgY2hhciBvbmx5XG4gICAgICAgICAgaWYgKCFuZXdwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7XG4gICAgICAgICAgICB2YXIgdmFsaWRQYXJ0cyA9IGhvc3RwYXJ0cy5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIHZhciBub3RIb3N0ID0gaG9zdHBhcnRzLnNsaWNlKGkgKyAxKTtcbiAgICAgICAgICAgIHZhciBiaXQgPSBwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFN0YXJ0KTtcbiAgICAgICAgICAgIGlmIChiaXQpIHtcbiAgICAgICAgICAgICAgdmFsaWRQYXJ0cy5wdXNoKGJpdFsxXSk7XG4gICAgICAgICAgICAgIG5vdEhvc3QudW5zaGlmdChiaXRbMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5vdEhvc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJlc3QgPSAnLycgKyBub3RIb3N0LmpvaW4oJy4nKSArIHJlc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gdmFsaWRQYXJ0cy5qb2luKCcuJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5ob3N0bmFtZS5sZW5ndGggPiBob3N0bmFtZU1heExlbikge1xuICAgICAgdGhpcy5ob3N0bmFtZSA9ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLlxuICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG5cbiAgICBpZiAoIWlwdjZIb3N0bmFtZSkge1xuICAgICAgLy8gSUROQSBTdXBwb3J0OiBSZXR1cm5zIGEgcHVueWNvZGVkIHJlcHJlc2VudGF0aW9uIG9mIFwiZG9tYWluXCIuXG4gICAgICAvLyBJdCBvbmx5IGNvbnZlcnRzIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB0aGF0XG4gICAgICAvLyBoYXZlIG5vbi1BU0NJSSBjaGFyYWN0ZXJzLCBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmXG4gICAgICAvLyB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQgYWxyZWFkeSBpcyBBU0NJSS1vbmx5LlxuICAgICAgdGhpcy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5ob3N0bmFtZSk7XG4gICAgfVxuXG4gICAgdmFyIHAgPSB0aGlzLnBvcnQgPyAnOicgKyB0aGlzLnBvcnQgOiAnJztcbiAgICB2YXIgaCA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7XG4gICAgdGhpcy5ob3N0ID0gaCArIHA7XG4gICAgdGhpcy5ocmVmICs9IHRoaXMuaG9zdDtcblxuICAgIC8vIHN0cmlwIFsgYW5kIF0gZnJvbSB0aGUgaG9zdG5hbWVcbiAgICAvLyB0aGUgaG9zdCBmaWVsZCBzdGlsbCByZXRhaW5zIHRoZW0sIHRob3VnaFxuICAgIGlmIChpcHY2SG9zdG5hbWUpIHtcbiAgICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lLnN1YnN0cigxLCB0aGlzLmhvc3RuYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgaWYgKHJlc3RbMF0gIT09ICcvJykge1xuICAgICAgICByZXN0ID0gJy8nICsgcmVzdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBub3cgcmVzdCBpcyBzZXQgdG8gdGhlIHBvc3QtaG9zdCBzdHVmZi5cbiAgLy8gY2hvcCBvZmYgYW55IGRlbGltIGNoYXJzLlxuICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7XG5cbiAgICAvLyBGaXJzdCwgbWFrZSAxMDAlIHN1cmUgdGhhdCBhbnkgXCJhdXRvRXNjYXBlXCIgY2hhcnMgZ2V0XG4gICAgLy8gZXNjYXBlZCwgZXZlbiBpZiBlbmNvZGVVUklDb21wb25lbnQgZG9lc24ndCB0aGluayB0aGV5XG4gICAgLy8gbmVlZCB0byBiZS5cbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF1dG9Fc2NhcGUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICB2YXIgYWUgPSBhdXRvRXNjYXBlW2ldO1xuICAgICAgaWYgKHJlc3QuaW5kZXhPZihhZSkgPT09IC0xKVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIHZhciBlc2MgPSBlbmNvZGVVUklDb21wb25lbnQoYWUpO1xuICAgICAgaWYgKGVzYyA9PT0gYWUpIHtcbiAgICAgICAgZXNjID0gZXNjYXBlKGFlKTtcbiAgICAgIH1cbiAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7XG4gICAgfVxuICB9XG5cblxuICAvLyBjaG9wIG9mZiBmcm9tIHRoZSB0YWlsIGZpcnN0LlxuICB2YXIgaGFzaCA9IHJlc3QuaW5kZXhPZignIycpO1xuICBpZiAoaGFzaCAhPT0gLTEpIHtcbiAgICAvLyBnb3QgYSBmcmFnbWVudCBzdHJpbmcuXG4gICAgdGhpcy5oYXNoID0gcmVzdC5zdWJzdHIoaGFzaCk7XG4gICAgcmVzdCA9IHJlc3Quc2xpY2UoMCwgaGFzaCk7XG4gIH1cbiAgdmFyIHFtID0gcmVzdC5pbmRleE9mKCc/Jyk7XG4gIGlmIChxbSAhPT0gLTEpIHtcbiAgICB0aGlzLnNlYXJjaCA9IHJlc3Quc3Vic3RyKHFtKTtcbiAgICB0aGlzLnF1ZXJ5ID0gcmVzdC5zdWJzdHIocW0gKyAxKTtcbiAgICBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMucXVlcnkpO1xuICAgIH1cbiAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBxbSk7XG4gIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgIC8vIG5vIHF1ZXJ5IHN0cmluZywgYnV0IHBhcnNlUXVlcnlTdHJpbmcgc3RpbGwgcmVxdWVzdGVkXG4gICAgdGhpcy5zZWFyY2ggPSAnJztcbiAgICB0aGlzLnF1ZXJ5ID0ge307XG4gIH1cbiAgaWYgKHJlc3QpIHRoaXMucGF0aG5hbWUgPSByZXN0O1xuICBpZiAoc2xhc2hlZFByb3RvY29sW2xvd2VyUHJvdG9dICYmXG4gICAgICB0aGlzLmhvc3RuYW1lICYmICF0aGlzLnBhdGhuYW1lKSB7XG4gICAgdGhpcy5wYXRobmFtZSA9ICcvJztcbiAgfVxuXG4gIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgaWYgKHRoaXMucGF0aG5hbWUgfHwgdGhpcy5zZWFyY2gpIHtcbiAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7XG4gICAgdmFyIHMgPSB0aGlzLnNlYXJjaCB8fCAnJztcbiAgICB0aGlzLnBhdGggPSBwICsgcztcbiAgfVxuXG4gIC8vIGZpbmFsbHksIHJlY29uc3RydWN0IHRoZSBocmVmIGJhc2VkIG9uIHdoYXQgaGFzIGJlZW4gdmFsaWRhdGVkLlxuICB0aGlzLmhyZWYgPSB0aGlzLmZvcm1hdCgpO1xuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGZvcm1hdCBhIHBhcnNlZCBvYmplY3QgaW50byBhIHVybCBzdHJpbmdcbmZ1bmN0aW9uIHVybEZvcm1hdChvYmopIHtcbiAgLy8gZW5zdXJlIGl0J3MgYW4gb2JqZWN0LCBhbmQgbm90IGEgc3RyaW5nIHVybC5cbiAgLy8gSWYgaXQncyBhbiBvYmosIHRoaXMgaXMgYSBuby1vcC5cbiAgLy8gdGhpcyB3YXksIHlvdSBjYW4gY2FsbCB1cmxfZm9ybWF0KCkgb24gc3RyaW5nc1xuICAvLyB0byBjbGVhbiB1cCBwb3RlbnRpYWxseSB3b25reSB1cmxzLlxuICBpZiAodXRpbC5pc1N0cmluZyhvYmopKSBvYmogPSB1cmxQYXJzZShvYmopO1xuICBpZiAoIShvYmogaW5zdGFuY2VvZiBVcmwpKSByZXR1cm4gVXJsLnByb3RvdHlwZS5mb3JtYXQuY2FsbChvYmopO1xuICByZXR1cm4gb2JqLmZvcm1hdCgpO1xufVxuXG5VcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJztcbiAgaWYgKGF1dGgpIHtcbiAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpO1xuICAgIGF1dGggPSBhdXRoLnJlcGxhY2UoLyUzQS9pLCAnOicpO1xuICAgIGF1dGggKz0gJ0AnO1xuICB9XG5cbiAgdmFyIHByb3RvY29sID0gdGhpcy5wcm90b2NvbCB8fCAnJyxcbiAgICAgIHBhdGhuYW1lID0gdGhpcy5wYXRobmFtZSB8fCAnJyxcbiAgICAgIGhhc2ggPSB0aGlzLmhhc2ggfHwgJycsXG4gICAgICBob3N0ID0gZmFsc2UsXG4gICAgICBxdWVyeSA9ICcnO1xuXG4gIGlmICh0aGlzLmhvc3QpIHtcbiAgICBob3N0ID0gYXV0aCArIHRoaXMuaG9zdDtcbiAgfSBlbHNlIGlmICh0aGlzLmhvc3RuYW1lKSB7XG4gICAgaG9zdCA9IGF1dGggKyAodGhpcy5ob3N0bmFtZS5pbmRleE9mKCc6JykgPT09IC0xID9cbiAgICAgICAgdGhpcy5ob3N0bmFtZSA6XG4gICAgICAgICdbJyArIHRoaXMuaG9zdG5hbWUgKyAnXScpO1xuICAgIGlmICh0aGlzLnBvcnQpIHtcbiAgICAgIGhvc3QgKz0gJzonICsgdGhpcy5wb3J0O1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLnF1ZXJ5ICYmXG4gICAgICB1dGlsLmlzT2JqZWN0KHRoaXMucXVlcnkpICYmXG4gICAgICBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHtcbiAgICBxdWVyeSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh0aGlzLnF1ZXJ5KTtcbiAgfVxuXG4gIHZhciBzZWFyY2ggPSB0aGlzLnNlYXJjaCB8fCAocXVlcnkgJiYgKCc/JyArIHF1ZXJ5KSkgfHwgJyc7XG5cbiAgaWYgKHByb3RvY29sICYmIHByb3RvY29sLnN1YnN0cigtMSkgIT09ICc6JykgcHJvdG9jb2wgKz0gJzonO1xuXG4gIC8vIG9ubHkgdGhlIHNsYXNoZWRQcm90b2NvbHMgZ2V0IHRoZSAvLy4gIE5vdCBtYWlsdG86LCB4bXBwOiwgZXRjLlxuICAvLyB1bmxlc3MgdGhleSBoYWQgdGhlbSB0byBiZWdpbiB3aXRoLlxuICBpZiAodGhpcy5zbGFzaGVzIHx8XG4gICAgICAoIXByb3RvY29sIHx8IHNsYXNoZWRQcm90b2NvbFtwcm90b2NvbF0pICYmIGhvc3QgIT09IGZhbHNlKSB7XG4gICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7XG4gICAgaWYgKHBhdGhuYW1lICYmIHBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSBwYXRobmFtZSA9ICcvJyArIHBhdGhuYW1lO1xuICB9IGVsc2UgaWYgKCFob3N0KSB7XG4gICAgaG9zdCA9ICcnO1xuICB9XG5cbiAgaWYgKGhhc2ggJiYgaGFzaC5jaGFyQXQoMCkgIT09ICcjJykgaGFzaCA9ICcjJyArIGhhc2g7XG4gIGlmIChzZWFyY2ggJiYgc2VhcmNoLmNoYXJBdCgwKSAhPT0gJz8nKSBzZWFyY2ggPSAnPycgKyBzZWFyY2g7XG5cbiAgcGF0aG5hbWUgPSBwYXRobmFtZS5yZXBsYWNlKC9bPyNdL2csIGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChtYXRjaCk7XG4gIH0pO1xuICBzZWFyY2ggPSBzZWFyY2gucmVwbGFjZSgnIycsICclMjMnKTtcblxuICByZXR1cm4gcHJvdG9jb2wgKyBob3N0ICsgcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoO1xufTtcblxuZnVuY3Rpb24gdXJsUmVzb2x2ZShzb3VyY2UsIHJlbGF0aXZlKSB7XG4gIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlKHJlbGF0aXZlKTtcbn1cblxuVXJsLnByb3RvdHlwZS5yZXNvbHZlID0gZnVuY3Rpb24ocmVsYXRpdmUpIHtcbiAgcmV0dXJuIHRoaXMucmVzb2x2ZU9iamVjdCh1cmxQYXJzZShyZWxhdGl2ZSwgZmFsc2UsIHRydWUpKS5mb3JtYXQoKTtcbn07XG5cbmZ1bmN0aW9uIHVybFJlc29sdmVPYmplY3Qoc291cmNlLCByZWxhdGl2ZSkge1xuICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlO1xuICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZU9iamVjdChyZWxhdGl2ZSk7XG59XG5cblVybC5wcm90b3R5cGUucmVzb2x2ZU9iamVjdCA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7XG4gIGlmICh1dGlsLmlzU3RyaW5nKHJlbGF0aXZlKSkge1xuICAgIHZhciByZWwgPSBuZXcgVXJsKCk7XG4gICAgcmVsLnBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgcmVsYXRpdmUgPSByZWw7XG4gIH1cblxuICB2YXIgcmVzdWx0ID0gbmV3IFVybCgpO1xuICB2YXIgdGtleXMgPSBPYmplY3Qua2V5cyh0aGlzKTtcbiAgZm9yICh2YXIgdGsgPSAwOyB0ayA8IHRrZXlzLmxlbmd0aDsgdGsrKykge1xuICAgIHZhciB0a2V5ID0gdGtleXNbdGtdO1xuICAgIHJlc3VsdFt0a2V5XSA9IHRoaXNbdGtleV07XG4gIH1cblxuICAvLyBoYXNoIGlzIGFsd2F5cyBvdmVycmlkZGVuLCBubyBtYXR0ZXIgd2hhdC5cbiAgLy8gZXZlbiBocmVmPVwiXCIgd2lsbCByZW1vdmUgaXQuXG4gIHJlc3VsdC5oYXNoID0gcmVsYXRpdmUuaGFzaDtcblxuICAvLyBpZiB0aGUgcmVsYXRpdmUgdXJsIGlzIGVtcHR5LCB0aGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGRvIGhlcmUuXG4gIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykge1xuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBocmVmcyBsaWtlIC8vZm9vL2JhciBhbHdheXMgY3V0IHRvIHRoZSBwcm90b2NvbC5cbiAgaWYgKHJlbGF0aXZlLnNsYXNoZXMgJiYgIXJlbGF0aXZlLnByb3RvY29sKSB7XG4gICAgLy8gdGFrZSBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgcHJvdG9jb2wgZnJvbSByZWxhdGl2ZVxuICAgIHZhciBya2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTtcbiAgICBmb3IgKHZhciByayA9IDA7IHJrIDwgcmtleXMubGVuZ3RoOyByaysrKSB7XG4gICAgICB2YXIgcmtleSA9IHJrZXlzW3JrXTtcbiAgICAgIGlmIChya2V5ICE9PSAncHJvdG9jb2wnKVxuICAgICAgICByZXN1bHRbcmtleV0gPSByZWxhdGl2ZVtya2V5XTtcbiAgICB9XG5cbiAgICAvL3VybFBhcnNlIGFwcGVuZHMgdHJhaWxpbmcgLyB0byB1cmxzIGxpa2UgaHR0cDovL3d3dy5leGFtcGxlLmNvbVxuICAgIGlmIChzbGFzaGVkUHJvdG9jb2xbcmVzdWx0LnByb3RvY29sXSAmJlxuICAgICAgICByZXN1bHQuaG9zdG5hbWUgJiYgIXJlc3VsdC5wYXRobmFtZSkge1xuICAgICAgcmVzdWx0LnBhdGggPSByZXN1bHQucGF0aG5hbWUgPSAnLyc7XG4gICAgfVxuXG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGlmIChyZWxhdGl2ZS5wcm90b2NvbCAmJiByZWxhdGl2ZS5wcm90b2NvbCAhPT0gcmVzdWx0LnByb3RvY29sKSB7XG4gICAgLy8gaWYgaXQncyBhIGtub3duIHVybCBwcm90b2NvbCwgdGhlbiBjaGFuZ2luZ1xuICAgIC8vIHRoZSBwcm90b2NvbCBkb2VzIHdlaXJkIHRoaW5nc1xuICAgIC8vIGZpcnN0LCBpZiBpdCdzIG5vdCBmaWxlOiwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBob3N0LFxuICAgIC8vIGFuZCBpZiB0aGVyZSB3YXMgYSBwYXRoXG4gICAgLy8gdG8gYmVnaW4gd2l0aCwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBwYXRoLlxuICAgIC8vIGlmIGl0IGlzIGZpbGU6LCB0aGVuIHRoZSBob3N0IGlzIGRyb3BwZWQsXG4gICAgLy8gYmVjYXVzZSB0aGF0J3Mga25vd24gdG8gYmUgaG9zdGxlc3MuXG4gICAgLy8gYW55dGhpbmcgZWxzZSBpcyBhc3N1bWVkIHRvIGJlIGFic29sdXRlLlxuICAgIGlmICghc2xhc2hlZFByb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkge1xuICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZWxhdGl2ZSk7XG4gICAgICBmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHtcbiAgICAgICAgdmFyIGsgPSBrZXlzW3ZdO1xuICAgICAgICByZXN1bHRba10gPSByZWxhdGl2ZVtrXTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZXN1bHQucHJvdG9jb2wgPSByZWxhdGl2ZS5wcm90b2NvbDtcbiAgICBpZiAoIXJlbGF0aXZlLmhvc3QgJiYgIWhvc3RsZXNzUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7XG4gICAgICB2YXIgcmVsUGF0aCA9IChyZWxhdGl2ZS5wYXRobmFtZSB8fCAnJykuc3BsaXQoJy8nKTtcbiAgICAgIHdoaWxlIChyZWxQYXRoLmxlbmd0aCAmJiAhKHJlbGF0aXZlLmhvc3QgPSByZWxQYXRoLnNoaWZ0KCkpKTtcbiAgICAgIGlmICghcmVsYXRpdmUuaG9zdCkgcmVsYXRpdmUuaG9zdCA9ICcnO1xuICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0bmFtZSkgcmVsYXRpdmUuaG9zdG5hbWUgPSAnJztcbiAgICAgIGlmIChyZWxQYXRoWzBdICE9PSAnJykgcmVsUGF0aC51bnNoaWZ0KCcnKTtcbiAgICAgIGlmIChyZWxQYXRoLmxlbmd0aCA8IDIpIHJlbFBhdGgudW5zaGlmdCgnJyk7XG4gICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxQYXRoLmpvaW4oJy8nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnBhdGhuYW1lID0gcmVsYXRpdmUucGF0aG5hbWU7XG4gICAgfVxuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgcmVzdWx0Lmhvc3QgPSByZWxhdGl2ZS5ob3N0IHx8ICcnO1xuICAgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aDtcbiAgICByZXN1bHQuaG9zdG5hbWUgPSByZWxhdGl2ZS5ob3N0bmFtZSB8fCByZWxhdGl2ZS5ob3N0O1xuICAgIHJlc3VsdC5wb3J0ID0gcmVsYXRpdmUucG9ydDtcbiAgICAvLyB0byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgIGlmIChyZXN1bHQucGF0aG5hbWUgfHwgcmVzdWx0LnNlYXJjaCkge1xuICAgICAgdmFyIHAgPSByZXN1bHQucGF0aG5hbWUgfHwgJyc7XG4gICAgICB2YXIgcyA9IHJlc3VsdC5zZWFyY2ggfHwgJyc7XG4gICAgICByZXN1bHQucGF0aCA9IHAgKyBzO1xuICAgIH1cbiAgICByZXN1bHQuc2xhc2hlcyA9IHJlc3VsdC5zbGFzaGVzIHx8IHJlbGF0aXZlLnNsYXNoZXM7XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHZhciBpc1NvdXJjZUFicyA9IChyZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSxcbiAgICAgIGlzUmVsQWJzID0gKFxuICAgICAgICAgIHJlbGF0aXZlLmhvc3QgfHxcbiAgICAgICAgICByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJ1xuICAgICAgKSxcbiAgICAgIG11c3RFbmRBYnMgPSAoaXNSZWxBYnMgfHwgaXNTb3VyY2VBYnMgfHxcbiAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lKSksXG4gICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicyxcbiAgICAgIHNyY1BhdGggPSByZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sXG4gICAgICByZWxQYXRoID0gcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSxcbiAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07XG5cbiAgLy8gaWYgdGhlIHVybCBpcyBhIG5vbi1zbGFzaGVkIHVybCwgdGhlbiByZWxhdGl2ZVxuICAvLyBsaW5rcyBsaWtlIC4uLy4uIHNob3VsZCBiZSBhYmxlXG4gIC8vIHRvIGNyYXdsIHVwIHRvIHRoZSBob3N0bmFtZSwgYXMgd2VsbC4gIFRoaXMgaXMgc3RyYW5nZS5cbiAgLy8gcmVzdWx0LnByb3RvY29sIGhhcyBhbHJlYWR5IGJlZW4gc2V0IGJ5IG5vdy5cbiAgLy8gTGF0ZXIgb24sIHB1dCB0aGUgZmlyc3QgcGF0aCBwYXJ0IGludG8gdGhlIGhvc3QgZmllbGQuXG4gIGlmIChwc3ljaG90aWMpIHtcbiAgICByZXN1bHQuaG9zdG5hbWUgPSAnJztcbiAgICByZXN1bHQucG9ydCA9IG51bGw7XG4gICAgaWYgKHJlc3VsdC5ob3N0KSB7XG4gICAgICBpZiAoc3JjUGF0aFswXSA9PT0gJycpIHNyY1BhdGhbMF0gPSByZXN1bHQuaG9zdDtcbiAgICAgIGVsc2Ugc3JjUGF0aC51bnNoaWZ0KHJlc3VsdC5ob3N0KTtcbiAgICB9XG4gICAgcmVzdWx0Lmhvc3QgPSAnJztcbiAgICBpZiAocmVsYXRpdmUucHJvdG9jb2wpIHtcbiAgICAgIHJlbGF0aXZlLmhvc3RuYW1lID0gbnVsbDtcbiAgICAgIHJlbGF0aXZlLnBvcnQgPSBudWxsO1xuICAgICAgaWYgKHJlbGF0aXZlLmhvc3QpIHtcbiAgICAgICAgaWYgKHJlbFBhdGhbMF0gPT09ICcnKSByZWxQYXRoWzBdID0gcmVsYXRpdmUuaG9zdDtcbiAgICAgICAgZWxzZSByZWxQYXRoLnVuc2hpZnQocmVsYXRpdmUuaG9zdCk7XG4gICAgICB9XG4gICAgICByZWxhdGl2ZS5ob3N0ID0gbnVsbDtcbiAgICB9XG4gICAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgJiYgKHJlbFBhdGhbMF0gPT09ICcnIHx8IHNyY1BhdGhbMF0gPT09ICcnKTtcbiAgfVxuXG4gIGlmIChpc1JlbEFicykge1xuICAgIC8vIGl0J3MgYWJzb2x1dGUuXG4gICAgcmVzdWx0Lmhvc3QgPSAocmVsYXRpdmUuaG9zdCB8fCByZWxhdGl2ZS5ob3N0ID09PSAnJykgP1xuICAgICAgICAgICAgICAgICAgcmVsYXRpdmUuaG9zdCA6IHJlc3VsdC5ob3N0O1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IChyZWxhdGl2ZS5ob3N0bmFtZSB8fCByZWxhdGl2ZS5ob3N0bmFtZSA9PT0gJycpID9cbiAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0bmFtZSA6IHJlc3VsdC5ob3N0bmFtZTtcbiAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoO1xuICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgIHNyY1BhdGggPSByZWxQYXRoO1xuICAgIC8vIGZhbGwgdGhyb3VnaCB0byB0aGUgZG90LWhhbmRsaW5nIGJlbG93LlxuICB9IGVsc2UgaWYgKHJlbFBhdGgubGVuZ3RoKSB7XG4gICAgLy8gaXQncyByZWxhdGl2ZVxuICAgIC8vIHRocm93IGF3YXkgdGhlIGV4aXN0aW5nIGZpbGUsIGFuZCB0YWtlIHRoZSBuZXcgcGF0aCBpbnN0ZWFkLlxuICAgIGlmICghc3JjUGF0aCkgc3JjUGF0aCA9IFtdO1xuICAgIHNyY1BhdGgucG9wKCk7XG4gICAgc3JjUGF0aCA9IHNyY1BhdGguY29uY2F0KHJlbFBhdGgpO1xuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gIH0gZWxzZSBpZiAoIXV0aWwuaXNOdWxsT3JVbmRlZmluZWQocmVsYXRpdmUuc2VhcmNoKSkge1xuICAgIC8vIGp1c3QgcHVsbCBvdXQgdGhlIHNlYXJjaC5cbiAgICAvLyBsaWtlIGhyZWY9Jz9mb28nLlxuICAgIC8vIFB1dCB0aGlzIGFmdGVyIHRoZSBvdGhlciB0d28gY2FzZXMgYmVjYXVzZSBpdCBzaW1wbGlmaWVzIHRoZSBib29sZWFuc1xuICAgIGlmIChwc3ljaG90aWMpIHtcbiAgICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlc3VsdC5ob3N0ID0gc3JjUGF0aC5zaGlmdCgpO1xuICAgICAgLy9vY2NhdGlvbmFseSB0aGUgYXV0aCBjYW4gZ2V0IHN0dWNrIG9ubHkgaW4gaG9zdFxuICAgICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlXG4gICAgICAvL3VybC5yZXNvbHZlT2JqZWN0KCdtYWlsdG86bG9jYWwxQGRvbWFpbjEnLCAnbG9jYWwyQGRvbWFpbjInKVxuICAgICAgdmFyIGF1dGhJbkhvc3QgPSByZXN1bHQuaG9zdCAmJiByZXN1bHQuaG9zdC5pbmRleE9mKCdAJykgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlO1xuICAgICAgaWYgKGF1dGhJbkhvc3QpIHtcbiAgICAgICAgcmVzdWx0LmF1dGggPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoO1xuICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7XG4gICAgICByZXN1bHQucGF0aCA9IChyZXN1bHQucGF0aG5hbWUgPyByZXN1bHQucGF0aG5hbWUgOiAnJykgK1xuICAgICAgICAgICAgICAgICAgICAocmVzdWx0LnNlYXJjaCA/IHJlc3VsdC5zZWFyY2ggOiAnJyk7XG4gICAgfVxuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7XG4gICAgLy8gbm8gcGF0aCBhdCBhbGwuICBlYXN5LlxuICAgIC8vIHdlJ3ZlIGFscmVhZHkgaGFuZGxlZCB0aGUgb3RoZXIgc3R1ZmYgYWJvdmUuXG4gICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDtcbiAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0XG4gICAgaWYgKHJlc3VsdC5zZWFyY2gpIHtcbiAgICAgIHJlc3VsdC5wYXRoID0gJy8nICsgcmVzdWx0LnNlYXJjaDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICAgIH1cbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gaWYgYSB1cmwgRU5EcyBpbiAuIG9yIC4uLCB0aGVuIGl0IG11c3QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guXG4gIC8vIGhvd2V2ZXIsIGlmIGl0IGVuZHMgaW4gYW55dGhpbmcgZWxzZSBub24tc2xhc2h5LFxuICAvLyB0aGVuIGl0IG11c3QgTk9UIGdldCBhIHRyYWlsaW5nIHNsYXNoLlxuICB2YXIgbGFzdCA9IHNyY1BhdGguc2xpY2UoLTEpWzBdO1xuICB2YXIgaGFzVHJhaWxpbmdTbGFzaCA9IChcbiAgICAgIChyZXN1bHQuaG9zdCB8fCByZWxhdGl2ZS5ob3N0IHx8IHNyY1BhdGgubGVuZ3RoID4gMSkgJiZcbiAgICAgIChsYXN0ID09PSAnLicgfHwgbGFzdCA9PT0gJy4uJykgfHwgbGFzdCA9PT0gJycpO1xuXG4gIC8vIHN0cmlwIHNpbmdsZSBkb3RzLCByZXNvbHZlIGRvdWJsZSBkb3RzIHRvIHBhcmVudCBkaXJcbiAgLy8gaWYgdGhlIHBhdGggdHJpZXMgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIGB1cGAgZW5kcyB1cCA+IDBcbiAgdmFyIHVwID0gMDtcbiAgZm9yICh2YXIgaSA9IHNyY1BhdGgubGVuZ3RoOyBpID49IDA7IGktLSkge1xuICAgIGxhc3QgPSBzcmNQYXRoW2ldO1xuICAgIGlmIChsYXN0ID09PSAnLicpIHtcbiAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpO1xuICAgIH0gZWxzZSBpZiAobGFzdCA9PT0gJy4uJykge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICB1cCsrO1xuICAgIH0gZWxzZSBpZiAodXApIHtcbiAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpO1xuICAgICAgdXAtLTtcbiAgICB9XG4gIH1cblxuICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zXG4gIGlmICghbXVzdEVuZEFicyAmJiAhcmVtb3ZlQWxsRG90cykge1xuICAgIGZvciAoOyB1cC0tOyB1cCkge1xuICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtdXN0RW5kQWJzICYmIHNyY1BhdGhbMF0gIT09ICcnICYmXG4gICAgICAoIXNyY1BhdGhbMF0gfHwgc3JjUGF0aFswXS5jaGFyQXQoMCkgIT09ICcvJykpIHtcbiAgICBzcmNQYXRoLnVuc2hpZnQoJycpO1xuICB9XG5cbiAgaWYgKGhhc1RyYWlsaW5nU2xhc2ggJiYgKHNyY1BhdGguam9pbignLycpLnN1YnN0cigtMSkgIT09ICcvJykpIHtcbiAgICBzcmNQYXRoLnB1c2goJycpO1xuICB9XG5cbiAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fFxuICAgICAgKHNyY1BhdGhbMF0gJiYgc3JjUGF0aFswXS5jaGFyQXQoMCkgPT09ICcvJyk7XG5cbiAgLy8gcHV0IHRoZSBob3N0IGJhY2tcbiAgaWYgKHBzeWNob3RpYykge1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlc3VsdC5ob3N0ID0gaXNBYnNvbHV0ZSA/ICcnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyY1BhdGgubGVuZ3RoID8gc3JjUGF0aC5zaGlmdCgpIDogJyc7XG4gICAgLy9vY2NhdGlvbmFseSB0aGUgYXV0aCBjYW4gZ2V0IHN0dWNrIG9ubHkgaW4gaG9zdFxuICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZVxuICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpXG4gICAgdmFyIGF1dGhJbkhvc3QgPSByZXN1bHQuaG9zdCAmJiByZXN1bHQuaG9zdC5pbmRleE9mKCdAJykgPiAwID9cbiAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTtcbiAgICBpZiAoYXV0aEluSG9zdCkge1xuICAgICAgcmVzdWx0LmF1dGggPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICB9XG4gIH1cblxuICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyB8fCAocmVzdWx0Lmhvc3QgJiYgc3JjUGF0aC5sZW5ndGgpO1xuXG4gIGlmIChtdXN0RW5kQWJzICYmICFpc0Fic29sdXRlKSB7XG4gICAgc3JjUGF0aC51bnNoaWZ0KCcnKTtcbiAgfVxuXG4gIGlmICghc3JjUGF0aC5sZW5ndGgpIHtcbiAgICByZXN1bHQucGF0aG5hbWUgPSBudWxsO1xuICAgIHJlc3VsdC5wYXRoID0gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQucGF0aG5hbWUgPSBzcmNQYXRoLmpvaW4oJy8nKTtcbiAgfVxuXG4gIC8vdG8gc3VwcG9ydCByZXF1ZXN0Lmh0dHBcbiAgaWYgKCF1dGlsLmlzTnVsbChyZXN1bHQucGF0aG5hbWUpIHx8ICF1dGlsLmlzTnVsbChyZXN1bHQuc2VhcmNoKSkge1xuICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArXG4gICAgICAgICAgICAgICAgICAocmVzdWx0LnNlYXJjaCA/IHJlc3VsdC5zZWFyY2ggOiAnJyk7XG4gIH1cbiAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoIHx8IHJlc3VsdC5hdXRoO1xuICByZXN1bHQuc2xhc2hlcyA9IHJlc3VsdC5zbGFzaGVzIHx8IHJlbGF0aXZlLnNsYXNoZXM7XG4gIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICByZXR1cm4gcmVzdWx0O1xufTtcblxuVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gIHZhciBwb3J0ID0gcG9ydFBhdHRlcm4uZXhlYyhob3N0KTtcbiAgaWYgKHBvcnQpIHtcbiAgICBwb3J0ID0gcG9ydFswXTtcbiAgICBpZiAocG9ydCAhPT0gJzonKSB7XG4gICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTtcbiAgICB9XG4gICAgaG9zdCA9IGhvc3Quc3Vic3RyKDAsIGhvc3QubGVuZ3RoIC0gcG9ydC5sZW5ndGgpO1xuICB9XG4gIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDtcbn07XG4iLCAiJ3VzZSBzdHJpY3QnXG5cbmZ1bmN0aW9uIHBhcnNlVVJJIChzdHIsIG9wdHMpIHtcbiAgaWYgKCFzdHIpIHJldHVybiB1bmRlZmluZWRcblxuICBvcHRzID0gb3B0cyB8fCB7fVxuXG4gIHZhciBvID0ge1xuICAgIGtleTogW1xuICAgICAgJ3NvdXJjZScsXG4gICAgICAncHJvdG9jb2wnLFxuICAgICAgJ2F1dGhvcml0eScsXG4gICAgICAndXNlckluZm8nLFxuICAgICAgJ3VzZXInLFxuICAgICAgJ3Bhc3N3b3JkJyxcbiAgICAgICdob3N0JyxcbiAgICAgICdwb3J0JyxcbiAgICAgICdyZWxhdGl2ZScsXG4gICAgICAncGF0aCcsXG4gICAgICAnZGlyZWN0b3J5JyxcbiAgICAgICdmaWxlJyxcbiAgICAgICdxdWVyeScsXG4gICAgICAnYW5jaG9yJ1xuICAgIF0sXG4gICAgcToge1xuICAgICAgbmFtZTogJ3F1ZXJ5S2V5JyxcbiAgICAgIHBhcnNlcjogLyg/Ol58JikoW14mPV0qKT0/KFteJl0qKS9nXG4gICAgfSxcbiAgICBwYXJzZXI6IHtcbiAgICAgIHN0cmljdDogL14oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPyhbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPygoKCg/OltePyNcXC9dKlxcLykqKShbXj8jXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLyxcbiAgICAgIGxvb3NlOiAvXig/Oig/IVteOkBdKzpbXjpAXFwvXSpAKShbXjpcXC8/Iy5dKyk6KT8oPzpcXC9cXC8pPygoPzooKFteOkBdKikoPzo6KFteOkBdKikpPyk/QCk/KFteOlxcLz8jXSopKD86OihcXGQqKSk/KSgoKFxcLyg/OltePyNdKD8hW14/I1xcL10qXFwuW14/I1xcLy5dKyg/Ols/I118JCkpKSpcXC8/KT8oW14/I1xcL10qKSkoPzpcXD8oW14jXSopKT8oPzojKC4qKSk/KS9cbiAgICB9XG4gIH1cblxuICB2YXIgbSA9IG8ucGFyc2VyW29wdHMuc3RyaWN0TW9kZSA/ICdzdHJpY3QnIDogJ2xvb3NlJ10uZXhlYyhzdHIpXG4gIHZhciB1cmkgPSB7fVxuICB2YXIgaSA9IDE0XG5cbiAgd2hpbGUgKGktLSkgdXJpW28ua2V5W2ldXSA9IG1baV0gfHwgJydcblxuICB1cmlbby5xLm5hbWVdID0ge31cbiAgdXJpW28ua2V5WzEyXV0ucmVwbGFjZShvLnEucGFyc2VyLCBmdW5jdGlvbiAoJDAsICQxLCAkMikge1xuICAgIGlmICgkMSkgdXJpW28ucS5uYW1lXVskMV0gPSAkMlxuICB9KVxuXG4gIHJldHVybiB1cmlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBwYXJzZVVSSVxuIiwgIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXG52YXIgTWluaVNpZ25hbEJpbmRpbmcgPSAoZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBNaW5pU2lnbmFsQmluZGluZyhmbiwgb25jZSwgdGhpc0FyZykge1xuICAgIGlmIChvbmNlID09PSB1bmRlZmluZWQpIG9uY2UgPSBmYWxzZTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNaW5pU2lnbmFsQmluZGluZyk7XG5cbiAgICB0aGlzLl9mbiA9IGZuO1xuICAgIHRoaXMuX29uY2UgPSBvbmNlO1xuICAgIHRoaXMuX3RoaXNBcmcgPSB0aGlzQXJnO1xuICAgIHRoaXMuX25leHQgPSB0aGlzLl9wcmV2ID0gdGhpcy5fb3duZXIgPSBudWxsO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKE1pbmlTaWduYWxCaW5kaW5nLCBbe1xuICAgIGtleTogJ2RldGFjaCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaCgpIHtcbiAgICAgIGlmICh0aGlzLl9vd25lciA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgICAgdGhpcy5fb3duZXIuZGV0YWNoKHRoaXMpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIE1pbmlTaWduYWxCaW5kaW5nO1xufSkoKTtcblxuZnVuY3Rpb24gX2FkZE1pbmlTaWduYWxCaW5kaW5nKHNlbGYsIG5vZGUpIHtcbiAgaWYgKCFzZWxmLl9oZWFkKSB7XG4gICAgc2VsZi5faGVhZCA9IG5vZGU7XG4gICAgc2VsZi5fdGFpbCA9IG5vZGU7XG4gIH0gZWxzZSB7XG4gICAgc2VsZi5fdGFpbC5fbmV4dCA9IG5vZGU7XG4gICAgbm9kZS5fcHJldiA9IHNlbGYuX3RhaWw7XG4gICAgc2VsZi5fdGFpbCA9IG5vZGU7XG4gIH1cblxuICBub2RlLl9vd25lciA9IHNlbGY7XG5cbiAgcmV0dXJuIG5vZGU7XG59XG5cbnZhciBNaW5pU2lnbmFsID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTWluaVNpZ25hbCgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWluaVNpZ25hbCk7XG5cbiAgICB0aGlzLl9oZWFkID0gdGhpcy5fdGFpbCA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhNaW5pU2lnbmFsLCBbe1xuICAgIGtleTogJ2hhbmRsZXJzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlcnMoKSB7XG4gICAgICB2YXIgZXhpc3RzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbMF07XG5cbiAgICAgIHZhciBub2RlID0gdGhpcy5faGVhZDtcblxuICAgICAgaWYgKGV4aXN0cykgcmV0dXJuICEhbm9kZTtcblxuICAgICAgdmFyIGVlID0gW107XG5cbiAgICAgIHdoaWxlIChub2RlKSB7XG4gICAgICAgIGVlLnB1c2gobm9kZSk7XG4gICAgICAgIG5vZGUgPSBub2RlLl9uZXh0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnaGFzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzKG5vZGUpIHtcbiAgICAgIGlmICghKG5vZGUgaW5zdGFuY2VvZiBNaW5pU2lnbmFsQmluZGluZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaW5pU2lnbmFsI2hhcygpOiBGaXJzdCBhcmcgbXVzdCBiZSBhIE1pbmlTaWduYWxCaW5kaW5nIG9iamVjdC4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5vZGUuX293bmVyID09PSB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2Rpc3BhdGNoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcGF0Y2goKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX2hlYWQ7XG5cbiAgICAgIGlmICghbm9kZSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICB3aGlsZSAobm9kZSkge1xuICAgICAgICBpZiAobm9kZS5fb25jZSkgdGhpcy5kZXRhY2gobm9kZSk7XG4gICAgICAgIG5vZGUuX2ZuLmFwcGx5KG5vZGUuX3RoaXNBcmcsIGFyZ3VtZW50cyk7XG4gICAgICAgIG5vZGUgPSBub2RlLl9uZXh0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdhZGQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoZm4pIHtcbiAgICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGFyZ3VtZW50c1sxXTtcblxuICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pbmlTaWduYWwjYWRkKCk6IEZpcnN0IGFyZyBtdXN0IGJlIGEgRnVuY3Rpb24uJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gX2FkZE1pbmlTaWduYWxCaW5kaW5nKHRoaXMsIG5ldyBNaW5pU2lnbmFsQmluZGluZyhmbiwgZmFsc2UsIHRoaXNBcmcpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdvbmNlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gb25jZShmbikge1xuICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBudWxsIDogYXJndW1lbnRzWzFdO1xuXG4gICAgICBpZiAodHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWluaVNpZ25hbCNvbmNlKCk6IEZpcnN0IGFyZyBtdXN0IGJlIGEgRnVuY3Rpb24uJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gX2FkZE1pbmlTaWduYWxCaW5kaW5nKHRoaXMsIG5ldyBNaW5pU2lnbmFsQmluZGluZyhmbiwgdHJ1ZSwgdGhpc0FyZykpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2RldGFjaCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaChub2RlKSB7XG4gICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgTWluaVNpZ25hbEJpbmRpbmcpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWluaVNpZ25hbCNkZXRhY2goKTogRmlyc3QgYXJnIG11c3QgYmUgYSBNaW5pU2lnbmFsQmluZGluZyBvYmplY3QuJyk7XG4gICAgICB9XG4gICAgICBpZiAobm9kZS5fb3duZXIgIT09IHRoaXMpIHJldHVybiB0aGlzO1xuXG4gICAgICBpZiAobm9kZS5fcHJldikgbm9kZS5fcHJldi5fbmV4dCA9IG5vZGUuX25leHQ7XG4gICAgICBpZiAobm9kZS5fbmV4dCkgbm9kZS5fbmV4dC5fcHJldiA9IG5vZGUuX3ByZXY7XG5cbiAgICAgIGlmIChub2RlID09PSB0aGlzLl9oZWFkKSB7XG4gICAgICAgIHRoaXMuX2hlYWQgPSBub2RlLl9uZXh0O1xuICAgICAgICBpZiAobm9kZS5fbmV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuX3RhaWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG5vZGUgPT09IHRoaXMuX3RhaWwpIHtcbiAgICAgICAgdGhpcy5fdGFpbCA9IG5vZGUuX3ByZXY7XG4gICAgICAgIHRoaXMuX3RhaWwuX25leHQgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICBub2RlLl9vd25lciA9IG51bGw7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdkZXRhY2hBbGwnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hBbGwoKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX2hlYWQ7XG4gICAgICBpZiAoIW5vZGUpIHJldHVybiB0aGlzO1xuXG4gICAgICB0aGlzLl9oZWFkID0gdGhpcy5fdGFpbCA9IG51bGw7XG5cbiAgICAgIHdoaWxlIChub2RlKSB7XG4gICAgICAgIG5vZGUuX293bmVyID0gbnVsbDtcbiAgICAgICAgbm9kZSA9IG5vZGUuX25leHQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gTWluaVNpZ25hbDtcbn0pKCk7XG5cbk1pbmlTaWduYWwuTWluaVNpZ25hbEJpbmRpbmcgPSBNaW5pU2lnbmFsQmluZGluZztcblxuZXhwb3J0c1snZGVmYXVsdCddID0gTWluaVNpZ25hbDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuIiwgImltcG9ydCB7IFBvbHlmaWxsIH0gZnJvbSAnZXM2LXByb21pc2UtcG9seWZpbGwnO1xuXG4vLyBTdXBwb3J0IGZvciBJRSA5IC0gMTEgd2hpY2ggZG9lcyBub3QgaW5jbHVkZSBQcm9taXNlc1xuaWYgKCF3aW5kb3cuUHJvbWlzZSlcbntcbiAgICB3aW5kb3cuUHJvbWlzZSA9IFBvbHlmaWxsO1xufVxuIiwgIi8vIFJlZmVyZW5jZXM6XG4vLyBodHRwczovL2dpdGh1Yi5jb20vc2luZHJlc29yaHVzL29iamVjdC1hc3NpZ25cbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9hc3NpZ25cblxuaW1wb3J0IG9iamVjdEFzc2lnbiBmcm9tICdvYmplY3QtYXNzaWduJztcblxuaWYgKCFPYmplY3QuYXNzaWduKVxue1xuICAgIE9iamVjdC5hc3NpZ24gPSBvYmplY3RBc3NpZ247XG59XG4iLCAiLy8gUmVmZXJlbmNlczpcbi8vIGh0dHA6Ly9wYXVsaXJpc2guY29tLzIwMTEvcmVxdWVzdGFuaW1hdGlvbmZyYW1lLWZvci1zbWFydC1hbmltYXRpbmcvXG4vLyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS8xNTc5NjcxXG4vLyBodHRwOi8vdXBkYXRlcy5odG1sNXJvY2tzLmNvbS8yMDEyLzA1L3JlcXVlc3RBbmltYXRpb25GcmFtZS1BUEktbm93LXdpdGgtc3ViLW1pbGxpc2Vjb25kLXByZWNpc2lvblxuLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vdGltaGFsbC80MDc4NjE0XG4vLyBodHRwczovL2dpdGh1Yi5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvdHJlZS9tYXN0ZXIvcG9seWZpbGxzL3JlcXVlc3RBbmltYXRpb25GcmFtZVxuXG4vLyBFeHBlY3RlZCB0byBiZSB1c2VkIHdpdGggQnJvd3NlcmZpeVxuLy8gQnJvd3NlcmlmeSBhdXRvbWF0aWNhbGx5IGRldGVjdHMgdGhlIHVzZSBvZiBgZ2xvYmFsYCBhbmQgcGFzc2VzIHRoZVxuLy8gY29ycmVjdCByZWZlcmVuY2Ugb2YgYGdsb2JhbGAsIGBzZWxmYCwgYW5kIGZpbmFsbHkgYHdpbmRvd2BcblxuY29uc3QgT05FX0ZSQU1FX1RJTUUgPSAxNjtcblxuLy8gRGF0ZS5ub3dcbmlmICghKERhdGUubm93ICYmIERhdGUucHJvdG90eXBlLmdldFRpbWUpKVxue1xuICAgIERhdGUubm93ID0gZnVuY3Rpb24gbm93KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIH07XG59XG5cbi8vIHBlcmZvcm1hbmNlLm5vd1xuaWYgKCEod2luZG93LnBlcmZvcm1hbmNlICYmIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cpKVxue1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICBpZiAoIXdpbmRvdy5wZXJmb3JtYW5jZSlcbiAgICB7XG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5wZXJmb3JtYW5jZSA9IHt9O1xuICAgIH1cblxuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cgPSAoKTogbnVtYmVyID0+IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG59XG5cbi8vIHJlcXVlc3RBbmltYXRpb25GcmFtZVxubGV0IGxhc3RUaW1lID0gRGF0ZS5ub3coKTtcbmNvbnN0IHZlbmRvcnMgPSBbJ21zJywgJ21veicsICd3ZWJraXQnLCAnbyddO1xuXG5mb3IgKGxldCB4ID0gMDsgeCA8IHZlbmRvcnMubGVuZ3RoICYmICF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lOyArK3gpXG57XG4gICAgY29uc3QgcCA9IHZlbmRvcnNbeF07XG5cbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gKHdpbmRvdyBhcyBhbnkpW2Ake3B9UmVxdWVzdEFuaW1hdGlvbkZyYW1lYF07XG4gICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gKHdpbmRvdyBhcyBhbnkpW2Ake3B9Q2FuY2VsQW5pbWF0aW9uRnJhbWVgXVxuICAgICAgICB8fCAod2luZG93IGFzIGFueSlbYCR7cH1DYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWVgXTtcbn1cblxuaWYgKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKVxue1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSAoY2FsbGJhY2s6ICguLi5wYXJtczogYW55W10pID0+IHZvaWQpOiBudW1iZXIgPT5cbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7Y2FsbGJhY2t9aXMgbm90IGEgZnVuY3Rpb25gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgbGV0IGRlbGF5ID0gT05FX0ZSQU1FX1RJTUUgKyBsYXN0VGltZSAtIGN1cnJlbnRUaW1lO1xuXG4gICAgICAgIGlmIChkZWxheSA8IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxhc3RUaW1lID0gY3VycmVudFRpbWU7XG5cbiAgICAgICAgcmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhc3RUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKHBlcmZvcm1hbmNlLm5vdygpKTtcbiAgICAgICAgfSwgZGVsYXkpO1xuICAgIH07XG59XG5cbmlmICghd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKVxue1xuICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IChpZDogbnVtYmVyKTogdm9pZCA9PiBjbGVhclRpbWVvdXQoaWQpO1xufVxuIiwgIi8vIFJlZmVyZW5jZXM6XG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9NYXRoL3NpZ25cblxuaWYgKCFNYXRoLnNpZ24pXG57XG4gICAgTWF0aC5zaWduID0gZnVuY3Rpb24gbWF0aFNpZ24oeCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgeCA9IE51bWJlcih4KTtcblxuICAgICAgICBpZiAoeCA9PT0gMCB8fCBpc05hTih4KSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geCA+IDAgPyAxIDogLTE7XG4gICAgfTtcbn1cbiIsICIvLyBSZWZlcmVuY2VzOlxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvTnVtYmVyL2lzSW50ZWdlclxuXG5pZiAoIU51bWJlci5pc0ludGVnZXIpXG57XG4gICAgTnVtYmVyLmlzSW50ZWdlciA9IGZ1bmN0aW9uIG51bWJlcklzSW50ZWdlcih2YWx1ZSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbHVlKSAmJiBNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWU7XG4gICAgfTtcbn1cbiIsICJpbXBvcnQgJy4vUHJvbWlzZSc7XG5pbXBvcnQgJy4vT2JqZWN0LmFzc2lnbic7XG5pbXBvcnQgJy4vcmVxdWVzdEFuaW1hdGlvbkZyYW1lJztcbmltcG9ydCAnLi9NYXRoLnNpZ24nO1xuaW1wb3J0ICcuL051bWJlci5pc0ludGVnZXInO1xuXG5pZiAoIXdpbmRvdy5BcnJheUJ1ZmZlcilcbntcbiAgICAod2luZG93IGFzIGFueSkuQXJyYXlCdWZmZXIgPSBBcnJheTtcbn1cblxuaWYgKCF3aW5kb3cuRmxvYXQzMkFycmF5KVxue1xuICAgICh3aW5kb3cgYXMgYW55KS5GbG9hdDMyQXJyYXkgPSBBcnJheTtcbn1cblxuaWYgKCF3aW5kb3cuVWludDMyQXJyYXkpXG57XG4gICAgKHdpbmRvdyBhcyBhbnkpLlVpbnQzMkFycmF5ID0gQXJyYXk7XG59XG5cbmlmICghd2luZG93LlVpbnQxNkFycmF5KVxue1xuICAgICh3aW5kb3cgYXMgYW55KS5VaW50MTZBcnJheSA9IEFycmF5O1xufVxuXG5pZiAoIXdpbmRvdy5VaW50OEFycmF5KVxue1xuICAgICh3aW5kb3cgYXMgYW55KS5VaW50OEFycmF5ID0gQXJyYXk7XG59XG5cbmlmICghd2luZG93LkludDMyQXJyYXkpXG57XG4gICAgKHdpbmRvdyBhcyBhbnkpLkludDMyQXJyYXkgPSBBcnJheTtcbn1cbiIsIG51bGwsICIvLyBUaGUgRVNNL0NKUyB2ZXJzaW9ucyBvZiBpc21vYmlsZWpzIG9ubHlcbi8vIGV4cG9ydHMgdGhlIGZ1bmN0aW9uIGZvciBleGVjdXRpbmdcbi8vIGRlc2lnbmVkIGZvciBOb2RlLW9ubHkgZW52aXJvbm1lbnRzXG5pbXBvcnQgaXNNb2JpbGVDYWxsIGZyb20gJ2lzbW9iaWxlanMnO1xuXG5jb25zdCBpc01vYmlsZSA9IGlzTW9iaWxlQ2FsbCh3aW5kb3cubmF2aWdhdG9yKTtcblxuZXhwb3J0IHsgaXNNb2JpbGUgfTtcbiIsICJpbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJy4vaXNNb2JpbGUnO1xuXG4vKipcbiAqIFRoZSBtYXhpbXVtIHJlY29tbWVuZGVkIHRleHR1cmUgdW5pdHMgdG8gdXNlLlxuICogSW4gdGhlb3J5IHRoZSBiaWdnZXIgdGhlIGJldHRlciwgYW5kIGZvciBkZXNrdG9wIHdlJ2xsIHVzZSBhcyBtYW55IGFzIHdlIGNhbi5cbiAqIEJ1dCBzb21lIG1vYmlsZSBkZXZpY2VzIHNsb3cgZG93biBpZiB0aGVyZSBpcyB0byBtYW55IGJyYW5jaGVzIGluIHRoZSBzaGFkZXIuXG4gKiBTbyBpbiBwcmFjdGljZSB0aGVyZSBzZWVtcyB0byBiZSBhIHN3ZWV0IHNwb3Qgc2l6ZSB0aGF0IHZhcmllcyBkZXBlbmRpbmcgb24gdGhlIGRldmljZS5cbiAqXG4gKiBJbiB2NCwgYWxsIG1vYmlsZSBkZXZpY2VzIHdlcmUgbGltaXRlZCB0byA0IHRleHR1cmUgdW5pdHMgYmVjYXVzZSBmb3IgdGhpcy5cbiAqIEluIHY1LCB3ZSBhbGxvdyBhbGwgdGV4dHVyZSB1bml0cyB0byBiZSB1c2VkIG9uIG1vZGVybiBBcHBsZSBvciBBbmRyb2lkIGRldmljZXMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXhcbiAqIEByZXR1cm5zIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXhSZWNvbW1lbmRlZFRleHR1cmVzKG1heDogbnVtYmVyKTogbnVtYmVyXG57XG4gICAgbGV0IGFsbG93TWF4ID0gdHJ1ZTtcblxuICAgIGlmIChpc01vYmlsZS50YWJsZXQgfHwgaXNNb2JpbGUucGhvbmUpXG4gICAge1xuICAgICAgICBpZiAoaXNNb2JpbGUuYXBwbGUuZGV2aWNlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IChuYXZpZ2F0b3IudXNlckFnZW50KS5tYXRjaCgvT1MgKFxcZCspXyhcXGQrKT8vKTtcblxuICAgICAgICAgICAgaWYgKG1hdGNoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1ham9yVmVyc2lvbiA9IHBhcnNlSW50KG1hdGNoWzFdLCAxMCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMaW1pdCB0ZXh0dXJlIHVuaXRzIG9uIGRldmljZXMgYmVsb3cgaU9TIDExLCB3aGljaCB3aWxsIGJlIG9sZGVyIGhhcmR3YXJlXG4gICAgICAgICAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA8IDExKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dNYXggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTW9iaWxlLmFuZHJvaWQuZGV2aWNlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IChuYXZpZ2F0b3IudXNlckFnZW50KS5tYXRjaCgvQW5kcm9pZFxccyhbMC05Ll0qKS8pO1xuXG4gICAgICAgICAgICBpZiAobWF0Y2gpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFqb3JWZXJzaW9uID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKTtcblxuICAgICAgICAgICAgICAgIC8vIExpbWl0IHRleHR1cmUgdW5pdHMgb24gZGV2aWNlcyBiZWxvdyBBbmRyb2lkIDcgKE5vdWdhdCksIHdoaWNoIHdpbGwgYmUgb2xkZXIgaGFyZHdhcmVcbiAgICAgICAgICAgICAgICBpZiAobWFqb3JWZXJzaW9uIDwgNylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGFsbG93TWF4ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGFsbG93TWF4ID8gbWF4IDogNDtcbn1cbiIsICJpbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJy4vaXNNb2JpbGUnO1xuXG4vKipcbiAqIFVwbG9hZGluZyB0aGUgc2FtZSBidWZmZXIgbXVsdGlwbGUgdGltZXMgaW4gYSBzaW5nbGUgZnJhbWUgY2FuIGNhdXNlIHBlcmZvcm1hbmNlIGlzc3Vlcy5cbiAqIEFwcGFyZW50IG9uIGlPUyBzbyBvbmx5IGNoZWNrIGZvciB0aGF0IGF0IHRoZSBtb21lbnRcbiAqIFRoaXMgY2hlY2sgbWF5IGJlY29tZSBtb3JlIGNvbXBsZXggaWYgdGhpcyBpc3N1ZSBwb3BzIHVwIGVsc2V3aGVyZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5VcGxvYWRTYW1lQnVmZmVyKCk6IGJvb2xlYW5cbntcbiAgICByZXR1cm4gIWlzTW9iaWxlLmFwcGxlLmRldmljZTtcbn1cbiIsICJpbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJy4vdXRpbHMvaXNNb2JpbGUnO1xuaW1wb3J0IHsgbWF4UmVjb21tZW5kZWRUZXh0dXJlcyB9IGZyb20gJy4vdXRpbHMvbWF4UmVjb21tZW5kZWRUZXh0dXJlcyc7XG5pbXBvcnQgeyBjYW5VcGxvYWRTYW1lQnVmZmVyIH0gZnJvbSAnLi91dGlscy9jYW5VcGxvYWRTYW1lQnVmZmVyJztcblxuZXhwb3J0IGludGVyZmFjZSBJUmVuZGVyT3B0aW9ucyB7XG4gICAgdmlldzogSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgYW50aWFsaWFzOiBib29sZWFuO1xuICAgIGF1dG9EZW5zaXR5OiBib29sZWFuO1xuICAgIHRyYW5zcGFyZW50OiBib29sZWFuO1xuICAgIGJhY2tncm91bmRDb2xvcjogbnVtYmVyO1xuICAgIGNsZWFyQmVmb3JlUmVuZGVyOiBib29sZWFuO1xuICAgIHByZXNlcnZlRHJhd2luZ0J1ZmZlcjogYm9vbGVhbjtcbiAgICB3aWR0aDogbnVtYmVyO1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIGxlZ2FjeTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJU2V0dGluZ3Mge1xuICAgIE1JUE1BUF9URVhUVVJFUzogbnVtYmVyO1xuICAgIEFOSVNPVFJPUElDX0xFVkVMOiBudW1iZXI7XG4gICAgUkVTT0xVVElPTjogbnVtYmVyO1xuICAgIEZJTFRFUl9SRVNPTFVUSU9OOiBudW1iZXI7XG4gICAgU1BSSVRFX01BWF9URVhUVVJFUzogbnVtYmVyO1xuICAgIFNQUklURV9CQVRDSF9TSVpFOiBudW1iZXI7XG4gICAgUkVOREVSX09QVElPTlM6IElSZW5kZXJPcHRpb25zO1xuICAgIEdDX01PREU6IG51bWJlcjtcbiAgICBHQ19NQVhfSURMRTogbnVtYmVyO1xuICAgIEdDX01BWF9DSEVDS19DT1VOVDogbnVtYmVyO1xuICAgIFdSQVBfTU9ERTogbnVtYmVyO1xuICAgIFNDQUxFX01PREU6IG51bWJlcjtcbiAgICBQUkVDSVNJT05fVkVSVEVYOiBzdHJpbmc7XG4gICAgUFJFQ0lTSU9OX0ZSQUdNRU5UOiBzdHJpbmc7XG4gICAgQ0FOX1VQTE9BRF9TQU1FX0JVRkZFUjogYm9vbGVhbjtcbiAgICBDUkVBVEVfSU1BR0VfQklUTUFQOiBib29sZWFuO1xuICAgIFJPVU5EX1BJWEVMUzogYm9vbGVhbjtcbiAgICBSRVRJTkFfUFJFRklYPzogUmVnRXhwO1xuICAgIEZBSUxfSUZfTUFKT1JfUEVSRk9STUFOQ0VfQ0FWRUFUPzogYm9vbGVhbjtcbiAgICBVUExPQURTX1BFUl9GUkFNRT86IG51bWJlcjtcbiAgICBTT1JUQUJMRV9DSElMRFJFTj86IGJvb2xlYW47XG4gICAgUFJFRkVSX0VOVj86IG51bWJlcjtcbiAgICBTVFJJQ1RfVEVYVFVSRV9DQUNIRT86IGJvb2xlYW47XG4gICAgTUVTSF9DQU5WQVNfUEFERElORz86IG51bWJlcjtcbiAgICBUQVJHRVRfRlBNUz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBVc2VyJ3MgY3VzdG9taXphYmxlIGdsb2JhbHMgZm9yIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHQgUElYSSBzZXR0aW5ncywgc3VjaFxuICogYXMgYSByZW5kZXJlcidzIGRlZmF1bHQgcmVzb2x1dGlvbiwgZnJhbWVyYXRlLCBmbG9hdCBwcmVjaXNpb24sIGV0Yy5cbiAqIEBleGFtcGxlXG4gKiAvLyBVc2UgdGhlIG5hdGl2ZSB3aW5kb3cgcmVzb2x1dGlvbiBhcyB0aGUgZGVmYXVsdCByZXNvbHV0aW9uXG4gKiAvLyB3aWxsIHN1cHBvcnQgaGlnaC1kZW5zaXR5IGRpc3BsYXlzIHdoZW4gcmVuZGVyaW5nXG4gKiBQSVhJLnNldHRpbmdzLlJFU09MVVRJT04gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcbiAqXG4gKiAvLyBEaXNhYmxlIGludGVycG9sYXRpb24gd2hlbiBzY2FsaW5nLCB3aWxsIG1ha2UgdGV4dHVyZSBiZSBwaXhlbGF0ZWRcbiAqIFBJWEkuc2V0dGluZ3MuU0NBTEVfTU9ERSA9IFBJWEkuU0NBTEVfTU9ERVMuTkVBUkVTVDtcbiAqIEBuYW1lc3BhY2UgUElYSS5zZXR0aW5nc1xuICovXG5leHBvcnQgY29uc3Qgc2V0dGluZ3M6IElTZXR0aW5ncyA9IHtcblxuICAgIC8qKlxuICAgICAqIElmIHNldCB0byB0cnVlIFdlYkdMIHdpbGwgYXR0ZW1wdCBtYWtlIHRleHR1cmVzIG1pbXBhcGVkIGJ5IGRlZmF1bHQuXG4gICAgICogTWlwbWFwcGluZyB3aWxsIG9ubHkgc3VjY2VlZCBpZiB0aGUgYmFzZSB0ZXh0dXJlIHVwbG9hZGVkIGhhcyBwb3dlciBvZiB0d28gZGltZW5zaW9ucy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbmFtZSBNSVBNQVBfVEVYVFVSRVNcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICAgICAqIEB0eXBlIHtQSVhJLk1JUE1BUF9NT0RFU31cbiAgICAgKiBAZGVmYXVsdCBQSVhJLk1JUE1BUF9NT0RFUy5QT1cyXG4gICAgICovXG4gICAgTUlQTUFQX1RFWFRVUkVTOiAxLFxuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBhbmlzb3Ryb3BpYyBmaWx0ZXJpbmcgbGV2ZWwgb2YgdGV4dHVyZXMuXG4gICAgICogVXN1YWxseSBmcm9tIDAgdG8gMTZcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbmFtZSBBTklTT1RST1BJQ19MRVZFTFxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAwXG4gICAgICovXG4gICAgQU5JU09UUk9QSUNfTEVWRUw6IDAsXG5cbiAgICAvKipcbiAgICAgKiBEZWZhdWx0IHJlc29sdXRpb24gLyBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgdGhlIHJlbmRlcmVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBuYW1lIFJFU09MVVRJT05cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMVxuICAgICAqL1xuICAgIFJFU09MVVRJT046IDEsXG5cbiAgICAvKipcbiAgICAgKiBEZWZhdWx0IGZpbHRlciByZXNvbHV0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBuYW1lIEZJTFRFUl9SRVNPTFVUSU9OXG4gICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDFcbiAgICAgKi9cbiAgICBGSUxURVJfUkVTT0xVVElPTjogMSxcblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIHRleHR1cmVzIHRoYXQgdGhpcyBkZXZpY2Ugc3VwcG9ydHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgU1BSSVRFX01BWF9URVhUVVJFU1xuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAzMlxuICAgICAqL1xuICAgIFNQUklURV9NQVhfVEVYVFVSRVM6IG1heFJlY29tbWVuZGVkVGV4dHVyZXMoMzIpLFxuXG4gICAgLy8gVE9ETzogbWF5YmUgY2hhbmdlIHRvIFNQUklURS5CQVRDSF9TSVpFOiAyMDAwXG4gICAgLy8gVE9ETzogbWF5YmUgYWRkIFBBUlRJQ0xFLkJBVENIX1NJWkU6IDE1MDAwXG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVmYXVsdCBzcHJpdGUgYmF0Y2ggc2l6ZS5cbiAgICAgKlxuICAgICAqIFRoZSBkZWZhdWx0IGFpbXMgdG8gYmFsYW5jZSBkZXNrdG9wIGFuZCBtb2JpbGUgZGV2aWNlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbmFtZSBTUFJJVEVfQkFUQ0hfU0laRVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCA0MDk2XG4gICAgICovXG4gICAgU1BSSVRFX0JBVENIX1NJWkU6IDQwOTYsXG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVmYXVsdCByZW5kZXIgb3B0aW9ucyBpZiBub25lIGFyZSBzdXBwbGllZCB0byB7QGxpbmsgUElYSS5SZW5kZXJlcn1cbiAgICAgKiBvciB7QGxpbmsgUElYSS5DYW52YXNSZW5kZXJlcn0uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgUkVOREVSX09QVElPTlNcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICogQHByb3BlcnR5IHtIVE1MQ2FudmFzRWxlbWVudH0gdmlldz1udWxsXG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IHJlc29sdXRpb249MVxuICAgICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYW50aWFsaWFzPWZhbHNlXG4gICAgICogQHByb3BlcnR5IHtib29sZWFufSBhdXRvRGVuc2l0eT1mYWxzZVxuICAgICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdHJhbnNwYXJlbnQ9ZmFsc2VcbiAgICAgKiBAcHJvcGVydHkge251bWJlcn0gYmFja2dyb3VuZENvbG9yPTB4MDAwMDAwXG4gICAgICogQHByb3BlcnR5IHtib29sZWFufSBjbGVhckJlZm9yZVJlbmRlcj10cnVlXG4gICAgICogQHByb3BlcnR5IHtib29sZWFufSBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI9ZmFsc2VcbiAgICAgKiBAcHJvcGVydHkge251bWJlcn0gd2lkdGg9ODAwXG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IGhlaWdodD02MDBcbiAgICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IGxlZ2FjeT1mYWxzZVxuICAgICAqL1xuICAgIFJFTkRFUl9PUFRJT05TOiB7XG4gICAgICAgIHZpZXc6IG51bGwsXG4gICAgICAgIGFudGlhbGlhczogZmFsc2UsXG4gICAgICAgIGF1dG9EZW5zaXR5OiBmYWxzZSxcbiAgICAgICAgdHJhbnNwYXJlbnQ6IGZhbHNlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IDB4MDAwMDAwLFxuICAgICAgICBjbGVhckJlZm9yZVJlbmRlcjogdHJ1ZSxcbiAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBmYWxzZSxcbiAgICAgICAgd2lkdGg6IDgwMCxcbiAgICAgICAgaGVpZ2h0OiA2MDAsXG4gICAgICAgIGxlZ2FjeTogZmFsc2UsXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgR2FyYmFnZSBDb2xsZWN0aW9uIG1vZGUuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgR0NfTU9ERVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge1BJWEkuR0NfTU9ERVN9XG4gICAgICogQGRlZmF1bHQgUElYSS5HQ19NT0RFUy5BVVRPXG4gICAgICovXG4gICAgR0NfTU9ERTogMCxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgR2FyYmFnZSBDb2xsZWN0aW9uIG1heCBpZGxlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBuYW1lIEdDX01BWF9JRExFXG4gICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDM2MDBcbiAgICAgKi9cbiAgICBHQ19NQVhfSURMRTogNjAgKiA2MCxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgR2FyYmFnZSBDb2xsZWN0aW9uIG1heGltdW0gY2hlY2sgY291bnQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgR0NfTUFYX0NIRUNLX0NPVU5UXG4gICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDYwMFxuICAgICAqL1xuICAgIEdDX01BWF9DSEVDS19DT1VOVDogNjAgKiAxMCxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgd3JhcCBtb2RlcyB0aGF0IGFyZSBzdXBwb3J0ZWQgYnkgcGl4aS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbmFtZSBXUkFQX01PREVcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICAgICAqIEB0eXBlIHtQSVhJLldSQVBfTU9ERVN9XG4gICAgICogQGRlZmF1bHQgUElYSS5XUkFQX01PREVTLkNMQU1QXG4gICAgICovXG4gICAgV1JBUF9NT0RFOiAzMzA3MSxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgc2NhbGUgbW9kZSBmb3IgdGV4dHVyZXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgU0NBTEVfTU9ERVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge1BJWEkuU0NBTEVfTU9ERVN9XG4gICAgICogQGRlZmF1bHQgUElYSS5TQ0FMRV9NT0RFUy5MSU5FQVJcbiAgICAgKi9cbiAgICBTQ0FMRV9NT0RFOiAxLFxuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBzcGVjaWZ5IGZsb2F0IHByZWNpc2lvbiBpbiB2ZXJ0ZXggc2hhZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBuYW1lIFBSRUNJU0lPTl9WRVJURVhcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICAgICAqIEB0eXBlIHtQSVhJLlBSRUNJU0lPTn1cbiAgICAgKiBAZGVmYXVsdCBQSVhJLlBSRUNJU0lPTi5ISUdIXG4gICAgICovXG4gICAgUFJFQ0lTSU9OX1ZFUlRFWDogJ2hpZ2hwJyxcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgc3BlY2lmeSBmbG9hdCBwcmVjaXNpb24gaW4gZnJhZ21lbnQgc2hhZGVyLlxuICAgICAqIGlPUyBpcyBiZXN0IHNldCBhdCBoaWdocCBkdWUgdG8gaHR0cHM6Ly9naXRodWIuY29tL3BpeGlqcy9waXhpLmpzL2lzc3Vlcy8zNzQyXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgUFJFQ0lTSU9OX0ZSQUdNRU5UXG4gICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgKiBAdHlwZSB7UElYSS5QUkVDSVNJT059XG4gICAgICogQGRlZmF1bHQgUElYSS5QUkVDSVNJT04uTUVESVVNXG4gICAgICovXG4gICAgUFJFQ0lTSU9OX0ZSQUdNRU5UOiBpc01vYmlsZS5hcHBsZS5kZXZpY2UgPyAnaGlnaHAnIDogJ21lZGl1bXAnLFxuXG4gICAgLyoqXG4gICAgICogQ2FuIHdlIHVwbG9hZCB0aGUgc2FtZSBidWZmZXIgaW4gYSBzaW5nbGUgZnJhbWU/XG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgQ0FOX1VQTE9BRF9TQU1FX0JVRkZFUlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgQ0FOX1VQTE9BRF9TQU1FX0JVRkZFUjogY2FuVXBsb2FkU2FtZUJ1ZmZlcigpLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBiaXRtYXAgY3JlYXRpb24gYmVmb3JlIGltYWdlIGxvYWQuIFRoaXMgZmVhdHVyZSBpcyBleHBlcmltZW50YWwuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG5hbWUgQ1JFQVRFX0lNQUdFX0JJVE1BUFxuICAgICAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgKi9cbiAgICBDUkVBVEVfSU1BR0VfQklUTUFQOiBmYWxzZSxcblxuICAgIC8qKlxuICAgICAqIElmIHRydWUgUGl4aUpTIHdpbGwgTWF0aC5mbG9vcigpIHgveSB2YWx1ZXMgd2hlbiByZW5kZXJpbmcsIHN0b3BwaW5nIHBpeGVsIGludGVycG9sYXRpb24uXG4gICAgICogQWR2YW50YWdlcyBjYW4gaW5jbHVkZSBzaGFycGVyIGltYWdlIHF1YWxpdHkgKGxpa2UgdGV4dCkgYW5kIGZhc3RlciByZW5kZXJpbmcgb24gY2FudmFzLlxuICAgICAqIFRoZSBtYWluIGRpc2FkdmFudGFnZSBpcyBtb3ZlbWVudCBvZiBvYmplY3RzIG1heSBhcHBlYXIgbGVzcyBzbW9vdGguXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQGNvbnN0YW50XG4gICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAqL1xuICAgIFJPVU5EX1BJWEVMUzogZmFsc2UsXG59O1xuIiwgIi8qKlxuICogRGlmZmVyZW50IHR5cGVzIG9mIGVudmlyb25tZW50cyBmb3IgV2ViR0wuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBuYW1lIEVOVlxuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBXRUJHTF9MRUdBQ1kgLSBVc2VkIGZvciBvbGRlciB2MSBXZWJHTCBkZXZpY2VzLiBQaXhpSlMgd2lsbCBhaW0gdG8gZW5zdXJlIGNvbXBhdGliaWxpdHlcbiAqICB3aXRoIG9sZGVyIC8gbGVzcyBhZHZhbmNlZCBkZXZpY2VzLiBJZiB5b3UgZXhwZXJpZW5jZSB1bmV4cGxhaW5lZCBmbGlja2VyaW5nIHByZWZlciB0aGlzIGVudmlyb25tZW50LlxuICogQHByb3BlcnR5IHtudW1iZXJ9IFdFQkdMIC0gVmVyc2lvbiAxIG9mIFdlYkdMXG4gKiBAcHJvcGVydHkge251bWJlcn0gV0VCR0wyIC0gVmVyc2lvbiAyIG9mIFdlYkdMXG4gKi9cbmV4cG9ydCBlbnVtIEVOViB7XG4gICAgV0VCR0xfTEVHQUNZLFxuICAgIFdFQkdMLFxuICAgIFdFQkdMMixcbn1cblxuLyoqXG4gKiBDb25zdGFudCB0byBpZGVudGlmeSB0aGUgUmVuZGVyZXIgVHlwZS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQG5hbWUgUkVOREVSRVJfVFlQRVxuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVTktOT1dOIC0gVW5rbm93biByZW5kZXIgdHlwZS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBXRUJHTCAtIFdlYkdMIHJlbmRlciB0eXBlLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IENBTlZBUyAtIENhbnZhcyByZW5kZXIgdHlwZS5cbiAqL1xuZXhwb3J0IGVudW0gUkVOREVSRVJfVFlQRSB7XG4gICAgVU5LTk9XTixcbiAgICBXRUJHTCxcbiAgICBDQU5WQVMsXG59XG5cbi8qKlxuICogQml0d2lzZSBPUiBvZiBtYXNrcyB0aGF0IGluZGljYXRlIHRoZSBidWZmZXJzIHRvIGJlIGNsZWFyZWQuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBuYW1lIEJVRkZFUl9CSVRTXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IENPTE9SIC0gSW5kaWNhdGVzIHRoZSBidWZmZXJzIGN1cnJlbnRseSBlbmFibGVkIGZvciBjb2xvciB3cml0aW5nLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IERFUFRIIC0gSW5kaWNhdGVzIHRoZSBkZXB0aCBidWZmZXIuXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1RFTkNJTCAtIEluZGljYXRlcyB0aGUgc3RlbmNpbCBidWZmZXIuXG4gKi9cbmV4cG9ydCBlbnVtIEJVRkZFUl9CSVRTIHtcbiAgICBDT0xPUiA9IDB4MDAwMDQwMDAsXG4gICAgREVQVEggPSAweDAwMDAwMTAwLFxuICAgIFNURU5DSUwgPSAweDAwMDAwNDAwXG59XG5cbi8qKlxuICogVmFyaW91cyBibGVuZCBtb2RlcyBzdXBwb3J0ZWQgYnkgUElYSS5cbiAqXG4gKiBJTVBPUlRBTlQgLSBUaGUgV2ViR0wgcmVuZGVyZXIgb25seSBzdXBwb3J0cyB0aGUgTk9STUFMLCBBREQsIE1VTFRJUExZIGFuZCBTQ1JFRU4gYmxlbmQgbW9kZXMuXG4gKiBBbnl0aGluZyBlbHNlIHdpbGwgc2lsZW50bHkgYWN0IGxpa2UgTk9STUFMLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAbmFtZSBCTEVORF9NT0RFU1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT1JNQUxcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBBRERcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBNVUxUSVBMWVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNDUkVFTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IE9WRVJMQVlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEQVJLRU5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMSUdIVEVOXG4gKiBAcHJvcGVydHkge251bWJlcn0gQ09MT1JfRE9ER0VcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBDT0xPUl9CVVJOXG4gKiBAcHJvcGVydHkge251bWJlcn0gSEFSRF9MSUdIVFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNPRlRfTElHSFRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBESUZGRVJFTkNFXG4gKiBAcHJvcGVydHkge251bWJlcn0gRVhDTFVTSU9OXG4gKiBAcHJvcGVydHkge251bWJlcn0gSFVFXG4gKiBAcHJvcGVydHkge251bWJlcn0gU0FUVVJBVElPTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IENPTE9SXG4gKiBAcHJvcGVydHkge251bWJlcn0gTFVNSU5PU0lUWVxuICogQHByb3BlcnR5IHtudW1iZXJ9IE5PUk1BTF9OUE1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBBRERfTlBNXG4gKiBAcHJvcGVydHkge251bWJlcn0gU0NSRUVOX05QTVxuICogQHByb3BlcnR5IHtudW1iZXJ9IE5PTkVcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTUkNfSU5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTUkNfT1VUXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1JDX0FUT1BcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEU1RfT1ZFUlxuICogQHByb3BlcnR5IHtudW1iZXJ9IERTVF9JTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IERTVF9PVVRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEU1RfQVRPUFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNVQlRSQUNUXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1JDX09WRVJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBFUkFTRVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFhPUlxuICovXG5leHBvcnQgZW51bSBCTEVORF9NT0RFUyB7XG4gICAgTk9STUFMID0gMCxcbiAgICBBREQgPSAxLFxuICAgIE1VTFRJUExZID0gMixcbiAgICBTQ1JFRU4gPSAzLFxuICAgIE9WRVJMQVkgPSA0LFxuICAgIERBUktFTiA9IDUsXG4gICAgTElHSFRFTiA9IDYsXG4gICAgQ09MT1JfRE9ER0UgPSA3LFxuICAgIENPTE9SX0JVUk4gPSA4LFxuICAgIEhBUkRfTElHSFQgPSA5LFxuICAgIFNPRlRfTElHSFQgPSAxMCxcbiAgICBESUZGRVJFTkNFID0gMTEsXG4gICAgRVhDTFVTSU9OID0gMTIsXG4gICAgSFVFID0gMTMsXG4gICAgU0FUVVJBVElPTiA9IDE0LFxuICAgIENPTE9SID0gMTUsXG4gICAgTFVNSU5PU0lUWSA9IDE2LFxuICAgIE5PUk1BTF9OUE0gPSAxNyxcbiAgICBBRERfTlBNID0gMTgsXG4gICAgU0NSRUVOX05QTSA9IDE5LFxuICAgIE5PTkUgPSAyMCxcblxuICAgIFNSQ19PVkVSID0gMCxcbiAgICBTUkNfSU4gPSAyMSxcbiAgICBTUkNfT1VUID0gMjIsXG4gICAgU1JDX0FUT1AgPSAyMyxcbiAgICBEU1RfT1ZFUiA9IDI0LFxuICAgIERTVF9JTiA9IDI1LFxuICAgIERTVF9PVVQgPSAyNixcbiAgICBEU1RfQVRPUCA9IDI3LFxuICAgIEVSQVNFID0gMjYsXG4gICAgU1VCVFJBQ1QgPSAyOCxcbiAgICBYT1IgPSAyOSxcbn1cblxuLyoqXG4gKiBWYXJpb3VzIHdlYmdsIGRyYXcgbW9kZXMuIFRoZXNlIGNhbiBiZSB1c2VkIHRvIHNwZWNpZnkgd2hpY2ggR0wgZHJhd01vZGUgdG8gdXNlXG4gKiB1bmRlciBjZXJ0YWluIHNpdHVhdGlvbnMgYW5kIHJlbmRlcmVycy5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQG5hbWUgRFJBV19NT0RFU1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBQT0lOVFNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMSU5FU1xuICogQHByb3BlcnR5IHtudW1iZXJ9IExJTkVfTE9PUFxuICogQHByb3BlcnR5IHtudW1iZXJ9IExJTkVfU1RSSVBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBUUklBTkdMRVNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBUUklBTkdMRV9TVFJJUFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFRSSUFOR0xFX0ZBTlxuICovXG5leHBvcnQgZW51bSBEUkFXX01PREVTIHtcbiAgICBQT0lOVFMsXG4gICAgTElORVMsXG4gICAgTElORV9MT09QLFxuICAgIExJTkVfU1RSSVAsXG4gICAgVFJJQU5HTEVTLFxuICAgIFRSSUFOR0xFX1NUUklQLFxuICAgIFRSSUFOR0xFX0ZBTixcbn1cblxuLyoqXG4gKiBWYXJpb3VzIEdMIHRleHR1cmUvcmVzb3VyY2VzIGZvcm1hdHMuXG4gKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIEZPUk1BVFNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gUkdCQT02NDA4XG4gKiBAcHJvcGVydHkge251bWJlcn0gUkdCPTY0MDdcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBBTFBIQT02NDA2XG4gKiBAcHJvcGVydHkge251bWJlcn0gTFVNSU5BTkNFPTY0MDlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMVU1JTkFOQ0VfQUxQSEE9NjQxMFxuICogQHByb3BlcnR5IHtudW1iZXJ9IERFUFRIX0NPTVBPTkVOVD02NDAyXG4gKiBAcHJvcGVydHkge251bWJlcn0gREVQVEhfU1RFTkNJTD0zNDA0MVxuICovXG5leHBvcnQgZW51bSBGT1JNQVRTIHtcbiAgICBSR0JBID0gNjQwOCxcbiAgICBSR0IgPSA2NDA3LFxuICAgIEFMUEhBID0gNjQwNixcbiAgICBMVU1JTkFOQ0UgPSA2NDA5LFxuICAgIExVTUlOQU5DRV9BTFBIQSA9IDY0MTAsXG4gICAgREVQVEhfQ09NUE9ORU5UID0gNjQwMixcbiAgICBERVBUSF9TVEVOQ0lMID0gMzQwNDEsXG59XG5cbi8qKlxuICogVmFyaW91cyBHTCB0YXJnZXQgdHlwZXMuXG4gKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIFRBUkdFVFNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV8yRD0zNTUzXG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUD0zNDA2N1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFRFWFRVUkVfMkRfQVJSQVk9MzU4NjZcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1g9MzQwNjlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1g9MzQwNzBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1k9MzQwNzFcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1k9MzQwNzJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1o9MzQwNzNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1o9MzQwNzRcbiAqL1xuZXhwb3J0IGVudW0gVEFSR0VUUyB7XG4gICAgVEVYVFVSRV8yRCA9IDM1NTMsXG4gICAgVEVYVFVSRV9DVUJFX01BUCA9IDM0MDY3LFxuICAgIFRFWFRVUkVfMkRfQVJSQVkgPSAzNTg2NixcbiAgICBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ggPSAzNDA2OSxcbiAgICBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1ggPSAzNDA3MCxcbiAgICBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1kgPSAzNDA3MSxcbiAgICBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1kgPSAzNDA3MixcbiAgICBURVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ogPSAzNDA3MyxcbiAgICBURVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1ogPSAzNDA3NCxcbn1cblxuLyoqXG4gKiBWYXJpb3VzIEdMIGRhdGEgZm9ybWF0IHR5cGVzLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBUWVBFU1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVTlNJR05FRF9CWVRFPTUxMjFcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVTlNJR05FRF9TSE9SVD01MTIzXG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5TSUdORURfU0hPUlRfNV82XzU9MzM2MzVcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVTlNJR05FRF9TSE9SVF80XzRfNF80PTMyODE5XG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5TSUdORURfU0hPUlRfNV81XzVfMT0zMjgyMFxuICogQHByb3BlcnR5IHtudW1iZXJ9IEZMT0FUPTUxMjZcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBIQUxGX0ZMT0FUPTM2MTkzXG4gKi9cbmV4cG9ydCBlbnVtIFRZUEVTIHtcbiAgICBVTlNJR05FRF9CWVRFID0gNTEyMSxcbiAgICBVTlNJR05FRF9TSE9SVCA9IDUxMjMsXG4gICAgVU5TSUdORURfU0hPUlRfNV82XzUgPSAzMzYzNSxcbiAgICBVTlNJR05FRF9TSE9SVF80XzRfNF80ID0gMzI4MTksXG4gICAgVU5TSUdORURfU0hPUlRfNV81XzVfMSA9IDMyODIwLFxuICAgIEZMT0FUID0gNTEyNixcbiAgICBIQUxGX0ZMT0FUID0gMzYxOTMsXG59XG5cbi8qKlxuICogVGhlIHNjYWxlIG1vZGVzIHRoYXQgYXJlIHN1cHBvcnRlZCBieSBwaXhpLlxuICpcbiAqIFRoZSB7QGxpbmsgUElYSS5zZXR0aW5ncy5TQ0FMRV9NT0RFfSBzY2FsZSBtb2RlIGFmZmVjdHMgdGhlIGRlZmF1bHQgc2NhbGluZyBtb2RlIG9mIGZ1dHVyZSBvcGVyYXRpb25zLlxuICogSXQgY2FuIGJlIHJlLWFzc2lnbmVkIHRvIGVpdGhlciBMSU5FQVIgb3IgTkVBUkVTVCwgZGVwZW5kaW5nIHVwb24gc3VpdGFiaWxpdHkuXG4gKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIFNDQUxFX01PREVTXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IExJTkVBUiBTbW9vdGggc2NhbGluZ1xuICogQHByb3BlcnR5IHtudW1iZXJ9IE5FQVJFU1QgUGl4ZWxhdGluZyBzY2FsaW5nXG4gKi9cbmV4cG9ydCBlbnVtIFNDQUxFX01PREVTIHtcbiAgICBORUFSRVNULFxuICAgIExJTkVBUixcbn1cblxuLyoqXG4gKiBUaGUgd3JhcCBtb2RlcyB0aGF0IGFyZSBzdXBwb3J0ZWQgYnkgcGl4aS5cbiAqXG4gKiBUaGUge0BsaW5rIFBJWEkuc2V0dGluZ3MuV1JBUF9NT0RFfSB3cmFwIG1vZGUgYWZmZWN0cyB0aGUgZGVmYXVsdCB3cmFwcGluZyBtb2RlIG9mIGZ1dHVyZSBvcGVyYXRpb25zLlxuICogSXQgY2FuIGJlIHJlLWFzc2lnbmVkIHRvIGVpdGhlciBDTEFNUCBvciBSRVBFQVQsIGRlcGVuZGluZyB1cG9uIHN1aXRhYmlsaXR5LlxuICogSWYgdGhlIHRleHR1cmUgaXMgbm9uIHBvd2VyIG9mIHR3byB0aGVuIGNsYW1wIHdpbGwgYmUgdXNlZCByZWdhcmRsZXNzIGFzIFdlYkdMIGNhblxuICogb25seSB1c2UgUkVQRUFUIGlmIHRoZSB0ZXh0dXJlIGlzIHBvMi5cbiAqXG4gKiBUaGlzIHByb3BlcnR5IG9ubHkgYWZmZWN0cyBXZWJHTC5cbiAqXG4gKiBAbmFtZSBXUkFQX01PREVTXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBDTEFNUCAtIFRoZSB0ZXh0dXJlcyB1dnMgYXJlIGNsYW1wZWRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBSRVBFQVQgLSBUaGUgdGV4dHVyZSB1dnMgdGlsZSBhbmQgcmVwZWF0XG4gKiBAcHJvcGVydHkge251bWJlcn0gTUlSUk9SRURfUkVQRUFUIC0gVGhlIHRleHR1cmUgdXZzIHRpbGUgYW5kIHJlcGVhdCB3aXRoIG1pcnJvcmluZ1xuICovXG5leHBvcnQgZW51bSBXUkFQX01PREVTIHtcbiAgICBDTEFNUCA9IDMzMDcxLFxuICAgIFJFUEVBVCA9IDEwNDk3LFxuICAgIE1JUlJPUkVEX1JFUEVBVCA9IDMzNjQ4LFxufVxuXG4vKipcbiAqIE1pcG1hcCBmaWx0ZXJpbmcgbW9kZXMgdGhhdCBhcmUgc3VwcG9ydGVkIGJ5IHBpeGkuXG4gKlxuICogVGhlIHtAbGluayBQSVhJLnNldHRpbmdzLk1JUE1BUF9URVhUVVJFU30gYWZmZWN0cyBkZWZhdWx0IHRleHR1cmUgZmlsdGVyaW5nLlxuICogTWlwbWFwcyBhcmUgZ2VuZXJhdGVkIGZvciBhIGJhc2VUZXh0dXJlIGlmIGl0cyBgbWlwbWFwYCBmaWVsZCBpcyBgT05gLFxuICogb3IgaXRzIGBQT1cyYCBhbmQgdGV4dHVyZSBkaW1lbnNpb25zIGFyZSBwb3dlcnMgb2YgMi5cbiAqIER1ZSB0byBwbGF0Zm9ybSByZXN0cmljdGlvbiwgYE9OYCBvcHRpb24gd2lsbCB3b3JrIGxpa2UgYFBPVzJgIGZvciB3ZWJnbC0xLlxuICpcbiAqIFRoaXMgcHJvcGVydHkgb25seSBhZmZlY3RzIFdlYkdMLlxuICpcbiAqIEBuYW1lIE1JUE1BUF9NT0RFU1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gT0ZGIC0gTm8gbWlwbWFwc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFBPVzIgLSBHZW5lcmF0ZSBtaXBtYXBzIGlmIHRleHR1cmUgZGltZW5zaW9ucyBhcmUgcG93MlxuICogQHByb3BlcnR5IHtudW1iZXJ9IE9OIC0gQWx3YXlzIGdlbmVyYXRlIG1pcG1hcHNcbiAqL1xuZXhwb3J0IGVudW0gTUlQTUFQX01PREVTIHtcbiAgICBPRkYsXG4gICAgUE9XMixcbiAgICBPTixcbn1cblxuLyoqXG4gKiBIb3cgdG8gdHJlYXQgdGV4dHVyZXMgd2l0aCBwcmVtdWx0aXBsaWVkIGFscGhhXG4gKlxuICogQG5hbWUgQUxQSEFfTU9ERVNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IE5PX1BSRU1VTFRJUExJRURfQUxQSEEgLSBTb3VyY2UgaXMgbm90IHByZW11bHRpcGxpZWQsIGxlYXZlIGl0IGxpa2UgdGhhdC5cbiAqICBPcHRpb24gZm9yIGNvbXByZXNzZWQgYW5kIGRhdGEgdGV4dHVyZXMgdGhhdCBhcmUgY3JlYXRlZCBmcm9tIHR5cGVkIGFycmF5cy5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBQUkVNVUxUSVBMWV9PTl9VUExPQUQgLSBTb3VyY2UgaXMgbm90IHByZW11bHRpcGxpZWQsIHByZW11bHRpcGx5IG9uIHVwbG9hZC5cbiAqICBEZWZhdWx0IG9wdGlvbiwgdXNlZCBmb3IgYWxsIGxvYWRlZCBpbWFnZXMuXG4gKiBAcHJvcGVydHkge251bWJlcn0gUFJFTVVMVElQTElFRF9BTFBIQSAtIFNvdXJjZSBpcyBhbHJlYWR5IHByZW11bHRpcGxpZWRcbiAqICBFeGFtcGxlOiBzcGluZSBhdGxhc2VzIHdpdGggYF9wbWFgIHN1ZmZpeC5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOUE0gLSBBbGlhcyBmb3IgTk9fUFJFTVVMVElQTElFRF9BTFBIQS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVTlBBQ0sgLSBEZWZhdWx0IG9wdGlvbiwgYWxpYXMgZm9yIFBSRU1VTFRJUExZX09OX1VQTE9BRC5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBQTUEgLSBBbGlhcyBmb3IgUFJFTVVMVElQTElFRF9BTFBIQS5cbiAqL1xuZXhwb3J0IGVudW0gQUxQSEFfTU9ERVMge1xuICAgIE5QTSA9IDAsXG4gICAgVU5QQUNLID0gMSxcbiAgICBQTUEgPSAyLFxuICAgIE5PX1BSRU1VTFRJUExJRURfQUxQSEEgPSAwLFxuICAgIFBSRU1VTFRJUExZX09OX1VQTE9BRCA9IDEsXG4gICAgUFJFTVVMVElQTFlfQUxQSEEgPSAyLFxufVxuXG4vKipcbiAqIEhvdyB0byBjbGVhciByZW5kZXJUZXh0dXJlcyBpbiBmaWx0ZXJcbiAqXG4gKiBAbmFtZSBDTEVBUl9NT0RFU1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gQkxFTkQgLSBQcmVzZXJ2ZSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHRleHR1cmUsIGJsZW5kIGFib3ZlXG4gKiBAcHJvcGVydHkge251bWJlcn0gQ0xFQVIgLSBNdXN0IHVzZSBgZ2wuY2xlYXJgIG9wZXJhdGlvblxuICogQHByb3BlcnR5IHtudW1iZXJ9IEJMSVQgLSBDbGVhciBvciBibGl0IGl0LCBkZXBlbmRzIG9uIGRldmljZSBhbmQgbGV2ZWwgb2YgcGFyYW5vaWFcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOTyAtIEFsaWFzIGZvciBCTEVORCwgc2FtZSBhcyBgZmFsc2VgIGluIGVhcmxpZXIgdmVyc2lvbnNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBZRVMgLSBBbGlhcyBmb3IgQ0xFQVIsIHNhbWUgYXMgYHRydWVgIGluIGVhcmxpZXIgdmVyc2lvbnNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBBVVRPIC0gQWxpYXMgZm9yIEJMSVRcbiAqL1xuZXhwb3J0IGVudW0gQ0xFQVJfTU9ERVMge1xuICAgIE5PID0gMCxcbiAgICBZRVMgPSAxLFxuICAgIEFVVE8gPSAyLFxuICAgIEJMRU5EID0gMCxcbiAgICBDTEVBUiA9IDEsXG4gICAgQkxJVCA9IDIsXG59XG5cbi8qKlxuICogVGhlIGdjIG1vZGVzIHRoYXQgYXJlIHN1cHBvcnRlZCBieSBwaXhpLlxuICpcbiAqIFRoZSB7QGxpbmsgUElYSS5zZXR0aW5ncy5HQ19NT0RFfSBHYXJiYWdlIENvbGxlY3Rpb24gbW9kZSBmb3IgUGl4aUpTIHRleHR1cmVzIGlzIEFVVE9cbiAqIElmIHNldCB0byBHQ19NT0RFLCB0aGUgcmVuZGVyZXIgd2lsbCBvY2Nhc2lvbmFsbHkgY2hlY2sgdGV4dHVyZXMgdXNhZ2UuIElmIHRoZXkgYXJlIG5vdFxuICogdXNlZCBmb3IgYSBzcGVjaWZpZWQgcGVyaW9kIG9mIHRpbWUgdGhleSB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgR1BVLiBUaGV5IHdpbGwgb2YgY291cnNlXG4gKiBiZSB1cGxvYWRlZCBhZ2FpbiB3aGVuIHRoZXkgYXJlIHJlcXVpcmVkLiBUaGlzIGlzIGEgc2lsZW50IGJlaGluZCB0aGUgc2NlbmVzIHByb2Nlc3MgdGhhdFxuICogc2hvdWxkIGVuc3VyZSB0aGF0IHRoZSBHUFUgZG9lcyBub3QgIGdldCBmaWxsZWQgdXAuXG4gKlxuICogSGFuZHkgZm9yIG1vYmlsZSBkZXZpY2VzIVxuICogVGhpcyBwcm9wZXJ0eSBvbmx5IGFmZmVjdHMgV2ViR0wuXG4gKlxuICogQG5hbWUgR0NfTU9ERVNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHByb3BlcnR5IHtudW1iZXJ9IEFVVE8gLSBHYXJiYWdlIGNvbGxlY3Rpb24gd2lsbCBoYXBwZW4gcGVyaW9kaWNhbGx5IGF1dG9tYXRpY2FsbHlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBNQU5VQUwgLSBHYXJiYWdlIGNvbGxlY3Rpb24gd2lsbCBuZWVkIHRvIGJlIGNhbGxlZCBtYW51YWxseVxuICovXG5leHBvcnQgZW51bSBHQ19NT0RFUyB7XG4gICAgQVVUTyxcbiAgICBNQU5VQUwsXG59XG5cbi8qKlxuICogQ29uc3RhbnRzIHRoYXQgc3BlY2lmeSBmbG9hdCBwcmVjaXNpb24gaW4gc2hhZGVycy5cbiAqXG4gKiBAbmFtZSBQUkVDSVNJT05cbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAY29uc3RhbnRcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKiBAcHJvcGVydHkge3N0cmluZ30gTE9XPSdsb3dwJ1xuICogQHByb3BlcnR5IHtzdHJpbmd9IE1FRElVTT0nbWVkaXVtcCdcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBISUdIPSdoaWdocCdcbiAqL1xuZXhwb3J0IGVudW0gUFJFQ0lTSU9OIHtcbiAgICBMT1cgPSAnbG93cCcsXG4gICAgTUVESVVNID0gJ21lZGl1bXAnLFxuICAgIEhJR0ggPSAnaGlnaHAnLFxufVxuXG4vKipcbiAqIENvbnN0YW50cyBmb3IgbWFzayBpbXBsZW1lbnRhdGlvbnMuXG4gKiBXZSB1c2UgYHR5cGVgIHN1ZmZpeCBiZWNhdXNlIGl0IGxlYWRzIHRvIHZlcnkgZGlmZmVyZW50IGJlaGF2aW91cnNcbiAqXG4gKiBAbmFtZSBNQVNLX1RZUEVTXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT05FIC0gTWFzayBpcyBpZ25vcmVkXG4gKiBAcHJvcGVydHkge251bWJlcn0gU0NJU1NPUiAtIFNjaXNzb3IgbWFzaywgcmVjdGFuZ2xlIG9uIHNjcmVlbiwgY2hlYXBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTVEVOQ0lMIC0gU3RlbmNpbCBtYXNrLCAxLWJpdCwgbWVkaXVtLCB3b3JrcyBvbmx5IGlmIHJlbmRlcmVyIHN1cHBvcnRzIHN0ZW5jaWxcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTUFJJVEUgLSBNYXNrIHRoYXQgdXNlcyBTcHJpdGVNYXNrRmlsdGVyLCB1c2VzIHRlbXBvcmFyeSBSZW5kZXJUZXh0dXJlXG4gKi9cbmV4cG9ydCBlbnVtIE1BU0tfVFlQRVMge1xuICAgIE5PTkUgPSAwLFxuICAgIFNDSVNTT1IgPSAxLFxuICAgIFNURU5DSUwgPSAyLFxuICAgIFNQUklURSA9IDMsXG59XG5cbi8qKlxuICogQ29uc3RhbnRzIGZvciBtdWx0aS1zYW1wbGluZyBhbnRpYWxpYXNpbmcuXG4gKlxuICogQHNlZSBQSVhJLkZyYW1lYnVmZmVyI211bHRpc2FtcGxlXG4gKlxuICogQG5hbWUgTVNBQV9RVUFMSVRZXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT05FIC0gTm8gbXVsdGlzYW1wbGluZyBmb3IgdGhpcyByZW5kZXJUZXh0dXJlXG4gKiBAcHJvcGVydHkge251bWJlcn0gTE9XIC0gVHJ5IDIgc2FtcGxlc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IE1FRElVTSAtIFRyeSA0IHNhbXBsZXNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBISUdIIC0gVHJ5IDggc2FtcGxlc1xuICovXG5leHBvcnQgZW51bSBNU0FBX1FVQUxJVFkge1xuICAgIE5PTkUgPSAwLFxuICAgIExPVyA9IDIsXG4gICAgTUVESVVNID0gNCxcbiAgICBISUdIID0gOFxufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuXG4vKipcbiAqIFRoZSBwcmVmaXggdGhhdCBkZW5vdGVzIGEgVVJMIGlzIGZvciBhIHJldGluYSBhc3NldC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBSRVRJTkFfUFJFRklYXG4gKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICogQHR5cGUge1JlZ0V4cH1cbiAqIEBkZWZhdWx0IC9AKFswLTlcXC5dKyl4L1xuICogQGV4YW1wbGUgYEAyeGBcbiAqL1xuc2V0dGluZ3MuUkVUSU5BX1BSRUZJWCA9IC9AKFswLTlcXC5dKyl4LztcblxuLyoqXG4gKiBTaG91bGQgdGhlIGBmYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0YCBmbGFnIGJlIGVuYWJsZWQgYXMgYSBjb250ZXh0IG9wdGlvbiB1c2VkIGluIHRoZSBgaXNXZWJHTFN1cHBvcnRlZGAgZnVuY3Rpb24uXG4gKiBGb3IgbW9zdCBzY2VuYXJpb3MgdGhpcyBzaG91bGQgYmUgbGVmdCBhcyB0cnVlLCBhcyBvdGhlcndpc2UgdGhlIHVzZXIgbWF5IGhhdmUgYSBwb29yIGV4cGVyaWVuY2UuXG4gKiBIb3dldmVyLCBpdCBjYW4gYmUgdXNlZnVsIHRvIGRpc2FibGUgdW5kZXIgY2VydGFpbiBzY2VuYXJpb3MsIHN1Y2ggYXMgaGVhZGxlc3MgdW5pdCB0ZXN0cy5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBGQUlMX0lGX01BSk9SX1BFUkZPUk1BTkNFX0NBVkVBVFxuICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAqIEB0eXBlIHtib29sZWFufVxuICogQGRlZmF1bHQgdHJ1ZVxuICovXG5zZXR0aW5ncy5GQUlMX0lGX01BSk9SX1BFUkZPUk1BTkNFX0NBVkVBVCA9IHRydWU7XG5cbmV4cG9ydCB7IHNldHRpbmdzIH07XG4iLCAibGV0IHNhaWRIZWxsbyA9IGZhbHNlO1xuY29uc3QgVkVSU0lPTiA9ICdfX1ZFUlNJT05fXyc7XG5cbi8qKlxuICogU2tpcHMgdGhlIGhlbGxvIG1lc3NhZ2Ugb2YgcmVuZGVyZXJzIHRoYXQgYXJlIGNyZWF0ZWQgYWZ0ZXIgdGhpcyBpcyBydW4uXG4gKlxuICogQGZ1bmN0aW9uIHNraXBIZWxsb1xuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNraXBIZWxsbygpOiB2b2lkXG57XG4gICAgc2FpZEhlbGxvID0gdHJ1ZTtcbn1cblxuLyoqXG4gKiBMb2dzIG91dCB0aGUgdmVyc2lvbiBhbmQgcmVuZGVyZXIgaW5mb3JtYXRpb24gZm9yIHRoaXMgcnVubmluZyBpbnN0YW5jZSBvZiBQSVhJLlxuICogSWYgeW91IGRvbid0IHdhbnQgdG8gc2VlIHRoaXMgbWVzc2FnZSB5b3UgY2FuIHJ1biBgUElYSS51dGlscy5za2lwSGVsbG8oKWAgYmVmb3JlXG4gKiBjcmVhdGluZyB5b3VyIHJlbmRlcmVyLiBLZWVwIGluIG1pbmQgdGhhdCBkb2luZyB0aGF0IHdpbGwgZm9yZXZlciBtYWtlIHlvdSBhIGplcmsgZmFjZS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAZnVuY3Rpb24gc2F5SGVsbG9cbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSBzdHJpbmcgcmVuZGVyZXIgdHlwZSB0byBsb2cuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYXlIZWxsbyh0eXBlOiBzdHJpbmcpOiB2b2lkXG57XG4gICAgaWYgKHNhaWRIZWxsbylcbiAgICB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2Nocm9tZScpID4gLTEpXG4gICAge1xuICAgICAgICBjb25zdCBhcmdzID0gW1xuICAgICAgICAgICAgYFxcbiAlYyAlYyAlYyBQaXhpSlMgJHtWRVJTSU9OfSAtIFx1MjczMCAke3R5cGV9IFx1MjczMCAgJWMgICVjICBodHRwOi8vd3d3LnBpeGlqcy5jb20vICAlYyAlYyBcdTI2NjUlY1x1MjY2NSVjXHUyNjY1IFxcblxcbmAsXG4gICAgICAgICAgICAnYmFja2dyb3VuZDogI2ZmNjZhNTsgcGFkZGluZzo1cHggMDsnLFxuICAgICAgICAgICAgJ2JhY2tncm91bmQ6ICNmZjY2YTU7IHBhZGRpbmc6NXB4IDA7JyxcbiAgICAgICAgICAgICdjb2xvcjogI2ZmNjZhNTsgYmFja2dyb3VuZDogIzAzMDMwNzsgcGFkZGluZzo1cHggMDsnLFxuICAgICAgICAgICAgJ2JhY2tncm91bmQ6ICNmZjY2YTU7IHBhZGRpbmc6NXB4IDA7JyxcbiAgICAgICAgICAgICdiYWNrZ3JvdW5kOiAjZmZjM2RjOyBwYWRkaW5nOjVweCAwOycsXG4gICAgICAgICAgICAnYmFja2dyb3VuZDogI2ZmNjZhNTsgcGFkZGluZzo1cHggMDsnLFxuICAgICAgICAgICAgJ2NvbG9yOiAjZmYyNDI0OyBiYWNrZ3JvdW5kOiAjZmZmOyBwYWRkaW5nOjVweCAwOycsXG4gICAgICAgICAgICAnY29sb3I6ICNmZjI0MjQ7IGJhY2tncm91bmQ6ICNmZmY7IHBhZGRpbmc6NXB4IDA7JyxcbiAgICAgICAgICAgICdjb2xvcjogI2ZmMjQyNDsgYmFja2dyb3VuZDogI2ZmZjsgcGFkZGluZzo1cHggMDsnLFxuICAgICAgICBdO1xuXG4gICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyguLi5hcmdzKTtcbiAgICB9XG4gICAgZWxzZSBpZiAod2luZG93LmNvbnNvbGUpXG4gICAge1xuICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coYFBpeGlKUyAke1ZFUlNJT059IC0gJHt0eXBlfSAtIGh0dHA6Ly93d3cucGl4aWpzLmNvbS9gKTtcbiAgICB9XG5cbiAgICBzYWlkSGVsbG8gPSB0cnVlO1xufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG5sZXQgc3VwcG9ydGVkOiBib29sZWFufHVuZGVmaW5lZDtcblxuLyoqXG4gKiBIZWxwZXIgZm9yIGNoZWNraW5nIGZvciBXZWJHTCBzdXBwb3J0LlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gaXNXZWJHTFN1cHBvcnRlZFxuICogQHJldHVybiB7Ym9vbGVhbn0gSXMgV2ViR0wgc3VwcG9ydGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNXZWJHTFN1cHBvcnRlZCgpOiBib29sZWFuXG57XG4gICAgaWYgKHR5cGVvZiBzdXBwb3J0ZWQgPT09ICd1bmRlZmluZWQnKVxuICAgIHtcbiAgICAgICAgc3VwcG9ydGVkID0gKGZ1bmN0aW9uIHN1cHBvcnRlZCgpOiBib29sZWFuXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHN0ZW5jaWw6IHRydWUsXG4gICAgICAgICAgICAgICAgZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDogc2V0dGluZ3MuRkFJTF9JRl9NQUpPUl9QRVJGT1JNQU5DRV9DQVZFQVQsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0cnlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoIXdpbmRvdy5XZWJHTFJlbmRlcmluZ0NvbnRleHQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgbGV0IGdsID0gKFxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnLCBjb250ZXh0T3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgfHwgY2FudmFzLmdldENvbnRleHQoJ2V4cGVyaW1lbnRhbC13ZWJnbCcsIGNvbnRleHRPcHRpb25zKVxuICAgICAgICAgICAgICAgICkgYXMgV2ViR0xSZW5kZXJpbmdDb250ZXh0O1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9ICEhKGdsICYmIGdsLmdldENvbnRleHRBdHRyaWJ1dGVzKCkuc3RlbmNpbCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2wpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsb3NlQ29udGV4dCA9IGdsLmdldEV4dGVuc2lvbignV0VCR0xfbG9zZV9jb250ZXh0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvc2VDb250ZXh0KVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3NlQ29udGV4dC5sb3NlQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZ2wgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1cHBvcnRlZDtcbn1cbiIsICIvKipcbiAqIENvbnZlcnRzIGEgaGV4YWRlY2ltYWwgY29sb3IgbnVtYmVyIHRvIGFuIFtSLCBHLCBCXSBhcnJheSBvZiBub3JtYWxpemVkIGZsb2F0cyAobnVtYmVycyBmcm9tIDAuMCB0byAxLjApLlxuICpcbiAqIEBleGFtcGxlXG4gKiBQSVhJLnV0aWxzLmhleDJyZ2IoMHhmZmZmZmYpOyAvLyByZXR1cm5zIFsxLCAxLCAxXVxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBoZXgycmdiXG4gKiBAcGFyYW0ge251bWJlcn0gaGV4IC0gVGhlIGhleGFkZWNpbWFsIG51bWJlciB0byBjb252ZXJ0XG4gKiBAcGFyYW0gIHtudW1iZXJbXX0gW291dD1bXV0gLSBJZiBzdXBwbGllZCwgdGhpcyBhcnJheSB3aWxsIGJlIHVzZWQgcmF0aGVyIHRoYW4gcmV0dXJuaW5nIGEgbmV3IG9uZVxuICogQHJldHVybiB7bnVtYmVyW119IEFuIGFycmF5IHJlcHJlc2VudGluZyB0aGUgW1IsIEcsIEJdIG9mIHRoZSBjb2xvciB3aGVyZSBhbGwgdmFsdWVzIGFyZSBmbG9hdHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoZXgycmdiKGhleDogbnVtYmVyLCBvdXQ6IEFycmF5PG51bWJlcj4gfCBGbG9hdDMyQXJyYXkgPSBbXSk6IEFycmF5PG51bWJlcj4gfCBGbG9hdDMyQXJyYXlcbntcbiAgICBvdXRbMF0gPSAoKGhleCA+PiAxNikgJiAweEZGKSAvIDI1NTtcbiAgICBvdXRbMV0gPSAoKGhleCA+PiA4KSAmIDB4RkYpIC8gMjU1O1xuICAgIG91dFsyXSA9IChoZXggJiAweEZGKSAvIDI1NTtcblxuICAgIHJldHVybiBvdXQ7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBoZXhhZGVjaW1hbCBjb2xvciBudW1iZXIgdG8gYSBzdHJpbmcuXG4gKlxuICogQGV4YW1wbGVcbiAqIFBJWEkudXRpbHMuaGV4MnN0cmluZygweGZmZmZmZik7IC8vIHJldHVybnMgXCIjZmZmZmZmXCJcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gaGV4MnN0cmluZ1xuICogQHBhcmFtIHtudW1iZXJ9IGhleCAtIE51bWJlciBpbiBoZXggKGUuZy4sIGAweGZmZmZmZmApXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBzdHJpbmcgY29sb3IgKGUuZy4sIGBcIiNmZmZmZmZcImApLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGV4MnN0cmluZyhoZXg6IG51bWJlcik6IHN0cmluZ1xue1xuICAgIGxldCBoZXhTdHJpbmcgPSBoZXgudG9TdHJpbmcoMTYpO1xuXG4gICAgaGV4U3RyaW5nID0gJzAwMDAwMCcuc3Vic3RyKDAsIDYgLSBoZXhTdHJpbmcubGVuZ3RoKSArIGhleFN0cmluZztcblxuICAgIHJldHVybiBgIyR7aGV4U3RyaW5nfWA7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBoZXhhZGVjaW1hbCBzdHJpbmcgdG8gYSBoZXhhZGVjaW1hbCBjb2xvciBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIFBJWEkudXRpbHMuc3RyaW5nMmhleChcIiNmZmZmZmZcIik7IC8vIHJldHVybnMgMHhmZmZmZmZcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gc3RyaW5nMmhleFxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyAtIFRoZSBzdHJpbmcgY29sb3IgKGUuZy4sIGBcIiNmZmZmZmZcImApXG4gKiBAcmV0dXJuIHtudW1iZXJ9IE51bWJlciBpbiBoZXhhZGVjaW1hbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZzJoZXgoc3RyaW5nOiBzdHJpbmcpOiBudW1iZXJcbntcbiAgICBpZiAodHlwZW9mIHN0cmluZyA9PT0gJ3N0cmluZycgJiYgc3RyaW5nWzBdID09PSAnIycpXG4gICAge1xuICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyKDEpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJzZUludChzdHJpbmcsIDE2KTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIGNvbG9yIGFzIGFuIFtSLCBHLCBCXSBhcnJheSBvZiBub3JtYWxpemVkIGZsb2F0cyB0byBhIGhleGFkZWNpbWFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogUElYSS51dGlscy5yZ2IyaGV4KFsxLCAxLCAxXSk7IC8vIHJldHVybnMgMHhmZmZmZmZcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gcmdiMmhleFxuICogQHBhcmFtIHtudW1iZXJbXX0gcmdiIC0gQXJyYXkgb2YgbnVtYmVycyB3aGVyZSBhbGwgdmFsdWVzIGFyZSBub3JtYWxpemVkIGZsb2F0cyBmcm9tIDAuMCB0byAxLjAuXG4gKiBAcmV0dXJuIHtudW1iZXJ9IE51bWJlciBpbiBoZXhhZGVjaW1hbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJnYjJoZXgocmdiOiBudW1iZXJbXSB8IEZsb2F0MzJBcnJheSk6IG51bWJlclxue1xuICAgIHJldHVybiAoKChyZ2JbMF0gKiAyNTUpIDw8IDE2KSArICgocmdiWzFdICogMjU1KSA8PCA4KSArIChyZ2JbMl0gKiAyNTUgfCAwKSk7XG59XG4iLCAiaW1wb3J0IHsgQkxFTkRfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG4vKipcbiAqIENvcnJlY3RzIFBpeGlKUyBibGVuZCwgdGFrZXMgcHJlbXVsdGlwbGllZCBhbHBoYSBpbnRvIGFjY291bnRcbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIG1hcFByZW11bHRpcGxpZWRCbGVuZE1vZGVzXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybiB7QXJyYXk8bnVtYmVyW10+fSBNYXBwZWQgbW9kZXMuXG4gKi9cbmZ1bmN0aW9uIG1hcFByZW11bHRpcGxpZWRCbGVuZE1vZGVzKCk6IG51bWJlcltdW11cbntcbiAgICBjb25zdCBwbSA9IFtdO1xuICAgIGNvbnN0IG5wbSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzMjsgaSsrKVxuICAgIHtcbiAgICAgICAgcG1baV0gPSBpO1xuICAgICAgICBucG1baV0gPSBpO1xuICAgIH1cblxuICAgIHBtW0JMRU5EX01PREVTLk5PUk1BTF9OUE1dID0gQkxFTkRfTU9ERVMuTk9STUFMO1xuICAgIHBtW0JMRU5EX01PREVTLkFERF9OUE1dID0gQkxFTkRfTU9ERVMuQUREO1xuICAgIHBtW0JMRU5EX01PREVTLlNDUkVFTl9OUE1dID0gQkxFTkRfTU9ERVMuU0NSRUVOO1xuXG4gICAgbnBtW0JMRU5EX01PREVTLk5PUk1BTF0gPSBCTEVORF9NT0RFUy5OT1JNQUxfTlBNO1xuICAgIG5wbVtCTEVORF9NT0RFUy5BRERdID0gQkxFTkRfTU9ERVMuQUREX05QTTtcbiAgICBucG1bQkxFTkRfTU9ERVMuU0NSRUVOXSA9IEJMRU5EX01PREVTLlNDUkVFTl9OUE07XG5cbiAgICBjb25zdCBhcnJheTogbnVtYmVyW11bXSA9IFtdO1xuXG4gICAgYXJyYXkucHVzaChucG0pO1xuICAgIGFycmF5LnB1c2gocG0pO1xuXG4gICAgcmV0dXJuIGFycmF5O1xufVxuXG4vKipcbiAqIG1hcHMgcHJlbXVsdGlwbHkgZmxhZyBhbmQgYmxlbmRNb2RlIHRvIGFkanVzdGVkIGJsZW5kTW9kZVxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBjb25zdCBwcmVtdWx0aXBseUJsZW5kTW9kZVxuICogQHR5cGUge0FycmF5PG51bWJlcltdPn1cbiAqL1xuZXhwb3J0IGNvbnN0IHByZW11bHRpcGx5QmxlbmRNb2RlID0gbWFwUHJlbXVsdGlwbGllZEJsZW5kTW9kZXMoKTtcblxuLyoqXG4gKiBjaGFuZ2VzIGJsZW5kTW9kZSBhY2NvcmRpbmcgdG8gdGV4dHVyZSBmb3JtYXRcbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIGNvcnJlY3RCbGVuZE1vZGVcbiAqIEBwYXJhbSB7bnVtYmVyfSBibGVuZE1vZGUgLSBzdXBwb3NlZCBibGVuZCBtb2RlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHByZW11bHRpcGxpZWQgLSB3aGV0aGVyIHNvdXJjZSBpcyBwcmVtdWx0aXBsaWVkXG4gKiBAcmV0dXJucyB7bnVtYmVyfSB0cnVlIGJsZW5kIG1vZGUgZm9yIHRoaXMgdGV4dHVyZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY29ycmVjdEJsZW5kTW9kZShibGVuZE1vZGU6IG51bWJlciwgcHJlbXVsdGlwbGllZDogYm9vbGVhbik6IG51bWJlclxue1xuICAgIHJldHVybiBwcmVtdWx0aXBseUJsZW5kTW9kZVtwcmVtdWx0aXBsaWVkID8gMSA6IDBdW2JsZW5kTW9kZV07XG59XG5cbi8qKlxuICogY29tYmluZXMgcmdiIGFuZCBhbHBoYSB0byBvdXQgYXJyYXlcbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIHByZW11bHRpcGx5UmdiYVxuICogQHBhcmFtIHtGbG9hdDMyQXJyYXl8bnVtYmVyW119IHJnYiAtIGlucHV0IHJnYlxuICogQHBhcmFtIHtudW1iZXJ9IGFscGhhIC0gYWxwaGEgcGFyYW1cbiAqIEBwYXJhbSB7RmxvYXQzMkFycmF5fSBbb3V0XSAtIG91dHB1dFxuICogQHBhcmFtIHtib29sZWFufSBbcHJlbXVsdGlwbHk9dHJ1ZV0gLSBkbyBwcmVtdWx0aXBseSBpdFxuICogQHJldHVybnMge0Zsb2F0MzJBcnJheX0gdmVjNCByZ2JhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcmVtdWx0aXBseVJnYmEoXG4gICAgcmdiOiBGbG9hdDMyQXJyYXl8bnVtYmVyW10sXG4gICAgYWxwaGE6IG51bWJlcixcbiAgICBvdXQ6IEZsb2F0MzJBcnJheSxcbiAgICBwcmVtdWx0aXBseTogYm9vbGVhblxuKTogRmxvYXQzMkFycmF5XG57XG4gICAgb3V0ID0gb3V0IHx8IG5ldyBGbG9hdDMyQXJyYXkoNCk7XG4gICAgaWYgKHByZW11bHRpcGx5IHx8IHByZW11bHRpcGx5ID09PSB1bmRlZmluZWQpXG4gICAge1xuICAgICAgICBvdXRbMF0gPSByZ2JbMF0gKiBhbHBoYTtcbiAgICAgICAgb3V0WzFdID0gcmdiWzFdICogYWxwaGE7XG4gICAgICAgIG91dFsyXSA9IHJnYlsyXSAqIGFscGhhO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBvdXRbMF0gPSByZ2JbMF07XG4gICAgICAgIG91dFsxXSA9IHJnYlsxXTtcbiAgICAgICAgb3V0WzJdID0gcmdiWzJdO1xuICAgIH1cbiAgICBvdXRbM10gPSBhbHBoYTtcblxuICAgIHJldHVybiBvdXQ7XG59XG5cbi8qKlxuICogcHJlbXVsdGlwbGllcyB0aW50XG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBwcmVtdWx0aXBseVRpbnRcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW50IC0gaW50ZWdlciBSR0JcbiAqIEBwYXJhbSB7bnVtYmVyfSBhbHBoYSAtIGZsb2F0aW5nIHBvaW50IGFscGhhICgwLjAtMS4wKVxuICogQHJldHVybnMge251bWJlcn0gdGludCBtdWx0aXBsaWVkIGJ5IGFscGhhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcmVtdWx0aXBseVRpbnQodGludDogbnVtYmVyLCBhbHBoYTogbnVtYmVyKTogbnVtYmVyXG57XG4gICAgaWYgKGFscGhhID09PSAxLjApXG4gICAge1xuICAgICAgICByZXR1cm4gKGFscGhhICogMjU1IDw8IDI0KSArIHRpbnQ7XG4gICAgfVxuICAgIGlmIChhbHBoYSA9PT0gMC4wKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGxldCBSID0gKCh0aW50ID4+IDE2KSAmIDB4RkYpO1xuICAgIGxldCBHID0gKCh0aW50ID4+IDgpICYgMHhGRik7XG4gICAgbGV0IEIgPSAodGludCAmIDB4RkYpO1xuXG4gICAgUiA9ICgoUiAqIGFscGhhKSArIDAuNSkgfCAwO1xuICAgIEcgPSAoKEcgKiBhbHBoYSkgKyAwLjUpIHwgMDtcbiAgICBCID0gKChCICogYWxwaGEpICsgMC41KSB8IDA7XG5cbiAgICByZXR1cm4gKGFscGhhICogMjU1IDw8IDI0KSArIChSIDw8IDE2KSArIChHIDw8IDgpICsgQjtcbn1cblxuLyoqXG4gKiBjb252ZXJ0cyBpbnRlZ2VyIHRpbnQgYW5kIGZsb2F0IGFscGhhIHRvIHZlYzQgZm9ybSwgcHJlbXVsdGlwbGllcyBieSBkZWZhdWx0XG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBwcmVtdWx0aXBseVRpbnRUb1JnYmFcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW50IC0gaW5wdXQgdGludFxuICogQHBhcmFtIHtudW1iZXJ9IGFscGhhIC0gYWxwaGEgcGFyYW1cbiAqIEBwYXJhbSB7RmxvYXQzMkFycmF5fSBbb3V0XSBvdXRwdXRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3ByZW11bHRpcGx5PXRydWVdIC0gZG8gcHJlbXVsdGlwbHkgaXRcbiAqIEByZXR1cm5zIHtGbG9hdDMyQXJyYXl9IHZlYzQgcmdiYVxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJlbXVsdGlwbHlUaW50VG9SZ2JhKHRpbnQ6IG51bWJlciwgYWxwaGE6IG51bWJlciwgb3V0OiBGbG9hdDMyQXJyYXksIHByZW11bHRpcGx5OiBib29sZWFuKTogRmxvYXQzMkFycmF5XG57XG4gICAgb3V0ID0gb3V0IHx8IG5ldyBGbG9hdDMyQXJyYXkoNCk7XG4gICAgb3V0WzBdID0gKCh0aW50ID4+IDE2KSAmIDB4RkYpIC8gMjU1LjA7XG4gICAgb3V0WzFdID0gKCh0aW50ID4+IDgpICYgMHhGRikgLyAyNTUuMDtcbiAgICBvdXRbMl0gPSAodGludCAmIDB4RkYpIC8gMjU1LjA7XG4gICAgaWYgKHByZW11bHRpcGx5IHx8IHByZW11bHRpcGx5ID09PSB1bmRlZmluZWQpXG4gICAge1xuICAgICAgICBvdXRbMF0gKj0gYWxwaGE7XG4gICAgICAgIG91dFsxXSAqPSBhbHBoYTtcbiAgICAgICAgb3V0WzJdICo9IGFscGhhO1xuICAgIH1cbiAgICBvdXRbM10gPSBhbHBoYTtcblxuICAgIHJldHVybiBvdXQ7XG59XG4iLCAiLyoqXG4gKiBHZW5lcmljIE1hc2sgU3RhY2sgZGF0YSBzdHJ1Y3R1cmVcbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIGNyZWF0ZUluZGljZXNGb3JRdWFkc1xuICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBOdW1iZXIgb2YgcXVhZHNcbiAqIEBwYXJhbSB7VWludDE2QXJyYXl8VWludDMyQXJyYXl9IFtvdXRCdWZmZXJdIC0gQnVmZmVyIGZvciBvdXRwdXQsIGxlbmd0aCBoYXMgdG8gYmUgYDYgKiBzaXplYFxuICogQHJldHVybiB7VWludDE2QXJyYXl8VWludDMyQXJyYXl9IC0gUmVzdWx0aW5nIGluZGV4IGJ1ZmZlclxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW5kaWNlc0ZvclF1YWRzKHNpemU6IG51bWJlciwgb3V0QnVmZmVyOiBVaW50MTZBcnJheXxVaW50MzJBcnJheSA9IG51bGwpOiBVaW50MTZBcnJheXxVaW50MzJBcnJheVxue1xuICAgIC8vIHRoZSB0b3RhbCBudW1iZXIgb2YgaW5kaWNlcyBpbiBvdXIgYXJyYXksIHRoZXJlIGFyZSA2IHBvaW50cyBwZXIgcXVhZC5cbiAgICBjb25zdCB0b3RhbEluZGljZXMgPSBzaXplICogNjtcblxuICAgIG91dEJ1ZmZlciA9IG91dEJ1ZmZlciB8fCBuZXcgVWludDE2QXJyYXkodG90YWxJbmRpY2VzKTtcblxuICAgIGlmIChvdXRCdWZmZXIubGVuZ3RoICE9PSB0b3RhbEluZGljZXMpXG4gICAge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE91dCBidWZmZXIgbGVuZ3RoIGlzIGluY29ycmVjdCwgZ290ICR7b3V0QnVmZmVyLmxlbmd0aH0gYW5kIGV4cGVjdGVkICR7dG90YWxJbmRpY2VzfWApO1xuICAgIH1cblxuICAgIC8vIGZpbGwgdGhlIGluZGljZXMgd2l0aCB0aGUgcXVhZHMgdG8gZHJhd1xuICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHRvdGFsSW5kaWNlczsgaSArPSA2LCBqICs9IDQpXG4gICAge1xuICAgICAgICBvdXRCdWZmZXJbaSArIDBdID0gaiArIDA7XG4gICAgICAgIG91dEJ1ZmZlcltpICsgMV0gPSBqICsgMTtcbiAgICAgICAgb3V0QnVmZmVyW2kgKyAyXSA9IGogKyAyO1xuICAgICAgICBvdXRCdWZmZXJbaSArIDNdID0gaiArIDA7XG4gICAgICAgIG91dEJ1ZmZlcltpICsgNF0gPSBqICsgMjtcbiAgICAgICAgb3V0QnVmZmVyW2kgKyA1XSA9IGogKyAzO1xuICAgIH1cblxuICAgIHJldHVybiBvdXRCdWZmZXI7XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBJVHlwZWRBcnJheSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QnVmZmVyVHlwZShhcnJheTogSVR5cGVkQXJyYXkpOiAnRmxvYXQzMkFycmF5J3wnVWludDMyQXJyYXknfCdJbnQzMkFycmF5J3wnVWludDE2QXJyYXknfCdVaW50OEFycmF5J3xudWxsXG57XG4gICAgaWYgKGFycmF5LkJZVEVTX1BFUl9FTEVNRU5UID09PSA0KVxuICAgIHtcbiAgICAgICAgaWYgKGFycmF5IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gJ0Zsb2F0MzJBcnJheSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJyYXkgaW5zdGFuY2VvZiBVaW50MzJBcnJheSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICdVaW50MzJBcnJheSc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJ0ludDMyQXJyYXknO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnJheS5CWVRFU19QRVJfRUxFTUVOVCA9PT0gMilcbiAgICB7XG4gICAgICAgIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQxNkFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gJ1VpbnQxNkFycmF5JztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcnJheS5CWVRFU19QRVJfRUxFTUVOVCA9PT0gMSlcbiAgICB7XG4gICAgICAgIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAnVWludDhBcnJheSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIG1hcCBvdXQgdGhlIHJlc3Qgb2YgdGhlIGFycmF5IGVsZW1lbnRzIVxuICAgIHJldHVybiBudWxsO1xufVxuIiwgImltcG9ydCB7IGdldEJ1ZmZlclR5cGUgfSBmcm9tICcuL2dldEJ1ZmZlclR5cGUnO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBvYmplY3Qtc2hvcnRoYW5kICovXG5jb25zdCBtYXAgPSB7IEZsb2F0MzJBcnJheTogRmxvYXQzMkFycmF5LCBVaW50MzJBcnJheTogVWludDMyQXJyYXksIEludDMyQXJyYXk6IEludDMyQXJyYXksIFVpbnQ4QXJyYXk6IFVpbnQ4QXJyYXkgfTtcblxudHlwZSBQYWNrZWRBcnJheSA9IEZsb2F0MzJBcnJheXxVaW50MzJBcnJheXxJbnQzMkFycmF5fFVpbnQ4QXJyYXk7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcmxlYXZlVHlwZWRBcnJheXMoYXJyYXlzOiBQYWNrZWRBcnJheVtdLCBzaXplczogbnVtYmVyW10pOiBGbG9hdDMyQXJyYXlcbntcbiAgICBsZXQgb3V0U2l6ZSA9IDA7XG4gICAgbGV0IHN0cmlkZSA9IDA7XG4gICAgY29uc3Qgdmlld3M6IHtba2V5OiBzdHJpbmddOiBQYWNrZWRBcnJheX0gPSB7fTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlzLmxlbmd0aDsgaSsrKVxuICAgIHtcbiAgICAgICAgc3RyaWRlICs9IHNpemVzW2ldO1xuICAgICAgICBvdXRTaXplICs9IGFycmF5c1tpXS5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc3QgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKG91dFNpemUgKiA0KTtcblxuICAgIGxldCBvdXQgPSBudWxsO1xuICAgIGxldCBsaXR0bGVPZmZzZXQgPSAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspXG4gICAge1xuICAgICAgICBjb25zdCBzaXplID0gc2l6ZXNbaV07XG4gICAgICAgIGNvbnN0IGFycmF5ID0gYXJyYXlzW2ldO1xuXG4gICAgICAgIC8qXG4gICAgICAgIEB0b2RvIFRoaXMgaXMgdW5zYWZlIGNhc3RpbmcgYnV0IGNvbnNpc3RlbnQgd2l0aCBob3cgdGhlIGNvZGUgd29ya2VkIHByZXZpb3VzbHkuIFNob3VsZCBpdCBzdGF5IHRoaXMgd2F5XG4gICAgICAgICAgICAgIG9yIHNob3VsZCBhbmQgYGdldEJ1ZmZlclR5cGVVbnNhZmVgIGZ1bmN0aW9uIGJlIGV4cG9zZWQgdGhhdCB0aHJvd3MgYW4gRXJyb3IgaWYgdW5zdXBwb3J0ZWQgdHlwZSBpcyBwYXNzZWQ/XG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0QnVmZmVyVHlwZShhcnJheSkgYXMga2V5b2YgdHlwZW9mIG1hcDtcblxuICAgICAgICBpZiAoIXZpZXdzW3R5cGVdKVxuICAgICAgICB7XG4gICAgICAgICAgICB2aWV3c1t0eXBlXSA9IG5ldyBtYXBbdHlwZV0oYnVmZmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG91dCA9IHZpZXdzW3R5cGVdO1xuXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXJyYXkubGVuZ3RoOyBqKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4U3RhcnQgPSAoKGogLyBzaXplIHwgMCkgKiBzdHJpZGUpICsgbGl0dGxlT2Zmc2V0O1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBqICUgc2l6ZTtcblxuICAgICAgICAgICAgb3V0W2luZGV4U3RhcnQgKyBpbmRleF0gPSBhcnJheVtqXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxpdHRsZU9mZnNldCArPSBzaXplO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KGJ1ZmZlcik7XG59XG4iLCAiLy8gVGFrZW4gZnJvbSB0aGUgYml0LXR3aWRkbGUgcGFja2FnZVxuXG4vKipcbiAqIFJvdW5kcyB0byBuZXh0IHBvd2VyIG9mIHR3by5cbiAqXG4gKiBAZnVuY3Rpb24gbmV4dFBvdzJcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAcGFyYW0ge251bWJlcn0gdiAtIGlucHV0IHZhbHVlXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBuZXh0UG93Mih2OiBudW1iZXIpOiBudW1iZXJcbntcbiAgICB2ICs9IHYgPT09IDAgPyAxIDogMDtcbiAgICAtLXY7XG4gICAgdiB8PSB2ID4+PiAxO1xuICAgIHYgfD0gdiA+Pj4gMjtcbiAgICB2IHw9IHYgPj4+IDQ7XG4gICAgdiB8PSB2ID4+PiA4O1xuICAgIHYgfD0gdiA+Pj4gMTY7XG5cbiAgICByZXR1cm4gdiArIDE7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGEgbnVtYmVyIGlzIGEgcG93ZXIgb2YgdHdvLlxuICpcbiAqIEBmdW5jdGlvbiBpc1BvdzJcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAcGFyYW0ge251bWJlcn0gdiAtIGlucHV0IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgdmFsdWUgaXMgcG93ZXIgb2YgdHdvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1BvdzIodjogbnVtYmVyKTogYm9vbGVhblxue1xuICAgIHJldHVybiAhKHYgJiAodiAtIDEpKSAmJiAoISF2KTtcbn1cblxuLyoqXG4gKiBDb21wdXRlcyBjZWlsIG9mIGxvZyBiYXNlIDJcbiAqXG4gKiBAZnVuY3Rpb24gbG9nMlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBwYXJhbSB7bnVtYmVyfSB2IC0gaW5wdXQgdmFsdWVcbiAqIEByZXR1cm4ge251bWJlcn0gbG9nYXJpdGhtIGJhc2UgMlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9nMih2OiBudW1iZXIpOiBudW1iZXJcbntcbiAgICBsZXQgciA9ICh2ID4gMHhGRkZGID8gMSA6IDApIDw8IDQ7XG5cbiAgICB2ID4+Pj0gcjtcblxuICAgIGxldCBzaGlmdCA9ICh2ID4gMHhGRiA/IDEgOiAwKSA8PCAzO1xuXG4gICAgdiA+Pj49IHNoaWZ0OyByIHw9IHNoaWZ0O1xuICAgIHNoaWZ0ID0gKHYgPiAweEYgPyAxIDogMCkgPDwgMjtcbiAgICB2ID4+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7XG4gICAgc2hpZnQgPSAodiA+IDB4MyA/IDEgOiAwKSA8PCAxO1xuICAgIHYgPj4+PSBzaGlmdDsgciB8PSBzaGlmdDtcblxuICAgIHJldHVybiByIHwgKHYgPj4gMSk7XG59XG4iLCAiLyoqXG4gKiBSZW1vdmUgaXRlbXMgZnJvbSBhIGphdmFzY3JpcHQgYXJyYXkgd2l0aG91dCBnZW5lcmF0aW5nIGdhcmJhZ2VcbiAqXG4gKiBAZnVuY3Rpb24gcmVtb3ZlSXRlbXNcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAcGFyYW0ge0FycmF5PGFueT59IGFyciAtIEFycmF5IHRvIHJlbW92ZSBlbGVtZW50cyBmcm9tXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRJZHggLSBzdGFydGluZyBpbmRleFxuICogQHBhcmFtIHtudW1iZXJ9IHJlbW92ZUNvdW50IC0gaG93IG1hbnkgdG8gcmVtb3ZlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVJdGVtcyhhcnI6IGFueVtdLCBzdGFydElkeDogbnVtYmVyLCByZW1vdmVDb3VudDogbnVtYmVyKTogdm9pZFxue1xuICAgIGNvbnN0IGxlbmd0aCA9IGFyci5sZW5ndGg7XG4gICAgbGV0IGk7XG5cbiAgICBpZiAoc3RhcnRJZHggPj0gbGVuZ3RoIHx8IHJlbW92ZUNvdW50ID09PSAwKVxuICAgIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJlbW92ZUNvdW50ID0gKHN0YXJ0SWR4ICsgcmVtb3ZlQ291bnQgPiBsZW5ndGggPyBsZW5ndGggLSBzdGFydElkeCA6IHJlbW92ZUNvdW50KTtcblxuICAgIGNvbnN0IGxlbiA9IGxlbmd0aCAtIHJlbW92ZUNvdW50O1xuXG4gICAgZm9yIChpID0gc3RhcnRJZHg7IGkgPCBsZW47ICsraSlcbiAgICB7XG4gICAgICAgIGFycltpXSA9IGFycltpICsgcmVtb3ZlQ291bnRdO1xuICAgIH1cblxuICAgIGFyci5sZW5ndGggPSBsZW47XG59XG4iLCAiLyoqXG4gKiBSZXR1cm5zIHNpZ24gb2YgbnVtYmVyXG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBzaWduXG4gKiBAcGFyYW0ge251bWJlcn0gbiAtIHRoZSBudW1iZXIgdG8gY2hlY2sgdGhlIHNpZ24gb2ZcbiAqIEByZXR1cm5zIHtudW1iZXJ9IDAgaWYgYG5gIGlzIDAsIC0xIGlmIGBuYCBpcyBuZWdhdGl2ZSwgMSBpZiBgbmAgaXMgcG9zaXRpdmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpZ24objogbnVtYmVyKTogLTF8MHwxXG57XG4gICAgaWYgKG4gPT09IDApIHJldHVybiAwO1xuXG4gICAgcmV0dXJuIG4gPCAwID8gLTEgOiAxO1xufVxuIiwgImxldCBuZXh0VWlkID0gMDtcblxuLyoqXG4gKiBHZXRzIHRoZSBuZXh0IHVuaXF1ZSBpZGVudGlmaWVyXG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiB1aWRcbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIG5leHQgdW5pcXVlIGlkZW50aWZpZXIgdG8gdXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdWlkKCk6IG51bWJlclxue1xuICAgIHJldHVybiArK25leHRVaWQ7XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vLyBBIG1hcCBvZiB3YXJuaW5nIG1lc3NhZ2VzIGFscmVhZHkgZmlyZWRcbmNvbnN0IHdhcm5pbmdzOiBEaWN0PGJvb2xlYW4+ID0ge307XG5cbi8qKlxuICogSGVscGVyIGZvciB3YXJuaW5nIGRldmVsb3BlcnMgYWJvdXQgZGVwcmVjYXRlZCBmZWF0dXJlcyAmIHNldHRpbmdzLlxuICogQSBzdGFjayB0cmFjayBmb3Igd2FybmluZ3MgaXMgZ2l2ZW47IHVzZWZ1bCBmb3IgdHJhY2tpbmctZG93biB3aGVyZVxuICogZGVwcmVjYXRlZCBtZXRob2RzL3Byb3BlcnRpZXMvY2xhc3NlcyBhcmUgYmVpbmcgdXNlZCB3aXRoaW4gdGhlIGNvZGUuXG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBkZXByZWNhdGlvblxuICogQHBhcmFtIHtzdHJpbmd9IHZlcnNpb24gLSBUaGUgdmVyc2lvbiB3aGVyZSB0aGUgZmVhdHVyZSBiZWNhbWUgZGVwcmVjYXRlZFxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSBNZXNzYWdlIHNob3VsZCBpbmNsdWRlIHdoYXQgaXMgZGVwcmVjYXRlZCwgd2hlcmUsIGFuZCB0aGUgbmV3IHNvbHV0aW9uXG4gKiBAcGFyYW0ge251bWJlcn0gW2lnbm9yZURlcHRoPTNdIC0gVGhlIG51bWJlciBvZiBzdGVwcyB0byBpZ25vcmUgYXQgdGhlIHRvcCBvZiB0aGUgZXJyb3Igc3RhY2tcbiAqICAgICAgICB0aGlzIGlzIG1vc3RseSB0byBpZ25vcmUgaW50ZXJuYWwgZGVwcmVjYXRpb24gY2FsbHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXByZWNhdGlvbih2ZXJzaW9uOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgaWdub3JlRGVwdGggPSAzKTogdm9pZFxue1xuICAgIC8vIElnbm9yZSBkdXBsaWNhdFxuICAgIGlmICh3YXJuaW5nc1ttZXNzYWdlXSlcbiAgICB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zb2xlICovXG4gICAgbGV0IHN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7XG5cbiAgICAvLyBIYW5kbGUgSUUgPCAxMCBhbmQgU2FmYXJpIDwgNlxuICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09ICd1bmRlZmluZWQnKVxuICAgIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdQaXhpSlMgRGVwcmVjYXRpb24gV2FybmluZzogJywgYCR7bWVzc2FnZX1cXG5EZXByZWNhdGVkIHNpbmNlIHYke3ZlcnNpb259YCk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIC8vIGNob3Agb2ZmIHRoZSBzdGFjayB0cmFjZSB3aGljaCBpbmNsdWRlcyBQaXhpSlMgaW50ZXJuYWwgY2FsbHNcbiAgICAgICAgc3RhY2sgPSBzdGFjay5zcGxpdCgnXFxuJykuc3BsaWNlKGlnbm9yZURlcHRoKS5qb2luKCdcXG4nKTtcblxuICAgICAgICBpZiAoY29uc29sZS5ncm91cENvbGxhcHNlZClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS5ncm91cENvbGxhcHNlZChcbiAgICAgICAgICAgICAgICAnJWNQaXhpSlMgRGVwcmVjYXRpb24gV2FybmluZzogJWMlcycsXG4gICAgICAgICAgICAgICAgJ2NvbG9yOiM2MTQxMDg7YmFja2dyb3VuZDojZmZmYmU2JyxcbiAgICAgICAgICAgICAgICAnZm9udC13ZWlnaHQ6bm9ybWFsO2NvbG9yOiM2MTQxMDg7YmFja2dyb3VuZDojZmZmYmU2JyxcbiAgICAgICAgICAgICAgICBgJHttZXNzYWdlfVxcbkRlcHJlY2F0ZWQgc2luY2UgdiR7dmVyc2lvbn1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKHN0YWNrKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignUGl4aUpTIERlcHJlY2F0aW9uIFdhcm5pbmc6ICcsIGAke21lc3NhZ2V9XFxuRGVwcmVjYXRlZCBzaW5jZSB2JHt2ZXJzaW9ufWApO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKHN0YWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWNvbnNvbGUgKi9cblxuICAgIHdhcm5pbmdzW21lc3NhZ2VdID0gdHJ1ZTtcbn1cbiIsICJpbXBvcnQgdHlwZSB7IFByb2dyYW0sIFRleHR1cmUsIEJhc2VUZXh0dXJlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5cbi8qKlxuICogQHRvZG8gRGVzY3JpYmUgcHJvcGVydHkgdXNhZ2VcbiAqXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBQcm9ncmFtQ2FjaGVcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5leHBvcnQgY29uc3QgUHJvZ3JhbUNhY2hlOiB7W2tleTogc3RyaW5nXTogUHJvZ3JhbX0gPSB7fTtcblxuLyoqXG4gKiBAdG9kbyBEZXNjcmliZSBwcm9wZXJ0eSB1c2FnZVxuICpcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIFRleHR1cmVDYWNoZVxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbmV4cG9ydCBjb25zdCBUZXh0dXJlQ2FjaGU6IHtba2V5OiBzdHJpbmddOiBUZXh0dXJlfSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbi8qKlxuICogQHRvZG8gRGVzY3JpYmUgcHJvcGVydHkgdXNhZ2VcbiAqXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBCYXNlVGV4dHVyZUNhY2hlXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQHR5cGUge09iamVjdH1cbiAqL1xuZXhwb3J0IGNvbnN0IEJhc2VUZXh0dXJlQ2FjaGU6IHtba2V5OiBzdHJpbmddOiBCYXNlVGV4dHVyZX0gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4vKipcbiAqIERlc3Ryb3lzIGFsbCB0ZXh0dXJlIGluIHRoZSBjYWNoZVxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gZGVzdHJveVRleHR1cmVDYWNoZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveVRleHR1cmVDYWNoZSgpOiB2b2lkXG57XG4gICAgbGV0IGtleTtcblxuICAgIGZvciAoa2V5IGluIFRleHR1cmVDYWNoZSlcbiAgICB7XG4gICAgICAgIFRleHR1cmVDYWNoZVtrZXldLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgZm9yIChrZXkgaW4gQmFzZVRleHR1cmVDYWNoZSlcbiAgICB7XG4gICAgICAgIEJhc2VUZXh0dXJlQ2FjaGVba2V5XS5kZXN0cm95KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIHRleHR1cmVzIGZyb20gY2FjaGUsIGJ1dCBkb2VzIG5vdCBkZXN0cm95IHRoZW1cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIGNsZWFyVGV4dHVyZUNhY2hlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRleHR1cmVDYWNoZSgpOiB2b2lkXG57XG4gICAgbGV0IGtleTtcblxuICAgIGZvciAoa2V5IGluIFRleHR1cmVDYWNoZSlcbiAgICB7XG4gICAgICAgIGRlbGV0ZSBUZXh0dXJlQ2FjaGVba2V5XTtcbiAgICB9XG4gICAgZm9yIChrZXkgaW4gQmFzZVRleHR1cmVDYWNoZSlcbiAgICB7XG4gICAgICAgIGRlbGV0ZSBCYXNlVGV4dHVyZUNhY2hlW2tleV07XG4gICAgfVxufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBDYW52YXMgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gc2l6ZSB0byBiZSB1c2VkIGFzIGEgdGFyZ2V0IGZvciByZW5kZXJpbmcgdG8uXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICovXG5leHBvcnQgY2xhc3MgQ2FudmFzUmVuZGVyVGFyZ2V0XG57XG4gICAgcHVibGljIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG5cbiAgICBwdWJsaWMgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuXG4gICAgcHVibGljIHJlc29sdXRpb246IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCAtIHRoZSB3aWR0aCBmb3IgdGhlIG5ld2x5IGNyZWF0ZWQgY2FudmFzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodCAtIHRoZSBoZWlnaHQgZm9yIHRoZSBuZXdseSBjcmVhdGVkIGNhbnZhc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmVzb2x1dGlvbj0xXSAtIFRoZSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIHRoZSBjYW52YXNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgcmVzb2x1dGlvbjogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBDYW52YXMgb2JqZWN0IHRoYXQgYmVsb25ncyB0byB0aGlzIENhbnZhc1JlbmRlclRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7SFRNTENhbnZhc0VsZW1lbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCBvYmplY3QgcmVwcmVzZW50aW5nIGEgdHdvLWRpbWVuc2lvbmFsIHJlbmRlcmluZyBjb250ZXh0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgIHRoaXMucmVzb2x1dGlvbiA9IHJlc29sdXRpb24gfHwgc2V0dGluZ3MuUkVTT0xVVElPTjtcblxuICAgICAgICB0aGlzLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgdGhlIGNhbnZhcyB0aGF0IHdhcyBjcmVhdGVkIGJ5IHRoZSBDYW52YXNSZW5kZXJUYXJnZXQgY2xhc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNsZWFyKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuY29udGV4dC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzaXplcyB0aGUgY2FudmFzIHRvIHRoZSBzcGVjaWZpZWQgd2lkdGggYW5kIGhlaWdodC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCAtIHRoZSBuZXcgd2lkdGggb2YgdGhlIGNhbnZhc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSB0aGUgbmV3IGhlaWdodCBvZiB0aGUgY2FudmFzXG4gICAgICovXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aWR0aCAqIHRoaXMucmVzb2x1dGlvbjtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gaGVpZ2h0ICogdGhpcy5yZXNvbHV0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgY2FudmFzLlxuICAgICAqXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBudWxsO1xuICAgICAgICB0aGlzLmNhbnZhcyA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHdpZHRoIG9mIHRoZSBjYW52YXMgYnVmZmVyIGluIHBpeGVscy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgd2lkdGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5jYW52YXMud2lkdGg7XG4gICAgfVxuXG4gICAgc2V0IHdpZHRoKHZhbDogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB2YWw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgY2FudmFzIGJ1ZmZlciBpbiBwaXhlbHMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGhlaWdodCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgc2V0IGhlaWdodCh2YWw6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHZhbDtcbiAgICB9XG59XG4iLCAiaW50ZXJmYWNlIEluc2V0IHtcbiAgICB0b3A/OiBudW1iZXI7XG4gICAgbGVmdD86IG51bWJlcjtcbiAgICByaWdodD86IG51bWJlcjtcbiAgICBib3R0b20/OiBudW1iZXI7XG59XG5cbi8qKlxuICogVHJpbSB0cmFuc3BhcmVudCBib3JkZXJzIGZyb20gYSBjYW52YXNcbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIHRyaW1DYW52YXNcbiAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IGNhbnZhcyAtIHRoZSBjYW52YXMgdG8gdHJpbVxuICogQHJldHVybnMge29iamVjdH0gVHJpbSBkYXRhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmltQ2FudmFzKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpOiB7d2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXI7IGRhdGE/OiBJbWFnZURhdGF9XG57XG4gICAgLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vcmVteS83ODQ1MDhcblxuICAgIGxldCB3aWR0aCA9IGNhbnZhcy53aWR0aDtcbiAgICBsZXQgaGVpZ2h0ID0gY2FudmFzLmhlaWdodDtcblxuICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjb25zdCBpbWFnZURhdGEgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBjb25zdCBwaXhlbHMgPSBpbWFnZURhdGEuZGF0YTtcbiAgICBjb25zdCBsZW4gPSBwaXhlbHMubGVuZ3RoO1xuXG4gICAgY29uc3QgYm91bmQ6IEluc2V0ID0ge1xuICAgICAgICB0b3A6IG51bGwsXG4gICAgICAgIGxlZnQ6IG51bGwsXG4gICAgICAgIHJpZ2h0OiBudWxsLFxuICAgICAgICBib3R0b206IG51bGwsXG4gICAgfTtcbiAgICBsZXQgZGF0YSA9IG51bGw7XG4gICAgbGV0IGk7XG4gICAgbGV0IHg7XG4gICAgbGV0IHk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpXG4gICAge1xuICAgICAgICBpZiAocGl4ZWxzW2kgKyAzXSAhPT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgeCA9IChpIC8gNCkgJSB3aWR0aDtcbiAgICAgICAgICAgIHkgPSB+figoaSAvIDQpIC8gd2lkdGgpO1xuXG4gICAgICAgICAgICBpZiAoYm91bmQudG9wID09PSBudWxsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJvdW5kLnRvcCA9IHk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChib3VuZC5sZWZ0ID09PSBudWxsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJvdW5kLmxlZnQgPSB4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoeCA8IGJvdW5kLmxlZnQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYm91bmQubGVmdCA9IHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChib3VuZC5yaWdodCA9PT0gbnVsbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBib3VuZC5yaWdodCA9IHggKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYm91bmQucmlnaHQgPCB4KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJvdW5kLnJpZ2h0ID0geCArIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChib3VuZC5ib3R0b20gPT09IG51bGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYm91bmQuYm90dG9tID0geTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGJvdW5kLmJvdHRvbSA8IHkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYm91bmQuYm90dG9tID0geTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChib3VuZC50b3AgIT09IG51bGwpXG4gICAge1xuICAgICAgICB3aWR0aCA9IGJvdW5kLnJpZ2h0IC0gYm91bmQubGVmdDtcbiAgICAgICAgaGVpZ2h0ID0gYm91bmQuYm90dG9tIC0gYm91bmQudG9wICsgMTtcbiAgICAgICAgZGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKGJvdW5kLmxlZnQsIGJvdW5kLnRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaGVpZ2h0LFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgZGF0YSxcbiAgICB9O1xufVxuIiwgIi8qKlxuICogUmVnZXhwIGZvciBkYXRhIFVSSS5cbiAqIEJhc2VkIG9uOiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3JhZ2luZ3dpbmQvZGF0YS11cmktcmVnZXh9XG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50IHtSZWdFeHB8c3RyaW5nfSBEQVRBX1VSSVxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBleGFtcGxlIGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NFxuICovXG5leHBvcnQgY29uc3QgREFUQV9VUkkgPSAvXlxccypkYXRhOig/OihbXFx3LV0rKVxcLyhbXFx3Ky4tXSspKT8oPzo7Y2hhcnNldD0oW1xcdy1dKykpPyg/OjsoYmFzZTY0KSk/LCguKikvaTtcbiIsICJpbXBvcnQgeyBEQVRBX1VSSSB9IGZyb20gJy4uL2NvbnN0JztcblxuZXhwb3J0IGludGVyZmFjZSBEZWNvbXBvc2VkRGF0YVVyaSB7XG4gICAgbWVkaWFUeXBlOiBzdHJpbmc7XG4gICAgc3ViVHlwZTogc3RyaW5nO1xuICAgIGNoYXJzZXQ6IHN0cmluZztcbiAgICBlbmNvZGluZzogc3RyaW5nO1xuICAgIGRhdGE6IHN0cmluZztcbn1cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGludGVyZmFjZSBEZWNvbXBvc2VkRGF0YVVyaVxuICovXG5cbi8qKlxuICogdHlwZSwgZWcuIGBpbWFnZWBcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzLkRlY29tcG9zZWREYXRhVXJpI1xuICogQG1lbWJlciB7c3RyaW5nfSBtZWRpYVR5cGVcbiAqL1xuXG4vKipcbiAqIFN1YiB0eXBlLCBlZy4gYHBuZ2BcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzLkRlY29tcG9zZWREYXRhVXJpI1xuICogQG1lbWJlciB7c3RyaW5nfSBzdWJUeXBlXG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlscy5EZWNvbXBvc2VkRGF0YVVyaSNcbiAqIEBtZW1iZXIge3N0cmluZ30gY2hhcnNldFxuICovXG5cbi8qKlxuICogRGF0YSBlbmNvZGluZywgZWcuIGBiYXNlNjRgXG4gKiBAbWVtYmVyb2YgUElYSS51dGlscy5EZWNvbXBvc2VkRGF0YVVyaSNcbiAqIEBtZW1iZXIge3N0cmluZ30gZW5jb2RpbmdcbiAqL1xuXG4vKipcbiAqIFRoZSBhY3R1YWwgZGF0YVxuICogQG1lbWJlcm9mIFBJWEkudXRpbHMuRGVjb21wb3NlZERhdGFVcmkjXG4gKiBAbWVtYmVyIHtzdHJpbmd9IGRhdGFcbiAqL1xuXG4vKipcbiAqIFNwbGl0IGEgZGF0YSBVUkkgaW50byBjb21wb25lbnRzLiBSZXR1cm5zIHVuZGVmaW5lZCBpZlxuICogcGFyYW1ldGVyIGBkYXRhVXJpYCBpcyBub3QgYSB2YWxpZCBkYXRhIFVSSS5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQGZ1bmN0aW9uIGRlY29tcG9zZURhdGFVcmlcbiAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhVXJpIC0gdGhlIGRhdGEgVVJJIHRvIGNoZWNrXG4gKiBAcmV0dXJuIHtQSVhJLnV0aWxzLkRlY29tcG9zZWREYXRhVXJpfHVuZGVmaW5lZH0gVGhlIGRlY29tcG9zZWQgZGF0YSB1cmkgb3IgdW5kZWZpbmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWNvbXBvc2VEYXRhVXJpKGRhdGFVcmk6IHN0cmluZyk6IERlY29tcG9zZWREYXRhVXJpXG57XG4gICAgY29uc3QgZGF0YVVyaU1hdGNoID0gREFUQV9VUkkuZXhlYyhkYXRhVXJpKTtcblxuICAgIGlmIChkYXRhVXJpTWF0Y2gpXG4gICAge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWVkaWFUeXBlOiBkYXRhVXJpTWF0Y2hbMV0gPyBkYXRhVXJpTWF0Y2hbMV0udG9Mb3dlckNhc2UoKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHN1YlR5cGU6IGRhdGFVcmlNYXRjaFsyXSA/IGRhdGFVcmlNYXRjaFsyXS50b0xvd2VyQ2FzZSgpIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgY2hhcnNldDogZGF0YVVyaU1hdGNoWzNdID8gZGF0YVVyaU1hdGNoWzNdLnRvTG93ZXJDYXNlKCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBlbmNvZGluZzogZGF0YVVyaU1hdGNoWzRdID8gZGF0YVVyaU1hdGNoWzRdLnRvTG93ZXJDYXNlKCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkYXRhOiBkYXRhVXJpTWF0Y2hbNV0sXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbiIsICJpbXBvcnQgKiBhcyBfdXJsIGZyb20gJ3VybCc7XG5cbmxldCB0ZW1wQW5jaG9yOiBIVE1MQW5jaG9yRWxlbWVudHx1bmRlZmluZWQ7XG5cbi8qKlxuICogU2V0cyB0aGUgYGNyb3NzT3JpZ2luYCBwcm9wZXJ0eSBmb3IgdGhpcyByZXNvdXJjZSBiYXNlZCBvbiBpZiB0aGUgdXJsXG4gKiBmb3IgdGhpcyByZXNvdXJjZSBpcyBjcm9zcy1vcmlnaW4uIElmIGNyb3NzT3JpZ2luIHdhcyBtYW51YWxseSBzZXQsIHRoaXNcbiAqIGZ1bmN0aW9uIGRvZXMgbm90aGluZy5cbiAqIE5pcHBlZCBmcm9tIHRoZSByZXNvdXJjZSBsb2FkZXIhXG4gKlxuICogQGlnbm9yZVxuICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSB1cmwgdG8gdGVzdC5cbiAqIEBwYXJhbSB7b2JqZWN0fSBbbG9jPXdpbmRvdy5sb2NhdGlvbl0gLSBUaGUgbG9jYXRpb24gb2JqZWN0IHRvIHRlc3QgYWdhaW5zdC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGNyb3NzT3JpZ2luIHZhbHVlIHRvIHVzZSAob3IgZW1wdHkgc3RyaW5nIGZvciBub25lKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVybWluZUNyb3NzT3JpZ2luKHVybDogc3RyaW5nLCBsb2M6IExvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uKTogc3RyaW5nXG57XG4gICAgLy8gZGF0YTogYW5kIGphdmFzY3JpcHQ6IHVybHMgYXJlIGNvbnNpZGVyZWQgc2FtZS1vcmlnaW5cbiAgICBpZiAodXJsLmluZGV4T2YoJ2RhdGE6JykgPT09IDApXG4gICAge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLy8gZGVmYXVsdCBpcyB3aW5kb3cubG9jYXRpb25cbiAgICBsb2MgPSBsb2MgfHwgd2luZG93LmxvY2F0aW9uO1xuXG4gICAgaWYgKCF0ZW1wQW5jaG9yKVxuICAgIHtcbiAgICAgICAgdGVtcEFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB9XG5cbiAgICAvLyBsZXQgdGhlIGJyb3dzZXIgZGV0ZXJtaW5lIHRoZSBmdWxsIGhyZWYgZm9yIHRoZSB1cmwgb2YgdGhpcyByZXNvdXJjZSBhbmQgdGhlblxuICAgIC8vIHBhcnNlIHdpdGggdGhlIG5vZGUgdXJsIGxpYiwgd2UgY2FuJ3QgdXNlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBhbmNob3IgZWxlbWVudFxuICAgIC8vIGJlY2F1c2UgdGhleSBkb24ndCB3b3JrIGluIElFOSA6KFxuICAgIHRlbXBBbmNob3IuaHJlZiA9IHVybDtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBfdXJsLnBhcnNlKHRlbXBBbmNob3IuaHJlZik7XG5cbiAgICBjb25zdCBzYW1lUG9ydCA9ICghcGFyc2VkVXJsLnBvcnQgJiYgbG9jLnBvcnQgPT09ICcnKSB8fCAocGFyc2VkVXJsLnBvcnQgPT09IGxvYy5wb3J0KTtcblxuICAgIC8vIGlmIGNyb3NzIG9yaWdpblxuICAgIGlmIChwYXJzZWRVcmwuaG9zdG5hbWUgIT09IGxvYy5ob3N0bmFtZSB8fCAhc2FtZVBvcnQgfHwgcGFyc2VkVXJsLnByb3RvY29sICE9PSBsb2MucHJvdG9jb2wpXG4gICAge1xuICAgICAgICByZXR1cm4gJ2Fub255bW91cyc7XG4gICAgfVxuXG4gICAgcmV0dXJuICcnO1xufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG4vKipcbiAqIGdldCB0aGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiBhbiBhc3NldCBieSBsb29raW5nIGZvciB0aGUgcHJlZml4XG4gKiB1c2VkIGJ5IHNwcml0ZXNoZWV0cyBhbmQgaW1hZ2UgdXJsc1xuICpcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAZnVuY3Rpb24gZ2V0UmVzb2x1dGlvbk9mVXJsXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gdGhlIGltYWdlIHBhdGhcbiAqIEBwYXJhbSB7bnVtYmVyfSBbZGVmYXVsdFZhbHVlPTFdIC0gdGhlIGRlZmF1bHRWYWx1ZSBpZiBubyBmaWxlbmFtZSBwcmVmaXggaXMgc2V0LlxuICogQHJldHVybiB7bnVtYmVyfSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIGFuIGFzc2V0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXNvbHV0aW9uT2ZVcmwodXJsOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IG51bWJlcik6IG51bWJlclxue1xuICAgIGNvbnN0IHJlc29sdXRpb24gPSBzZXR0aW5ncy5SRVRJTkFfUFJFRklYLmV4ZWModXJsKTtcblxuICAgIGlmIChyZXNvbHV0aW9uKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQocmVzb2x1dGlvblsxXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkID8gZGVmYXVsdFZhbHVlIDogMTtcbn1cbiIsICIvKipcbiAqIEdlbmVyYWxpemVkIGNvbnZlbmllbmNlIHV0aWxpdGllcyBmb3IgUElYSS5cbiAqIEBleGFtcGxlXG4gKiAvLyBFeHRlbmQgUElYSSdzIGludGVybmFsIEV2ZW50IEVtaXR0ZXIuXG4gKiBjbGFzcyBNeUVtaXR0ZXIgZXh0ZW5kcyBQSVhJLnV0aWxzLkV2ZW50RW1pdHRlciB7XG4gKiAgIGNvbnN0cnVjdG9yKCkge1xuICogICAgICBzdXBlcigpO1xuICogICAgICBjb25zb2xlLmxvZyhcIkVtaXR0ZXIgY3JlYXRlZCFcIik7XG4gKiAgIH1cbiAqIH1cbiAqXG4gKiAvLyBHZXQgaW5mbyBvbiBjdXJyZW50IGRldmljZVxuICogY29uc29sZS5sb2coUElYSS51dGlscy5pc01vYmlsZSk7XG4gKlxuICogLy8gQ29udmVydCBoZXggY29sb3IgdG8gc3RyaW5nXG4gKiBjb25zb2xlLmxvZyhQSVhJLnV0aWxzLmhleDJzdHJpbmcoMHhmZjAwZmYpKTsgLy8gcmV0dXJuczogXCIjZmYwMGZmXCJcbiAqIEBuYW1lc3BhY2UgUElYSS51dGlsc1xuICovXG5cbi8qKlxuICogQSBzaW1wbGUgSlMgbGlicmFyeSB0aGF0IGRldGVjdHMgbW9iaWxlIGRldmljZXMuXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2thaW1hbGxlYS9pc01vYmlsZX1cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS51dGlsc1xuICogQG5hbWUgaXNNb2JpbGVcbiAqIEB0eXBlIHtPYmplY3R9XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFueSAtIGB0cnVlYCBpZiBjdXJyZW50IHBsYXRmb3JtIGlzIHRhYmxldCBvciBwaG9uZSBkZXZpY2VcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdGFibGV0IC0gYHRydWVgIGlmIGN1cnJlbnQgcGxhdGZvcm0gbGFyZ2Utc2NyZWVuIHRhYmxldCBkZXZpY2VcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gcGhvbmUgLSBgdHJ1ZWAgaWYgY3VycmVudCBwbGF0Zm9ybSBzbWFsbC1zY3JlZW4gcGhvbmUgZGV2aWNlXG4gKiBAcHJvcGVydHkge29iamVjdH0gYXBwbGVcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYXBwbGUuZGV2aWNlIC0gYHRydWVgIGlmIGFueSBBcHBsZSBkZXZpY2VcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYXBwbGUudGFibGV0IC0gYHRydWVgIGlmIGFueSBBcHBsZSBpUGFkXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFwcGxlLnBob25lIC0gYHRydWVgIGlmIGFueSBBcHBsZSBpUGhvbmVcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYXBwbGUuaXBvZCAtIGB0cnVlYCBpZiBhbnkgaVBvZFxuICogQHByb3BlcnR5IHtvYmplY3R9IGFuZHJvaWRcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYW5kcm9pZC5kZXZpY2UgLSBgdHJ1ZWAgaWYgYW55IEFuZHJvaWQgZGV2aWNlXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFuZHJvaWQudGFibGV0IC0gYHRydWVgIGlmIGFueSBBbmRyb2lkIHRhYmxldFxuICogQHByb3BlcnR5IHtib29sZWFufSBhbmRyb2lkLnBob25lIC0gYHRydWVgIGlmIGFueSBBbmRyb2lkIHBob25lXG4gKiBAcHJvcGVydHkge29iamVjdH0gYW1hem9uXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFtYXpvbi5kZXZpY2UgLSBgdHJ1ZWAgaWYgYW55IFNpbGsgZGV2aWNlXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFtYXpvbi50YWJsZXQgLSBgdHJ1ZWAgaWYgYW55IFNpbGsgdGFibGV0XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFtYXpvbi5waG9uZSAtIGB0cnVlYCBpZiBhbnkgU2lsayBwaG9uZVxuICogQHByb3BlcnR5IHtvYmplY3R9IHdpbmRvd3NcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gd2luZG93cy5kZXZpY2UgLSBgdHJ1ZWAgaWYgYW55IFdpbmRvd3MgZGV2aWNlXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHdpbmRvd3MudGFibGV0IC0gYHRydWVgIGlmIGFueSBXaW5kb3dzIHRhYmxldFxuICogQHByb3BlcnR5IHtib29sZWFufSB3aW5kb3dzLnBob25lIC0gYHRydWVgIGlmIGFueSBXaW5kb3dzIHBob25lXG4gKi9cbmV4cG9ydCB7IGlzTW9iaWxlIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuXG5pbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50ZW1pdHRlcjMnO1xuXG4vKipcbiAqIEEgaGlnaCBwZXJmb3JtYW5jZSBldmVudCBlbWl0dGVyXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3ByaW11cy9ldmVudGVtaXR0ZXIzfVxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAY2xhc3MgRXZlbnRFbWl0dGVyXG4gKiBAdHlwZSB7RXZlbnRFbWl0dGVyfVxuICovXG5leHBvcnQgeyBFdmVudEVtaXR0ZXIgfTtcblxuLyoqXG4gKiBBIHBvbHlnb24gdHJpYW5ndWxhdGlvbiBsaWJyYXJ5XG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL21hcGJveC9lYXJjdXR9XG4gKlxuICogQG1lbWJlcm9mIFBJWEkudXRpbHNcbiAqIEBmdW5jdGlvbiBlYXJjdXRcbiAqIEBwYXJhbSB7bnVtYmVyW119IHZlcnRpY2VzIC0gQSBmbGF0IGFycmF5IG9mIHZlcnRleCBjb29yZGluYXRlc1xuICogQHBhcmFtIHtudW1iZXJbXX0gW2hvbGVzXSAtIEFuIGFycmF5IG9mIGhvbGUgaW5kaWNlc1xuICogQHBhcmFtIHtudW1iZXJ9IFtkaW1lbnNpb25zPTJdIC0gVGhlIG51bWJlciBvZiBjb29yZGluYXRlcyBwZXIgdmVydGV4IGluIHRoZSBpbnB1dCBhcnJheVxuICogQHJldHVybiB7bnVtYmVyW119IFRyaWFuZ3VsYXRlZCBwb2x5Z29uXG4gKi9cbmV4cG9ydCB7IGRlZmF1bHQgYXMgZWFyY3V0IH0gZnJvbSAnZWFyY3V0JztcblxuLyoqXG4gKiBOb2RlLmpzIGNvbXBhdGlibGUgVVJMIHV0aWxpdGllcy5cbiAqXG4gKiBAc2VlIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL3VybFxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzXG4gKiBAbmFtZSB1cmxcbiAqIEB0eXBlIHtvYmplY3R9XG4gKi9cbmV4cG9ydCB7IGRlZmF1bHQgYXMgdXJsIH0gZnJvbSAndXJsJztcblxuaW1wb3J0ICcuL3NldHRpbmdzJztcblxuZXhwb3J0ICogZnJvbSAnLi9icm93c2VyL2hlbGxvJztcbmV4cG9ydCAqIGZyb20gJy4vYnJvd3Nlci9pc1dlYkdMU3VwcG9ydGVkJztcbmV4cG9ydCAqIGZyb20gJy4vY29sb3IvaGV4JztcbmV4cG9ydCAqIGZyb20gJy4vY29sb3IvcHJlbXVsdGlwbHknO1xuZXhwb3J0ICogZnJvbSAnLi9kYXRhL2NyZWF0ZUluZGljZXNGb3JRdWFkcyc7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEvZ2V0QnVmZmVyVHlwZSc7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEvaW50ZXJsZWF2ZVR5cGVkQXJyYXlzJztcbmV4cG9ydCAqIGZyb20gJy4vZGF0YS9wb3cyJztcbmV4cG9ydCAqIGZyb20gJy4vZGF0YS9yZW1vdmVJdGVtcyc7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEvc2lnbic7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEvdWlkJztcbmV4cG9ydCAqIGZyb20gJy4vbG9nZ2luZy9kZXByZWNhdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL21lZGlhL2NhY2hlcyc7XG5leHBvcnQgKiBmcm9tICcuL21lZGlhL0NhbnZhc1JlbmRlclRhcmdldCc7XG5leHBvcnQgKiBmcm9tICcuL21lZGlhL3RyaW1DYW52YXMnO1xuZXhwb3J0ICogZnJvbSAnLi9uZXR3b3JrL2RlY29tcG9zZURhdGFVcmknO1xuZXhwb3J0ICogZnJvbSAnLi9uZXR3b3JrL2RldGVybWluZUNyb3NzT3JpZ2luJztcbmV4cG9ydCAqIGZyb20gJy4vbmV0d29yay9nZXRSZXNvbHV0aW9uT2ZVcmwnO1xuZXhwb3J0ICogZnJvbSAnLi9jb25zdCc7XG5leHBvcnQgKiBmcm9tICcuL3R5cGVzJztcbiIsICIvKipcbiAqIFR3byBQaS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAY29uc3RhbnQge251bWJlcn0gUElfMlxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNvbnN0IFBJXzIgPSBNYXRoLlBJICogMjtcblxuLyoqXG4gKiBDb252ZXJzaW9uIGZhY3RvciBmb3IgY29udmVydGluZyByYWRpYW5zIHRvIGRlZ3JlZXMuXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50IHtudW1iZXJ9IFJBRF9UT19ERUdcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjb25zdCBSQURfVE9fREVHID0gMTgwIC8gTWF0aC5QSTtcblxuLyoqXG4gKiBDb252ZXJzaW9uIGZhY3RvciBmb3IgY29udmVydGluZyBkZWdyZWVzIHRvIHJhZGlhbnMuXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50IHtudW1iZXJ9IERFR19UT19SQURcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjb25zdCBERUdfVE9fUkFEID0gTWF0aC5QSSAvIDE4MDtcblxuZXhwb3J0IGVudW0gU0hBUEVTIHtcbiAgICBQT0xZID0gMCxcbiAgICBSRUNUID0gMSxcbiAgICBDSVJDID0gMixcbiAgICBFTElQID0gMyxcbiAgICBSUkVDID0gNCxcbn1cbi8qKlxuICogQ29uc3RhbnRzIHRoYXQgaWRlbnRpZnkgc2hhcGVzLCBtYWlubHkgdG8gcHJldmVudCBgaW5zdGFuY2VvZmAgY2FsbHMuXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50XG4gKiBAbmFtZSBTSEFQRVNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZSB7ZW51bX1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBQT0xZIFBvbHlnb25cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBSRUNUIFJlY3RhbmdsZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IENJUkMgQ2lyY2xlXG4gKiBAcHJvcGVydHkge251bWJlcn0gRUxJUCBFbGxpcHNlXG4gKiBAcHJvcGVydHkge251bWJlcn0gUlJFQyBSb3VuZGVkIFJlY3RhbmdsZVxuICogQGVudW0ge251bWJlcn1cbiAqL1xuIiwgImltcG9ydCB7IFNIQVBFUyB9IGZyb20gJy4uL2NvbnN0JztcblxuLyoqXG4gKiBTaXplIG9iamVjdCwgY29udGFpbnMgd2lkdGggYW5kIGhlaWdodFxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBJU2l6ZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHdpZHRoIC0gV2lkdGggY29tcG9uZW50XG4gKiBAcHJvcGVydHkge251bWJlcn0gaGVpZ2h0IC0gSGVpZ2h0IGNvbXBvbmVudFxuICovXG5cbi8qKlxuICogUmVjdGFuZ2xlIG9iamVjdCBpcyBhbiBhcmVhIGRlZmluZWQgYnkgaXRzIHBvc2l0aW9uLCBhcyBpbmRpY2F0ZWQgYnkgaXRzIHRvcC1sZWZ0IGNvcm5lclxuICogcG9pbnQgKHgsIHkpIGFuZCBieSBpdHMgd2lkdGggYW5kIGl0cyBoZWlnaHQuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgUmVjdGFuZ2xlXG57XG4gICAgcHVibGljIHg6IG51bWJlcjtcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xuICAgIHB1YmxpYyB3aWR0aDogbnVtYmVyO1xuICAgIHB1YmxpYyBoZWlnaHQ6IG51bWJlcjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgdHlwZTogU0hBUEVTLlJFQ1Q7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3g9MF0gLSBUaGUgWCBjb29yZGluYXRlIG9mIHRoZSB1cHBlci1sZWZ0IGNvcm5lciBvZiB0aGUgcmVjdGFuZ2xlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt5PTBdIC0gVGhlIFkgY29vcmRpbmF0ZSBvZiB0aGUgdXBwZXItbGVmdCBjb3JuZXIgb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbd2lkdGg9MF0gLSBUaGUgb3ZlcmFsbCB3aWR0aCBvZiB0aGlzIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbaGVpZ2h0PTBdIC0gVGhlIG92ZXJhbGwgaGVpZ2h0IG9mIHRoaXMgcmVjdGFuZ2xlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoeCA9IDAsIHkgPSAwLCB3aWR0aCA9IDAsIGhlaWdodCA9IDApXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnggPSBOdW1iZXIoeCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55ID0gTnVtYmVyKHkpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud2lkdGggPSBOdW1iZXIod2lkdGgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gTnVtYmVyKGhlaWdodCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0eXBlIG9mIHRoZSBvYmplY3QsIG1haW5seSB1c2VkIHRvIGF2b2lkIGBpbnN0YW5jZW9mYCBjaGVja3NcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5TSEFQRVMuUkVDVFxuICAgICAgICAgKiBAc2VlIFBJWEkuU0hBUEVTXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBTSEFQRVMuUkVDVDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSBsZWZ0IGVkZ2Ugb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBsZWZ0KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSByaWdodCBlZGdlIG9mIHRoZSByZWN0YW5nbGVcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgcmlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy54ICsgdGhpcy53aWR0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSB0b3AgZWRnZSBvZiB0aGUgcmVjdGFuZ2xlXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHRvcCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgYm90dG9tIGVkZ2Ugb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBib3R0b20oKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBjb25zdGFudCBlbXB0eSByZWN0YW5nbGUuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQGNvbnN0YW50XG4gICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICogQHJldHVybiB7UElYSS5SZWN0YW5nbGV9IEFuIGVtcHR5IHJlY3RhbmdsZVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXQgRU1QVFkoKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IFJlY3RhbmdsZSgwLCAwLCAwLCAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhpcyBSZWN0YW5nbGVcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuUmVjdGFuZ2xlfSBhIGNvcHkgb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqL1xuICAgIGNsb25lKCk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgYW5vdGhlciByZWN0YW5nbGUgdG8gdGhpcyBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSByZWN0YW5nbGUgLSBUaGUgcmVjdGFuZ2xlIHRvIGNvcHkgZnJvbS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gUmV0dXJucyBpdHNlbGYuXG4gICAgICovXG4gICAgY29weUZyb20ocmVjdGFuZ2xlOiBSZWN0YW5nbGUpOiBSZWN0YW5nbGVcbiAgICB7XG4gICAgICAgIHRoaXMueCA9IHJlY3RhbmdsZS54O1xuICAgICAgICB0aGlzLnkgPSByZWN0YW5nbGUueTtcbiAgICAgICAgdGhpcy53aWR0aCA9IHJlY3RhbmdsZS53aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSByZWN0YW5nbGUuaGVpZ2h0O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvcGllcyB0aGlzIHJlY3RhbmdsZSB0byBhbm90aGVyIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IHJlY3RhbmdsZSAtIFRoZSByZWN0YW5nbGUgdG8gY29weSB0by5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gUmV0dXJucyBnaXZlbiBwYXJhbWV0ZXIuXG4gICAgICovXG4gICAgY29weVRvKHJlY3RhbmdsZTogUmVjdGFuZ2xlKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICByZWN0YW5nbGUueCA9IHRoaXMueDtcbiAgICAgICAgcmVjdGFuZ2xlLnkgPSB0aGlzLnk7XG4gICAgICAgIHJlY3RhbmdsZS53aWR0aCA9IHRoaXMud2lkdGg7XG4gICAgICAgIHJlY3RhbmdsZS5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblxuICAgICAgICByZXR1cm4gcmVjdGFuZ2xlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB3aGV0aGVyIHRoZSB4IGFuZCB5IGNvb3JkaW5hdGVzIGdpdmVuIGFyZSBjb250YWluZWQgd2l0aGluIHRoaXMgUmVjdGFuZ2xlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIFRoZSBYIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIFRoZSBZIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB4L3kgY29vcmRpbmF0ZXMgYXJlIHdpdGhpbiB0aGlzIFJlY3RhbmdsZVxuICAgICAqL1xuICAgIGNvbnRhaW5zKHg6IG51bWJlciwgeTogbnVtYmVyKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMud2lkdGggPD0gMCB8fCB0aGlzLmhlaWdodCA8PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoeCA+PSB0aGlzLnggJiYgeCA8IHRoaXMueCArIHRoaXMud2lkdGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh5ID49IHRoaXMueSAmJiB5IDwgdGhpcy55ICsgdGhpcy5oZWlnaHQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFkcyB0aGUgcmVjdGFuZ2xlIG1ha2luZyBpdCBncm93IGluIGFsbCBkaXJlY3Rpb25zLlxuICAgICAqIElmIHBhZGRpbmdZIGlzIG9taXR0ZWQsIGJvdGggcGFkZGluZ1ggYW5kIHBhZGRpbmdZIHdpbGwgYmUgc2V0IHRvIHBhZGRpbmdYLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtwYWRkaW5nWD0wXSAtIFRoZSBob3Jpem9udGFsIHBhZGRpbmcgYW1vdW50LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcGFkZGluZ1k9MF0gLSBUaGUgdmVydGljYWwgcGFkZGluZyBhbW91bnQuXG4gICAgICogQHJldHVybiB7UElYSS5SZWN0YW5nbGV9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIHBhZChwYWRkaW5nWCA9IDAsIHBhZGRpbmdZID0gcGFkZGluZ1gpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLnggLT0gcGFkZGluZ1g7XG4gICAgICAgIHRoaXMueSAtPSBwYWRkaW5nWTtcblxuICAgICAgICB0aGlzLndpZHRoICs9IHBhZGRpbmdYICogMjtcbiAgICAgICAgdGhpcy5oZWlnaHQgKz0gcGFkZGluZ1kgKiAyO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpdHMgdGhpcyByZWN0YW5nbGUgYXJvdW5kIHRoZSBwYXNzZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gcmVjdGFuZ2xlIC0gVGhlIHJlY3RhbmdsZSB0byBmaXQuXG4gICAgICogQHJldHVybiB7UElYSS5SZWN0YW5nbGV9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGZpdChyZWN0YW5nbGU6IFJlY3RhbmdsZSk6IHRoaXNcbiAgICB7XG4gICAgICAgIGNvbnN0IHgxID0gTWF0aC5tYXgodGhpcy54LCByZWN0YW5nbGUueCk7XG4gICAgICAgIGNvbnN0IHgyID0gTWF0aC5taW4odGhpcy54ICsgdGhpcy53aWR0aCwgcmVjdGFuZ2xlLnggKyByZWN0YW5nbGUud2lkdGgpO1xuICAgICAgICBjb25zdCB5MSA9IE1hdGgubWF4KHRoaXMueSwgcmVjdGFuZ2xlLnkpO1xuICAgICAgICBjb25zdCB5MiA9IE1hdGgubWluKHRoaXMueSArIHRoaXMuaGVpZ2h0LCByZWN0YW5nbGUueSArIHJlY3RhbmdsZS5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMueCA9IHgxO1xuICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5tYXgoeDIgLSB4MSwgMCk7XG4gICAgICAgIHRoaXMueSA9IHkxO1xuICAgICAgICB0aGlzLmhlaWdodCA9IE1hdGgubWF4KHkyIC0geTEsIDApO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVubGFyZ2VzIHJlY3RhbmdsZSB0aGF0IHdheSBpdHMgY29ybmVycyBsaWUgb24gZ3JpZFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtyZXNvbHV0aW9uPTFdIHJlc29sdXRpb25cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2Vwcz0wLjAwMV0gcHJlY2lzaW9uXG4gICAgICogQHJldHVybiB7UElYSS5SZWN0YW5nbGV9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGNlaWwocmVzb2x1dGlvbiA9IDEsIGVwcyA9IDAuMDAxKTogdGhpc1xuICAgIHtcbiAgICAgICAgY29uc3QgeDIgPSBNYXRoLmNlaWwoKHRoaXMueCArIHRoaXMud2lkdGggLSBlcHMpICogcmVzb2x1dGlvbikgLyByZXNvbHV0aW9uO1xuICAgICAgICBjb25zdCB5MiA9IE1hdGguY2VpbCgodGhpcy55ICsgdGhpcy5oZWlnaHQgLSBlcHMpICogcmVzb2x1dGlvbikgLyByZXNvbHV0aW9uO1xuXG4gICAgICAgIHRoaXMueCA9IE1hdGguZmxvb3IoKHRoaXMueCArIGVwcykgKiByZXNvbHV0aW9uKSAvIHJlc29sdXRpb247XG4gICAgICAgIHRoaXMueSA9IE1hdGguZmxvb3IoKHRoaXMueSArIGVwcykgKiByZXNvbHV0aW9uKSAvIHJlc29sdXRpb247XG5cbiAgICAgICAgdGhpcy53aWR0aCA9IHgyIC0gdGhpcy54O1xuICAgICAgICB0aGlzLmhlaWdodCA9IHkyIC0gdGhpcy55O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVubGFyZ2VzIHRoaXMgcmVjdGFuZ2xlIHRvIGluY2x1ZGUgdGhlIHBhc3NlZCByZWN0YW5nbGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSByZWN0YW5nbGUgLSBUaGUgcmVjdGFuZ2xlIHRvIGluY2x1ZGUuXG4gICAgICogQHJldHVybiB7UElYSS5SZWN0YW5nbGV9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGVubGFyZ2UocmVjdGFuZ2xlOiBSZWN0YW5nbGUpOiB0aGlzXG4gICAge1xuICAgICAgICBjb25zdCB4MSA9IE1hdGgubWluKHRoaXMueCwgcmVjdGFuZ2xlLngpO1xuICAgICAgICBjb25zdCB4MiA9IE1hdGgubWF4KHRoaXMueCArIHRoaXMud2lkdGgsIHJlY3RhbmdsZS54ICsgcmVjdGFuZ2xlLndpZHRoKTtcbiAgICAgICAgY29uc3QgeTEgPSBNYXRoLm1pbih0aGlzLnksIHJlY3RhbmdsZS55KTtcbiAgICAgICAgY29uc3QgeTIgPSBNYXRoLm1heCh0aGlzLnkgKyB0aGlzLmhlaWdodCwgcmVjdGFuZ2xlLnkgKyByZWN0YW5nbGUuaGVpZ2h0KTtcblxuICAgICAgICB0aGlzLnggPSB4MTtcbiAgICAgICAgdGhpcy53aWR0aCA9IHgyIC0geDE7XG4gICAgICAgIHRoaXMueSA9IHkxO1xuICAgICAgICB0aGlzLmhlaWdodCA9IHkyIC0geTE7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFNIQVBFUyB9IGZyb20gJy4vLi4vY29uc3QnO1xuaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSAnLi9SZWN0YW5nbGUnO1xuXG4vKipcbiAqIFRoZSBDaXJjbGUgb2JqZWN0IGlzIHVzZWQgdG8gaGVscCBkcmF3IGdyYXBoaWNzIGFuZCBjYW4gYWxzbyBiZSB1c2VkIHRvIHNwZWNpZnkgYSBoaXQgYXJlYSBmb3IgZGlzcGxheU9iamVjdHMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQ2lyY2xlXG57XG4gICAgcHVibGljIHg6IG51bWJlcjtcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xuICAgIHB1YmxpYyByYWRpdXM6IG51bWJlcjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgdHlwZTogU0hBUEVTLkNJUkM7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3g9MF0gLSBUaGUgWCBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhpcyBjaXJjbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3k9MF0gLSBUaGUgWSBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhpcyBjaXJjbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3JhZGl1cz0wXSAtIFRoZSByYWRpdXMgb2YgdGhlIGNpcmNsZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgcmFkaXVzID0gMClcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueCA9IHg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHR5cGUgb2YgdGhlIG9iamVjdCwgbWFpbmx5IHVzZWQgdG8gYXZvaWQgYGluc3RhbmNlb2ZgIGNoZWNrc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEByZWFkT25seVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLlNIQVBFUy5DSVJDXG4gICAgICAgICAqIEBzZWUgUElYSS5TSEFQRVNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFNIQVBFUy5DSVJDO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjbG9uZSBvZiB0aGlzIENpcmNsZSBpbnN0YW5jZVxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5DaXJjbGV9IGEgY29weSBvZiB0aGUgQ2lyY2xlXG4gICAgICovXG4gICAgY2xvbmUoKTogQ2lyY2xlXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IENpcmNsZSh0aGlzLngsIHRoaXMueSwgdGhpcy5yYWRpdXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB3aGV0aGVyIHRoZSB4IGFuZCB5IGNvb3JkaW5hdGVzIGdpdmVuIGFyZSBjb250YWluZWQgd2l0aGluIHRoaXMgY2lyY2xlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIFRoZSBYIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIFRoZSBZIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB4L3kgY29vcmRpbmF0ZXMgYXJlIHdpdGhpbiB0aGlzIENpcmNsZVxuICAgICAqL1xuICAgIGNvbnRhaW5zKHg6IG51bWJlciwgeTogbnVtYmVyKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMucmFkaXVzIDw9IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHIyID0gdGhpcy5yYWRpdXMgKiB0aGlzLnJhZGl1cztcbiAgICAgICAgbGV0IGR4ID0gKHRoaXMueCAtIHgpO1xuICAgICAgICBsZXQgZHkgPSAodGhpcy55IC0geSk7XG5cbiAgICAgICAgZHggKj0gZHg7XG4gICAgICAgIGR5ICo9IGR5O1xuXG4gICAgICAgIHJldHVybiAoZHggKyBkeSA8PSByMik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBSZXR1cm5zIHRoZSBmcmFtaW5nIHJlY3RhbmdsZSBvZiB0aGUgY2lyY2xlIGFzIGEgUmVjdGFuZ2xlIG9iamVjdFxuICAgICpcbiAgICAqIEByZXR1cm4ge1BJWEkuUmVjdGFuZ2xlfSB0aGUgZnJhbWluZyByZWN0YW5nbGVcbiAgICAqL1xuICAgIGdldEJvdW5kcygpOiBSZWN0YW5nbGVcbiAgICB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjdGFuZ2xlKHRoaXMueCAtIHRoaXMucmFkaXVzLCB0aGlzLnkgLSB0aGlzLnJhZGl1cywgdGhpcy5yYWRpdXMgKiAyLCB0aGlzLnJhZGl1cyAqIDIpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tICcuL1JlY3RhbmdsZSc7XG5pbXBvcnQgeyBTSEFQRVMgfSBmcm9tICcuLi9jb25zdCc7XG5cbi8qKlxuICogVGhlIEVsbGlwc2Ugb2JqZWN0IGlzIHVzZWQgdG8gaGVscCBkcmF3IGdyYXBoaWNzIGFuZCBjYW4gYWxzbyBiZSB1c2VkIHRvIHNwZWNpZnkgYSBoaXQgYXJlYSBmb3IgZGlzcGxheU9iamVjdHMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgRWxsaXBzZVxue1xuICAgIHB1YmxpYyB4OiBudW1iZXI7XG4gICAgcHVibGljIHk6IG51bWJlcjtcbiAgICBwdWJsaWMgd2lkdGg6IG51bWJlcjtcbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIHJlYWRvbmx5IHR5cGU6IFNIQVBFUy5FTElQO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt4PTBdIC0gVGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgY2VudGVyIG9mIHRoaXMgZWxsaXBzZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeT0wXSAtIFRoZSBZIGNvb3JkaW5hdGUgb2YgdGhlIGNlbnRlciBvZiB0aGlzIGVsbGlwc2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2hhbGZXaWR0aD0wXSAtIFRoZSBoYWxmIHdpZHRoIG9mIHRoaXMgZWxsaXBzZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbaGFsZkhlaWdodD0wXSAtIFRoZSBoYWxmIGhlaWdodCBvZiB0aGlzIGVsbGlwc2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih4ID0gMCwgeSA9IDAsIGhhbGZXaWR0aCA9IDAsIGhhbGZIZWlnaHQgPSAwKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy54ID0geDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnkgPSB5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud2lkdGggPSBoYWxmV2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoYWxmSGVpZ2h0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0LCBtYWlubHkgdXNlZCB0byBhdm9pZCBgaW5zdGFuY2VvZmAgY2hlY2tzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRPbmx5XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuU0hBUEVTLkVMSVBcbiAgICAgICAgICogQHNlZSBQSVhJLlNIQVBFU1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gU0hBUEVTLkVMSVA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoaXMgRWxsaXBzZSBpbnN0YW5jZVxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5FbGxpcHNlfSBhIGNvcHkgb2YgdGhlIGVsbGlwc2VcbiAgICAgKi9cbiAgICBjbG9uZSgpOiBFbGxpcHNlXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IEVsbGlwc2UodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3Mgd2hldGhlciB0aGUgeCBhbmQgeSBjb29yZGluYXRlcyBnaXZlbiBhcmUgY29udGFpbmVkIHdpdGhpbiB0aGlzIGVsbGlwc2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgdG8gdGVzdFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gVGhlIFkgY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgdG8gdGVzdFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHgveSBjb29yZHMgYXJlIHdpdGhpbiB0aGlzIGVsbGlwc2VcbiAgICAgKi9cbiAgICBjb250YWlucyh4OiBudW1iZXIsIHk6IG51bWJlcik6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGlmICh0aGlzLndpZHRoIDw9IDAgfHwgdGhpcy5oZWlnaHQgPD0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbm9ybWFsaXplIHRoZSBjb29yZHMgdG8gYW4gZWxsaXBzZSB3aXRoIGNlbnRlciAwLDBcbiAgICAgICAgbGV0IG5vcm14ID0gKCh4IC0gdGhpcy54KSAvIHRoaXMud2lkdGgpO1xuICAgICAgICBsZXQgbm9ybXkgPSAoKHkgLSB0aGlzLnkpIC8gdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgIG5vcm14ICo9IG5vcm14O1xuICAgICAgICBub3JteSAqPSBub3JteTtcblxuICAgICAgICByZXR1cm4gKG5vcm14ICsgbm9ybXkgPD0gMSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZnJhbWluZyByZWN0YW5nbGUgb2YgdGhlIGVsbGlwc2UgYXMgYSBSZWN0YW5nbGUgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gdGhlIGZyYW1pbmcgcmVjdGFuZ2xlXG4gICAgICovXG4gICAgZ2V0Qm91bmRzKCk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUodGhpcy54IC0gdGhpcy53aWR0aCwgdGhpcy55IC0gdGhpcy5oZWlnaHQsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgU0hBUEVTIH0gZnJvbSAnLi4vY29uc3QnO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnQgfSBmcm9tICcuLi9JUG9pbnQnO1xuXG4vKipcbiAqIEEgY2xhc3MgdG8gZGVmaW5lIGEgc2hhcGUgdmlhIHVzZXIgZGVmaW5lZCBjby1vcmluYXRlcy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBQb2x5Z29uXG57XG4gICAgcHVibGljIHBvaW50czogbnVtYmVyW107XG4gICAgcHVibGljIGNsb3NlU3Ryb2tlOiBib29sZWFuO1xuICAgIHB1YmxpYyByZWFkb25seSB0eXBlOiBTSEFQRVMuUE9MWTtcblxuICAgIGNvbnN0cnVjdG9yKHBvaW50czogSVBvaW50W118bnVtYmVyW10pO1xuICAgIGNvbnN0cnVjdG9yKC4uLnBvaW50czogSVBvaW50W118bnVtYmVyW10pO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnRbXXxudW1iZXJbXX0gcG9pbnRzIC0gVGhpcyBjYW4gYmUgYW4gYXJyYXkgb2YgUG9pbnRzXG4gICAgICogIHRoYXQgZm9ybSB0aGUgcG9seWdvbiwgYSBmbGF0IGFycmF5IG9mIG51bWJlcnMgdGhhdCB3aWxsIGJlIGludGVycHJldGVkIGFzIFt4LHksIHgseSwgLi4uXSwgb3JcbiAgICAgKiAgdGhlIGFyZ3VtZW50cyBwYXNzZWQgY2FuIGJlIGFsbCB0aGUgcG9pbnRzIG9mIHRoZSBwb2x5Z29uIGUuZy5cbiAgICAgKiAgYG5ldyBQSVhJLlBvbHlnb24obmV3IFBJWEkuUG9pbnQoKSwgbmV3IFBJWEkuUG9pbnQoKSwgLi4uKWAsIG9yIHRoZSBhcmd1bWVudHMgcGFzc2VkIGNhbiBiZSBmbGF0XG4gICAgICogIHgseSB2YWx1ZXMgZS5nLiBgbmV3IFBvbHlnb24oeCx5LCB4LHksIHgseSwgLi4uKWAgd2hlcmUgYHhgIGFuZCBgeWAgYXJlIE51bWJlcnMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoLi4ucG9pbnRzOiBhbnlbXSlcbiAgICB7XG4gICAgICAgIGxldCBmbGF0OiBJUG9pbnRbXXxudW1iZXJbXSA9IEFycmF5LmlzQXJyYXkocG9pbnRzWzBdKSA/IHBvaW50c1swXSA6IHBvaW50cztcblxuICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGFycmF5IG9mIHBvaW50cywgY29udmVydCBpdCB0byBhIGZsYXQgYXJyYXkgb2YgbnVtYmVyc1xuICAgICAgICBpZiAodHlwZW9mIGZsYXRbMF0gIT09ICdudW1iZXInKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWwgPSBmbGF0Lmxlbmd0aDsgaSA8IGlsOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcC5wdXNoKChmbGF0W2ldIGFzIElQb2ludCkueCwgKGZsYXRbaV0gYXMgSVBvaW50KS55KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmxhdCA9IHA7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gYXJyYXkgb2YgdGhlIHBvaW50cyBvZiB0aGlzIHBvbHlnb25cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBvaW50cyA9IGZsYXQgYXMgbnVtYmVyW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0eXBlIG9mIHRoZSBvYmplY3QsIG1haW5seSB1c2VkIHRvIGF2b2lkIGBpbnN0YW5jZW9mYCBjaGVja3NcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5TSEFQRVMuUE9MWVxuICAgICAgICAgKiBAc2VlIFBJWEkuU0hBUEVTXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBTSEFQRVMuUE9MWTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYGZhbHNlYCBhZnRlciBtb3ZlVG8sIGB0cnVlYCBhZnRlciBgY2xvc2VQYXRoYC4gSW4gYWxsIG90aGVyIGNhc2VzIGl0IGlzIGB0cnVlYC5cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jbG9zZVN0cm9rZSA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoaXMgcG9seWdvblxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5Qb2x5Z29ufSBhIGNvcHkgb2YgdGhlIHBvbHlnb25cbiAgICAgKi9cbiAgICBjbG9uZSgpOiBQb2x5Z29uXG4gICAge1xuICAgICAgICBjb25zdCBwb2ludHMgPSB0aGlzLnBvaW50cy5zbGljZSgpO1xuICAgICAgICBjb25zdCBwb2x5Z29uID0gbmV3IFBvbHlnb24ocG9pbnRzKTtcblxuICAgICAgICBwb2x5Z29uLmNsb3NlU3Ryb2tlID0gdGhpcy5jbG9zZVN0cm9rZTtcblxuICAgICAgICByZXR1cm4gcG9seWdvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3Mgd2hldGhlciB0aGUgeCBhbmQgeSBjb29yZGluYXRlcyBwYXNzZWQgdG8gdGhpcyBmdW5jdGlvbiBhcmUgY29udGFpbmVkIHdpdGhpbiB0aGlzIHBvbHlnb25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgdG8gdGVzdFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gVGhlIFkgY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgdG8gdGVzdFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIHgveSBjb29yZGluYXRlcyBhcmUgd2l0aGluIHRoaXMgcG9seWdvblxuICAgICAqL1xuICAgIGNvbnRhaW5zKHg6IG51bWJlciwgeTogbnVtYmVyKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgbGV0IGluc2lkZSA9IGZhbHNlO1xuXG4gICAgICAgIC8vIHVzZSBzb21lIHJheWNhc3RpbmcgdG8gdGVzdCBoaXRzXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zdWJzdGFjay9wb2ludC1pbi1wb2x5Z29uL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMucG9pbnRzLmxlbmd0aCAvIDI7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSBsZW5ndGggLSAxOyBpIDwgbGVuZ3RoOyBqID0gaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB4aSA9IHRoaXMucG9pbnRzW2kgKiAyXTtcbiAgICAgICAgICAgIGNvbnN0IHlpID0gdGhpcy5wb2ludHNbKGkgKiAyKSArIDFdO1xuICAgICAgICAgICAgY29uc3QgeGogPSB0aGlzLnBvaW50c1tqICogMl07XG4gICAgICAgICAgICBjb25zdCB5aiA9IHRoaXMucG9pbnRzWyhqICogMikgKyAxXTtcbiAgICAgICAgICAgIGNvbnN0IGludGVyc2VjdCA9ICgoeWkgPiB5KSAhPT0gKHlqID4geSkpICYmICh4IDwgKCh4aiAtIHhpKSAqICgoeSAtIHlpKSAvICh5aiAtIHlpKSkpICsgeGkpO1xuXG4gICAgICAgICAgICBpZiAoaW50ZXJzZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluc2lkZSA9ICFpbnNpZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5zaWRlO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBTSEFQRVMgfSBmcm9tICcuLi9jb25zdCc7XG5cbi8qKlxuICogVGhlIFJvdW5kZWQgUmVjdGFuZ2xlIG9iamVjdCBpcyBhbiBhcmVhIHRoYXQgaGFzIG5pY2Ugcm91bmRlZCBjb3JuZXJzLCBhcyBpbmRpY2F0ZWQgYnkgaXRzXG4gKiB0b3AtbGVmdCBjb3JuZXIgcG9pbnQgKHgsIHkpIGFuZCBieSBpdHMgd2lkdGggYW5kIGl0cyBoZWlnaHQgYW5kIGl0cyByYWRpdXMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgUm91bmRlZFJlY3RhbmdsZVxue1xuICAgIHB1YmxpYyB4OiBudW1iZXI7XG4gICAgcHVibGljIHk6IG51bWJlcjtcbiAgICBwdWJsaWMgd2lkdGg6IG51bWJlcjtcbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIHJhZGl1czogbnVtYmVyO1xuICAgIHB1YmxpYyByZWFkb25seSB0eXBlOiBTSEFQRVMuUlJFQztcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeD0wXSAtIFRoZSBYIGNvb3JkaW5hdGUgb2YgdGhlIHVwcGVyLWxlZnQgY29ybmVyIG9mIHRoZSByb3VuZGVkIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeT0wXSAtIFRoZSBZIGNvb3JkaW5hdGUgb2YgdGhlIHVwcGVyLWxlZnQgY29ybmVyIG9mIHRoZSByb3VuZGVkIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbd2lkdGg9MF0gLSBUaGUgb3ZlcmFsbCB3aWR0aCBvZiB0aGlzIHJvdW5kZWQgcmVjdGFuZ2xlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtoZWlnaHQ9MF0gLSBUaGUgb3ZlcmFsbCBoZWlnaHQgb2YgdGhpcyByb3VuZGVkIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmFkaXVzPTIwXSAtIENvbnRyb2xzIHRoZSByYWRpdXMgb2YgdGhlIHJvdW5kZWQgY29ybmVyc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwLCByYWRpdXMgPSAyMClcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueCA9IHg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMjBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0LCBtYWlubHkgdXNlZCB0byBhdm9pZCBgaW5zdGFuY2VvZmAgY2hlY2tzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuU0hBUEVTLlJSRUNcbiAgICAgICAgICogQHNlZSBQSVhJLlNIQVBFU1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gU0hBUEVTLlJSRUM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoaXMgUm91bmRlZCBSZWN0YW5nbGVcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuUm91bmRlZFJlY3RhbmdsZX0gYSBjb3B5IG9mIHRoZSByb3VuZGVkIHJlY3RhbmdsZVxuICAgICAqL1xuICAgIGNsb25lKCk6IFJvdW5kZWRSZWN0YW5nbGVcbiAgICB7XG4gICAgICAgIHJldHVybiBuZXcgUm91bmRlZFJlY3RhbmdsZSh0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMucmFkaXVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3Mgd2hldGhlciB0aGUgeCBhbmQgeSBjb29yZGluYXRlcyBnaXZlbiBhcmUgY29udGFpbmVkIHdpdGhpbiB0aGlzIFJvdW5kZWQgUmVjdGFuZ2xlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIFRoZSBYIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIFRoZSBZIGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50IHRvIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB4L3kgY29vcmRpbmF0ZXMgYXJlIHdpdGhpbiB0aGlzIFJvdW5kZWQgUmVjdGFuZ2xlXG4gICAgICovXG4gICAgY29udGFpbnMoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAodGhpcy53aWR0aCA8PSAwIHx8IHRoaXMuaGVpZ2h0IDw9IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeCA+PSB0aGlzLnggJiYgeCA8PSB0aGlzLnggKyB0aGlzLndpZHRoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoeSA+PSB0aGlzLnkgJiYgeSA8PSB0aGlzLnkgKyB0aGlzLmhlaWdodClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoKHkgPj0gdGhpcy55ICsgdGhpcy5yYWRpdXMgJiYgeSA8PSB0aGlzLnkgKyB0aGlzLmhlaWdodCAtIHRoaXMucmFkaXVzKVxuICAgICAgICAgICAgICAgIHx8ICh4ID49IHRoaXMueCArIHRoaXMucmFkaXVzICYmIHggPD0gdGhpcy54ICsgdGhpcy53aWR0aCAtIHRoaXMucmFkaXVzKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgZHggPSB4IC0gKHRoaXMueCArIHRoaXMucmFkaXVzKTtcbiAgICAgICAgICAgICAgICBsZXQgZHkgPSB5IC0gKHRoaXMueSArIHRoaXMucmFkaXVzKTtcbiAgICAgICAgICAgICAgICBjb25zdCByYWRpdXMyID0gdGhpcy5yYWRpdXMgKiB0aGlzLnJhZGl1cztcblxuICAgICAgICAgICAgICAgIGlmICgoZHggKiBkeCkgKyAoZHkgKiBkeSkgPD0gcmFkaXVzMilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkeCA9IHggLSAodGhpcy54ICsgdGhpcy53aWR0aCAtIHRoaXMucmFkaXVzKTtcbiAgICAgICAgICAgICAgICBpZiAoKGR4ICogZHgpICsgKGR5ICogZHkpIDw9IHJhZGl1czIpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZHkgPSB5IC0gKHRoaXMueSArIHRoaXMuaGVpZ2h0IC0gdGhpcy5yYWRpdXMpO1xuICAgICAgICAgICAgICAgIGlmICgoZHggKiBkeCkgKyAoZHkgKiBkeSkgPD0gcmFkaXVzMilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkeCA9IHggLSAodGhpcy54ICsgdGhpcy5yYWRpdXMpO1xuICAgICAgICAgICAgICAgIGlmICgoZHggKiBkeCkgKyAoZHkgKiBkeSkgPD0gcmFkaXVzMilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBJUG9pbnREYXRhXG57XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBDb21tb24gaW50ZXJmYWNlIGZvciBwb2ludHMuIEJvdGggUG9pbnQgYW5kIE9ic2VydmFibGVQb2ludCBpbXBsZW1lbnQgaXRcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAaW50ZXJmYWNlIElQb2ludERhdGFcbiAqL1xuXG4vKipcbiAqIFggY29vcmRcbiAqIEBtZW1iZXJvZiBQSVhJLklQb2ludERhdGEjXG4gKiBAbWVtYmVyIHtudW1iZXJ9IHhcbiAqL1xuXG4vKipcbiAqIFkgY29vcmRcbiAqIEBtZW1iZXJvZiBQSVhJLklQb2ludERhdGEjXG4gKiBAbWVtYmVyIHtudW1iZXJ9IHlcbiAqL1xuIiwgImltcG9ydCB7IElQb2ludERhdGEgfSBmcm9tICcuL0lQb2ludERhdGEnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElQb2ludCBleHRlbmRzIElQb2ludERhdGFcbntcbiAgICBjb3B5RnJvbShwOiBJUG9pbnREYXRhKTogdGhpcztcbiAgICBjb3B5VG88VCBleHRlbmRzIElQb2ludD4ocDogVCk6IFQ7XG4gICAgZXF1YWxzKHA6IElQb2ludERhdGEpOiBib29sZWFuO1xuICAgIHNldCh4PzogbnVtYmVyLCB5PzogbnVtYmVyKTogdm9pZDtcbn1cbi8qKlxuICogQ29tbW9uIGludGVyZmFjZSBmb3IgcG9pbnRzLiBCb3RoIFBvaW50IGFuZCBPYnNlcnZhYmxlUG9pbnQgaW1wbGVtZW50IGl0XG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGludGVyZmFjZSBJUG9pbnRcbiAqIEBleHRlbmRzIFBJWEkuSVBvaW50RGF0YVxuICovXG5cbi8qKlxuICogU2V0cyB0aGUgcG9pbnQgdG8gYSBuZXcgeCBhbmQgeSBwb3NpdGlvbi5cbiAqIElmIHkgaXMgb21pdHRlZCwgYm90aCB4IGFuZCB5IHdpbGwgYmUgc2V0IHRvIHguXG4gKlxuICogQG1ldGhvZCBzZXRcbiAqIEBtZW1iZXJvZiBQSVhJLklQb2ludCNcbiAqIEBwYXJhbSB7bnVtYmVyfSBbeD0wXSAtIHBvc2l0aW9uIG9mIHRoZSBwb2ludCBvbiB0aGUgeCBheGlzXG4gKiBAcGFyYW0ge251bWJlcn0gW3k9eF0gLSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQgb24gdGhlIHkgYXhpc1xuICovXG5cbi8qKlxuICogQ29waWVzIHggYW5kIHkgZnJvbSB0aGUgZ2l2ZW4gcG9pbnRcbiAqIEBtZXRob2QgY29weUZyb21cbiAqIEBtZW1iZXJvZiBQSVhJLklQb2ludCNcbiAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwIC0gVGhlIHBvaW50IHRvIGNvcHkgZnJvbVxuICogQHJldHVybnMge3RoaXN9IFJldHVybnMgaXRzZWxmLlxuICovXG5cbi8qKlxuICogQ29waWVzIHggYW5kIHkgaW50byB0aGUgZ2l2ZW4gcG9pbnRcbiAqIEBtZXRob2QgY29weVRvXG4gKiBAbWVtYmVyb2YgUElYSS5JUG9pbnQjXG4gKiBAcGFyYW0ge1BJWEkuSVBvaW50fSBwIC0gVGhlIHBvaW50IHRvIGNvcHkuXG4gKiBAcmV0dXJucyB7UElYSS5JUG9pbnR9IEdpdmVuIHBvaW50IHdpdGggdmFsdWVzIHVwZGF0ZWRcbiAqL1xuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gcG9pbnQgaXMgZXF1YWwgdG8gdGhpcyBwb2ludFxuICpcbiAqIEBtZXRob2QgZXF1YWxzXG4gKiBAbWVtYmVyb2YgUElYSS5JUG9pbnQjXG4gKiBAcGFyYW0ge1BJWEkuSVBvaW50RGF0YX0gcCAtIFRoZSBwb2ludCB0byBjaGVja1xuICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIGdpdmVuIHBvaW50IGVxdWFsIHRvIHRoaXMgcG9pbnRcbiAqL1xuXG4iLCAiaW1wb3J0IHR5cGUgeyBJUG9pbnQgfSBmcm9tICcuL0lQb2ludCc7XG5pbXBvcnQgdHlwZSB7IElQb2ludERhdGEgfSBmcm9tICcuL0lQb2ludERhdGEnO1xuXG4vKipcbiAqIFRoZSBQb2ludCBvYmplY3QgcmVwcmVzZW50cyBhIGxvY2F0aW9uIGluIGEgdHdvLWRpbWVuc2lvbmFsIGNvb3JkaW5hdGUgc3lzdGVtLCB3aGVyZSB4IHJlcHJlc2VudHNcbiAqIHRoZSBob3Jpem9udGFsIGF4aXMgYW5kIHkgcmVwcmVzZW50cyB0aGUgdmVydGljYWwgYXhpcy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAaW1wbGVtZW50cyBJUG9pbnRcbiAqL1xuZXhwb3J0IGNsYXNzIFBvaW50IGltcGxlbWVudHMgSVBvaW50XG57XG4gICAgcHVibGljIHg6IG51bWJlcjtcbiAgICBwdWJsaWMgeTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt4PTBdIC0gcG9zaXRpb24gb2YgdGhlIHBvaW50IG9uIHRoZSB4IGF4aXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3k9MF0gLSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQgb24gdGhlIHkgYXhpc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMClcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueCA9IHg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55ID0geTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhpcyBwb2ludFxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5Qb2ludH0gYSBjb3B5IG9mIHRoZSBwb2ludFxuICAgICAqL1xuICAgIGNsb25lKCk6IFBvaW50XG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IFBvaW50KHRoaXMueCwgdGhpcy55KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgeCBhbmQgeSBmcm9tIHRoZSBnaXZlbiBwb2ludFxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLklQb2ludERhdGF9IHAgLSBUaGUgcG9pbnQgdG8gY29weSBmcm9tXG4gICAgICogQHJldHVybnMge3RoaXN9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGNvcHlGcm9tKHA6IElQb2ludERhdGEpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLnNldChwLngsIHAueSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29waWVzIHggYW5kIHkgaW50byB0aGUgZ2l2ZW4gcG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnR9IHAgLSBUaGUgcG9pbnQgdG8gY29weS5cbiAgICAgKiBAcmV0dXJucyB7UElYSS5JUG9pbnR9IEdpdmVuIHBvaW50IHdpdGggdmFsdWVzIHVwZGF0ZWRcbiAgICAgKi9cbiAgICBjb3B5VG88VCBleHRlbmRzIElQb2ludD4ocDogVCk6IFRcbiAgICB7XG4gICAgICAgIHAuc2V0KHRoaXMueCwgdGhpcy55KTtcblxuICAgICAgICByZXR1cm4gcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIHBvaW50IGlzIGVxdWFsIHRvIHRoaXMgcG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwIC0gVGhlIHBvaW50IHRvIGNoZWNrXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIGdpdmVuIHBvaW50IGVxdWFsIHRvIHRoaXMgcG9pbnRcbiAgICAgKi9cbiAgICBlcXVhbHMocDogSVBvaW50RGF0YSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAocC54ID09PSB0aGlzLngpICYmIChwLnkgPT09IHRoaXMueSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcG9pbnQgdG8gYSBuZXcgeCBhbmQgeSBwb3NpdGlvbi5cbiAgICAgKiBJZiB5IGlzIG9taXR0ZWQsIGJvdGggeCBhbmQgeSB3aWxsIGJlIHNldCB0byB4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt4PTBdIC0gcG9zaXRpb24gb2YgdGhlIHBvaW50IG9uIHRoZSB4IGF4aXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3k9eF0gLSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQgb24gdGhlIHkgYXhpc1xuICAgICAqIEByZXR1cm5zIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICBzZXQoeCA9IDAsIHkgPSB4KTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBJUG9pbnREYXRhIH0gZnJvbSAnLi9JUG9pbnREYXRhJztcbmltcG9ydCB0eXBlIHsgSVBvaW50IH0gZnJvbSAnLi9JUG9pbnQnO1xuXG4vKipcbiAqIFRoZSBQb2ludCBvYmplY3QgcmVwcmVzZW50cyBhIGxvY2F0aW9uIGluIGEgdHdvLWRpbWVuc2lvbmFsIGNvb3JkaW5hdGUgc3lzdGVtLCB3aGVyZSB4IHJlcHJlc2VudHNcbiAqIHRoZSBob3Jpem9udGFsIGF4aXMgYW5kIHkgcmVwcmVzZW50cyB0aGUgdmVydGljYWwgYXhpcy5cbiAqXG4gKiBBbiBPYnNlcnZhYmxlUG9pbnQgaXMgYSBwb2ludCB0aGF0IHRyaWdnZXJzIGEgY2FsbGJhY2sgd2hlbiB0aGUgcG9pbnQncyBwb3NpdGlvbiBpcyBjaGFuZ2VkLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBpbXBsZW1lbnRzIElQb2ludFxuICovXG5leHBvcnQgY2xhc3MgT2JzZXJ2YWJsZVBvaW50PFQgPSBhbnk+IGltcGxlbWVudHMgSVBvaW50XG57XG4gICAgcHVibGljIGNiOiAodGhpczogVCkgPT4gYW55O1xuICAgIHB1YmxpYyBzY29wZTogYW55O1xuICAgIF94OiBudW1iZXI7XG4gICAgX3k6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIC0gY2FsbGJhY2sgd2hlbiBjaGFuZ2VkXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHNjb3BlIC0gb3duZXIgb2YgY2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3g9MF0gLSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQgb24gdGhlIHggYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeT0wXSAtIHBvc2l0aW9uIG9mIHRoZSBwb2ludCBvbiB0aGUgeSBheGlzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoY2I6ICh0aGlzOiBUKSA9PiBhbnksIHNjb3BlOiBULCB4ID0gMCwgeSA9IDApXG4gICAge1xuICAgICAgICB0aGlzLl94ID0geDtcbiAgICAgICAgdGhpcy5feSA9IHk7XG5cbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoaXMgcG9pbnQuXG4gICAgICogVGhlIGNhbGxiYWNrIGFuZCBzY29wZSBwYXJhbXMgY2FuIGJlIG92ZXJpZGRlbiBvdGhlcndpc2UgdGhleSB3aWxsIGRlZmF1bHRcbiAgICAgKiB0byB0aGUgY2xvbmUgb2JqZWN0J3MgdmFsdWVzLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NiPW51bGxdIC0gY2FsbGJhY2sgd2hlbiBjaGFuZ2VkXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtzY29wZT1udWxsXSAtIG93bmVyIG9mIGNhbGxiYWNrXG4gICAgICogQHJldHVybiB7UElYSS5PYnNlcnZhYmxlUG9pbnR9IGEgY29weSBvZiB0aGUgcG9pbnRcbiAgICAgKi9cbiAgICBjbG9uZShjYiA9IHRoaXMuY2IsIHNjb3BlID0gdGhpcy5zY29wZSk6IE9ic2VydmFibGVQb2ludFxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlUG9pbnQoY2IsIHNjb3BlLCB0aGlzLl94LCB0aGlzLl95KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwb2ludCB0byBhIG5ldyB4IGFuZCB5IHBvc2l0aW9uLlxuICAgICAqIElmIHkgaXMgb21pdHRlZCwgYm90aCB4IGFuZCB5IHdpbGwgYmUgc2V0IHRvIHguXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3g9MF0gLSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQgb24gdGhlIHggYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeT14XSAtIHBvc2l0aW9uIG9mIHRoZSBwb2ludCBvbiB0aGUgeSBheGlzXG4gICAgICogQHJldHVybnMge3RoaXN9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIHNldCh4ID0gMCwgeSA9IHgpOiB0aGlzXG4gICAge1xuICAgICAgICBpZiAodGhpcy5feCAhPT0geCB8fCB0aGlzLl95ICE9PSB5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl94ID0geDtcbiAgICAgICAgICAgIHRoaXMuX3kgPSB5O1xuICAgICAgICAgICAgdGhpcy5jYi5jYWxsKHRoaXMuc2NvcGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29waWVzIHggYW5kIHkgZnJvbSB0aGUgZ2l2ZW4gcG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwIC0gVGhlIHBvaW50IHRvIGNvcHkgZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7dGhpc30gUmV0dXJucyBpdHNlbGYuXG4gICAgICovXG4gICAgY29weUZyb20ocDogSVBvaW50RGF0YSk6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl94ICE9PSBwLnggfHwgdGhpcy5feSAhPT0gcC55KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl94ID0gcC54O1xuICAgICAgICAgICAgdGhpcy5feSA9IHAueTtcbiAgICAgICAgICAgIHRoaXMuY2IuY2FsbCh0aGlzLnNjb3BlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvcGllcyB4IGFuZCB5IGludG8gdGhlIGdpdmVuIHBvaW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuSVBvaW50fSBwIC0gVGhlIHBvaW50IHRvIGNvcHkuXG4gICAgICogQHJldHVybnMge1BJWEkuSVBvaW50fSBHaXZlbiBwb2ludCB3aXRoIHZhbHVlcyB1cGRhdGVkXG4gICAgICovXG4gICAgY29weVRvPFQgZXh0ZW5kcyBJUG9pbnQ+KHA6IFQpOiBUXG4gICAge1xuICAgICAgICBwLnNldCh0aGlzLl94LCB0aGlzLl95KTtcblxuICAgICAgICByZXR1cm4gcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIHBvaW50IGlzIGVxdWFsIHRvIHRoaXMgcG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwIC0gVGhlIHBvaW50IHRvIGNoZWNrXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFdoZXRoZXIgdGhlIGdpdmVuIHBvaW50IGVxdWFsIHRvIHRoaXMgcG9pbnRcbiAgICAgKi9cbiAgICBlcXVhbHMocDogSVBvaW50RGF0YSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAocC54ID09PSB0aGlzLl94KSAmJiAocC55ID09PSB0aGlzLl95KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcG9zaXRpb24gb2YgdGhlIGRpc3BsYXlPYmplY3Qgb24gdGhlIHggYXhpcyByZWxhdGl2ZSB0byB0aGUgbG9jYWwgY29vcmRpbmF0ZXMgb2YgdGhlIHBhcmVudC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgeCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl94O1xuICAgIH1cblxuICAgIHNldCB4KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5feCAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3ggPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuY2IuY2FsbCh0aGlzLnNjb3BlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgZGlzcGxheU9iamVjdCBvbiB0aGUgeCBheGlzIHJlbGF0aXZlIHRvIHRoZSBsb2NhbCBjb29yZGluYXRlcyBvZiB0aGUgcGFyZW50LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCB5KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3k7XG4gICAgfVxuXG4gICAgc2V0IHkodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl95ICE9PSB2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5feSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jYi5jYWxsKHRoaXMuc2NvcGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFBvaW50IH0gZnJvbSAnLi9Qb2ludCc7XG5pbXBvcnQgeyBQSV8yIH0gZnJvbSAnLi9jb25zdCc7XG5cbmltcG9ydCB0eXBlIHsgVHJhbnNmb3JtIH0gZnJvbSAnLi9UcmFuc2Zvcm0nO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnREYXRhIH0gZnJvbSAnLi9JUG9pbnREYXRhJztcblxuLyoqXG4gKiBUaGUgUGl4aUpTIE1hdHJpeCBhcyBhIGNsYXNzIG1ha2VzIGl0IGEgbG90IGZhc3Rlci5cbiAqXG4gKiBIZXJlIGlzIGEgcmVwcmVzZW50YXRpb24gb2YgaXQ6XG4gKiBgYGBqc1xuICogfCBhIHwgYyB8IHR4fFxuICogfCBiIHwgZCB8IHR5fFxuICogfCAwIHwgMCB8IDEgfFxuICogYGBgXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBNYXRyaXhcbntcbiAgICBwdWJsaWMgYTogbnVtYmVyO1xuICAgIHB1YmxpYyBiOiBudW1iZXI7XG4gICAgcHVibGljIGM6IG51bWJlcjtcbiAgICBwdWJsaWMgZDogbnVtYmVyO1xuICAgIHB1YmxpYyB0eDogbnVtYmVyO1xuICAgIHB1YmxpYyB0eTogbnVtYmVyO1xuXG4gICAgcHVibGljIGFycmF5OiBGbG9hdDMyQXJyYXl8bnVsbCA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2E9MV0gLSB4IHNjYWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtiPTBdIC0geCBza2V3XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjPTBdIC0geSBza2V3XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtkPTFdIC0geSBzY2FsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbdHg9MF0gLSB4IHRyYW5zbGF0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt0eT0wXSAtIHkgdHJhbnNsYXRpb25cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhID0gMSwgYiA9IDAsIGMgPSAwLCBkID0gMSwgdHggPSAwLCB0eSA9IDApXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmEgPSBhO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYiA9IGI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jID0gYztcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmQgPSBkO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHggPSB0eDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5ID0gdHk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIE1hdHJpeCBvYmplY3QgYmFzZWQgb24gdGhlIGdpdmVuIGFycmF5LiBUaGUgRWxlbWVudCB0byBNYXRyaXggbWFwcGluZyBvcmRlciBpcyBhcyBmb2xsb3dzOlxuICAgICAqXG4gICAgICogYSA9IGFycmF5WzBdXG4gICAgICogYiA9IGFycmF5WzFdXG4gICAgICogYyA9IGFycmF5WzNdXG4gICAgICogZCA9IGFycmF5WzRdXG4gICAgICogdHggPSBhcnJheVsyXVxuICAgICAqIHR5ID0gYXJyYXlbNV1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IGFycmF5IC0gVGhlIGFycmF5IHRoYXQgdGhlIG1hdHJpeCB3aWxsIGJlIHBvcHVsYXRlZCBmcm9tLlxuICAgICAqL1xuICAgIGZyb21BcnJheShhcnJheTogbnVtYmVyW10pOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmEgPSBhcnJheVswXTtcbiAgICAgICAgdGhpcy5iID0gYXJyYXlbMV07XG4gICAgICAgIHRoaXMuYyA9IGFycmF5WzNdO1xuICAgICAgICB0aGlzLmQgPSBhcnJheVs0XTtcbiAgICAgICAgdGhpcy50eCA9IGFycmF5WzJdO1xuICAgICAgICB0aGlzLnR5ID0gYXJyYXlbNV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc2V0cyB0aGUgbWF0cml4IHByb3BlcnRpZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhIC0gTWF0cml4IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiIC0gTWF0cml4IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjIC0gTWF0cml4IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkIC0gTWF0cml4IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0eCAtIE1hdHJpeCBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdHkgLSBNYXRyaXggY29tcG9uZW50XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLk1hdHJpeH0gVGhpcyBtYXRyaXguIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi9cbiAgICBzZXQoYTogbnVtYmVyLCBiOiBudW1iZXIsIGM6IG51bWJlciwgZDogbnVtYmVyLCB0eDogbnVtYmVyLCB0eTogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5hID0gYTtcbiAgICAgICAgdGhpcy5iID0gYjtcbiAgICAgICAgdGhpcy5jID0gYztcbiAgICAgICAgdGhpcy5kID0gZDtcbiAgICAgICAgdGhpcy50eCA9IHR4O1xuICAgICAgICB0aGlzLnR5ID0gdHk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBmcm9tIHRoZSBjdXJyZW50IE1hdHJpeCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHRyYW5zcG9zZSAtIFdoZXRoZXIgd2UgbmVlZCB0byB0cmFuc3Bvc2UgdGhlIG1hdHJpeCBvciBub3RcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gW291dD1uZXcgRmxvYXQzMkFycmF5KDkpXSAtIElmIHByb3ZpZGVkIHRoZSBhcnJheSB3aWxsIGJlIGFzc2lnbmVkIHRvIG91dFxuICAgICAqIEByZXR1cm4ge251bWJlcltdfSB0aGUgbmV3bHkgY3JlYXRlZCBhcnJheSB3aGljaCBjb250YWlucyB0aGUgbWF0cml4XG4gICAgICovXG4gICAgdG9BcnJheSh0cmFuc3Bvc2U6IGJvb2xlYW4sIG91dD86IEZsb2F0MzJBcnJheSk6IEZsb2F0MzJBcnJheVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFycmF5ID0gbmV3IEZsb2F0MzJBcnJheSg5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFycmF5ID0gb3V0IHx8IHRoaXMuYXJyYXk7XG5cbiAgICAgICAgaWYgKHRyYW5zcG9zZSlcbiAgICAgICAge1xuICAgICAgICAgICAgYXJyYXlbMF0gPSB0aGlzLmE7XG4gICAgICAgICAgICBhcnJheVsxXSA9IHRoaXMuYjtcbiAgICAgICAgICAgIGFycmF5WzJdID0gMDtcbiAgICAgICAgICAgIGFycmF5WzNdID0gdGhpcy5jO1xuICAgICAgICAgICAgYXJyYXlbNF0gPSB0aGlzLmQ7XG4gICAgICAgICAgICBhcnJheVs1XSA9IDA7XG4gICAgICAgICAgICBhcnJheVs2XSA9IHRoaXMudHg7XG4gICAgICAgICAgICBhcnJheVs3XSA9IHRoaXMudHk7XG4gICAgICAgICAgICBhcnJheVs4XSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBhcnJheVswXSA9IHRoaXMuYTtcbiAgICAgICAgICAgIGFycmF5WzFdID0gdGhpcy5jO1xuICAgICAgICAgICAgYXJyYXlbMl0gPSB0aGlzLnR4O1xuICAgICAgICAgICAgYXJyYXlbM10gPSB0aGlzLmI7XG4gICAgICAgICAgICBhcnJheVs0XSA9IHRoaXMuZDtcbiAgICAgICAgICAgIGFycmF5WzVdID0gdGhpcy50eTtcbiAgICAgICAgICAgIGFycmF5WzZdID0gMDtcbiAgICAgICAgICAgIGFycmF5WzddID0gMDtcbiAgICAgICAgICAgIGFycmF5WzhdID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBuZXcgcG9zaXRpb24gd2l0aCB0aGUgY3VycmVudCB0cmFuc2Zvcm1hdGlvbiBhcHBsaWVkLlxuICAgICAqIENhbiBiZSB1c2VkIHRvIGdvIGZyb20gYSBjaGlsZCdzIGNvb3JkaW5hdGUgc3BhY2UgdG8gdGhlIHdvcmxkIGNvb3JkaW5hdGUgc3BhY2UuIChlLmcuIHJlbmRlcmluZylcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb3MgLSBUaGUgb3JpZ2luXG4gICAgICogQHBhcmFtIHtQSVhJLlBvaW50fSBbbmV3UG9zXSAtIFRoZSBwb2ludCB0aGF0IHRoZSBuZXcgcG9zaXRpb24gaXMgYXNzaWduZWQgdG8gKGFsbG93ZWQgdG8gYmUgc2FtZSBhcyBpbnB1dClcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlBvaW50fSBUaGUgbmV3IHBvaW50LCB0cmFuc2Zvcm1lZCB0aHJvdWdoIHRoaXMgbWF0cml4XG4gICAgICovXG4gICAgYXBwbHk8UCBleHRlbmRzIElQb2ludERhdGEgPSBQb2ludD4ocG9zOiBJUG9pbnREYXRhLCBuZXdQb3M/OiBQKTogUFxuICAgIHtcbiAgICAgICAgbmV3UG9zID0gKG5ld1BvcyB8fCBuZXcgUG9pbnQoKSkgYXMgUDtcblxuICAgICAgICBjb25zdCB4ID0gcG9zLng7XG4gICAgICAgIGNvbnN0IHkgPSBwb3MueTtcblxuICAgICAgICBuZXdQb3MueCA9ICh0aGlzLmEgKiB4KSArICh0aGlzLmMgKiB5KSArIHRoaXMudHg7XG4gICAgICAgIG5ld1Bvcy55ID0gKHRoaXMuYiAqIHgpICsgKHRoaXMuZCAqIHkpICsgdGhpcy50eTtcblxuICAgICAgICByZXR1cm4gbmV3UG9zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIG5ldyBwb3NpdGlvbiB3aXRoIHRoZSBpbnZlcnNlIG9mIHRoZSBjdXJyZW50IHRyYW5zZm9ybWF0aW9uIGFwcGxpZWQuXG4gICAgICogQ2FuIGJlIHVzZWQgdG8gZ28gZnJvbSB0aGUgd29ybGQgY29vcmRpbmF0ZSBzcGFjZSB0byBhIGNoaWxkJ3MgY29vcmRpbmF0ZSBzcGFjZS4gKGUuZy4gaW5wdXQpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuSVBvaW50RGF0YX0gcG9zIC0gVGhlIG9yaWdpblxuICAgICAqIEBwYXJhbSB7UElYSS5Qb2ludH0gW25ld1Bvc10gLSBUaGUgcG9pbnQgdGhhdCB0aGUgbmV3IHBvc2l0aW9uIGlzIGFzc2lnbmVkIHRvIChhbGxvd2VkIHRvIGJlIHNhbWUgYXMgaW5wdXQpXG4gICAgICogQHJldHVybiB7UElYSS5Qb2ludH0gVGhlIG5ldyBwb2ludCwgaW52ZXJzZS10cmFuc2Zvcm1lZCB0aHJvdWdoIHRoaXMgbWF0cml4XG4gICAgICovXG4gICAgYXBwbHlJbnZlcnNlPFAgZXh0ZW5kcyBJUG9pbnREYXRhID0gUG9pbnQ+KHBvczogSVBvaW50RGF0YSwgbmV3UG9zPzogUCk6IFBcbiAgICB7XG4gICAgICAgIG5ld1BvcyA9IChuZXdQb3MgfHwgbmV3IFBvaW50KCkpIGFzIFA7XG5cbiAgICAgICAgY29uc3QgaWQgPSAxIC8gKCh0aGlzLmEgKiB0aGlzLmQpICsgKHRoaXMuYyAqIC10aGlzLmIpKTtcblxuICAgICAgICBjb25zdCB4ID0gcG9zLng7XG4gICAgICAgIGNvbnN0IHkgPSBwb3MueTtcblxuICAgICAgICBuZXdQb3MueCA9ICh0aGlzLmQgKiBpZCAqIHgpICsgKC10aGlzLmMgKiBpZCAqIHkpICsgKCgodGhpcy50eSAqIHRoaXMuYykgLSAodGhpcy50eCAqIHRoaXMuZCkpICogaWQpO1xuICAgICAgICBuZXdQb3MueSA9ICh0aGlzLmEgKiBpZCAqIHkpICsgKC10aGlzLmIgKiBpZCAqIHgpICsgKCgoLXRoaXMudHkgKiB0aGlzLmEpICsgKHRoaXMudHggKiB0aGlzLmIpKSAqIGlkKTtcblxuICAgICAgICByZXR1cm4gbmV3UG9zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyYW5zbGF0ZXMgdGhlIG1hdHJpeCBvbiB0aGUgeCBhbmQgeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gSG93IG11Y2ggdG8gdHJhbnNsYXRlIHggYnlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIEhvdyBtdWNoIHRvIHRyYW5zbGF0ZSB5IGJ5XG4gICAgICogQHJldHVybiB7UElYSS5NYXRyaXh9IFRoaXMgbWF0cml4LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHMuXG4gICAgICovXG4gICAgdHJhbnNsYXRlKHg6IG51bWJlciwgeTogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy50eCArPSB4O1xuICAgICAgICB0aGlzLnR5ICs9IHk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhIHNjYWxlIHRyYW5zZm9ybWF0aW9uIHRvIHRoZSBtYXRyaXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIFRoZSBhbW91bnQgdG8gc2NhbGUgaG9yaXpvbnRhbGx5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBUaGUgYW1vdW50IHRvIHNjYWxlIHZlcnRpY2FsbHlcbiAgICAgKiBAcmV0dXJuIHtQSVhJLk1hdHJpeH0gVGhpcyBtYXRyaXguIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi9cbiAgICBzY2FsZSh4OiBudW1iZXIsIHk6IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMuYSAqPSB4O1xuICAgICAgICB0aGlzLmQgKj0geTtcbiAgICAgICAgdGhpcy5jICo9IHg7XG4gICAgICAgIHRoaXMuYiAqPSB5O1xuICAgICAgICB0aGlzLnR4ICo9IHg7XG4gICAgICAgIHRoaXMudHkgKj0geTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGEgcm90YXRpb24gdHJhbnNmb3JtYXRpb24gdG8gdGhlIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhbmdsZSAtIFRoZSBhbmdsZSBpbiByYWRpYW5zLlxuICAgICAqIEByZXR1cm4ge1BJWEkuTWF0cml4fSBUaGlzIG1hdHJpeC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqL1xuICAgIHJvdGF0ZShhbmdsZTogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgY29uc3QgY29zID0gTWF0aC5jb3MoYW5nbGUpO1xuICAgICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbihhbmdsZSk7XG5cbiAgICAgICAgY29uc3QgYTEgPSB0aGlzLmE7XG4gICAgICAgIGNvbnN0IGMxID0gdGhpcy5jO1xuICAgICAgICBjb25zdCB0eDEgPSB0aGlzLnR4O1xuXG4gICAgICAgIHRoaXMuYSA9IChhMSAqIGNvcykgLSAodGhpcy5iICogc2luKTtcbiAgICAgICAgdGhpcy5iID0gKGExICogc2luKSArICh0aGlzLmIgKiBjb3MpO1xuICAgICAgICB0aGlzLmMgPSAoYzEgKiBjb3MpIC0gKHRoaXMuZCAqIHNpbik7XG4gICAgICAgIHRoaXMuZCA9IChjMSAqIHNpbikgKyAodGhpcy5kICogY29zKTtcbiAgICAgICAgdGhpcy50eCA9ICh0eDEgKiBjb3MpIC0gKHRoaXMudHkgKiBzaW4pO1xuICAgICAgICB0aGlzLnR5ID0gKHR4MSAqIHNpbikgKyAodGhpcy50eSAqIGNvcyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyB0aGUgZ2l2ZW4gTWF0cml4IHRvIHRoaXMgTWF0cml4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gbWF0cml4IC0gVGhlIG1hdHJpeCB0byBhcHBlbmQuXG4gICAgICogQHJldHVybiB7UElYSS5NYXRyaXh9IFRoaXMgbWF0cml4LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHMuXG4gICAgICovXG4gICAgYXBwZW5kKG1hdHJpeDogTWF0cml4KTogdGhpc1xuICAgIHtcbiAgICAgICAgY29uc3QgYTEgPSB0aGlzLmE7XG4gICAgICAgIGNvbnN0IGIxID0gdGhpcy5iO1xuICAgICAgICBjb25zdCBjMSA9IHRoaXMuYztcbiAgICAgICAgY29uc3QgZDEgPSB0aGlzLmQ7XG5cbiAgICAgICAgdGhpcy5hID0gKG1hdHJpeC5hICogYTEpICsgKG1hdHJpeC5iICogYzEpO1xuICAgICAgICB0aGlzLmIgPSAobWF0cml4LmEgKiBiMSkgKyAobWF0cml4LmIgKiBkMSk7XG4gICAgICAgIHRoaXMuYyA9IChtYXRyaXguYyAqIGExKSArIChtYXRyaXguZCAqIGMxKTtcbiAgICAgICAgdGhpcy5kID0gKG1hdHJpeC5jICogYjEpICsgKG1hdHJpeC5kICogZDEpO1xuXG4gICAgICAgIHRoaXMudHggPSAobWF0cml4LnR4ICogYTEpICsgKG1hdHJpeC50eSAqIGMxKSArIHRoaXMudHg7XG4gICAgICAgIHRoaXMudHkgPSAobWF0cml4LnR4ICogYjEpICsgKG1hdHJpeC50eSAqIGQxKSArIHRoaXMudHk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbWF0cml4IGJhc2VkIG9uIGFsbCB0aGUgYXZhaWxhYmxlIHByb3BlcnRpZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gUG9zaXRpb24gb24gdGhlIHggYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gUG9zaXRpb24gb24gdGhlIHkgYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwaXZvdFggLSBQaXZvdCBvbiB0aGUgeCBheGlzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBpdm90WSAtIFBpdm90IG9uIHRoZSB5IGF4aXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2NhbGVYIC0gU2NhbGUgb24gdGhlIHggYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZVkgLSBTY2FsZSBvbiB0aGUgeSBheGlzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdGF0aW9uIC0gUm90YXRpb24gaW4gcmFkaWFuc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBza2V3WCAtIFNrZXcgb24gdGhlIHggYXhpc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBza2V3WSAtIFNrZXcgb24gdGhlIHkgYXhpc1xuICAgICAqIEByZXR1cm4ge1BJWEkuTWF0cml4fSBUaGlzIG1hdHJpeC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqL1xuICAgIHNldFRyYW5zZm9ybSh4OiBudW1iZXIsIHk6IG51bWJlciwgcGl2b3RYOiBudW1iZXIsIHBpdm90WTogbnVtYmVyLCBzY2FsZVg6IG51bWJlcixcbiAgICAgICAgc2NhbGVZOiBudW1iZXIsIHJvdGF0aW9uOiBudW1iZXIsIHNrZXdYOiBudW1iZXIsIHNrZXdZOiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLmEgPSBNYXRoLmNvcyhyb3RhdGlvbiArIHNrZXdZKSAqIHNjYWxlWDtcbiAgICAgICAgdGhpcy5iID0gTWF0aC5zaW4ocm90YXRpb24gKyBza2V3WSkgKiBzY2FsZVg7XG4gICAgICAgIHRoaXMuYyA9IC1NYXRoLnNpbihyb3RhdGlvbiAtIHNrZXdYKSAqIHNjYWxlWTtcbiAgICAgICAgdGhpcy5kID0gTWF0aC5jb3Mocm90YXRpb24gLSBza2V3WCkgKiBzY2FsZVk7XG5cbiAgICAgICAgdGhpcy50eCA9IHggLSAoKHBpdm90WCAqIHRoaXMuYSkgKyAocGl2b3RZICogdGhpcy5jKSk7XG4gICAgICAgIHRoaXMudHkgPSB5IC0gKChwaXZvdFggKiB0aGlzLmIpICsgKHBpdm90WSAqIHRoaXMuZCkpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXBlbmRzIHRoZSBnaXZlbiBNYXRyaXggdG8gdGhpcyBNYXRyaXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBUaGUgbWF0cml4IHRvIHByZXBlbmRcbiAgICAgKiBAcmV0dXJuIHtQSVhJLk1hdHJpeH0gVGhpcyBtYXRyaXguIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi9cbiAgICBwcmVwZW5kKG1hdHJpeDogTWF0cml4KTogdGhpc1xuICAgIHtcbiAgICAgICAgY29uc3QgdHgxID0gdGhpcy50eDtcblxuICAgICAgICBpZiAobWF0cml4LmEgIT09IDEgfHwgbWF0cml4LmIgIT09IDAgfHwgbWF0cml4LmMgIT09IDAgfHwgbWF0cml4LmQgIT09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGExID0gdGhpcy5hO1xuICAgICAgICAgICAgY29uc3QgYzEgPSB0aGlzLmM7XG5cbiAgICAgICAgICAgIHRoaXMuYSA9IChhMSAqIG1hdHJpeC5hKSArICh0aGlzLmIgKiBtYXRyaXguYyk7XG4gICAgICAgICAgICB0aGlzLmIgPSAoYTEgKiBtYXRyaXguYikgKyAodGhpcy5iICogbWF0cml4LmQpO1xuICAgICAgICAgICAgdGhpcy5jID0gKGMxICogbWF0cml4LmEpICsgKHRoaXMuZCAqIG1hdHJpeC5jKTtcbiAgICAgICAgICAgIHRoaXMuZCA9IChjMSAqIG1hdHJpeC5iKSArICh0aGlzLmQgKiBtYXRyaXguZCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnR4ID0gKHR4MSAqIG1hdHJpeC5hKSArICh0aGlzLnR5ICogbWF0cml4LmMpICsgbWF0cml4LnR4O1xuICAgICAgICB0aGlzLnR5ID0gKHR4MSAqIG1hdHJpeC5iKSArICh0aGlzLnR5ICogbWF0cml4LmQpICsgbWF0cml4LnR5O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlY29tcG9zZXMgdGhlIG1hdHJpeCAoeCwgeSwgc2NhbGVYLCBzY2FsZVksIGFuZCByb3RhdGlvbikgYW5kIHNldHMgdGhlIHByb3BlcnRpZXMgb24gdG8gYSB0cmFuc2Zvcm0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuVHJhbnNmb3JtfSB0cmFuc2Zvcm0gLSBUaGUgdHJhbnNmb3JtIHRvIGFwcGx5IHRoZSBwcm9wZXJ0aWVzIHRvLlxuICAgICAqIEByZXR1cm4ge1BJWEkuVHJhbnNmb3JtfSBUaGUgdHJhbnNmb3JtIHdpdGggdGhlIG5ld2x5IGFwcGxpZWQgcHJvcGVydGllc1xuICAgICAqL1xuICAgIGRlY29tcG9zZSh0cmFuc2Zvcm06IFRyYW5zZm9ybSk6IFRyYW5zZm9ybVxuICAgIHtcbiAgICAgICAgLy8gc29ydCBvdXQgcm90YXRpb24gLyBza2V3Li5cbiAgICAgICAgY29uc3QgYSA9IHRoaXMuYTtcbiAgICAgICAgY29uc3QgYiA9IHRoaXMuYjtcbiAgICAgICAgY29uc3QgYyA9IHRoaXMuYztcbiAgICAgICAgY29uc3QgZCA9IHRoaXMuZDtcblxuICAgICAgICBjb25zdCBza2V3WCA9IC1NYXRoLmF0YW4yKC1jLCBkKTtcbiAgICAgICAgY29uc3Qgc2tld1kgPSBNYXRoLmF0YW4yKGIsIGEpO1xuXG4gICAgICAgIGNvbnN0IGRlbHRhID0gTWF0aC5hYnMoc2tld1ggKyBza2V3WSk7XG5cbiAgICAgICAgaWYgKGRlbHRhIDwgMC4wMDAwMSB8fCBNYXRoLmFicyhQSV8yIC0gZGVsdGEpIDwgMC4wMDAwMSlcbiAgICAgICAge1xuICAgICAgICAgICAgdHJhbnNmb3JtLnJvdGF0aW9uID0gc2tld1k7XG4gICAgICAgICAgICB0cmFuc2Zvcm0uc2tldy54ID0gdHJhbnNmb3JtLnNrZXcueSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0cmFuc2Zvcm0ucm90YXRpb24gPSAwO1xuICAgICAgICAgICAgdHJhbnNmb3JtLnNrZXcueCA9IHNrZXdYO1xuICAgICAgICAgICAgdHJhbnNmb3JtLnNrZXcueSA9IHNrZXdZO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbmV4dCBzZXQgc2NhbGVcbiAgICAgICAgdHJhbnNmb3JtLnNjYWxlLnggPSBNYXRoLnNxcnQoKGEgKiBhKSArIChiICogYikpO1xuICAgICAgICB0cmFuc2Zvcm0uc2NhbGUueSA9IE1hdGguc3FydCgoYyAqIGMpICsgKGQgKiBkKSk7XG5cbiAgICAgICAgLy8gbmV4dCBzZXQgcG9zaXRpb25cbiAgICAgICAgdHJhbnNmb3JtLnBvc2l0aW9uLnggPSB0aGlzLnR4O1xuICAgICAgICB0cmFuc2Zvcm0ucG9zaXRpb24ueSA9IHRoaXMudHk7XG5cbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnZlcnRzIHRoaXMgbWF0cml4XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLk1hdHJpeH0gVGhpcyBtYXRyaXguIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi9cbiAgICBpbnZlcnQoKTogdGhpc1xuICAgIHtcbiAgICAgICAgY29uc3QgYTEgPSB0aGlzLmE7XG4gICAgICAgIGNvbnN0IGIxID0gdGhpcy5iO1xuICAgICAgICBjb25zdCBjMSA9IHRoaXMuYztcbiAgICAgICAgY29uc3QgZDEgPSB0aGlzLmQ7XG4gICAgICAgIGNvbnN0IHR4MSA9IHRoaXMudHg7XG4gICAgICAgIGNvbnN0IG4gPSAoYTEgKiBkMSkgLSAoYjEgKiBjMSk7XG5cbiAgICAgICAgdGhpcy5hID0gZDEgLyBuO1xuICAgICAgICB0aGlzLmIgPSAtYjEgLyBuO1xuICAgICAgICB0aGlzLmMgPSAtYzEgLyBuO1xuICAgICAgICB0aGlzLmQgPSBhMSAvIG47XG4gICAgICAgIHRoaXMudHggPSAoKGMxICogdGhpcy50eSkgLSAoZDEgKiB0eDEpKSAvIG47XG4gICAgICAgIHRoaXMudHkgPSAtKChhMSAqIHRoaXMudHkpIC0gKGIxICogdHgxKSkgLyBuO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGlzIE1hdHJpeCB0byBhbiBpZGVudGl0eSAoZGVmYXVsdCkgbWF0cml4LlxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5NYXRyaXh9IFRoaXMgbWF0cml4LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHMuXG4gICAgICovXG4gICAgaWRlbnRpdHkoKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5hID0gMTtcbiAgICAgICAgdGhpcy5iID0gMDtcbiAgICAgICAgdGhpcy5jID0gMDtcbiAgICAgICAgdGhpcy5kID0gMTtcbiAgICAgICAgdGhpcy50eCA9IDA7XG4gICAgICAgIHRoaXMudHkgPSAwO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgTWF0cml4IG9iamVjdCB3aXRoIHRoZSBzYW1lIHZhbHVlcyBhcyB0aGlzIG9uZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuTWF0cml4fSBBIGNvcHkgb2YgdGhpcyBtYXRyaXguIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi9cbiAgICBjbG9uZSgpOiBNYXRyaXhcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeCA9IG5ldyBNYXRyaXgoKTtcblxuICAgICAgICBtYXRyaXguYSA9IHRoaXMuYTtcbiAgICAgICAgbWF0cml4LmIgPSB0aGlzLmI7XG4gICAgICAgIG1hdHJpeC5jID0gdGhpcy5jO1xuICAgICAgICBtYXRyaXguZCA9IHRoaXMuZDtcbiAgICAgICAgbWF0cml4LnR4ID0gdGhpcy50eDtcbiAgICAgICAgbWF0cml4LnR5ID0gdGhpcy50eTtcblxuICAgICAgICByZXR1cm4gbWF0cml4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIHZhbHVlcyBvZiB0aGUgZ2l2ZW4gbWF0cml4IHRvIGJlIHRoZSBzYW1lIGFzIHRoZSBvbmVzIGluIHRoaXMgbWF0cml4XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBUaGUgbWF0cml4IHRvIGNvcHkgdG8uXG4gICAgICogQHJldHVybiB7UElYSS5NYXRyaXh9IFRoZSBtYXRyaXggZ2l2ZW4gaW4gcGFyYW1ldGVyIHdpdGggaXRzIHZhbHVlcyB1cGRhdGVkLlxuICAgICAqL1xuICAgIGNvcHlUbyhtYXRyaXg6IE1hdHJpeCk6IE1hdHJpeFxuICAgIHtcbiAgICAgICAgbWF0cml4LmEgPSB0aGlzLmE7XG4gICAgICAgIG1hdHJpeC5iID0gdGhpcy5iO1xuICAgICAgICBtYXRyaXguYyA9IHRoaXMuYztcbiAgICAgICAgbWF0cml4LmQgPSB0aGlzLmQ7XG4gICAgICAgIG1hdHJpeC50eCA9IHRoaXMudHg7XG4gICAgICAgIG1hdHJpeC50eSA9IHRoaXMudHk7XG5cbiAgICAgICAgcmV0dXJuIG1hdHJpeDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIG1hdHJpeCB0byBiZSB0aGUgc2FtZSBhcyB0aGUgb25lcyBpbiBnaXZlbiBtYXRyaXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXRyaXh9IG1hdHJpeCAtIFRoZSBtYXRyaXggdG8gY29weSBmcm9tLlxuICAgICAqIEByZXR1cm4ge1BJWEkuTWF0cml4fSB0aGlzXG4gICAgICovXG4gICAgY29weUZyb20obWF0cml4OiBNYXRyaXgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLmEgPSBtYXRyaXguYTtcbiAgICAgICAgdGhpcy5iID0gbWF0cml4LmI7XG4gICAgICAgIHRoaXMuYyA9IG1hdHJpeC5jO1xuICAgICAgICB0aGlzLmQgPSBtYXRyaXguZDtcbiAgICAgICAgdGhpcy50eCA9IG1hdHJpeC50eDtcbiAgICAgICAgdGhpcy50eSA9IG1hdHJpeC50eTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGRlZmF1bHQgKGlkZW50aXR5KSBtYXRyaXhcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAY29uc3RcbiAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0IElERU5USVRZKCk6IE1hdHJpeFxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXRyaXgoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHRlbXAgbWF0cml4XG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQGNvbnN0XG4gICAgICogQG1lbWJlciB7UElYSS5NYXRyaXh9XG4gICAgICovXG4gICAgc3RhdGljIGdldCBURU1QX01BVFJJWCgpOiBNYXRyaXhcbiAgICB7XG4gICAgICAgIHJldHVybiBuZXcgTWF0cml4KCk7XG4gICAgfVxufVxuIiwgIi8vIFlvdXIgZnJpZW5kbHkgbmVpZ2hib3VyIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0RpaGVkcmFsX2dyb3VwXG4vL1xuLy8gVGhpcyBmaWxlIGltcGxlbWVudHMgdGhlIGRpaGVkcmFsIGdyb3VwIG9mIG9yZGVyIDE2LCBhbHNvIGNhbGxlZFxuLy8gb2YgZGVncmVlIDguIFRoYXQncyB3aHkgaXRzIGNhbGxlZCBncm91cEQ4LlxuXG5pbXBvcnQgeyBNYXRyaXggfSBmcm9tICcuL01hdHJpeCc7XG5cbi8qXG4gKiBUcmFuc2Zvcm0gbWF0cml4IGZvciBvcGVyYXRpb24gbiBpczpcbiAqIHwgdXggfCB2eCB8XG4gKiB8IHV5IHwgdnkgfFxuICovXG5cbmNvbnN0IHV4ID0gWzEsIDEsIDAsIC0xLCAtMSwgLTEsIDAsIDEsIDEsIDEsIDAsIC0xLCAtMSwgLTEsIDAsIDFdO1xuY29uc3QgdXkgPSBbMCwgMSwgMSwgMSwgMCwgLTEsIC0xLCAtMSwgMCwgMSwgMSwgMSwgMCwgLTEsIC0xLCAtMV07XG5jb25zdCB2eCA9IFswLCAtMSwgLTEsIC0xLCAwLCAxLCAxLCAxLCAwLCAxLCAxLCAxLCAwLCAtMSwgLTEsIC0xXTtcbmNvbnN0IHZ5ID0gWzEsIDEsIDAsIC0xLCAtMSwgLTEsIDAsIDEsIC0xLCAtMSwgMCwgMSwgMSwgMSwgMCwgLTFdO1xuXG4vKipcbiAqIFtDYXlsZXkgVGFibGVde0BsaW5rIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NheWxleV90YWJsZX1cbiAqIGZvciB0aGUgY29tcG9zaXRpb24gb2YgZWFjaCByb3RhdGlvbiBpbiB0aGUgZGloZWRlcmFsIGdyb3VwIEQ4LlxuICpcbiAqIEB0eXBlIG51bWJlcltdW11cbiAqIEBwcml2YXRlXG4gKi9cbmNvbnN0IHJvdGF0aW9uQ2F5bGV5OiBudW1iZXJbXVtdID0gW107XG5cbi8qKlxuICogTWF0cmljZXMgZm9yIGVhY2ggYEdEOFN5bW1ldHJ5YCByb3RhdGlvbi5cbiAqXG4gKiBAdHlwZSBNYXRyaXhbXVxuICogQHByaXZhdGVcbiAqL1xuY29uc3Qgcm90YXRpb25NYXRyaWNlczogTWF0cml4W10gPSBbXTtcblxuLypcbiAqIEFsaWFzIGZvciB7QGNvZGUgTWF0aC5zaWdufS5cbiAqL1xuY29uc3Qgc2lnbnVtID0gTWF0aC5zaWduO1xuXG4vKlxuICogSW5pdGlhbGl6ZXMgYHJvdGF0aW9uQ2F5bGV5YCBhbmQgYHJvdGF0aW9uTWF0cmljZXNgLiBJdCBpcyBjYWxsZWRcbiAqIG9ubHkgb25jZSBiZWxvdy5cbiAqL1xuZnVuY3Rpb24gaW5pdCgpOiB2b2lkXG57XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKVxuICAgIHtcbiAgICAgICAgY29uc3Qgcm93OiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICAgIHJvdGF0aW9uQ2F5bGV5LnB1c2gocm93KTtcblxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyBqKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8qIE11bHRpcGxpZXMgcm90YXRpb24gbWF0cmljZXMgaSBhbmQgai4gKi9cbiAgICAgICAgICAgIGNvbnN0IF91eCA9IHNpZ251bSgodXhbaV0gKiB1eFtqXSkgKyAodnhbaV0gKiB1eVtqXSkpO1xuICAgICAgICAgICAgY29uc3QgX3V5ID0gc2lnbnVtKCh1eVtpXSAqIHV4W2pdKSArICh2eVtpXSAqIHV5W2pdKSk7XG4gICAgICAgICAgICBjb25zdCBfdnggPSBzaWdudW0oKHV4W2ldICogdnhbal0pICsgKHZ4W2ldICogdnlbal0pKTtcbiAgICAgICAgICAgIGNvbnN0IF92eSA9IHNpZ251bSgodXlbaV0gKiB2eFtqXSkgKyAodnlbaV0gKiB2eVtqXSkpO1xuXG4gICAgICAgICAgICAvKiBGaW5kcyByb3RhdGlvbiBtYXRyaXggbWF0Y2hpbmcgdGhlIHByb2R1Y3QgYW5kIHB1c2hlcyBpdC4gKi9cbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgMTY7IGsrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodXhba10gPT09IF91eCAmJiB1eVtrXSA9PT0gX3V5XG4gICAgICAgICAgICAgICAgICAgICAgJiYgdnhba10gPT09IF92eCAmJiB2eVtrXSA9PT0gX3Z5KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcm93LnB1c2goayk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKylcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdCA9IG5ldyBNYXRyaXgoKTtcblxuICAgICAgICBtYXQuc2V0KHV4W2ldLCB1eVtpXSwgdnhbaV0sIHZ5W2ldLCAwLCAwKTtcbiAgICAgICAgcm90YXRpb25NYXRyaWNlcy5wdXNoKG1hdCk7XG4gICAgfVxufVxuXG5pbml0KCk7XG5cbnR5cGUgR0Q4U3ltbWV0cnkgPSBudW1iZXI7XG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZWRlZiB7bnVtYmVyfSBHRDhTeW1tZXRyeVxuICogQHNlZSBQSVhJLmdyb3VwRDhcbiAqL1xuXG4vKipcbiAqIEltcGxlbWVudHMgdGhlIGRpaGVkcmFsIGdyb3VwIEQ4LCB3aGljaCBpcyBzaW1pbGFyIHRvXG4gKiBbZ3JvdXAgRDRde0BsaW5rIGh0dHA6Ly9tYXRod29ybGQud29sZnJhbS5jb20vRGloZWRyYWxHcm91cEQ0Lmh0bWx9O1xuICogRDggaXMgdGhlIHNhbWUgYnV0IHdpdGggZGlhZ29uYWxzLCBhbmQgaXQgaXMgdXNlZCBmb3IgdGV4dHVyZVxuICogcm90YXRpb25zLlxuICpcbiAqIFRoZSBkaXJlY3Rpb25zIHRoZSBVLSBhbmQgVi0gYXhlcyBhZnRlciByb3RhdGlvblxuICogb2YgYW4gYW5nbGUgb2YgYGE6IEdEOENvbnN0YW50YCBhcmUgdGhlIHZlY3RvcnMgYCh1WChhKSwgdVkoYSkpYFxuICogYW5kIGAodlgoYSksIHZZKGEpKWAuIFRoZXNlIGFyZW4ndCBuZWNlc3NhcmlseSB1bml0IHZlY3RvcnMuXG4gKlxuICogKipPcmlnaW46Kio8YnI+XG4gKiAgVGhpcyBpcyB0aGUgc21hbGwgcGFydCBvZiBnYW1lb2Zib21icy5jb20gcG9ydGFsIHN5c3RlbS4gSXQgd29ya3MuXG4gKlxuICogQHNlZSBQSVhJLmdyb3VwRDguRVxuICogQHNlZSBQSVhJLmdyb3VwRDguU0VcbiAqIEBzZWUgUElYSS5ncm91cEQ4LlNcbiAqIEBzZWUgUElYSS5ncm91cEQ4LlNXXG4gKiBAc2VlIFBJWEkuZ3JvdXBEOC5XXG4gKiBAc2VlIFBJWEkuZ3JvdXBEOC5OV1xuICogQHNlZSBQSVhJLmdyb3VwRDguTlxuICogQHNlZSBQSVhJLmdyb3VwRDguTkVcbiAqIEBhdXRob3IgSXZhbiBAaXZhbnBvcGVseXNoZXZcbiAqIEBuYW1lc3BhY2UgUElYSS5ncm91cEQ4XG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY29uc3QgZ3JvdXBEOCA9IHtcbiAgICAvKipcbiAgICAgKiB8IFJvdGF0aW9uIHwgRGlyZWN0aW9uIHxcbiAgICAgKiB8LS0tLS0tLS0tLXwtLS0tLS0tLS0tLXxcbiAgICAgKiB8IDBcdTAwQjAgICAgICAgfCBFYXN0ICAgICAgfFxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZ3JvdXBEOFxuICAgICAqIEBjb25zdGFudCB7UElYSS5HRDhTeW1tZXRyeX1cbiAgICAgKi9cbiAgICBFOiAwLFxuXG4gICAgLyoqXG4gICAgICogfCBSb3RhdGlvbiB8IERpcmVjdGlvbiB8XG4gICAgICogfC0tLS0tLS0tLS18LS0tLS0tLS0tLS18XG4gICAgICogfCA0NVx1MDBCMFx1MjFCQiAgICAgfCBTb3V0aGVhc3QgfFxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZ3JvdXBEOFxuICAgICAqIEBjb25zdGFudCB7UElYSS5HRDhTeW1tZXRyeX1cbiAgICAgKi9cbiAgICBTRTogMSxcblxuICAgIC8qKlxuICAgICAqIHwgUm90YXRpb24gfCBEaXJlY3Rpb24gfFxuICAgICAqIHwtLS0tLS0tLS0tfC0tLS0tLS0tLS0tfFxuICAgICAqIHwgOTBcdTAwQjBcdTIxQkIgICAgIHwgU291dGggICAgIHxcbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgUzogMixcblxuICAgIC8qKlxuICAgICAqIHwgUm90YXRpb24gfCBEaXJlY3Rpb24gfFxuICAgICAqIHwtLS0tLS0tLS0tfC0tLS0tLS0tLS0tfFxuICAgICAqIHwgMTM1XHUwMEIwXHUyMUJCICAgIHwgU291dGh3ZXN0IHxcbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgU1c6IDMsXG5cbiAgICAvKipcbiAgICAgKiB8IFJvdGF0aW9uIHwgRGlyZWN0aW9uIHxcbiAgICAgKiB8LS0tLS0tLS0tLXwtLS0tLS0tLS0tLXxcbiAgICAgKiB8IDE4MFx1MDBCMCAgICAgfCBXZXN0ICAgICAgfFxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZ3JvdXBEOFxuICAgICAqIEBjb25zdGFudCB7UElYSS5HRDhTeW1tZXRyeX1cbiAgICAgKi9cbiAgICBXOiA0LFxuXG4gICAgLyoqXG4gICAgICogfCBSb3RhdGlvbiAgICB8IERpcmVjdGlvbiAgICB8XG4gICAgICogfC0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18XG4gICAgICogfCAtMTM1XHUwMEIwLzIyNVx1MDBCMFx1MjFCQiB8IE5vcnRod2VzdCAgICB8XG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQGNvbnN0YW50IHtQSVhJLkdEOFN5bW1ldHJ5fVxuICAgICAqL1xuICAgIE5XOiA1LFxuXG4gICAgLyoqXG4gICAgICogfCBSb3RhdGlvbiAgICB8IERpcmVjdGlvbiAgICB8XG4gICAgICogfC0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18XG4gICAgICogfCAtOTBcdTAwQjAvMjcwXHUwMEIwXHUyMUJCICB8IE5vcnRoICAgICAgICB8XG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQGNvbnN0YW50IHtQSVhJLkdEOFN5bW1ldHJ5fVxuICAgICAqL1xuICAgIE46IDYsXG5cbiAgICAvKipcbiAgICAgKiB8IFJvdGF0aW9uICAgIHwgRGlyZWN0aW9uICAgIHxcbiAgICAgKiB8LS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLXxcbiAgICAgKiB8IC00NVx1MDBCMC8zMTVcdTAwQjBcdTIxQkIgIHwgTm9ydGhlYXN0ICAgIHxcbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgTkU6IDcsXG5cbiAgICAvKipcbiAgICAgKiBSZWZsZWN0aW9uIGFib3V0IFktYXhpcy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgTUlSUk9SX1ZFUlRJQ0FMOiA4LFxuXG4gICAgLyoqXG4gICAgICogUmVmbGVjdGlvbiBhYm91dCB0aGUgbWFpbiBkaWFnb25hbC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgTUFJTl9ESUFHT05BTDogMTAsXG5cbiAgICAvKipcbiAgICAgKiBSZWZsZWN0aW9uIGFib3V0IFgtYXhpcy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAY29uc3RhbnQge1BJWEkuR0Q4U3ltbWV0cnl9XG4gICAgICovXG4gICAgTUlSUk9SX0hPUklaT05UQUw6IDEyLFxuXG4gICAgLyoqXG4gICAgICogUmVmbGVjdGlvbiBhYm91dCByZXZlcnNlIGRpYWdvbmFsLlxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZ3JvdXBEOFxuICAgICAqIEBjb25zdGFudCB7UElYSS5HRDhTeW1tZXRyeX1cbiAgICAgKi9cbiAgICBSRVZFUlNFX0RJQUdPTkFMOiAxNCxcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IGluZCAtIHNwcml0ZSByb3RhdGlvbiBhbmdsZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdEOFN5bW1ldHJ5fSBUaGUgWC1jb21wb25lbnQgb2YgdGhlIFUtYXhpc1xuICAgICAqICAgIGFmdGVyIHJvdGF0aW5nIHRoZSBheGVzLlxuICAgICAqL1xuICAgIHVYOiAoaW5kOiBHRDhTeW1tZXRyeSk6IEdEOFN5bW1ldHJ5ID0+IHV4W2luZF0sXG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQHBhcmFtIHtQSVhJLkdEOFN5bW1ldHJ5fSBpbmQgLSBzcHJpdGUgcm90YXRpb24gYW5nbGUuXG4gICAgICogQHJldHVybiB7UElYSS5HRDhTeW1tZXRyeX0gVGhlIFktY29tcG9uZW50IG9mIHRoZSBVLWF4aXNcbiAgICAgKiAgICBhZnRlciByb3RhdGluZyB0aGUgYXhlcy5cbiAgICAgKi9cbiAgICB1WTogKGluZDogR0Q4U3ltbWV0cnkpOiBHRDhTeW1tZXRyeSA9PiB1eVtpbmRdLFxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZ3JvdXBEOFxuICAgICAqIEBwYXJhbSB7UElYSS5HRDhTeW1tZXRyeX0gaW5kIC0gc3ByaXRlIHJvdGF0aW9uIGFuZ2xlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuR0Q4U3ltbWV0cnl9IFRoZSBYLWNvbXBvbmVudCBvZiB0aGUgVi1heGlzXG4gICAgICogICAgYWZ0ZXIgcm90YXRpbmcgdGhlIGF4ZXMuXG4gICAgICovXG4gICAgdlg6IChpbmQ6IEdEOFN5bW1ldHJ5KTogR0Q4U3ltbWV0cnkgPT4gdnhbaW5kXSxcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IGluZCAtIHNwcml0ZSByb3RhdGlvbiBhbmdsZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdEOFN5bW1ldHJ5fSBUaGUgWS1jb21wb25lbnQgb2YgdGhlIFYtYXhpc1xuICAgICAqICAgIGFmdGVyIHJvdGF0aW5nIHRoZSBheGVzLlxuICAgICAqL1xuICAgIHZZOiAoaW5kOiBHRDhTeW1tZXRyeSk6IEdEOFN5bW1ldHJ5ID0+IHZ5W2luZF0sXG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQHBhcmFtIHtQSVhJLkdEOFN5bW1ldHJ5fSByb3RhdGlvbiAtIHN5bW1ldHJ5IHdob3NlIG9wcG9zaXRlXG4gICAgICogICBpcyBuZWVkZWQuIE9ubHkgcm90YXRpb25zIGhhdmUgb3Bwb3NpdGUgc3ltbWV0cmllcyB3aGlsZVxuICAgICAqICAgcmVmbGVjdGlvbnMgZG9uJ3QuXG4gICAgICogQHJldHVybiB7UElYSS5HRDhTeW1tZXRyeX0gVGhlIG9wcG9zaXRlIHN5bW1ldHJ5IG9mIGByb3RhdGlvbmBcbiAgICAgKi9cbiAgICBpbnY6IChyb3RhdGlvbjogR0Q4U3ltbWV0cnkpOiBHRDhTeW1tZXRyeSA9PlxuICAgIHtcbiAgICAgICAgaWYgKHJvdGF0aW9uICYgOCkvLyB0cnVlIG9ubHkgaWYgYmV0d2VlbiA4ICYgMTUgKHJlZmxlY3Rpb25zKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRpb24gJiAxNTsvLyBvciByb3RhdGlvbiAlIDE2XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKC1yb3RhdGlvbikgJiA3Oy8vIG9yICg4IC0gcm90YXRpb24pICUgOFxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDb21wb3NlcyB0aGUgdHdvIEQ4IG9wZXJhdGlvbnMuXG4gICAgICpcbiAgICAgKiBUYWtpbmcgYF5gIGFzIHJlZmxlY3Rpb246XG4gICAgICpcbiAgICAgKiB8ICAgICAgIHwgRT0wIHwgUz0yIHwgVz00IHwgTj02IHwgRV49OCB8IFNePTEwIHwgV149MTIgfCBOXj0xNCB8XG4gICAgICogfC0tLS0tLS18LS0tLS18LS0tLS18LS0tLS18LS0tLS18LS0tLS0tfC0tLS0tLS18LS0tLS0tLXwtLS0tLS0tfFxuICAgICAqIHwgRT0wICAgfCBFICAgfCBTICAgfCBXICAgfCBOICAgfCBFXiAgIHwgU14gICAgfCBXXiAgICB8IE5eICAgIHxcbiAgICAgKiB8IFM9MiAgIHwgUyAgIHwgVyAgIHwgTiAgIHwgRSAgIHwgU14gICB8IFdeICAgIHwgTl4gICAgfCBFXiAgICB8XG4gICAgICogfCBXPTQgICB8IFcgICB8IE4gICB8IEUgICB8IFMgICB8IFdeICAgfCBOXiAgICB8IEVeICAgIHwgU14gICAgfFxuICAgICAqIHwgTj02ICAgfCBOICAgfCBFICAgfCBTICAgfCBXICAgfCBOXiAgIHwgRV4gICAgfCBTXiAgICB8IFdeICAgIHxcbiAgICAgKiB8IEVePTggIHwgRV4gIHwgTl4gIHwgV14gIHwgU14gIHwgRSAgICB8IE4gICAgIHwgVyAgICAgfCBTICAgICB8XG4gICAgICogfCBTXj0xMCB8IFNeICB8IEVeICB8IE5eICB8IFdeICB8IFMgICAgfCBFICAgICB8IE4gICAgIHwgVyAgICAgfFxuICAgICAqIHwgV149MTIgfCBXXiAgfCBTXiAgfCBFXiAgfCBOXiAgfCBXICAgIHwgUyAgICAgfCBFICAgICB8IE4gICAgIHxcbiAgICAgKiB8IE5ePTE0IHwgTl4gIHwgV14gIHwgU14gIHwgRV4gIHwgTiAgICB8IFcgICAgIHwgUyAgICAgfCBFICAgICB8XG4gICAgICpcbiAgICAgKiBbVGhpcyBpcyBhIENheWxleSB0YWJsZV17QGxpbmsgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2F5bGV5X3RhYmxlfVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IHJvdGF0aW9uU2Vjb25kIC0gU2Vjb25kIG9wZXJhdGlvbiwgd2hpY2hcbiAgICAgKiAgIGlzIHRoZSByb3cgaW4gdGhlIGFib3ZlIGNheWxleSB0YWJsZS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IHJvdGF0aW9uRmlyc3QgLSBGaXJzdCBvcGVyYXRpb24sIHdoaWNoXG4gICAgICogICBpcyB0aGUgY29sdW1uIGluIHRoZSBhYm92ZSBjYXlsZXkgdGFibGUuXG4gICAgICogQHJldHVybiB7UElYSS5HRDhTeW1tZXRyeX0gQ29tcG9zZWQgb3BlcmF0aW9uXG4gICAgICovXG4gICAgYWRkOiAocm90YXRpb25TZWNvbmQ6IEdEOFN5bW1ldHJ5LCByb3RhdGlvbkZpcnN0OiBHRDhTeW1tZXRyeSk6IEdEOFN5bW1ldHJ5ID0+IChcbiAgICAgICAgcm90YXRpb25DYXlsZXlbcm90YXRpb25TZWNvbmRdW3JvdGF0aW9uRmlyc3RdXG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIFJldmVyc2Ugb2YgYGFkZGAuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQHBhcmFtIHtQSVhJLkdEOFN5bW1ldHJ5fSByb3RhdGlvblNlY29uZCAtIFNlY29uZCBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IHJvdGF0aW9uRmlyc3QgLSBGaXJzdCBvcGVyYXRpb25cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdEOFN5bW1ldHJ5fSBSZXN1bHRcbiAgICAgKi9cbiAgICBzdWI6IChyb3RhdGlvblNlY29uZDogR0Q4U3ltbWV0cnksIHJvdGF0aW9uRmlyc3Q6IEdEOFN5bW1ldHJ5KTogR0Q4U3ltbWV0cnkgPT4gKFxuICAgICAgICByb3RhdGlvbkNheWxleVtyb3RhdGlvblNlY29uZF1bZ3JvdXBEOC5pbnYocm90YXRpb25GaXJzdCldXG4gICAgKSxcblxuICAgIC8qKlxuICAgICAqIEFkZHMgMTgwIGRlZ3JlZXMgdG8gcm90YXRpb24sIHdoaWNoIGlzIGEgY29tbXV0YXRpdmVcbiAgICAgKiBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdGF0aW9uIC0gVGhlIG51bWJlciB0byByb3RhdGUuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUm90YXRlZCBudW1iZXJcbiAgICAgKi9cbiAgICByb3RhdGUxODA6IChyb3RhdGlvbjogbnVtYmVyKTogbnVtYmVyID0+IHJvdGF0aW9uIF4gNCxcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgcm90YXRpb24gYW5nbGUgaXMgdmVydGljYWwsIGkuZS4gc291dGhcbiAgICAgKiBvciBub3J0aC4gSXQgZG9lc24ndCB3b3JrIGZvciByZWZsZWN0aW9ucy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0Q4U3ltbWV0cnl9IHJvdGF0aW9uIC0gVGhlIG51bWJlciB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hldGhlciBvciBub3QgdGhlIGRpcmVjdGlvbiBpcyB2ZXJ0aWNhbFxuICAgICAqL1xuICAgIGlzVmVydGljYWw6IChyb3RhdGlvbjogR0Q4U3ltbWV0cnkpOiBib29sZWFuID0+IChyb3RhdGlvbiAmIDMpID09PSAyLCAvLyByb3RhdGlvbiAlIDQgPT09IDJcblxuICAgIC8qKlxuICAgICAqIEFwcHJveGltYXRlcyB0aGUgdmVjdG9yIGBWKGR4LGR5KWAgaW50byBvbmUgb2YgdGhlXG4gICAgICogZWlnaHQgZGlyZWN0aW9ucyBwcm92aWRlZCBieSBgZ3JvdXBEOGAuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5ncm91cEQ4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR4IC0gWC1jb21wb25lbnQgb2YgdGhlIHZlY3RvclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkeSAtIFktY29tcG9uZW50IG9mIHRoZSB2ZWN0b3JcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdEOFN5bW1ldHJ5fSBBcHByb3hpbWF0aW9uIG9mIHRoZSB2ZWN0b3IgaW50b1xuICAgICAqICBvbmUgb2YgdGhlIGVpZ2h0IHN5bW1ldHJpZXMuXG4gICAgICovXG4gICAgYnlEaXJlY3Rpb246IChkeDogbnVtYmVyLCBkeTogbnVtYmVyKTogR0Q4U3ltbWV0cnkgPT5cbiAgICB7XG4gICAgICAgIGlmIChNYXRoLmFicyhkeCkgKiAyIDw9IE1hdGguYWJzKGR5KSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGR5ID49IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwRDguUztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGdyb3VwRDguTjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChNYXRoLmFicyhkeSkgKiAyIDw9IE1hdGguYWJzKGR4KSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGR4ID4gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXBEOC5FO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZ3JvdXBEOC5XO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5ID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGR4ID4gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXBEOC5TRTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGdyb3VwRDguU1c7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZHggPiAwKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZ3JvdXBEOC5ORTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBncm91cEQ4Lk5XO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIZWxwcyBzcHJpdGUgdG8gY29tcGVuc2F0ZSB0ZXh0dXJlIHBhY2tlciByb3RhdGlvbi5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmdyb3VwRDhcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBzcHJpdGUgd29ybGQgbWF0cml4XG4gICAgICogQHBhcmFtIHtQSVhJLkdEOFN5bW1ldHJ5fSByb3RhdGlvbiAtIFRoZSByb3RhdGlvbiBmYWN0b3IgdG8gdXNlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0eCAtIHNwcml0ZSBhbmNob3JpbmdcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdHkgLSBzcHJpdGUgYW5jaG9yaW5nXG4gICAgICovXG4gICAgbWF0cml4QXBwZW5kUm90YXRpb25JbnY6IChtYXRyaXg6IE1hdHJpeCwgcm90YXRpb246IEdEOFN5bW1ldHJ5LCB0eCA9IDAsIHR5ID0gMCk6IHZvaWQgPT5cbiAgICB7XG4gICAgICAgIC8vIFBhY2tlciB1c2VkIFwicm90YXRpb25cIiwgd2UgdXNlIFwiaW52KHJvdGF0aW9uKVwiXG4gICAgICAgIGNvbnN0IG1hdDogTWF0cml4ID0gcm90YXRpb25NYXRyaWNlc1tncm91cEQ4Lmludihyb3RhdGlvbildO1xuXG4gICAgICAgIG1hdC50eCA9IHR4O1xuICAgICAgICBtYXQudHkgPSB0eTtcbiAgICAgICAgbWF0cml4LmFwcGVuZChtYXQpO1xuICAgIH0sXG59O1xuIiwgImltcG9ydCB7IE9ic2VydmFibGVQb2ludCB9IGZyb20gJy4vT2JzZXJ2YWJsZVBvaW50JztcbmltcG9ydCB7IE1hdHJpeCB9IGZyb20gJy4vTWF0cml4JztcblxuLyoqXG4gKiBUcmFuc2Zvcm0gdGhhdCB0YWtlcyBjYXJlIGFib3V0IGl0cyB2ZXJzaW9uc1xuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFRyYW5zZm9ybVxue1xuICAgIC8qKlxuICAgICAqIEEgZGVmYXVsdCAoaWRlbnRpdHkpIHRyYW5zZm9ybVxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBjb25zdGFudFxuICAgICAqIEBtZW1iZXIge1BJWEkuVHJhbnNmb3JtfVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSURFTlRJVFkgPSBuZXcgVHJhbnNmb3JtKCk7XG5cbiAgICBwdWJsaWMgd29ybGRUcmFuc2Zvcm06IE1hdHJpeDtcbiAgICBwdWJsaWMgbG9jYWxUcmFuc2Zvcm06IE1hdHJpeDtcbiAgICBwdWJsaWMgcG9zaXRpb246IE9ic2VydmFibGVQb2ludDtcbiAgICBwdWJsaWMgc2NhbGU6IE9ic2VydmFibGVQb2ludDtcbiAgICBwdWJsaWMgcGl2b3Q6IE9ic2VydmFibGVQb2ludDtcbiAgICBwdWJsaWMgc2tldzogT2JzZXJ2YWJsZVBvaW50O1xuICAgIHB1YmxpYyBfcGFyZW50SUQ6IG51bWJlcjtcbiAgICBfd29ybGRJRDogbnVtYmVyO1xuXG4gICAgcHJvdGVjdGVkIF9yb3RhdGlvbjogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfY3g6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3N4OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9jeTogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfc3k6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2xvY2FsSUQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2N1cnJlbnRMb2NhbElEOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHdvcmxkIHRyYW5zZm9ybWF0aW9uIG1hdHJpeC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NYXRyaXh9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndvcmxkVHJhbnNmb3JtID0gbmV3IE1hdHJpeCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbG9jYWwgdHJhbnNmb3JtYXRpb24gbWF0cml4LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9jYWxUcmFuc2Zvcm0gPSBuZXcgTWF0cml4KCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjb29yZGluYXRlIG9mIHRoZSBvYmplY3QgcmVsYXRpdmUgdG8gdGhlIGxvY2FsIGNvb3JkaW5hdGVzIG9mIHRoZSBwYXJlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBPYnNlcnZhYmxlUG9pbnQodGhpcy5vbkNoYW5nZSwgdGhpcywgMCwgMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzY2FsZSBmYWN0b3Igb2YgdGhlIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5PYnNlcnZhYmxlUG9pbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNjYWxlID0gbmV3IE9ic2VydmFibGVQb2ludCh0aGlzLm9uQ2hhbmdlLCB0aGlzLCAxLCAxKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHBpdm90IHBvaW50IG9mIHRoZSBkaXNwbGF5T2JqZWN0IHRoYXQgaXQgcm90YXRlcyBhcm91bmQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5waXZvdCA9IG5ldyBPYnNlcnZhYmxlUG9pbnQodGhpcy5vbkNoYW5nZSwgdGhpcywgMCwgMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBza2V3IGFtb3VudCwgb24gdGhlIHggYW5kIHkgYXhpcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5PYnNlcnZhYmxlUG9pbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNrZXcgPSBuZXcgT2JzZXJ2YWJsZVBvaW50KHRoaXMudXBkYXRlU2tldywgdGhpcywgMCwgMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByb3RhdGlvbiBhbW91bnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcm90YXRpb24gPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgWC1jb29yZGluYXRlIHZhbHVlIG9mIHRoZSBub3JtYWxpemVkIGxvY2FsIFggYXhpcyxcbiAgICAgICAgICogdGhlIGZpcnN0IGNvbHVtbiBvZiB0aGUgbG9jYWwgdHJhbnNmb3JtYXRpb24gbWF0cml4IHdpdGhvdXQgYSBzY2FsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jeCA9IDE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBZLWNvb3JkaW5hdGUgdmFsdWUgb2YgdGhlIG5vcm1hbGl6ZWQgbG9jYWwgWCBheGlzLFxuICAgICAgICAgKiB0aGUgZmlyc3QgY29sdW1uIG9mIHRoZSBsb2NhbCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggd2l0aG91dCBhIHNjYWxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3N4ID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFgtY29vcmRpbmF0ZSB2YWx1ZSBvZiB0aGUgbm9ybWFsaXplZCBsb2NhbCBZIGF4aXMsXG4gICAgICAgICAqIHRoZSBzZWNvbmQgY29sdW1uIG9mIHRoZSBsb2NhbCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggd2l0aG91dCBhIHNjYWxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2N5ID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFktY29vcmRpbmF0ZSB2YWx1ZSBvZiB0aGUgbm9ybWFsaXplZCBsb2NhbCBZIGF4aXMsXG4gICAgICAgICAqIHRoZSBzZWNvbmQgY29sdW1uIG9mIHRoZSBsb2NhbCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggd2l0aG91dCBhIHNjYWxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3N5ID0gMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGxvY2FsbHkgdW5pcXVlIElEIG9mIHRoZSBsb2NhbCB0cmFuc2Zvcm0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbG9jYWxJRCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb2NhbGx5IHVuaXF1ZSBJRCBvZiB0aGUgbG9jYWwgdHJhbnNmb3JtXG4gICAgICAgICAqIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBjdXJyZW50IGxvY2FsIHRyYW5zZm9ybWF0aW9uIG1hdHJpeC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jdXJyZW50TG9jYWxJRCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb2NhbGx5IHVuaXF1ZSBJRCBvZiB0aGUgd29ybGQgdHJhbnNmb3JtLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3dvcmxkSUQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbG9jYWxseSB1bmlxdWUgSUQgb2YgdGhlIHBhcmVudCdzIHdvcmxkIHRyYW5zZm9ybVxuICAgICAgICAgKiB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgY3VycmVudCB3b3JsZCB0cmFuc2Zvcm1hdGlvbiBtYXRyaXguXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcGFyZW50SUQgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIGEgdmFsdWUgY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgb25DaGFuZ2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fbG9jYWxJRCsrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBza2V3IG9yIHRoZSByb3RhdGlvbiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCB1cGRhdGVTa2V3KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuX2N4ID0gTWF0aC5jb3ModGhpcy5fcm90YXRpb24gKyB0aGlzLnNrZXcueSk7XG4gICAgICAgIHRoaXMuX3N4ID0gTWF0aC5zaW4odGhpcy5fcm90YXRpb24gKyB0aGlzLnNrZXcueSk7XG4gICAgICAgIHRoaXMuX2N5ID0gLU1hdGguc2luKHRoaXMuX3JvdGF0aW9uIC0gdGhpcy5za2V3LngpOyAvLyBjb3MsIGFkZGVkIFBJLzJcbiAgICAgICAgdGhpcy5fc3kgPSBNYXRoLmNvcyh0aGlzLl9yb3RhdGlvbiAtIHRoaXMuc2tldy54KTsgLy8gc2luLCBhZGRlZCBQSS8yXG5cbiAgICAgICAgdGhpcy5fbG9jYWxJRCsrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGxvY2FsIHRyYW5zZm9ybWF0aW9uIG1hdHJpeC5cbiAgICAgKi9cbiAgICB1cGRhdGVMb2NhbFRyYW5zZm9ybSgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBsdCA9IHRoaXMubG9jYWxUcmFuc2Zvcm07XG5cbiAgICAgICAgaWYgKHRoaXMuX2xvY2FsSUQgIT09IHRoaXMuX2N1cnJlbnRMb2NhbElEKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIG1hdHJpeCB2YWx1ZXMgb2YgdGhlIGRpc3BsYXlvYmplY3QgYmFzZWQgb24gaXRzIHRyYW5zZm9ybSBwcm9wZXJ0aWVzLi5cbiAgICAgICAgICAgIGx0LmEgPSB0aGlzLl9jeCAqIHRoaXMuc2NhbGUueDtcbiAgICAgICAgICAgIGx0LmIgPSB0aGlzLl9zeCAqIHRoaXMuc2NhbGUueDtcbiAgICAgICAgICAgIGx0LmMgPSB0aGlzLl9jeSAqIHRoaXMuc2NhbGUueTtcbiAgICAgICAgICAgIGx0LmQgPSB0aGlzLl9zeSAqIHRoaXMuc2NhbGUueTtcblxuICAgICAgICAgICAgbHQudHggPSB0aGlzLnBvc2l0aW9uLnggLSAoKHRoaXMucGl2b3QueCAqIGx0LmEpICsgKHRoaXMucGl2b3QueSAqIGx0LmMpKTtcbiAgICAgICAgICAgIGx0LnR5ID0gdGhpcy5wb3NpdGlvbi55IC0gKCh0aGlzLnBpdm90LnggKiBsdC5iKSArICh0aGlzLnBpdm90LnkgKiBsdC5kKSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50TG9jYWxJRCA9IHRoaXMuX2xvY2FsSUQ7XG5cbiAgICAgICAgICAgIC8vIGZvcmNlIGFuIHVwZGF0ZS4uXG4gICAgICAgICAgICB0aGlzLl9wYXJlbnRJRCA9IC0xO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgbG9jYWwgYW5kIHRoZSB3b3JsZCB0cmFuc2Zvcm1hdGlvbiBtYXRyaWNlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5UcmFuc2Zvcm19IHBhcmVudFRyYW5zZm9ybSAtIFRoZSBwYXJlbnQgdHJhbnNmb3JtXG4gICAgICovXG4gICAgdXBkYXRlVHJhbnNmb3JtKHBhcmVudFRyYW5zZm9ybTogVHJhbnNmb3JtKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbHQgPSB0aGlzLmxvY2FsVHJhbnNmb3JtO1xuXG4gICAgICAgIGlmICh0aGlzLl9sb2NhbElEICE9PSB0aGlzLl9jdXJyZW50TG9jYWxJRClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBtYXRyaXggdmFsdWVzIG9mIHRoZSBkaXNwbGF5b2JqZWN0IGJhc2VkIG9uIGl0cyB0cmFuc2Zvcm0gcHJvcGVydGllcy4uXG4gICAgICAgICAgICBsdC5hID0gdGhpcy5fY3ggKiB0aGlzLnNjYWxlLng7XG4gICAgICAgICAgICBsdC5iID0gdGhpcy5fc3ggKiB0aGlzLnNjYWxlLng7XG4gICAgICAgICAgICBsdC5jID0gdGhpcy5fY3kgKiB0aGlzLnNjYWxlLnk7XG4gICAgICAgICAgICBsdC5kID0gdGhpcy5fc3kgKiB0aGlzLnNjYWxlLnk7XG5cbiAgICAgICAgICAgIGx0LnR4ID0gdGhpcy5wb3NpdGlvbi54IC0gKCh0aGlzLnBpdm90LnggKiBsdC5hKSArICh0aGlzLnBpdm90LnkgKiBsdC5jKSk7XG4gICAgICAgICAgICBsdC50eSA9IHRoaXMucG9zaXRpb24ueSAtICgodGhpcy5waXZvdC54ICogbHQuYikgKyAodGhpcy5waXZvdC55ICogbHQuZCkpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudExvY2FsSUQgPSB0aGlzLl9sb2NhbElEO1xuXG4gICAgICAgICAgICAvLyBmb3JjZSBhbiB1cGRhdGUuLlxuICAgICAgICAgICAgdGhpcy5fcGFyZW50SUQgPSAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9wYXJlbnRJRCAhPT0gcGFyZW50VHJhbnNmb3JtLl93b3JsZElEKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjb25jYXQgdGhlIHBhcmVudCBtYXRyaXggd2l0aCB0aGUgb2JqZWN0cyB0cmFuc2Zvcm0uXG4gICAgICAgICAgICBjb25zdCBwdCA9IHBhcmVudFRyYW5zZm9ybS53b3JsZFRyYW5zZm9ybTtcbiAgICAgICAgICAgIGNvbnN0IHd0ID0gdGhpcy53b3JsZFRyYW5zZm9ybTtcblxuICAgICAgICAgICAgd3QuYSA9IChsdC5hICogcHQuYSkgKyAobHQuYiAqIHB0LmMpO1xuICAgICAgICAgICAgd3QuYiA9IChsdC5hICogcHQuYikgKyAobHQuYiAqIHB0LmQpO1xuICAgICAgICAgICAgd3QuYyA9IChsdC5jICogcHQuYSkgKyAobHQuZCAqIHB0LmMpO1xuICAgICAgICAgICAgd3QuZCA9IChsdC5jICogcHQuYikgKyAobHQuZCAqIHB0LmQpO1xuICAgICAgICAgICAgd3QudHggPSAobHQudHggKiBwdC5hKSArIChsdC50eSAqIHB0LmMpICsgcHQudHg7XG4gICAgICAgICAgICB3dC50eSA9IChsdC50eCAqIHB0LmIpICsgKGx0LnR5ICogcHQuZCkgKyBwdC50eTtcblxuICAgICAgICAgICAgdGhpcy5fcGFyZW50SUQgPSBwYXJlbnRUcmFuc2Zvcm0uX3dvcmxkSUQ7XG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgaWQgb2YgdGhlIHRyYW5zZm9ybS4uXG4gICAgICAgICAgICB0aGlzLl93b3JsZElEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWNvbXBvc2VzIGEgbWF0cml4IGFuZCBzZXRzIHRoZSB0cmFuc2Zvcm1zIHByb3BlcnRpZXMgYmFzZWQgb24gaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBUaGUgbWF0cml4IHRvIGRlY29tcG9zZVxuICAgICAqL1xuICAgIHNldEZyb21NYXRyaXgobWF0cml4OiBNYXRyaXgpOiB2b2lkXG4gICAge1xuICAgICAgICBtYXRyaXguZGVjb21wb3NlKHRoaXMpO1xuICAgICAgICB0aGlzLl9sb2NhbElEKys7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHJvdGF0aW9uIG9mIHRoZSBvYmplY3QgaW4gcmFkaWFucy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgcm90YXRpb24oKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm90YXRpb247XG4gICAgfVxuXG4gICAgc2V0IHJvdGF0aW9uKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fcm90YXRpb24gIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9yb3RhdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTa2V3KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLyoqXG4gKiBNYXRoIGNsYXNzZXMgYW5kIHV0aWxpdGllcyBtaXhlZCBpbnRvIFBJWEkgbmFtZXNwYWNlLlxuICpcbiAqIEBsZW5kcyBQSVhJXG4gKi9cblxuaW1wb3J0IHsgQ2lyY2xlIH0gZnJvbSAnLi9zaGFwZXMvQ2lyY2xlJztcbmltcG9ydCB7IEVsbGlwc2UgfSBmcm9tICcuL3NoYXBlcy9FbGxpcHNlJztcbmltcG9ydCB7IFBvbHlnb24gfSBmcm9tICcuL3NoYXBlcy9Qb2x5Z29uJztcbmltcG9ydCB7IFJlY3RhbmdsZSB9IGZyb20gJy4vc2hhcGVzL1JlY3RhbmdsZSc7XG5pbXBvcnQgeyBSb3VuZGVkUmVjdGFuZ2xlIH0gZnJvbSAnLi9zaGFwZXMvUm91bmRlZFJlY3RhbmdsZSc7XG5cbmV4cG9ydCAqIGZyb20gJy4vSVBvaW50RGF0YSc7XG5leHBvcnQgKiBmcm9tICcuL0lQb2ludCc7XG5leHBvcnQgKiBmcm9tICcuL1BvaW50JztcbmV4cG9ydCAqIGZyb20gJy4vT2JzZXJ2YWJsZVBvaW50JztcbmV4cG9ydCAqIGZyb20gJy4vTWF0cml4JztcbmV4cG9ydCAqIGZyb20gJy4vZ3JvdXBEOCc7XG5leHBvcnQgKiBmcm9tICcuL1RyYW5zZm9ybSc7XG5cbmV4cG9ydCB7IENpcmNsZSB9O1xuZXhwb3J0IHsgRWxsaXBzZSB9O1xuZXhwb3J0IHsgUG9seWdvbiB9O1xuZXhwb3J0IHsgUmVjdGFuZ2xlIH07XG5leHBvcnQgeyBSb3VuZGVkUmVjdGFuZ2xlIH07XG5cbmV4cG9ydCAqIGZyb20gJy4vY29uc3QnO1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBDb21wbGV4IHNoYXBlIHR5cGVcbiAqXG4gKi9cbmV4cG9ydCB0eXBlIElTaGFwZSA9IENpcmNsZSB8IEVsbGlwc2UgfCBQb2x5Z29uIHwgUmVjdGFuZ2xlIHwgUm91bmRlZFJlY3RhbmdsZTtcblxuZXhwb3J0IGludGVyZmFjZSBJU2l6ZVxue1xuICAgIHdpZHRoOiBudW1iZXI7XG4gICAgaGVpZ2h0OiBudW1iZXI7XG59XG4iLCAiaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5cbi8qKlxuICogU2V0cyB0aGUgZGVmYXVsdCB2YWx1ZSBmb3IgdGhlIGNvbnRhaW5lciBwcm9wZXJ0eSAnc29ydGFibGVDaGlsZHJlbicuXG4gKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGNvbnRhaW5lciB3aWxsIHNvcnQgaXRzIGNoaWxkcmVuIGJ5IHpJbmRleCB2YWx1ZVxuICogd2hlbiB1cGRhdGVUcmFuc2Zvcm0oKSBpcyBjYWxsZWQsIG9yIG1hbnVhbGx5IGlmIHNvcnRDaGlsZHJlbigpIGlzIGNhbGxlZC5cbiAqXG4gKiBUaGlzIGFjdHVhbGx5IGNoYW5nZXMgdGhlIG9yZGVyIG9mIGVsZW1lbnRzIGluIHRoZSBhcnJheSwgc28gc2hvdWxkIGJlIHRyZWF0ZWRcbiAqIGFzIGEgYmFzaWMgc29sdXRpb24gdGhhdCBpcyBub3QgcGVyZm9ybWFudCBjb21wYXJlZCB0byBvdGhlciBzb2x1dGlvbnMsXG4gKiBzdWNoIGFzIEBsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9waXhpanMvcGl4aS1kaXNwbGF5XG4gKlxuICogQWxzbyBiZSBhd2FyZSBvZiB0aGF0IHRoaXMgbWF5IG5vdCB3b3JrIG5pY2VseSB3aXRoIHRoZSBhZGRDaGlsZEF0KCkgZnVuY3Rpb24sXG4gKiBhcyB0aGUgekluZGV4IHNvcnRpbmcgbWF5IGNhdXNlIHRoZSBjaGlsZCB0byBhdXRvbWF0aWNhbGx5IHNvcnRlZCB0byBhbm90aGVyIHBvc2l0aW9uLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBjb25zdGFudFxuICogQG5hbWUgU09SVEFCTEVfQ0hJTERSRU5cbiAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gKiBAdHlwZSB7Ym9vbGVhbn1cbiAqIEBkZWZhdWx0IGZhbHNlXG4gKi9cbnNldHRpbmdzLlNPUlRBQkxFX0NISUxEUkVOID0gZmFsc2U7XG5cbmV4cG9ydCB7IHNldHRpbmdzIH07XG4iLCAiaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmltcG9ydCB0eXBlIHsgSVBvaW50RGF0YSwgVHJhbnNmb3JtLCBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcblxuLyoqXG4gKiAnQnVpbGRlcicgcGF0dGVybiBmb3IgYm91bmRzIHJlY3RhbmdsZXMuXG4gKlxuICogVGhpcyBjb3VsZCBiZSBjYWxsZWQgYW4gQXhpcy1BbGlnbmVkIEJvdW5kaW5nIEJveC5cbiAqIEl0IGlzIG5vdCBhbiBhY3R1YWwgc2hhcGUuIEl0IGlzIGEgbXV0YWJsZSB0aGluZzsgbm8gJ0VNUFRZJyBvciB0aG9zZSBraW5kIG9mIHByb2JsZW1zLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEJvdW5kc1xue1xuICAgIHB1YmxpYyBtaW5YOiBudW1iZXI7XG4gICAgcHVibGljIG1pblk6IG51bWJlcjtcbiAgICBwdWJsaWMgbWF4WDogbnVtYmVyO1xuICAgIHB1YmxpYyBtYXhZOiBudW1iZXI7XG4gICAgcHVibGljIHJlY3Q6IFJlY3RhbmdsZTtcbiAgICBwdWJsaWMgdXBkYXRlSUQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKClcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWluWCA9IEluZmluaXR5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWluWSA9IEluZmluaXR5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWF4WCA9IC1JbmZpbml0eTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1heFkgPSAtSW5maW5pdHk7XG5cbiAgICAgICAgdGhpcy5yZWN0ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSXQgaXMgdXBkYXRlZCB0byBfYm91bmRzSUQgb2YgY29ycmVzcG9uZGluZyBvYmplY3QgdG8ga2VlcCBib3VuZHMgaW4gc3luYyB3aXRoIGNvbnRlbnQuXG4gICAgICAgICAqIFVwZGF0ZWQgZnJvbSBvdXRzaWRlLCB0aHVzIHB1YmxpYyBtb2RpZmllci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHVibGljXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVwZGF0ZUlEID0gLTE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGJvdW5kcyBhcmUgZW1wdHkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIGVtcHR5LlxuICAgICAqL1xuICAgIGlzRW1wdHkoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWluWCA+IHRoaXMubWF4WCB8fCB0aGlzLm1pblkgPiB0aGlzLm1heFk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBib3VuZHMgYW5kIHJlc2V0cy5cbiAgICAgKlxuICAgICAqL1xuICAgIGNsZWFyKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMubWluWCA9IEluZmluaXR5O1xuICAgICAgICB0aGlzLm1pblkgPSBJbmZpbml0eTtcbiAgICAgICAgdGhpcy5tYXhYID0gLUluZmluaXR5O1xuICAgICAgICB0aGlzLm1heFkgPSAtSW5maW5pdHk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FuIHJldHVybiBSZWN0YW5nbGUuRU1QVFkgY29uc3RhbnQsIGVpdGhlciBjb25zdHJ1Y3QgbmV3IHJlY3RhbmdsZSwgZWl0aGVyIHVzZSB5b3VyIHJlY3RhbmdsZVxuICAgICAqIEl0IGlzIG5vdCBndWFyYW50ZWVkIHRoYXQgaXQgd2lsbCByZXR1cm4gdGVtcFJlY3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IHJlY3QgLSB0ZW1wb3Jhcnkgb2JqZWN0IHdpbGwgYmUgdXNlZCBpZiBBQUJCIGlzIG5vdCBlbXB0eVxuICAgICAqIEByZXR1cm5zIHtQSVhJLlJlY3RhbmdsZX0gQSByZWN0YW5nbGUgb2YgdGhlIGJvdW5kc1xuICAgICAqL1xuICAgIGdldFJlY3RhbmdsZShyZWN0PzogUmVjdGFuZ2xlKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICBpZiAodGhpcy5taW5YID4gdGhpcy5tYXhYIHx8IHRoaXMubWluWSA+IHRoaXMubWF4WSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIFJlY3RhbmdsZS5FTVBUWTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlY3QgPSByZWN0IHx8IG5ldyBSZWN0YW5nbGUoMCwgMCwgMSwgMSk7XG5cbiAgICAgICAgcmVjdC54ID0gdGhpcy5taW5YO1xuICAgICAgICByZWN0LnkgPSB0aGlzLm1pblk7XG4gICAgICAgIHJlY3Qud2lkdGggPSB0aGlzLm1heFggLSB0aGlzLm1pblg7XG4gICAgICAgIHJlY3QuaGVpZ2h0ID0gdGhpcy5tYXhZIC0gdGhpcy5taW5ZO1xuXG4gICAgICAgIHJldHVybiByZWN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gc2hvdWxkIGJlIGlubGluZWQgd2hlbiBpdHMgcG9zc2libGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuSVBvaW50RGF0YX0gcG9pbnQgLSBUaGUgcG9pbnQgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFBvaW50KHBvaW50OiBJUG9pbnREYXRhKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5taW5YID0gTWF0aC5taW4odGhpcy5taW5YLCBwb2ludC54KTtcbiAgICAgICAgdGhpcy5tYXhYID0gTWF0aC5tYXgodGhpcy5tYXhYLCBwb2ludC54KTtcbiAgICAgICAgdGhpcy5taW5ZID0gTWF0aC5taW4odGhpcy5taW5ZLCBwb2ludC55KTtcbiAgICAgICAgdGhpcy5tYXhZID0gTWF0aC5tYXgodGhpcy5tYXhZLCBwb2ludC55KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgcXVhZCwgbm90IHRyYW5zZm9ybWVkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gdmVydGljZXMgLSBUaGUgdmVydHMgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFF1YWQodmVydGljZXM6IEZsb2F0MzJBcnJheSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCBtaW5YID0gdGhpcy5taW5YO1xuICAgICAgICBsZXQgbWluWSA9IHRoaXMubWluWTtcbiAgICAgICAgbGV0IG1heFggPSB0aGlzLm1heFg7XG4gICAgICAgIGxldCBtYXhZID0gdGhpcy5tYXhZO1xuXG4gICAgICAgIGxldCB4ID0gdmVydGljZXNbMF07XG4gICAgICAgIGxldCB5ID0gdmVydGljZXNbMV07XG5cbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgeCA9IHZlcnRpY2VzWzJdO1xuICAgICAgICB5ID0gdmVydGljZXNbM107XG4gICAgICAgIG1pblggPSB4IDwgbWluWCA/IHggOiBtaW5YO1xuICAgICAgICBtaW5ZID0geSA8IG1pblkgPyB5IDogbWluWTtcbiAgICAgICAgbWF4WCA9IHggPiBtYXhYID8geCA6IG1heFg7XG4gICAgICAgIG1heFkgPSB5ID4gbWF4WSA/IHkgOiBtYXhZO1xuXG4gICAgICAgIHggPSB2ZXJ0aWNlc1s0XTtcbiAgICAgICAgeSA9IHZlcnRpY2VzWzVdO1xuICAgICAgICBtaW5YID0geCA8IG1pblggPyB4IDogbWluWDtcbiAgICAgICAgbWluWSA9IHkgPCBtaW5ZID8geSA6IG1pblk7XG4gICAgICAgIG1heFggPSB4ID4gbWF4WCA/IHggOiBtYXhYO1xuICAgICAgICBtYXhZID0geSA+IG1heFkgPyB5IDogbWF4WTtcblxuICAgICAgICB4ID0gdmVydGljZXNbNl07XG4gICAgICAgIHkgPSB2ZXJ0aWNlc1s3XTtcbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgdGhpcy5taW5YID0gbWluWDtcbiAgICAgICAgdGhpcy5taW5ZID0gbWluWTtcbiAgICAgICAgdGhpcy5tYXhYID0gbWF4WDtcbiAgICAgICAgdGhpcy5tYXhZID0gbWF4WTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHNwcml0ZSBmcmFtZSwgdHJhbnNmb3JtZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuVHJhbnNmb3JtfSB0cmFuc2Zvcm0gLSB0cmFuc2Zvcm0gdG8gYXBwbHlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geDAgLSBsZWZ0IFggb2YgZnJhbWVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geTAgLSB0b3AgWSBvZiBmcmFtZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MSAtIHJpZ2h0IFggb2YgZnJhbWVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geTEgLSBib3R0b20gWSBvZiBmcmFtZVxuICAgICAqL1xuICAgIGFkZEZyYW1lKHRyYW5zZm9ybTogVHJhbnNmb3JtLCB4MDogbnVtYmVyLCB5MDogbnVtYmVyLCB4MTogbnVtYmVyLCB5MTogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5hZGRGcmFtZU1hdHJpeCh0cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm0sIHgwLCB5MCwgeDEsIHkxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHNwcml0ZSBmcmFtZSwgbXVsdGlwbGllZCBieSBtYXRyaXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXRyaXh9IG1hdHJpeCAtIG1hdHJpeCB0byBhcHBseVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MCAtIGxlZnQgWCBvZiBmcmFtZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MCAtIHRvcCBZIG9mIGZyYW1lXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHgxIC0gcmlnaHQgWCBvZiBmcmFtZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MSAtIGJvdHRvbSBZIG9mIGZyYW1lXG4gICAgICovXG4gICAgYWRkRnJhbWVNYXRyaXgobWF0cml4OiBNYXRyaXgsIHgwOiBudW1iZXIsIHkwOiBudW1iZXIsIHgxOiBudW1iZXIsIHkxOiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBhID0gbWF0cml4LmE7XG4gICAgICAgIGNvbnN0IGIgPSBtYXRyaXguYjtcbiAgICAgICAgY29uc3QgYyA9IG1hdHJpeC5jO1xuICAgICAgICBjb25zdCBkID0gbWF0cml4LmQ7XG4gICAgICAgIGNvbnN0IHR4ID0gbWF0cml4LnR4O1xuICAgICAgICBjb25zdCB0eSA9IG1hdHJpeC50eTtcblxuICAgICAgICBsZXQgbWluWCA9IHRoaXMubWluWDtcbiAgICAgICAgbGV0IG1pblkgPSB0aGlzLm1pblk7XG4gICAgICAgIGxldCBtYXhYID0gdGhpcy5tYXhYO1xuICAgICAgICBsZXQgbWF4WSA9IHRoaXMubWF4WTtcblxuICAgICAgICBsZXQgeCA9IChhICogeDApICsgKGMgKiB5MCkgKyB0eDtcbiAgICAgICAgbGV0IHkgPSAoYiAqIHgwKSArIChkICogeTApICsgdHk7XG5cbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgeCA9IChhICogeDEpICsgKGMgKiB5MCkgKyB0eDtcbiAgICAgICAgeSA9IChiICogeDEpICsgKGQgKiB5MCkgKyB0eTtcbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgeCA9IChhICogeDApICsgKGMgKiB5MSkgKyB0eDtcbiAgICAgICAgeSA9IChiICogeDApICsgKGQgKiB5MSkgKyB0eTtcbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgeCA9IChhICogeDEpICsgKGMgKiB5MSkgKyB0eDtcbiAgICAgICAgeSA9IChiICogeDEpICsgKGQgKiB5MSkgKyB0eTtcbiAgICAgICAgbWluWCA9IHggPCBtaW5YID8geCA6IG1pblg7XG4gICAgICAgIG1pblkgPSB5IDwgbWluWSA/IHkgOiBtaW5ZO1xuICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgbWF4WSA9IHkgPiBtYXhZID8geSA6IG1heFk7XG5cbiAgICAgICAgdGhpcy5taW5YID0gbWluWDtcbiAgICAgICAgdGhpcy5taW5ZID0gbWluWTtcbiAgICAgICAgdGhpcy5tYXhYID0gbWF4WDtcbiAgICAgICAgdGhpcy5tYXhZID0gbWF4WTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHNjcmVlbiB2ZXJ0aWNlcyBmcm9tIGFycmF5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gdmVydGV4RGF0YSAtIGNhbGN1bGF0ZWQgdmVydGljZXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYmVnaW5PZmZzZXQgLSBiZWdpbiBvZmZzZXRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kT2Zmc2V0IC0gZW5kIG9mZnNldCwgZXhjbHVkZWRcbiAgICAgKi9cbiAgICBhZGRWZXJ0ZXhEYXRhKHZlcnRleERhdGE6IEZsb2F0MzJBcnJheSwgYmVnaW5PZmZzZXQ6IG51bWJlciwgZW5kT2Zmc2V0OiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBsZXQgbWluWCA9IHRoaXMubWluWDtcbiAgICAgICAgbGV0IG1pblkgPSB0aGlzLm1pblk7XG4gICAgICAgIGxldCBtYXhYID0gdGhpcy5tYXhYO1xuICAgICAgICBsZXQgbWF4WSA9IHRoaXMubWF4WTtcblxuICAgICAgICBmb3IgKGxldCBpID0gYmVnaW5PZmZzZXQ7IGkgPCBlbmRPZmZzZXQ7IGkgKz0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeCA9IHZlcnRleERhdGFbaV07XG4gICAgICAgICAgICBjb25zdCB5ID0gdmVydGV4RGF0YVtpICsgMV07XG5cbiAgICAgICAgICAgIG1pblggPSB4IDwgbWluWCA/IHggOiBtaW5YO1xuICAgICAgICAgICAgbWluWSA9IHkgPCBtaW5ZID8geSA6IG1pblk7XG4gICAgICAgICAgICBtYXhYID0geCA+IG1heFggPyB4IDogbWF4WDtcbiAgICAgICAgICAgIG1heFkgPSB5ID4gbWF4WSA/IHkgOiBtYXhZO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5taW5YID0gbWluWDtcbiAgICAgICAgdGhpcy5taW5ZID0gbWluWTtcbiAgICAgICAgdGhpcy5tYXhYID0gbWF4WDtcbiAgICAgICAgdGhpcy5tYXhZID0gbWF4WTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXJyYXkgb2YgbWVzaCB2ZXJ0aWNlc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlRyYW5zZm9ybX0gdHJhbnNmb3JtIC0gbWVzaCB0cmFuc2Zvcm1cbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gdmVydGljZXMgLSBtZXNoIGNvb3JkaW5hdGVzIGluIGFycmF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJlZ2luT2Zmc2V0IC0gYmVnaW4gb2Zmc2V0XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZE9mZnNldCAtIGVuZCBvZmZzZXQsIGV4Y2x1ZGVkXG4gICAgICovXG4gICAgYWRkVmVydGljZXModHJhbnNmb3JtOiBUcmFuc2Zvcm0sIHZlcnRpY2VzOiBGbG9hdDMyQXJyYXksIGJlZ2luT2Zmc2V0OiBudW1iZXIsIGVuZE9mZnNldDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5hZGRWZXJ0aWNlc01hdHJpeCh0cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm0sIHZlcnRpY2VzLCBiZWdpbk9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYW4gYXJyYXkgb2YgbWVzaCB2ZXJ0aWNlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXRyaXh9IG1hdHJpeCAtIG1lc2ggbWF0cml4XG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl9IHZlcnRpY2VzIC0gbWVzaCBjb29yZGluYXRlcyBpbiBhcnJheVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiZWdpbk9mZnNldCAtIGJlZ2luIG9mZnNldFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmRPZmZzZXQgLSBlbmQgb2Zmc2V0LCBleGNsdWRlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcGFkWD0wXSAtIHggcGFkZGluZ1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcGFkWT0wXSAtIHkgcGFkZGluZ1xuICAgICAqL1xuICAgIGFkZFZlcnRpY2VzTWF0cml4KG1hdHJpeDogTWF0cml4LCB2ZXJ0aWNlczogRmxvYXQzMkFycmF5LCBiZWdpbk9mZnNldDogbnVtYmVyLFxuICAgICAgICBlbmRPZmZzZXQ6IG51bWJlciwgcGFkWCA9IDAsIHBhZFkgPSBwYWRYKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgYSA9IG1hdHJpeC5hO1xuICAgICAgICBjb25zdCBiID0gbWF0cml4LmI7XG4gICAgICAgIGNvbnN0IGMgPSBtYXRyaXguYztcbiAgICAgICAgY29uc3QgZCA9IG1hdHJpeC5kO1xuICAgICAgICBjb25zdCB0eCA9IG1hdHJpeC50eDtcbiAgICAgICAgY29uc3QgdHkgPSBtYXRyaXgudHk7XG5cbiAgICAgICAgbGV0IG1pblggPSB0aGlzLm1pblg7XG4gICAgICAgIGxldCBtaW5ZID0gdGhpcy5taW5ZO1xuICAgICAgICBsZXQgbWF4WCA9IHRoaXMubWF4WDtcbiAgICAgICAgbGV0IG1heFkgPSB0aGlzLm1heFk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IGJlZ2luT2Zmc2V0OyBpIDwgZW5kT2Zmc2V0OyBpICs9IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHJhd1ggPSB2ZXJ0aWNlc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHJhd1kgPSB2ZXJ0aWNlc1tpICsgMV07XG4gICAgICAgICAgICBjb25zdCB4ID0gKGEgKiByYXdYKSArIChjICogcmF3WSkgKyB0eDtcbiAgICAgICAgICAgIGNvbnN0IHkgPSAoZCAqIHJhd1kpICsgKGIgKiByYXdYKSArIHR5O1xuXG4gICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgeCAtIHBhZFgpO1xuICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHggKyBwYWRYKTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB5IC0gcGFkWSk7XG4gICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgeSArIHBhZFkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5taW5YID0gbWluWDtcbiAgICAgICAgdGhpcy5taW5ZID0gbWluWTtcbiAgICAgICAgdGhpcy5tYXhYID0gbWF4WDtcbiAgICAgICAgdGhpcy5tYXhZID0gbWF4WTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIG90aGVyIEJvdW5kcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5Cb3VuZHN9IGJvdW5kcyAtIFRoZSBCb3VuZHMgdG8gYmUgYWRkZWRcbiAgICAgKi9cbiAgICBhZGRCb3VuZHMoYm91bmRzOiBCb3VuZHMpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtaW5YID0gdGhpcy5taW5YO1xuICAgICAgICBjb25zdCBtaW5ZID0gdGhpcy5taW5ZO1xuICAgICAgICBjb25zdCBtYXhYID0gdGhpcy5tYXhYO1xuICAgICAgICBjb25zdCBtYXhZID0gdGhpcy5tYXhZO1xuXG4gICAgICAgIHRoaXMubWluWCA9IGJvdW5kcy5taW5YIDwgbWluWCA/IGJvdW5kcy5taW5YIDogbWluWDtcbiAgICAgICAgdGhpcy5taW5ZID0gYm91bmRzLm1pblkgPCBtaW5ZID8gYm91bmRzLm1pblkgOiBtaW5ZO1xuICAgICAgICB0aGlzLm1heFggPSBib3VuZHMubWF4WCA+IG1heFggPyBib3VuZHMubWF4WCA6IG1heFg7XG4gICAgICAgIHRoaXMubWF4WSA9IGJvdW5kcy5tYXhZID4gbWF4WSA/IGJvdW5kcy5tYXhZIDogbWF4WTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIG90aGVyIEJvdW5kcywgbWFza2VkIHdpdGggQm91bmRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJvdW5kc30gYm91bmRzIC0gVGhlIEJvdW5kcyB0byBiZSBhZGRlZC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuQm91bmRzfSBtYXNrIC0gVE9ET1xuICAgICAqL1xuICAgIGFkZEJvdW5kc01hc2soYm91bmRzOiBCb3VuZHMsIG1hc2s6IEJvdW5kcyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IF9taW5YID0gYm91bmRzLm1pblggPiBtYXNrLm1pblggPyBib3VuZHMubWluWCA6IG1hc2subWluWDtcbiAgICAgICAgY29uc3QgX21pblkgPSBib3VuZHMubWluWSA+IG1hc2subWluWSA/IGJvdW5kcy5taW5ZIDogbWFzay5taW5ZO1xuICAgICAgICBjb25zdCBfbWF4WCA9IGJvdW5kcy5tYXhYIDwgbWFzay5tYXhYID8gYm91bmRzLm1heFggOiBtYXNrLm1heFg7XG4gICAgICAgIGNvbnN0IF9tYXhZID0gYm91bmRzLm1heFkgPCBtYXNrLm1heFkgPyBib3VuZHMubWF4WSA6IG1hc2subWF4WTtcblxuICAgICAgICBpZiAoX21pblggPD0gX21heFggJiYgX21pblkgPD0gX21heFkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IG1pblggPSB0aGlzLm1pblg7XG4gICAgICAgICAgICBjb25zdCBtaW5ZID0gdGhpcy5taW5ZO1xuICAgICAgICAgICAgY29uc3QgbWF4WCA9IHRoaXMubWF4WDtcbiAgICAgICAgICAgIGNvbnN0IG1heFkgPSB0aGlzLm1heFk7XG5cbiAgICAgICAgICAgIHRoaXMubWluWCA9IF9taW5YIDwgbWluWCA/IF9taW5YIDogbWluWDtcbiAgICAgICAgICAgIHRoaXMubWluWSA9IF9taW5ZIDwgbWluWSA/IF9taW5ZIDogbWluWTtcbiAgICAgICAgICAgIHRoaXMubWF4WCA9IF9tYXhYID4gbWF4WCA/IF9tYXhYIDogbWF4WDtcbiAgICAgICAgICAgIHRoaXMubWF4WSA9IF9tYXhZID4gbWF4WSA/IF9tYXhZIDogbWF4WTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgb3RoZXIgQm91bmRzLCBtdWx0aXBsaWVkIGJ5IG1hdHJpeC4gQm91bmRzIHNob3VsZG4ndCBiZSBlbXB0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5Cb3VuZHN9IGJvdW5kcyAtIG90aGVyIGJvdW5kc1xuICAgICAqIEBwYXJhbSB7UElYSS5NYXRyaXh9IG1hdHJpeCAtIG11bHRpcGxpY2F0b3JcbiAgICAgKi9cbiAgICBhZGRCb3VuZHNNYXRyaXgoYm91bmRzOiBCb3VuZHMsIG1hdHJpeDogTWF0cml4KTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5hZGRGcmFtZU1hdHJpeChtYXRyaXgsIGJvdW5kcy5taW5YLCBib3VuZHMubWluWSwgYm91bmRzLm1heFgsIGJvdW5kcy5tYXhZKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIG90aGVyIEJvdW5kcywgbWFza2VkIHdpdGggUmVjdGFuZ2xlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJvdW5kc30gYm91bmRzIC0gVE9ET1xuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IGFyZWEgLSBUT0RPXG4gICAgICovXG4gICAgYWRkQm91bmRzQXJlYShib3VuZHM6IEJvdW5kcywgYXJlYTogUmVjdGFuZ2xlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgX21pblggPSBib3VuZHMubWluWCA+IGFyZWEueCA/IGJvdW5kcy5taW5YIDogYXJlYS54O1xuICAgICAgICBjb25zdCBfbWluWSA9IGJvdW5kcy5taW5ZID4gYXJlYS55ID8gYm91bmRzLm1pblkgOiBhcmVhLnk7XG4gICAgICAgIGNvbnN0IF9tYXhYID0gYm91bmRzLm1heFggPCBhcmVhLnggKyBhcmVhLndpZHRoID8gYm91bmRzLm1heFggOiAoYXJlYS54ICsgYXJlYS53aWR0aCk7XG4gICAgICAgIGNvbnN0IF9tYXhZID0gYm91bmRzLm1heFkgPCBhcmVhLnkgKyBhcmVhLmhlaWdodCA/IGJvdW5kcy5tYXhZIDogKGFyZWEueSArIGFyZWEuaGVpZ2h0KTtcblxuICAgICAgICBpZiAoX21pblggPD0gX21heFggJiYgX21pblkgPD0gX21heFkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IG1pblggPSB0aGlzLm1pblg7XG4gICAgICAgICAgICBjb25zdCBtaW5ZID0gdGhpcy5taW5ZO1xuICAgICAgICAgICAgY29uc3QgbWF4WCA9IHRoaXMubWF4WDtcbiAgICAgICAgICAgIGNvbnN0IG1heFkgPSB0aGlzLm1heFk7XG5cbiAgICAgICAgICAgIHRoaXMubWluWCA9IF9taW5YIDwgbWluWCA/IF9taW5YIDogbWluWDtcbiAgICAgICAgICAgIHRoaXMubWluWSA9IF9taW5ZIDwgbWluWSA/IF9taW5ZIDogbWluWTtcbiAgICAgICAgICAgIHRoaXMubWF4WCA9IF9tYXhYID4gbWF4WCA/IF9tYXhYIDogbWF4WDtcbiAgICAgICAgICAgIHRoaXMubWF4WSA9IF9tYXhZID4gbWF4WSA/IF9tYXhZIDogbWF4WTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhZHMgYm91bmRzIG9iamVjdCwgbWFraW5nIGl0IGdyb3cgaW4gYWxsIGRpcmVjdGlvbnMuXG4gICAgICogSWYgcGFkZGluZ1kgaXMgb21pdHRlZCwgYm90aCBwYWRkaW5nWCBhbmQgcGFkZGluZ1kgd2lsbCBiZSBzZXQgdG8gcGFkZGluZ1guXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3BhZGRpbmdYPTBdIC0gVGhlIGhvcml6b250YWwgcGFkZGluZyBhbW91bnQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtwYWRkaW5nWT0wXSAtIFRoZSB2ZXJ0aWNhbCBwYWRkaW5nIGFtb3VudC5cbiAgICAgKi9cbiAgICBwYWQocGFkZGluZ1ggPSAwLCBwYWRkaW5nWSA9IHBhZGRpbmdYKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzRW1wdHkoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5taW5YIC09IHBhZGRpbmdYO1xuICAgICAgICAgICAgdGhpcy5tYXhYICs9IHBhZGRpbmdYO1xuICAgICAgICAgICAgdGhpcy5taW5ZIC09IHBhZGRpbmdZO1xuICAgICAgICAgICAgdGhpcy5tYXhZICs9IHBhZGRpbmdZO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBwYWRkZWQgZnJhbWUuICh4MCwgeTApIHNob3VsZCBiZSBzdHJpY3RseSBsZXNzIHRoYW4gKHgxLCB5MSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MCAtIGxlZnQgWCBvZiBmcmFtZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MCAtIHRvcCBZIG9mIGZyYW1lXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHgxIC0gcmlnaHQgWCBvZiBmcmFtZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MSAtIGJvdHRvbSBZIG9mIGZyYW1lXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhZFggLSBwYWRkaW5nIFhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcGFkWSAtIHBhZGRpbmcgWVxuICAgICAqL1xuICAgIGFkZEZyYW1lUGFkKHgwOiBudW1iZXIsIHkwOiBudW1iZXIsIHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHBhZFg6IG51bWJlciwgcGFkWTogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgeDAgLT0gcGFkWDtcbiAgICAgICAgeTAgLT0gcGFkWTtcbiAgICAgICAgeDEgKz0gcGFkWDtcbiAgICAgICAgeTEgKz0gcGFkWTtcblxuICAgICAgICB0aGlzLm1pblggPSB0aGlzLm1pblggPCB4MCA/IHRoaXMubWluWCA6IHgwO1xuICAgICAgICB0aGlzLm1heFggPSB0aGlzLm1heFggPiB4MSA/IHRoaXMubWF4WCA6IHgxO1xuICAgICAgICB0aGlzLm1pblkgPSB0aGlzLm1pblkgPCB5MCA/IHRoaXMubWluWSA6IHkwO1xuICAgICAgICB0aGlzLm1heFkgPSB0aGlzLm1heFkgPiB5MSA/IHRoaXMubWF4WSA6IHkxO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBERUdfVE9fUkFELCBNYXRyaXgsIFBvaW50LCBSQURfVE9fREVHLCBSZWN0YW5nbGUsIFRyYW5zZm9ybSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnLi9Db250YWluZXInO1xuaW1wb3J0IHsgQm91bmRzIH0gZnJvbSAnLi9Cb3VuZHMnO1xuXG5pbXBvcnQgdHlwZSB7IEZpbHRlciwgTWFza0RhdGEsIFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElQb2ludERhdGEsIE9ic2VydmFibGVQb2ludCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElEZXN0cm95T3B0aW9ucyB7XG4gICAgY2hpbGRyZW4/OiBib29sZWFuO1xuICAgIHRleHR1cmU/OiBib29sZWFuO1xuICAgIGJhc2VUZXh0dXJlPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEaXNwbGF5T2JqZWN0IGV4dGVuZHMgR2xvYmFsTWl4aW5zLkRpc3BsYXlPYmplY3QsIEV2ZW50RW1pdHRlciB7fVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBhbGwgb2JqZWN0cyB0aGF0IGFyZSByZW5kZXJlZCBvbiB0aGUgc2NyZWVuLlxuICpcbiAqIFRoaXMgaXMgYW4gYWJzdHJhY3QgY2xhc3MgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBvbiBpdHMgb3duOyByYXRoZXIgaXQgc2hvdWxkIGIgZSBleHRlbmRlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkudXRpbHMuRXZlbnRFbWl0dGVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRGlzcGxheU9iamVjdCBleHRlbmRzIEV2ZW50RW1pdHRlclxue1xuICAgIGFic3RyYWN0IHNvcnREaXJ0eTogYm9vbGVhbjtcblxuICAgIHB1YmxpYyBwYXJlbnQ6IERpc3BsYXlPYmplY3Q7XG4gICAgcHVibGljIHdvcmxkQWxwaGE6IG51bWJlcjtcbiAgICBwdWJsaWMgdHJhbnNmb3JtOiBUcmFuc2Zvcm07XG4gICAgcHVibGljIGFscGhhOiBudW1iZXI7XG4gICAgcHVibGljIHZpc2libGU6IGJvb2xlYW47XG4gICAgcHVibGljIHJlbmRlcmFibGU6IGJvb2xlYW47XG4gICAgcHVibGljIGZpbHRlckFyZWE6IFJlY3RhbmdsZTtcbiAgICBwdWJsaWMgZmlsdGVyczogRmlsdGVyW107XG4gICAgcHVibGljIGlzU3ByaXRlOiBib29sZWFuO1xuICAgIHB1YmxpYyBpc01hc2s6IGJvb2xlYW47XG4gICAgcHVibGljIF9sYXN0U29ydGVkSW5kZXg6IG51bWJlcjtcbiAgICBwdWJsaWMgX21hc2s6IENvbnRhaW5lcnxNYXNrRGF0YTtcbiAgICBwdWJsaWMgX2JvdW5kczogQm91bmRzO1xuICAgIHB1YmxpYyBfbG9jYWxCb3VuZHM6IEJvdW5kcztcblxuICAgIHByb3RlY3RlZCBfekluZGV4OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9lbmFibGVkRmlsdGVyczogRmlsdGVyW107XG4gICAgcHJvdGVjdGVkIF9ib3VuZHNJRDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfYm91bmRzUmVjdDogUmVjdGFuZ2xlO1xuICAgIHByb3RlY3RlZCBfbG9jYWxCb3VuZHNSZWN0OiBSZWN0YW5nbGU7XG4gICAgcHJvdGVjdGVkIF9kZXN0cm95ZWQ6IGJvb2xlYW47XG5cbiAgICBwcml2YXRlIHRlbXBEaXNwbGF5T2JqZWN0UGFyZW50OiBUZW1wb3JhcnlEaXNwbGF5T2JqZWN0O1xuICAgIHB1YmxpYyBkaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtOiAoKSA9PiB2b2lkO1xuXG4gICAgLyoqXG4gICAgICogTWl4ZXMgYWxsIGVudW1lcmFibGUgcHJvcGVydGllcyBhbmQgbWV0aG9kcyBmcm9tIGEgc291cmNlIG9iamVjdCB0byBEaXNwbGF5T2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2YgcHJvcGVydGllcyBhbmQgbWV0aG9kcyB0byBtaXggaW4uXG4gICAgICovXG4gICAgc3RhdGljIG1peGluKHNvdXJjZTogRGljdDxhbnk+KTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gaW4gRVM4L0VTMjAxNywgdGhpcyB3b3VsZCBiZSByZWFsbHkgZWFzeTpcbiAgICAgICAgLy8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoRGlzcGxheU9iamVjdC5wcm90b3R5cGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpO1xuXG4gICAgICAgIC8vIGdldCBhbGwgdGhlIGVudW1lcmFibGUgcHJvcGVydHkga2V5c1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcblxuICAgICAgICAvLyBsb29wIHRocm91Z2ggcHJvcGVydGllc1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IGtleXNbaV07XG5cbiAgICAgICAgICAgIC8vIFNldCB0aGUgcHJvcGVydHkgdXNpbmcgdGhlIHByb3BlcnR5IGRlc2NyaXB0b3IgLSB0aGlzIHdvcmtzIGZvciBhY2Nlc3NvcnMgYW5kIG5vcm1hbCB2YWx1ZSBwcm9wZXJ0aWVzXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXG4gICAgICAgICAgICAgICAgRGlzcGxheU9iamVjdC5wcm90b3R5cGUsXG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lLFxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBwcm9wZXJ0eU5hbWUpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLnRlbXBEaXNwbGF5T2JqZWN0UGFyZW50ID0gbnVsbDtcblxuICAgICAgICAvLyBUT0RPOiBuZWVkIHRvIGNyZWF0ZSBUcmFuc2Zvcm0gZnJvbSBmYWN0b3J5XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXb3JsZCB0cmFuc2Zvcm0gYW5kIGxvY2FsIHRyYW5zZm9ybSBvZiB0aGlzIG9iamVjdC5cbiAgICAgICAgICogVGhpcyB3aWxsIGJlY29tZSByZWFkLW9ubHkgbGF0ZXIsIHBsZWFzZSBkbyBub3QgYXNzaWduIGFueXRoaW5nIHRoZXJlIHVubGVzcyB5b3Uga25vdyB3aGF0IGFyZSB5b3UgZG9pbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVHJhbnNmb3JtfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBvcGFjaXR5IG9mIHRoZSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWxwaGEgPSAxO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdmlzaWJpbGl0eSBvZiB0aGUgb2JqZWN0LiBJZiBmYWxzZSB0aGUgb2JqZWN0IHdpbGwgbm90IGJlIGRyYXduLCBhbmRcbiAgICAgICAgICogdGhlIHVwZGF0ZVRyYW5zZm9ybSBmdW5jdGlvbiB3aWxsIG5vdCBiZSBjYWxsZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIE9ubHkgYWZmZWN0cyByZWN1cnNpdmUgY2FsbHMgZnJvbSBwYXJlbnQuIFlvdSBjYW4gYXNrIGZvciBib3VuZHMgb3IgY2FsbCB1cGRhdGVUcmFuc2Zvcm0gbWFudWFsbHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYW4gdGhpcyBvYmplY3QgYmUgcmVuZGVyZWQsIGlmIGZhbHNlIHRoZSBvYmplY3Qgd2lsbCBub3QgYmUgZHJhd24gYnV0IHRoZSB1cGRhdGVUcmFuc2Zvcm1cbiAgICAgICAgICogbWV0aG9kcyB3aWxsIHN0aWxsIGJlIGNhbGxlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogT25seSBhZmZlY3RzIHJlY3Vyc2l2ZSBjYWxscyBmcm9tIHBhcmVudC4gWW91IGNhbiBhc2sgZm9yIGJvdW5kcyBtYW51YWxseS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVuZGVyYWJsZSA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkaXNwbGF5IG9iamVjdCBjb250YWluZXIgdGhhdCBjb250YWlucyB0aGlzIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkNvbnRhaW5lcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG11bHRpcGxpZWQgYWxwaGEgb2YgdGhlIGRpc3BsYXlPYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndvcmxkQWxwaGEgPSAxO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGljaCBpbmRleCBpbiB0aGUgY2hpbGRyZW4gYXJyYXkgdGhlIGRpc3BsYXkgY29tcG9uZW50IHdhcyBiZWZvcmUgdGhlIHByZXZpb3VzIHpJbmRleCBzb3J0LlxuICAgICAgICAgKiBVc2VkIGJ5IGNvbnRhaW5lcnMgdG8gaGVscCBzb3J0IG9iamVjdHMgd2l0aCB0aGUgc2FtZSB6SW5kZXgsIGJ5IHVzaW5nIHByZXZpb3VzIGFycmF5IGluZGV4IGFzIHRoZSBkZWNpZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xhc3RTb3J0ZWRJbmRleCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB6SW5kZXggb2YgdGhlIGRpc3BsYXlPYmplY3QuXG4gICAgICAgICAqIEEgaGlnaGVyIHZhbHVlIHdpbGwgbWVhbiBpdCB3aWxsIGJlIHJlbmRlcmVkIG9uIHRvcCBvZiBvdGhlciBkaXNwbGF5T2JqZWN0cyB3aXRoaW4gdGhlIHNhbWUgY29udGFpbmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3pJbmRleCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhcmVhIHRoZSBmaWx0ZXIgaXMgYXBwbGllZCB0by4gVGhpcyBpcyB1c2VkIGFzIG1vcmUgb2YgYW4gb3B0aW1pemF0aW9uXG4gICAgICAgICAqIHJhdGhlciB0aGFuIGZpZ3VyaW5nIG91dCB0aGUgZGltZW5zaW9ucyBvZiB0aGUgZGlzcGxheU9iamVjdCBlYWNoIGZyYW1lIHlvdSBjYW4gc2V0IHRoaXMgcmVjdGFuZ2xlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBBbHNvIHdvcmtzIGFzIGFuIGludGVyYWN0aW9uIG1hc2suXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIgez9QSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyQXJlYSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdGhlIGZpbHRlcnMgZm9yIHRoZSBkaXNwbGF5T2JqZWN0LlxuICAgICAgICAgKiAqIElNUE9SVEFOVDogVGhpcyBpcyBhIFdlYkdMIG9ubHkgZmVhdHVyZSBhbmQgd2lsbCBiZSBpZ25vcmVkIGJ5IHRoZSBjYW52YXMgcmVuZGVyZXIuXG4gICAgICAgICAqIFRvIHJlbW92ZSBmaWx0ZXJzIHNpbXBseSBzZXQgdGhpcyBwcm9wZXJ0eSB0byBgJ251bGwnYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7P1BJWEkuRmlsdGVyW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlcnMgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDdXJyZW50bHkgZW5hYmxlZCBmaWx0ZXJzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRmlsdGVyW119XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2VuYWJsZWRGaWx0ZXJzID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGJvdW5kcyBvYmplY3QsIHRoaXMgaXMgdXNlZCB0byBjYWxjdWxhdGUgYW5kIHN0b3JlIHRoZSBib3VuZHMgb2YgdGhlIGRpc3BsYXlPYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQm91bmRzfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRzID0gbmV3IEJvdW5kcygpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2NhbCBib3VuZHMgb2JqZWN0LCBzd2FwcGVkIHdpdGggYF9ib3VuZHNgIHdoZW4gdXNpbmcgYGdldExvY2FsQm91bmRzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJvdW5kc31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xvY2FsQm91bmRzID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRmxhZ3MgdGhlIGNhY2hlZCBib3VuZHMgYXMgZGlydHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRzSUQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWNoZSBvZiB0aGlzIGRpc3BsYXktb2JqZWN0J3MgYm91bmRzLXJlY3RhbmdsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5Cb3VuZHN9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2JvdW5kc1JlY3QgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWNoZSBvZiB0aGlzIGRpc3BsYXktb2JqZWN0J3MgbG9jYWwtYm91bmRzIHJlY3RhbmdsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5Cb3VuZHN9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xvY2FsQm91bmRzUmVjdCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBvcmlnaW5hbCwgY2FjaGVkIG1hc2sgb2YgdGhlIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5Db250YWluZXJ8UElYSS5NYXNrRGF0YXxudWxsfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9tYXNrID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiB0aGlzIERpc3BsYXlPYmplY3QgaXMgYWRkZWQgdG8gYSBDb250YWluZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjYWRkZWRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcn0gY29udGFpbmVyIC0gVGhlIGNvbnRhaW5lciBhZGRlZCB0by5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gdGhpcyBEaXNwbGF5T2JqZWN0IGlzIHJlbW92ZWQgZnJvbSBhIENvbnRhaW5lci5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNyZW1vdmVkXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5Db250YWluZXJ9IGNvbnRhaW5lciAtIFRoZSBjb250YWluZXIgcmVtb3ZlZCBmcm9tLlxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIG9iamVjdCBoYXMgYmVlbiBkZXN0cm95ZWQgdmlhIGRlc3Ryb3koKS4gSWYgdHJ1ZSwgaXQgc2hvdWxkIG5vdCBiZSB1c2VkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9kZXN0cm95ZWQgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdXNlZCB0byBmYXN0IGNoZWNrIGlmIGEgc3ByaXRlIGlzLi4gYSBzcHJpdGUhXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlzU3ByaXRlID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERvZXMgYW55IG90aGVyIGRpc3BsYXlPYmplY3QgdXNlIHRoaXMgb2JqZWN0IGFzIGEgbWFzaz9cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXNNYXNrID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjYWxjdWxhdGVzIHRoZSBib3VuZHMgb2YgdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAqL1xuICAgIGFic3RyYWN0IGNhbGN1bGF0ZUJvdW5kcygpOiB2b2lkO1xuXG4gICAgYWJzdHJhY3QgcmVtb3ZlQ2hpbGQoY2hpbGQ6IERpc3BsYXlPYmplY3QpOiB2b2lkO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVycyB0aGUgb2JqZWN0IHVzaW5nIHRoZSBXZWJHTCByZW5kZXJlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIuXG4gICAgICovXG4gICAgYWJzdHJhY3QgcmVuZGVyKHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWQ7XG5cbiAgICAvKipcbiAgICAgKiBSZWN1cnNpdmVseSB1cGRhdGVzIHRyYW5zZm9ybSBvZiBhbGwgb2JqZWN0cyBmcm9tIHRoZSByb290IHRvIHRoaXMgb25lXG4gICAgICogaW50ZXJuYWwgZnVuY3Rpb24gZm9yIHRvTG9jYWwoKVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfcmVjdXJzaXZlUG9zdFVwZGF0ZVRyYW5zZm9ybSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Ll9yZWN1cnNpdmVQb3N0VXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS51cGRhdGVUcmFuc2Zvcm0odGhpcy5wYXJlbnQudHJhbnNmb3JtKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLnVwZGF0ZVRyYW5zZm9ybSh0aGlzLl90ZW1wRGlzcGxheU9iamVjdFBhcmVudC50cmFuc2Zvcm0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgb2JqZWN0IHRyYW5zZm9ybSBmb3IgcmVuZGVyaW5nLlxuICAgICAqXG4gICAgICogVE9ETyAtIE9wdGltaXphdGlvbiBwYXNzIVxuICAgICAqL1xuICAgIHVwZGF0ZVRyYW5zZm9ybSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLl9ib3VuZHNJRCsrO1xuXG4gICAgICAgIHRoaXMudHJhbnNmb3JtLnVwZGF0ZVRyYW5zZm9ybSh0aGlzLnBhcmVudC50cmFuc2Zvcm0pO1xuICAgICAgICAvLyBtdWx0aXBseSB0aGUgYWxwaGFzLi5cbiAgICAgICAgdGhpcy53b3JsZEFscGhhID0gdGhpcy5hbHBoYSAqIHRoaXMucGFyZW50LndvcmxkQWxwaGE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBib3VuZHMgb2YgdGhlIGRpc3BsYXlPYmplY3QgYXMgYSByZWN0YW5nbGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc2tpcFVwZGF0ZV0gLSBTZXR0aW5nIHRvIGB0cnVlYCB3aWxsIHN0b3AgdGhlIHRyYW5zZm9ybXMgb2YgdGhlIHNjZW5lIGdyYXBoIGZyb21cbiAgICAgKiAgYmVpbmcgdXBkYXRlZC4gVGhpcyBtZWFucyB0aGUgY2FsY3VsYXRpb24gcmV0dXJuZWQgTUFZIGJlIG91dCBvZiBkYXRlIEJVVCB3aWxsIGdpdmUgeW91IGFcbiAgICAgKiAgbmljZSBwZXJmb3JtYW5jZSBib29zdC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBbcmVjdF0gLSBPcHRpb25hbCByZWN0YW5nbGUgdG8gc3RvcmUgdGhlIHJlc3VsdCBvZiB0aGUgYm91bmRzIGNhbGN1bGF0aW9uLlxuICAgICAqIEByZXR1cm4ge1BJWEkuUmVjdGFuZ2xlfSBUaGUgcmVjdGFuZ3VsYXIgYm91bmRpbmcgYXJlYS5cbiAgICAgKi9cbiAgICBnZXRCb3VuZHMoc2tpcFVwZGF0ZT86IGJvb2xlYW4sIHJlY3Q/OiBSZWN0YW5nbGUpOiBSZWN0YW5nbGVcbiAgICB7XG4gICAgICAgIGlmICghc2tpcFVwZGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudCA9IHRoaXMuX3RlbXBEaXNwbGF5T2JqZWN0UGFyZW50O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlY3Vyc2l2ZVBvc3RVcGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2JvdW5kcy51cGRhdGVJRCAhPT0gdGhpcy5fYm91bmRzSUQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlQm91bmRzKCk7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZHMudXBkYXRlSUQgPSB0aGlzLl9ib3VuZHNJRDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVjdClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9ib3VuZHNSZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvdW5kc1JlY3QgPSBuZXcgUmVjdGFuZ2xlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlY3QgPSB0aGlzLl9ib3VuZHNSZWN0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kcy5nZXRSZWN0YW5nbGUocmVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBsb2NhbCBib3VuZHMgb2YgdGhlIGRpc3BsYXlPYmplY3QgYXMgYSByZWN0YW5nbGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gW3JlY3RdIC0gT3B0aW9uYWwgcmVjdGFuZ2xlIHRvIHN0b3JlIHRoZSByZXN1bHQgb2YgdGhlIGJvdW5kcyBjYWxjdWxhdGlvbi5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gVGhlIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGFyZWEuXG4gICAgICovXG4gICAgZ2V0TG9jYWxCb3VuZHMocmVjdD86IFJlY3RhbmdsZSk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgaWYgKCFyZWN0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2xvY2FsQm91bmRzUmVjdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2NhbEJvdW5kc1JlY3QgPSBuZXcgUmVjdGFuZ2xlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlY3QgPSB0aGlzLl9sb2NhbEJvdW5kc1JlY3Q7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuX2xvY2FsQm91bmRzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbEJvdW5kcyA9IG5ldyBCb3VuZHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRyYW5zZm9ybVJlZiA9IHRoaXMudHJhbnNmb3JtO1xuICAgICAgICBjb25zdCBwYXJlbnRSZWYgPSB0aGlzLnBhcmVudDtcblxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtID0gdGhpcy5fdGVtcERpc3BsYXlPYmplY3RQYXJlbnQudHJhbnNmb3JtO1xuXG4gICAgICAgIGNvbnN0IHdvcmxkQm91bmRzID0gdGhpcy5fYm91bmRzO1xuICAgICAgICBjb25zdCB3b3JsZEJvdW5kc0lEID0gdGhpcy5fYm91bmRzSUQ7XG5cbiAgICAgICAgdGhpcy5fYm91bmRzID0gdGhpcy5fbG9jYWxCb3VuZHM7XG5cbiAgICAgICAgY29uc3QgYm91bmRzID0gdGhpcy5nZXRCb3VuZHMoZmFsc2UsIHJlY3QpO1xuXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50UmVmO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybSA9IHRyYW5zZm9ybVJlZjtcblxuICAgICAgICB0aGlzLl9ib3VuZHMgPSB3b3JsZEJvdW5kcztcbiAgICAgICAgdGhpcy5fYm91bmRzLnVwZGF0ZUlEICs9IHRoaXMuX2JvdW5kc0lEIC0gd29ybGRCb3VuZHNJRDsvLyByZWZsZWN0IHNpZGUtZWZmZWN0c1xuXG4gICAgICAgIHJldHVybiBib3VuZHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlcyB0aGUgZ2xvYmFsIHBvc2l0aW9uIG9mIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb3NpdGlvbiAtIFRoZSB3b3JsZCBvcmlnaW4gdG8gY2FsY3VsYXRlIGZyb20uXG4gICAgICogQHBhcmFtIHtQSVhJLlBvaW50fSBbcG9pbnRdIC0gQSBQb2ludCBvYmplY3QgaW4gd2hpY2ggdG8gc3RvcmUgdGhlIHZhbHVlLCBvcHRpb25hbFxuICAgICAqICAob3RoZXJ3aXNlIHdpbGwgY3JlYXRlIGEgbmV3IFBvaW50KS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwVXBkYXRlPWZhbHNlXSAtIFNob3VsZCB3ZSBza2lwIHRoZSB1cGRhdGUgdHJhbnNmb3JtLlxuICAgICAqIEByZXR1cm4ge1BJWEkuUG9pbnR9IEEgcG9pbnQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgcG9zaXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAgICovXG4gICAgdG9HbG9iYWw8UCBleHRlbmRzIElQb2ludERhdGEgPSBQb2ludD4ocG9zaXRpb246IElQb2ludERhdGEsIHBvaW50PzogUCwgc2tpcFVwZGF0ZSA9IGZhbHNlKTogUFxuICAgIHtcbiAgICAgICAgaWYgKCFza2lwVXBkYXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9yZWN1cnNpdmVQb3N0VXBkYXRlVHJhbnNmb3JtKCk7XG5cbiAgICAgICAgICAgIC8vIHRoaXMgcGFyZW50IGNoZWNrIGlzIGZvciBqdXN0IGluIGNhc2UgdGhlIGl0ZW0gaXMgYSByb290IG9iamVjdC5cbiAgICAgICAgICAgIC8vIElmIGl0IGlzIHdlIG5lZWQgdG8gZ2l2ZSBpdCBhIHRlbXBvcmFyeSBwYXJlbnQgc28gdGhhdCBkaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtIHdvcmtzIGNvcnJlY3RseVxuICAgICAgICAgICAgLy8gdGhpcyBpcyBtYWlubHkgdG8gYXZvaWQgYSBwYXJlbnQgY2hlY2sgaW4gdGhlIG1haW4gbG9vcC4gRXZlcnkgbGl0dGxlIGhlbHBzIGZvciBwZXJmb3JtYW5jZSA6KVxuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudCA9IHRoaXMuX3RlbXBEaXNwbGF5T2JqZWN0UGFyZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheU9iamVjdFVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3RVcGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRvbid0IG5lZWQgdG8gdXBkYXRlIHRoZSBsb3RcbiAgICAgICAgcmV0dXJuIHRoaXMud29ybGRUcmFuc2Zvcm0uYXBwbHk8UD4ocG9zaXRpb24sIHBvaW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGVzIHRoZSBsb2NhbCBwb3NpdGlvbiBvZiB0aGUgZGlzcGxheSBvYmplY3QgcmVsYXRpdmUgdG8gYW5vdGhlciBwb2ludC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb3NpdGlvbiAtIFRoZSB3b3JsZCBvcmlnaW4gdG8gY2FsY3VsYXRlIGZyb20uXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IFtmcm9tXSAtIFRoZSBEaXNwbGF5T2JqZWN0IHRvIGNhbGN1bGF0ZSB0aGUgZ2xvYmFsIHBvc2l0aW9uIGZyb20uXG4gICAgICogQHBhcmFtIHtQSVhJLlBvaW50fSBbcG9pbnRdIC0gQSBQb2ludCBvYmplY3QgaW4gd2hpY2ggdG8gc3RvcmUgdGhlIHZhbHVlLCBvcHRpb25hbFxuICAgICAqICAob3RoZXJ3aXNlIHdpbGwgY3JlYXRlIGEgbmV3IFBvaW50KS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwVXBkYXRlPWZhbHNlXSAtIFNob3VsZCB3ZSBza2lwIHRoZSB1cGRhdGUgdHJhbnNmb3JtXG4gICAgICogQHJldHVybiB7UElYSS5Qb2ludH0gQSBwb2ludCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBwb3NpdGlvbiBvZiB0aGlzIG9iamVjdFxuICAgICAqL1xuICAgIHRvTG9jYWw8UCBleHRlbmRzIElQb2ludERhdGEgPSBQb2ludD4ocG9zaXRpb246IElQb2ludERhdGEsIGZyb206IERpc3BsYXlPYmplY3QsIHBvaW50PzogUCwgc2tpcFVwZGF0ZT86IGJvb2xlYW4pOiBQXG4gICAge1xuICAgICAgICBpZiAoZnJvbSlcbiAgICAgICAge1xuICAgICAgICAgICAgcG9zaXRpb24gPSBmcm9tLnRvR2xvYmFsKHBvc2l0aW9uLCBwb2ludCwgc2tpcFVwZGF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNraXBVcGRhdGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3JlY3Vyc2l2ZVBvc3RVcGRhdGVUcmFuc2Zvcm0oKTtcblxuICAgICAgICAgICAgLy8gdGhpcyBwYXJlbnQgY2hlY2sgaXMgZm9yIGp1c3QgaW4gY2FzZSB0aGUgaXRlbSBpcyBhIHJvb3Qgb2JqZWN0LlxuICAgICAgICAgICAgLy8gSWYgaXQgaXMgd2UgbmVlZCB0byBnaXZlIGl0IGEgdGVtcG9yYXJ5IHBhcmVudCBzbyB0aGF0IGRpc3BsYXlPYmplY3RVcGRhdGVUcmFuc2Zvcm0gd29ya3MgY29ycmVjdGx5XG4gICAgICAgICAgICAvLyB0aGlzIGlzIG1haW5seSB0byBhdm9pZCBhIHBhcmVudCBjaGVjayBpbiB0aGUgbWFpbiBsb29wLiBFdmVyeSBsaXR0bGUgaGVscHMgZm9yIHBlcmZvcm1hbmNlIDopXG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50ID0gdGhpcy5fdGVtcERpc3BsYXlPYmplY3RQYXJlbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheU9iamVjdFVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2ltcGx5IGFwcGx5IHRoZSBtYXRyaXguLlxuICAgICAgICByZXR1cm4gdGhpcy53b3JsZFRyYW5zZm9ybS5hcHBseUludmVyc2U8UD4ocG9zaXRpb24sIHBvaW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHBhcmVudCBDb250YWluZXIgb2YgdGhpcyBEaXNwbGF5T2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcn0gY29udGFpbmVyIC0gVGhlIENvbnRhaW5lciB0byBhZGQgdGhpcyBEaXNwbGF5T2JqZWN0IHRvLlxuICAgICAqIEByZXR1cm4ge1BJWEkuQ29udGFpbmVyfSBUaGUgQ29udGFpbmVyIHRoYXQgdGhpcyBEaXNwbGF5T2JqZWN0IHdhcyBhZGRlZCB0by5cbiAgICAgKi9cbiAgICBzZXRQYXJlbnQoY29udGFpbmVyOiBDb250YWluZXIpOiBDb250YWluZXJcbiAgICB7XG4gICAgICAgIGlmICghY29udGFpbmVyIHx8ICFjb250YWluZXIuYWRkQ2hpbGQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2V0UGFyZW50OiBBcmd1bWVudCBtdXN0IGJlIGEgQ29udGFpbmVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb250YWluZXIuYWRkQ2hpbGQodGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZW5pZW5jZSBmdW5jdGlvbiB0byBzZXQgdGhlIHBvc2l0aW9uLCBzY2FsZSwgc2tldyBhbmQgcGl2b3QgYXQgb25jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeD0wXSAtIFRoZSBYIHBvc2l0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt5PTBdIC0gVGhlIFkgcG9zaXRpb25cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3NjYWxlWD0xXSAtIFRoZSBYIHNjYWxlIHZhbHVlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzY2FsZVk9MV0gLSBUaGUgWSBzY2FsZSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcm90YXRpb249MF0gLSBUaGUgcm90YXRpb25cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3NrZXdYPTBdIC0gVGhlIFggc2tldyB2YWx1ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc2tld1k9MF0gLSBUaGUgWSBza2V3IHZhbHVlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtwaXZvdFg9MF0gLSBUaGUgWCBwaXZvdCB2YWx1ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcGl2b3RZPTBdIC0gVGhlIFkgcGl2b3QgdmFsdWVcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkRpc3BsYXlPYmplY3R9IFRoZSBEaXNwbGF5T2JqZWN0IGluc3RhbmNlXG4gICAgICovXG4gICAgc2V0VHJhbnNmb3JtKHggPSAwLCB5ID0gMCwgc2NhbGVYID0gMSwgc2NhbGVZID0gMSwgcm90YXRpb24gPSAwLCBza2V3WCA9IDAsIHNrZXdZID0gMCwgcGl2b3RYID0gMCwgcGl2b3RZID0gMCk6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMucG9zaXRpb24ueCA9IHg7XG4gICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHk7XG4gICAgICAgIHRoaXMuc2NhbGUueCA9ICFzY2FsZVggPyAxIDogc2NhbGVYO1xuICAgICAgICB0aGlzLnNjYWxlLnkgPSAhc2NhbGVZID8gMSA6IHNjYWxlWTtcbiAgICAgICAgdGhpcy5yb3RhdGlvbiA9IHJvdGF0aW9uO1xuICAgICAgICB0aGlzLnNrZXcueCA9IHNrZXdYO1xuICAgICAgICB0aGlzLnNrZXcueSA9IHNrZXdZO1xuICAgICAgICB0aGlzLnBpdm90LnggPSBwaXZvdFg7XG4gICAgICAgIHRoaXMucGl2b3QueSA9IHBpdm90WTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCYXNlIGRlc3Ryb3kgbWV0aG9kIGZvciBnZW5lcmljIGRpc3BsYXkgb2JqZWN0cy4gVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHlcbiAgICAgKiByZW1vdmUgdGhlIGRpc3BsYXkgb2JqZWN0IGZyb20gaXRzIHBhcmVudCBDb250YWluZXIgYXMgd2VsbCBhcyByZW1vdmVcbiAgICAgKiBhbGwgY3VycmVudCBldmVudCBsaXN0ZW5lcnMgYW5kIGludGVybmFsIHJlZmVyZW5jZXMuIERvIG5vdCB1c2UgYSBEaXNwbGF5T2JqZWN0XG4gICAgICogYWZ0ZXIgY2FsbGluZyBgZGVzdHJveSgpYC5cbiAgICAgKlxuICAgICAqL1xuICAgIGRlc3Ryb3koX29wdGlvbnM/OiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSBudWxsO1xuXG4gICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fYm91bmRzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbWFzayA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5maWx0ZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy5maWx0ZXJBcmVhID0gbnVsbDtcbiAgICAgICAgdGhpcy5oaXRBcmVhID0gbnVsbDtcblxuICAgICAgICB0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW50ZXJhY3RpdmVDaGlsZHJlbiA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3llZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBtZW1iZXIge1BJWEkuQ29udGFpbmVyfVxuICAgICAqL1xuICAgIGdldCBfdGVtcERpc3BsYXlPYmplY3RQYXJlbnQoKTogVGVtcG9yYXJ5RGlzcGxheU9iamVjdFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMudGVtcERpc3BsYXlPYmplY3RQYXJlbnQgPT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11c2UtYmVmb3JlLWRlZmluZVxuICAgICAgICAgICAgdGhpcy50ZW1wRGlzcGxheU9iamVjdFBhcmVudCA9IG5ldyBUZW1wb3JhcnlEaXNwbGF5T2JqZWN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy50ZW1wRGlzcGxheU9iamVjdFBhcmVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIGluIFJlbmRlcmVyLCBjYWNoZUFzQml0bWFwIGFuZCBvdGhlciBwbGFjZXMgd2hlcmUgeW91IGNhbGwgYW4gYHVwZGF0ZVRyYW5zZm9ybWAgb24gcm9vdFxuICAgICAqXG4gICAgICogYGBgXG4gICAgICogY29uc3QgY2FjaGVQYXJlbnQgPSBlbGVtLmVuYWJsZVRlbXBQYXJlbnQoKTtcbiAgICAgKiBlbGVtLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAqIGVsZW0uZGlzYWJsZVRlbXBQYXJlbnQoY2FjaGVQYXJlbnQpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHJldHVybnMge1BJWEkuRGlzcGxheU9iamVjdH0gY3VycmVudCBwYXJlbnRcbiAgICAgKi9cbiAgICBlbmFibGVUZW1wUGFyZW50KCk6IERpc3BsYXlPYmplY3RcbiAgICB7XG4gICAgICAgIGNvbnN0IG15UGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cbiAgICAgICAgdGhpcy5wYXJlbnQgPSB0aGlzLl90ZW1wRGlzcGxheU9iamVjdFBhcmVudDtcblxuICAgICAgICByZXR1cm4gbXlQYXJlbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFpciBtZXRob2QgZm9yIGBlbmFibGVUZW1wUGFyZW50YFxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBjYWNoZVBhcmVudCBhY3R1YWwgcGFyZW50IG9mIGVsZW1lbnRcbiAgICAgKi9cbiAgICBkaXNhYmxlVGVtcFBhcmVudChjYWNoZVBhcmVudDogRGlzcGxheU9iamVjdCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMucGFyZW50ID0gY2FjaGVQYXJlbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHBvc2l0aW9uIG9mIHRoZSBkaXNwbGF5T2JqZWN0IG9uIHRoZSB4IGF4aXMgcmVsYXRpdmUgdG8gdGhlIGxvY2FsIGNvb3JkaW5hdGVzIG9mIHRoZSBwYXJlbnQuXG4gICAgICogQW4gYWxpYXMgdG8gcG9zaXRpb24ueFxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCB4KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueDtcbiAgICB9XG5cbiAgICBzZXQgeCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0ucG9zaXRpb24ueCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgZGlzcGxheU9iamVjdCBvbiB0aGUgeSBheGlzIHJlbGF0aXZlIHRvIHRoZSBsb2NhbCBjb29yZGluYXRlcyBvZiB0aGUgcGFyZW50LlxuICAgICAqIEFuIGFsaWFzIHRvIHBvc2l0aW9uLnlcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgeSgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvc2l0aW9uLnk7XG4gICAgfVxuXG4gICAgc2V0IHkodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uLnkgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDdXJyZW50IHRyYW5zZm9ybSBvZiB0aGUgb2JqZWN0IGJhc2VkIG9uIHdvcmxkIChwYXJlbnQpIGZhY3RvcnMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgd29ybGRUcmFuc2Zvcm0oKTogTWF0cml4XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3VycmVudCB0cmFuc2Zvcm0gb2YgdGhlIG9iamVjdCBiYXNlZCBvbiBsb2NhbCBmYWN0b3JzOiBwb3NpdGlvbiwgc2NhbGUsIG90aGVyIHN0dWZmLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5NYXRyaXh9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgZ2V0IGxvY2FsVHJhbnNmb3JtKCk6IE1hdHJpeFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtLmxvY2FsVHJhbnNmb3JtO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBjb29yZGluYXRlIG9mIHRoZSBvYmplY3QgcmVsYXRpdmUgdG8gdGhlIGxvY2FsIGNvb3JkaW5hdGVzIG9mIHRoZSBwYXJlbnQuXG4gICAgICogQXNzaWdubWVudCBieSB2YWx1ZSBzaW5jZSBwaXhpLXY0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5PYnNlcnZhYmxlUG9pbnR9XG4gICAgICovXG4gICAgZ2V0IHBvc2l0aW9uKCk6IE9ic2VydmFibGVQb2ludFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtLnBvc2l0aW9uO1xuICAgIH1cblxuICAgIHNldCBwb3NpdGlvbih2YWx1ZTogT2JzZXJ2YWJsZVBvaW50KVxuICAgIHtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0ucG9zaXRpb24uY29weUZyb20odmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBzY2FsZSBmYWN0b3Igb2YgdGhlIG9iamVjdC5cbiAgICAgKiBBc3NpZ25tZW50IGJ5IHZhbHVlIHNpbmNlIHBpeGktdjQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLk9ic2VydmFibGVQb2ludH1cbiAgICAgKi9cbiAgICBnZXQgc2NhbGUoKTogT2JzZXJ2YWJsZVBvaW50XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy50cmFuc2Zvcm0uc2NhbGU7XG4gICAgfVxuXG4gICAgc2V0IHNjYWxlKHZhbHVlOiBPYnNlcnZhYmxlUG9pbnQpXG4gICAge1xuICAgICAgICB0aGlzLnRyYW5zZm9ybS5zY2FsZS5jb3B5RnJvbSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHBpdm90IHBvaW50IG9mIHRoZSBkaXNwbGF5T2JqZWN0IHRoYXQgaXQgcm90YXRlcyBhcm91bmQuXG4gICAgICogQXNzaWdubWVudCBieSB2YWx1ZSBzaW5jZSBwaXhpLXY0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5PYnNlcnZhYmxlUG9pbnR9XG4gICAgICovXG4gICAgZ2V0IHBpdm90KCk6IE9ic2VydmFibGVQb2ludFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtLnBpdm90O1xuICAgIH1cblxuICAgIHNldCBwaXZvdCh2YWx1ZTogT2JzZXJ2YWJsZVBvaW50KVxuICAgIHtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0ucGl2b3QuY29weUZyb20odmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBza2V3IGZhY3RvciBmb3IgdGhlIG9iamVjdCBpbiByYWRpYW5zLlxuICAgICAqIEFzc2lnbm1lbnQgYnkgdmFsdWUgc2luY2UgcGl4aS12NC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAqL1xuICAgIGdldCBza2V3KCk6IE9ic2VydmFibGVQb2ludFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtLnNrZXc7XG4gICAgfVxuXG4gICAgc2V0IHNrZXcodmFsdWU6IE9ic2VydmFibGVQb2ludClcbiAgICB7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtLnNrZXcuY29weUZyb20odmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSByb3RhdGlvbiBvZiB0aGUgb2JqZWN0IGluIHJhZGlhbnMuXG4gICAgICogJ3JvdGF0aW9uJyBhbmQgJ2FuZ2xlJyBoYXZlIHRoZSBzYW1lIGVmZmVjdCBvbiBhIGRpc3BsYXkgb2JqZWN0OyByb3RhdGlvbiBpcyBpbiByYWRpYW5zLCBhbmdsZSBpcyBpbiBkZWdyZWVzLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCByb3RhdGlvbigpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnRyYW5zZm9ybS5yb3RhdGlvbjtcbiAgICB9XG5cbiAgICBzZXQgcm90YXRpb24odmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtLnJvdGF0aW9uID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGFuZ2xlIG9mIHRoZSBvYmplY3QgaW4gZGVncmVlcy5cbiAgICAgKiAncm90YXRpb24nIGFuZCAnYW5nbGUnIGhhdmUgdGhlIHNhbWUgZWZmZWN0IG9uIGEgZGlzcGxheSBvYmplY3Q7IHJvdGF0aW9uIGlzIGluIHJhZGlhbnMsIGFuZ2xlIGlzIGluIGRlZ3JlZXMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGFuZ2xlKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtLnJvdGF0aW9uICogUkFEX1RPX0RFRztcbiAgICB9XG5cbiAgICBzZXQgYW5nbGUodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtLnJvdGF0aW9uID0gdmFsdWUgKiBERUdfVE9fUkFEO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB6SW5kZXggb2YgdGhlIGRpc3BsYXlPYmplY3QuXG4gICAgICogSWYgYSBjb250YWluZXIgaGFzIHRoZSBzb3J0YWJsZUNoaWxkcmVuIHByb3BlcnR5IHNldCB0byB0cnVlLCBjaGlsZHJlbiB3aWxsIGJlIGF1dG9tYXRpY2FsbHlcbiAgICAgKiBzb3J0ZWQgYnkgekluZGV4IHZhbHVlOyBhIGhpZ2hlciB2YWx1ZSB3aWxsIG1lYW4gaXQgd2lsbCBiZSBtb3ZlZCB0b3dhcmRzIHRoZSBlbmQgb2YgdGhlIGFycmF5LFxuICAgICAqIGFuZCB0aHVzIHJlbmRlcmVkIG9uIHRvcCBvZiBvdGhlciBkaXNwbGF5T2JqZWN0cyB3aXRoaW4gdGhlIHNhbWUgY29udGFpbmVyLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCB6SW5kZXgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fekluZGV4O1xuICAgIH1cblxuICAgIHNldCB6SW5kZXgodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX3pJbmRleCA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnNvcnREaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgaWYgdGhlIG9iamVjdCBpcyBnbG9iYWxseSB2aXNpYmxlLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgd29ybGRWaXNpYmxlKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGxldCBpdGVtID0gdGhpcyBhcyBEaXNwbGF5T2JqZWN0O1xuXG4gICAgICAgIGRvXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghaXRlbS52aXNpYmxlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaXRlbSA9IGl0ZW0ucGFyZW50O1xuICAgICAgICB9IHdoaWxlIChpdGVtKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbWFzayBmb3IgdGhlIGRpc3BsYXlPYmplY3QuIEEgbWFzayBpcyBhbiBvYmplY3QgdGhhdCBsaW1pdHMgdGhlIHZpc2liaWxpdHkgb2YgYW5cbiAgICAgKiBvYmplY3QgdG8gdGhlIHNoYXBlIG9mIHRoZSBtYXNrIGFwcGxpZWQgdG8gaXQuIEluIFBpeGlKUyBhIHJlZ3VsYXIgbWFzayBtdXN0IGJlIGFcbiAgICAgKiB7QGxpbmsgUElYSS5HcmFwaGljc30gb3IgYSB7QGxpbmsgUElYSS5TcHJpdGV9IG9iamVjdC4gVGhpcyBhbGxvd3MgZm9yIG11Y2ggZmFzdGVyIG1hc2tpbmcgaW4gY2FudmFzIGFzIGl0XG4gICAgICogdXRpbGl0aWVzIHNoYXBlIGNsaXBwaW5nLiBUbyByZW1vdmUgYSBtYXNrLCBzZXQgdGhpcyBwcm9wZXJ0eSB0byBgbnVsbGAuXG4gICAgICpcbiAgICAgKiBGb3Igc3ByaXRlIG1hc2sgYm90aCBhbHBoYSBhbmQgcmVkIGNoYW5uZWwgYXJlIHVzZWQuIEJsYWNrIG1hc2sgaXMgdGhlIHNhbWUgYXMgdHJhbnNwYXJlbnQgbWFzay5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgKiBncmFwaGljcy5iZWdpbkZpbGwoMHhGRjMzMDApO1xuICAgICAqIGdyYXBoaWNzLmRyYXdSZWN0KDUwLCAyNTAsIDEwMCwgMTAwKTtcbiAgICAgKiBncmFwaGljcy5lbmRGaWxsKCk7XG4gICAgICpcbiAgICAgKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gICAgICogc3ByaXRlLm1hc2sgPSBncmFwaGljcztcbiAgICAgKiBAdG9kbyBBdCB0aGUgbW9tZW50LCBQSVhJLkNhbnZhc1JlbmRlcmVyIGRvZXNuJ3Qgc3VwcG9ydCBQSVhJLlNwcml0ZSBhcyBtYXNrLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5Db250YWluZXJ8UElYSS5NYXNrRGF0YXxudWxsfVxuICAgICAqL1xuICAgIGdldCBtYXNrKCk6IENvbnRhaW5lcnxNYXNrRGF0YXxudWxsXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWFzaztcbiAgICB9XG5cbiAgICBzZXQgbWFzayh2YWx1ZTogQ29udGFpbmVyfE1hc2tEYXRhfG51bGwpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fbWFzaylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbWFza09iamVjdCA9ICgodGhpcy5fbWFzayBhcyBNYXNrRGF0YSkubWFza09iamVjdCB8fCB0aGlzLl9tYXNrKSBhcyBDb250YWluZXI7XG5cbiAgICAgICAgICAgIG1hc2tPYmplY3QucmVuZGVyYWJsZSA9IHRydWU7XG4gICAgICAgICAgICBtYXNrT2JqZWN0LmlzTWFzayA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbWFzayA9IHZhbHVlO1xuXG4gICAgICAgIGlmICh0aGlzLl9tYXNrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBtYXNrT2JqZWN0ID0gKCh0aGlzLl9tYXNrIGFzIE1hc2tEYXRhKS5tYXNrT2JqZWN0IHx8IHRoaXMuX21hc2spIGFzIENvbnRhaW5lcjtcblxuICAgICAgICAgICAgbWFza09iamVjdC5yZW5kZXJhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICBtYXNrT2JqZWN0LmlzTWFzayA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUZW1wb3JhcnlEaXNwbGF5T2JqZWN0IGV4dGVuZHMgRGlzcGxheU9iamVjdFxue1xuICAgIGNhbGN1bGF0ZUJvdW5kczogKCkgPT4gbnVsbDtcbiAgICByZW1vdmVDaGlsZDogKGNoaWxkOiBEaXNwbGF5T2JqZWN0KSA9PiBudWxsO1xuICAgIHJlbmRlcjogKHJlbmRlcmVyOiBSZW5kZXJlcikgPT4gbnVsbDtcbiAgICBzb3J0RGlydHk6IGJvb2xlYW4gPSBudWxsO1xufVxuXG4vKipcbiAqIERpc3BsYXlPYmplY3QgZGVmYXVsdCB1cGRhdGVUcmFuc2Zvcm0sIGRvZXMgbm90IHVwZGF0ZSBjaGlsZHJlbiBvZiBjb250YWluZXIuXG4gKiBXaWxsIGNyYXNoIGlmIHRoZXJlJ3Mgbm8gcGFyZW50IGVsZW1lbnQuXG4gKlxuICogQG1lbWJlcm9mIFBJWEkuRGlzcGxheU9iamVjdCNcbiAqIEBmdW5jdGlvbiBkaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtXG4gKi9cbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLmRpc3BsYXlPYmplY3RVcGRhdGVUcmFuc2Zvcm0gPSBEaXNwbGF5T2JqZWN0LnByb3RvdHlwZS51cGRhdGVUcmFuc2Zvcm07XG4iLCAiaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5pbXBvcnQgeyByZW1vdmVJdGVtcyB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IERpc3BsYXlPYmplY3QgfSBmcm9tICcuL0Rpc3BsYXlPYmplY3QnO1xuaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmltcG9ydCB0eXBlIHsgTWFza0RhdGEsIFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJy4vRGlzcGxheU9iamVjdCc7XG5cbmZ1bmN0aW9uIHNvcnRDaGlsZHJlbihhOiBEaXNwbGF5T2JqZWN0LCBiOiBEaXNwbGF5T2JqZWN0KTogbnVtYmVyXG57XG4gICAgaWYgKGEuekluZGV4ID09PSBiLnpJbmRleClcbiAgICB7XG4gICAgICAgIHJldHVybiBhLl9sYXN0U29ydGVkSW5kZXggLSBiLl9sYXN0U29ydGVkSW5kZXg7XG4gICAgfVxuXG4gICAgcmV0dXJuIGEuekluZGV4IC0gYi56SW5kZXg7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udGFpbmVyIGV4dGVuZHMgR2xvYmFsTWl4aW5zLkNvbnRhaW5lciwgRGlzcGxheU9iamVjdCB7fVxuXG4vKipcbiAqIEEgQ29udGFpbmVyIHJlcHJlc2VudHMgYSBjb2xsZWN0aW9uIG9mIGRpc3BsYXkgb2JqZWN0cy5cbiAqXG4gKiBJdCBpcyB0aGUgYmFzZSBjbGFzcyBvZiBhbGwgZGlzcGxheSBvYmplY3RzIHRoYXQgYWN0IGFzIGEgY29udGFpbmVyIGZvciBvdGhlciBvYmplY3RzIChsaWtlIFNwcml0ZXMpLlxuICpcbiAqYGBganNcbiAqIGxldCBjb250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAqIGNvbnRhaW5lci5hZGRDaGlsZChzcHJpdGUpO1xuICogYGBgXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkRpc3BsYXlPYmplY3RcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBDb250YWluZXIgZXh0ZW5kcyBEaXNwbGF5T2JqZWN0XG57XG4gICAgcHVibGljIHJlYWRvbmx5IGNoaWxkcmVuOiBEaXNwbGF5T2JqZWN0W107XG4gICAgcHVibGljIHNvcnRhYmxlQ2hpbGRyZW46IGJvb2xlYW47XG4gICAgcHVibGljIHNvcnREaXJ0eTogYm9vbGVhbjtcbiAgICBwdWJsaWMgY29udGFpbmVyVXBkYXRlVHJhbnNmb3JtOiAoKSA9PiB2b2lkO1xuXG4gICAgcHJvdGVjdGVkIF93aWR0aDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfaGVpZ2h0OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYXJyYXkgb2YgY2hpbGRyZW4gb2YgdGhpcyBjb250YWluZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRGlzcGxheU9iamVjdFtdfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgc2V0IHRvIHRydWUsIHRoZSBjb250YWluZXIgd2lsbCBzb3J0IGl0cyBjaGlsZHJlbiBieSB6SW5kZXggdmFsdWVcbiAgICAgICAgICogd2hlbiB1cGRhdGVUcmFuc2Zvcm0oKSBpcyBjYWxsZWQsIG9yIG1hbnVhbGx5IGlmIHNvcnRDaGlsZHJlbigpIGlzIGNhbGxlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBhY3R1YWxseSBjaGFuZ2VzIHRoZSBvcmRlciBvZiBlbGVtZW50cyBpbiB0aGUgYXJyYXksIHNvIHNob3VsZCBiZSB0cmVhdGVkXG4gICAgICAgICAqIGFzIGEgYmFzaWMgc29sdXRpb24gdGhhdCBpcyBub3QgcGVyZm9ybWFudCBjb21wYXJlZCB0byBvdGhlciBzb2x1dGlvbnMsXG4gICAgICAgICAqIHN1Y2ggYXMgQGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3BpeGlqcy9waXhpLWRpc3BsYXlcbiAgICAgICAgICpcbiAgICAgICAgICogQWxzbyBiZSBhd2FyZSBvZiB0aGF0IHRoaXMgbWF5IG5vdCB3b3JrIG5pY2VseSB3aXRoIHRoZSBhZGRDaGlsZEF0KCkgZnVuY3Rpb24sXG4gICAgICAgICAqIGFzIHRoZSB6SW5kZXggc29ydGluZyBtYXkgY2F1c2UgdGhlIGNoaWxkIHRvIGF1dG9tYXRpY2FsbHkgc29ydGVkIHRvIGFub3RoZXIgcG9zaXRpb24uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBzZWUgUElYSS5zZXR0aW5ncy5TT1JUQUJMRV9DSElMRFJFTlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zb3J0YWJsZUNoaWxkcmVuID0gc2V0dGluZ3MuU09SVEFCTEVfQ0hJTERSRU47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNob3VsZCBjaGlsZHJlbiBiZSBzb3J0ZWQgYnkgekluZGV4IGF0IHRoZSBuZXh0IHVwZGF0ZVRyYW5zZm9ybSBjYWxsLlxuICAgICAgICAgKiBXaWxsIGdldCBhdXRvbWF0aWNhbGx5IHNldCB0byB0cnVlIGlmIGEgbmV3IGNoaWxkIGlzIGFkZGVkLCBvciBpZiBhIGNoaWxkJ3MgekluZGV4IGNoYW5nZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNvcnREaXJ0eSA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgRGlzcGxheU9iamVjdCBpcyBhZGRlZCB0byB0aGlzIENvbnRhaW5lci5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuQ29udGFpbmVyI2NoaWxkQWRkZWRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGNoaWxkIC0gVGhlIGNoaWxkIGFkZGVkIHRvIHRoZSBDb250YWluZXIuXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5Db250YWluZXJ9IGNvbnRhaW5lciAtIFRoZSBjb250YWluZXIgdGhhdCBhZGRlZCB0aGUgY2hpbGQuXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBjaGlsZHJlbidzIGluZGV4IG9mIHRoZSBhZGRlZCBjaGlsZC5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBEaXNwbGF5T2JqZWN0IGlzIHJlbW92ZWQgZnJvbSB0aGlzIENvbnRhaW5lci5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNyZW1vdmVkRnJvbVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gY2hpbGQgLSBUaGUgY2hpbGQgcmVtb3ZlZCBmcm9tIHRoZSBDb250YWluZXIuXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5Db250YWluZXJ9IGNvbnRhaW5lciAtIFRoZSBjb250YWluZXIgdGhhdCByZW1vdmVkIHJlbW92ZWQgdGhlIGNoaWxkLlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgZm9ybWVyIGNoaWxkcmVuJ3MgaW5kZXggb2YgdGhlIHJlbW92ZWQgY2hpbGRcbiAgICAgICAgICovXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGFibGUgbWV0aG9kIHRoYXQgY2FuIGJlIHVzZWQgYnkgQ29udGFpbmVyIHN1YmNsYXNzZXMgd2hlbmV2ZXIgdGhlIGNoaWxkcmVuIGFycmF5IGlzIG1vZGlmaWVkXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIG9uQ2hpbGRyZW5DaGFuZ2UoX2xlbmd0aDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgLyogZW1wdHkgKi9cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIG9uZSBvciBtb3JlIGNoaWxkcmVuIHRvIHRoZSBjb250YWluZXIuXG4gICAgICpcbiAgICAgKiBNdWx0aXBsZSBpdGVtcyBjYW4gYmUgYWRkZWQgbGlrZSBzbzogYG15Q29udGFpbmVyLmFkZENoaWxkKHRoaW5nT25lLCB0aGluZ1R3bywgdGhpbmdUaHJlZSlgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gey4uLlBJWEkuRGlzcGxheU9iamVjdH0gY2hpbGRyZW4gLSBUaGUgRGlzcGxheU9iamVjdChzKSB0byBhZGQgdG8gdGhlIGNvbnRhaW5lclxuICAgICAqIEByZXR1cm4ge1BJWEkuRGlzcGxheU9iamVjdH0gVGhlIGZpcnN0IGNoaWxkIHRoYXQgd2FzIGFkZGVkLlxuICAgICAqL1xuICAgIGFkZENoaWxkPFQgZXh0ZW5kcyBEaXNwbGF5T2JqZWN0W10+KC4uLmNoaWxkcmVuOiBUKTogVFswXVxuICAgIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgb25seSBvbmUgYXJndW1lbnQgd2UgY2FuIGJ5cGFzcyBsb29waW5nIHRocm91Z2ggdGhlIHRoZW1cbiAgICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA+IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCB0aGUgYXJyYXkgYW5kIGFkZCBhbGwgY2hpbGRyZW5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1yZXN0LXBhcmFtc1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoY2hpbGRyZW5baV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlblswXTtcbiAgICAgICAgICAgIC8vIGlmIHRoZSBjaGlsZCBoYXMgYSBwYXJlbnQgdGhlbiBsZXRzIHJlbW92ZSBpdCBhcyBQaXhpSlMgb2JqZWN0cyBjYW4gb25seSBleGlzdCBpbiBvbmUgcGxhY2VcblxuICAgICAgICAgICAgaWYgKGNoaWxkLnBhcmVudClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5wYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5zb3J0RGlydHkgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyBlbnN1cmUgY2hpbGQgdHJhbnNmb3JtIHdpbGwgYmUgcmVjYWxjdWxhdGVkXG4gICAgICAgICAgICBjaGlsZC50cmFuc2Zvcm0uX3BhcmVudElEID0gLTE7XG5cbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XG5cbiAgICAgICAgICAgIC8vIGVuc3VyZSBib3VuZHMgd2lsbCBiZSByZWNhbGN1bGF0ZWRcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kc0lEKys7XG5cbiAgICAgICAgICAgIC8vIFRPRE8gLSBsZXRzIGVpdGhlciBkbyBhbGwgY2FsbGJhY2tzIG9yIGFsbCBldmVudHMuLiBub3QgYm90aCFcbiAgICAgICAgICAgIHRoaXMub25DaGlsZHJlbkNoYW5nZSh0aGlzLmNoaWxkcmVuLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdjaGlsZEFkZGVkJywgY2hpbGQsIHRoaXMsIHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBjaGlsZC5lbWl0KCdhZGRlZCcsIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuWzBdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBjaGlsZCB0byB0aGUgY29udGFpbmVyIGF0IGEgc3BlY2lmaWVkIGluZGV4LiBJZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kcyBhbiBlcnJvciB3aWxsIGJlIHRocm93blxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGNoaWxkIC0gVGhlIGNoaWxkIHRvIGFkZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBpbmRleCB0byBwbGFjZSB0aGUgY2hpbGQgaW5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkRpc3BsYXlPYmplY3R9IFRoZSBjaGlsZCB0aGF0IHdhcyBhZGRlZC5cbiAgICAgKi9cbiAgICBhZGRDaGlsZEF0PFQgZXh0ZW5kcyBEaXNwbGF5T2JqZWN0PihjaGlsZDogVCwgaW5kZXg6IG51bWJlcik6IFRcbiAgICB7XG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPiB0aGlzLmNoaWxkcmVuLmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2NoaWxkfWFkZENoaWxkQXQ6IFRoZSBpbmRleCAke2luZGV4fSBzdXBwbGllZCBpcyBvdXQgb2YgYm91bmRzICR7dGhpcy5jaGlsZHJlbi5sZW5ndGh9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hpbGQucGFyZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICAgICAgdGhpcy5zb3J0RGlydHkgPSB0cnVlO1xuXG4gICAgICAgIC8vIGVuc3VyZSBjaGlsZCB0cmFuc2Zvcm0gd2lsbCBiZSByZWNhbGN1bGF0ZWRcbiAgICAgICAgY2hpbGQudHJhbnNmb3JtLl9wYXJlbnRJRCA9IC0xO1xuXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAwLCBjaGlsZCk7XG5cbiAgICAgICAgLy8gZW5zdXJlIGJvdW5kcyB3aWxsIGJlIHJlY2FsY3VsYXRlZFxuICAgICAgICB0aGlzLl9ib3VuZHNJRCsrO1xuXG4gICAgICAgIC8vIFRPRE8gLSBsZXRzIGVpdGhlciBkbyBhbGwgY2FsbGJhY2tzIG9yIGFsbCBldmVudHMuLiBub3QgYm90aCFcbiAgICAgICAgdGhpcy5vbkNoaWxkcmVuQ2hhbmdlKGluZGV4KTtcbiAgICAgICAgY2hpbGQuZW1pdCgnYWRkZWQnLCB0aGlzKTtcbiAgICAgICAgdGhpcy5lbWl0KCdjaGlsZEFkZGVkJywgY2hpbGQsIHRoaXMsIGluZGV4KTtcblxuICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3dhcHMgdGhlIHBvc2l0aW9uIG9mIDIgRGlzcGxheSBPYmplY3RzIHdpdGhpbiB0aGlzIGNvbnRhaW5lci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBjaGlsZCAtIEZpcnN0IGRpc3BsYXkgb2JqZWN0IHRvIHN3YXBcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gY2hpbGQyIC0gU2Vjb25kIGRpc3BsYXkgb2JqZWN0IHRvIHN3YXBcbiAgICAgKi9cbiAgICBzd2FwQ2hpbGRyZW4oY2hpbGQ6IERpc3BsYXlPYmplY3QsIGNoaWxkMjogRGlzcGxheU9iamVjdCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChjaGlsZCA9PT0gY2hpbGQyKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpbmRleDEgPSB0aGlzLmdldENoaWxkSW5kZXgoY2hpbGQpO1xuICAgICAgICBjb25zdCBpbmRleDIgPSB0aGlzLmdldENoaWxkSW5kZXgoY2hpbGQyKTtcblxuICAgICAgICB0aGlzLmNoaWxkcmVuW2luZGV4MV0gPSBjaGlsZDI7XG4gICAgICAgIHRoaXMuY2hpbGRyZW5baW5kZXgyXSA9IGNoaWxkO1xuICAgICAgICB0aGlzLm9uQ2hpbGRyZW5DaGFuZ2UoaW5kZXgxIDwgaW5kZXgyID8gaW5kZXgxIDogaW5kZXgyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBwb3NpdGlvbiBvZiBhIGNoaWxkIERpc3BsYXlPYmplY3QgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBjaGlsZCAtIFRoZSBEaXNwbGF5T2JqZWN0IGluc3RhbmNlIHRvIGlkZW50aWZ5XG4gICAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgaW5kZXggcG9zaXRpb24gb2YgdGhlIGNoaWxkIGRpc3BsYXkgb2JqZWN0IHRvIGlkZW50aWZ5XG4gICAgICovXG4gICAgZ2V0Q2hpbGRJbmRleChjaGlsZDogRGlzcGxheU9iamVjdCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHN1cHBsaWVkIERpc3BsYXlPYmplY3QgbXVzdCBiZSBhIGNoaWxkIG9mIHRoZSBjYWxsZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBwb3NpdGlvbiBvZiBhbiBleGlzdGluZyBjaGlsZCBpbiB0aGUgZGlzcGxheSBvYmplY3QgY29udGFpbmVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gY2hpbGQgLSBUaGUgY2hpbGQgRGlzcGxheU9iamVjdCBpbnN0YW5jZSBmb3Igd2hpY2ggeW91IHdhbnQgdG8gY2hhbmdlIHRoZSBpbmRleCBudW1iZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgcmVzdWx0aW5nIGluZGV4IG51bWJlciBmb3IgdGhlIGNoaWxkIGRpc3BsYXkgb2JqZWN0XG4gICAgICovXG4gICAgc2V0Q2hpbGRJbmRleChjaGlsZDogRGlzcGxheU9iamVjdCwgaW5kZXg6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5jaGlsZHJlbi5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGluZGV4ICR7aW5kZXh9IHN1cHBsaWVkIGlzIG91dCBvZiBib3VuZHMgJHt0aGlzLmNoaWxkcmVuLmxlbmd0aH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IHRoaXMuZ2V0Q2hpbGRJbmRleChjaGlsZCk7XG5cbiAgICAgICAgcmVtb3ZlSXRlbXModGhpcy5jaGlsZHJlbiwgY3VycmVudEluZGV4LCAxKTsgLy8gcmVtb3ZlIGZyb20gb2xkIHBvc2l0aW9uXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAwLCBjaGlsZCk7IC8vIGFkZCBhdCBuZXcgcG9zaXRpb25cblxuICAgICAgICB0aGlzLm9uQ2hpbGRyZW5DaGFuZ2UoaW5kZXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGNoaWxkIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBpbmRleCB0byBnZXQgdGhlIGNoaWxkIGF0XG4gICAgICogQHJldHVybiB7UElYSS5EaXNwbGF5T2JqZWN0fSBUaGUgY2hpbGQgYXQgdGhlIGdpdmVuIGluZGV4LCBpZiBhbnkuXG4gICAgICovXG4gICAgZ2V0Q2hpbGRBdChpbmRleDogbnVtYmVyKTogRGlzcGxheU9iamVjdFxuICAgIHtcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmNoaWxkcmVuLmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBnZXRDaGlsZEF0OiBJbmRleCAoJHtpbmRleH0pIGRvZXMgbm90IGV4aXN0LmApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5baW5kZXhdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgb25lIG9yIG1vcmUgY2hpbGRyZW4gZnJvbSB0aGUgY29udGFpbmVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHsuLi5QSVhJLkRpc3BsYXlPYmplY3R9IGNoaWxkcmVuIC0gVGhlIERpc3BsYXlPYmplY3QocykgdG8gcmVtb3ZlXG4gICAgICogQHJldHVybiB7UElYSS5EaXNwbGF5T2JqZWN0fSBUaGUgZmlyc3QgY2hpbGQgdGhhdCB3YXMgcmVtb3ZlZC5cbiAgICAgKi9cbiAgICByZW1vdmVDaGlsZDxUIGV4dGVuZHMgRGlzcGxheU9iamVjdFtdPiguLi5jaGlsZHJlbjogVCk6IFRbMF1cbiAgICB7XG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lIGFyZ3VtZW50IHdlIGNhbiBieXBhc3MgbG9vcGluZyB0aHJvdWdoIHRoZSB0aGVtXG4gICAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAxKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBsb29wIHRocm91Z2ggdGhlIGFyZ3VtZW50cyBwcm9wZXJ0eSBhbmQgcmVtb3ZlIGFsbCBjaGlsZHJlblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKGNoaWxkcmVuW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5bMF07XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgLy8gZW5zdXJlIGNoaWxkIHRyYW5zZm9ybSB3aWxsIGJlIHJlY2FsY3VsYXRlZFxuICAgICAgICAgICAgY2hpbGQudHJhbnNmb3JtLl9wYXJlbnRJRCA9IC0xO1xuICAgICAgICAgICAgcmVtb3ZlSXRlbXModGhpcy5jaGlsZHJlbiwgaW5kZXgsIDEpO1xuXG4gICAgICAgICAgICAvLyBlbnN1cmUgYm91bmRzIHdpbGwgYmUgcmVjYWxjdWxhdGVkXG4gICAgICAgICAgICB0aGlzLl9ib3VuZHNJRCsrO1xuXG4gICAgICAgICAgICAvLyBUT0RPIC0gbGV0cyBlaXRoZXIgZG8gYWxsIGNhbGxiYWNrcyBvciBhbGwgZXZlbnRzLi4gbm90IGJvdGghXG4gICAgICAgICAgICB0aGlzLm9uQ2hpbGRyZW5DaGFuZ2UoaW5kZXgpO1xuICAgICAgICAgICAgY2hpbGQuZW1pdCgncmVtb3ZlZCcsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdjaGlsZFJlbW92ZWQnLCBjaGlsZCwgdGhpcywgaW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuWzBdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBjaGlsZCBmcm9tIHRoZSBzcGVjaWZpZWQgaW5kZXggcG9zaXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgaW5kZXggdG8gZ2V0IHRoZSBjaGlsZCBmcm9tXG4gICAgICogQHJldHVybiB7UElYSS5EaXNwbGF5T2JqZWN0fSBUaGUgY2hpbGQgdGhhdCB3YXMgcmVtb3ZlZC5cbiAgICAgKi9cbiAgICByZW1vdmVDaGlsZEF0KGluZGV4OiBudW1iZXIpOiBEaXNwbGF5T2JqZWN0XG4gICAge1xuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuZ2V0Q2hpbGRBdChpbmRleCk7XG5cbiAgICAgICAgLy8gZW5zdXJlIGNoaWxkIHRyYW5zZm9ybSB3aWxsIGJlIHJlY2FsY3VsYXRlZC4uXG4gICAgICAgIGNoaWxkLnBhcmVudCA9IG51bGw7XG4gICAgICAgIGNoaWxkLnRyYW5zZm9ybS5fcGFyZW50SUQgPSAtMTtcbiAgICAgICAgcmVtb3ZlSXRlbXModGhpcy5jaGlsZHJlbiwgaW5kZXgsIDEpO1xuXG4gICAgICAgIC8vIGVuc3VyZSBib3VuZHMgd2lsbCBiZSByZWNhbGN1bGF0ZWRcbiAgICAgICAgdGhpcy5fYm91bmRzSUQrKztcblxuICAgICAgICAvLyBUT0RPIC0gbGV0cyBlaXRoZXIgZG8gYWxsIGNhbGxiYWNrcyBvciBhbGwgZXZlbnRzLi4gbm90IGJvdGghXG4gICAgICAgIHRoaXMub25DaGlsZHJlbkNoYW5nZShpbmRleCk7XG4gICAgICAgIGNoaWxkLmVtaXQoJ3JlbW92ZWQnLCB0aGlzKTtcbiAgICAgICAgdGhpcy5lbWl0KCdjaGlsZFJlbW92ZWQnLCBjaGlsZCwgdGhpcywgaW5kZXgpO1xuXG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFsbCBjaGlsZHJlbiBmcm9tIHRoaXMgY29udGFpbmVyIHRoYXQgYXJlIHdpdGhpbiB0aGUgYmVnaW4gYW5kIGVuZCBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtiZWdpbkluZGV4PTBdIC0gVGhlIGJlZ2lubmluZyBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2VuZEluZGV4PXRoaXMuY2hpbGRyZW4ubGVuZ3RoXSAtIFRoZSBlbmRpbmcgcG9zaXRpb24uIERlZmF1bHQgdmFsdWUgaXMgc2l6ZSBvZiB0aGUgY29udGFpbmVyLlxuICAgICAqIEByZXR1cm5zIHtQSVhJLkRpc3BsYXlPYmplY3RbXX0gTGlzdCBvZiByZW1vdmVkIGNoaWxkcmVuXG4gICAgICovXG4gICAgcmVtb3ZlQ2hpbGRyZW4oYmVnaW5JbmRleCA9IDAsIGVuZEluZGV4ID0gdGhpcy5jaGlsZHJlbi5sZW5ndGgpOiBEaXNwbGF5T2JqZWN0W11cbiAgICB7XG4gICAgICAgIGNvbnN0IGJlZ2luID0gYmVnaW5JbmRleDtcbiAgICAgICAgY29uc3QgZW5kID0gZW5kSW5kZXg7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gZW5kIC0gYmVnaW47XG4gICAgICAgIGxldCByZW1vdmVkO1xuXG4gICAgICAgIGlmIChyYW5nZSA+IDAgJiYgcmFuZ2UgPD0gZW5kKVxuICAgICAgICB7XG4gICAgICAgICAgICByZW1vdmVkID0gdGhpcy5jaGlsZHJlbi5zcGxpY2UoYmVnaW4sIHJhbmdlKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkLmxlbmd0aDsgKytpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlbW92ZWRbaV0ucGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAocmVtb3ZlZFtpXS50cmFuc2Zvcm0pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVkW2ldLnRyYW5zZm9ybS5fcGFyZW50SUQgPSAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2JvdW5kc0lEKys7XG5cbiAgICAgICAgICAgIHRoaXMub25DaGlsZHJlbkNoYW5nZShiZWdpbkluZGV4KTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkLmxlbmd0aDsgKytpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlbW92ZWRbaV0uZW1pdCgncmVtb3ZlZCcsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnY2hpbGRSZW1vdmVkJywgcmVtb3ZlZFtpXSwgdGhpcywgaSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZW1vdmVkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJhbmdlID09PSAwICYmIHRoaXMuY2hpbGRyZW4ubGVuZ3RoID09PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigncmVtb3ZlQ2hpbGRyZW46IG51bWVyaWMgdmFsdWVzIGFyZSBvdXRzaWRlIHRoZSBhY2NlcHRhYmxlIHJhbmdlLicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNvcnRzIGNoaWxkcmVuIGJ5IHpJbmRleC4gUHJldmlvdXMgb3JkZXIgaXMgbWFudGFpbmVkIGZvciAyIGNoaWxkcmVuIHdpdGggdGhlIHNhbWUgekluZGV4LlxuICAgICAqL1xuICAgIHNvcnRDaGlsZHJlbigpOiB2b2lkXG4gICAge1xuICAgICAgICBsZXQgc29ydFJlcXVpcmVkID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSB0aGlzLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBjaGlsZC5fbGFzdFNvcnRlZEluZGV4ID0gaTtcblxuICAgICAgICAgICAgaWYgKCFzb3J0UmVxdWlyZWQgJiYgY2hpbGQuekluZGV4ICE9PSAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNvcnRSZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc29ydFJlcXVpcmVkICYmIHRoaXMuY2hpbGRyZW4ubGVuZ3RoID4gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zb3J0KHNvcnRDaGlsZHJlbik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNvcnREaXJ0eSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHRyYW5zZm9ybSBvbiBhbGwgY2hpbGRyZW4gb2YgdGhpcyBjb250YWluZXIgZm9yIHJlbmRlcmluZ1xuICAgICAqL1xuICAgIHVwZGF0ZVRyYW5zZm9ybSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5zb3J0YWJsZUNoaWxkcmVuICYmIHRoaXMuc29ydERpcnR5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNvcnRDaGlsZHJlbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYm91bmRzSUQrKztcblxuICAgICAgICB0aGlzLnRyYW5zZm9ybS51cGRhdGVUcmFuc2Zvcm0odGhpcy5wYXJlbnQudHJhbnNmb3JtKTtcblxuICAgICAgICAvLyBUT0RPOiBjaGVjayByZW5kZXIgZmxhZ3MsIGhvdyB0byBwcm9jZXNzIHN0dWZmIGhlcmVcbiAgICAgICAgdGhpcy53b3JsZEFscGhhID0gdGhpcy5hbHBoYSAqIHRoaXMucGFyZW50LndvcmxkQWxwaGE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSB0aGlzLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBpZiAoY2hpbGQudmlzaWJsZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGlsZC51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlY2FsY3VsYXRlcyB0aGUgYm91bmRzIG9mIHRoZSBjb250YWluZXIuXG4gICAgICpcbiAgICAgKi9cbiAgICBjYWxjdWxhdGVCb3VuZHMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fYm91bmRzLmNsZWFyKCk7XG5cbiAgICAgICAgdGhpcy5fY2FsY3VsYXRlQm91bmRzKCk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgIGlmICghY2hpbGQudmlzaWJsZSB8fCAhY2hpbGQucmVuZGVyYWJsZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2hpbGQuY2FsY3VsYXRlQm91bmRzKCk7XG5cbiAgICAgICAgICAgIC8vIFRPRE86IGZpbHRlcittYXNrLCBuZWVkIHRvIG1hc2sgYm90aCBzb21laG93XG4gICAgICAgICAgICBpZiAoY2hpbGQuX21hc2spXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFza09iamVjdCA9ICgoY2hpbGQuX21hc2sgYXMgTWFza0RhdGEpLm1hc2tPYmplY3QgfHwgY2hpbGQuX21hc2spIGFzIENvbnRhaW5lcjtcblxuICAgICAgICAgICAgICAgIG1hc2tPYmplY3QuY2FsY3VsYXRlQm91bmRzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRzLmFkZEJvdW5kc01hc2soY2hpbGQuX2JvdW5kcywgbWFza09iamVjdC5fYm91bmRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkLmZpbHRlckFyZWEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRzLmFkZEJvdW5kc0FyZWEoY2hpbGQuX2JvdW5kcywgY2hpbGQuZmlsdGVyQXJlYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRzLmFkZEJvdW5kcyhjaGlsZC5fYm91bmRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2JvdW5kcy51cGRhdGVJRCA9IHRoaXMuX2JvdW5kc0lEO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgbG9jYWwgYm91bmRzIG9mIHRoZSBkaXNwbGF5T2JqZWN0IGFzIGEgcmVjdGFuZ2xlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtyZWN0XSAtIE9wdGlvbmFsIHJlY3RhbmdsZSB0byBzdG9yZSB0aGUgcmVzdWx0IG9mIHRoZSBib3VuZHMgY2FsY3VsYXRpb24uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc2tpcENoaWxkcmVuVXBkYXRlPWZhbHNlXSAtIFNldHRpbmcgdG8gYHRydWVgIHdpbGwgc3RvcCByZS1jYWxjdWxhdGlvbiBvZiBjaGlsZHJlbiB0cmFuc2Zvcm1zLFxuICAgICAqICBpdCB3YXMgZGVmYXVsdCBiZWhhdmlvdXIgb2YgcGl4aSA0LjAtNS4yIGFuZCBjYXVzZWQgbWFueSBwcm9ibGVtcyB0byB1c2Vycy5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gVGhlIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGFyZWEuXG4gICAgICovXG4gICAgcHVibGljIGdldExvY2FsQm91bmRzKHJlY3Q/OiBSZWN0YW5nbGUsIHNraXBDaGlsZHJlblVwZGF0ZSA9IGZhbHNlKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzdXBlci5nZXRMb2NhbEJvdW5kcyhyZWN0KTtcblxuICAgICAgICBpZiAoIXNraXBDaGlsZHJlblVwZGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7ICsraSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQudmlzaWJsZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjYWxjdWxhdGVzIHRoZSBib3VuZHMgb2YgdGhlIG9iamVjdC4gT3ZlcnJpZGUgdGhpcyB0b1xuICAgICAqIGNhbGN1bGF0ZSB0aGUgYm91bmRzIG9mIHRoZSBzcGVjaWZpYyBvYmplY3QgKG5vdCBpbmNsdWRpbmcgY2hpbGRyZW4pLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY2FsY3VsYXRlQm91bmRzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIEZJTEwgSU4vL1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgdGhlIG9iamVjdCB1c2luZyB0aGUgV2ViR0wgcmVuZGVyZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXJcbiAgICAgKi9cbiAgICByZW5kZXIocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gaWYgdGhlIG9iamVjdCBpcyBub3QgdmlzaWJsZSBvciB0aGUgYWxwaGEgaXMgMCB0aGVuIG5vIG5lZWQgdG8gcmVuZGVyIHRoaXMgZWxlbWVudFxuICAgICAgICBpZiAoIXRoaXMudmlzaWJsZSB8fCB0aGlzLndvcmxkQWxwaGEgPD0gMCB8fCAhdGhpcy5yZW5kZXJhYmxlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkbyBhIHF1aWNrIGNoZWNrIHRvIHNlZSBpZiB0aGlzIGVsZW1lbnQgaGFzIGEgbWFzayBvciBhIGZpbHRlci5cbiAgICAgICAgaWYgKHRoaXMuX21hc2sgfHwgKHRoaXMuZmlsdGVycyAmJiB0aGlzLmZpbHRlcnMubGVuZ3RoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJBZHZhbmNlZChyZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXIocmVuZGVyZXIpO1xuXG4gICAgICAgICAgICAvLyBzaW1wbGUgcmVuZGVyIGNoaWxkcmVuIVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7ICsraSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLnJlbmRlcihyZW5kZXJlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIG9iamVjdCB1c2luZyB0aGUgV2ViR0wgcmVuZGVyZXIgYW5kIGFkdmFuY2VkIGZlYXR1cmVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgcmVuZGVyQWR2YW5jZWQocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guZmx1c2goKTtcblxuICAgICAgICBjb25zdCBmaWx0ZXJzID0gdGhpcy5maWx0ZXJzO1xuICAgICAgICBjb25zdCBtYXNrID0gdGhpcy5fbWFzaztcblxuICAgICAgICAvLyBwdXNoIGZpbHRlciBmaXJzdCBhcyB3ZSBuZWVkIHRvIGVuc3VyZSB0aGUgc3RlbmNpbCBidWZmZXIgaXMgY29ycmVjdCBmb3IgYW55IG1hc2tpbmdcbiAgICAgICAgaWYgKGZpbHRlcnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZW5hYmxlZEZpbHRlcnMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlZEZpbHRlcnMgPSBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZW5hYmxlZEZpbHRlcnMubGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJzW2ldLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbmFibGVkRmlsdGVycy5wdXNoKGZpbHRlcnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2VuYWJsZWRGaWx0ZXJzLmxlbmd0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZW5kZXJlci5maWx0ZXIucHVzaCh0aGlzLCB0aGlzLl9lbmFibGVkRmlsdGVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWFzaylcbiAgICAgICAge1xuICAgICAgICAgICAgcmVuZGVyZXIubWFzay5wdXNoKHRoaXMsIHRoaXMuX21hc2spO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIHRoaXMgb2JqZWN0IHRvIHRoZSBiYXRjaCwgb25seSByZW5kZXJlZCBpZiBpdCBoYXMgYSB0ZXh0dXJlLlxuICAgICAgICB0aGlzLl9yZW5kZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8vIG5vdyBsb29wIHRocm91Z2ggdGhlIGNoaWxkcmVuIGFuZCBtYWtlIHN1cmUgdGhleSBnZXQgcmVuZGVyZWRcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbltpXS5yZW5kZXIocmVuZGVyZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guZmx1c2goKTtcblxuICAgICAgICBpZiAobWFzaylcbiAgICAgICAge1xuICAgICAgICAgICAgcmVuZGVyZXIubWFzay5wb3AodGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmlsdGVycyAmJiB0aGlzLl9lbmFibGVkRmlsdGVycyAmJiB0aGlzLl9lbmFibGVkRmlsdGVycy5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLmZpbHRlci5wb3AoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRvIGJlIG92ZXJyaWRkZW4gYnkgdGhlIHN1YmNsYXNzZXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlclxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfcmVuZGVyKF9yZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICB7XG4gICAgICAgIC8vIHRoaXMgaXMgd2hlcmUgY29udGVudCBpdHNlbGYgZ2V0cyByZW5kZXJlZC4uLlxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGludGVybmFsIHJlZmVyZW5jZXMgYW5kIGxpc3RlbmVycyBhcyB3ZWxsIGFzIHJlbW92ZXMgY2hpbGRyZW4gZnJvbSB0aGUgZGlzcGxheSBsaXN0LlxuICAgICAqIERvIG5vdCB1c2UgYSBDb250YWluZXIgYWZ0ZXIgY2FsbGluZyBgZGVzdHJveWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdHxib29sZWFufSBbb3B0aW9uc10gLSBPcHRpb25zIHBhcmFtZXRlci4gQSBib29sZWFuIHdpbGwgYWN0IGFzIGlmIGFsbCBvcHRpb25zXG4gICAgICogIGhhdmUgYmVlbiBzZXQgdG8gdGhhdCB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gaWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlIHRoZWlyIGRlc3Ryb3lcbiAgICAgKiAgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50ZXh0dXJlPWZhbHNlXSAtIE9ubHkgdXNlZCBmb3IgY2hpbGQgU3ByaXRlcyBpZiBvcHRpb25zLmNoaWxkcmVuIGlzIHNldCB0byB0cnVlXG4gICAgICogIFNob3VsZCBpdCBkZXN0cm95IHRoZSB0ZXh0dXJlIG9mIHRoZSBjaGlsZCBzcHJpdGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmJhc2VUZXh0dXJlPWZhbHNlXSAtIE9ubHkgdXNlZCBmb3IgY2hpbGQgU3ByaXRlcyBpZiBvcHRpb25zLmNoaWxkcmVuIGlzIHNldCB0byB0cnVlXG4gICAgICogIFNob3VsZCBpdCBkZXN0cm95IHRoZSBiYXNlIHRleHR1cmUgb2YgdGhlIGNoaWxkIHNwcml0ZVxuICAgICAqL1xuICAgIGRlc3Ryb3kob3B0aW9ucz86IElEZXN0cm95T3B0aW9uc3xib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xuXG4gICAgICAgIHRoaXMuc29ydERpcnR5ID0gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgZGVzdHJveUNoaWxkcmVuID0gdHlwZW9mIG9wdGlvbnMgPT09ICdib29sZWFuJyA/IG9wdGlvbnMgOiBvcHRpb25zICYmIG9wdGlvbnMuY2hpbGRyZW47XG5cbiAgICAgICAgY29uc3Qgb2xkQ2hpbGRyZW4gPSB0aGlzLnJlbW92ZUNoaWxkcmVuKDAsIHRoaXMuY2hpbGRyZW4ubGVuZ3RoKTtcblxuICAgICAgICBpZiAoZGVzdHJveUNoaWxkcmVuKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9sZENoaWxkcmVuLmxlbmd0aDsgKytpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG9sZENoaWxkcmVuW2ldLmRlc3Ryb3kob3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIENvbnRhaW5lciwgc2V0dGluZyB0aGlzIHdpbGwgYWN0dWFsbHkgbW9kaWZ5IHRoZSBzY2FsZSB0byBhY2hpZXZlIHRoZSB2YWx1ZSBzZXRcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgd2lkdGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2FsZS54ICogdGhpcy5nZXRMb2NhbEJvdW5kcygpLndpZHRoO1xuICAgIH1cblxuICAgIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLmdldExvY2FsQm91bmRzKCkud2lkdGg7XG5cbiAgICAgICAgaWYgKHdpZHRoICE9PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNjYWxlLnggPSB2YWx1ZSAvIHdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zY2FsZS54ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3dpZHRoID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgQ29udGFpbmVyLCBzZXR0aW5nIHRoaXMgd2lsbCBhY3R1YWxseSBtb2RpZnkgdGhlIHNjYWxlIHRvIGFjaGlldmUgdGhlIHZhbHVlIHNldFxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBoZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2FsZS55ICogdGhpcy5nZXRMb2NhbEJvdW5kcygpLmhlaWdodDtcbiAgICB9XG5cbiAgICBzZXQgaGVpZ2h0KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmdldExvY2FsQm91bmRzKCkuaGVpZ2h0O1xuXG4gICAgICAgIGlmIChoZWlnaHQgIT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2NhbGUueSA9IHZhbHVlIC8gaGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zY2FsZS55ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHZhbHVlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb250YWluZXIgZGVmYXVsdCB1cGRhdGVUcmFuc2Zvcm0sIGRvZXMgdXBkYXRlIGNoaWxkcmVuIG9mIGNvbnRhaW5lci5cbiAqIFdpbGwgY3Jhc2ggaWYgdGhlcmUncyBubyBwYXJlbnQgZWxlbWVudC5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS5Db250YWluZXIjXG4gKiBAZnVuY3Rpb24gY29udGFpbmVyVXBkYXRlVHJhbnNmb3JtXG4gKi9cbkNvbnRhaW5lci5wcm90b3R5cGUuY29udGFpbmVyVXBkYXRlVHJhbnNmb3JtID0gQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVUcmFuc2Zvcm07XG4iLCAiaW1wb3J0IHR5cGUgeyBEaXNwbGF5T2JqZWN0IH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5cbmV4cG9ydCB0eXBlIFBvaW50ZXJFdmVudHMgPSAnYXV0bydcbnwgJ25vbmUnXG58ICd2aXNpYmxlUGFpbnRlZCdcbnwgJ3Zpc2libGVGaWxsJ1xufCAndmlzaWJsZVN0cm9rZSdcbnwgJ3Zpc2libGUnXG58ICdwYWludGVkJ1xufCAnZmlsbCdcbnwgJ3N0cm9rZSdcbnwgJ2FsbCdcbnwgJ2luaGVyaXQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElBY2Nlc3NpYmxlVGFyZ2V0IHtcbiAgICBhY2Nlc3NpYmxlOiBib29sZWFuO1xuICAgIGFjY2Vzc2libGVUaXRsZTogc3RyaW5nO1xuICAgIGFjY2Vzc2libGVIaW50OiBzdHJpbmc7XG4gICAgdGFiSW5kZXg6IG51bWJlcjtcbiAgICBfYWNjZXNzaWJsZUFjdGl2ZTogYm9vbGVhbjtcbiAgICBfYWNjZXNzaWJsZURpdjogSUFjY2Vzc2libGVIVE1MRWxlbWVudDtcbiAgICBhY2Nlc3NpYmxlVHlwZTogc3RyaW5nO1xuICAgIGFjY2Vzc2libGVQb2ludGVyRXZlbnRzOiBQb2ludGVyRXZlbnRzO1xuICAgIGFjY2Vzc2libGVDaGlsZHJlbjogdHJ1ZTtcbiAgICByZW5kZXJJZDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElBY2Nlc3NpYmxlSFRNTEVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgdHlwZT86IHN0cmluZztcbiAgICBkaXNwbGF5T2JqZWN0PzogRGlzcGxheU9iamVjdDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IHByb3BlcnR5IHZhbHVlcyBvZiBhY2Nlc3NpYmxlIG9iamVjdHNcbiAqIHVzZWQgYnkge0BsaW5rIFBJWEkuQWNjZXNzaWJpbGl0eU1hbmFnZXJ9LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAZnVuY3Rpb24gYWNjZXNzaWJsZVRhcmdldFxuICogQG1lbWJlcm9mIFBJWElcbiAqIEB0eXBlIHtPYmplY3R9XG4gKiBAZXhhbXBsZVxuICogICAgICBmdW5jdGlvbiBNeU9iamVjdCgpIHt9XG4gKlxuICogICAgICBPYmplY3QuYXNzaWduKFxuICogICAgICAgICAgTXlPYmplY3QucHJvdG90eXBlLFxuICogICAgICAgICAgUElYSS5hY2Nlc3NpYmxlVGFyZ2V0XG4gKiAgICAgICk7XG4gKi9cbmV4cG9ydCBjb25zdCBhY2Nlc3NpYmxlVGFyZ2V0OiBJQWNjZXNzaWJsZVRhcmdldCA9IHtcbiAgICAvKipcbiAgICAgKiAgRmxhZyBmb3IgaWYgdGhlIG9iamVjdCBpcyBhY2Nlc3NpYmxlLiBJZiB0cnVlIEFjY2Vzc2liaWxpdHlNYW5hZ2VyIHdpbGwgb3ZlcmxheSBhXG4gICAgICogICBzaGFkb3cgZGl2IHdpdGggYXR0cmlidXRlcyBzZXRcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQG1lbWJlcm9mIFBJWEkuRGlzcGxheU9iamVjdCNcbiAgICAgKi9cbiAgICBhY2Nlc3NpYmxlOiBmYWxzZSxcblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgc2hhZG93IGRpdlxuICAgICAqIElmIGFjY2Vzc2libGVUaXRsZSBBTkQgYWNjZXNzaWJsZUhpbnQgaGFzIG5vdCBiZWVuIHRoaXMgd2lsbCBkZWZhdWx0IHRvICdkaXNwbGF5T2JqZWN0IFt0YWJJbmRleF0nXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHs/c3RyaW5nfVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICovXG4gICAgYWNjZXNzaWJsZVRpdGxlOiBudWxsLFxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYXJpYS1sYWJlbCBhdHRyaWJ1dGUgb2YgdGhlIHNoYWRvdyBkaXZcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5EaXNwbGF5T2JqZWN0I1xuICAgICAqL1xuICAgIGFjY2Vzc2libGVIaW50OiBudWxsLFxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAdG9kbyBOZWVkcyBkb2NzLlxuICAgICAqL1xuICAgIHRhYkluZGV4OiAwLFxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5EaXNwbGF5T2JqZWN0I1xuICAgICAqIEB0b2RvIE5lZWRzIGRvY3MuXG4gICAgICovXG4gICAgX2FjY2Vzc2libGVBY3RpdmU6IGZhbHNlLFxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5EaXNwbGF5T2JqZWN0I1xuICAgICAqIEB0b2RvIE5lZWRzIGRvY3MuXG4gICAgICovXG4gICAgX2FjY2Vzc2libGVEaXY6IG51bGwsXG5cbiAgICAvKipcbiAgICAgKiBTcGVjaWZ5IHRoZSB0eXBlIG9mIGRpdiB0aGUgYWNjZXNzaWJsZSBsYXllciBpcy4gU2NyZWVuIHJlYWRlcnMgdHJlYXQgdGhlIGVsZW1lbnQgZGlmZmVyZW50bHlcbiAgICAgKiBkZXBlbmRpbmcgb24gdGhpcyB0eXBlLiBEZWZhdWx0cyB0byBidXR0b24uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICogQG1lbWJlcm9mIFBJWEkuRGlzcGxheU9iamVjdCNcbiAgICAgKiBAZGVmYXVsdCAnYnV0dG9uJ1xuICAgICAqL1xuICAgIGFjY2Vzc2libGVUeXBlOiAnYnV0dG9uJyxcblxuICAgIC8qKlxuICAgICAqIFNwZWNpZnkgdGhlIHBvaW50ZXItZXZlbnRzIHRoZSBhY2Nlc3NpYmxlIGRpdiB3aWxsIHVzZVxuICAgICAqIERlZmF1bHRzIHRvIGF1dG8uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICogQG1lbWJlcm9mIFBJWEkuRGlzcGxheU9iamVjdCNcbiAgICAgKiBAZGVmYXVsdCAnYXV0bydcbiAgICAgKi9cbiAgICBhY2Nlc3NpYmxlUG9pbnRlckV2ZW50czogJ2F1dG8nLFxuXG4gICAgLyoqXG4gICAgICogU2V0dGluZyB0byBmYWxzZSB3aWxsIHByZXZlbnQgYW55IGNoaWxkcmVuIGluc2lkZSB0aGlzIGNvbnRhaW5lciB0b1xuICAgICAqIGJlIGFjY2Vzc2libGUuIERlZmF1bHRzIHRvIHRydWUuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAqL1xuICAgIGFjY2Vzc2libGVDaGlsZHJlbjogdHJ1ZSxcblxuICAgIHJlbmRlcklkOiAtMSxcbn07XG4iLCAiaW1wb3J0IHsgRGlzcGxheU9iamVjdCB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHsgaXNNb2JpbGUsIHJlbW92ZUl0ZW1zIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgYWNjZXNzaWJsZVRhcmdldCB9IGZyb20gJy4vYWNjZXNzaWJsZVRhcmdldCc7XG5cbmltcG9ydCB0eXBlIHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgdHlwZSB7IENvbnRhaW5lciB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciwgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBJQWNjZXNzaWJsZUhUTUxFbGVtZW50IH0gZnJvbSAnLi9hY2Nlc3NpYmxlVGFyZ2V0JztcblxuLy8gYWRkIHNvbWUgZXh0cmEgdmFyaWFibGVzIHRvIHRoZSBjb250YWluZXIuLlxuRGlzcGxheU9iamVjdC5taXhpbihhY2Nlc3NpYmxlVGFyZ2V0KTtcblxuY29uc3QgS0VZX0NPREVfVEFCID0gOTtcblxuY29uc3QgRElWX1RPVUNIX1NJWkUgPSAxMDA7XG5jb25zdCBESVZfVE9VQ0hfUE9TX1ggPSAwO1xuY29uc3QgRElWX1RPVUNIX1BPU19ZID0gMDtcbmNvbnN0IERJVl9UT1VDSF9aSU5ERVggPSAyO1xuXG5jb25zdCBESVZfSE9PS19TSVpFID0gMTtcbmNvbnN0IERJVl9IT09LX1BPU19YID0gLTEwMDA7XG5jb25zdCBESVZfSE9PS19QT1NfWSA9IC0xMDAwO1xuY29uc3QgRElWX0hPT0tfWklOREVYID0gMjtcblxuLyoqXG4gKiBUaGUgQWNjZXNzaWJpbGl0eSBtYW5hZ2VyIHJlY3JlYXRlcyB0aGUgYWJpbGl0eSB0byB0YWIgYW5kIGhhdmUgY29udGVudCByZWFkIGJ5IHNjcmVlbiByZWFkZXJzLlxuICogVGhpcyBpcyB2ZXJ5IGltcG9ydGFudCBhcyBpdCBjYW4gcG9zc2libHkgaGVscCBwZW9wbGUgd2l0aCBkaXNhYmlsaXRpZXMgYWNjZXNzIFBpeGlKUyBjb250ZW50LlxuICpcbiAqIEEgRGlzcGxheU9iamVjdCBjYW4gYmUgbWFkZSBhY2Nlc3NpYmxlIGp1c3QgbGlrZSBpdCBjYW4gYmUgbWFkZSBpbnRlcmFjdGl2ZS4gVGhpcyBtYW5hZ2VyIHdpbGwgbWFwIHRoZVxuICogZXZlbnRzIGFzIGlmIHRoZSBtb3VzZSB3YXMgYmVpbmcgdXNlZCwgbWluaW1pemluZyB0aGUgZWZmb3J0IHJlcXVpcmVkIHRvIGltcGxlbWVudC5cbiAqXG4gKiBBbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgY3JlYXRlZCBieSBkZWZhdWx0LCBhbmQgY2FuIGJlIGZvdW5kIGF0IGByZW5kZXJlci5wbHVnaW5zLmFjY2Vzc2liaWxpdHlgXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQWNjZXNzaWJpbGl0eU1hbmFnZXJcbntcbiAgICBwdWJsaWMgZGVidWc6IGJvb2xlYW47XG4gICAgcHVibGljIHJlbmRlcmVyOiBBYnN0cmFjdFJlbmRlcmVyfFJlbmRlcmVyO1xuXG4gICAgcHJpdmF0ZSBfaXNBY3RpdmU6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBfaXNNb2JpbGVBY2Nlc3NpYmlsaXR5OiBib29sZWFuO1xuICAgIHByaXZhdGUgX2hvb2tEaXY6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgZGl2OiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHBvb2w6IElBY2Nlc3NpYmxlSFRNTEVsZW1lbnRbXTtcbiAgICBwcml2YXRlIHJlbmRlcklkOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBjaGlsZHJlbjogRGlzcGxheU9iamVjdFtdO1xuICAgIHByaXZhdGUgYW5kcm9pZFVwZGF0ZUNvdW50OiBudW1iZXI7XG4gICAgcHJpdmF0ZSBhbmRyb2lkVXBkYXRlRnJlcXVlbmN5OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ2FudmFzUmVuZGVyZXJ8UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBBIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCByZW5kZXJlclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBBYnN0cmFjdFJlbmRlcmVyfFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHs/SFRNTEVsZW1lbnR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9ob29rRGl2ID0gbnVsbDtcblxuICAgICAgICBpZiAoaXNNb2JpbGUudGFibGV0IHx8IGlzTW9iaWxlLnBob25lKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVRvdWNoSG9vaygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZmlyc3Qgd2UgY3JlYXRlIGEgZGl2IHRoYXQgd2lsbCBzaXQgb3ZlciB0aGUgUGl4aUpTIGVsZW1lbnQuIFRoaXMgaXMgd2hlcmUgdGhlIGRpdiBvdmVybGF5cyB3aWxsIGdvLlxuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICBkaXYuc3R5bGUud2lkdGggPSBgJHtESVZfVE9VQ0hfU0laRX1weGA7XG4gICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSBgJHtESVZfVE9VQ0hfU0laRX1weGA7XG4gICAgICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGRpdi5zdHlsZS50b3AgPSBgJHtESVZfVE9VQ0hfUE9TX1h9cHhgO1xuICAgICAgICBkaXYuc3R5bGUubGVmdCA9IGAke0RJVl9UT1VDSF9QT1NfWX1weGA7XG4gICAgICAgIGRpdi5zdHlsZS56SW5kZXggPSBESVZfVE9VQ0hfWklOREVYLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgaXMgdGhlIGRvbSBlbGVtZW50IHRoYXQgd2lsbCBzaXQgb3ZlciB0aGUgUGl4aUpTIGVsZW1lbnQuIFRoaXMgaXMgd2hlcmUgdGhlIGRpdiBvdmVybGF5cyB3aWxsIGdvLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpdiA9IGRpdjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBzaW1wbGUgcG9vbCBmb3Igc3RvcmluZyBkaXZzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7Kn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucG9vbCA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIGlzIGEgdGljayB1c2VkIHRvIGNoZWNrIGlmIGFuIG9iamVjdCBpcyBubyBsb25nZXIgYmVpbmcgcmVuZGVyZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtOdW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlbmRlcklkID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0dGluZyB0aGlzIHRvIHRydWUgd2lsbCB2aXN1YWxseSBzaG93IHRoZSBkaXZzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVidWcgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlbmRlcmVyIHRoaXMgYWNjZXNzaWJpbGl0eSBtYW5hZ2VyIHdvcmtzIGZvci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5BYnN0cmFjdFJlbmRlcmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYXJyYXkgb2YgY3VycmVudGx5IGFjdGl2ZSBhY2Nlc3NpYmxlIGl0ZW1zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtBcnJheTwqPn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogcHJlLWJpbmQgdGhlIGZ1bmN0aW9uc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7RnVuY3Rpb259XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9vbktleURvd24gPSB0aGlzLl9vbktleURvd24uYmluZCh0aGlzKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogcHJlLWJpbmQgdGhlIGZ1bmN0aW9uc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7RnVuY3Rpb259XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9vbk1vdXNlTW92ZSA9IHRoaXMuX29uTW91c2VNb3ZlLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9pc01vYmlsZUFjY2Vzc2liaWxpdHkgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogY291bnQgdG8gdGhyb3R0bGUgZGl2IHVwZGF0ZXMgb24gYW5kcm9pZCBkZXZpY2VzXG4gICAgICAgICAqIEB0eXBlIG51bWJlclxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbmRyb2lkVXBkYXRlQ291bnQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0aGUgZnJlcXVlbmN5IHRvIHVwZGF0ZSB0aGUgZGl2IGVsZW1lbnRzICgpXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFuZHJvaWRVcGRhdGVGcmVxdWVuY3kgPSA1MDA7IC8vIDJmcHNcblxuICAgICAgICAvLyBsZXQgbGlzdGVuIGZvciB0YWIuLiBvbmNlIHByZXNzZWQgd2UgY2FuIGZpcmUgdXAgYW5kIHNob3cgdGhlIGFjY2Vzc2liaWxpdHkgbGF5ZXJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZsYWdcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCBpc0FjdGl2ZSgpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNBY3RpdmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmbGFnXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgaXNNb2JpbGVBY2Nlc3NpYmlsaXR5KCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc01vYmlsZUFjY2Vzc2liaWxpdHk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyB0aGUgdG91Y2ggaG9va3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlVG91Y2hIb29rKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGhvb2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblxuICAgICAgICBob29rRGl2LnN0eWxlLndpZHRoID0gYCR7RElWX0hPT0tfU0laRX1weGA7XG4gICAgICAgIGhvb2tEaXYuc3R5bGUuaGVpZ2h0ID0gYCR7RElWX0hPT0tfU0laRX1weGA7XG4gICAgICAgIGhvb2tEaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBob29rRGl2LnN0eWxlLnRvcCA9IGAke0RJVl9IT09LX1BPU19YfXB4YDtcbiAgICAgICAgaG9va0Rpdi5zdHlsZS5sZWZ0ID0gYCR7RElWX0hPT0tfUE9TX1l9cHhgO1xuICAgICAgICBob29rRGl2LnN0eWxlLnpJbmRleCA9IERJVl9IT09LX1pJTkRFWC50b1N0cmluZygpO1xuICAgICAgICBob29rRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjRkYwMDAwJztcbiAgICAgICAgaG9va0Rpdi50aXRsZSA9ICdzZWxlY3QgdG8gZW5hYmxlIGFjY2Vzc2FiaWxpdHkgZm9yIHRoaXMgY29udGVudCc7XG5cbiAgICAgICAgaG9va0Rpdi5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2lzTW9iaWxlQWNjZXNzaWJpbGl0eSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlKCk7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lUb3VjaEhvb2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChob29rRGl2KTtcbiAgICAgICAgdGhpcy5faG9va0RpdiA9IGhvb2tEaXY7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhlIHRvdWNoIGhvb2tzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGRlc3Ryb3lUb3VjaEhvb2soKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl9ob29rRGl2KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLl9ob29rRGl2KTtcbiAgICAgICAgdGhpcy5faG9va0RpdiA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWN0aXZhdGluZyB3aWxsIGNhdXNlIHRoZSBBY2Nlc3NpYmlsaXR5IGxheWVyIHRvIGJlIHNob3duLlxuICAgICAqIFRoaXMgaXMgY2FsbGVkIHdoZW4gYSB1c2VyIHByZXNzZXMgdGhlIHRhYiBrZXkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYWN0aXZhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzQWN0aXZlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pc0FjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgd2luZG93LmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX29uTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIGZhbHNlKTtcblxuICAgICAgICAvLyBUT0RPOiBSZW1vdmUgY2FzdGluZyB3aGVuIENhbnZhc1JlbmRlcmVyIGlzIGNvbnZlcnRlZFxuICAgICAgICAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5vbigncG9zdHJlbmRlcicsIHRoaXMudXBkYXRlLCB0aGlzKTtcblxuICAgICAgICBpZiAoKHRoaXMucmVuZGVyZXIgYXMgQWJzdHJhY3RSZW5kZXJlcikudmlldy5wYXJlbnROb2RlKVxuICAgICAgICB7XG4gICAgICAgICAgICAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS52aWV3LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcy5kaXYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVhY3RpdmF0aW5nIHdpbGwgY2F1c2UgdGhlIEFjY2Vzc2liaWxpdHkgbGF5ZXIgdG8gYmUgaGlkZGVuLlxuICAgICAqIFRoaXMgaXMgY2FsbGVkIHdoZW4gYSB1c2VyIG1vdmVzIHRoZSBtb3VzZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZWFjdGl2YXRlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5faXNBY3RpdmUgfHwgdGhpcy5faXNNb2JpbGVBY2Nlc3NpYmlsaXR5KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pc0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHdpbmRvdy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9vbk1vdXNlTW92ZSwgdHJ1ZSk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fb25LZXlEb3duLCBmYWxzZSk7XG5cbiAgICAgICAgLy8gVE9ETzogUmVtb3ZlIGNhc3Rpbmcgd2hlbiBDYW52YXNSZW5kZXJlciBpcyBjb252ZXJ0ZWRcbiAgICAgICAgKHRoaXMucmVuZGVyZXIgYXMgQWJzdHJhY3RSZW5kZXJlcikub2ZmKCdwb3N0cmVuZGVyJywgdGhpcy51cGRhdGUpO1xuXG4gICAgICAgIGlmICh0aGlzLmRpdi5wYXJlbnROb2RlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZGl2KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgcmVjdXJzaXZlIGZ1bmN0aW9uIHdpbGwgcnVuIHRocm91Z2ggdGhlIHNjZW5lIGdyYXBoIGFuZCBhZGQgYW55IG5ldyBhY2Nlc3NpYmxlIG9iamVjdHMgdG8gdGhlIERPTSBsYXllci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcn0gZGlzcGxheU9iamVjdCAtIFRoZSBEaXNwbGF5T2JqZWN0IHRvIGNoZWNrLlxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlQWNjZXNzaWJsZU9iamVjdHMoZGlzcGxheU9iamVjdDogQ29udGFpbmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCFkaXNwbGF5T2JqZWN0LnZpc2libGUgfHwgIWRpc3BsYXlPYmplY3QuYWNjZXNzaWJsZUNoaWxkcmVuKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzcGxheU9iamVjdC5hY2Nlc3NpYmxlICYmIGRpc3BsYXlPYmplY3QuaW50ZXJhY3RpdmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghZGlzcGxheU9iamVjdC5fYWNjZXNzaWJsZUFjdGl2ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkKGRpc3BsYXlPYmplY3QpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkaXNwbGF5T2JqZWN0LnJlbmRlcklkID0gdGhpcy5yZW5kZXJJZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gZGlzcGxheU9iamVjdC5jaGlsZHJlbjtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUFjY2Vzc2libGVPYmplY3RzKGNoaWxkcmVuW2ldIGFzIENvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCZWZvcmUgZWFjaCByZW5kZXIgdGhpcyBmdW5jdGlvbiB3aWxsIGVuc3VyZSB0aGF0IGFsbCBkaXZzIGFyZSBtYXBwZWQgY29ycmVjdGx5IHRvIHRoZWlyIERpc3BsYXlPYmplY3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICAvKiBPbiBBbmRyb2lkIGRlZmF1bHQgd2ViIGJyb3dzZXIsIHRhYiBvcmRlciBzZWVtcyB0byBiZSBjYWxjdWxhdGVkIGJ5IHBvc2l0aW9uIHJhdGhlciB0aGFuIHRhYkluZGV4LFxuICAgICAgICAqICBtb3ZpbmcgYnV0dG9ucyBjYW4gY2F1c2UgZm9jdXMgdG8gZmxpY2tlciBiZXR3ZWVuIHR3byBidXR0b25zIG1ha2luZyBpdCBoYXJkL2ltcG9zc2libGUgdG8gbmF2aWdhdGUsXG4gICAgICAgICogIHNvIEkgYW0ganVzdCBydW5uaW5nIHVwZGF0ZSBldmVyeSBoYWxmIGEgc2Vjb25kLCBzZWVtcyB0byBmaXggaXQuXG4gICAgICAgICovXG4gICAgICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICAgIGlmIChpc01vYmlsZS5hbmRyb2lkLmRldmljZSAmJiBub3cgPCB0aGlzLmFuZHJvaWRVcGRhdGVDb3VudClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hbmRyb2lkVXBkYXRlQ291bnQgPSBub3cgKyB0aGlzLmFuZHJvaWRVcGRhdGVGcmVxdWVuY3k7XG5cbiAgICAgICAgaWYgKCEodGhpcy5yZW5kZXJlciBhcyBSZW5kZXJlcikucmVuZGVyaW5nVG9TY3JlZW4pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVwZGF0ZSBjaGlsZHJlbi4uLlxuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5fbGFzdE9iamVjdFJlbmRlcmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUFjY2Vzc2libGVPYmplY3RzKHRoaXMucmVuZGVyZXIuX2xhc3RPYmplY3RSZW5kZXJlZCBhcyBDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETzogUmVtb3ZlIGNhc3Rpbmcgd2hlbiBDYW52YXNSZW5kZXJlciBpcyBjb252ZXJ0ZWRcbiAgICAgICAgY29uc3QgcmVjdCA9ICh0aGlzLnJlbmRlcmVyIGFzIEFic3RyYWN0UmVuZGVyZXIpLnZpZXcuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IHRoaXMucmVuZGVyZXIucmVzb2x1dGlvbjtcblxuICAgICAgICBjb25zdCBzeCA9IChyZWN0LndpZHRoIC8gKHRoaXMucmVuZGVyZXIgYXMgQWJzdHJhY3RSZW5kZXJlcikud2lkdGgpICogcmVzb2x1dGlvbjtcbiAgICAgICAgY29uc3Qgc3kgPSAocmVjdC5oZWlnaHQgLyAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5oZWlnaHQpICogcmVzb2x1dGlvbjtcblxuICAgICAgICBsZXQgZGl2ID0gdGhpcy5kaXY7XG5cbiAgICAgICAgZGl2LnN0eWxlLmxlZnQgPSBgJHtyZWN0LmxlZnR9cHhgO1xuICAgICAgICBkaXYuc3R5bGUudG9wID0gYCR7cmVjdC50b3B9cHhgO1xuICAgICAgICBkaXYuc3R5bGUud2lkdGggPSBgJHsodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS53aWR0aH1weGA7XG4gICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSBgJHsodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5oZWlnaHR9cHhgO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbi5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSB0aGlzLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBpZiAoY2hpbGQucmVuZGVySWQgIT09IHRoaXMucmVuZGVySWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2hpbGQuX2FjY2Vzc2libGVBY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJlbW92ZUl0ZW1zKHRoaXMuY2hpbGRyZW4sIGksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGl2LnJlbW92ZUNoaWxkKGNoaWxkLl9hY2Nlc3NpYmxlRGl2KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvb2wucHVzaChjaGlsZC5fYWNjZXNzaWJsZURpdik7XG4gICAgICAgICAgICAgICAgY2hpbGQuX2FjY2Vzc2libGVEaXYgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIG1hcCBkaXYgdG8gZGlzcGxheS4uXG4gICAgICAgICAgICAgICAgZGl2ID0gY2hpbGQuX2FjY2Vzc2libGVEaXY7XG4gICAgICAgICAgICAgICAgbGV0IGhpdEFyZWEgPSBjaGlsZC5oaXRBcmVhIGFzIFJlY3RhbmdsZTtcbiAgICAgICAgICAgICAgICBjb25zdCB3dCA9IGNoaWxkLndvcmxkVHJhbnNmb3JtO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLmhpdEFyZWEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUubGVmdCA9IGAkeyh3dC50eCArIChoaXRBcmVhLnggKiB3dC5hKSkgKiBzeH1weGA7XG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS50b3AgPSBgJHsod3QudHkgKyAoaGl0QXJlYS55ICogd3QuZCkpICogc3l9cHhgO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS53aWR0aCA9IGAke2hpdEFyZWEud2lkdGggKiB3dC5hICogc3h9cHhgO1xuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gYCR7aGl0QXJlYS5oZWlnaHQgKiB3dC5kICogc3l9cHhgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBoaXRBcmVhID0gY2hpbGQuZ2V0Qm91bmRzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXBIaXRBcmVhKGhpdEFyZWEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5sZWZ0ID0gYCR7aGl0QXJlYS54ICogc3h9cHhgO1xuICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUudG9wID0gYCR7aGl0QXJlYS55ICogc3l9cHhgO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS53aWR0aCA9IGAke2hpdEFyZWEud2lkdGggKiBzeH1weGA7XG4gICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSBgJHtoaXRBcmVhLmhlaWdodCAqIHN5fXB4YDtcblxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYnV0dG9uIHRpdGxlcyBhbmQgaGludHMgaWYgdGhleSBleGlzdCBhbmQgdGhleSd2ZSBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgIGlmIChkaXYudGl0bGUgIT09IGNoaWxkLmFjY2Vzc2libGVUaXRsZSAmJiBjaGlsZC5hY2Nlc3NpYmxlVGl0bGUgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi50aXRsZSA9IGNoaWxkLmFjY2Vzc2libGVUaXRsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZGl2LmdldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpICE9PSBjaGlsZC5hY2Nlc3NpYmxlSGludFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgY2hpbGQuYWNjZXNzaWJsZUhpbnQgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBjaGlsZC5hY2Nlc3NpYmxlSGludCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyB0aGUgdGl0bGUgb3IgaW5kZXggbWF5IGhhdmUgY2hhbmdlZCwgaWYgc28gbGV0cyB1cGRhdGUgaXQhXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLmFjY2Vzc2libGVUaXRsZSAhPT0gZGl2LnRpdGxlIHx8IGNoaWxkLnRhYkluZGV4ICE9PSBkaXYudGFiSW5kZXgpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkaXYudGl0bGUgPSBjaGlsZC5hY2Nlc3NpYmxlVGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIGRpdi50YWJJbmRleCA9IGNoaWxkLnRhYkluZGV4O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWJ1ZykgdGhpcy51cGRhdGVEZWJ1Z0hUTUwoZGl2KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbmNyZW1lbnQgdGhlIHJlbmRlciBpZC4uXG4gICAgICAgIHRoaXMucmVuZGVySWQrKztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBwcml2YXRlIGZ1bmN0aW9uIHRoYXQgd2lsbCB2aXN1YWxseSBhZGQgdGhlIGluZm9ybWF0aW9uIHRvIHRoZVxuICAgICAqIGFjY2Vzc2FiaWxpdHkgZGl2XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBkaXZcbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlRGVidWdIVE1MKGRpdjogSUFjY2Vzc2libGVIVE1MRWxlbWVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSBgdHlwZTogJHtkaXYudHlwZX08L2JyPiB0aXRsZSA6ICR7ZGl2LnRpdGxlfTwvYnI+IHRhYkluZGV4OiAke2Rpdi50YWJJbmRleH1gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkanVzdCB0aGUgaGl0IGFyZWEgYmFzZWQgb24gdGhlIGJvdW5kcyBvZiBhIGRpc3BsYXkgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBoaXRBcmVhIC0gQm91bmRzIG9mIHRoZSBjaGlsZFxuICAgICAqL1xuICAgIHB1YmxpYyBjYXBIaXRBcmVhKGhpdEFyZWE6IFJlY3RhbmdsZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChoaXRBcmVhLnggPCAwKVxuICAgICAgICB7XG4gICAgICAgICAgICBoaXRBcmVhLndpZHRoICs9IGhpdEFyZWEueDtcbiAgICAgICAgICAgIGhpdEFyZWEueCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGl0QXJlYS55IDwgMClcbiAgICAgICAge1xuICAgICAgICAgICAgaGl0QXJlYS5oZWlnaHQgKz0gaGl0QXJlYS55O1xuICAgICAgICAgICAgaGl0QXJlYS55ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRPRE86IFJlbW92ZSBjYXN0aW5nIHdoZW4gQ2FudmFzUmVuZGVyZXIgaXMgY29udmVydGVkXG4gICAgICAgIGlmIChoaXRBcmVhLnggKyBoaXRBcmVhLndpZHRoID4gKHRoaXMucmVuZGVyZXIgYXMgQWJzdHJhY3RSZW5kZXJlcikud2lkdGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGhpdEFyZWEud2lkdGggPSAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS53aWR0aCAtIGhpdEFyZWEueDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChoaXRBcmVhLnkgKyBoaXRBcmVhLmhlaWdodCA+ICh0aGlzLnJlbmRlcmVyIGFzIEFic3RyYWN0UmVuZGVyZXIpLmhlaWdodClcbiAgICAgICAge1xuICAgICAgICAgICAgaGl0QXJlYS5oZWlnaHQgPSAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5oZWlnaHQgLSBoaXRBcmVhLnk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgRGlzcGxheU9iamVjdCB0byB0aGUgYWNjZXNzaWJpbGl0eSBtYW5hZ2VyXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBkaXNwbGF5T2JqZWN0IC0gVGhlIGNoaWxkIHRvIG1ha2UgYWNjZXNzaWJsZS5cbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZENoaWxkPFQgZXh0ZW5kcyBEaXNwbGF5T2JqZWN0PihkaXNwbGF5T2JqZWN0OiBUKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gICAgdGhpcy5hY3RpdmF0ZSgpO1xuXG4gICAgICAgIGxldCBkaXYgPSB0aGlzLnBvb2wucG9wKCk7XG5cbiAgICAgICAgaWYgKCFkaXYpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgICAgICAgICBkaXYuc3R5bGUud2lkdGggPSBgJHtESVZfVE9VQ0hfU0laRX1weGA7XG4gICAgICAgICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gYCR7RElWX1RPVUNIX1NJWkV9cHhgO1xuICAgICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuZGVidWcgPyAncmdiYSgyNTUsMjU1LDI1NSwwLjUpJyA6ICd0cmFuc3BhcmVudCc7XG4gICAgICAgICAgICBkaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IERJVl9UT1VDSF9aSU5ERVgudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGRpdi5zdHlsZS5ib3JkZXJTdHlsZSA9ICdub25lJztcblxuICAgICAgICAgICAgLy8gQVJJQSBhdHRyaWJ1dGVzIGVuc3VyZSB0aGF0IGJ1dHRvbiB0aXRsZSBhbmQgaGludCB1cGRhdGVzIGFyZSBhbm5vdW5jZWQgcHJvcGVybHlcbiAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZignY2hyb21lJykgPiAtMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBDaHJvbWUgZG9lc24ndCBuZWVkIGFyaWEtbGl2ZSB0byB3b3JrIGFzIGludGVuZGVkOyBpbiBmYWN0IGl0IGp1c3QgZ2V0cyBtb3JlIGNvbmZ1c2VkLlxuICAgICAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsICdvZmYnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLWxpdmUnLCAncG9saXRlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9ydjouKkdlY2tvXFwvLykpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gRmlyZUZveCBuZWVkcyB0aGlzIHRvIGFubm91bmNlIG9ubHkgdGhlIG5ldyBidXR0b24gbmFtZVxuICAgICAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtcmVsZXZhbnQnLCAnYWRkaXRpb25zJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gcmVxdWlyZWQgYnkgSUUsIG90aGVyIGJyb3dzZXJzIGRvbid0IG11Y2ggY2FyZVxuICAgICAgICAgICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtcmVsZXZhbnQnLCAndGV4dCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cy5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIHRoaXMuX29uRm9jdXNPdXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQgcG9pbnRlciBldmVudHNcbiAgICAgICAgZGl2LnN0eWxlLnBvaW50ZXJFdmVudHMgPSBkaXNwbGF5T2JqZWN0LmFjY2Vzc2libGVQb2ludGVyRXZlbnRzO1xuICAgICAgICAvLyBzZXQgdGhlIHR5cGUsIHRoaXMgZGVmYXVsdHMgdG8gYnV0dG9uIVxuICAgICAgICBkaXYudHlwZSA9IGRpc3BsYXlPYmplY3QuYWNjZXNzaWJsZVR5cGU7XG5cbiAgICAgICAgaWYgKGRpc3BsYXlPYmplY3QuYWNjZXNzaWJsZVRpdGxlICYmIGRpc3BsYXlPYmplY3QuYWNjZXNzaWJsZVRpdGxlICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBkaXYudGl0bGUgPSBkaXNwbGF5T2JqZWN0LmFjY2Vzc2libGVUaXRsZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghZGlzcGxheU9iamVjdC5hY2Nlc3NpYmxlSGludFxuICAgICAgICAgICAgICAgICB8fCBkaXNwbGF5T2JqZWN0LmFjY2Vzc2libGVIaW50ID09PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBkaXYudGl0bGUgPSBgZGlzcGxheU9iamVjdCAke2Rpc3BsYXlPYmplY3QudGFiSW5kZXh9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXNwbGF5T2JqZWN0LmFjY2Vzc2libGVIaW50XG4gICAgICAgICAgICAmJiBkaXNwbGF5T2JqZWN0LmFjY2Vzc2libGVIaW50ICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgZGlzcGxheU9iamVjdC5hY2Nlc3NpYmxlSGludCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZWJ1ZykgdGhpcy51cGRhdGVEZWJ1Z0hUTUwoZGl2KTtcblxuICAgICAgICBkaXNwbGF5T2JqZWN0Ll9hY2Nlc3NpYmxlQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgZGlzcGxheU9iamVjdC5fYWNjZXNzaWJsZURpdiA9IGRpdjtcbiAgICAgICAgZGl2LmRpc3BsYXlPYmplY3QgPSBkaXNwbGF5T2JqZWN0O1xuXG4gICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChkaXNwbGF5T2JqZWN0KTtcbiAgICAgICAgdGhpcy5kaXYuYXBwZW5kQ2hpbGQoZGlzcGxheU9iamVjdC5fYWNjZXNzaWJsZURpdik7XG4gICAgICAgIGRpc3BsYXlPYmplY3QuX2FjY2Vzc2libGVEaXYudGFiSW5kZXggPSBkaXNwbGF5T2JqZWN0LnRhYkluZGV4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcHMgdGhlIGRpdiBidXR0b24gcHJlc3MgdG8gcGl4aSdzIEludGVyYWN0aW9uTWFuYWdlciAoY2xpY2spXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZSAtIFRoZSBjbGljayBldmVudC5cbiAgICAgKi9cbiAgICBwcml2YXRlIF9vbkNsaWNrKGU6IE1vdXNlRXZlbnQpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBUT0RPOiBSZW1vdmUgY2FzdGluZyB3aGVuIENhbnZhc1JlbmRlcmVyIGlzIGNvbnZlcnRlZFxuICAgICAgICBjb25zdCBpbnRlcmFjdGlvbk1hbmFnZXIgPSAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5wbHVnaW5zLmludGVyYWN0aW9uO1xuXG4gICAgICAgIGludGVyYWN0aW9uTWFuYWdlci5kaXNwYXRjaEV2ZW50KFxuICAgICAgICAgICAgKGUudGFyZ2V0IGFzIElBY2Nlc3NpYmxlSFRNTEVsZW1lbnQpLmRpc3BsYXlPYmplY3QsICdjbGljaycsIGludGVyYWN0aW9uTWFuYWdlci5ldmVudERhdGFcbiAgICAgICAgKTtcbiAgICAgICAgaW50ZXJhY3Rpb25NYW5hZ2VyLmRpc3BhdGNoRXZlbnQoXG4gICAgICAgICAgICAoZS50YXJnZXQgYXMgSUFjY2Vzc2libGVIVE1MRWxlbWVudCkuZGlzcGxheU9iamVjdCwgJ3BvaW50ZXJ0YXAnLCBpbnRlcmFjdGlvbk1hbmFnZXIuZXZlbnREYXRhXG4gICAgICAgICk7XG4gICAgICAgIGludGVyYWN0aW9uTWFuYWdlci5kaXNwYXRjaEV2ZW50KFxuICAgICAgICAgICAgKGUudGFyZ2V0IGFzIElBY2Nlc3NpYmxlSFRNTEVsZW1lbnQpLmRpc3BsYXlPYmplY3QsICd0YXAnLCBpbnRlcmFjdGlvbk1hbmFnZXIuZXZlbnREYXRhXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFwcyB0aGUgZGl2IGZvY3VzIGV2ZW50cyB0byBwaXhpJ3MgSW50ZXJhY3Rpb25NYW5hZ2VyIChtb3VzZW92ZXIpXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Rm9jdXNFdmVudH0gZSAtIFRoZSBmb2N1cyBldmVudC5cbiAgICAgKi9cbiAgICBwcml2YXRlIF9vbkZvY3VzKGU6IEZvY3VzRXZlbnQpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoIShlLnRhcmdldCBhcyBFbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScpKVxuICAgICAgICB7XG4gICAgICAgICAgICAoZS50YXJnZXQgYXMgRWxlbWVudCkuc2V0QXR0cmlidXRlKCdhcmlhLWxpdmUnLCAnYXNzZXJ0aXZlJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPOiBSZW1vdmUgY2FzdGluZyB3aGVuIENhbnZhc1JlbmRlcmVyIGlzIGNvbnZlcnRlZFxuICAgICAgICBjb25zdCBpbnRlcmFjdGlvbk1hbmFnZXIgPSAodGhpcy5yZW5kZXJlciBhcyBBYnN0cmFjdFJlbmRlcmVyKS5wbHVnaW5zLmludGVyYWN0aW9uO1xuXG4gICAgICAgIGludGVyYWN0aW9uTWFuYWdlci5kaXNwYXRjaEV2ZW50KFxuICAgICAgICAgICAgKGUudGFyZ2V0IGFzIElBY2Nlc3NpYmxlSFRNTEVsZW1lbnQpLmRpc3BsYXlPYmplY3QsICdtb3VzZW92ZXInLCBpbnRlcmFjdGlvbk1hbmFnZXIuZXZlbnREYXRhXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFwcyB0aGUgZGl2IGZvY3VzIGV2ZW50cyB0byBwaXhpJ3MgSW50ZXJhY3Rpb25NYW5hZ2VyIChtb3VzZW91dClcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGb2N1c0V2ZW50fSBlIC0gVGhlIGZvY3Vzb3V0IGV2ZW50LlxuICAgICAqL1xuICAgIHByaXZhdGUgX29uRm9jdXNPdXQoZTogRm9jdXNFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghKGUudGFyZ2V0IGFzIEVsZW1lbnQpLmdldEF0dHJpYnV0ZSgnYXJpYS1saXZlJykpXG4gICAgICAgIHtcbiAgICAgICAgICAgIChlLnRhcmdldCBhcyBFbGVtZW50KS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsICdwb2xpdGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRPRE86IFJlbW92ZSBjYXN0aW5nIHdoZW4gQ2FudmFzUmVuZGVyZXIgaXMgY29udmVydGVkXG4gICAgICAgIGNvbnN0IGludGVyYWN0aW9uTWFuYWdlciA9ICh0aGlzLnJlbmRlcmVyIGFzIEFic3RyYWN0UmVuZGVyZXIpLnBsdWdpbnMuaW50ZXJhY3Rpb247XG5cbiAgICAgICAgaW50ZXJhY3Rpb25NYW5hZ2VyLmRpc3BhdGNoRXZlbnQoKGUudGFyZ2V0IGFzIGFueSkuZGlzcGxheU9iamVjdCwgJ21vdXNlb3V0JywgaW50ZXJhY3Rpb25NYW5hZ2VyLmV2ZW50RGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXMgY2FsbGVkIHdoZW4gYSBrZXkgaXMgcHJlc3NlZFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUgLSBUaGUga2V5ZG93biBldmVudC5cbiAgICAgKi9cbiAgICBwcml2YXRlIF9vbktleURvd24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChlLmtleUNvZGUgIT09IEtFWV9DT0RFX1RBQilcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hY3RpdmF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElzIGNhbGxlZCB3aGVuIHRoZSBtb3VzZSBtb3ZlcyBhY3Jvc3MgdGhlIHJlbmRlcmVyIGVsZW1lbnRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBlIC0gVGhlIG1vdXNlIGV2ZW50LlxuICAgICAqL1xuICAgIHByaXZhdGUgX29uTW91c2VNb3ZlKGU6IE1vdXNlRXZlbnQpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoZS5tb3ZlbWVudFggPT09IDAgJiYgZS5tb3ZlbWVudFkgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGVhY3RpdmF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBhY2Nlc3NpYmlsaXR5IG1hbmFnZXJcbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZGVzdHJveVRvdWNoSG9vaygpO1xuICAgICAgICB0aGlzLmRpdiA9IG51bGw7XG5cbiAgICAgICAgd2luZG93LmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX29uTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24pO1xuXG4gICAgICAgIHRoaXMucG9vbCA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBudWxsO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5cbi8qKlxuICogVGFyZ2V0IGZyYW1lcyBwZXIgbWlsbGlzZWNvbmQuXG4gKlxuICogQHN0YXRpY1xuICogQG5hbWUgVEFSR0VUX0ZQTVNcbiAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQGRlZmF1bHQgMC4wNlxuICovXG5zZXR0aW5ncy5UQVJHRVRfRlBNUyA9IDAuMDY7XG5cbmV4cG9ydCB7IHNldHRpbmdzIH07XG4iLCAiLyoqXG4gKiBSZXByZXNlbnRzIHRoZSB1cGRhdGUgcHJpb3JpdGllcyB1c2VkIGJ5IGludGVybmFsIFBJWEkgY2xhc3NlcyB3aGVuIHJlZ2lzdGVyZWQgd2l0aFxuICogdGhlIHtAbGluayBQSVhJLlRpY2tlcn0gb2JqZWN0LiBIaWdoZXIgcHJpb3JpdHkgaXRlbXMgYXJlIHVwZGF0ZWQgZmlyc3QgYW5kIGxvd2VyXG4gKiBwcmlvcml0eSBpdGVtcywgc3VjaCBhcyByZW5kZXIsIHNob3VsZCBnbyBsYXRlci5cbiAqXG4gKiBAc3RhdGljXG4gKiBAY29uc3RhbnRcbiAqIEBuYW1lIFVQREFURV9QUklPUklUWVxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gSU5URVJBQ1RJT049NTAgSGlnaGVzdCBwcmlvcml0eSwgdXNlZCBmb3Ige0BsaW5rIFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IEhJR0g9MjUgSGlnaCBwcmlvcml0eSB1cGRhdGluZywge0BsaW5rIFBJWEkuVmlkZW9CYXNlVGV4dHVyZX0gYW5kIHtAbGluayBQSVhJLkFuaW1hdGVkU3ByaXRlfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IE5PUk1BTD0wIERlZmF1bHQgcHJpb3JpdHkgZm9yIHRpY2tlciBldmVudHMsIHNlZSB7QGxpbmsgUElYSS5UaWNrZXIjYWRkfS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMT1c9LTI1IExvdyBwcmlvcml0eSB1c2VkIGZvciB7QGxpbmsgUElYSS5BcHBsaWNhdGlvbn0gcmVuZGVyaW5nLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IFVUSUxJVFk9LTUwIExvd2VzdCBwcmlvcml0eSB1c2VkIGZvciB7QGxpbmsgUElYSS5CYXNlUHJlcGFyZX0gdXRpbGl0eS5cbiAqL1xuZXhwb3J0IGVudW0gVVBEQVRFX1BSSU9SSVRZIHtcbiAgICBJTlRFUkFDVElPTiA9IDUwLFxuICAgIEhJR0ggPSAyNSxcbiAgICBOT1JNQUwgPSAwLFxuICAgIExPVyA9IC0yNSxcbiAgICBVVElMSVRZID0gLTUwLFxufVxuIiwgImltcG9ydCB7IFRpY2tlckNhbGxiYWNrIH0gZnJvbSAnLi9UaWNrZXInO1xuXG4vKipcbiAqIEludGVybmFsIGNsYXNzIGZvciBoYW5kbGluZyB0aGUgcHJpb3JpdHkgc29ydGluZyBvZiB0aWNrZXIgaGFuZGxlcnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFRpY2tlckxpc3RlbmVyPFQgPSBhbnk+XG57XG4gICAgcHVibGljIHByaW9yaXR5OiBudW1iZXI7XG4gICAgcHVibGljIG5leHQ6IFRpY2tlckxpc3RlbmVyO1xuICAgIHB1YmxpYyBwcmV2aW91czogVGlja2VyTGlzdGVuZXI7XG5cbiAgICBwcml2YXRlIGZuOiBUaWNrZXJDYWxsYmFjazxUPjtcbiAgICBwcml2YXRlIGNvbnRleHQ6IFQ7XG4gICAgcHJpdmF0ZSBvbmNlOiBib29sZWFuO1xuICAgIHByaXZhdGUgX2Rlc3Ryb3llZDogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBhZGRlZCBmb3Igb25lIHVwZGF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9bnVsbF0gLSBUaGUgbGlzdGVuZXIgY29udGV4dFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcHJpb3JpdHk9MF0gLSBUaGUgcHJpb3JpdHkgZm9yIGVtaXR0aW5nXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0gLSBJZiB0aGUgaGFuZGxlciBzaG91bGQgZmlyZSBvbmNlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZm46IFRpY2tlckNhbGxiYWNrPFQ+LCBjb250ZXh0OiBUID0gbnVsbCwgcHJpb3JpdHkgPSAwLCBvbmNlID0gZmFsc2UpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGhhbmRsZXIgZnVuY3Rpb24gdG8gZXhlY3V0ZS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7RnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZuID0gZm47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjYWxsaW5nIHRvIGV4ZWN1dGUuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIgeyp9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgY3VycmVudCBwcmlvcml0eS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGlzIHNob3VsZCBvbmx5IGV4ZWN1dGUgb25jZS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25jZSA9IG9uY2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBuZXh0IGl0ZW0gaW4gY2hhaW4uXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge1RpY2tlckxpc3RlbmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHByZXZpb3VzIGl0ZW0gaW4gY2hhaW4uXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge1RpY2tlckxpc3RlbmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcmV2aW91cyA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCBpZiB0aGlzIGxpc3RlbmVyIGhhcyBiZWVuIGRlc3Ryb3llZCBhbHJlYWR5LlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZGVzdHJveWVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2ltcGxlIGNvbXBhcmUgZnVuY3Rpb24gdG8gZmlndXJlIG91dCBpZiBhIGZ1bmN0aW9uIGFuZCBjb250ZXh0IG1hdGNoLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gLSBUaGUgbGlzdGVuZXIgZnVuY3Rpb24gdG8gYmUgYWRkZWQgZm9yIG9uZSB1cGRhdGVcbiAgICAgKiBAcGFyYW0ge2FueX0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgdGhlIGxpc3RlbmVyIG1hdGNoIHRoZSBhcmd1bWVudHNcbiAgICAgKi9cbiAgICBtYXRjaChmbjogVGlja2VyQ2FsbGJhY2s8VD4sIGNvbnRleHQ6IGFueSA9IG51bGwpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5mbiA9PT0gZm4gJiYgdGhpcy5jb250ZXh0ID09PSBjb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVtaXQgYnkgY2FsbGluZyB0aGUgY3VycmVudCBmdW5jdGlvbi5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWx0YVRpbWUgLSB0aW1lIHNpbmNlIHRoZSBsYXN0IGVtaXQuXG4gICAgICogQHJldHVybiB7VGlja2VyTGlzdGVuZXJ9IE5leHQgdGlja2VyXG4gICAgICovXG4gICAgZW1pdChkZWx0YVRpbWU6IG51bWJlcik6IFRpY2tlckxpc3RlbmVyXG4gICAge1xuICAgICAgICBpZiAodGhpcy5mbilcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuY29udGV4dClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZuLmNhbGwodGhpcy5jb250ZXh0LCBkZWx0YVRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICh0aGlzIGFzIFRpY2tlckxpc3RlbmVyPGFueT4pLmZuKGRlbHRhVGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWRpcmVjdCA9IHRoaXMubmV4dDtcblxuICAgICAgICBpZiAodGhpcy5vbmNlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3kodHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTb2Z0LWRlc3Ryb3lpbmcgc2hvdWxkIHJlbW92ZVxuICAgICAgICAvLyB0aGUgbmV4dCByZWZlcmVuY2VcbiAgICAgICAgaWYgKHRoaXMuX2Rlc3Ryb3llZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZWRpcmVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25uZWN0IHRvIHRoZSBsaXN0LlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtUaWNrZXJMaXN0ZW5lcn0gcHJldmlvdXMgLSBJbnB1dCBub2RlLCBwcmV2aW91cyBsaXN0ZW5lclxuICAgICAqL1xuICAgIGNvbm5lY3QocHJldmlvdXM6IFRpY2tlckxpc3RlbmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5wcmV2aW91cyA9IHByZXZpb3VzO1xuICAgICAgICBpZiAocHJldmlvdXMubmV4dClcbiAgICAgICAge1xuICAgICAgICAgICAgcHJldmlvdXMubmV4dC5wcmV2aW91cyA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0ID0gcHJldmlvdXMubmV4dDtcbiAgICAgICAgcHJldmlvdXMubmV4dCA9IHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSBhbmQgZG9uJ3QgdXNlIGFmdGVyIHRoaXMuXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtoYXJkID0gZmFsc2VdIGB0cnVlYCB0byByZW1vdmUgdGhlIGBuZXh0YCByZWZlcmVuY2UsIHRoaXNcbiAgICAgKiAgICAgICAgaXMgY29uc2lkZXJlZCBhIGhhcmQgZGVzdHJveS4gU29mdCBkZXN0cm95IG1haW50YWlucyB0aGUgbmV4dCByZWZlcmVuY2UuXG4gICAgICogQHJldHVybiB7VGlja2VyTGlzdGVuZXJ9IFRoZSBsaXN0ZW5lciB0byByZWRpcmVjdCB3aGlsZSBlbWl0dGluZyBvciByZW1vdmluZy5cbiAgICAgKi9cbiAgICBkZXN0cm95KGhhcmQgPSBmYWxzZSk6IFRpY2tlckxpc3RlbmVyXG4gICAge1xuICAgICAgICB0aGlzLl9kZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmZuID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gbnVsbDtcblxuICAgICAgICAvLyBEaXNjb25uZWN0LCBob29rIHVwIG5leHQgYW5kIHByZXZpb3VzXG4gICAgICAgIGlmICh0aGlzLnByZXZpb3VzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzLm5leHQgPSB0aGlzLm5leHQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5uZXh0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm5leHQucHJldmlvdXMgPSB0aGlzLnByZXZpb3VzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVkaXJlY3QgdG8gdGhlIG5leHQgaXRlbVxuICAgICAgICBjb25zdCByZWRpcmVjdCA9IHRoaXMubmV4dDtcblxuICAgICAgICAvLyBSZW1vdmUgcmVmZXJlbmNlc1xuICAgICAgICB0aGlzLm5leHQgPSBoYXJkID8gbnVsbCA6IHJlZGlyZWN0O1xuICAgICAgICB0aGlzLnByZXZpb3VzID0gbnVsbDtcblxuICAgICAgICByZXR1cm4gcmVkaXJlY3Q7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBVUERBVEVfUFJJT1JJVFkgfSBmcm9tICcuL2NvbnN0JztcbmltcG9ydCB7IFRpY2tlckxpc3RlbmVyIH0gZnJvbSAnLi9UaWNrZXJMaXN0ZW5lcic7XG5cbmV4cG9ydCB0eXBlIFRpY2tlckNhbGxiYWNrPFQ+ID0gKHRoaXM6IFQsIGR0OiBudW1iZXIpID0+IGFueTtcblxuLyoqXG4gKiBBIFRpY2tlciBjbGFzcyB0aGF0IHJ1bnMgYW4gdXBkYXRlIGxvb3AgdGhhdCBvdGhlciBvYmplY3RzIGxpc3RlbiB0by5cbiAqXG4gKiBUaGlzIGNsYXNzIGlzIGNvbXBvc2VkIGFyb3VuZCBsaXN0ZW5lcnMgbWVhbnQgZm9yIGV4ZWN1dGlvbiBvbiB0aGUgbmV4dCByZXF1ZXN0ZWQgYW5pbWF0aW9uIGZyYW1lLlxuICogQW5pbWF0aW9uIGZyYW1lcyBhcmUgcmVxdWVzdGVkIG9ubHkgd2hlbiBuZWNlc3NhcnksIGUuZy4gV2hlbiB0aGUgdGlja2VyIGlzIHN0YXJ0ZWQgYW5kIHRoZSBlbWl0dGVyIGhhcyBsaXN0ZW5lcnMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgVGlja2VyXG57XG4gICAgc3RhdGljIF9zaGFyZWQ6IFRpY2tlcjtcbiAgICBzdGF0aWMgX3N5c3RlbTogVGlja2VyO1xuXG4gICAgcHVibGljIGF1dG9TdGFydDogYm9vbGVhbjtcbiAgICBwdWJsaWMgZGVsdGFUaW1lOiBudW1iZXI7XG4gICAgcHVibGljIGRlbHRhTVM6IG51bWJlcjtcbiAgICBwdWJsaWMgZWxhcHNlZE1TOiBudW1iZXI7XG4gICAgcHVibGljIGxhc3RUaW1lOiBudW1iZXI7XG4gICAgcHVibGljIHNwZWVkOiBudW1iZXI7XG4gICAgcHVibGljIHN0YXJ0ZWQ6IGJvb2xlYW47XG5cbiAgICBwcml2YXRlIF9oZWFkOiBUaWNrZXJMaXN0ZW5lcjtcbiAgICBwcml2YXRlIF9yZXF1ZXN0SWQ6IG51bWJlcjtcbiAgICBwcml2YXRlIF9tYXhFbGFwc2VkTVM6IG51bWJlcjtcbiAgICBwcml2YXRlIF9taW5FbGFwc2VkTVM6IG51bWJlcjtcbiAgICBwcml2YXRlIF9wcm90ZWN0ZWQ6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBfbGFzdEZyYW1lOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfdGljazogKHRpbWU6IG51bWJlcikgPT4gYW55O1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBmaXJzdCBsaXN0ZW5lci4gQWxsIG5ldyBsaXN0ZW5lcnMgYWRkZWQgYXJlIGNoYWluZWQgb24gdGhpcy5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge1RpY2tlckxpc3RlbmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGVhZCA9IG5ldyBUaWNrZXJMaXN0ZW5lcihudWxsLCBudWxsLCBJbmZpbml0eSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGN1cnJlbnQgZnJhbWUgcmVxdWVzdCBJRFxuICAgICAgICAgKiBAdHlwZSB7P251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3JlcXVlc3RJZCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIHZhbHVlIG1hbmFnZWQgYnkgbWluRlBTIHByb3BlcnR5IHNldHRlciBhbmQgZ2V0dGVyLlxuICAgICAgICAgKiBUaGlzIGlzIHRoZSBtYXhpbXVtIGFsbG93ZWQgbWlsbGlzZWNvbmRzIGJldHdlZW4gdXBkYXRlcy5cbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX21heEVsYXBzZWRNUyA9IDEwMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgdmFsdWUgbWFuYWdlZCBieSBtYXhGUFMgcHJvcGVydHkgc2V0dGVyIGFuZCBnZXR0ZXIuXG4gICAgICAgICAqIFRoaXMgaXMgdGhlIG1pbmltdW0gYWxsb3dlZCBtaWxsaXNlY29uZHMgYmV0d2VlbiB1cGRhdGVzLlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbWluRWxhcHNlZE1TID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBvciBub3QgdGhpcyB0aWNrZXIgc2hvdWxkIGludm9rZSB0aGUgbWV0aG9kXG4gICAgICAgICAqIHtAbGluayBQSVhJLlRpY2tlciNzdGFydH0gYXV0b21hdGljYWxseVxuICAgICAgICAgKiB3aGVuIGEgbGlzdGVuZXIgaXMgYWRkZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1dG9TdGFydCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTY2FsYXIgdGltZSB2YWx1ZSBmcm9tIGxhc3QgZnJhbWUgdG8gdGhpcyBmcmFtZS5cbiAgICAgICAgICogVGhpcyB2YWx1ZSBpcyBjYXBwZWQgYnkgc2V0dGluZyB7QGxpbmsgUElYSS5UaWNrZXIjbWluRlBTfVxuICAgICAgICAgKiBhbmQgaXMgc2NhbGVkIHdpdGgge0BsaW5rIFBJWEkuVGlja2VyI3NwZWVkfS5cbiAgICAgICAgICogKipOb3RlOioqIFRoZSBjYXAgbWF5IGJlIGV4Y2VlZGVkIGJ5IHNjYWxpbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWx0YVRpbWUgPSAxO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTY2FsZXIgdGltZSBlbGFwc2VkIGluIG1pbGxpc2Vjb25kcyBmcm9tIGxhc3QgZnJhbWUgdG8gdGhpcyBmcmFtZS5cbiAgICAgICAgICogVGhpcyB2YWx1ZSBpcyBjYXBwZWQgYnkgc2V0dGluZyB7QGxpbmsgUElYSS5UaWNrZXIjbWluRlBTfVxuICAgICAgICAgKiBhbmQgaXMgc2NhbGVkIHdpdGgge0BsaW5rIFBJWEkuVGlja2VyI3NwZWVkfS5cbiAgICAgICAgICogKipOb3RlOioqIFRoZSBjYXAgbWF5IGJlIGV4Y2VlZGVkIGJ5IHNjYWxpbmcuXG4gICAgICAgICAqIElmIHRoZSBwbGF0Zm9ybSBzdXBwb3J0cyBET01IaWdoUmVzVGltZVN0YW1wLFxuICAgICAgICAgKiB0aGlzIHZhbHVlIHdpbGwgaGF2ZSBhIHByZWNpc2lvbiBvZiAxIFx1MDBCNXMuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIHRhcmdldCBmcmFtZSB0aW1lXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMTYuNjZcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVsdGFNUyA9IDEgLyBzZXR0aW5ncy5UQVJHRVRfRlBNUztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGltZSBlbGFwc2VkIGluIG1pbGxpc2Vjb25kcyBmcm9tIGxhc3QgZnJhbWUgdG8gdGhpcyBmcmFtZS5cbiAgICAgICAgICogT3Bwb3NlZCB0byB3aGF0IHRoZSBzY2FsYXIge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX1cbiAgICAgICAgICogaXMgYmFzZWQsIHRoaXMgdmFsdWUgaXMgbmVpdGhlciBjYXBwZWQgbm9yIHNjYWxlZC5cbiAgICAgICAgICogSWYgdGhlIHBsYXRmb3JtIHN1cHBvcnRzIERPTUhpZ2hSZXNUaW1lU3RhbXAsXG4gICAgICAgICAqIHRoaXMgdmFsdWUgd2lsbCBoYXZlIGEgcHJlY2lzaW9uIG9mIDEgXHUwMEI1cy5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gdGFyZ2V0IGZyYW1lIHRpbWVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxNi42NlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5lbGFwc2VkTVMgPSAxIC8gc2V0dGluZ3MuVEFSR0VUX0ZQTVM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsYXN0IHRpbWUge0BsaW5rIFBJWEkuVGlja2VyI3VwZGF0ZX0gd2FzIGludm9rZWQuXG4gICAgICAgICAqIFRoaXMgdmFsdWUgaXMgYWxzbyByZXNldCBpbnRlcm5hbGx5IG91dHNpZGUgb2YgaW52b2tpbmdcbiAgICAgICAgICogdXBkYXRlLCBidXQgb25seSB3aGVuIGEgbmV3IGFuaW1hdGlvbiBmcmFtZSBpcyByZXF1ZXN0ZWQuXG4gICAgICAgICAqIElmIHRoZSBwbGF0Zm9ybSBzdXBwb3J0cyBET01IaWdoUmVzVGltZVN0YW1wLFxuICAgICAgICAgKiB0aGlzIHZhbHVlIHdpbGwgaGF2ZSBhIHByZWNpc2lvbiBvZiAxIFx1MDBCNXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgLTFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSAtMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRmFjdG9yIG9mIGN1cnJlbnQge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX0uXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIFNjYWxlcyB0aWNrZXIuZGVsdGFUaW1lIHRvIHdoYXQgd291bGQgYmVcbiAgICAgICAgICogLy8gdGhlIGVxdWl2YWxlbnQgb2YgYXBwcm94aW1hdGVseSAxMjAgRlBTXG4gICAgICAgICAqIHRpY2tlci5zcGVlZCA9IDI7XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zcGVlZCA9IDE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgb3Igbm90IHRoaXMgdGlja2VyIGhhcyBiZWVuIHN0YXJ0ZWQuXG4gICAgICAgICAqIGB0cnVlYCBpZiB7QGxpbmsgUElYSS5UaWNrZXIjc3RhcnR9IGhhcyBiZWVuIGNhbGxlZC5cbiAgICAgICAgICogYGZhbHNlYCBpZiB7QGxpbmsgUElYSS5UaWNrZXIjc3RvcH0gaGFzIGJlZW4gY2FsbGVkLlxuICAgICAgICAgKiBXaGlsZSBgZmFsc2VgLCB0aGlzIHZhbHVlIG1heSBjaGFuZ2UgdG8gYHRydWVgIGluIHRoZVxuICAgICAgICAgKiBldmVudCBvZiB7QGxpbmsgUElYSS5UaWNrZXIjYXV0b1N0YXJ0fSBiZWluZyBgdHJ1ZWBcbiAgICAgICAgICogYW5kIGEgbGlzdGVuZXIgaXMgYWRkZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgZW5hYmxlZCwgZGVsZXRpbmcgaXMgZGlzYWJsZWQuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9wcm90ZWN0ZWQgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGxhc3QgdGltZSBrZXlmcmFtZSB3YXMgZXhlY3V0ZWQuXG4gICAgICAgICAqIE1haW50YWlucyBhIHJlbGF0aXZlbHkgZml4ZWQgaW50ZXJ2YWwgd2l0aCB0aGUgcHJldmlvdXMgdmFsdWUuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgLTFcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xhc3RGcmFtZSA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCB0aWNrIG1ldGhvZCBib3VuZCB0byB0aWNrZXIgaW5zdGFuY2UuXG4gICAgICAgICAqIFRoaXMgaXMgYmVjYXVzZSBpbiBlYXJseSAyMDE1LCBGdW5jdGlvbi5iaW5kXG4gICAgICAgICAqIGlzIHN0aWxsIDYwJSBzbG93ZXIgaW4gaGlnaCBwZXJmb3JtYW5jZSBzY2VuYXJpb3MuXG4gICAgICAgICAqIEFsc28gc2VwYXJhdGluZyBmcmFtZSByZXF1ZXN0cyBmcm9tIHVwZGF0ZSBtZXRob2RcbiAgICAgICAgICogc28gbGlzdGVuZXJzIG1heSBiZSBjYWxsZWQgYXQgYW55IHRpbWUgYW5kIHdpdGhcbiAgICAgICAgICogYW55IGFuaW1hdGlvbiBBUEksIGp1c3QgaW52b2tlIHRpY2tlci51cGRhdGUodGltZSkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lIC0gVGltZSBzaW5jZSBsYXN0IHRpY2suXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90aWNrID0gKHRpbWU6IG51bWJlcik6IHZvaWQgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdElkID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBJbnZva2UgbGlzdGVuZXJzIG5vd1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKHRpbWUpO1xuICAgICAgICAgICAgICAgIC8vIExpc3RlbmVyIHNpZGUgZWZmZWN0cyBtYXkgaGF2ZSBtb2RpZmllZCB0aWNrZXIgc3RhdGUuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCAmJiB0aGlzLl9yZXF1ZXN0SWQgPT09IG51bGwgJiYgdGhpcy5faGVhZC5uZXh0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdElkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX3RpY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IHJlcXVlc3RzIGEgbmV3IGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKiBJZiBhIGZyYW1lIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlcXVlc3RlZCwgYW5kIGlmIHRoZSBpbnRlcm5hbFxuICAgICAqIGVtaXR0ZXIgaGFzIGxpc3RlbmVycywgYSBuZXcgZnJhbWUgaXMgcmVxdWVzdGVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9yZXF1ZXN0SWZOZWVkZWQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RJZCA9PT0gbnVsbCAmJiB0aGlzLl9oZWFkLm5leHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVuc3VyZSBjYWxsYmFja3MgZ2V0IGNvcnJlY3QgZGVsdGFcbiAgICAgICAgICAgIHRoaXMubGFzdFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RGcmFtZSA9IHRoaXMubGFzdFRpbWU7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0SWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fdGljayk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IGNhbmNlbHMgYSBwZW5kaW5nIGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfY2FuY2VsSWZOZWVkZWQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RJZCAhPT0gbnVsbClcbiAgICAgICAge1xuICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5fcmVxdWVzdElkKTtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IHJlcXVlc3RzIGEgbmV3IGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKiBJZiB0aGUgdGlja2VyIGhhcyBiZWVuIHN0YXJ0ZWQgaXQgY2hlY2tzIGlmIGEgZnJhbWUgaGFzIG5vdCBhbHJlYWR5XG4gICAgICogYmVlbiByZXF1ZXN0ZWQsIGFuZCBpZiB0aGUgaW50ZXJuYWwgZW1pdHRlciBoYXMgbGlzdGVuZXJzLiBJZiB0aGVzZVxuICAgICAqIGNvbmRpdGlvbnMgYXJlIG1ldCwgYSBuZXcgZnJhbWUgaXMgcmVxdWVzdGVkLiBJZiB0aGUgdGlja2VyIGhhcyBub3RcbiAgICAgKiBiZWVuIHN0YXJ0ZWQsIGJ1dCBhdXRvU3RhcnQgaXMgYHRydWVgLCB0aGVuIHRoZSB0aWNrZXIgc3RhcnRzIG5vdyxcbiAgICAgKiBhbmQgY29udGludWVzIHdpdGggdGhlIHByZXZpb3VzIGNvbmRpdGlvbnMgdG8gcmVxdWVzdCBhIG5ldyBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfc3RhcnRJZlBvc3NpYmxlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RJZk5lZWRlZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYXV0b1N0YXJ0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIGhhbmRsZXIgZm9yIHRpY2sgZXZlbnRzLiBDYWxscyBjb250aW51b3VzbHkgdW5sZXNzXG4gICAgICogaXQgaXMgcmVtb3ZlZCBvciB0aGUgdGlja2VyIGlzIHN0b3BwZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBhZGRlZCBmb3IgdXBkYXRlc1xuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3ByaW9yaXR5PVBJWEkuVVBEQVRFX1BSSU9SSVRZLk5PUk1BTF0gLSBUaGUgcHJpb3JpdHkgZm9yIGVtaXR0aW5nXG4gICAgICogQHJldHVybnMge1BJWEkuVGlja2VyfSBUaGlzIGluc3RhbmNlIG9mIGEgdGlja2VyXG4gICAgICovXG4gICAgYWRkPFQgPSBhbnk+KGZuOiBUaWNrZXJDYWxsYmFjazxUPiwgY29udGV4dDogVCwgcHJpb3JpdHkgPSBVUERBVEVfUFJJT1JJVFkuTk9STUFMKTogdGhpc1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkZExpc3RlbmVyKG5ldyBUaWNrZXJMaXN0ZW5lcihmbiwgY29udGV4dCwgcHJpb3JpdHkpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBoYW5kbGVyIGZvciB0aGUgdGljayBldmVudCB3aGljaCBpcyBvbmx5IGV4ZWN1dGUgb25jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gVGhlIGxpc3RlbmVyIGZ1bmN0aW9uIHRvIGJlIGFkZGVkIGZvciBvbmUgdXBkYXRlXG4gICAgICogQHBhcmFtIHsqfSBbY29udGV4dF0gLSBUaGUgbGlzdGVuZXIgY29udGV4dFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcHJpb3JpdHk9UElYSS5VUERBVEVfUFJJT1JJVFkuTk9STUFMXSAtIFRoZSBwcmlvcml0eSBmb3IgZW1pdHRpbmdcbiAgICAgKiBAcmV0dXJucyB7UElYSS5UaWNrZXJ9IFRoaXMgaW5zdGFuY2Ugb2YgYSB0aWNrZXJcbiAgICAgKi9cbiAgICBhZGRPbmNlPFQgPSBhbnk+KGZuOiBUaWNrZXJDYWxsYmFjazxUPiwgY29udGV4dDogVCwgcHJpb3JpdHkgPSBVUERBVEVfUFJJT1JJVFkuTk9STUFMKTogdGhpc1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkZExpc3RlbmVyKG5ldyBUaWNrZXJMaXN0ZW5lcihmbiwgY29udGV4dCwgcHJpb3JpdHksIHRydWUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbGx5IGFkZHMgdGhlIGV2ZW50IGhhbmRsZXIgc28gdGhhdCBpdCBjYW4gYmUgc29ydGVkIGJ5IHByaW9yaXR5LlxuICAgICAqIFByaW9yaXR5IGFsbG93cyBjZXJ0YWluIGhhbmRsZXIgKHVzZXIsIEFuaW1hdGVkU3ByaXRlLCBJbnRlcmFjdGlvbikgdG8gYmUgcnVuXG4gICAgICogYmVmb3JlIHRoZSByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7VGlja2VyTGlzdGVuZXJ9IGxpc3RlbmVyIC0gQ3VycmVudCBsaXN0ZW5lciBiZWluZyBhZGRlZC5cbiAgICAgKiBAcmV0dXJucyB7UElYSS5UaWNrZXJ9IFRoaXMgaW5zdGFuY2Ugb2YgYSB0aWNrZXJcbiAgICAgKi9cbiAgICBwcml2YXRlIF9hZGRMaXN0ZW5lcihsaXN0ZW5lcjogVGlja2VyTGlzdGVuZXIpOiB0aGlzXG4gICAge1xuICAgICAgICAvLyBGb3IgYXR0YWNoaW5nIHRvIGhlYWRcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0aGlzLl9oZWFkLm5leHQ7XG4gICAgICAgIGxldCBwcmV2aW91cyA9IHRoaXMuX2hlYWQ7XG5cbiAgICAgICAgLy8gQWRkIHRoZSBmaXJzdCBpdGVtXG4gICAgICAgIGlmICghY3VycmVudClcbiAgICAgICAge1xuICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBHbyBmcm9tIGhpZ2hlc3QgdG8gbG93ZXN0IHByaW9yaXR5XG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAobGlzdGVuZXIucHJpb3JpdHkgPiBjdXJyZW50LnByaW9yaXR5KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2aW91cyA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTm90IHlldCBjb25uZWN0ZWRcbiAgICAgICAgICAgIGlmICghbGlzdGVuZXIucHJldmlvdXMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zdGFydElmUG9zc2libGUoKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFueSBoYW5kbGVycyBtYXRjaGluZyB0aGUgZnVuY3Rpb24gYW5kIGNvbnRleHQgcGFyYW1ldGVycy5cbiAgICAgKiBJZiBubyBoYW5kbGVycyBhcmUgbGVmdCBhZnRlciByZW1vdmluZywgdGhlbiBpdCBjYW5jZWxzIHRoZSBhbmltYXRpb24gZnJhbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSByZW1vdmVkXG4gICAgICogQHBhcmFtIHsqfSBbY29udGV4dF0gLSBUaGUgbGlzdGVuZXIgY29udGV4dCB0byBiZSByZW1vdmVkXG4gICAgICogQHJldHVybnMge1BJWEkuVGlja2VyfSBUaGlzIGluc3RhbmNlIG9mIGEgdGlja2VyXG4gICAgICovXG4gICAgcmVtb3ZlPFQgPSBhbnk+KGZuOiBUaWNrZXJDYWxsYmFjazxUPiwgY29udGV4dDogVCk6IHRoaXNcbiAgICB7XG4gICAgICAgIGxldCBsaXN0ZW5lciA9IHRoaXMuX2hlYWQubmV4dDtcblxuICAgICAgICB3aGlsZSAobGlzdGVuZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIFdlIGZvdW5kIGEgbWF0Y2gsIGxldHMgcmVtb3ZlIGl0XG4gICAgICAgICAgICAvLyBubyBicmVhayB0byBkZWxldGUgYWxsIHBvc3NpYmxlIG1hdGNoZXNcbiAgICAgICAgICAgIC8vIGluY2FzZSBhIGxpc3RlbmVyIHdhcyBhZGRlZCAyKyB0aW1lc1xuICAgICAgICAgICAgaWYgKGxpc3RlbmVyLm1hdGNoKGZuLCBjb250ZXh0KSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuX2hlYWQubmV4dClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsSWZOZWVkZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2YgbGlzdGVuZXJzIG9uIHRoaXMgdGlja2VyLCBjYWxjdWxhdGVkIGJ5IHdhbGtpbmcgdGhyb3VnaCBsaW5rZWQgbGlzdFxuICAgICAqXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBjb3VudCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5faGVhZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMuX2hlYWQ7XG5cbiAgICAgICAgd2hpbGUgKChjdXJyZW50ID0gY3VycmVudC5uZXh0KSlcbiAgICAgICAge1xuICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIHRpY2tlci4gSWYgdGhlIHRpY2tlciBoYXMgbGlzdGVuZXJzXG4gICAgICogYSBuZXcgYW5pbWF0aW9uIGZyYW1lIGlzIHJlcXVlc3RlZCBhdCB0aGlzIHBvaW50LlxuICAgICAqL1xuICAgIHN0YXJ0KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdElmTmVlZGVkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wcyB0aGUgdGlja2VyLiBJZiB0aGUgdGlja2VyIGhhcyByZXF1ZXN0ZWRcbiAgICAgKiBhbiBhbmltYXRpb24gZnJhbWUgaXQgaXMgY2FuY2VsZWQgYXQgdGhpcyBwb2ludC5cbiAgICAgKi9cbiAgICBzdG9wKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsSWZOZWVkZWQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgdGhlIHRpY2tlciBhbmQgZG9uJ3QgdXNlIGFmdGVyIHRoaXMuIENhbGxpbmdcbiAgICAgKiB0aGlzIG1ldGhvZCByZW1vdmVzIGFsbCByZWZlcmVuY2VzIHRvIGludGVybmFsIGV2ZW50cy5cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5fcHJvdGVjdGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcblxuICAgICAgICAgICAgbGV0IGxpc3RlbmVyID0gdGhpcy5faGVhZC5uZXh0O1xuXG4gICAgICAgICAgICB3aGlsZSAobGlzdGVuZXIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIgPSBsaXN0ZW5lci5kZXN0cm95KHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9oZWFkLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcnMgYW4gdXBkYXRlLiBBbiB1cGRhdGUgZW50YWlscyBzZXR0aW5nIHRoZVxuICAgICAqIGN1cnJlbnQge0BsaW5rIFBJWEkuVGlja2VyI2VsYXBzZWRNU30sXG4gICAgICogdGhlIGN1cnJlbnQge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX0sXG4gICAgICogaW52b2tpbmcgYWxsIGxpc3RlbmVycyB3aXRoIGN1cnJlbnQgZGVsdGFUaW1lLFxuICAgICAqIGFuZCB0aGVuIGZpbmFsbHkgc2V0dGluZyB7QGxpbmsgUElYSS5UaWNrZXIjbGFzdFRpbWV9XG4gICAgICogd2l0aCB0aGUgdmFsdWUgb2YgY3VycmVudFRpbWUgdGhhdCB3YXMgcHJvdmlkZWQuXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYXV0b21hdGljYWxseSBieSBhbmltYXRpb25cbiAgICAgKiBmcmFtZSBjYWxsYmFja3MgaWYgdGhlIHRpY2tlciBpbnN0YW5jZSBoYXMgYmVlbiBzdGFydGVkXG4gICAgICogYW5kIGxpc3RlbmVycyBhcmUgYWRkZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2N1cnJlbnRUaW1lPXBlcmZvcm1hbmNlLm5vdygpXSAtIHRoZSBjdXJyZW50IHRpbWUgb2YgZXhlY3V0aW9uXG4gICAgICovXG4gICAgdXBkYXRlKGN1cnJlbnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkpOiB2b2lkXG4gICAge1xuICAgICAgICBsZXQgZWxhcHNlZE1TO1xuXG4gICAgICAgIC8vIElmIHRoZSBkaWZmZXJlbmNlIGluIHRpbWUgaXMgemVybyBvciBuZWdhdGl2ZSwgd2UgaWdub3JlIG1vc3Qgb2YgdGhlIHdvcmsgZG9uZSBoZXJlLlxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyB2YWxpZCBkaWZmZXJlbmNlLCB0aGVuIHNob3VsZCBiZSBubyByZWFzb24gdG8gbGV0IGFueW9uZSBrbm93IGFib3V0IGl0LlxuICAgICAgICAvLyBBIHplcm8gZGVsdGEsIGlzIGV4YWN0bHkgdGhhdCwgbm90aGluZyBzaG91bGQgdXBkYXRlLlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGUgZGlmZmVyZW5jZSBpbiB0aW1lIGNhbiBiZSBuZWdhdGl2ZSwgYW5kIG5vIHRoaXMgZG9lcyBub3QgbWVhbiB0aW1lIHRyYXZlbGluZy5cbiAgICAgICAgLy8gVGhpcyBjYW4gYmUgdGhlIHJlc3VsdCBvZiBhIHJhY2UgY29uZGl0aW9uIGJldHdlZW4gd2hlbiBhbiBhbmltYXRpb24gZnJhbWUgaXMgcmVxdWVzdGVkXG4gICAgICAgIC8vIG9uIHRoZSBjdXJyZW50IEphdmFTY3JpcHQgZW5naW5lIGV2ZW50IGxvb3AsIGFuZCB3aGVuIHRoZSB0aWNrZXIncyBzdGFydCBtZXRob2QgaXMgaW52b2tlZFxuICAgICAgICAvLyAod2hpY2ggaW52b2tlcyB0aGUgaW50ZXJuYWwgX3JlcXVlc3RJZk5lZWRlZCBtZXRob2QpLiBJZiBhIGZyYW1lIGlzIHJlcXVlc3RlZCBiZWZvcmVcbiAgICAgICAgLy8gX3JlcXVlc3RJZk5lZWRlZCBpcyBpbnZva2VkLCB0aGVuIHRoZSBjYWxsYmFjayBmb3IgdGhlIGFuaW1hdGlvbiBmcmFtZSB0aGUgdGlja2VyIHJlcXVlc3RzLFxuICAgICAgICAvLyBjYW4gcmVjZWl2ZSBhIHRpbWUgYXJndW1lbnQgdGhhdCBjYW4gYmUgbGVzcyB0aGFuIHRoZSBsYXN0VGltZSB2YWx1ZSB0aGF0IHdhcyBzZXQgd2l0aGluXG4gICAgICAgIC8vIF9yZXF1ZXN0SWZOZWVkZWQuIFRoaXMgZGlmZmVyZW5jZSBpcyBpbiBtaWNyb3NlY29uZHMsIGJ1dCB0aGlzIGlzIGVub3VnaCB0byBjYXVzZSBwcm9ibGVtcy5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhpcyBjaGVjayBjb3ZlcnMgdGhpcyBicm93c2VyIGVuZ2luZSB0aW1pbmcgaXNzdWUsIGFzIHdlbGwgYXMgaWYgY29uc3VtZXJzIHBhc3MgYW4gaW52YWxpZFxuICAgICAgICAvLyBjdXJyZW50VGltZSB2YWx1ZS4gVGhpcyBtYXkgaGFwcGVuIGlmIGNvbnN1bWVycyBvcHQtb3V0IG9mIHRoZSBhdXRvU3RhcnQsIGFuZCB1cGRhdGUgdGhlbXNlbHZlcy5cblxuICAgICAgICBpZiAoY3VycmVudFRpbWUgPiB0aGlzLmxhc3RUaW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBTYXZlIHVuY2FwcGVkIGVsYXBzZWRNUyBmb3IgbWVhc3VyZW1lbnRcbiAgICAgICAgICAgIGVsYXBzZWRNUyA9IHRoaXMuZWxhcHNlZE1TID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUaW1lO1xuXG4gICAgICAgICAgICAvLyBjYXAgdGhlIG1pbGxpc2Vjb25kcyBlbGFwc2VkIHVzZWQgZm9yIGRlbHRhVGltZVxuICAgICAgICAgICAgaWYgKGVsYXBzZWRNUyA+IHRoaXMuX21heEVsYXBzZWRNUylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBlbGFwc2VkTVMgPSB0aGlzLl9tYXhFbGFwc2VkTVM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsYXBzZWRNUyAqPSB0aGlzLnNwZWVkO1xuXG4gICAgICAgICAgICAvLyBJZiBub3QgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZCwgZXhpdCB0aGUgZnVuY3Rpb24uXG4gICAgICAgICAgICAvLyBHZXQgcmVhZHkgZm9yIG5leHQgZnJhbWUgYnkgc2V0dGluZyBfbGFzdEZyYW1lLCBidXQgYmFzZWQgb24gX21pbkVsYXBzZWRNU1xuICAgICAgICAgICAgLy8gYWRqdXN0bWVudCB0byBlbnN1cmUgYSByZWxhdGl2ZWx5IHN0YWJsZSBpbnRlcnZhbC5cbiAgICAgICAgICAgIGlmICh0aGlzLl9taW5FbGFwc2VkTVMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVsdGEgPSBjdXJyZW50VGltZSAtIHRoaXMuX2xhc3RGcmFtZSB8IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGVsdGEgPCB0aGlzLl9taW5FbGFwc2VkTVMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdEZyYW1lID0gY3VycmVudFRpbWUgLSAoZGVsdGEgJSB0aGlzLl9taW5FbGFwc2VkTVMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRlbHRhTVMgPSBlbGFwc2VkTVM7XG4gICAgICAgICAgICB0aGlzLmRlbHRhVGltZSA9IHRoaXMuZGVsdGFNUyAqIHNldHRpbmdzLlRBUkdFVF9GUE1TO1xuXG4gICAgICAgICAgICAvLyBDYWNoZSBhIGxvY2FsIHJlZmVyZW5jZSwgaW4tY2FzZSB0aWNrZXIgaXMgZGVzdHJveWVkXG4gICAgICAgICAgICAvLyBkdXJpbmcgdGhlIGVtaXQsIHdlIGNhbiBzdGlsbCBjaGVjayBmb3IgaGVhZC5uZXh0XG4gICAgICAgICAgICBjb25zdCBoZWFkID0gdGhpcy5faGVhZDtcblxuICAgICAgICAgICAgLy8gSW52b2tlIGxpc3RlbmVycyBhZGRlZCB0byBpbnRlcm5hbCBlbWl0dGVyXG4gICAgICAgICAgICBsZXQgbGlzdGVuZXIgPSBoZWFkLm5leHQ7XG5cbiAgICAgICAgICAgIHdoaWxlIChsaXN0ZW5lcilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyLmVtaXQodGhpcy5kZWx0YVRpbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWhlYWQubmV4dClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW5jZWxJZk5lZWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5kZWx0YVRpbWUgPSB0aGlzLmRlbHRhTVMgPSB0aGlzLmVsYXBzZWRNUyA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxhc3RUaW1lID0gY3VycmVudFRpbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGZyYW1lcyBwZXIgc2Vjb25kIGF0IHdoaWNoIHRoaXMgdGlja2VyIGlzIHJ1bm5pbmcuXG4gICAgICogVGhlIGRlZmF1bHQgaXMgYXBwcm94aW1hdGVseSA2MCBpbiBtb3N0IG1vZGVybiBicm93c2Vycy5cbiAgICAgKiAqKk5vdGU6KiogVGhpcyBkb2VzIG5vdCBmYWN0b3IgaW4gdGhlIHZhbHVlIG9mXG4gICAgICoge0BsaW5rIFBJWEkuVGlja2VyI3NwZWVkfSwgd2hpY2ggaXMgc3BlY2lmaWNcbiAgICAgKiB0byBzY2FsaW5nIHtAbGluayBQSVhJLlRpY2tlciNkZWx0YVRpbWV9LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCBGUFMoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gMTAwMCAvIHRoaXMuZWxhcHNlZE1TO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hbmFnZXMgdGhlIG1heGltdW0gYW1vdW50IG9mIG1pbGxpc2Vjb25kcyBhbGxvd2VkIHRvXG4gICAgICogZWxhcHNlIGJldHdlZW4gaW52b2tpbmcge0BsaW5rIFBJWEkuVGlja2VyI3VwZGF0ZX0uXG4gICAgICogVGhpcyB2YWx1ZSBpcyB1c2VkIHRvIGNhcCB7QGxpbmsgUElYSS5UaWNrZXIjZGVsdGFUaW1lfSxcbiAgICAgKiBidXQgZG9lcyBub3QgZWZmZWN0IHRoZSBtZWFzdXJlZCB2YWx1ZSBvZiB7QGxpbmsgUElYSS5UaWNrZXIjRlBTfS5cbiAgICAgKiBXaGVuIHNldHRpbmcgdGhpcyBwcm9wZXJ0eSBpdCBpcyBjbGFtcGVkIHRvIGEgdmFsdWUgYmV0d2VlblxuICAgICAqIGAwYCBhbmQgYFBJWEkuc2V0dGluZ3MuVEFSR0VUX0ZQTVMgKiAxMDAwYC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAxMFxuICAgICAqL1xuICAgIGdldCBtaW5GUFMoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gMTAwMCAvIHRoaXMuX21heEVsYXBzZWRNUztcbiAgICB9XG5cbiAgICBzZXQgbWluRlBTKGZwczogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgLy8gTWluaW11bSBtdXN0IGJlIGJlbG93IHRoZSBtYXhGUFNcbiAgICAgICAgY29uc3QgbWluRlBTID0gTWF0aC5taW4odGhpcy5tYXhGUFMsIGZwcyk7XG5cbiAgICAgICAgLy8gTXVzdCBiZSBhdCBsZWFzdCAwLCBidXQgYmVsb3cgMSAvIHNldHRpbmdzLlRBUkdFVF9GUE1TXG4gICAgICAgIGNvbnN0IG1pbkZQTVMgPSBNYXRoLm1pbihNYXRoLm1heCgwLCBtaW5GUFMpIC8gMTAwMCwgc2V0dGluZ3MuVEFSR0VUX0ZQTVMpO1xuXG4gICAgICAgIHRoaXMuX21heEVsYXBzZWRNUyA9IDEgLyBtaW5GUE1TO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hbmFnZXMgdGhlIG1pbmltdW0gYW1vdW50IG9mIG1pbGxpc2Vjb25kcyByZXF1aXJlZCB0b1xuICAgICAqIGVsYXBzZSBiZXR3ZWVuIGludm9raW5nIHtAbGluayBQSVhJLlRpY2tlciN1cGRhdGV9LlxuICAgICAqIFRoaXMgd2lsbCBlZmZlY3QgdGhlIG1lYXN1cmVkIHZhbHVlIG9mIHtAbGluayBQSVhJLlRpY2tlciNGUFN9LlxuICAgICAqIElmIGl0IGlzIHNldCB0byBgMGAsIHRoZW4gdGhlcmUgaXMgbm8gbGltaXQ7IFBpeGlKUyB3aWxsIHJlbmRlciBhcyBtYW55IGZyYW1lcyBhcyBpdCBjYW4uXG4gICAgICogT3RoZXJ3aXNlIGl0IHdpbGwgYmUgYXQgbGVhc3QgYG1pbkZQU2BcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAwXG4gICAgICovXG4gICAgZ2V0IG1heEZQUygpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9taW5FbGFwc2VkTVMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMDAgLyB0aGlzLl9taW5FbGFwc2VkTVMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgc2V0IG1heEZQUyhmcHM6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmIChmcHMgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX21pbkVsYXBzZWRNUyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBNYXggbXVzdCBiZSBhdCBsZWFzdCB0aGUgbWluRlBTXG4gICAgICAgICAgICBjb25zdCBtYXhGUFMgPSBNYXRoLm1heCh0aGlzLm1pbkZQUywgZnBzKTtcblxuICAgICAgICAgICAgdGhpcy5fbWluRWxhcHNlZE1TID0gMSAvIChtYXhGUFMgLyAxMDAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBzaGFyZWQgdGlja2VyIGluc3RhbmNlIHVzZWQgYnkge0BsaW5rIFBJWEkuQW5pbWF0ZWRTcHJpdGV9IGFuZCBieVxuICAgICAqIHtAbGluayBQSVhJLlZpZGVvUmVzb3VyY2V9IHRvIHVwZGF0ZSBhbmltYXRpb24gZnJhbWVzIC8gdmlkZW8gdGV4dHVyZXMuXG4gICAgICpcbiAgICAgKiBJdCBtYXkgYWxzbyBiZSB1c2VkIGJ5IHtAbGluayBQSVhJLkFwcGxpY2F0aW9ufSBpZiBjcmVhdGVkIHdpdGggdGhlIGBzaGFyZWRUaWNrZXJgIG9wdGlvbiBwcm9wZXJ0eSBzZXQgdG8gdHJ1ZS5cbiAgICAgKlxuICAgICAqIFRoZSBwcm9wZXJ0eSB7QGxpbmsgUElYSS5UaWNrZXIjYXV0b1N0YXJ0fSBpcyBzZXQgdG8gYHRydWVgIGZvciB0aGlzIGluc3RhbmNlLlxuICAgICAqIFBsZWFzZSBmb2xsb3cgdGhlIGV4YW1wbGVzIGZvciB1c2FnZSwgaW5jbHVkaW5nIGhvdyB0byBvcHQtb3V0IG9mIGF1dG8tc3RhcnRpbmcgdGhlIHNoYXJlZCB0aWNrZXIuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGxldCB0aWNrZXIgPSBQSVhJLlRpY2tlci5zaGFyZWQ7XG4gICAgICogLy8gU2V0IHRoaXMgdG8gcHJldmVudCBzdGFydGluZyB0aGlzIHRpY2tlciB3aGVuIGxpc3RlbmVycyBhcmUgYWRkZWQuXG4gICAgICogLy8gQnkgZGVmYXVsdCB0aGlzIGlzIHRydWUgb25seSBmb3IgdGhlIFBJWEkuVGlja2VyLnNoYXJlZCBpbnN0YW5jZS5cbiAgICAgKiB0aWNrZXIuYXV0b1N0YXJ0ID0gZmFsc2U7XG4gICAgICogLy8gRllJLCBjYWxsIHRoaXMgdG8gZW5zdXJlIHRoZSB0aWNrZXIgaXMgc3RvcHBlZC4gSXQgc2hvdWxkIGJlIHN0b3BwZWRcbiAgICAgKiAvLyBpZiB5b3UgaGF2ZSBub3QgYXR0ZW1wdGVkIHRvIHJlbmRlciBhbnl0aGluZyB5ZXQuXG4gICAgICogdGlja2VyLnN0b3AoKTtcbiAgICAgKiAvLyBDYWxsIHRoaXMgd2hlbiB5b3UgYXJlIHJlYWR5IGZvciBhIHJ1bm5pbmcgc2hhcmVkIHRpY2tlci5cbiAgICAgKiB0aWNrZXIuc3RhcnQoKTtcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gWW91IG1heSB1c2UgdGhlIHNoYXJlZCB0aWNrZXIgdG8gcmVuZGVyLi4uXG4gICAgICogbGV0IHJlbmRlcmVyID0gUElYSS5hdXRvRGV0ZWN0UmVuZGVyZXIoKTtcbiAgICAgKiBsZXQgc3RhZ2UgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgKiBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJlbmRlcmVyLnZpZXcpO1xuICAgICAqIHRpY2tlci5hZGQoZnVuY3Rpb24gKHRpbWUpIHtcbiAgICAgKiAgICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gT3IgeW91IGNhbiBqdXN0IHVwZGF0ZSBpdCBtYW51YWxseS5cbiAgICAgKiB0aWNrZXIuYXV0b1N0YXJ0ID0gZmFsc2U7XG4gICAgICogdGlja2VyLnN0b3AoKTtcbiAgICAgKiBmdW5jdGlvbiBhbmltYXRlKHRpbWUpIHtcbiAgICAgKiAgICAgdGlja2VyLnVwZGF0ZSh0aW1lKTtcbiAgICAgKiAgICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgICAgKiAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuICAgICAqIH1cbiAgICAgKiBhbmltYXRlKHBlcmZvcm1hbmNlLm5vdygpKTtcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuVGlja2VyfVxuICAgICAqIEBzdGF0aWNcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0IHNoYXJlZCgpOiBUaWNrZXJcbiAgICB7XG4gICAgICAgIGlmICghVGlja2VyLl9zaGFyZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHNoYXJlZCA9IFRpY2tlci5fc2hhcmVkID0gbmV3IFRpY2tlcigpO1xuXG4gICAgICAgICAgICBzaGFyZWQuYXV0b1N0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgIHNoYXJlZC5fcHJvdGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBUaWNrZXIuX3NoYXJlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc3lzdGVtIHRpY2tlciBpbnN0YW5jZSB1c2VkIGJ5IHtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlcn0gYW5kIGJ5XG4gICAgICoge0BsaW5rIFBJWEkuQmFzZVByZXBhcmV9IGZvciBjb3JlIHRpbWluZyBmdW5jdGlvbmFsaXR5IHRoYXQgc2hvdWxkbid0IHVzdWFsbHkgbmVlZCB0byBiZSBwYXVzZWQsXG4gICAgICogdW5saWtlIHRoZSBgc2hhcmVkYCB0aWNrZXIgd2hpY2ggZHJpdmVzIHZpc3VhbCBhbmltYXRpb25zIGFuZCByZW5kZXJpbmcgd2hpY2ggbWF5IHdhbnQgdG8gYmUgcGF1c2VkLlxuICAgICAqXG4gICAgICogVGhlIHByb3BlcnR5IHtAbGluayBQSVhJLlRpY2tlciNhdXRvU3RhcnR9IGlzIHNldCB0byBgdHJ1ZWAgZm9yIHRoaXMgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLlRpY2tlcn1cbiAgICAgKiBAc3RhdGljXG4gICAgICovXG4gICAgc3RhdGljIGdldCBzeXN0ZW0oKTogVGlja2VyXG4gICAge1xuICAgICAgICBpZiAoIVRpY2tlci5fc3lzdGVtKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBzeXN0ZW0gPSBUaWNrZXIuX3N5c3RlbSA9IG5ldyBUaWNrZXIoKTtcblxuICAgICAgICAgICAgc3lzdGVtLmF1dG9TdGFydCA9IHRydWU7XG4gICAgICAgICAgICBzeXN0ZW0uX3Byb3RlY3RlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gVGlja2VyLl9zeXN0ZW07XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFVQREFURV9QUklPUklUWSB9IGZyb20gJy4vY29uc3QnO1xuaW1wb3J0IHsgVGlja2VyIH0gZnJvbSAnLi9UaWNrZXInO1xuXG5pbXBvcnQgdHlwZSB7IElBcHBsaWNhdGlvbk9wdGlvbnMgfSBmcm9tICdAcGl4aS9hcHAnO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgZm9yIGZvciBBcHBsaWNhdGlvbiBUaWNrZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7VGlja2VyUGx1Z2lufSBmcm9tICdAcGl4aS90aWNrZXInO1xuICogaW1wb3J0IHtBcHBsaWNhdGlvbn0gZnJvbSAnQHBpeGkvYXBwJztcbiAqIEFwcGxpY2F0aW9uLnJlZ2lzdGVyUGx1Z2luKFRpY2tlclBsdWdpbik7XG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgVGlja2VyUGx1Z2luXG57XG4gICAgc3RhdGljIHN0YXJ0OiAoKSA9PiB2b2lkO1xuICAgIHN0YXRpYyBzdG9wOiAoKSA9PiB2b2lkO1xuICAgIHN0YXRpYyBfdGlja2VyOiBUaWNrZXI7XG4gICAgc3RhdGljIHRpY2tlcjogVGlja2VyO1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGUgcGx1Z2luIHdpdGggc2NvcGUgb2YgYXBwbGljYXRpb24gaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBTZWUgYXBwbGljYXRpb24gb3B0aW9uc1xuICAgICAqL1xuICAgIHN0YXRpYyBpbml0KG9wdGlvbnM/OiBJQXBwbGljYXRpb25PcHRpb25zKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gU2V0IGRlZmF1bHRcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgYXV0b1N0YXJ0OiB0cnVlLFxuICAgICAgICAgICAgc2hhcmVkVGlja2VyOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRpY2tlciBzZXR0ZXJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICd0aWNrZXInLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNldCh0aWNrZXIpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fdGlja2VyKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90aWNrZXIucmVtb3ZlKHRoaXMucmVuZGVyLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aWNrZXIgPSB0aWNrZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aWNrZXIpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tlci5hZGQodGhpcy5yZW5kZXIsIHRoaXMsIFVQREFURV9QUklPUklUWS5MT1cpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBnZXQoKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpY2tlcjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3Igc3RvcHBpbmcgdGhlIHJlbmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBQSVhJLkFwcGxpY2F0aW9uI3N0b3BcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3RvcCA9ICgpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3RpY2tlci5zdG9wKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3Igc3RhcnRpbmcgdGhlIHJlbmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBQSVhJLkFwcGxpY2F0aW9uI3N0YXJ0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXJ0ID0gKCk6IHZvaWQgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fdGlja2VyLnN0YXJ0KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIHJlZmVyZW5jZSB0byB0aGUgdGlja2VyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5UaWNrZXJ9XG4gICAgICAgICAqIEBuYW1lIF90aWNrZXJcbiAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuQXBwbGljYXRpb24jXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90aWNrZXIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaWNrZXIgZm9yIGRvaW5nIHJlbmRlciB1cGRhdGVzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5UaWNrZXJ9XG4gICAgICAgICAqIEBuYW1lIHRpY2tlclxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5BcHBsaWNhdGlvbiNcbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5UaWNrZXIuc2hhcmVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRpY2tlciA9IG9wdGlvbnMuc2hhcmVkVGlja2VyID8gVGlja2VyLnNoYXJlZCA6IG5ldyBUaWNrZXIoKTtcblxuICAgICAgICAvLyBTdGFydCB0aGUgcmVuZGVyaW5nXG4gICAgICAgIGlmIChvcHRpb25zLmF1dG9TdGFydClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgdGhlIHRpY2tlciwgc2NvcGVkIHRvIGFwcGxpY2F0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgc3RhdGljIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3RpY2tlcilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3Qgb2xkVGlja2VyID0gdGhpcy5fdGlja2VyO1xuXG4gICAgICAgICAgICB0aGlzLnRpY2tlciA9IG51bGw7XG4gICAgICAgICAgICBvbGRUaWNrZXIuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFBvaW50LCBJUG9pbnREYXRhIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmltcG9ydCB0eXBlIHsgRGlzcGxheU9iamVjdCB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuXG5leHBvcnQgdHlwZSBJbnRlcmFjdGl2ZVBvaW50ZXJFdmVudCA9IFBvaW50ZXJFdmVudCB8IFRvdWNoRXZlbnQgfCBNb3VzZUV2ZW50O1xuXG4vKipcbiAqIEhvbGRzIGFsbCBpbmZvcm1hdGlvbiByZWxhdGVkIHRvIGFuIEludGVyYWN0aW9uIGV2ZW50XG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgSW50ZXJhY3Rpb25EYXRhXG57XG4gICAgcHVibGljIGdsb2JhbDogUG9pbnQ7XG4gICAgcHVibGljIHRhcmdldDogRGlzcGxheU9iamVjdDtcbiAgICBwdWJsaWMgb3JpZ2luYWxFdmVudDogSW50ZXJhY3RpdmVQb2ludGVyRXZlbnQ7XG4gICAgcHVibGljIGlkZW50aWZpZXI6IG51bWJlcjtcbiAgICBwdWJsaWMgaXNQcmltYXJ5OiBib29sZWFuO1xuICAgIHB1YmxpYyBidXR0b246IG51bWJlcjtcbiAgICBwdWJsaWMgYnV0dG9uczogbnVtYmVyO1xuICAgIHB1YmxpYyB3aWR0aDogbnVtYmVyO1xuICAgIHB1YmxpYyBoZWlnaHQ6IG51bWJlcjtcbiAgICBwdWJsaWMgdGlsdFg6IG51bWJlcjtcbiAgICBwdWJsaWMgdGlsdFk6IG51bWJlcjtcbiAgICBwdWJsaWMgcG9pbnRlclR5cGU6IHN0cmluZztcbiAgICBwdWJsaWMgcHJlc3N1cmUgPSAwO1xuICAgIHB1YmxpYyByb3RhdGlvbkFuZ2xlID0gMDtcbiAgICBwdWJsaWMgdHdpc3QgPSAwO1xuICAgIHB1YmxpYyB0YW5nZW50aWFsUHJlc3N1cmUgPSAwO1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgcG9pbnQgc3RvcmVzIHRoZSBnbG9iYWwgY29vcmRzIG9mIHdoZXJlIHRoZSB0b3VjaC9tb3VzZSBldmVudCBoYXBwZW5lZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlBvaW50fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nbG9iYWwgPSBuZXcgUG9pbnQoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRhcmdldCBTcHJpdGUgdGhhdCB3YXMgaW50ZXJhY3RlZCB3aXRoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuU3ByaXRlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHBhc3NlZCB0byBhbiBldmVudCBoYW5kbGVyLCB0aGlzIHdpbGwgYmUgdGhlIG9yaWdpbmFsIERPTSBFdmVudCB0aGF0IHdhcyBjYXB0dXJlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Nb3VzZUV2ZW50XG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1RvdWNoRXZlbnRcbiAgICAgICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUG9pbnRlckV2ZW50XG4gICAgICAgICAqIEBtZW1iZXIge01vdXNlRXZlbnR8VG91Y2hFdmVudHxQb2ludGVyRXZlbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9yaWdpbmFsRXZlbnQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhpcyBpbnRlcmFjdGlvblxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlkZW50aWZpZXIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdGhlIHBvaW50ZXIgZGV2aWNlIHRoYXQgY3JlYXRlZCB0aGUgZXZlbnQgaXMgdGhlIHByaW1hcnkgcG9pbnRlci5cbiAgICAgICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUG9pbnRlckV2ZW50L2lzUHJpbWFyeVxuICAgICAgICAgKiBAdHlwZSB7Qm9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluZGljYXRlcyB3aGljaCBidXR0b24gd2FzIHByZXNzZWQgb24gdGhlIG1vdXNlIG9yIHBvaW50ZXIgZGV2aWNlIHRvIHRyaWdnZXIgdGhlIGV2ZW50LlxuICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Nb3VzZUV2ZW50L2J1dHRvblxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5idXR0b24gPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbmRpY2F0ZXMgd2hpY2ggYnV0dG9ucyBhcmUgcHJlc3NlZCBvbiB0aGUgbW91c2Ugb3IgcG9pbnRlciBkZXZpY2Ugd2hlbiB0aGUgZXZlbnQgaXMgdHJpZ2dlcmVkLlxuICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Nb3VzZUV2ZW50L2J1dHRvbnNcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYnV0dG9ucyA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgcG9pbnRlcidzIGNvbnRhY3QgYWxvbmcgdGhlIHgtYXhpcywgbWVhc3VyZWQgaW4gQ1NTIHBpeGVscy5cbiAgICAgICAgICogcmFkaXVzWCBvZiBUb3VjaEV2ZW50cyB3aWxsIGJlIHJlcHJlc2VudGVkIGJ5IHRoaXMgdmFsdWUuXG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BvaW50ZXJFdmVudC93aWR0aFxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53aWR0aCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIHBvaW50ZXIncyBjb250YWN0IGFsb25nIHRoZSB5LWF4aXMsIG1lYXN1cmVkIGluIENTUyBwaXhlbHMuXG4gICAgICAgICAqIHJhZGl1c1kgb2YgVG91Y2hFdmVudHMgd2lsbCBiZSByZXByZXNlbnRlZCBieSB0aGlzIHZhbHVlLlxuICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Qb2ludGVyRXZlbnQvaGVpZ2h0XG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhlaWdodCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhbmdsZSwgaW4gZGVncmVlcywgYmV0d2VlbiB0aGUgcG9pbnRlciBkZXZpY2UgYW5kIHRoZSBzY3JlZW4uXG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BvaW50ZXJFdmVudC90aWx0WFxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50aWx0WCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhbmdsZSwgaW4gZGVncmVlcywgYmV0d2VlbiB0aGUgcG9pbnRlciBkZXZpY2UgYW5kIHRoZSBzY3JlZW4uXG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BvaW50ZXJFdmVudC90aWx0WVxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50aWx0WSA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0eXBlIG9mIHBvaW50ZXIgdGhhdCB0cmlnZ2VyZWQgdGhlIGV2ZW50LlxuICAgICAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Qb2ludGVyRXZlbnQvcG9pbnRlclR5cGVcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucG9pbnRlclR5cGUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcmVzc3VyZSBhcHBsaWVkIGJ5IHRoZSBwb2ludGluZyBkZXZpY2UgZHVyaW5nIHRoZSBldmVudC4gQSBUb3VjaCdzIGZvcmNlIHByb3BlcnR5XG4gICAgICAgICAqIHdpbGwgYmUgcmVwcmVzZW50ZWQgYnkgdGhpcyB2YWx1ZS5cbiAgICAgICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUG9pbnRlckV2ZW50L3ByZXNzdXJlXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnByZXNzdXJlID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRnJvbSBUb3VjaEV2ZW50cyAobm90IFBvaW50ZXJFdmVudHMgdHJpZ2dlcmVkIGJ5IHRvdWNoZXMpLCB0aGUgcm90YXRpb25BbmdsZSBvZiB0aGUgVG91Y2guXG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1RvdWNoL3JvdGF0aW9uQW5nbGVcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucm90YXRpb25BbmdsZSA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFR3aXN0IG9mIGEgc3R5bHVzIHBvaW50ZXIuXG4gICAgICAgICAqIEBzZWUgaHR0cHM6Ly93M2MuZ2l0aHViLmlvL3BvaW50ZXJldmVudHMvI3BvaW50ZXJldmVudC1pbnRlcmZhY2VcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHdpc3QgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYXJyZWwgcHJlc3N1cmUgb24gYSBzdHlsdXMgcG9pbnRlci5cbiAgICAgICAgICogQHNlZSBodHRwczovL3czYy5naXRodWIuaW8vcG9pbnRlcmV2ZW50cy8jcG9pbnRlcmV2ZW50LWludGVyZmFjZVxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YW5nZW50aWFsUHJlc3N1cmUgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgcG9pbnRlci4gSXQgd2lsbCBiZSB0aGUgc2FtZSBhcyBgaWRlbnRpZmllcmAuXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BvaW50ZXJFdmVudC9wb2ludGVySWRcbiAgICAgKi9cbiAgICBnZXQgcG9pbnRlcklkKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRlbnRpZmllcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIHdpbGwgcmV0dXJuIHRoZSBsb2NhbCBjb29yZGluYXRlcyBvZiB0aGUgc3BlY2lmaWVkIGRpc3BsYXlPYmplY3QgZm9yIHRoaXMgSW50ZXJhY3Rpb25EYXRhXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gZGlzcGxheU9iamVjdCAtIFRoZSBEaXNwbGF5T2JqZWN0IHRoYXQgeW91IHdvdWxkIGxpa2UgdGhlIGxvY2FsXG4gICAgICogIGNvb3JkcyBvZmZcbiAgICAgKiBAcGFyYW0ge1BJWEkuUG9pbnR9IFtwb2ludF0gLSBBIFBvaW50IG9iamVjdCBpbiB3aGljaCB0byBzdG9yZSB0aGUgdmFsdWUsIG9wdGlvbmFsIChvdGhlcndpc2VcbiAgICAgKiAgd2lsbCBjcmVhdGUgYSBuZXcgcG9pbnQpXG4gICAgICogQHBhcmFtIHtQSVhJLlBvaW50fSBbZ2xvYmFsUG9zXSAtIEEgUG9pbnQgb2JqZWN0IGNvbnRhaW5pbmcgeW91ciBjdXN0b20gZ2xvYmFsIGNvb3Jkcywgb3B0aW9uYWxcbiAgICAgKiAgKG90aGVyd2lzZSB3aWxsIHVzZSB0aGUgY3VycmVudCBnbG9iYWwgY29vcmRzKVxuICAgICAqIEByZXR1cm4ge1BJWEkuUG9pbnR9IEEgcG9pbnQgY29udGFpbmluZyB0aGUgY29vcmRpbmF0ZXMgb2YgdGhlIEludGVyYWN0aW9uRGF0YSBwb3NpdGlvbiByZWxhdGl2ZVxuICAgICAqICB0byB0aGUgRGlzcGxheU9iamVjdFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRMb2NhbFBvc2l0aW9uPFAgZXh0ZW5kcyBJUG9pbnREYXRhID0gUG9pbnQ+KGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3QsIHBvaW50PzogUCwgZ2xvYmFsUG9zPzogSVBvaW50RGF0YSk6IFBcbiAgICB7XG4gICAgICAgIHJldHVybiBkaXNwbGF5T2JqZWN0LndvcmxkVHJhbnNmb3JtLmFwcGx5SW52ZXJzZTxQPihnbG9iYWxQb3MgfHwgdGhpcy5nbG9iYWwsIHBvaW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgcHJvcGVydGllcyBmcm9tIG5vcm1hbGl6ZWQgZXZlbnQgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7VG91Y2h8TW91c2VFdmVudHxQb2ludGVyRXZlbnR9IGV2ZW50IC0gVGhlIG5vcm1hbGl6ZWQgZXZlbnQgZGF0YVxuICAgICAqL1xuICAgIHB1YmxpYyBjb3B5RXZlbnQoZXZlbnQ6IFRvdWNoIHwgSW50ZXJhY3RpdmVQb2ludGVyRXZlbnQpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBpc1ByaW1hcnkgc2hvdWxkIG9ubHkgY2hhbmdlIG9uIHRvdWNoc3RhcnQvcG9pbnRlcmRvd24sIHNvIHdlIGRvbid0IHdhbnQgdG8gb3ZlcndyaXRlXG4gICAgICAgIC8vIGl0IHdpdGggXCJmYWxzZVwiIG9uIGxhdGVyIGV2ZW50cyB3aGVuIG91ciBzaGltIGZvciBpdCBvbiB0b3VjaCBldmVudHMgbWlnaHQgbm90IGJlXG4gICAgICAgIC8vIGFjY3VyYXRlXG4gICAgICAgIGlmICgnaXNQcmltYXJ5JyBpbiBldmVudCAmJiBldmVudC5pc1ByaW1hcnkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJ1dHRvbiA9ICdidXR0b24nIGluIGV2ZW50ICYmIGV2ZW50LmJ1dHRvbjtcbiAgICAgICAgLy8gZXZlbnQuYnV0dG9ucyBpcyBub3QgYXZhaWxhYmxlIGluIGFsbCBicm93c2VycyAoaWUuIFNhZmFyaSksIGJ1dCBpdCBkb2VzIGhhdmUgYSBub24tc3RhbmRhcmRcbiAgICAgICAgLy8gZXZlbnQud2hpY2ggcHJvcGVydHkgaW5zdGVhZCwgd2hpY2ggY29udmV5cyB0aGUgc2FtZSBpbmZvcm1hdGlvbi5cbiAgICAgICAgY29uc3QgYnV0dG9ucyA9ICdidXR0b25zJyBpbiBldmVudCAmJiBldmVudC5idXR0b25zO1xuXG4gICAgICAgIHRoaXMuYnV0dG9ucyA9IE51bWJlci5pc0ludGVnZXIoYnV0dG9ucykgPyBidXR0b25zIDogJ3doaWNoJyBpbiBldmVudCAmJiBldmVudC53aGljaDtcbiAgICAgICAgdGhpcy53aWR0aCA9ICd3aWR0aCcgaW4gZXZlbnQgJiYgZXZlbnQud2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gJ2hlaWdodCcgaW4gZXZlbnQgJiYgZXZlbnQuaGVpZ2h0O1xuICAgICAgICB0aGlzLnRpbHRYID0gJ3RpbHRYJyBpbiBldmVudCAmJiBldmVudC50aWx0WDtcbiAgICAgICAgdGhpcy50aWx0WSA9ICd0aWx0WScgaW4gZXZlbnQgJiYgZXZlbnQudGlsdFk7XG4gICAgICAgIHRoaXMucG9pbnRlclR5cGUgPSAncG9pbnRlclR5cGUnIGluIGV2ZW50ICYmIGV2ZW50LnBvaW50ZXJUeXBlO1xuICAgICAgICB0aGlzLnByZXNzdXJlID0gJ3ByZXNzdXJlJyBpbiBldmVudCAmJiBldmVudC5wcmVzc3VyZTtcbiAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gJ3JvdGF0aW9uQW5nbGUnIGluIGV2ZW50ICYmIGV2ZW50LnJvdGF0aW9uQW5nbGU7XG4gICAgICAgIHRoaXMudHdpc3QgPSAoJ3R3aXN0JyBpbiBldmVudCAmJiBldmVudC50d2lzdCkgfHwgMDtcbiAgICAgICAgdGhpcy50YW5nZW50aWFsUHJlc3N1cmUgPSAoJ3RhbmdlbnRpYWxQcmVzc3VyZScgaW4gZXZlbnQgJiYgZXZlbnQudGFuZ2VudGlhbFByZXNzdXJlKSB8fCAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgZGF0YSBmb3IgcG9vbGluZy5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVzZXQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gaXNQcmltYXJ5IGlzIHRoZSBvbmx5IHByb3BlcnR5IHRoYXQgd2UgcmVhbGx5IG5lZWQgdG8gcmVzZXQgLSBldmVyeXRoaW5nIGVsc2UgaXNcbiAgICAgICAgLy8gZ3VhcmFudGVlZCB0byBiZSBvdmVyd3JpdHRlblxuICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IGZhbHNlO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgdHlwZSB7IERpc3BsYXlPYmplY3QgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB0eXBlIHsgSW50ZXJhY3Rpb25EYXRhIH0gZnJvbSAnLi9JbnRlcmFjdGlvbkRhdGEnO1xuXG5leHBvcnQgdHlwZSBJbnRlcmFjdGlvbkNhbGxiYWNrID0gKGludGVyYWN0aW9uRXZlbnQ6IEludGVyYWN0aW9uRXZlbnQsIGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3QsIGhpdD86IGJvb2xlYW4pID0+IHZvaWQ7XG5cbi8qKlxuICogRXZlbnQgY2xhc3MgdGhhdCBtaW1pY3MgbmF0aXZlIERPTSBldmVudHMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgSW50ZXJhY3Rpb25FdmVudFxue1xuICAgIHB1YmxpYyBzdG9wcGVkOiBib29sZWFuO1xuICAgIHB1YmxpYyBzdG9wc1Byb3BhZ2F0aW5nQXQ6IERpc3BsYXlPYmplY3Q7XG4gICAgcHVibGljIHN0b3BQcm9wYWdhdGlvbkhpbnQ6IGJvb2xlYW47XG4gICAgcHVibGljIHRhcmdldDogRGlzcGxheU9iamVjdDtcbiAgICBwdWJsaWMgY3VycmVudFRhcmdldDogRGlzcGxheU9iamVjdDtcbiAgICBwdWJsaWMgdHlwZTogc3RyaW5nO1xuICAgIHB1YmxpYyBkYXRhOiBJbnRlcmFjdGlvbkRhdGE7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGlzIGV2ZW50IHdpbGwgY29udGludWUgcHJvcGFnYXRpbmcgaW4gdGhlIHRyZWUuXG4gICAgICAgICAqXG4gICAgICAgICAqIFJlbWFpbmluZyBldmVudHMgZm9yIHRoZSB7QGxpbmsgc3RvcHNQcm9wYWdhdGluZ0F0fSBvYmplY3RcbiAgICAgICAgICogd2lsbCBzdGlsbCBiZSBkaXNwYXRjaGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEF0IHdoaWNoIG9iamVjdCB0aGlzIGV2ZW50IHN0b3BzIHByb3BhZ2F0aW5nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkRpc3BsYXlPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0b3BzUHJvcGFnYXRpbmdBdCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgd2UgYWxyZWFkeSByZWFjaGVkIHRoZSBlbGVtZW50IHdlIHdhbnQgdG9cbiAgICAgICAgICogc3RvcCBwcm9wYWdhdGluZyBhdC4gVGhpcyBpcyBpbXBvcnRhbnQgZm9yIGRlbGF5ZWQgZXZlbnRzLFxuICAgICAgICAgKiB3aGVyZSB3ZSBzdGFydCBvdmVyIGRlZXBlciBpbiB0aGUgdHJlZSBhZ2Fpbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3RvcFByb3BhZ2F0aW9uSGludCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgb2JqZWN0IHdoaWNoIGNhdXNlZCB0aGlzIGV2ZW50IHRvIGJlIGRpc3BhdGNoZWQuXG4gICAgICAgICAqIEZvciBsaXN0ZW5lciBjYWxsYmFjayBzZWUge0BsaW5rIFBJWEkuSW50ZXJhY3Rpb25FdmVudC5jdXJyZW50VGFyZ2V0fS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5EaXNwbGF5T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgb2JqZWN0IHdob3NlIGV2ZW50IGxpc3RlbmVyXHUyMDE5cyBjYWxsYmFjayBpcyBjdXJyZW50bHkgYmVpbmcgaW52b2tlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5EaXNwbGF5T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVHlwZSBvZiB0aGUgZXZlbnRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJhY3Rpb25EYXRhIHJlbGF0ZWQgdG8gdGhpcyBldmVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkludGVyYWN0aW9uRGF0YX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJldmVudHMgZXZlbnQgZnJvbSByZWFjaGluZyBhbnkgb2JqZWN0cyBvdGhlciB0aGFuIHRoZSBjdXJyZW50IG9iamVjdC5cbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyBzdG9wUHJvcGFnYXRpb24oKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdG9wUHJvcGFnYXRpb25IaW50ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdG9wc1Byb3BhZ2F0aW5nQXQgPSB0aGlzLmN1cnJlbnRUYXJnZXQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBldmVudC5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVzZXQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3RvcHNQcm9wYWdhdGluZ0F0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdG9wUHJvcGFnYXRpb25IaW50ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY3VycmVudFRhcmdldCA9IG51bGw7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBJbnRlcmFjdGlvblRyYWNraW5nRmxhZ3NcbntcbiAgICBPVkVSOiBudW1iZXI7XG4gICAgTEVGVF9ET1dOOiBudW1iZXI7XG4gICAgUklHSFRfRE9XTjogbnVtYmVyO1xuICAgIE5PTkU6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBEaXNwbGF5T2JqZWN0cyB3aXRoIHRoZSB7QGxpbmsgUElYSS5pbnRlcmFjdGl2ZVRhcmdldH0gbWl4aW4gdXNlIHRoaXMgY2xhc3MgdG8gdHJhY2sgaW50ZXJhY3Rpb25zXG4gKlxuICogQGNsYXNzXG4gKiBAcHJpdmF0ZVxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEludGVyYWN0aW9uVHJhY2tpbmdEYXRhXG57XG4gICAgcHVibGljIHN0YXRpYyBGTEFHUzogUmVhZG9ubHk8SW50ZXJhY3Rpb25UcmFja2luZ0ZsYWdzPiA9IE9iamVjdC5mcmVlemUoe1xuICAgICAgICBOT05FOiAwLFxuICAgICAgICBPVkVSOiAxIDw8IDAsXG4gICAgICAgIExFRlRfRE9XTjogMSA8PCAxLFxuICAgICAgICBSSUdIVF9ET1dOOiAxIDw8IDIsXG4gICAgfSk7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IF9wb2ludGVySWQ6IG51bWJlcjtcbiAgICBwcml2YXRlIF9mbGFnczogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBvaW50ZXJJZCAtIFVuaXF1ZSBwb2ludGVyIGlkIG9mIHRoZSBldmVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocG9pbnRlcklkOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9wb2ludGVySWQgPSBwb2ludGVySWQ7XG4gICAgICAgIHRoaXMuX2ZsYWdzID0gSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEuRkxBR1MuTk9ORTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGZsYWcgLSBUaGUgaW50ZXJhY3Rpb24gZmxhZyB0byBzZXRcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHluIC0gU2hvdWxkIHRoZSBmbGFnIGJlIHNldCBvciB1bnNldFxuICAgICAqL1xuICAgIHByaXZhdGUgX2RvU2V0KGZsYWc6IG51bWJlciwgeW46IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoeW4pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ZsYWdzID0gdGhpcy5fZmxhZ3MgfCBmbGFnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZmxhZ3MgPSB0aGlzLl9mbGFncyAmICh+ZmxhZyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVbmlxdWUgcG9pbnRlciBpZCBvZiB0aGUgZXZlbnRcbiAgICAgKlxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBwb2ludGVySWQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcG9pbnRlcklkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXRlIG9mIHRoZSB0cmFja2luZyBkYXRhLCBleHByZXNzZWQgYXMgYml0IGZsYWdzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgZmxhZ3MoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmxhZ3M7XG4gICAgfVxuXG4gICAgc2V0IGZsYWdzKGZsYWdzOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9mbGFncyA9IGZsYWdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElzIHRoZSB0cmFja2VkIGV2ZW50IGluYWN0aXZlIChub3Qgb3ZlciBvciBkb3duKT9cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBub25lKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mbGFncyA9PT0gSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEuRkxBR1MuTk9ORTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJcyB0aGUgdHJhY2tlZCBldmVudCBvdmVyIHRoZSBEaXNwbGF5T2JqZWN0P1xuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBvdmVyKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZmxhZ3MgJiBJbnRlcmFjdGlvblRyYWNraW5nRGF0YS5GTEFHUy5PVkVSKSAhPT0gMDtcbiAgICB9XG5cbiAgICBzZXQgb3Zlcih5bjogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIHRoaXMuX2RvU2V0KEludGVyYWN0aW9uVHJhY2tpbmdEYXRhLkZMQUdTLk9WRVIsIHluKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaWQgdGhlIHJpZ2h0IG1vdXNlIGJ1dHRvbiBjb21lIGRvd24gaW4gdGhlIERpc3BsYXlPYmplY3Q/XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICovXG4gICAgZ2V0IHJpZ2h0RG93bigpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gKHRoaXMuX2ZsYWdzICYgSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEuRkxBR1MuUklHSFRfRE9XTikgIT09IDA7XG4gICAgfVxuXG4gICAgc2V0IHJpZ2h0RG93bih5bjogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIHRoaXMuX2RvU2V0KEludGVyYWN0aW9uVHJhY2tpbmdEYXRhLkZMQUdTLlJJR0hUX0RPV04sIHluKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaWQgdGhlIGxlZnQgbW91c2UgYnV0dG9uIGNvbWUgZG93biBpbiB0aGUgRGlzcGxheU9iamVjdD9cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgbGVmdERvd24oKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9mbGFncyAmIEludGVyYWN0aW9uVHJhY2tpbmdEYXRhLkZMQUdTLkxFRlRfRE9XTikgIT09IDA7XG4gICAgfVxuXG4gICAgc2V0IGxlZnREb3duKHluOiBib29sZWFuKVxuICAgIHtcbiAgICAgICAgdGhpcy5fZG9TZXQoSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEuRkxBR1MuTEVGVF9ET1dOLCB5bik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFBvaW50IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmltcG9ydCB0eXBlIHsgSW50ZXJhY3Rpb25FdmVudCwgSW50ZXJhY3Rpb25DYWxsYmFjayB9IGZyb20gJy4vSW50ZXJhY3Rpb25FdmVudCc7XG5pbXBvcnQgdHlwZSB7IENvbnRhaW5lciwgRGlzcGxheU9iamVjdCB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuXG4vKipcbiAqIFN0cmF0ZWd5IGhvdyB0byBzZWFyY2ggdGhyb3VnaCBzdGFnZSB0cmVlIGZvciBpbnRlcmFjdGl2ZSBvYmplY3RzXG4gKlxuICogQHByaXZhdGVcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFRyZWVTZWFyY2hcbntcbiAgICBwcml2YXRlIHJlYWRvbmx5IF90ZW1wUG9pbnQ6IFBvaW50O1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdGVtcFBvaW50ID0gbmV3IFBvaW50KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjdXJzaXZlIGltcGxlbWVudGF0aW9uIGZvciBmaW5kSGl0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBpbnRlcmFjdGlvbkV2ZW50IC0gZXZlbnQgY29udGFpbmluZyB0aGUgcG9pbnQgdGhhdFxuICAgICAqICBpcyB0ZXN0ZWQgZm9yIGNvbGxpc2lvblxuICAgICAqIEBwYXJhbSB7UElYSS5Db250YWluZXJ8UElYSS5TcHJpdGV8UElYSS5UaWxpbmdTcHJpdGV9IGRpc3BsYXlPYmplY3QgLSB0aGUgZGlzcGxheU9iamVjdFxuICAgICAqICB0aGF0IHdpbGwgYmUgaGl0IHRlc3QgKHJlY3Vyc2l2ZWx5IGNyYXdscyBpdHMgY2hpbGRyZW4pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2Z1bmNdIC0gdGhlIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb24gZWFjaCBpbnRlcmFjdGl2ZSBvYmplY3QuIFRoZVxuICAgICAqICBpbnRlcmFjdGlvbkV2ZW50LCBkaXNwbGF5T2JqZWN0IGFuZCBoaXQgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaGl0VGVzdF0gLSB0aGlzIGluZGljYXRlcyBpZiB0aGUgb2JqZWN0cyBpbnNpZGUgc2hvdWxkIGJlIGhpdCB0ZXN0IGFnYWluc3QgdGhlIHBvaW50XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaW50ZXJhY3RpdmVdIC0gV2hldGhlciB0aGUgZGlzcGxheU9iamVjdCBpcyBpbnRlcmFjdGl2ZVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHJldHVybnMgdHJ1ZSBpZiB0aGUgZGlzcGxheU9iamVjdCBoaXQgdGhlIHBvaW50XG4gICAgICovXG4gICAgcHVibGljIHJlY3Vyc2l2ZUZpbmRIaXQoaW50ZXJhY3Rpb25FdmVudDogSW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCxcbiAgICAgICAgZnVuYz86IEludGVyYWN0aW9uQ2FsbGJhY2ssIGhpdFRlc3Q/OiBib29sZWFuLCBpbnRlcmFjdGl2ZT86IGJvb2xlYW5cbiAgICApOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAoIWRpc3BsYXlPYmplY3QgfHwgIWRpc3BsYXlPYmplY3QudmlzaWJsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcG9pbnQgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGEuZ2xvYmFsO1xuXG4gICAgICAgIC8vIFRvb2sgYSBsaXR0bGUgd2hpbGUgdG8gcmV3b3JrIHRoaXMgZnVuY3Rpb24gY29ycmVjdGx5ISBCdXQgbm93IGl0IGlzIGRvbmUgYW5kIG5pY2UgYW5kIG9wdGltaXplZCEgXl9eXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gd2lsbCBub3cgbG9vcCB0aHJvdWdoIGFsbCBvYmplY3RzIGFuZCB0aGVuIG9ubHkgaGl0IHRlc3QgdGhlIG9iamVjdHMgaXQgSEFTXG4gICAgICAgIC8vIHRvLCBub3QgYWxsIG9mIHRoZW0uIE1VQ0ggZmFzdGVyLi5cbiAgICAgICAgLy8gQW4gb2JqZWN0IHdpbGwgYmUgaGl0IHRlc3QgaWYgdGhlIGZvbGxvd2luZyBpcyB0cnVlOlxuICAgICAgICAvL1xuICAgICAgICAvLyAxOiBJdCBpcyBpbnRlcmFjdGl2ZS5cbiAgICAgICAgLy8gMjogSXQgYmVsb25ncyB0byBhIHBhcmVudCB0aGF0IGlzIGludGVyYWN0aXZlIEFORCBvbmUgb2YgdGhlIHBhcmVudHMgY2hpbGRyZW4gaGF2ZSBub3QgYWxyZWFkeSBiZWVuIGhpdC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gQXMgYW5vdGhlciBsaXR0bGUgb3B0aW1pemF0aW9uIG9uY2UgYW4gaW50ZXJhY3RpdmUgb2JqZWN0IGhhcyBiZWVuIGhpdCB3ZSBjYW4gY2Fycnkgb25cbiAgICAgICAgLy8gdGhyb3VnaCB0aGUgc2NlbmVncmFwaCwgYnV0IHdlIGtub3cgdGhhdCB0aGVyZSB3aWxsIGJlIG5vIG1vcmUgaGl0cyEgU28gd2UgY2FuIGF2b2lkIGV4dHJhIGhpdCB0ZXN0c1xuICAgICAgICAvLyBBIGZpbmFsIG9wdGltaXphdGlvbiBpcyB0aGF0IGFuIG9iamVjdCBpcyBub3QgaGl0IHRlc3QgZGlyZWN0bHkgaWYgYSBjaGlsZCBoYXMgYWxyZWFkeSBiZWVuIGhpdC5cblxuICAgICAgICBpbnRlcmFjdGl2ZSA9IGRpc3BsYXlPYmplY3QuaW50ZXJhY3RpdmUgfHwgaW50ZXJhY3RpdmU7XG5cbiAgICAgICAgbGV0IGhpdCA9IGZhbHNlO1xuICAgICAgICBsZXQgaW50ZXJhY3RpdmVQYXJlbnQgPSBpbnRlcmFjdGl2ZTtcblxuICAgICAgICAvLyBGbGFnIGhlcmUgY2FuIHNldCB0byBmYWxzZSBpZiB0aGUgZXZlbnQgaXMgb3V0c2lkZSB0aGUgcGFyZW50cyBoaXRBcmVhIG9yIG1hc2tcbiAgICAgICAgbGV0IGhpdFRlc3RDaGlsZHJlbiA9IHRydWU7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBoaXRBcmVhLCBubyBuZWVkIHRvIHRlc3QgYWdhaW5zdCBhbnl0aGluZyBlbHNlIGlmIHRoZSBwb2ludGVyIGlzIG5vdCB3aXRoaW4gdGhlIGhpdEFyZWFcbiAgICAgICAgLy8gVGhlcmUgaXMgYWxzbyBubyBsb25nZXIgYSBuZWVkIHRvIGhpdFRlc3QgY2hpbGRyZW4uXG4gICAgICAgIGlmIChkaXNwbGF5T2JqZWN0LmhpdEFyZWEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChoaXRUZXN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3Qud29ybGRUcmFuc2Zvcm0uYXBwbHlJbnZlcnNlKHBvaW50LCB0aGlzLl90ZW1wUG9pbnQpO1xuICAgICAgICAgICAgICAgIGlmICghZGlzcGxheU9iamVjdC5oaXRBcmVhLmNvbnRhaW5zKHRoaXMuX3RlbXBQb2ludC54LCB0aGlzLl90ZW1wUG9pbnQueSkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBoaXRUZXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGhpdFRlc3RDaGlsZHJlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBoaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGludGVyYWN0aXZlUGFyZW50ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBtYXNrLCBubyBuZWVkIHRvIGhpdFRlc3QgYWdhaW5zdCBhbnl0aGluZyBlbHNlIGlmIHRoZSBwb2ludGVyIGlzIG5vdCB3aXRoaW4gdGhlIG1hc2suXG4gICAgICAgIC8vIFdlIHN0aWxsIHdhbnQgdG8gaGl0VGVzdENoaWxkcmVuLCBob3dldmVyLCB0byBlbnN1cmUgYSBtb3VzZW91dCBjYW4gc3RpbGwgYmUgZ2VuZXJhdGVkLlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcGl4aWpzL3BpeGkuanMvaXNzdWVzLzUxMzVcbiAgICAgICAgZWxzZSBpZiAoZGlzcGxheU9iamVjdC5fbWFzaylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGhpdFRlc3QpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKCEoKGRpc3BsYXlPYmplY3QuX21hc2sgYXMgYW55KS5jb250YWluc1BvaW50ICYmIChkaXNwbGF5T2JqZWN0Ll9tYXNrIGFzIGFueSkuY29udGFpbnNQb2ludChwb2ludCkpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaGl0VGVzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vICoqIEZSRUUgVElQICoqISBJZiBhbiBvYmplY3QgaXMgbm90IGludGVyYWN0aXZlIG9yIGhhcyBubyBidXR0b25zIGluIGl0XG4gICAgICAgIC8vIChzdWNoIGFzIGEgZ2FtZSBzY2VuZSEpIHNldCBpbnRlcmFjdGl2ZUNoaWxkcmVuIHRvIGZhbHNlIGZvciB0aGF0IGRpc3BsYXlPYmplY3QuXG4gICAgICAgIC8vIFRoaXMgd2lsbCBhbGxvdyBQaXhpSlMgdG8gY29tcGxldGVseSBpZ25vcmUgYW5kIGJ5cGFzcyBjaGVja2luZyB0aGUgZGlzcGxheU9iamVjdHMgY2hpbGRyZW4uXG4gICAgICAgIGlmIChoaXRUZXN0Q2hpbGRyZW4gJiYgZGlzcGxheU9iamVjdC5pbnRlcmFjdGl2ZUNoaWxkcmVuICYmIChkaXNwbGF5T2JqZWN0IGFzIENvbnRhaW5lcikuY2hpbGRyZW4pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gKGRpc3BsYXlPYmplY3QgYXMgQ29udGFpbmVyKS5jaGlsZHJlbjtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGNoaWxkcmVuLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgICAgICAvLyB0aW1lIHRvIGdldCByZWN1cnNpdmUuLiBpZiB0aGlzIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIGlmIHNvbWV0aGluZyBpcyBoaXQuLlxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkSGl0ID0gdGhpcy5yZWN1cnNpdmVGaW5kSGl0KGludGVyYWN0aW9uRXZlbnQsIGNoaWxkLCBmdW5jLCBoaXRUZXN0LCBpbnRlcmFjdGl2ZVBhcmVudCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRIaXQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyBpdHMgYSBnb29kIGlkZWEgdG8gY2hlY2sgaWYgYSBjaGlsZCBoYXMgbG9zdCBpdHMgcGFyZW50LlxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIG1lYW5zIGl0IGhhcyBiZWVuIHJlbW92ZWQgd2hpbHN0IGxvb3Bpbmcgc28gaXRzIGJlc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGlsZC5wYXJlbnQpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gd2Ugbm8gbG9uZ2VyIG5lZWQgdG8gaGl0IHRlc3QgYW55IG1vcmUgb2JqZWN0cyBpbiB0aGlzIGNvbnRhaW5lciBhcyB3ZSB3ZVxuICAgICAgICAgICAgICAgICAgICAvLyBub3cga25vdyB0aGUgcGFyZW50IGhhcyBiZWVuIGhpdFxuICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGl2ZVBhcmVudCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBjaGlsZCBpcyBpbnRlcmFjdGl2ZSAsIHRoYXQgbWVhbnMgdGhhdCB0aGUgb2JqZWN0IGhpdCB3YXMgYWN0dWFsbHlcbiAgICAgICAgICAgICAgICAgICAgLy8gaW50ZXJhY3RpdmUgYW5kIG5vdCBqdXN0IHRoZSBjaGlsZCBvZiBhbiBpbnRlcmFjdGl2ZSBvYmplY3QuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgbWVhbnMgd2Ugbm8gbG9uZ2VyIG5lZWQgdG8gaGl0IHRlc3QgYW55dGhpbmcgZWxzZS4gV2Ugc3RpbGwgbmVlZCB0byBydW5cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhyb3VnaCBhbGwgb2JqZWN0cywgYnV0IHdlIGRvbid0IG5lZWQgdG8gcGVyZm9ybSBhbnkgaGl0IHRlc3RzLlxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZEhpdClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludGVyYWN0aW9uRXZlbnQudGFyZ2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpdFRlc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhpdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBubyBwb2ludCBydW5uaW5nIHRoaXMgaWYgdGhlIGl0ZW0gaXMgbm90IGludGVyYWN0aXZlIG9yIGRvZXMgbm90IGhhdmUgYW4gaW50ZXJhY3RpdmUgcGFyZW50LlxuICAgICAgICBpZiAoaW50ZXJhY3RpdmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGlmIHdlIGFyZSBoaXQgdGVzdGluZyAoYXMgaW4gd2UgaGF2ZSBubyBoaXQgYW55IG9iamVjdHMgeWV0KVxuICAgICAgICAgICAgLy8gV2UgYWxzbyBkb24ndCBuZWVkIHRvIHdvcnJ5IGFib3V0IGhpdCB0ZXN0aW5nIGlmIG9uY2Ugb2YgdGhlIGRpc3BsYXlPYmplY3RzIGNoaWxkcmVuXG4gICAgICAgICAgICAvLyBoYXMgYWxyZWFkeSBiZWVuIGhpdCAtIGJ1dCBvbmx5IGlmIGl0IHdhcyBpbnRlcmFjdGl2ZSwgb3RoZXJ3aXNlIHdlIG5lZWQgdG8ga2VlcFxuICAgICAgICAgICAgLy8gbG9va2luZyBmb3IgYW4gaW50ZXJhY3RpdmUgY2hpbGQsIGp1c3QgaW4gY2FzZSB3ZSBoaXQgb25lXG4gICAgICAgICAgICBpZiAoaGl0VGVzdCAmJiAhaW50ZXJhY3Rpb25FdmVudC50YXJnZXQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gYWxyZWFkeSB0ZXN0ZWQgYWdhaW5zdCBoaXRBcmVhIGlmIGl0IGlzIGRlZmluZWRcbiAgICAgICAgICAgICAgICBpZiAoIWRpc3BsYXlPYmplY3QuaGl0QXJlYSAmJiAoZGlzcGxheU9iamVjdCBhcyBhbnkpLmNvbnRhaW5zUG9pbnQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGRpc3BsYXlPYmplY3QgYXMgYW55KS5jb250YWluc1BvaW50KHBvaW50KSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGRpc3BsYXlPYmplY3QuaW50ZXJhY3RpdmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGhpdCAmJiAhaW50ZXJhY3Rpb25FdmVudC50YXJnZXQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbkV2ZW50LnRhcmdldCA9IGRpc3BsYXlPYmplY3Q7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZ1bmMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBmdW5jKGludGVyYWN0aW9uRXZlbnQsIGRpc3BsYXlPYmplY3QsICEhaGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaGl0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgcHJvdmlkZXMgYSBuZWF0IHdheSBvZiBjcmF3bGluZyB0aHJvdWdoIHRoZSBzY2VuZSBncmFwaCBhbmQgcnVubmluZyBhXG4gICAgICogc3BlY2lmaWVkIGZ1bmN0aW9uIG9uIGFsbCBpbnRlcmFjdGl2ZSBvYmplY3RzIGl0IGZpbmRzLiBJdCB3aWxsIGFsc28gdGFrZSBjYXJlIG9mIGhpdFxuICAgICAqIHRlc3RpbmcgdGhlIGludGVyYWN0aXZlIG9iamVjdHMgYW5kIHBhc3NlcyB0aGUgaGl0IGFjcm9zcyBpbiB0aGUgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBpbnRlcmFjdGlvbkV2ZW50IC0gZXZlbnQgY29udGFpbmluZyB0aGUgcG9pbnQgdGhhdFxuICAgICAqICBpcyB0ZXN0ZWQgZm9yIGNvbGxpc2lvblxuICAgICAqIEBwYXJhbSB7UElYSS5Db250YWluZXJ8UElYSS5TcHJpdGV8UElYSS5UaWxpbmdTcHJpdGV9IGRpc3BsYXlPYmplY3QgLSB0aGUgZGlzcGxheU9iamVjdFxuICAgICAqICB0aGF0IHdpbGwgYmUgaGl0IHRlc3QgKHJlY3Vyc2l2ZWx5IGNyYXdscyBpdHMgY2hpbGRyZW4pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2Z1bmNdIC0gdGhlIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb24gZWFjaCBpbnRlcmFjdGl2ZSBvYmplY3QuIFRoZVxuICAgICAqICBpbnRlcmFjdGlvbkV2ZW50LCBkaXNwbGF5T2JqZWN0IGFuZCBoaXQgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaGl0VGVzdF0gLSB0aGlzIGluZGljYXRlcyBpZiB0aGUgb2JqZWN0cyBpbnNpZGUgc2hvdWxkIGJlIGhpdCB0ZXN0IGFnYWluc3QgdGhlIHBvaW50XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gcmV0dXJucyB0cnVlIGlmIHRoZSBkaXNwbGF5T2JqZWN0IGhpdCB0aGUgcG9pbnRcbiAgICAgKi9cbiAgICBwdWJsaWMgZmluZEhpdChpbnRlcmFjdGlvbkV2ZW50OiBJbnRlcmFjdGlvbkV2ZW50LCBkaXNwbGF5T2JqZWN0OiBEaXNwbGF5T2JqZWN0LFxuICAgICAgICBmdW5jPzogSW50ZXJhY3Rpb25DYWxsYmFjaywgaGl0VGVzdD86IGJvb2xlYW5cbiAgICApOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlY3Vyc2l2ZUZpbmRIaXQoaW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdCwgZnVuYywgaGl0VGVzdCwgZmFsc2UpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgdHlwZSB7IEludGVyYWN0aW9uVHJhY2tpbmdEYXRhIH0gZnJvbSAnLi9JbnRlcmFjdGlvblRyYWNraW5nRGF0YSc7XG5cbmV4cG9ydCB0eXBlIEN1cnNvciA9ICdhdXRvJ1xuICAgIHwgJ2RlZmF1bHQnXG4gICAgfCAnbm9uZSdcbiAgICB8ICdjb250ZXh0LW1lbnUnXG4gICAgfCAnaGVscCdcbiAgICB8ICdwb2ludGVyJ1xuICAgIHwgJ3Byb2dyZXNzJ1xuICAgIHwgJ3dhaXQnXG4gICAgfCAnY2VsbCdcbiAgICB8ICdjcm9zc2hhaXInXG4gICAgfCAndGV4dCdcbiAgICB8ICd2ZXJ0aWNhbC10ZXh0J1xuICAgIHwgJ2FsaWFzJ1xuICAgIHwgJ2NvcHknXG4gICAgfCAnbW92ZSdcbiAgICB8ICduby1kcm9wJ1xuICAgIHwgJ25vdC1hbGxvd2VkJ1xuICAgIHwgJ2UtcmVzaXplJ1xuICAgIHwgJ24tcmVzaXplJ1xuICAgIHwgJ25lLXJlc2l6ZSdcbiAgICB8ICdudy1yZXNpemUnXG4gICAgfCAncy1yZXNpemUnXG4gICAgfCAnc2UtcmVzaXplJ1xuICAgIHwgJ3N3LXJlc2l6ZSdcbiAgICB8ICd3LXJlc2l6ZSdcbiAgICB8ICducy1yZXNpemUnXG4gICAgfCAnZXctcmVzaXplJ1xuICAgIHwgJ25lc3ctcmVzaXplJ1xuICAgIHwgJ2NvbC1yZXNpemUnXG4gICAgfCAnbndzZS1yZXNpemUnXG4gICAgfCAncm93LXJlc2l6ZSdcbiAgICB8ICdhbGwtc2Nyb2xsJ1xuICAgIHwgJ3pvb20taW4nXG4gICAgfCAnem9vbS1vdXQnXG4gICAgfCAnZ3JhYidcbiAgICB8ICdncmFiYmluZyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUhpdEFyZWEge1xuICAgIGNvbnRhaW5zKHg6IG51bWJlciwgeTogbnVtYmVyKTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbnRlcmFjdGl2ZVRhcmdldCB7XG4gICAgaW50ZXJhY3RpdmU6IGJvb2xlYW47XG4gICAgaW50ZXJhY3RpdmVDaGlsZHJlbjogYm9vbGVhbjtcbiAgICBoaXRBcmVhOiBJSGl0QXJlYTtcbiAgICBjdXJzb3I6IEN1cnNvciB8IHN0cmluZztcbiAgICBidXR0b25Nb2RlOiBib29sZWFuO1xuICAgIHRyYWNrZWRQb2ludGVyczoge1t4OiBudW1iZXJdOiBJbnRlcmFjdGlvblRyYWNraW5nRGF0YX07XG4gICAgX3RyYWNrZWRQb2ludGVyczoge1t4OiBudW1iZXJdOiBJbnRlcmFjdGlvblRyYWNraW5nRGF0YX07XG59XG5cbi8qKlxuICogSW50ZXJmYWNlIGZvciBjbGFzc2VzIHRoYXQgcmVwcmVzZW50IGEgaGl0IGFyZWEuXG4gKlxuICogSXQgaXMgaW1wbGVtZW50ZWQgYnkgdGhlIGZvbGxvd2luZyBjbGFzc2VzOlxuICogLSB7QGxpbmsgUElYSS5DaXJjbGV9XG4gKiAtIHtAbGluayBQSVhJLkVsbGlwc2V9XG4gKiAtIHtAbGluayBQSVhJLlBvbHlnb259XG4gKiAtIHtAbGluayBQSVhJLlJvdW5kZWRSZWN0YW5nbGV9XG4gKlxuICogQGludGVyZmFjZSBJSGl0QXJlYVxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB4IGFuZCB5IGNvb3JkaW5hdGVzIGdpdmVuIGFyZSBjb250YWluZWQgd2l0aGluIHRoaXMgYXJlYVxuICpcbiAqIEBtZXRob2RcbiAqIEBuYW1lIGNvbnRhaW5zXG4gKiBAbWVtYmVyb2YgUElYSS5JSGl0QXJlYSNcbiAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQgdG8gdGVzdFxuICogQHBhcmFtIHtudW1iZXJ9IHkgLSBUaGUgWSBjb29yZGluYXRlIG9mIHRoZSBwb2ludCB0byB0ZXN0XG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSB4L3kgY29vcmRpbmF0ZXMgYXJlIHdpdGhpbiB0aGlzIGFyZWFcbiAqL1xuXG4vKipcbiAqIERlZmF1bHQgcHJvcGVydHkgdmFsdWVzIG9mIGludGVyYWN0aXZlIG9iamVjdHNcbiAqIFVzZWQgYnkge0BsaW5rIFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyfSB0byBhdXRvbWF0aWNhbGx5IGdpdmUgYWxsIERpc3BsYXlPYmplY3RzIHRoZXNlIHByb3BlcnRpZXNcbiAqXG4gKiBAcHJpdmF0ZVxuICogQG5hbWUgaW50ZXJhY3RpdmVUYXJnZXRcbiAqIEB0eXBlIHtPYmplY3R9XG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGV4YW1wbGVcbiAqICAgICAgZnVuY3Rpb24gTXlPYmplY3QoKSB7fVxuICpcbiAqICAgICAgT2JqZWN0LmFzc2lnbihcbiAqICAgICAgICAgIERpc3BsYXlPYmplY3QucHJvdG90eXBlLFxuICogICAgICAgICAgUElYSS5pbnRlcmFjdGl2ZVRhcmdldFxuICogICAgICApO1xuICovXG5leHBvcnQgY29uc3QgaW50ZXJhY3RpdmVUYXJnZXQ6IEludGVyYWN0aXZlVGFyZ2V0ID0ge1xuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIGludGVyYWN0aW9uIGV2ZW50cyBmb3IgdGhlIERpc3BsYXlPYmplY3QuIFRvdWNoLCBwb2ludGVyIGFuZCBtb3VzZVxuICAgICAqIGV2ZW50cyB3aWxsIG5vdCBiZSBlbWl0dGVkIHVubGVzcyBgaW50ZXJhY3RpdmVgIGlzIHNldCB0byBgdHJ1ZWAuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAgICAgKiBzcHJpdGUuaW50ZXJhY3RpdmUgPSB0cnVlO1xuICAgICAqIHNwcml0ZS5vbigndGFwJywgKGV2ZW50KSA9PiB7XG4gICAgICogICAgLy9oYW5kbGUgZXZlbnRcbiAgICAgKiB9KTtcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICovXG4gICAgaW50ZXJhY3RpdmU6IGZhbHNlLFxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyBpZiB0aGUgY2hpbGRyZW4gdG8gdGhlIGRpc3BsYXlPYmplY3QgY2FuIGJlIGNsaWNrZWQvdG91Y2hlZFxuICAgICAqIFNldHRpbmcgdGhpcyB0byBmYWxzZSBhbGxvd3MgUGl4aUpTIHRvIGJ5cGFzcyBhIHJlY3Vyc2l2ZSBgaGl0VGVzdGAgZnVuY3Rpb25cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQG1lbWJlcm9mIFBJWEkuQ29udGFpbmVyI1xuICAgICAqL1xuICAgIGludGVyYWN0aXZlQ2hpbGRyZW46IHRydWUsXG5cbiAgICAvKipcbiAgICAgKiBJbnRlcmFjdGlvbiBzaGFwZS4gQ2hpbGRyZW4gd2lsbCBiZSBoaXQgZmlyc3QsIHRoZW4gdGhpcyBzaGFwZSB3aWxsIGJlIGNoZWNrZWQuXG4gICAgICogU2V0dGluZyB0aGlzIHdpbGwgY2F1c2UgdGhpcyBzaGFwZSB0byBiZSBjaGVja2VkIGluIGhpdCB0ZXN0cyByYXRoZXIgdGhhbiB0aGUgZGlzcGxheU9iamVjdCdzIGJvdW5kcy5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICAgICAqIHNwcml0ZS5pbnRlcmFjdGl2ZSA9IHRydWU7XG4gICAgICogc3ByaXRlLmhpdEFyZWEgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwgMCwgMTAwLCAxMDApO1xuICAgICAqIEBtZW1iZXIge1BJWEkuSUhpdEFyZWF9XG4gICAgICogQG1lbWJlcm9mIFBJWEkuRGlzcGxheU9iamVjdCNcbiAgICAgKi9cbiAgICBoaXRBcmVhOiBudWxsLFxuXG4gICAgLyoqXG4gICAgICogSWYgZW5hYmxlZCwgdGhlIG1vdXNlIGN1cnNvciB1c2UgdGhlIHBvaW50ZXIgYmVoYXZpb3Igd2hlbiBob3ZlcmVkIG92ZXIgdGhlIGRpc3BsYXlPYmplY3QgaWYgaXQgaXMgaW50ZXJhY3RpdmVcbiAgICAgKiBTZXR0aW5nIHRoaXMgY2hhbmdlcyB0aGUgJ2N1cnNvcicgcHJvcGVydHkgdG8gYCdwb2ludGVyJ2AuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAgICAgKiBzcHJpdGUuaW50ZXJhY3RpdmUgPSB0cnVlO1xuICAgICAqIHNwcml0ZS5idXR0b25Nb2RlID0gdHJ1ZTtcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICovXG4gICAgZ2V0IGJ1dHRvbk1vZGUoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3Vyc29yID09PSAncG9pbnRlcic7XG4gICAgfSxcbiAgICBzZXQgYnV0dG9uTW9kZSh2YWx1ZTogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jdXJzb3IgPT09ICdwb2ludGVyJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jdXJzb3IgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRoaXMgZGVmaW5lcyB3aGF0IGN1cnNvciBtb2RlIGlzIHVzZWQgd2hlbiB0aGUgbW91c2UgY3Vyc29yXG4gICAgICogaXMgaG92ZXJlZCBvdmVyIHRoZSBkaXNwbGF5T2JqZWN0LlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gICAgICogc3ByaXRlLmludGVyYWN0aXZlID0gdHJ1ZTtcbiAgICAgKiBzcHJpdGUuY3Vyc29yID0gJ3dhaXQnO1xuICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9XZWIvQ1NTL2N1cnNvclxuICAgICAqXG4gICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICovXG4gICAgY3Vyc29yOiBudWxsLFxuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgc2V0IG9mIGFsbCBhY3RpdmUgcG9pbnRlcnMsIGJ5IGlkZW50aWZpZXJcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge01hcDxudW1iZXIsIEludGVyYWN0aW9uVHJhY2tpbmdEYXRhPn1cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5EaXNwbGF5T2JqZWN0I1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZ2V0IHRyYWNrZWRQb2ludGVycygpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fdHJhY2tlZFBvaW50ZXJzID09PSB1bmRlZmluZWQpIHRoaXMuX3RyYWNrZWRQb2ludGVycyA9IHt9O1xuXG4gICAgICAgIHJldHVybiB0aGlzLl90cmFja2VkUG9pbnRlcnM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE1hcCBvZiBhbGwgdHJhY2tlZCBwb2ludGVycywgYnkgaWRlbnRpZmllci4gVXNlIHRyYWNrZWRQb2ludGVycyB0byBhY2Nlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEB0eXBlIHtNYXA8bnVtYmVyLCBJbnRlcmFjdGlvblRyYWNraW5nRGF0YT59XG4gICAgICovXG4gICAgX3RyYWNrZWRQb2ludGVyczogdW5kZWZpbmVkLFxufTtcbiIsICJpbXBvcnQgeyBUaWNrZXIsIFVQREFURV9QUklPUklUWSB9IGZyb20gJ0BwaXhpL3RpY2tlcic7XG5pbXBvcnQgeyBEaXNwbGF5T2JqZWN0LCBUZW1wb3JhcnlEaXNwbGF5T2JqZWN0IH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBJbnRlcmFjdGlvbkRhdGEsIEludGVyYWN0aXZlUG9pbnRlckV2ZW50IH0gZnJvbSAnLi9JbnRlcmFjdGlvbkRhdGEnO1xuaW1wb3J0IHsgSW50ZXJhY3Rpb25FdmVudCwgSW50ZXJhY3Rpb25DYWxsYmFjayB9IGZyb20gJy4vSW50ZXJhY3Rpb25FdmVudCc7XG5pbXBvcnQgeyBJbnRlcmFjdGlvblRyYWNraW5nRGF0YSB9IGZyb20gJy4vSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEnO1xuaW1wb3J0IHsgVHJlZVNlYXJjaCB9IGZyb20gJy4vVHJlZVNlYXJjaCc7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgeyBpbnRlcmFjdGl2ZVRhcmdldCB9IGZyb20gJy4vaW50ZXJhY3RpdmVUYXJnZXQnO1xuXG5pbXBvcnQgdHlwZSB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB0eXBlIHsgUG9pbnQsIElQb2ludERhdGEgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuLy8gTWl4IGludGVyYWN0aXZlVGFyZ2V0IGludG8gRGlzcGxheU9iamVjdC5wcm90b3R5cGUsXG4vLyBhZnRlciBkZXByZWNhdGlvbiBoYXMgYmVlbiBoYW5kbGVkXG5EaXNwbGF5T2JqZWN0Lm1peGluKGludGVyYWN0aXZlVGFyZ2V0KTtcblxuY29uc3QgTU9VU0VfUE9JTlRFUl9JRCA9IDE7XG5cbi8vIE1vY2sgaW50ZXJmYWNlIGZvciBoaXRUZXN0RXZlbnQgLSBvbmx5IHVzZWQgaW5zaWRlIGhpdFRlc3QoKVxuaW50ZXJmYWNlIFRlc3RJbnRlcmFjdGlvbkV2ZW50XG57XG4gICAgdGFyZ2V0OiBEaXNwbGF5T2JqZWN0O1xuICAgIGRhdGE6IHtnbG9iYWw6IFBvaW50fTtcbn1cblxuLy8gaGVscGVycyBmb3IgaGl0VGVzdCgpIC0gb25seSB1c2VkIGluc2lkZSBoaXRUZXN0KClcbmNvbnN0IGhpdFRlc3RFdmVudDogVGVzdEludGVyYWN0aW9uRXZlbnQgPSB7XG4gICAgdGFyZ2V0OiBudWxsLFxuICAgIGRhdGE6IHtcbiAgICAgICAgZ2xvYmFsOiBudWxsLFxuICAgIH0sXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEludGVyYWN0aW9uTWFuYWdlck9wdGlvbnMge1xuICAgIGF1dG9QcmV2ZW50RGVmYXVsdD86IGJvb2xlYW47XG4gICAgaW50ZXJhY3Rpb25GcmVxdWVuY3k/OiBudW1iZXI7XG4gICAgdXNlU3lzdGVtVGlja2VyPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZWxheWVkRXZlbnQge1xuICAgIGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3Q7XG4gICAgZXZlbnRTdHJpbmc6IHN0cmluZztcbiAgICBldmVudERhdGE6IEludGVyYWN0aW9uRXZlbnQ7XG59XG5cbmludGVyZmFjZSBDcm9zc0NTU1N0eWxlRGVjbGFyYXRpb24gZXh0ZW5kcyBDU1NTdHlsZURlY2xhcmF0aW9uXG57XG4gICAgbXNDb250ZW50Wm9vbWluZzogc3RyaW5nO1xuICAgIG1zVG91Y2hBY3Rpb246IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgaW50ZXJhY3Rpb24gbWFuYWdlciBkZWFscyB3aXRoIG1vdXNlLCB0b3VjaCBhbmQgcG9pbnRlciBldmVudHMuXG4gKlxuICogQW55IERpc3BsYXlPYmplY3QgY2FuIGJlIGludGVyYWN0aXZlIGlmIGl0cyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IGlzIHNldCB0byB0cnVlLlxuICpcbiAqIFRoaXMgbWFuYWdlciBhbHNvIHN1cHBvcnRzIG11bHRpdG91Y2guXG4gKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGNyZWF0ZWQgYnkgZGVmYXVsdCwgYW5kIGNhbiBiZSBmb3VuZCBhdCBgcmVuZGVyZXIucGx1Z2lucy5pbnRlcmFjdGlvbmBcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkudXRpbHMuRXZlbnRFbWl0dGVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgSW50ZXJhY3Rpb25NYW5hZ2VyIGV4dGVuZHMgRXZlbnRFbWl0dGVyXG57XG4gICAgcHVibGljIHJlYWRvbmx5IGFjdGl2ZUludGVyYWN0aW9uRGF0YTogeyBba2V5OiBudW1iZXJdOiBJbnRlcmFjdGlvbkRhdGEgfTtcbiAgICBwdWJsaWMgcmVhZG9ubHkgc3VwcG9ydHNUb3VjaEV2ZW50czogYm9vbGVhbjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgc3VwcG9ydHNQb2ludGVyRXZlbnRzOiBib29sZWFuO1xuICAgIHB1YmxpYyBpbnRlcmFjdGlvbkRhdGFQb29sOiBJbnRlcmFjdGlvbkRhdGFbXTtcbiAgICBwdWJsaWMgY3Vyc29yOiBzdHJpbmc7XG4gICAgcHVibGljIGRlbGF5ZWRFdmVudHM6IERlbGF5ZWRFdmVudFtdO1xuICAgIHB1YmxpYyBzZWFyY2g6IFRyZWVTZWFyY2g7XG4gICAgcHVibGljIHJlbmRlcmVyOiBBYnN0cmFjdFJlbmRlcmVyO1xuICAgIHB1YmxpYyBhdXRvUHJldmVudERlZmF1bHQ6IGJvb2xlYW47XG4gICAgcHVibGljIGludGVyYWN0aW9uRnJlcXVlbmN5OiBudW1iZXI7XG4gICAgcHVibGljIG1vdXNlOiBJbnRlcmFjdGlvbkRhdGE7XG4gICAgcHVibGljIGV2ZW50RGF0YTogSW50ZXJhY3Rpb25FdmVudDtcbiAgICBwdWJsaWMgbW92ZVdoZW5JbnNpZGU6IGJvb2xlYW47XG4gICAgcHVibGljIGN1cnNvclN0eWxlczogRGljdDxzdHJpbmcgfCAoKG1vZGU6IHN0cmluZykgPT4gdm9pZCkgfCBDU1NTdHlsZURlY2xhcmF0aW9uPjtcbiAgICBwdWJsaWMgY3VycmVudEN1cnNvck1vZGU6IHN0cmluZztcbiAgICBwdWJsaWMgcmVzb2x1dGlvbjogbnVtYmVyO1xuXG4gICAgcHJvdGVjdGVkIGludGVyYWN0aW9uRE9NRWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIGV2ZW50c0FkZGVkOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCB0aWNrZXJBZGRlZDogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgbW91c2VPdmVyUmVuZGVyZXI6IGJvb2xlYW47XG5cbiAgICBwcml2YXRlIF91c2VTeXN0ZW1UaWNrZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBfZGVsdGFUaW1lOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfZGlkTW92ZTogYm9vbGVhbjtcbiAgICBwcml2YXRlIF90ZW1wRGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdDtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5DYW52YXNSZW5kZXJlcnxQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IHJlbmRlcmVyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25zIGZvciB0aGUgbWFuYWdlci5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9QcmV2ZW50RGVmYXVsdD10cnVlXSAtIFNob3VsZCB0aGUgbWFuYWdlciBhdXRvbWF0aWNhbGx5IHByZXZlbnQgZGVmYXVsdCBicm93c2VyIGFjdGlvbnMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmludGVyYWN0aW9uRnJlcXVlbmN5PTEwXSAtIE1heGltdW0gcmVxdWVuY3kgKG1zKSBhdCBwb2ludGVyIG92ZXIvb3V0IHN0YXRlcyB3aWxsIGJlIGNoZWNrZWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnVzZVN5c3RlbVRpY2tlcj10cnVlXSAtIFdoZXRoZXIgdG8gYWRkIHtAbGluayB0aWNrZXJVcGRhdGV9IHRvIHtAbGluayBQSVhJLlRpY2tlci5zeXN0ZW19LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBBYnN0cmFjdFJlbmRlcmVyLCBvcHRpb25zOiBJbnRlcmFjdGlvbk1hbmFnZXJPcHRpb25zKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlbmRlcmVyIHRoaXMgaW50ZXJhY3Rpb24gbWFuYWdlciB3b3JrcyBmb3IuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQWJzdHJhY3RSZW5kZXJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2hvdWxkIGRlZmF1bHQgYnJvd3NlciBhY3Rpb25zIGF1dG9tYXRpY2FsbHkgYmUgcHJldmVudGVkLlxuICAgICAgICAgKiBEb2VzIG5vdCBhcHBseSB0byBwb2ludGVyIGV2ZW50cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICogcHJldmVudERlZmF1bHQgb24gcG9pbnRlciBldmVudHMgc3RvcHMgbW91c2UgZXZlbnRzIGZyb20gZmlyaW5nXG4gICAgICAgICAqIFRodXMsIGZvciBldmVyeSBwb2ludGVyIGV2ZW50LCB0aGVyZSB3aWxsIGFsd2F5cyBiZSBlaXRoZXIgYSBtb3VzZSBvZiB0b3VjaCBldmVudCBhbG9uZ3NpZGUgaXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYXV0b1ByZXZlbnREZWZhdWx0ID0gb3B0aW9ucy5hdXRvUHJldmVudERlZmF1bHQgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuYXV0b1ByZXZlbnREZWZhdWx0IDogdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogTWF4aW11bSByZXF1ZW5jeSBpbiBtaWxsaXNlY29uZHMgYXQgd2hpY2ggcG9pbnRlciBvdmVyL291dCBzdGF0ZXMgd2lsbCBiZSBjaGVja2VkIGJ5IHtAbGluayB0aWNrZXJVcGRhdGV9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDEwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmludGVyYWN0aW9uRnJlcXVlbmN5ID0gb3B0aW9ucy5pbnRlcmFjdGlvbkZyZXF1ZW5jeSB8fCAxMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG1vdXNlIGRhdGFcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5JbnRlcmFjdGlvbkRhdGF9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1vdXNlID0gbmV3IEludGVyYWN0aW9uRGF0YSgpO1xuICAgICAgICB0aGlzLm1vdXNlLmlkZW50aWZpZXIgPSBNT1VTRV9QT0lOVEVSX0lEO1xuXG4gICAgICAgIC8vIHNldHRpbmcgdGhlIG1vdXNlIHRvIHN0YXJ0IG9mZiBmYXIgb2ZmIHNjcmVlbiB3aWxsIG1lYW4gdGhhdCBtb3VzZSBvdmVyIGRvZXNcbiAgICAgICAgLy8gIG5vdCBnZXQgY2FsbGVkIGJlZm9yZSB3ZSBldmVuIG1vdmUgdGhlIG1vdXNlLlxuICAgICAgICB0aGlzLm1vdXNlLmdsb2JhbC5zZXQoLTk5OTk5OSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFjdGl2ZWx5IHRyYWNrZWQgSW50ZXJhY3Rpb25EYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdC48bnVtYmVyLFBJWEkuSW50ZXJhY3Rpb25EYXRhPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWN0aXZlSW50ZXJhY3Rpb25EYXRhID0ge307XG4gICAgICAgIHRoaXMuYWN0aXZlSW50ZXJhY3Rpb25EYXRhW01PVVNFX1BPSU5URVJfSURdID0gdGhpcy5tb3VzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUG9vbCBvZiB1bnVzZWQgSW50ZXJhY3Rpb25EYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuSW50ZXJhY3Rpb25EYXRhW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmludGVyYWN0aW9uRGF0YVBvb2wgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gZXZlbnQgZGF0YSBvYmplY3QgdG8gaGFuZGxlIGFsbCB0aGUgZXZlbnQgdHJhY2tpbmcvZGlzcGF0Y2hpbmdcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ldmVudERhdGEgPSBuZXcgSW50ZXJhY3Rpb25FdmVudCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgRE9NIGVsZW1lbnQgdG8gYmluZCB0by5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtIVE1MRWxlbWVudH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBwcm9wZXJ0eSBkZXRlcm1pbmVzIGlmIG1vdXNlbW92ZSBhbmQgdG91Y2htb3ZlIGV2ZW50cyBhcmUgZmlyZWQgb25seSB3aGVuIHRoZSBjdXJzb3JcbiAgICAgICAgICogaXMgb3ZlciB0aGUgb2JqZWN0LlxuICAgICAgICAgKiBTZXR0aW5nIHRvIHRydWUgd2lsbCBtYWtlIHRoaW5ncyB3b3JrIG1vcmUgaW4gbGluZSB3aXRoIGhvdyB0aGUgRE9NIHZlcnNpb24gd29ya3MuXG4gICAgICAgICAqIFNldHRpbmcgdG8gZmFsc2UgY2FuIG1ha2UgdGhpbmdzIGVhc2llciBmb3IgdGhpbmdzIGxpa2UgZHJhZ2dpbmdcbiAgICAgICAgICogSXQgaXMgY3VycmVudGx5IHNldCB0byBmYWxzZSBhcyB0aGlzIGlzIGhvdyBQaXhpSlMgdXNlZCB0byB3b3JrLiBUaGlzIHdpbGwgYmUgc2V0IHRvIHRydWUgaW5cbiAgICAgICAgICogZnV0dXJlIHZlcnNpb25zIG9mIHBpeGkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1vdmVXaGVuSW5zaWRlID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhdmUgZXZlbnRzIGJlZW4gYXR0YWNoZWQgdG8gdGhlIGRvbSBlbGVtZW50P1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmV2ZW50c0FkZGVkID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhcyB0aGUgc3lzdGVtIHRpY2tlciBiZWVuIGFkZGVkP1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRpY2tlckFkZGVkID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElzIHRoZSBtb3VzZSBob3ZlcmluZyBvdmVyIHRoZSByZW5kZXJlcj9cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tb3VzZU92ZXJSZW5kZXJlciA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEb2VzIHRoZSBkZXZpY2Ugc3VwcG9ydCB0b3VjaCBldmVudHNcbiAgICAgICAgICogaHR0cHM6Ly93d3cudzMub3JnL1RSL3RvdWNoLWV2ZW50cy9cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN1cHBvcnRzVG91Y2hFdmVudHMgPSAnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3c7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERvZXMgdGhlIGRldmljZSBzdXBwb3J0IHBvaW50ZXIgZXZlbnRzXG4gICAgICAgICAqIGh0dHBzOi8vd3d3LnczLm9yZy9TdWJtaXNzaW9uL3BvaW50ZXItZXZlbnRzL1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3VwcG9ydHNQb2ludGVyRXZlbnRzID0gISF3aW5kb3cuUG9pbnRlckV2ZW50O1xuXG4gICAgICAgIC8vIHRoaXMgd2lsbCBtYWtlIGl0IHNvIHRoYXQgeW91IGRvbid0IGhhdmUgdG8gY2FsbCBiaW5kIGFsbCB0aGUgdGltZVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Qb2ludGVyVXAgPSB0aGlzLm9uUG9pbnRlclVwLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMucHJvY2Vzc1BvaW50ZXJVcCA9IHRoaXMucHJvY2Vzc1BvaW50ZXJVcC5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Qb2ludGVyQ2FuY2VsID0gdGhpcy5vblBvaW50ZXJDYW5jZWwuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlckNhbmNlbCA9IHRoaXMucHJvY2Vzc1BvaW50ZXJDYW5jZWwuYmluZCh0aGlzKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7RnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uUG9pbnRlckRvd24gPSB0aGlzLm9uUG9pbnRlckRvd24uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlckRvd24gPSB0aGlzLnByb2Nlc3NQb2ludGVyRG93bi5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Qb2ludGVyTW92ZSA9IHRoaXMub25Qb2ludGVyTW92ZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnByb2Nlc3NQb2ludGVyTW92ZSA9IHRoaXMucHJvY2Vzc1BvaW50ZXJNb3ZlLmJpbmQodGhpcyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge0Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vblBvaW50ZXJPdXQgPSB0aGlzLm9uUG9pbnRlck91dC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnByb2Nlc3NQb2ludGVyT3Zlck91dCA9IHRoaXMucHJvY2Vzc1BvaW50ZXJPdmVyT3V0LmJpbmQodGhpcyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge0Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vblBvaW50ZXJPdmVyID0gdGhpcy5vblBvaW50ZXJPdmVyLmJpbmQodGhpcyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpY3Rpb25hcnkgb2YgaG93IGRpZmZlcmVudCBjdXJzb3IgbW9kZXMgYXJlIGhhbmRsZWQuIFN0cmluZ3MgYXJlIGhhbmRsZWQgYXMgQ1NTIGN1cnNvclxuICAgICAgICAgKiB2YWx1ZXMsIG9iamVjdHMgYXJlIGhhbmRsZWQgYXMgZGljdGlvbmFyaWVzIG9mIENTUyB2YWx1ZXMgZm9yIGludGVyYWN0aW9uRE9NRWxlbWVudCxcbiAgICAgICAgICogYW5kIGZ1bmN0aW9ucyBhcmUgY2FsbGVkIGluc3RlYWQgb2YgY2hhbmdpbmcgdGhlIENTUy5cbiAgICAgICAgICogRGVmYXVsdCBDU1MgY3Vyc29yIHZhbHVlcyBhcmUgcHJvdmlkZWQgZm9yICdkZWZhdWx0JyBhbmQgJ3BvaW50ZXInIG1vZGVzLlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3QuPHN0cmluZywgT2JqZWN0Pn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3Vyc29yU3R5bGVzID0ge1xuICAgICAgICAgICAgZGVmYXVsdDogJ2luaGVyaXQnLFxuICAgICAgICAgICAgcG9pbnRlcjogJ3BvaW50ZXInLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbW9kZSBvZiB0aGUgY3Vyc29yIHRoYXQgaXMgYmVpbmcgdXNlZC5cbiAgICAgICAgICogVGhlIHZhbHVlIG9mIHRoaXMgaXMgYSBrZXkgZnJvbSB0aGUgY3Vyc29yU3R5bGVzIGRpY3Rpb25hcnkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3VycmVudEN1cnNvck1vZGUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCBjYWNoZWQgbGV0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnNvciA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjdXJyZW50IHJlc29sdXRpb24gLyBkZXZpY2UgcGl4ZWwgcmF0aW8uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNvbHV0aW9uID0gMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVsYXllZCBwb2ludGVyIGV2ZW50cy4gVXNlZCB0byBndWFyYW50ZWUgY29ycmVjdCBvcmRlcmluZyBvZiBvdmVyL291dCBldmVudHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWxheWVkRXZlbnRzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyZWVTZWFyY2ggY29tcG9uZW50IHRoYXQgaXMgdXNlZCB0byBoaXRUZXN0IHN0YWdlIHRyZWVcbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UcmVlU2VhcmNofVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWFyY2ggPSBuZXcgVHJlZVNlYXJjaCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VkIGFzIGEgbGFzdCByZW5kZXJlZCBvYmplY3QgaW4gY2FzZSByZW5kZXJlciBkb2VzbnQgaGF2ZSBfbGFzdE9iamVjdFJlbmRlcmVkXG4gICAgICAgICAqIEBtZW1iZXIge0Rpc3BsYXlPYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90ZW1wRGlzcGxheU9iamVjdCA9IG5ldyBUZW1wb3JhcnlEaXNwbGF5T2JqZWN0KCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBidXR0b24gKHVzdWFsbHkgYSBtb3VzZSBsZWZ0LWJ1dHRvbikgaXMgcHJlc3NlZCBvbiB0aGUgZGlzcGxheVxuICAgICAgICAgKiBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNtb3VzZWRvd25cbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyBwcmVzc2VkXG4gICAgICAgICAqIG9uIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3JpZ2h0ZG93blxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiAodXN1YWxseSBhIG1vdXNlIGxlZnQtYnV0dG9uKSBpcyByZWxlYXNlZCBvdmVyIHRoZSBkaXNwbGF5XG4gICAgICAgICAqIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI21vdXNldXBcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyByZWxlYXNlZFxuICAgICAgICAgKiBvdmVyIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3JpZ2h0dXBcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBidXR0b24gKHVzdWFsbHkgYSBtb3VzZSBsZWZ0LWJ1dHRvbikgaXMgcHJlc3NlZCBhbmQgcmVsZWFzZWQgb25cbiAgICAgICAgICogdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjY2xpY2tcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyBwcmVzc2VkXG4gICAgICAgICAqIGFuZCByZWxlYXNlZCBvbiB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNyaWdodGNsaWNrXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgbGVmdC1idXR0b24pIGlzIHJlbGVhc2VkIG91dHNpZGUgdGhlXG4gICAgICAgICAqIGRpc3BsYXkgb2JqZWN0IHRoYXQgaW5pdGlhbGx5IHJlZ2lzdGVyZWQgYVxuICAgICAgICAgKiBbbW91c2Vkb3duXXtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNldmVudDptb3VzZWRvd259LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjbW91c2V1cG91dHNpZGVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyByZWxlYXNlZFxuICAgICAgICAgKiBvdXRzaWRlIHRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IGluaXRpYWxseSByZWdpc3RlcmVkIGFcbiAgICAgICAgICogW3JpZ2h0ZG93bl17QGxpbmsgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjZXZlbnQ6cmlnaHRkb3dufS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3JpZ2h0dXBvdXRzaWRlXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgKHVzdWFsbHkgYSBtb3VzZSkgaXMgbW92ZWQgd2hpbGUgb3ZlciB0aGUgZGlzcGxheSBvYmplY3RcbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI21vdXNlbW92ZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlICh1c3VhbGx5IGEgbW91c2UpIGlzIG1vdmVkIG9udG8gdGhlIGRpc3BsYXkgb2JqZWN0XG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNtb3VzZW92ZXJcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSAodXN1YWxseSBhIG1vdXNlKSBpcyBtb3ZlZCBvZmYgdGhlIGRpc3BsYXkgb2JqZWN0XG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNtb3VzZW91dFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiBpcyBwcmVzc2VkIG9uIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3BvaW50ZXJkb3duXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgYnV0dG9uIGlzIHJlbGVhc2VkIG92ZXIgdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBOb3QgYWx3YXlzIGZpcmVkIHdoZW4gc29tZSBidXR0b25zIGFyZSBoZWxkIGRvd24gd2hpbGUgb3RoZXJzIGFyZSByZWxlYXNlZC4gSW4gdGhvc2UgY2FzZXMsXG4gICAgICAgICAqIHVzZSBbbW91c2Vkb3duXXtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNldmVudDptb3VzZWRvd259IGFuZFxuICAgICAgICAgKiBbbW91c2V1cF17QGxpbmsgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjZXZlbnQ6bW91c2V1cH0gaW5zdGVhZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3BvaW50ZXJ1cFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiB0aGUgb3BlcmF0aW5nIHN5c3RlbSBjYW5jZWxzIGEgcG9pbnRlciBldmVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjcG9pbnRlcmNhbmNlbFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiBpcyBwcmVzc2VkIGFuZCByZWxlYXNlZCBvbiB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNwb2ludGVydGFwXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgYnV0dG9uIGlzIHJlbGVhc2VkIG91dHNpZGUgdGhlIGRpc3BsYXkgb2JqZWN0IHRoYXQgaW5pdGlhbGx5XG4gICAgICAgICAqIHJlZ2lzdGVyZWQgYSBbcG9pbnRlcmRvd25de0BsaW5rIFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI2V2ZW50OnBvaW50ZXJkb3dufS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3BvaW50ZXJ1cG91dHNpZGVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBpcyBtb3ZlZCB3aGlsZSBvdmVyIHRoZSBkaXNwbGF5IG9iamVjdFxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjcG9pbnRlcm1vdmVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBpcyBtb3ZlZCBvbnRvIHRoZSBkaXNwbGF5IG9iamVjdFxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjcG9pbnRlcm92ZXJcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBpcyBtb3ZlZCBvZmYgdGhlIGRpc3BsYXkgb2JqZWN0XG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNwb2ludGVyb3V0XG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgdG91Y2ggcG9pbnQgaXMgcGxhY2VkIG9uIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3RvdWNoc3RhcnRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSB0b3VjaCBwb2ludCBpcyByZW1vdmVkIGZyb20gdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5JbnRlcmFjdGlvbk1hbmFnZXIjdG91Y2hlbmRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gdGhlIG9wZXJhdGluZyBzeXN0ZW0gY2FuY2VscyBhIHRvdWNoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkludGVyYWN0aW9uTWFuYWdlciN0b3VjaGNhbmNlbFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHRvdWNoIHBvaW50IGlzIHBsYWNlZCBhbmQgcmVtb3ZlZCBmcm9tIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3RhcFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHRvdWNoIHBvaW50IGlzIHJlbW92ZWQgb3V0c2lkZSBvZiB0aGUgZGlzcGxheSBvYmplY3QgdGhhdCBpbml0aWFsbHlcbiAgICAgICAgICogcmVnaXN0ZXJlZCBhIFt0b3VjaHN0YXJ0XXtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlciNldmVudDp0b3VjaHN0YXJ0fS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3RvdWNoZW5kb3V0c2lkZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHRvdWNoIHBvaW50IGlzIG1vdmVkIGFsb25nIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyI3RvdWNobW92ZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiAodXN1YWxseSBhIG1vdXNlIGxlZnQtYnV0dG9uKSBpcyBwcmVzc2VkIG9uIHRoZSBkaXNwbGF5LlxuICAgICAgICAgKiBvYmplY3QuIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I21vdXNlZG93blxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIHNlY29uZGFyeSBidXR0b24gKHVzdWFsbHkgYSBtb3VzZSByaWdodC1idXR0b24pIGlzIHByZXNzZWRcbiAgICAgICAgICogb24gdGhlIGRpc3BsYXkgb2JqZWN0LiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNyaWdodGRvd25cbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBidXR0b24gKHVzdWFsbHkgYSBtb3VzZSBsZWZ0LWJ1dHRvbikgaXMgcmVsZWFzZWQgb3ZlciB0aGUgZGlzcGxheVxuICAgICAgICAgKiBvYmplY3QuIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I21vdXNldXBcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyByZWxlYXNlZFxuICAgICAgICAgKiBvdmVyIHRoZSBkaXNwbGF5IG9iamVjdC4gRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjcmlnaHR1cFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiAodXN1YWxseSBhIG1vdXNlIGxlZnQtYnV0dG9uKSBpcyBwcmVzc2VkIGFuZCByZWxlYXNlZCBvblxuICAgICAgICAgKiB0aGUgZGlzcGxheSBvYmplY3QuIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I2NsaWNrXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2Ugc2Vjb25kYXJ5IGJ1dHRvbiAodXN1YWxseSBhIG1vdXNlIHJpZ2h0LWJ1dHRvbikgaXMgcHJlc3NlZFxuICAgICAgICAgKiBhbmQgcmVsZWFzZWQgb24gdGhlIGRpc3BsYXkgb2JqZWN0LiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNyaWdodGNsaWNrXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgbGVmdC1idXR0b24pIGlzIHJlbGVhc2VkIG91dHNpZGUgdGhlXG4gICAgICAgICAqIGRpc3BsYXkgb2JqZWN0IHRoYXQgaW5pdGlhbGx5IHJlZ2lzdGVyZWQgYVxuICAgICAgICAgKiBbbW91c2Vkb3duXXtAbGluayBQSVhJLkRpc3BsYXlPYmplY3QjZXZlbnQ6bW91c2Vkb3dufS5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjbW91c2V1cG91dHNpZGVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBzZWNvbmRhcnkgYnV0dG9uICh1c3VhbGx5IGEgbW91c2UgcmlnaHQtYnV0dG9uKSBpcyByZWxlYXNlZFxuICAgICAgICAgKiBvdXRzaWRlIHRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IGluaXRpYWxseSByZWdpc3RlcmVkIGFcbiAgICAgICAgICogW3JpZ2h0ZG93bl17QGxpbmsgUElYSS5EaXNwbGF5T2JqZWN0I2V2ZW50OnJpZ2h0ZG93bn0uXG4gICAgICAgICAqIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I3JpZ2h0dXBvdXRzaWRlXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgcG9pbnRlciBkZXZpY2UgKHVzdWFsbHkgYSBtb3VzZSkgaXMgbW92ZWQgd2hpbGUgb3ZlciB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I21vdXNlbW92ZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlICh1c3VhbGx5IGEgbW91c2UpIGlzIG1vdmVkIG9udG8gdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNtb3VzZW92ZXJcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSAodXN1YWxseSBhIG1vdXNlKSBpcyBtb3ZlZCBvZmYgdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNtb3VzZW91dFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiBpcyBwcmVzc2VkIG9uIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjcG9pbnRlcmRvd25cbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBidXR0b24gaXMgcmVsZWFzZWQgb3ZlciB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I3BvaW50ZXJ1cFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiB0aGUgb3BlcmF0aW5nIHN5c3RlbSBjYW5jZWxzIGEgcG9pbnRlciBldmVudC5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjcG9pbnRlcmNhbmNlbFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGJ1dHRvbiBpcyBwcmVzc2VkIGFuZCByZWxlYXNlZCBvbiB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I3BvaW50ZXJ0YXBcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBwb2ludGVyIGRldmljZSBidXR0b24gaXMgcmVsZWFzZWQgb3V0c2lkZSB0aGUgZGlzcGxheSBvYmplY3QgdGhhdCBpbml0aWFsbHlcbiAgICAgICAgICogcmVnaXN0ZXJlZCBhIFtwb2ludGVyZG93bl17QGxpbmsgUElYSS5EaXNwbGF5T2JqZWN0I2V2ZW50OnBvaW50ZXJkb3dufS5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjcG9pbnRlcnVwb3V0c2lkZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGlzIG1vdmVkIHdoaWxlIG92ZXIgdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNwb2ludGVybW92ZVxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGlzIG1vdmVkIG9udG8gdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCNwb2ludGVyb3ZlclxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHBvaW50ZXIgZGV2aWNlIGlzIG1vdmVkIG9mZiB0aGUgZGlzcGxheSBvYmplY3QuXG4gICAgICAgICAqIERpc3BsYXlPYmplY3QncyBgaW50ZXJhY3RpdmVgIHByb3BlcnR5IG11c3QgYmUgc2V0IHRvIGB0cnVlYCB0byBmaXJlIGV2ZW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5EaXNwbGF5T2JqZWN0I3BvaW50ZXJvdXRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSB0b3VjaCBwb2ludCBpcyBwbGFjZWQgb24gdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCN0b3VjaHN0YXJ0XG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgdG91Y2ggcG9pbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjdG91Y2hlbmRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gdGhlIG9wZXJhdGluZyBzeXN0ZW0gY2FuY2VscyBhIHRvdWNoLlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCN0b3VjaGNhbmNlbFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnQgLSBJbnRlcmFjdGlvbiBldmVudFxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZWQgd2hlbiBhIHRvdWNoIHBvaW50IGlzIHBsYWNlZCBhbmQgcmVtb3ZlZCBmcm9tIHRoZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjdGFwXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgdG91Y2ggcG9pbnQgaXMgcmVtb3ZlZCBvdXRzaWRlIG9mIHRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IGluaXRpYWxseVxuICAgICAgICAgKiByZWdpc3RlcmVkIGEgW3RvdWNoc3RhcnRde0BsaW5rIFBJWEkuRGlzcGxheU9iamVjdCNldmVudDp0b3VjaHN0YXJ0fS5cbiAgICAgICAgICogRGlzcGxheU9iamVjdCdzIGBpbnRlcmFjdGl2ZWAgcHJvcGVydHkgbXVzdCBiZSBzZXQgdG8gYHRydWVgIHRvIGZpcmUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLkRpc3BsYXlPYmplY3QjdG91Y2hlbmRvdXRzaWRlXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBldmVudCAtIEludGVyYWN0aW9uIGV2ZW50XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgdG91Y2ggcG9pbnQgaXMgbW92ZWQgYWxvbmcgdGhlIGRpc3BsYXkgb2JqZWN0LlxuICAgICAgICAgKiBEaXNwbGF5T2JqZWN0J3MgYGludGVyYWN0aXZlYCBwcm9wZXJ0eSBtdXN0IGJlIHNldCB0byBgdHJ1ZWAgdG8gZmlyZSBldmVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuRGlzcGxheU9iamVjdCN0b3VjaG1vdmVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGV2ZW50IC0gSW50ZXJhY3Rpb24gZXZlbnRcbiAgICAgICAgICovXG5cbiAgICAgICAgdGhpcy5fdXNlU3lzdGVtVGlja2VyID0gb3B0aW9ucy51c2VTeXN0ZW1UaWNrZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMudXNlU3lzdGVtVGlja2VyIDogdHJ1ZTtcblxuICAgICAgICB0aGlzLnNldFRhcmdldEVsZW1lbnQodGhpcy5yZW5kZXJlci52aWV3LCB0aGlzLnJlbmRlcmVyLnJlc29sdXRpb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3VsZCB0aGUgSW50ZXJhY3Rpb25NYW5hZ2VyIGF1dG9tYXRpY2FsbHkgYWRkIHtAbGluayB0aWNrZXJVcGRhdGV9IHRvIHtAbGluayBQSVhJLlRpY2tlci5zeXN0ZW19LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICovXG4gICAgZ2V0IHVzZVN5c3RlbVRpY2tlcigpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlU3lzdGVtVGlja2VyO1xuICAgIH1cbiAgICBzZXQgdXNlU3lzdGVtVGlja2VyKHVzZVN5c3RlbVRpY2tlcjogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIHRoaXMuX3VzZVN5c3RlbVRpY2tlciA9IHVzZVN5c3RlbVRpY2tlcjtcblxuICAgICAgICBpZiAodXNlU3lzdGVtVGlja2VyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFkZFRpY2tlckxpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRpY2tlckxpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMYXN0IHJlbmRlcmVkIG9iamVjdCBvciB0ZW1wIG9iamVjdFxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAbWVtYmVyIHtQSVhJLkRpc3BsYXlPYmplY3R9XG4gICAgICovXG4gICAgZ2V0IGxhc3RPYmplY3RSZW5kZXJlZCgpOiBEaXNwbGF5T2JqZWN0XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5fbGFzdE9iamVjdFJlbmRlcmVkIHx8IHRoaXMuX3RlbXBEaXNwbGF5T2JqZWN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhpdCB0ZXN0cyBhIHBvaW50IGFnYWluc3QgdGhlIGRpc3BsYXkgdHJlZSwgcmV0dXJuaW5nIHRoZSBmaXJzdCBpbnRlcmFjdGl2ZSBvYmplY3QgdGhhdCBpcyBoaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUG9pbnR9IGdsb2JhbFBvaW50IC0gQSBwb2ludCB0byBoaXQgdGVzdCB3aXRoLCBpbiBnbG9iYWwgc3BhY2UuXG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcn0gW3Jvb3RdIC0gVGhlIHJvb3QgZGlzcGxheSBvYmplY3QgdG8gc3RhcnQgZnJvbS4gSWYgb21pdHRlZCwgZGVmYXVsdHNcbiAgICAgKiB0byB0aGUgbGFzdCByZW5kZXJlZCByb290IG9mIHRoZSBhc3NvY2lhdGVkIHJlbmRlcmVyLlxuICAgICAqIEByZXR1cm4ge1BJWEkuRGlzcGxheU9iamVjdH0gVGhlIGhpdCBkaXNwbGF5IG9iamVjdCwgaWYgYW55LlxuICAgICAqL1xuICAgIHB1YmxpYyBoaXRUZXN0KGdsb2JhbFBvaW50OiBQb2ludCwgcm9vdD86IERpc3BsYXlPYmplY3QpOiBEaXNwbGF5T2JqZWN0XG4gICAge1xuICAgICAgICAvLyBjbGVhciB0aGUgdGFyZ2V0IGZvciBvdXIgaGl0IHRlc3RcbiAgICAgICAgaGl0VGVzdEV2ZW50LnRhcmdldCA9IG51bGw7XG4gICAgICAgIC8vIGFzc2lnbiB0aGUgZ2xvYmFsIHBvaW50XG4gICAgICAgIGhpdFRlc3RFdmVudC5kYXRhLmdsb2JhbCA9IGdsb2JhbFBvaW50O1xuICAgICAgICAvLyBlbnN1cmUgc2FmZXR5IG9mIHRoZSByb290XG4gICAgICAgIGlmICghcm9vdClcbiAgICAgICAge1xuICAgICAgICAgICAgcm9vdCA9IHRoaXMubGFzdE9iamVjdFJlbmRlcmVkO1xuICAgICAgICB9XG4gICAgICAgIC8vIHJ1biB0aGUgaGl0IHRlc3RcbiAgICAgICAgdGhpcy5wcm9jZXNzSW50ZXJhY3RpdmUoaGl0VGVzdEV2ZW50IGFzIEludGVyYWN0aW9uRXZlbnQsIHJvb3QsIG51bGwsIHRydWUpO1xuICAgICAgICAvLyByZXR1cm4gb3VyIGZvdW5kIG9iamVjdCAtIGl0J2xsIGJlIG51bGwgaWYgd2UgZGlkbid0IGhpdCBhbnl0aGluZ1xuXG4gICAgICAgIHJldHVybiBoaXRUZXN0RXZlbnQudGFyZ2V0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIERPTSBlbGVtZW50IHdoaWNoIHdpbGwgcmVjZWl2ZSBtb3VzZS90b3VjaCBldmVudHMuIFRoaXMgaXMgdXNlZnVsIGZvciB3aGVuIHlvdSBoYXZlXG4gICAgICogb3RoZXIgRE9NIGVsZW1lbnRzIG9uIHRvcCBvZiB0aGUgcmVuZGVyZXJzIENhbnZhcyBlbGVtZW50LiBXaXRoIHRoaXMgeW91J2xsIGJlIGJhbGUgdG8gZGVsZWdhdGVcbiAgICAgKiBhbm90aGVyIERPTSBlbGVtZW50IHRvIHJlY2VpdmUgdGhvc2UgZXZlbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIHRoZSBET00gZWxlbWVudCB3aGljaCB3aWxsIHJlY2VpdmUgbW91c2UgYW5kIHRvdWNoIGV2ZW50cy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb249MV0gLSBUaGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiB0aGUgbmV3IGVsZW1lbnQgKHJlbGF0aXZlIHRvIHRoZSBjYW52YXMpLlxuICAgICAqL1xuICAgIHB1YmxpYyBzZXRUYXJnZXRFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50LCByZXNvbHV0aW9uID0gMSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMucmVtb3ZlVGlja2VyTGlzdGVuZXIoKTtcblxuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50cygpO1xuXG4gICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50ID0gZWxlbWVudDtcblxuICAgICAgICB0aGlzLnJlc29sdXRpb24gPSByZXNvbHV0aW9uO1xuXG4gICAgICAgIHRoaXMuYWRkRXZlbnRzKCk7XG5cbiAgICAgICAgdGhpcy5hZGRUaWNrZXJMaXN0ZW5lcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCB0aGUgdGlja2VyIGxpc3RlbmVyXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYWRkVGlja2VyTGlzdGVuZXIoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMudGlja2VyQWRkZWQgfHwgIXRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50IHx8ICF0aGlzLl91c2VTeXN0ZW1UaWNrZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIFRpY2tlci5zeXN0ZW0uYWRkKHRoaXMudGlja2VyVXBkYXRlLCB0aGlzLCBVUERBVEVfUFJJT1JJVFkuSU5URVJBQ1RJT04pO1xuXG4gICAgICAgIHRoaXMudGlja2VyQWRkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgdGlja2VyIGxpc3RlbmVyXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVtb3ZlVGlja2VyTGlzdGVuZXIoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnRpY2tlckFkZGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBUaWNrZXIuc3lzdGVtLnJlbW92ZSh0aGlzLnRpY2tlclVwZGF0ZSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy50aWNrZXJBZGRlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhbGwgdGhlIERPTSBldmVudHNcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRFdmVudHMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuZXZlbnRzQWRkZWQgfHwgIXRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnN0eWxlIGFzIENyb3NzQ1NTU3R5bGVEZWNsYXJhdGlvbjtcblxuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBzdHlsZS5tc0NvbnRlbnRab29taW5nID0gJ25vbmUnO1xuICAgICAgICAgICAgc3R5bGUubXNUb3VjaEFjdGlvbiA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnN1cHBvcnRzUG9pbnRlckV2ZW50cylcbiAgICAgICAge1xuICAgICAgICAgICAgc3R5bGUudG91Y2hBY3Rpb24gPSAnbm9uZSc7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlc2UgZXZlbnRzIGFyZSBhZGRlZCBmaXJzdCwgc28gdGhhdCBpZiBwb2ludGVyIGV2ZW50cyBhcmUgbm9ybWFsaXplZCwgdGhleSBhcmUgZmlyZWRcbiAgICAgICAgICogaW4gdGhlIHNhbWUgb3JkZXIgYXMgbm9uLW5vcm1hbGl6ZWQgZXZlbnRzLiBpZS4gcG9pbnRlciBldmVudCAxc3QsIG1vdXNlIC8gdG91Y2ggMm5kXG4gICAgICAgICAqL1xuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1BvaW50ZXJFdmVudHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMub25Qb2ludGVyTW92ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIHRoaXMub25Qb2ludGVyRG93biwgdHJ1ZSk7XG4gICAgICAgICAgICAvLyBwb2ludGVyb3V0IGlzIGZpcmVkIGluIGFkZGl0aW9uIHRvIHBvaW50ZXJ1cCAoZm9yIHRvdWNoIGV2ZW50cykgYW5kIHBvaW50ZXJjYW5jZWxcbiAgICAgICAgICAgIC8vIHdlIGFscmVhZHkgaGFuZGxlIHRob3NlLCBzbyBmb3IgdGhlIHB1cnBvc2VzIG9mIHdoYXQgd2UgZG8gaW4gb25Qb2ludGVyT3V0LCB3ZSBvbmx5XG4gICAgICAgICAgICAvLyBjYXJlIGFib3V0IHRoZSBwb2ludGVybGVhdmUgZXZlbnRcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJsZWF2ZScsIHRoaXMub25Qb2ludGVyT3V0LCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJvdmVyJywgdGhpcy5vblBvaW50ZXJPdmVyLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyY2FuY2VsJywgdGhpcy5vblBvaW50ZXJDYW5jZWwsIHRydWUpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIHRoaXMub25Qb2ludGVyVXAsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgd2luZG93LmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25Qb2ludGVyTW92ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uUG9pbnRlckRvd24sIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLm9uUG9pbnRlck91dCwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCB0aGlzLm9uUG9pbnRlck92ZXIsIHRydWUpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm9uUG9pbnRlclVwLCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFsd2F5cyBsb29rIGRpcmVjdGx5IGZvciB0b3VjaCBldmVudHMgc28gdGhhdCB3ZSBjYW4gcHJvdmlkZSBvcmlnaW5hbCBkYXRhXG4gICAgICAgIC8vIEluIGEgZnV0dXJlIHZlcnNpb24gd2Ugc2hvdWxkIGNoYW5nZSB0aGlzIHRvIGJlaW5nIGp1c3QgYSBmYWxsYmFjayBhbmQgcmVseSBzb2xlbHkgb25cbiAgICAgICAgLy8gUG9pbnRlckV2ZW50cyB3aGVuZXZlciBhdmFpbGFibGVcbiAgICAgICAgaWYgKHRoaXMuc3VwcG9ydHNUb3VjaEV2ZW50cylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMub25Qb2ludGVyRG93biwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGNhbmNlbCcsIHRoaXMub25Qb2ludGVyQ2FuY2VsLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5vblBvaW50ZXJVcCwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLm9uUG9pbnRlck1vdmUsIHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ldmVudHNBZGRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbGwgdGhlIERPTSBldmVudHMgdGhhdCB3ZXJlIHByZXZpb3VzbHkgcmVnaXN0ZXJlZFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbW92ZUV2ZW50cygpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzQWRkZWQgfHwgIXRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnN0eWxlIGFzIENyb3NzQ1NTU3R5bGVEZWNsYXJhdGlvbjtcblxuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBzdHlsZS5tc0NvbnRlbnRab29taW5nID0gJyc7XG4gICAgICAgICAgICBzdHlsZS5tc1RvdWNoQWN0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdXBwb3J0c1BvaW50ZXJFdmVudHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN0eWxlLnRvdWNoQWN0aW9uID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1BvaW50ZXJFdmVudHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMub25Qb2ludGVyTW92ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIHRoaXMub25Qb2ludGVyRG93biwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybGVhdmUnLCB0aGlzLm9uUG9pbnRlck91dCwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVyb3ZlcicsIHRoaXMub25Qb2ludGVyT3ZlciwgdHJ1ZSk7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcmNhbmNlbCcsIHRoaXMub25Qb2ludGVyQ2FuY2VsLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCB0aGlzLm9uUG9pbnRlclVwLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uUG9pbnRlck1vdmUsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5vblBvaW50ZXJPdXQsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5vblBvaW50ZXJPdmVyLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vblBvaW50ZXJVcCwgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1RvdWNoRXZlbnRzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5vblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgdGhpcy5vblBvaW50ZXJDYW5jZWwsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uUG9pbnRlclVwLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Qb2ludGVyTW92ZSwgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5ldmVudHNBZGRlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHN0YXRlIG9mIGludGVyYWN0aXZlIG9iamVjdHMgaWYgYXQgbGVhc3Qge0BsaW5rIGludGVyYWN0aW9uRnJlcXVlbmN5fVxuICAgICAqIG1pbGxpc2Vjb25kcyBoYXZlIHBhc3NlZCBzaW5jZSB0aGUgbGFzdCBpbnZvY2F0aW9uLlxuICAgICAqXG4gICAgICogSW52b2tlZCBieSBhIHRocm90dGxlZCB0aWNrZXIgdXBkYXRlIGZyb20ge0BsaW5rIFBJWEkuVGlja2VyLnN5c3RlbX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFUaW1lIC0gdGltZSBkZWx0YSBzaW5jZSB0aGUgbGFzdCBjYWxsXG4gICAgICovXG4gICAgcHVibGljIHRpY2tlclVwZGF0ZShkZWx0YVRpbWU6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuX2RlbHRhVGltZSArPSBkZWx0YVRpbWU7XG5cbiAgICAgICAgaWYgKHRoaXMuX2RlbHRhVGltZSA8IHRoaXMuaW50ZXJhY3Rpb25GcmVxdWVuY3kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2RlbHRhVGltZSA9IDA7XG5cbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBzdGF0ZSBvZiBpbnRlcmFjdGl2ZSBvYmplY3RzLlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIHVzZXIgbW92ZSB0aGUgbW91c2UgdGhpcyBjaGVjayBoYXMgYWxyZWFkeSBiZWVuIGRvbmUgdXNpbmcgdGhlIG1vdXNlIG1vdmUhXG4gICAgICAgIGlmICh0aGlzLl9kaWRNb3ZlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9kaWRNb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3Vyc29yID0gbnVsbDtcblxuICAgICAgICAvLyBSZXNldHMgdGhlIGZsYWcgYXMgc2V0IGJ5IGEgc3RvcFByb3BhZ2F0aW9uIGNhbGwuIFRoaXMgZmxhZyBpcyB1c3VhbGx5IHJlc2V0IGJ5IGEgdXNlciBpbnRlcmFjdGlvbiBvZiBhbnkga2luZCxcbiAgICAgICAgLy8gYnV0IHRoZXJlIHdhcyBhIHNjZW5hcmlvIG9mIGEgZGlzcGxheSBvYmplY3QgbW92aW5nIHVuZGVyIGEgc3RhdGljIG1vdXNlIGN1cnNvci5cbiAgICAgICAgLy8gSW4gdGhpcyBjYXNlLCBtb3VzZW92ZXIgYW5kIG1vdXNlZXZlbnRzIHdvdWxkIG5vdCBwYXNzIHRoZSBmbGFnIHRlc3QgaW4gZGlzcGF0Y2hFdmVudCBmdW5jdGlvblxuICAgICAgICBmb3IgKGNvbnN0IGsgaW4gdGhpcy5hY3RpdmVJbnRlcmFjdGlvbkRhdGEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUludGVyYWN0aW9uRGF0YS5oYXNPd25Qcm9wZXJ0eShrKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnRlcmFjdGlvbkRhdGEgPSB0aGlzLmFjdGl2ZUludGVyYWN0aW9uRGF0YVtrXTtcblxuICAgICAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvbkRhdGEub3JpZ2luYWxFdmVudCAmJiBpbnRlcmFjdGlvbkRhdGEucG9pbnRlclR5cGUgIT09ICd0b3VjaCcpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRlcmFjdGlvbkV2ZW50ID0gdGhpcy5jb25maWd1cmVJbnRlcmFjdGlvbkV2ZW50Rm9yRE9NRXZlbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50RGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9uRGF0YS5vcmlnaW5hbEV2ZW50IGFzIFBvaW50ZXJFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9uRGF0YVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0ludGVyYWN0aXZlKFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25FdmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdE9iamVjdFJlbmRlcmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlck92ZXJPdXQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRDdXJzb3JNb2RlKHRoaXMuY3Vyc29yKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBjdXJyZW50IGN1cnNvciBtb2RlLCBoYW5kbGluZyBhbnkgY2FsbGJhY2tzIG9yIENTUyBzdHlsZSBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUgLSBjdXJzb3IgbW9kZSwgYSBrZXkgZnJvbSB0aGUgY3Vyc29yU3R5bGVzIGRpY3Rpb25hcnlcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0Q3Vyc29yTW9kZShtb2RlOiBzdHJpbmcpOiB2b2lkXG4gICAge1xuICAgICAgICBtb2RlID0gbW9kZSB8fCAnZGVmYXVsdCc7XG4gICAgICAgIC8vIGlmIHRoZSBtb2RlIGRpZG4ndCBhY3R1YWxseSBjaGFuZ2UsIGJhaWwgZWFybHlcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEN1cnNvck1vZGUgPT09IG1vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN1cnJlbnRDdXJzb3JNb2RlID0gbW9kZTtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSB0aGlzLmN1cnNvclN0eWxlc1ttb2RlXTtcblxuICAgICAgICAvLyBvbmx5IGRvIHRoaW5ncyBpZiB0aGVyZSBpcyBhIGN1cnNvciBzdHlsZSBmb3IgaXRcbiAgICAgICAgaWYgKHN0eWxlKVxuICAgICAgICB7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiBzdHlsZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgICAgICAgICAvLyBzdHJpbmcgc3R5bGVzIGFyZSBoYW5kbGVkIGFzIGN1cnNvciBDU1NcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRPTUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgLy8gZnVuY3Rpb25zIGFyZSBqdXN0IGNhbGxlZCwgYW5kIHBhc3NlZCB0aGUgY3Vyc29yIG1vZGVcbiAgICAgICAgICAgICAgICAgICAgc3R5bGUobW9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIGFuIG9iamVjdCwgYXNzdW1lIHRoYXQgaXQgaXMgYSBkaWN0aW9uYXJ5IG9mIENTUyBzdHlsZXMsXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IGl0IHRvIHRoZSBpbnRlcmFjdGlvbkRPTUVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5zdHlsZSwgc3R5bGUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgbW9kZSA9PT0gJ3N0cmluZycgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmN1cnNvclN0eWxlcywgbW9kZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGlmIGl0IG1vZGUgaXMgYSBzdHJpbmcgKG5vdCBhIFN5bWJvbCkgYW5kIGN1cnNvclN0eWxlcyBkb2Vzbid0IGhhdmUgYW55IGVudHJ5XG4gICAgICAgICAgICAvLyBmb3IgdGhlIG1vZGUsIHRoZW4gYXNzdW1lIHRoYXQgdGhlIGRldiB3YW50cyBpdCB0byBiZSBDU1MgZm9yIHRoZSBjdXJzb3IuXG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5zdHlsZS5jdXJzb3IgPSBtb2RlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcGF0Y2hlcyBhbiBldmVudCBvbiB0aGUgZGlzcGxheSBvYmplY3QgdGhhdCB3YXMgaW50ZXJhY3RlZCB3aXRoXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ29udGFpbmVyfFBJWEkuU3ByaXRlfFBJWEkuVGlsaW5nU3ByaXRlfSBkaXNwbGF5T2JqZWN0IC0gdGhlIGRpc3BsYXkgb2JqZWN0IGluIHF1ZXN0aW9uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50U3RyaW5nIC0gdGhlIG5hbWUgb2YgdGhlIGV2ZW50IChlLmcsIG1vdXNlZG93bilcbiAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gZXZlbnREYXRhIC0gdGhlIGV2ZW50IGRhdGEgb2JqZWN0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCwgZXZlbnRTdHJpbmc6IHN0cmluZywgZXZlbnREYXRhOiBJbnRlcmFjdGlvbkV2ZW50KTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gRXZlbiBpZiB0aGUgZXZlbnQgd2FzIHN0b3BwZWQsIGF0IGxlYXN0IGRpc3BhdGNoIGFueSByZW1haW5pbmcgZXZlbnRzXG4gICAgICAgIC8vIGZvciB0aGUgc2FtZSBkaXNwbGF5IG9iamVjdC5cbiAgICAgICAgaWYgKCFldmVudERhdGEuc3RvcFByb3BhZ2F0aW9uSGludCB8fCBkaXNwbGF5T2JqZWN0ID09PSBldmVudERhdGEuc3RvcHNQcm9wYWdhdGluZ0F0KVxuICAgICAgICB7XG4gICAgICAgICAgICBldmVudERhdGEuY3VycmVudFRhcmdldCA9IGRpc3BsYXlPYmplY3Q7XG4gICAgICAgICAgICBldmVudERhdGEudHlwZSA9IGV2ZW50U3RyaW5nO1xuXG4gICAgICAgICAgICBkaXNwbGF5T2JqZWN0LmVtaXQoZXZlbnRTdHJpbmcsIGV2ZW50RGF0YSk7XG5cbiAgICAgICAgICAgIGlmICgoZGlzcGxheU9iamVjdCBhcyBhbnkpW2V2ZW50U3RyaW5nXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAoZGlzcGxheU9iamVjdCBhcyBhbnkpW2V2ZW50U3RyaW5nXShldmVudERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHV0cyBhIGV2ZW50IG9uIGEgcXVldWUgdG8gYmUgZGlzcGF0Y2hlZCBsYXRlci4gVGhpcyBpcyB1c2VkIHRvIGd1YXJhbnRlZSBjb3JyZWN0XG4gICAgICogb3JkZXJpbmcgb2Ygb3Zlci9vdXQgZXZlbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcnxQSVhJLlNwcml0ZXxQSVhJLlRpbGluZ1Nwcml0ZX0gZGlzcGxheU9iamVjdCAtIHRoZSBkaXNwbGF5IG9iamVjdCBpbiBxdWVzdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFN0cmluZyAtIHRoZSBuYW1lIG9mIHRoZSBldmVudCAoZS5nLCBtb3VzZWRvd24pXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGV2ZW50RGF0YSAtIHRoZSBldmVudCBkYXRhIG9iamVjdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBkZWxheURpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCwgZXZlbnRTdHJpbmc6IHN0cmluZywgZXZlbnREYXRhOiBJbnRlcmFjdGlvbkV2ZW50KTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5kZWxheWVkRXZlbnRzLnB1c2goeyBkaXNwbGF5T2JqZWN0LCBldmVudFN0cmluZywgZXZlbnREYXRhIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcHMgeCBhbmQgeSBjb29yZHMgZnJvbSBhIERPTSBvYmplY3QgYW5kIG1hcHMgdGhlbSBjb3JyZWN0bHkgdG8gdGhlIFBpeGlKUyB2aWV3LiBUaGVcbiAgICAgKiByZXN1bHRpbmcgdmFsdWUgaXMgc3RvcmVkIGluIHRoZSBwb2ludC4gVGhpcyB0YWtlcyBpbnRvIGFjY291bnQgdGhlIGZhY3QgdGhhdCB0aGUgRE9NXG4gICAgICogZWxlbWVudCBjb3VsZCBiZSBzY2FsZWQgYW5kIHBvc2l0aW9uZWQgYW55d2hlcmUgb24gdGhlIHNjcmVlbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge1BJWEkuSVBvaW50RGF0YX0gcG9pbnQgLSB0aGUgcG9pbnQgdGhhdCB0aGUgcmVzdWx0IHdpbGwgYmUgc3RvcmVkIGluXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSB4IC0gdGhlIHggY29vcmQgb2YgdGhlIHBvc2l0aW9uIHRvIG1hcFxuICAgICAqIEBwYXJhbSAge251bWJlcn0geSAtIHRoZSB5IGNvb3JkIG9mIHRoZSBwb3NpdGlvbiB0byBtYXBcbiAgICAgKi9cbiAgICBwdWJsaWMgbWFwUG9zaXRpb25Ub1BvaW50KHBvaW50OiBJUG9pbnREYXRhLCB4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCByZWN0O1xuXG4gICAgICAgIC8vIElFIDExIGZpeFxuICAgICAgICBpZiAoIXRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50LnBhcmVudEVsZW1lbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlY3QgPSB7IHg6IDAsIHk6IDAsIHdpZHRoOiAwLCBoZWlnaHQ6IDAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlY3QgPSB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc29sdXRpb25NdWx0aXBsaWVyID0gMS4wIC8gdGhpcy5yZXNvbHV0aW9uO1xuXG4gICAgICAgIHBvaW50LnggPSAoKHggLSByZWN0LmxlZnQpICogKCh0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudCBhcyBhbnkpLndpZHRoIC8gcmVjdC53aWR0aCkpICogcmVzb2x1dGlvbk11bHRpcGxpZXI7XG4gICAgICAgIHBvaW50LnkgPSAoKHkgLSByZWN0LnRvcCkgKiAoKHRoaXMuaW50ZXJhY3Rpb25ET01FbGVtZW50IGFzIGFueSkuaGVpZ2h0IC8gcmVjdC5oZWlnaHQpKSAqIHJlc29sdXRpb25NdWx0aXBsaWVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgcHJvdmlkZXMgYSBuZWF0IHdheSBvZiBjcmF3bGluZyB0aHJvdWdoIHRoZSBzY2VuZSBncmFwaCBhbmQgcnVubmluZyBhXG4gICAgICogc3BlY2lmaWVkIGZ1bmN0aW9uIG9uIGFsbCBpbnRlcmFjdGl2ZSBvYmplY3RzIGl0IGZpbmRzLiBJdCB3aWxsIGFsc28gdGFrZSBjYXJlIG9mIGhpdFxuICAgICAqIHRlc3RpbmcgdGhlIGludGVyYWN0aXZlIG9iamVjdHMgYW5kIHBhc3NlcyB0aGUgaGl0IGFjcm9zcyBpbiB0aGUgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGludGVyYWN0aW9uRXZlbnQgLSBldmVudCBjb250YWluaW5nIHRoZSBwb2ludCB0aGF0XG4gICAgICogIGlzIHRlc3RlZCBmb3IgY29sbGlzaW9uXG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcnxQSVhJLlNwcml0ZXxQSVhJLlRpbGluZ1Nwcml0ZX0gZGlzcGxheU9iamVjdCAtIHRoZSBkaXNwbGF5T2JqZWN0XG4gICAgICogIHRoYXQgd2lsbCBiZSBoaXQgdGVzdCAocmVjdXJzaXZlbHkgY3Jhd2xzIGl0cyBjaGlsZHJlbilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZnVuY10gLSB0aGUgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbiBlYWNoIGludGVyYWN0aXZlIG9iamVjdC4gVGhlXG4gICAgICogIGludGVyYWN0aW9uRXZlbnQsIGRpc3BsYXlPYmplY3QgYW5kIGhpdCB3aWxsIGJlIHBhc3NlZCB0byB0aGUgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtoaXRUZXN0XSAtIGluZGljYXRlcyB3aGV0aGVyIHdlIHdhbnQgdG8gY2FsY3VsYXRlIGhpdHNcbiAgICAgKiAgb3IganVzdCBpdGVyYXRlIHRocm91Z2ggYWxsIGludGVyYWN0aXZlIG9iamVjdHNcbiAgICAgKi9cbiAgICBwdWJsaWMgcHJvY2Vzc0ludGVyYWN0aXZlKGludGVyYWN0aW9uRXZlbnQ6IEludGVyYWN0aW9uRXZlbnQsIGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3QsXG4gICAgICAgIGZ1bmM/OiBJbnRlcmFjdGlvbkNhbGxiYWNrLCBoaXRUZXN0PzogYm9vbGVhblxuICAgICk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGhpdCA9IHRoaXMuc2VhcmNoLmZpbmRIaXQoaW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdCwgZnVuYywgaGl0VGVzdCk7XG5cbiAgICAgICAgY29uc3QgZGVsYXllZEV2ZW50cyA9IHRoaXMuZGVsYXllZEV2ZW50cztcblxuICAgICAgICBpZiAoIWRlbGF5ZWRFdmVudHMubGVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gaGl0O1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlc2V0IHRoZSBwcm9wYWdhdGlvbiBoaW50LCBiZWNhdXNlIHdlIHN0YXJ0IGRlZXBlciBpbiB0aGUgdHJlZSBhZ2Fpbi5cbiAgICAgICAgaW50ZXJhY3Rpb25FdmVudC5zdG9wUHJvcGFnYXRpb25IaW50ID0gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgZGVsYXllZExlbiA9IGRlbGF5ZWRFdmVudHMubGVuZ3RoO1xuXG4gICAgICAgIHRoaXMuZGVsYXllZEV2ZW50cyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVsYXllZExlbjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB7IGRpc3BsYXlPYmplY3QsIGV2ZW50U3RyaW5nLCBldmVudERhdGEgfSA9IGRlbGF5ZWRFdmVudHNbaV07XG5cbiAgICAgICAgICAgIC8vIFdoZW4gd2UgcmVhY2ggdGhlIG9iamVjdCB3ZSB3YW50ZWQgdG8gc3RvcCBwcm9wYWdhdGluZyBhdCxcbiAgICAgICAgICAgIC8vIHNldCB0aGUgcHJvcGFnYXRpb24gaGludC5cbiAgICAgICAgICAgIGlmIChldmVudERhdGEuc3RvcHNQcm9wYWdhdGluZ0F0ID09PSBkaXNwbGF5T2JqZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGV2ZW50RGF0YS5zdG9wUHJvcGFnYXRpb25IaW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsIGV2ZW50U3RyaW5nLCBldmVudERhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGhpdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJcyBjYWxsZWQgd2hlbiB0aGUgcG9pbnRlciBidXR0b24gaXMgcHJlc3NlZCBkb3duIG9uIHRoZSByZW5kZXJlciBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UG9pbnRlckV2ZW50fSBvcmlnaW5hbEV2ZW50IC0gVGhlIERPTSBldmVudCBvZiBhIHBvaW50ZXIgYnV0dG9uIGJlaW5nIHByZXNzZWQgZG93blxuICAgICAqL1xuICAgIHByaXZhdGUgb25Qb2ludGVyRG93bihvcmlnaW5hbEV2ZW50OiBJbnRlcmFjdGl2ZVBvaW50ZXJFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIGlmIHdlIHN1cHBvcnQgdG91Y2ggZXZlbnRzLCB0aGVuIG9ubHkgdXNlIHRob3NlIGZvciB0b3VjaCBldmVudHMsIG5vdCBwb2ludGVyIGV2ZW50c1xuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1RvdWNoRXZlbnRzICYmIChvcmlnaW5hbEV2ZW50IGFzIFBvaW50ZXJFdmVudCkucG9pbnRlclR5cGUgPT09ICd0b3VjaCcpIHJldHVybjtcblxuICAgICAgICBjb25zdCBldmVudHMgPSB0aGlzLm5vcm1hbGl6ZVRvUG9pbnRlckRhdGEob3JpZ2luYWxFdmVudCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5vIG5lZWQgdG8gcHJldmVudCBkZWZhdWx0IG9uIG5hdHVyYWwgcG9pbnRlciBldmVudHMsIGFzIHRoZXJlIGFyZSBubyBzaWRlIGVmZmVjdHNcbiAgICAgICAgICogTm9ybWFsaXplZCBldmVudHMsIGhvd2V2ZXIsIG1heSBoYXZlIHRoZSBkb3VibGUgbW91c2Vkb3duL3RvdWNoc3RhcnQgaXNzdWUgb24gdGhlIG5hdGl2ZSBhbmRyb2lkIGJyb3dzZXIsXG4gICAgICAgICAqIHNvIHN0aWxsIG5lZWQgdG8gYmUgcHJldmVudGVkLlxuICAgICAgICAgKi9cblxuICAgICAgICAvLyBHdWFyYW50ZWVkIHRoYXQgdGhlcmUgd2lsbCBiZSBhdCBsZWFzdCBvbmUgZXZlbnQgaW4gZXZlbnRzLCBhbmQgYWxsIGV2ZW50cyBtdXN0IGhhdmUgdGhlIHNhbWUgcG9pbnRlciB0eXBlXG5cbiAgICAgICAgaWYgKHRoaXMuYXV0b1ByZXZlbnREZWZhdWx0ICYmIChldmVudHNbMF0gYXMgYW55KS5pc05vcm1hbGl6ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbmNlbGFibGUgPSBvcmlnaW5hbEV2ZW50LmNhbmNlbGFibGUgfHwgISgnY2FuY2VsYWJsZScgaW4gb3JpZ2luYWxFdmVudCk7XG5cbiAgICAgICAgICAgIGlmIChjYW5jZWxhYmxlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGV2ZW50TGVuID0gZXZlbnRzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50TGVuOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzW2ldO1xuXG4gICAgICAgICAgICBjb25zdCBpbnRlcmFjdGlvbkRhdGEgPSB0aGlzLmdldEludGVyYWN0aW9uRGF0YUZvclBvaW50ZXJJZChldmVudCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGludGVyYWN0aW9uRXZlbnQgPSB0aGlzLmNvbmZpZ3VyZUludGVyYWN0aW9uRXZlbnRGb3JET01FdmVudCh0aGlzLmV2ZW50RGF0YSwgZXZlbnQsIGludGVyYWN0aW9uRGF0YSk7XG5cbiAgICAgICAgICAgIGludGVyYWN0aW9uRXZlbnQuZGF0YS5vcmlnaW5hbEV2ZW50ID0gb3JpZ2luYWxFdmVudDtcblxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzSW50ZXJhY3RpdmUoaW50ZXJhY3Rpb25FdmVudCwgdGhpcy5sYXN0T2JqZWN0UmVuZGVyZWQsIHRoaXMucHJvY2Vzc1BvaW50ZXJEb3duLCB0cnVlKTtcblxuICAgICAgICAgICAgdGhpcy5lbWl0KCdwb2ludGVyZG93bicsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAndG91Y2gnKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgndG91Y2hzdGFydCcsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZW1pdCBhIG1vdXNlIGV2ZW50IGZvciBcInBlblwiIHBvaW50ZXJzLCB0aGUgd2F5IGEgYnJvd3NlciB3b3VsZCBlbWl0IGEgZmFsbGJhY2sgZXZlbnRcbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAnbW91c2UnIHx8IGV2ZW50LnBvaW50ZXJUeXBlID09PSAncGVuJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1JpZ2h0QnV0dG9uID0gZXZlbnQuYnV0dG9uID09PSAyO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0KGlzUmlnaHRCdXR0b24gPyAncmlnaHRkb3duJyA6ICdtb3VzZWRvd24nLCB0aGlzLmV2ZW50RGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzZXMgdGhlIHJlc3VsdCBvZiB0aGUgcG9pbnRlciBkb3duIGNoZWNrIGFuZCBkaXNwYXRjaGVzIHRoZSBldmVudCBpZiBuZWVkIGJlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBpbnRlcmFjdGlvbkV2ZW50IC0gVGhlIGludGVyYWN0aW9uIGV2ZW50IHdyYXBwaW5nIHRoZSBET00gZXZlbnRcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ29udGFpbmVyfFBJWEkuU3ByaXRlfFBJWEkuVGlsaW5nU3ByaXRlfSBkaXNwbGF5T2JqZWN0IC0gVGhlIGRpc3BsYXkgb2JqZWN0IHRoYXQgd2FzIHRlc3RlZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaGl0IC0gdGhlIHJlc3VsdCBvZiB0aGUgaGl0IHRlc3Qgb24gdGhlIGRpc3BsYXkgb2JqZWN0XG4gICAgICovXG4gICAgcHJpdmF0ZSBwcm9jZXNzUG9pbnRlckRvd24oaW50ZXJhY3Rpb25FdmVudDogSW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCwgaGl0OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGludGVyYWN0aW9uRXZlbnQuZGF0YTtcbiAgICAgICAgY29uc3QgaWQgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGEuaWRlbnRpZmllcjtcblxuICAgICAgICBpZiAoaGl0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWRpc3BsYXlPYmplY3QudHJhY2tlZFBvaW50ZXJzW2lkXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5T2JqZWN0LnRyYWNrZWRQb2ludGVyc1tpZF0gPSBuZXcgSW50ZXJhY3Rpb25UcmFja2luZ0RhdGEoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICdwb2ludGVyZG93bicsIGludGVyYWN0aW9uRXZlbnQpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5wb2ludGVyVHlwZSA9PT0gJ3RvdWNoJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3RvdWNoc3RhcnQnLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEucG9pbnRlclR5cGUgPT09ICdtb3VzZScgfHwgZGF0YS5wb2ludGVyVHlwZSA9PT0gJ3BlbicpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNSaWdodEJ1dHRvbiA9IGRhdGEuYnV0dG9uID09PSAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzUmlnaHRCdXR0b24pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5T2JqZWN0LnRyYWNrZWRQb2ludGVyc1tpZF0ucmlnaHREb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC50cmFja2VkUG9pbnRlcnNbaWRdLmxlZnREb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgaXNSaWdodEJ1dHRvbiA/ICdyaWdodGRvd24nIDogJ21vdXNlZG93bicsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXMgY2FsbGVkIHdoZW4gdGhlIHBvaW50ZXIgYnV0dG9uIGlzIHJlbGVhc2VkIG9uIHRoZSByZW5kZXJlciBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UG9pbnRlckV2ZW50fSBvcmlnaW5hbEV2ZW50IC0gVGhlIERPTSBldmVudCBvZiBhIHBvaW50ZXIgYnV0dG9uIGJlaW5nIHJlbGVhc2VkXG4gICAgICogQHBhcmFtIHtib29sZWFufSBjYW5jZWxsZWQgLSB0cnVlIGlmIHRoZSBwb2ludGVyIGlzIGNhbmNlbGxlZFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgLSBGdW5jdGlvbiBwYXNzZWQgdG8ge0BsaW5rIHByb2Nlc3NJbnRlcmFjdGl2ZX1cbiAgICAgKi9cbiAgICBwcml2YXRlIG9uUG9pbnRlckNvbXBsZXRlKG9yaWdpbmFsRXZlbnQ6IEludGVyYWN0aXZlUG9pbnRlckV2ZW50LCBjYW5jZWxsZWQ6IGJvb2xlYW4sIGZ1bmM6IEludGVyYWN0aW9uQ2FsbGJhY2spOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBldmVudHMgPSB0aGlzLm5vcm1hbGl6ZVRvUG9pbnRlckRhdGEob3JpZ2luYWxFdmVudCk7XG5cbiAgICAgICAgY29uc3QgZXZlbnRMZW4gPSBldmVudHMubGVuZ3RoO1xuXG4gICAgICAgIC8vIGlmIHRoZSBldmVudCB3YXNuJ3QgdGFyZ2V0aW5nIG91ciBjYW52YXMsIHRoZW4gY29uc2lkZXIgaXQgdG8gYmUgcG9pbnRlcnVwb3V0c2lkZVxuICAgICAgICAvLyBpbiBhbGwgY2FzZXMgKHVubGVzcyBpdCB3YXMgYSBwb2ludGVyY2FuY2VsKVxuICAgICAgICBjb25zdCBldmVudEFwcGVuZCA9IG9yaWdpbmFsRXZlbnQudGFyZ2V0ICE9PSB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudCA/ICdvdXRzaWRlJyA6ICcnO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRMZW47IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBldmVudHNbaV07XG5cbiAgICAgICAgICAgIGNvbnN0IGludGVyYWN0aW9uRGF0YSA9IHRoaXMuZ2V0SW50ZXJhY3Rpb25EYXRhRm9yUG9pbnRlcklkKGV2ZW50KTtcblxuICAgICAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25FdmVudCA9IHRoaXMuY29uZmlndXJlSW50ZXJhY3Rpb25FdmVudEZvckRPTUV2ZW50KHRoaXMuZXZlbnREYXRhLCBldmVudCwgaW50ZXJhY3Rpb25EYXRhKTtcblxuICAgICAgICAgICAgaW50ZXJhY3Rpb25FdmVudC5kYXRhLm9yaWdpbmFsRXZlbnQgPSBvcmlnaW5hbEV2ZW50O1xuXG4gICAgICAgICAgICAvLyBwZXJmb3JtIGhpdCB0ZXN0aW5nIGZvciBldmVudHMgdGFyZ2V0aW5nIG91ciBjYW52YXMgb3IgY2FuY2VsIGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzSW50ZXJhY3RpdmUoaW50ZXJhY3Rpb25FdmVudCwgdGhpcy5sYXN0T2JqZWN0UmVuZGVyZWQsIGZ1bmMsIGNhbmNlbGxlZCB8fCAhZXZlbnRBcHBlbmQpO1xuXG4gICAgICAgICAgICB0aGlzLmVtaXQoY2FuY2VsbGVkID8gJ3BvaW50ZXJjYW5jZWwnIDogYHBvaW50ZXJ1cCR7ZXZlbnRBcHBlbmR9YCwgaW50ZXJhY3Rpb25FdmVudCk7XG5cbiAgICAgICAgICAgIGlmIChldmVudC5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJyB8fCBldmVudC5wb2ludGVyVHlwZSA9PT0gJ3BlbicpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNSaWdodEJ1dHRvbiA9IGV2ZW50LmJ1dHRvbiA9PT0gMjtcblxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdChpc1JpZ2h0QnV0dG9uID8gYHJpZ2h0dXAke2V2ZW50QXBwZW5kfWAgOiBgbW91c2V1cCR7ZXZlbnRBcHBlbmR9YCwgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChldmVudC5wb2ludGVyVHlwZSA9PT0gJ3RvdWNoJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoY2FuY2VsbGVkID8gJ3RvdWNoY2FuY2VsJyA6IGB0b3VjaGVuZCR7ZXZlbnRBcHBlbmR9YCwgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWxlYXNlSW50ZXJhY3Rpb25EYXRhRm9yUG9pbnRlcklkKGV2ZW50LnBvaW50ZXJJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJcyBjYWxsZWQgd2hlbiB0aGUgcG9pbnRlciBidXR0b24gaXMgY2FuY2VsbGVkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UG9pbnRlckV2ZW50fSBldmVudCAtIFRoZSBET00gZXZlbnQgb2YgYSBwb2ludGVyIGJ1dHRvbiBiZWluZyByZWxlYXNlZFxuICAgICAqL1xuICAgIHByaXZhdGUgb25Qb2ludGVyQ2FuY2VsKGV2ZW50OiBJbnRlcmFjdGl2ZVBvaW50ZXJFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIGlmIHdlIHN1cHBvcnQgdG91Y2ggZXZlbnRzLCB0aGVuIG9ubHkgdXNlIHRob3NlIGZvciB0b3VjaCBldmVudHMsIG5vdCBwb2ludGVyIGV2ZW50c1xuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1RvdWNoRXZlbnRzICYmIChldmVudCBhcyBQb2ludGVyRXZlbnQpLnBvaW50ZXJUeXBlID09PSAndG91Y2gnKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5vblBvaW50ZXJDb21wbGV0ZShldmVudCwgdHJ1ZSwgdGhpcy5wcm9jZXNzUG9pbnRlckNhbmNlbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2Vzc2VzIHRoZSByZXN1bHQgb2YgdGhlIHBvaW50ZXIgY2FuY2VsIGNoZWNrIGFuZCBkaXNwYXRjaGVzIHRoZSBldmVudCBpZiBuZWVkIGJlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBpbnRlcmFjdGlvbkV2ZW50IC0gVGhlIGludGVyYWN0aW9uIGV2ZW50IHdyYXBwaW5nIHRoZSBET00gZXZlbnRcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ29udGFpbmVyfFBJWEkuU3ByaXRlfFBJWEkuVGlsaW5nU3ByaXRlfSBkaXNwbGF5T2JqZWN0IC0gVGhlIGRpc3BsYXkgb2JqZWN0IHRoYXQgd2FzIHRlc3RlZFxuICAgICAqL1xuICAgIHByaXZhdGUgcHJvY2Vzc1BvaW50ZXJDYW5jZWwoaW50ZXJhY3Rpb25FdmVudDogSW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGE7XG5cbiAgICAgICAgY29uc3QgaWQgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGEuaWRlbnRpZmllcjtcblxuICAgICAgICBpZiAoZGlzcGxheU9iamVjdC50cmFja2VkUG9pbnRlcnNbaWRdICE9PSB1bmRlZmluZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlbGV0ZSBkaXNwbGF5T2JqZWN0LnRyYWNrZWRQb2ludGVyc1tpZF07XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3BvaW50ZXJjYW5jZWwnLCBpbnRlcmFjdGlvbkV2ZW50KTtcblxuICAgICAgICAgICAgaWYgKGRhdGEucG9pbnRlclR5cGUgPT09ICd0b3VjaCcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICd0b3VjaGNhbmNlbCcsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXMgY2FsbGVkIHdoZW4gdGhlIHBvaW50ZXIgYnV0dG9uIGlzIHJlbGVhc2VkIG9uIHRoZSByZW5kZXJlciBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UG9pbnRlckV2ZW50fSBldmVudCAtIFRoZSBET00gZXZlbnQgb2YgYSBwb2ludGVyIGJ1dHRvbiBiZWluZyByZWxlYXNlZFxuICAgICAqL1xuICAgIHByaXZhdGUgb25Qb2ludGVyVXAoZXZlbnQ6IEludGVyYWN0aXZlUG9pbnRlckV2ZW50KTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gaWYgd2Ugc3VwcG9ydCB0b3VjaCBldmVudHMsIHRoZW4gb25seSB1c2UgdGhvc2UgZm9yIHRvdWNoIGV2ZW50cywgbm90IHBvaW50ZXIgZXZlbnRzXG4gICAgICAgIGlmICh0aGlzLnN1cHBvcnRzVG91Y2hFdmVudHMgJiYgKGV2ZW50IGFzIFBvaW50ZXJFdmVudCkucG9pbnRlclR5cGUgPT09ICd0b3VjaCcpIHJldHVybjtcblxuICAgICAgICB0aGlzLm9uUG9pbnRlckNvbXBsZXRlKGV2ZW50LCBmYWxzZSwgdGhpcy5wcm9jZXNzUG9pbnRlclVwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzZXMgdGhlIHJlc3VsdCBvZiB0aGUgcG9pbnRlciB1cCBjaGVjayBhbmQgZGlzcGF0Y2hlcyB0aGUgZXZlbnQgaWYgbmVlZCBiZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gaW50ZXJhY3Rpb25FdmVudCAtIFRoZSBpbnRlcmFjdGlvbiBldmVudCB3cmFwcGluZyB0aGUgRE9NIGV2ZW50XG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcnxQSVhJLlNwcml0ZXxQSVhJLlRpbGluZ1Nwcml0ZX0gZGlzcGxheU9iamVjdCAtIFRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IHdhcyB0ZXN0ZWRcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGhpdCAtIHRoZSByZXN1bHQgb2YgdGhlIGhpdCB0ZXN0IG9uIHRoZSBkaXNwbGF5IG9iamVjdFxuICAgICAqL1xuICAgIHByaXZhdGUgcHJvY2Vzc1BvaW50ZXJVcChpbnRlcmFjdGlvbkV2ZW50OiBJbnRlcmFjdGlvbkV2ZW50LCBkaXNwbGF5T2JqZWN0OiBEaXNwbGF5T2JqZWN0LCBoaXQ6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBkYXRhID0gaW50ZXJhY3Rpb25FdmVudC5kYXRhO1xuXG4gICAgICAgIGNvbnN0IGlkID0gaW50ZXJhY3Rpb25FdmVudC5kYXRhLmlkZW50aWZpZXI7XG5cbiAgICAgICAgY29uc3QgdHJhY2tpbmdEYXRhID0gZGlzcGxheU9iamVjdC50cmFja2VkUG9pbnRlcnNbaWRdO1xuXG4gICAgICAgIGNvbnN0IGlzVG91Y2ggPSBkYXRhLnBvaW50ZXJUeXBlID09PSAndG91Y2gnO1xuXG4gICAgICAgIGNvbnN0IGlzTW91c2UgPSAoZGF0YS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJyB8fCBkYXRhLnBvaW50ZXJUeXBlID09PSAncGVuJyk7XG4gICAgICAgIC8vIG5lZWQgdG8gdHJhY2sgbW91c2UgZG93biBzdGF0dXMgaW4gdGhlIG1vdXNlIGJsb2NrIHNvIHRoYXQgd2UgY2FuIGVtaXRcbiAgICAgICAgLy8gZXZlbnQgaW4gYSBsYXRlciBibG9ja1xuICAgICAgICBsZXQgaXNNb3VzZVRhcCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIE1vdXNlIG9ubHlcbiAgICAgICAgaWYgKGlzTW91c2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGlzUmlnaHRCdXR0b24gPSBkYXRhLmJ1dHRvbiA9PT0gMjtcblxuICAgICAgICAgICAgY29uc3QgZmxhZ3MgPSBJbnRlcmFjdGlvblRyYWNraW5nRGF0YS5GTEFHUztcblxuICAgICAgICAgICAgY29uc3QgdGVzdCA9IGlzUmlnaHRCdXR0b24gPyBmbGFncy5SSUdIVF9ET1dOIDogZmxhZ3MuTEVGVF9ET1dOO1xuXG4gICAgICAgICAgICBjb25zdCBpc0Rvd24gPSB0cmFja2luZ0RhdGEgIT09IHVuZGVmaW5lZCAmJiAodHJhY2tpbmdEYXRhLmZsYWdzICYgdGVzdCk7XG5cbiAgICAgICAgICAgIGlmIChoaXQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsIGlzUmlnaHRCdXR0b24gPyAncmlnaHR1cCcgOiAnbW91c2V1cCcsIGludGVyYWN0aW9uRXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRG93bilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChkaXNwbGF5T2JqZWN0LCBpc1JpZ2h0QnV0dG9uID8gJ3JpZ2h0Y2xpY2snIDogJ2NsaWNrJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGJlY2F1c2Ugd2UgY2FuIGNvbmZpcm0gdGhhdCB0aGUgbW91c2Vkb3duIGhhcHBlbmVkIG9uIHRoaXMgb2JqZWN0LCBmbGFnIGZvciBsYXRlciBlbWl0IG9mIHBvaW50ZXJ0YXBcbiAgICAgICAgICAgICAgICAgICAgaXNNb3VzZVRhcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEb3duKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChkaXNwbGF5T2JqZWN0LCBpc1JpZ2h0QnV0dG9uID8gJ3JpZ2h0dXBvdXRzaWRlJyA6ICdtb3VzZXVwb3V0c2lkZScsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdXBkYXRlIHRoZSBkb3duIHN0YXRlIG9mIHRoZSB0cmFja2luZyBkYXRhXG4gICAgICAgICAgICBpZiAodHJhY2tpbmdEYXRhKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChpc1JpZ2h0QnV0dG9uKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tpbmdEYXRhLnJpZ2h0RG93biA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0cmFja2luZ0RhdGEubGVmdERvd24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQb2ludGVycyBhbmQgVG91Y2hlcywgYW5kIE1vdXNlXG4gICAgICAgIGlmIChoaXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChkaXNwbGF5T2JqZWN0LCAncG9pbnRlcnVwJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICBpZiAoaXNUb3VjaCkgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICd0b3VjaGVuZCcsIGludGVyYWN0aW9uRXZlbnQpO1xuXG4gICAgICAgICAgICBpZiAodHJhY2tpbmdEYXRhKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGVtaXQgcG9pbnRlcnRhcCBpZiBub3QgYSBtb3VzZSwgb3IgaWYgdGhlIG1vdXNlIGJsb2NrIGRlY2lkZWQgaXQgd2FzIGEgdGFwXG4gICAgICAgICAgICAgICAgaWYgKCFpc01vdXNlIHx8IGlzTW91c2VUYXApXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3BvaW50ZXJ0YXAnLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzVG91Y2gpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3RhcCcsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAvLyB0b3VjaGVzIGFyZSBubyBsb25nZXIgb3ZlciAoaWYgdGhleSBldmVyIHdlcmUpIHdoZW4gd2UgZ2V0IHRoZSB0b3VjaGVuZFxuICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBzaG91bGQgZW5zdXJlIHRoYXQgd2UgZG9uJ3Qga2VlcCBwcmV0ZW5kaW5nIHRoYXQgdGhleSBhcmVcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tpbmdEYXRhLm92ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHJhY2tpbmdEYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3BvaW50ZXJ1cG91dHNpZGUnLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIGlmIChpc1RvdWNoKSB0aGlzLmRpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3RvdWNoZW5kb3V0c2lkZScsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE9ubHkgcmVtb3ZlIHRoZSB0cmFja2luZyBkYXRhIGlmIHRoZXJlIGlzIG5vIG92ZXIvZG93biBzdGF0ZSBzdGlsbCBhc3NvY2lhdGVkIHdpdGggaXRcbiAgICAgICAgaWYgKHRyYWNraW5nRGF0YSAmJiB0cmFja2luZ0RhdGEubm9uZSlcbiAgICAgICAge1xuICAgICAgICAgICAgZGVsZXRlIGRpc3BsYXlPYmplY3QudHJhY2tlZFBvaW50ZXJzW2lkXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElzIGNhbGxlZCB3aGVuIHRoZSBwb2ludGVyIG1vdmVzIGFjcm9zcyB0aGUgcmVuZGVyZXIgZWxlbWVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BvaW50ZXJFdmVudH0gb3JpZ2luYWxFdmVudCAtIFRoZSBET00gZXZlbnQgb2YgYSBwb2ludGVyIG1vdmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgb25Qb2ludGVyTW92ZShvcmlnaW5hbEV2ZW50OiBJbnRlcmFjdGl2ZVBvaW50ZXJFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIGlmIHdlIHN1cHBvcnQgdG91Y2ggZXZlbnRzLCB0aGVuIG9ubHkgdXNlIHRob3NlIGZvciB0b3VjaCBldmVudHMsIG5vdCBwb2ludGVyIGV2ZW50c1xuICAgICAgICBpZiAodGhpcy5zdXBwb3J0c1RvdWNoRXZlbnRzICYmIChvcmlnaW5hbEV2ZW50IGFzIFBvaW50ZXJFdmVudCkucG9pbnRlclR5cGUgPT09ICd0b3VjaCcpIHJldHVybjtcblxuICAgICAgICBjb25zdCBldmVudHMgPSB0aGlzLm5vcm1hbGl6ZVRvUG9pbnRlckRhdGEob3JpZ2luYWxFdmVudCk7XG5cbiAgICAgICAgaWYgKGV2ZW50c1swXS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJyB8fCBldmVudHNbMF0ucG9pbnRlclR5cGUgPT09ICdwZW4nKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9kaWRNb3ZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgdGhpcy5jdXJzb3IgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZXZlbnRMZW4gPSBldmVudHMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRMZW47IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBldmVudHNbaV07XG5cbiAgICAgICAgICAgIGNvbnN0IGludGVyYWN0aW9uRGF0YSA9IHRoaXMuZ2V0SW50ZXJhY3Rpb25EYXRhRm9yUG9pbnRlcklkKGV2ZW50KTtcblxuICAgICAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25FdmVudCA9IHRoaXMuY29uZmlndXJlSW50ZXJhY3Rpb25FdmVudEZvckRPTUV2ZW50KHRoaXMuZXZlbnREYXRhLCBldmVudCwgaW50ZXJhY3Rpb25EYXRhKTtcblxuICAgICAgICAgICAgaW50ZXJhY3Rpb25FdmVudC5kYXRhLm9yaWdpbmFsRXZlbnQgPSBvcmlnaW5hbEV2ZW50O1xuXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NJbnRlcmFjdGl2ZShpbnRlcmFjdGlvbkV2ZW50LCB0aGlzLmxhc3RPYmplY3RSZW5kZXJlZCwgdGhpcy5wcm9jZXNzUG9pbnRlck1vdmUsIHRydWUpO1xuXG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3BvaW50ZXJtb3ZlJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICBpZiAoZXZlbnQucG9pbnRlclR5cGUgPT09ICd0b3VjaCcpIHRoaXMuZW1pdCgndG91Y2htb3ZlJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICBpZiAoZXZlbnQucG9pbnRlclR5cGUgPT09ICdtb3VzZScgfHwgZXZlbnQucG9pbnRlclR5cGUgPT09ICdwZW4nKSB0aGlzLmVtaXQoJ21vdXNlbW92ZScsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV2ZW50c1swXS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zZXRDdXJzb3JNb2RlKHRoaXMuY3Vyc29yKTtcblxuICAgICAgICAgICAgLy8gVE9ETyBCVUcgZm9yIHBhcmVudHMgaW50ZXJhY3RpdmUgb2JqZWN0IChib3JkZXIgb3JkZXIgaXNzdWUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzZXMgdGhlIHJlc3VsdCBvZiB0aGUgcG9pbnRlciBtb3ZlIGNoZWNrIGFuZCBkaXNwYXRjaGVzIHRoZSBldmVudCBpZiBuZWVkIGJlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSBpbnRlcmFjdGlvbkV2ZW50IC0gVGhlIGludGVyYWN0aW9uIGV2ZW50IHdyYXBwaW5nIHRoZSBET00gZXZlbnRcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ29udGFpbmVyfFBJWEkuU3ByaXRlfFBJWEkuVGlsaW5nU3ByaXRlfSBkaXNwbGF5T2JqZWN0IC0gVGhlIGRpc3BsYXkgb2JqZWN0IHRoYXQgd2FzIHRlc3RlZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaGl0IC0gdGhlIHJlc3VsdCBvZiB0aGUgaGl0IHRlc3Qgb24gdGhlIGRpc3BsYXkgb2JqZWN0XG4gICAgICovXG4gICAgcHJpdmF0ZSBwcm9jZXNzUG9pbnRlck1vdmUoaW50ZXJhY3Rpb25FdmVudDogSW50ZXJhY3Rpb25FdmVudCwgZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCwgaGl0OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGludGVyYWN0aW9uRXZlbnQuZGF0YTtcblxuICAgICAgICBjb25zdCBpc1RvdWNoID0gZGF0YS5wb2ludGVyVHlwZSA9PT0gJ3RvdWNoJztcblxuICAgICAgICBjb25zdCBpc01vdXNlID0gKGRhdGEucG9pbnRlclR5cGUgPT09ICdtb3VzZScgfHwgZGF0YS5wb2ludGVyVHlwZSA9PT0gJ3BlbicpO1xuXG4gICAgICAgIGlmIChpc01vdXNlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NQb2ludGVyT3Zlck91dChpbnRlcmFjdGlvbkV2ZW50LCBkaXNwbGF5T2JqZWN0LCBoaXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLm1vdmVXaGVuSW5zaWRlIHx8IGhpdClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICdwb2ludGVybW92ZScsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgaWYgKGlzVG91Y2gpIHRoaXMuZGlzcGF0Y2hFdmVudChkaXNwbGF5T2JqZWN0LCAndG91Y2htb3ZlJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICBpZiAoaXNNb3VzZSkgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICdtb3VzZW1vdmUnLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElzIGNhbGxlZCB3aGVuIHRoZSBwb2ludGVyIGlzIG1vdmVkIG91dCBvZiB0aGUgcmVuZGVyZXIgZWxlbWVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BvaW50ZXJFdmVudH0gb3JpZ2luYWxFdmVudCAtIFRoZSBET00gZXZlbnQgb2YgYSBwb2ludGVyIGJlaW5nIG1vdmVkIG91dFxuICAgICAqL1xuICAgIHByaXZhdGUgb25Qb2ludGVyT3V0KG9yaWdpbmFsRXZlbnQ6IEludGVyYWN0aXZlUG9pbnRlckV2ZW50KTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gaWYgd2Ugc3VwcG9ydCB0b3VjaCBldmVudHMsIHRoZW4gb25seSB1c2UgdGhvc2UgZm9yIHRvdWNoIGV2ZW50cywgbm90IHBvaW50ZXIgZXZlbnRzXG4gICAgICAgIGlmICh0aGlzLnN1cHBvcnRzVG91Y2hFdmVudHMgJiYgKG9yaWdpbmFsRXZlbnQgYXMgUG9pbnRlckV2ZW50KS5wb2ludGVyVHlwZSA9PT0gJ3RvdWNoJykgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IHRoaXMubm9ybWFsaXplVG9Qb2ludGVyRGF0YShvcmlnaW5hbEV2ZW50KTtcblxuICAgICAgICAvLyBPbmx5IG1vdXNlIGFuZCBwb2ludGVyIGNhbiBjYWxsIG9uUG9pbnRlck91dCwgc28gZXZlbnRzIHdpbGwgYWx3YXlzIGJlIGxlbmd0aCAxXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzWzBdO1xuXG4gICAgICAgIGlmIChldmVudC5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5tb3VzZU92ZXJSZW5kZXJlciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zZXRDdXJzb3JNb2RlKG51bGwpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25EYXRhID0gdGhpcy5nZXRJbnRlcmFjdGlvbkRhdGFGb3JQb2ludGVySWQoZXZlbnQpO1xuXG4gICAgICAgIGNvbnN0IGludGVyYWN0aW9uRXZlbnQgPSB0aGlzLmNvbmZpZ3VyZUludGVyYWN0aW9uRXZlbnRGb3JET01FdmVudCh0aGlzLmV2ZW50RGF0YSwgZXZlbnQsIGludGVyYWN0aW9uRGF0YSk7XG5cbiAgICAgICAgaW50ZXJhY3Rpb25FdmVudC5kYXRhLm9yaWdpbmFsRXZlbnQgPSBldmVudDtcblxuICAgICAgICB0aGlzLnByb2Nlc3NJbnRlcmFjdGl2ZShpbnRlcmFjdGlvbkV2ZW50LCB0aGlzLmxhc3RPYmplY3RSZW5kZXJlZCwgdGhpcy5wcm9jZXNzUG9pbnRlck92ZXJPdXQsIGZhbHNlKTtcblxuICAgICAgICB0aGlzLmVtaXQoJ3BvaW50ZXJvdXQnLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAnbW91c2UnIHx8IGV2ZW50LnBvaW50ZXJUeXBlID09PSAncGVuJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdtb3VzZW91dCcsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gd2UgY2FuIGdldCB0b3VjaGxlYXZlIGV2ZW50cyBhZnRlciB0b3VjaGVuZCwgc28gd2Ugd2FudCB0byBtYWtlIHN1cmUgd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIGludHJvZHVjZSBtZW1vcnkgbGVha3NcbiAgICAgICAgICAgIHRoaXMucmVsZWFzZUludGVyYWN0aW9uRGF0YUZvclBvaW50ZXJJZChpbnRlcmFjdGlvbkRhdGEuaWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzZXMgdGhlIHJlc3VsdCBvZiB0aGUgcG9pbnRlciBvdmVyL291dCBjaGVjayBhbmQgZGlzcGF0Y2hlcyB0aGUgZXZlbnQgaWYgbmVlZCBiZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuSW50ZXJhY3Rpb25FdmVudH0gaW50ZXJhY3Rpb25FdmVudCAtIFRoZSBpbnRlcmFjdGlvbiBldmVudCB3cmFwcGluZyB0aGUgRE9NIGV2ZW50XG4gICAgICogQHBhcmFtIHtQSVhJLkNvbnRhaW5lcnxQSVhJLlNwcml0ZXxQSVhJLlRpbGluZ1Nwcml0ZX0gZGlzcGxheU9iamVjdCAtIFRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IHdhcyB0ZXN0ZWRcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGhpdCAtIHRoZSByZXN1bHQgb2YgdGhlIGhpdCB0ZXN0IG9uIHRoZSBkaXNwbGF5IG9iamVjdFxuICAgICAqL1xuICAgIHByaXZhdGUgcHJvY2Vzc1BvaW50ZXJPdmVyT3V0KGludGVyYWN0aW9uRXZlbnQ6IEludGVyYWN0aW9uRXZlbnQsIGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3QsIGhpdDogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGE7XG5cbiAgICAgICAgY29uc3QgaWQgPSBpbnRlcmFjdGlvbkV2ZW50LmRhdGEuaWRlbnRpZmllcjtcblxuICAgICAgICBjb25zdCBpc01vdXNlID0gKGRhdGEucG9pbnRlclR5cGUgPT09ICdtb3VzZScgfHwgZGF0YS5wb2ludGVyVHlwZSA9PT0gJ3BlbicpO1xuXG4gICAgICAgIGxldCB0cmFja2luZ0RhdGEgPSBkaXNwbGF5T2JqZWN0LnRyYWNrZWRQb2ludGVyc1tpZF07XG5cbiAgICAgICAgLy8gaWYgd2UganVzdCBtb3VzZWQgb3ZlciB0aGUgZGlzcGxheSBvYmplY3QsIHRoZW4gd2UgbmVlZCB0byB0cmFjayB0aGF0IHN0YXRlXG4gICAgICAgIGlmIChoaXQgJiYgIXRyYWNraW5nRGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgdHJhY2tpbmdEYXRhID0gZGlzcGxheU9iamVjdC50cmFja2VkUG9pbnRlcnNbaWRdID0gbmV3IEludGVyYWN0aW9uVHJhY2tpbmdEYXRhKGlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0cmFja2luZ0RhdGEgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChoaXQgJiYgdGhpcy5tb3VzZU92ZXJSZW5kZXJlcilcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0cmFja2luZ0RhdGEub3ZlcilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0cmFja2luZ0RhdGEub3ZlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxheURpc3BhdGNoRXZlbnQoZGlzcGxheU9iamVjdCwgJ3BvaW50ZXJvdmVyJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTW91c2UpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGF5RGlzcGF0Y2hFdmVudChkaXNwbGF5T2JqZWN0LCAnbW91c2VvdmVyJywgaW50ZXJhY3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBvbmx5IGNoYW5nZSB0aGUgY3Vyc29yIGlmIGl0IGhhcyBub3QgYWxyZWFkeSBiZWVuIGNoYW5nZWQgKGJ5IHNvbWV0aGluZyBkZWVwZXIgaW4gdGhlXG4gICAgICAgICAgICAvLyBkaXNwbGF5IHRyZWUpXG4gICAgICAgICAgICBpZiAoaXNNb3VzZSAmJiB0aGlzLmN1cnNvciA9PT0gbnVsbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnNvciA9IGRpc3BsYXlPYmplY3QuY3Vyc29yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRyYWNraW5nRGF0YS5vdmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0cmFja2luZ0RhdGEub3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICdwb2ludGVyb3V0JywgdGhpcy5ldmVudERhdGEpO1xuICAgICAgICAgICAgaWYgKGlzTW91c2UpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGRpc3BsYXlPYmplY3QsICdtb3VzZW91dCcsIGludGVyYWN0aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gbW91c2UgZG93biBpbmZvcm1hdGlvbiBmb3IgdGhlIHBvaW50ZXIsIHRoZW4gaXQgaXMgc2FmZSB0byBkZWxldGVcbiAgICAgICAgICAgIGlmICh0cmFja2luZ0RhdGEubm9uZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGlzcGxheU9iamVjdC50cmFja2VkUG9pbnRlcnNbaWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXMgY2FsbGVkIHdoZW4gdGhlIHBvaW50ZXIgaXMgbW92ZWQgaW50byB0aGUgcmVuZGVyZXIgZWxlbWVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BvaW50ZXJFdmVudH0gb3JpZ2luYWxFdmVudCAtIFRoZSBET00gZXZlbnQgb2YgYSBwb2ludGVyIGJ1dHRvbiBiZWluZyBtb3ZlZCBpbnRvIHRoZSByZW5kZXJlciB2aWV3XG4gICAgICovXG4gICAgcHJpdmF0ZSBvblBvaW50ZXJPdmVyKG9yaWdpbmFsRXZlbnQ6IEludGVyYWN0aXZlUG9pbnRlckV2ZW50KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZXZlbnRzID0gdGhpcy5ub3JtYWxpemVUb1BvaW50ZXJEYXRhKG9yaWdpbmFsRXZlbnQpO1xuXG4gICAgICAgIC8vIE9ubHkgbW91c2UgYW5kIHBvaW50ZXIgY2FuIGNhbGwgb25Qb2ludGVyT3Zlciwgc28gZXZlbnRzIHdpbGwgYWx3YXlzIGJlIGxlbmd0aCAxXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzWzBdO1xuXG4gICAgICAgIGNvbnN0IGludGVyYWN0aW9uRGF0YSA9IHRoaXMuZ2V0SW50ZXJhY3Rpb25EYXRhRm9yUG9pbnRlcklkKGV2ZW50KTtcblxuICAgICAgICBjb25zdCBpbnRlcmFjdGlvbkV2ZW50ID0gdGhpcy5jb25maWd1cmVJbnRlcmFjdGlvbkV2ZW50Rm9yRE9NRXZlbnQodGhpcy5ldmVudERhdGEsIGV2ZW50LCBpbnRlcmFjdGlvbkRhdGEpO1xuXG4gICAgICAgIGludGVyYWN0aW9uRXZlbnQuZGF0YS5vcmlnaW5hbEV2ZW50ID0gZXZlbnQ7XG5cbiAgICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAnbW91c2UnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm1vdXNlT3ZlclJlbmRlcmVyID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZW1pdCgncG9pbnRlcm92ZXInLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAnbW91c2UnIHx8IGV2ZW50LnBvaW50ZXJUeXBlID09PSAncGVuJylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdtb3VzZW92ZXInLCBpbnRlcmFjdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBJbnRlcmFjdGlvbkRhdGEgZm9yIGEgZ2l2ZW4gcG9pbnRlcklkLiBTdG9yZSB0aGF0IGRhdGEgYXMgd2VsbFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BvaW50ZXJFdmVudH0gZXZlbnQgLSBOb3JtYWxpemVkIHBvaW50ZXIgZXZlbnQsIG91dHB1dCBmcm9tIG5vcm1hbGl6ZVRvUG9pbnRlckRhdGFcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkludGVyYWN0aW9uRGF0YX0gLSBJbnRlcmFjdGlvbiBkYXRhIGZvciB0aGUgZ2l2ZW4gcG9pbnRlciBpZGVudGlmaWVyXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRJbnRlcmFjdGlvbkRhdGFGb3JQb2ludGVySWQoZXZlbnQ6IFBvaW50ZXJFdmVudCk6IEludGVyYWN0aW9uRGF0YVxuICAgIHtcbiAgICAgICAgY29uc3QgcG9pbnRlcklkID0gZXZlbnQucG9pbnRlcklkO1xuXG4gICAgICAgIGxldCBpbnRlcmFjdGlvbkRhdGE7XG5cbiAgICAgICAgaWYgKHBvaW50ZXJJZCA9PT0gTU9VU0VfUE9JTlRFUl9JRCB8fCBldmVudC5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJylcbiAgICAgICAge1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25EYXRhID0gdGhpcy5tb3VzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGl2ZUludGVyYWN0aW9uRGF0YVtwb2ludGVySWRdKVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnRlcmFjdGlvbkRhdGEgPSB0aGlzLmFjdGl2ZUludGVyYWN0aW9uRGF0YVtwb2ludGVySWRdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25EYXRhID0gdGhpcy5pbnRlcmFjdGlvbkRhdGFQb29sLnBvcCgpIHx8IG5ldyBJbnRlcmFjdGlvbkRhdGEoKTtcbiAgICAgICAgICAgIGludGVyYWN0aW9uRGF0YS5pZGVudGlmaWVyID0gcG9pbnRlcklkO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbnRlcmFjdGlvbkRhdGFbcG9pbnRlcklkXSA9IGludGVyYWN0aW9uRGF0YTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb3B5IHByb3BlcnRpZXMgZnJvbSB0aGUgZXZlbnQsIHNvIHRoYXQgd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IHRvdWNoL3BvaW50ZXIgc3BlY2lmaWNcbiAgICAgICAgLy8gZGF0YSBpcyBhdmFpbGFibGVcbiAgICAgICAgaW50ZXJhY3Rpb25EYXRhLmNvcHlFdmVudChldmVudCk7XG5cbiAgICAgICAgcmV0dXJuIGludGVyYWN0aW9uRGF0YTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdW51c2VkIEludGVyYWN0aW9uRGF0YSB0byB0aGUgcG9vbCwgZm9yIGEgZ2l2ZW4gcG9pbnRlcklkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwb2ludGVySWQgLSBJZGVudGlmaWVyIGZyb20gYSBwb2ludGVyIGV2ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSByZWxlYXNlSW50ZXJhY3Rpb25EYXRhRm9yUG9pbnRlcklkKHBvaW50ZXJJZDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25EYXRhID0gdGhpcy5hY3RpdmVJbnRlcmFjdGlvbkRhdGFbcG9pbnRlcklkXTtcblxuICAgICAgICBpZiAoaW50ZXJhY3Rpb25EYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5hY3RpdmVJbnRlcmFjdGlvbkRhdGFbcG9pbnRlcklkXTtcbiAgICAgICAgICAgIGludGVyYWN0aW9uRGF0YS5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbkRhdGFQb29sLnB1c2goaW50ZXJhY3Rpb25EYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZSBhbiBJbnRlcmFjdGlvbkV2ZW50IHRvIHdyYXAgYSBET00gUG9pbnRlckV2ZW50IGFuZCBJbnRlcmFjdGlvbkRhdGFcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtQSVhJLkludGVyYWN0aW9uRXZlbnR9IGludGVyYWN0aW9uRXZlbnQgLSBUaGUgZXZlbnQgdG8gYmUgY29uZmlndXJlZFxuICAgICAqIEBwYXJhbSB7UG9pbnRlckV2ZW50fSBwb2ludGVyRXZlbnQgLSBUaGUgRE9NIGV2ZW50IHRoYXQgd2lsbCBiZSBwYWlyZWQgd2l0aCB0aGUgSW50ZXJhY3Rpb25FdmVudFxuICAgICAqIEBwYXJhbSB7UElYSS5JbnRlcmFjdGlvbkRhdGF9IGludGVyYWN0aW9uRGF0YSAtIFRoZSBJbnRlcmFjdGlvbkRhdGEgdGhhdCB3aWxsIGJlIHBhaXJlZFxuICAgICAqICAgICAgICB3aXRoIHRoZSBJbnRlcmFjdGlvbkV2ZW50XG4gICAgICogQHJldHVybiB7UElYSS5JbnRlcmFjdGlvbkV2ZW50fSB0aGUgaW50ZXJhY3Rpb24gZXZlbnQgdGhhdCB3YXMgcGFzc2VkIGluXG4gICAgICovXG4gICAgcHJpdmF0ZSBjb25maWd1cmVJbnRlcmFjdGlvbkV2ZW50Rm9yRE9NRXZlbnQoaW50ZXJhY3Rpb25FdmVudDogSW50ZXJhY3Rpb25FdmVudCwgcG9pbnRlckV2ZW50OiBQb2ludGVyRXZlbnQsXG4gICAgICAgIGludGVyYWN0aW9uRGF0YTogSW50ZXJhY3Rpb25EYXRhXG4gICAgKTogSW50ZXJhY3Rpb25FdmVudFxuICAgIHtcbiAgICAgICAgaW50ZXJhY3Rpb25FdmVudC5kYXRhID0gaW50ZXJhY3Rpb25EYXRhO1xuXG4gICAgICAgIHRoaXMubWFwUG9zaXRpb25Ub1BvaW50KGludGVyYWN0aW9uRGF0YS5nbG9iYWwsIHBvaW50ZXJFdmVudC5jbGllbnRYLCBwb2ludGVyRXZlbnQuY2xpZW50WSk7XG5cbiAgICAgICAgLy8gTm90IHJlYWxseSBzdXJlIHdoeSB0aGlzIGlzIGhhcHBlbmluZywgYnV0IGl0J3MgaG93IGEgcHJldmlvdXMgdmVyc2lvbiBoYW5kbGVkIHRoaW5nc1xuICAgICAgICBpZiAocG9pbnRlckV2ZW50LnBvaW50ZXJUeXBlID09PSAndG91Y2gnKVxuICAgICAgICB7XG4gICAgICAgICAgICAocG9pbnRlckV2ZW50IGFzIGFueSkuZ2xvYmFsWCA9IGludGVyYWN0aW9uRGF0YS5nbG9iYWwueDtcbiAgICAgICAgICAgIChwb2ludGVyRXZlbnQgYXMgYW55KS5nbG9iYWxZID0gaW50ZXJhY3Rpb25EYXRhLmdsb2JhbC55O1xuICAgICAgICB9XG5cbiAgICAgICAgaW50ZXJhY3Rpb25EYXRhLm9yaWdpbmFsRXZlbnQgPSBwb2ludGVyRXZlbnQ7XG4gICAgICAgIGludGVyYWN0aW9uRXZlbnQucmVzZXQoKTtcblxuICAgICAgICByZXR1cm4gaW50ZXJhY3Rpb25FdmVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbnN1cmVzIHRoYXQgdGhlIG9yaWdpbmFsIGV2ZW50IG9iamVjdCBjb250YWlucyBhbGwgZGF0YSB0aGF0IGEgcmVndWxhciBwb2ludGVyIGV2ZW50IHdvdWxkIGhhdmVcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtUb3VjaEV2ZW50fE1vdXNlRXZlbnR8UG9pbnRlckV2ZW50fSBldmVudCAtIFRoZSBvcmlnaW5hbCBldmVudCBkYXRhIGZyb20gYSB0b3VjaCBvciBtb3VzZSBldmVudFxuICAgICAqIEByZXR1cm4ge1BvaW50ZXJFdmVudFtdfSBBbiBhcnJheSBjb250YWluaW5nIGEgc2luZ2xlIG5vcm1hbGl6ZWQgcG9pbnRlciBldmVudCwgaW4gdGhlIGNhc2Ugb2YgYSBwb2ludGVyXG4gICAgICogIG9yIG1vdXNlIGV2ZW50LCBvciBhIG11bHRpcGxlIG5vcm1hbGl6ZWQgcG9pbnRlciBldmVudHMgaWYgdGhlcmUgYXJlIG11bHRpcGxlIGNoYW5nZWQgdG91Y2hlc1xuICAgICAqL1xuICAgIHByaXZhdGUgbm9ybWFsaXplVG9Qb2ludGVyRGF0YShldmVudDogSW50ZXJhY3RpdmVQb2ludGVyRXZlbnQpOiBQb2ludGVyRXZlbnRbXVxuICAgIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZEV2ZW50cyA9IFtdO1xuXG4gICAgICAgIGlmICh0aGlzLnN1cHBvcnRzVG91Y2hFdmVudHMgJiYgZXZlbnQgaW5zdGFuY2VvZiBUb3VjaEV2ZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGkgPSBldmVudC5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkgPCBsaTsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbaV0gYXMgUGl4aVRvdWNoO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3VjaC5idXR0b24gPT09ICd1bmRlZmluZWQnKSB0b3VjaC5idXR0b24gPSBldmVudC50b3VjaGVzLmxlbmd0aCA/IDEgOiAwO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2guYnV0dG9ucyA9PT0gJ3VuZGVmaW5lZCcpIHRvdWNoLmJ1dHRvbnMgPSBldmVudC50b3VjaGVzLmxlbmd0aCA/IDEgOiAwO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2guaXNQcmltYXJ5ID09PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRvdWNoLmlzUHJpbWFyeSA9IGV2ZW50LnRvdWNoZXMubGVuZ3RoID09PSAxICYmIGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3VjaC53aWR0aCA9PT0gJ3VuZGVmaW5lZCcpIHRvdWNoLndpZHRoID0gdG91Y2gucmFkaXVzWCB8fCAxO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2guaGVpZ2h0ID09PSAndW5kZWZpbmVkJykgdG91Y2guaGVpZ2h0ID0gdG91Y2gucmFkaXVzWSB8fCAxO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2gudGlsdFggPT09ICd1bmRlZmluZWQnKSB0b3VjaC50aWx0WCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3VjaC50aWx0WSA9PT0gJ3VuZGVmaW5lZCcpIHRvdWNoLnRpbHRZID0gMDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvdWNoLnBvaW50ZXJUeXBlID09PSAndW5kZWZpbmVkJykgdG91Y2gucG9pbnRlclR5cGUgPSAndG91Y2gnO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2gucG9pbnRlcklkID09PSAndW5kZWZpbmVkJykgdG91Y2gucG9pbnRlcklkID0gdG91Y2guaWRlbnRpZmllciB8fCAwO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2gucHJlc3N1cmUgPT09ICd1bmRlZmluZWQnKSB0b3VjaC5wcmVzc3VyZSA9IHRvdWNoLmZvcmNlIHx8IDAuNTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRvdWNoLnR3aXN0ID09PSAndW5kZWZpbmVkJykgdG91Y2gudHdpc3QgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2gudGFuZ2VudGlhbFByZXNzdXJlID09PSAndW5kZWZpbmVkJykgdG91Y2gudGFuZ2VudGlhbFByZXNzdXJlID0gMDtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhlc2UsIGFzIGxheWVyWC9ZIGlzIG5vdCBhIHN0YW5kYXJkLCBpcyBkZXByZWNhdGVkLCBoYXMgdW5ldmVuXG4gICAgICAgICAgICAgICAgLy8gc3VwcG9ydCwgYW5kIHRoZSBmaWxsIGlucyBhcmUgbm90IHF1aXRlIHRoZSBzYW1lXG4gICAgICAgICAgICAgICAgLy8gb2Zmc2V0WC9ZIG1pZ2h0IGJlIG9rYXksIGJ1dCBpcyBub3QgdGhlIHNhbWUgYXMgY2xpZW50WC9ZIHdoZW4gdGhlIGNhbnZhcydzIHRvcFxuICAgICAgICAgICAgICAgIC8vIGxlZnQgaXMgbm90IDAsMCBvbiB0aGUgcGFnZVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG91Y2gubGF5ZXJYID09PSAndW5kZWZpbmVkJykgdG91Y2gubGF5ZXJYID0gdG91Y2gub2Zmc2V0WCA9IHRvdWNoLmNsaWVudFg7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3VjaC5sYXllclkgPT09ICd1bmRlZmluZWQnKSB0b3VjaC5sYXllclkgPSB0b3VjaC5vZmZzZXRZID0gdG91Y2guY2xpZW50WTtcblxuICAgICAgICAgICAgICAgIC8vIG1hcmsgdGhlIHRvdWNoIGFzIG5vcm1hbGl6ZWQsIGp1c3Qgc28gdGhhdCB3ZSBrbm93IHdlIGRpZCBpdFxuICAgICAgICAgICAgICAgIHRvdWNoLmlzTm9ybWFsaXplZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBub3JtYWxpemVkRXZlbnRzLnB1c2godG91Y2gpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGFwcGFyZW50bHkgUG9pbnRlckV2ZW50IHN1YmNsYXNzZXMgTW91c2VFdmVudCwgc28geWF5XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50IGluc3RhbmNlb2YgTW91c2VFdmVudCAmJiAoIXRoaXMuc3VwcG9ydHNQb2ludGVyRXZlbnRzIHx8ICEoZXZlbnQgaW5zdGFuY2VvZiB3aW5kb3cuUG9pbnRlckV2ZW50KSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBFdmVudCA9IGV2ZW50IGFzIFBpeGlQb2ludGVyRXZlbnQ7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGVtcEV2ZW50LmlzUHJpbWFyeSA9PT0gJ3VuZGVmaW5lZCcpIHRlbXBFdmVudC5pc1ByaW1hcnkgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wRXZlbnQud2lkdGggPT09ICd1bmRlZmluZWQnKSB0ZW1wRXZlbnQud2lkdGggPSAxO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wRXZlbnQuaGVpZ2h0ID09PSAndW5kZWZpbmVkJykgdGVtcEV2ZW50LmhlaWdodCA9IDE7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBFdmVudC50aWx0WCA9PT0gJ3VuZGVmaW5lZCcpIHRlbXBFdmVudC50aWx0WCA9IDA7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBFdmVudC50aWx0WSA9PT0gJ3VuZGVmaW5lZCcpIHRlbXBFdmVudC50aWx0WSA9IDA7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBFdmVudC5wb2ludGVyVHlwZSA9PT0gJ3VuZGVmaW5lZCcpIHRlbXBFdmVudC5wb2ludGVyVHlwZSA9ICdtb3VzZSc7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBFdmVudC5wb2ludGVySWQgPT09ICd1bmRlZmluZWQnKSB0ZW1wRXZlbnQucG9pbnRlcklkID0gTU9VU0VfUE9JTlRFUl9JRDtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGVtcEV2ZW50LnByZXNzdXJlID09PSAndW5kZWZpbmVkJykgdGVtcEV2ZW50LnByZXNzdXJlID0gMC41O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wRXZlbnQudHdpc3QgPT09ICd1bmRlZmluZWQnKSB0ZW1wRXZlbnQudHdpc3QgPSAwO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wRXZlbnQudGFuZ2VudGlhbFByZXNzdXJlID09PSAndW5kZWZpbmVkJykgdGVtcEV2ZW50LnRhbmdlbnRpYWxQcmVzc3VyZSA9IDA7XG5cbiAgICAgICAgICAgIC8vIG1hcmsgdGhlIG1vdXNlIGV2ZW50IGFzIG5vcm1hbGl6ZWQsIGp1c3Qgc28gdGhhdCB3ZSBrbm93IHdlIGRpZCBpdFxuICAgICAgICAgICAgdGVtcEV2ZW50LmlzTm9ybWFsaXplZCA9IHRydWU7XG5cbiAgICAgICAgICAgIG5vcm1hbGl6ZWRFdmVudHMucHVzaCh0ZW1wRXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgbm9ybWFsaXplZEV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBub3JtYWxpemVkRXZlbnRzIGFzIFBvaW50ZXJFdmVudFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBpbnRlcmFjdGlvbiBtYW5hZ2VyXG4gICAgICpcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50cygpO1xuXG4gICAgICAgIHRoaXMucmVtb3ZlVGlja2VyTGlzdGVuZXIoKTtcblxuICAgICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMubW91c2UgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuZXZlbnREYXRhID0gbnVsbDtcblxuICAgICAgICB0aGlzLmludGVyYWN0aW9uRE9NRWxlbWVudCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5vblBvaW50ZXJEb3duID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlckRvd24gPSBudWxsO1xuXG4gICAgICAgIHRoaXMub25Qb2ludGVyVXAgPSBudWxsO1xuICAgICAgICB0aGlzLnByb2Nlc3NQb2ludGVyVXAgPSBudWxsO1xuXG4gICAgICAgIHRoaXMub25Qb2ludGVyQ2FuY2VsID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlckNhbmNlbCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5vblBvaW50ZXJNb3ZlID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlck1vdmUgPSBudWxsO1xuXG4gICAgICAgIHRoaXMub25Qb2ludGVyT3V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9jZXNzUG9pbnRlck92ZXJPdXQgPSBudWxsO1xuXG4gICAgICAgIHRoaXMub25Qb2ludGVyT3ZlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5zZWFyY2ggPSBudWxsO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIFBpeGlQb2ludGVyRXZlbnQgZXh0ZW5kcyBQb2ludGVyRXZlbnRcbntcbiAgICBpc1ByaW1hcnk6IGJvb2xlYW47XG4gICAgd2lkdGg6IG51bWJlcjtcbiAgICBoZWlnaHQ6IG51bWJlcjtcbiAgICB0aWx0WDogbnVtYmVyO1xuICAgIHRpbHRZOiBudW1iZXI7XG4gICAgcG9pbnRlclR5cGU6IHN0cmluZztcbiAgICBwb2ludGVySWQ6IG51bWJlcjtcbiAgICBwcmVzc3VyZTogbnVtYmVyO1xuICAgIHR3aXN0OiBudW1iZXI7XG4gICAgdGFuZ2VudGlhbFByZXNzdXJlOiBudW1iZXI7XG4gICAgaXNOb3JtYWxpemVkOiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgUGl4aVRvdWNoIGV4dGVuZHMgVG91Y2hcbntcbiAgICBidXR0b246IG51bWJlcjtcbiAgICBidXR0b25zOiBudW1iZXI7XG4gICAgaXNQcmltYXJ5OiBib29sZWFuO1xuICAgIHdpZHRoOiBudW1iZXI7XG4gICAgaGVpZ2h0OiBudW1iZXI7XG4gICAgdGlsdFg6IG51bWJlcjtcbiAgICB0aWx0WTogbnVtYmVyO1xuICAgIHBvaW50ZXJUeXBlOiBzdHJpbmc7XG4gICAgcG9pbnRlcklkOiBudW1iZXI7XG4gICAgcHJlc3N1cmU6IG51bWJlcjtcbiAgICB0d2lzdDogbnVtYmVyO1xuICAgIHRhbmdlbnRpYWxQcmVzc3VyZTogbnVtYmVyO1xuICAgIGxheWVyWDogbnVtYmVyO1xuICAgIGxheWVyWTogbnVtYmVyO1xuICAgIG9mZnNldFg6IG51bWJlcjtcbiAgICBvZmZzZXRZOiBudW1iZXI7XG4gICAgaXNOb3JtYWxpemVkOiBib29sZWFuO1xufVxuIiwgIi8qKlxuICogQSBSdW5uZXIgaXMgYSBoaWdobHkgcGVyZm9ybWFudCBhbmQgc2ltcGxlIGFsdGVybmF0aXZlIHRvIHNpZ25hbHMuIEJlc3QgdXNlZCBpbiBzaXR1YXRpb25zXG4gKiB3aGVyZSBldmVudHMgYXJlIGRpc3BhdGNoZWQgdG8gbWFueSBvYmplY3RzIGF0IGhpZ2ggZnJlcXVlbmN5IChzYXkgZXZlcnkgZnJhbWUhKVxuICpcbiAqXG4gKiBsaWtlIGEgc2lnbmFsLi5cbiAqIGBgYFxuICogaW1wb3J0IHsgUnVubmVyIH0gZnJvbSAnQHBpeGkvcnVubmVyJztcbiAqXG4gKiBjb25zdCBteU9iamVjdCA9IHtcbiAqICAgICBsb2FkZWQ6IG5ldyBSdW5uZXIoJ2xvYWRlZCcpXG4gKiB9XG4gKlxuICogY29uc3QgbGlzdGVuZXIgPSB7XG4gKiAgICAgbG9hZGVkOiBmdW5jdGlvbigpe1xuICogICAgICAgICAvLyB0aGluXG4gKiAgICAgfVxuICogfVxuICpcbiAqIG15T2JqZWN0LnVwZGF0ZS5hZGQobGlzdGVuZXIpO1xuICpcbiAqIG15T2JqZWN0LmxvYWRlZC5lbWl0KCk7XG4gKiBgYGBcbiAqXG4gKiBPciBmb3IgaGFuZGxpbmcgY2FsbGluZyB0aGUgc2FtZSBmdW5jdGlvbiBvbiBtYW55IGl0ZW1zXG4gKiBgYGBcbiAqIGltcG9ydCB7IFJ1bm5lciB9IGZyb20gJ0BwaXhpL3J1bm5lcic7XG4gKlxuICogY29uc3QgbXlHYW1lID0ge1xuICogICAgIHVwZGF0ZTogbmV3IFJ1bm5lcigndXBkYXRlJylcbiAqIH1cbiAqXG4gKiBjb25zdCBnYW1lT2JqZWN0ID0ge1xuICogICAgIHVwZGF0ZTogZnVuY3Rpb24odGltZSl7XG4gKiAgICAgICAgIC8vIHVwZGF0ZSBteSBnYW1leSBzdGF0ZVxuICogICAgIH1cbiAqIH1cbiAqXG4gKiBteUdhbWUudXBkYXRlLmFkZChnYW1lT2JqZWN0MSk7XG4gKlxuICogbXlHYW1lLnVwZGF0ZS5lbWl0KHRpbWUpO1xuICogYGBgXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBSdW5uZXJcbntcbiAgICBwdWJsaWMgaXRlbXM6IGFueVtdO1xuICAgIHByaXZhdGUgX25hbWU6IHN0cmluZztcbiAgICBwcml2YXRlIF9hbGlhc0NvdW50OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiAgQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSB0aGUgZnVuY3Rpb24gbmFtZSB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgb24gdGhlIGxpc3RlbmVycyBhZGRlZCB0byB0aGlzIFJ1bm5lci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcpXG4gICAge1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9hbGlhc0NvdW50ID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaXNwYXRjaC9Ccm9hZGNhc3QgUnVubmVyIHRvIGFsbCBsaXN0ZW5lcnMgYWRkZWQgdG8gdGhlIHF1ZXVlLlxuICAgICAqIEBwYXJhbSB7Li4uYW55fSBwYXJhbXMgLSBvcHRpb25hbCBwYXJhbWV0ZXJzIHRvIHBhc3MgdG8gZWFjaCBsaXN0ZW5lclxuICAgICAqIEByZXR1cm4ge1BJWEkuUnVubmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBlbWl0KGEwPzogdW5rbm93biwgYTE/OiB1bmtub3duLCBhMj86IHVua25vd24sIGEzPzogdW5rbm93bixcbiAgICAgICAgYTQ/OiB1bmtub3duLCBhNT86IHVua25vd24sIGE2PzogdW5rbm93biwgYTc/OiB1bmtub3duKTogdGhpc1xuICAgIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiA4KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21heCBhcmd1bWVudHMgcmVhY2hlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBuYW1lLCBpdGVtcyB9ID0gdGhpcztcblxuICAgICAgICB0aGlzLl9hbGlhc0NvdW50Kys7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGl0ZW1zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpdGVtc1tpXVtuYW1lXShhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGl0ZW1zID09PSB0aGlzLml0ZW1zKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hbGlhc0NvdW50LS07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBwcml2YXRlIGVuc3VyZU5vbkFsaWFzZWRJdGVtcygpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fYWxpYXNDb3VudCA+IDAgJiYgdGhpcy5pdGVtcy5sZW5ndGggPiAxKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hbGlhc0NvdW50ID0gMDtcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLnNsaWNlKDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgbGlzdGVuZXIgdG8gdGhlIFJ1bm5lclxuICAgICAqXG4gICAgICogUnVubmVycyBkbyBub3QgbmVlZCB0byBoYXZlIHNjb3BlIG9yIGZ1bmN0aW9ucyBwYXNzZWQgdG8gdGhlbS5cbiAgICAgKiBBbGwgdGhhdCBpcyByZXF1aXJlZCBpcyB0byBwYXNzIHRoZSBsaXN0ZW5pbmcgb2JqZWN0IGFuZCBlbnN1cmUgdGhhdCBpdCBoYXMgY29udGFpbnMgYSBmdW5jdGlvbiB0aGF0IGhhcyB0aGUgc2FtZSBuYW1lXG4gICAgICogYXMgdGhlIG5hbWUgcHJvdmlkZWQgdG8gdGhlIFJ1bm5lciB3aGVuIGl0IHdhcyBjcmVhdGVkLlxuICAgICAqXG4gICAgICogRWcgQSBsaXN0ZW5lciBwYXNzZWQgdG8gdGhpcyBSdW5uZXIgd2lsbCByZXF1aXJlIGEgJ2NvbXBsZXRlJyBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIGBgYFxuICAgICAqIGltcG9ydCB7IFJ1bm5lciB9IGZyb20gJ0BwaXhpL3J1bm5lcic7XG4gICAgICpcbiAgICAgKiBjb25zdCBjb21wbGV0ZSA9IG5ldyBSdW5uZXIoJ2NvbXBsZXRlJyk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBUaGUgc2NvcGUgdXNlZCB3aWxsIGJlIHRoZSBvYmplY3QgaXRzZWxmLlxuICAgICAqXG4gICAgICogQHBhcmFtIHthbnl9IGl0ZW0gLSBUaGUgb2JqZWN0IHRoYXQgd2lsbCBiZSBsaXN0ZW5pbmcuXG4gICAgICogQHJldHVybiB7UElYSS5SdW5uZXJ9XG4gICAgICovXG4gICAgcHVibGljIGFkZChpdGVtOiB1bmtub3duKTogdGhpc1xuICAgIHtcbiAgICAgICAgaWYgKChpdGVtIGFzIGFueSlbdGhpcy5fbmFtZV0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZW5zdXJlTm9uQWxpYXNlZEl0ZW1zKCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZShpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHNpbmdsZSBsaXN0ZW5lciBmcm9tIHRoZSBkaXNwYXRjaCBxdWV1ZS5cbiAgICAgKiBAcGFyYW0ge2FueX0gaXRlbSAtIFRoZSBsaXN0ZW5yIHRoYXQgeW91IHdvdWxkIGxpa2UgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuUnVubmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyByZW1vdmUoaXRlbTogdW5rbm93bik6IHRoaXNcbiAgICB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pdGVtcy5pbmRleE9mKGl0ZW0pO1xuXG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZW5zdXJlTm9uQWxpYXNlZEl0ZW1zKCk7XG4gICAgICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayB0byBzZWUgaWYgdGhlIGxpc3RlbmVyIGlzIGFscmVhZHkgaW4gdGhlIFJ1bm5lclxuICAgICAqIEBwYXJhbSB7YW55fSBpdGVtIC0gVGhlIGxpc3RlbmVyIHRoYXQgeW91IHdvdWxkIGxpa2UgdG8gY2hlY2suXG4gICAgICovXG4gICAgcHVibGljIGNvbnRhaW5zKGl0ZW06IHVua25vd24pOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5pbmRleE9mKGl0ZW0pICE9PSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYWxsIGxpc3RlbmVycyBmcm9tIHRoZSBSdW5uZXJcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJ1bm5lcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVtb3ZlQWxsKCk6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMuZW5zdXJlTm9uQWxpYXNlZEl0ZW1zKCk7XG4gICAgICAgIHRoaXMuaXRlbXMubGVuZ3RoID0gMDtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYWxsIHJlZmVyZW5jZXMsIGRvbid0IHVzZSBhZnRlciB0aGlzLlxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMucmVtb3ZlQWxsKCk7XG4gICAgICAgIHRoaXMuaXRlbXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9uYW1lID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBgdHJ1ZWAgaWYgdGhlcmUgYXJlIG5vIHRoaXMgUnVubmVyIGNvbnRhaW5zIG5vIGxpc3RlbmVyc1xuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGVtcHR5KCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zLmxlbmd0aCA9PT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcnVubmVyLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgbmFtZSgpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgIH1cbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUnVubmVyLnByb3RvdHlwZSwge1xuICAgIC8qKlxuICAgICAqIEFsaWFzIGZvciBgZW1pdGBcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5SdW5uZXIjXG4gICAgICogQG1ldGhvZCBkaXNwYXRjaFxuICAgICAqIEBzZWUgUElYSS5SdW5uZXIjZW1pdFxuICAgICAqL1xuICAgIGRpc3BhdGNoOiB7IHZhbHVlOiBSdW5uZXIucHJvdG90eXBlLmVtaXQgfSxcbiAgICAvKipcbiAgICAgKiBBbGlhcyBmb3IgYGVtaXRgXG4gICAgICogQG1lbWJlcm9mIFBJWEkuUnVubmVyI1xuICAgICAqIEBtZXRob2QgcnVuXG4gICAgICogQHNlZSBQSVhJLlJ1bm5lciNlbWl0XG4gICAgICovXG4gICAgcnVuOiB7IHZhbHVlOiBSdW5uZXIucHJvdG90eXBlLmVtaXQgfSxcbn0pO1xuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgRU5WIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IGlzTW9iaWxlIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG4vKipcbiAqIFRoZSBtYXhpbXVtIHN1cHBvcnQgZm9yIHVzaW5nIFdlYkdMLiBJZiBhIGRldmljZSBkb2VzIG5vdFxuICogc3VwcG9ydCBXZWJHTCB2ZXJzaW9uLCBmb3IgaW5zdGFuY2UgV2ViR0wgMiwgaXQgd2lsbCBzdGlsbFxuICogYXR0ZW1wdCB0byBmYWxsYmFjayBzdXBwb3J0IHRvIFdlYkdMIDEuIElmIHlvdSB3YW50IHRvXG4gKiBleHBsaWNpdGx5IHJlbW92ZSBmZWF0dXJlIHN1cHBvcnQgdG8gdGFyZ2V0IGEgbW9yZSBzdGFibGVcbiAqIGJhc2VsaW5lLCBwcmVmZXIgYSBsb3dlciBlbnZpcm9ubWVudC5cbiAqXG4gKiBEdWUgdG8ge0BsaW5rIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTkzNDgyM3xidWcgaW4gY2hyb21pdW19XG4gKiB3ZSBkaXNhYmxlIHdlYmdsMiBieSBkZWZhdWx0IGZvciBhbGwgbm9uLWFwcGxlIG1vYmlsZSBkZXZpY2VzLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIFBSRUZFUl9FTlZcbiAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQGRlZmF1bHQgUElYSS5FTlYuV0VCR0wyXG4gKi9cbnNldHRpbmdzLlBSRUZFUl9FTlYgPSBpc01vYmlsZS5hbnkgPyBFTlYuV0VCR0wgOiBFTlYuV0VCR0wyO1xuXG4vKipcbiAqIElmIHNldCB0byBgdHJ1ZWAsICpvbmx5KiBUZXh0dXJlcyBhbmQgQmFzZVRleHR1cmUgb2JqZWN0cyBzdG9yZWRcbiAqIGluIHRoZSBjYWNoZXMgKHtAbGluayBQSVhJLnV0aWxzLlRleHR1cmVDYWNoZSBUZXh0dXJlQ2FjaGV9IGFuZFxuICoge0BsaW5rIFBJWEkudXRpbHMuQmFzZVRleHR1cmVDYWNoZSBCYXNlVGV4dHVyZUNhY2hlfSkgY2FuIGJlXG4gKiB1c2VkIHdoZW4gY2FsbGluZyB7QGxpbmsgUElYSS5UZXh0dXJlLmZyb20gVGV4dHVyZS5mcm9tfSBvclxuICoge0BsaW5rIFBJWEkuQmFzZVRleHR1cmUuZnJvbSBCYXNlVGV4dHVyZS5mcm9tfS5cbiAqIE90aGVyd2lzZSwgdGhlc2UgYGZyb21gIGNhbGxzIHRocm93IGFuIGV4Y2VwdGlvbi4gVXNpbmcgdGhpcyBwcm9wZXJ0eVxuICogY2FuIGJlIHVzZWZ1bCBpZiB5b3Ugd2FudCB0byBlbmZvcmNlIHByZWxvYWRpbmcgYWxsIGFzc2V0cyB3aXRoXG4gKiB7QGxpbmsgUElYSS5Mb2FkZXIgTG9hZGVyfS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBTVFJJQ1RfVEVYVFVSRV9DQUNIRVxuICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAqIEB0eXBlIHtib29sZWFufVxuICogQGRlZmF1bHQgZmFsc2VcbiAqL1xuc2V0dGluZ3MuU1RSSUNUX1RFWFRVUkVfQ0FDSEUgPSBmYWxzZTtcblxuZXhwb3J0IHsgc2V0dGluZ3MgfTtcbiIsICJpbXBvcnQgeyBSZXNvdXJjZSB9IGZyb20gJy4vUmVzb3VyY2UnO1xuXG5pbXBvcnQgdHlwZSB7IElJbWFnZVJlc291cmNlT3B0aW9ucyB9IGZyb20gJy4vSW1hZ2VSZXNvdXJjZSc7XG5pbXBvcnQgdHlwZXsgSVNpemUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBleyBJQ3ViZVJlc291cmNlT3B0aW9ucyB9IGZyb20gJy4vQ3ViZVJlc291cmNlJztcbmltcG9ydCB0eXBleyBJU1ZHUmVzb3VyY2VPcHRpb25zIH0gZnJvbSAnLi9TVkdSZXNvdXJjZSc7XG5pbXBvcnQgdHlwZXsgSVZpZGVvUmVzb3VyY2VPcHRpb25zIH0gZnJvbSAnLi9WaWRlb1Jlc291cmNlJztcblxuLyoqXG4gKiBBbGxvdyBmbGV4aWJsZSBvcHRpb25zIGZvciByZXNvdXJjZSBwbHVnaW5zXG4gKi9cbmV4cG9ydCB0eXBlIElSZXNvdXJjZVBsdWdpbk9wdGlvbnMgPSB7IFtrZXk6IHN0cmluZ106IGFueSB9O1xuXG4vKipcbiAqIEFsbCBhbGxvd2FibGUgb3B0aW9ucyBmb3IgYXV0b0RldGVjdFJlc291cmNlXG4gKi9cbmV4cG9ydCB0eXBlIElBdXRvRGV0ZWN0T3B0aW9ucyA9IElTaXplXG4gICAgfCBJQ3ViZVJlc291cmNlT3B0aW9uc1xuICAgIHwgSUltYWdlUmVzb3VyY2VPcHRpb25zXG4gICAgfCBJU1ZHUmVzb3VyY2VPcHRpb25zXG4gICAgfCBJVmlkZW9SZXNvdXJjZU9wdGlvbnNcbiAgICB8IElSZXNvdXJjZVBsdWdpbk9wdGlvbnM7XG5cbi8qKlxuICogU2hhcGUgb2Ygc3VwcG9ydGVkIHJlc291cmNlIHBsdWdpbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJUmVzb3VyY2VQbHVnaW5cbntcbiAgICB0ZXN0KHNvdXJjZTogdW5rbm93biwgZXh0ZW5zaW9uOiBzdHJpbmcpOiBib29sZWFuO1xuICAgIG5ldyAoc291cmNlOiBhbnksIG9wdGlvbnM/OiBhbnkpOiBSZXNvdXJjZTtcbn1cblxuLyoqXG4gKiBDb2xsZWN0aW9uIG9mIGluc3RhbGxlZCByZXNvdXJjZSB0eXBlcywgY2xhc3MgbXVzdCBleHRlbmQge0BsaW5rIFBJWEkucmVzb3VyY2VzLlJlc291cmNlfS5cbiAqIEBleGFtcGxlXG4gKiBjbGFzcyBDdXN0b21SZXNvdXJjZSBleHRlbmRzIFBJWEkucmVzb3VyY2VzLlJlc291cmNlIHtcbiAqICAgLy8gTVVTVCBoYXZlIHNvdXJjZSwgb3B0aW9ucyBjb25zdHJ1Y3RvciBzaWduYXR1cmVcbiAqICAgLy8gZm9yIGF1dG8tZGV0ZWN0ZWQgcmVzb3VyY2VzIHRvIGJlIGNyZWF0ZWQuXG4gKiAgIGNvbnN0cnVjdG9yKHNvdXJjZSwgb3B0aW9ucykge1xuICogICAgIHN1cGVyKCk7XG4gKiAgIH1cbiAqICAgdXBsb2FkKHJlbmRlcmVyLCBiYXNlVGV4dHVyZSwgZ2xUZXh0dXJlKSB7XG4gKiAgICAgLy8gdXBsb2FkIHdpdGggR0xcbiAqICAgICByZXR1cm4gdHJ1ZTtcbiAqICAgfVxuICogICAvLyB1c2VkIHRvIGF1dG8tZGV0ZWN0IHJlc291cmNlXG4gKiAgIHN0YXRpYyB0ZXN0KHNvdXJjZSwgZXh0ZW5zaW9uKSB7XG4gKiAgICAgcmV0dXJuIGV4dGVuc2lvbiA9PT0gJ3h5eid8fCBzb3VyY2UgaW5zdGFuY2VvZiBTb21lQ2xhc3M7XG4gKiAgIH1cbiAqIH1cbiAqIC8vIEluc3RhbGwgdGhlIG5ldyByZXNvdXJjZSB0eXBlXG4gKiBQSVhJLnJlc291cmNlcy5JTlNUQUxMRUQucHVzaChDdXN0b21SZXNvdXJjZSk7XG4gKlxuICogQG5hbWUgUElYSS5yZXNvdXJjZXMuSU5TVEFMTEVEXG4gKiBAdHlwZSB7QXJyYXk8Kj59XG4gKiBAc3RhdGljXG4gKiBAcmVhZG9ubHlcbiAqL1xuZXhwb3J0IGNvbnN0IElOU1RBTExFRDogQXJyYXk8SVJlc291cmNlUGx1Z2luPiA9IFtdO1xuXG4vKipcbiAqIENyZWF0ZSBhIHJlc291cmNlIGVsZW1lbnQgZnJvbSBhIHNpbmdsZSBzb3VyY2UgZWxlbWVudC4gVGhpc1xuICogYXV0by1kZXRlY3RzIHdoaWNoIHR5cGUgb2YgcmVzb3VyY2UgdG8gY3JlYXRlLiBBbGwgcmVzb3VyY2VzIHRoYXRcbiAqIGFyZSBhdXRvLWRldGVjdGFibGUgbXVzdCBoYXZlIGEgc3RhdGljIGB0ZXN0YCBtZXRob2QgYW5kIGEgY29uc3RydWN0b3JcbiAqIHdpdGggdGhlIGFyZ3VtZW50cyBgKHNvdXJjZSwgb3B0aW9ucz8pYC4gQ3VycmVudGx5LCB0aGUgc3VwcG9ydGVkXG4gKiByZXNvdXJjZXMgZm9yIGF1dG8tZGV0ZWN0aW9uIGluY2x1ZGU6XG4gKiAgLSB7QGxpbmsgUElYSS5yZXNvdXJjZXMuSW1hZ2VSZXNvdXJjZX1cbiAqICAtIHtAbGluayBQSVhJLnJlc291cmNlcy5DYW52YXNSZXNvdXJjZX1cbiAqICAtIHtAbGluayBQSVhJLnJlc291cmNlcy5WaWRlb1Jlc291cmNlfVxuICogIC0ge0BsaW5rIFBJWEkucmVzb3VyY2VzLlNWR1Jlc291cmNlfVxuICogIC0ge0BsaW5rIFBJWEkucmVzb3VyY2VzLkJ1ZmZlclJlc291cmNlfVxuICogQHN0YXRpY1xuICogQGZ1bmN0aW9uIFBJWEkucmVzb3VyY2VzLmF1dG9EZXRlY3RSZXNvdXJjZVxuICogQHBhcmFtIHtzdHJpbmd8Kn0gc291cmNlIC0gUmVzb3VyY2Ugc291cmNlLCB0aGlzIGNhbiBiZSB0aGUgVVJMIHRvIHRoZSByZXNvdXJjZSxcbiAqICAgICAgICBhIHR5cGVkLWFycmF5IChmb3IgQnVmZmVyUmVzb3VyY2UpLCBIVE1MVmlkZW9FbGVtZW50LCBTVkcgZGF0YS11cmlcbiAqICAgICAgICBvciBhbnkgb3RoZXIgcmVzb3VyY2UgdGhhdCBjYW4gYmUgYXV0by1kZXRlY3RlZC4gSWYgbm90IHJlc291cmNlIGlzXG4gKiAgICAgICAgZGV0ZWN0ZWQsIGl0J3MgYXNzdW1lZCB0byBiZSBhbiBJbWFnZVJlc291cmNlLlxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFBhc3MtdGhyb3VnaCBvcHRpb25zIHRvIHVzZSBmb3IgUmVzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aF0gLSBXaWR0aCBvZiBCdWZmZXJSZXNvdXJjZSBvciBTVkcgcmFzdGVyaXphdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmhlaWdodF0gLSBIZWlnaHQgb2YgQnVmZmVyUmVzb3VyY2Ugb3IgU1ZHIHJhc3Rlcml6YXRpb25cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYXV0b0xvYWQ9dHJ1ZV0gLSBJbWFnZSwgU1ZHIGFuZCBWaWRlbyBmbGFnIHRvIHN0YXJ0IGxvYWRpbmdcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5zY2FsZT0xXSAtIFNWRyBzb3VyY2Ugc2NhbGUuIE92ZXJyaWRkZW4gYnkgd2lkdGgsIGhlaWdodFxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jcmVhdGVCaXRtYXA9UElYSS5zZXR0aW5ncy5DUkVBVEVfSU1BR0VfQklUTUFQXSAtIEltYWdlIG9wdGlvbiB0byBjcmVhdGUgQml0bWFwIG9iamVjdFxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jcm9zc29yaWdpbj10cnVlXSAtIEltYWdlIGFuZCBWaWRlbyBvcHRpb24gdG8gc2V0IGNyb3NzT3JpZ2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9QbGF5PXRydWVdIC0gVmlkZW8gb3B0aW9uIHRvIHN0YXJ0IHBsYXlpbmcgdmlkZW8gaW1tZWRpYXRlbHlcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy51cGRhdGVGUFM9MF0gLSBWaWRlbyBvcHRpb24gdG8gdXBkYXRlIGhvdyBtYW55IHRpbWVzIGEgc2Vjb25kIHRoZVxuICogICAgICAgIHRleHR1cmUgc2hvdWxkIGJlIHVwZGF0ZWQgZnJvbSB0aGUgdmlkZW8uIExlYXZlIGF0IDAgdG8gdXBkYXRlIGF0IGV2ZXJ5IHJlbmRlclxuICogQHJldHVybiB7UElYSS5yZXNvdXJjZXMuUmVzb3VyY2V9IFRoZSBjcmVhdGVkIHJlc291cmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXV0b0RldGVjdFJlc291cmNlKHNvdXJjZTogdW5rbm93biwgb3B0aW9ucz86IElBdXRvRGV0ZWN0T3B0aW9ucyk6IFJlc291cmNlXG57XG4gICAgaWYgKCFzb3VyY2UpXG4gICAge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBsZXQgZXh0ZW5zaW9uID0gJyc7XG5cbiAgICBpZiAodHlwZW9mIHNvdXJjZSA9PT0gJ3N0cmluZycpXG4gICAge1xuICAgICAgICAvLyBzZWFyY2ggZm9yIGZpbGUgZXh0ZW5zaW9uOiBwZXJpb2QsIDMtNCBjaGFycywgdGhlbiA/LCAjIG9yIEVPTFxuICAgICAgICBjb25zdCByZXN1bHQgPSAoL1xcLihcXHd7Myw0fSkoPzokfFxcP3wjKS9pKS5leGVjKHNvdXJjZSk7XG5cbiAgICAgICAgaWYgKHJlc3VsdClcbiAgICAgICAge1xuICAgICAgICAgICAgZXh0ZW5zaW9uID0gcmVzdWx0WzFdLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gSU5TVEFMTEVELmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKVxuICAgIHtcbiAgICAgICAgY29uc3QgUmVzb3VyY2VQbHVnaW4gPSBJTlNUQUxMRURbaV07XG5cbiAgICAgICAgaWYgKFJlc291cmNlUGx1Z2luLnRlc3QgJiYgUmVzb3VyY2VQbHVnaW4udGVzdChzb3VyY2UsIGV4dGVuc2lvbikpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzb3VyY2VQbHVnaW4oc291cmNlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRocm93IG5ldyBFcnJvcignVW5yZWNvZ25pemVkIHNvdXJjZSB0eXBlIHRvIGF1dG8tZGV0ZWN0IFJlc291cmNlJyk7XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgUnVubmVyIH0gZnJvbSAnQHBpeGkvcnVubmVyJztcblxuaW1wb3J0IHR5cGUgeyBCYXNlVGV4dHVyZSB9IGZyb20gJy4uL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9SZW5kZXJlcic7XG5pbXBvcnQgdHlwZSB7IEdMVGV4dHVyZSB9IGZyb20gJy4uL0dMVGV4dHVyZSc7XG5cbi8qKlxuICogQmFzZSByZXNvdXJjZSBjbGFzcyBmb3IgdGV4dHVyZXMgdGhhdCBtYW5hZ2VzIHZhbGlkYXRpb24gYW5kIHVwbG9hZGluZywgZGVwZW5kaW5nIG9uIGl0cyB0eXBlLlxuICpcbiAqIFVwbG9hZGluZyBvZiBhIGJhc2UgdGV4dHVyZSB0byB0aGUgR1BVIGlzIHJlcXVpcmVkLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWEkucmVzb3VyY2VzXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBSZXNvdXJjZVxue1xuICAgIHB1YmxpYyBkZXN0cm95ZWQ6IGJvb2xlYW47XG4gICAgcHVibGljIGludGVybmFsOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBfd2lkdGg6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2hlaWdodDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBvblJlc2l6ZTogUnVubmVyO1xuICAgIHByb3RlY3RlZCBvblVwZGF0ZTogUnVubmVyO1xuICAgIHByb3RlY3RlZCBvbkVycm9yOiBSdW5uZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt3aWR0aD0wXSAtIFdpZHRoIG9mIHRoZSByZXNvdXJjZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbaGVpZ2h0PTBdIC0gSGVpZ2h0IG9mIHRoZSByZXNvdXJjZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHdpZHRoID0gMCwgaGVpZ2h0ID0gMClcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCB3aWR0aCBvZiB0aGUgcmVzb3VyY2VcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCBoZWlnaHQgb2YgdGhlIHJlc291cmNlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiByZXNvdXJjZSBoYXMgYmVlbiBkZXN0cm95ZWRcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBgdHJ1ZWAgaWYgcmVzb3VyY2UgaXMgY3JlYXRlZCBieSBCYXNlVGV4dHVyZVxuICAgICAgICAgKiB1c2VmdWwgZm9yIGRvaW5nIGNsZWFudXAgd2l0aCBCYXNlVGV4dHVyZSBkZXN0cm95XG4gICAgICAgICAqIGFuZCBub3QgY2xlYW5pbmcgdXAgcmVzb3VyY2VzIHRoYXQgd2VyZSBjcmVhdGVkXG4gICAgICAgICAqIGV4dGVybmFsbHkuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW50ZXJuYWwgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogTWluaS1ydW5uZXIgZm9yIGhhbmRsaW5nIHJlc2l6ZSBldmVudHNcbiAgICAgICAgICogYWNjZXB0cyAyIHBhcmFtZXRlcnM6IHdpZHRoLCBoZWlnaHRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UnVubmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vblJlc2l6ZSA9IG5ldyBSdW5uZXIoJ3NldFJlYWxTaXplJyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1pbmktcnVubmVyIGZvciBoYW5kbGluZyB1cGRhdGUgZXZlbnRzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1J1bm5lcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25VcGRhdGUgPSBuZXcgUnVubmVyKCd1cGRhdGUnKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlIGludGVybmFsIGVycm9ycywgc3VjaCBhcyBsb2FkaW5nIGVycm9yc1xuICAgICAgICAgKiBhY2NlcHRzIDEgcGFyYW06IGVycm9yXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1J1bm5lcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25FcnJvciA9IG5ldyBSdW5uZXIoJ29uRXJyb3InKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCaW5kIHRvIGEgcGFyZW50IEJhc2VUZXh0dXJlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IGJhc2VUZXh0dXJlIC0gUGFyZW50IHRleHR1cmVcbiAgICAgKi9cbiAgICBiaW5kKGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMub25SZXNpemUuYWRkKGJhc2VUZXh0dXJlKTtcbiAgICAgICAgdGhpcy5vblVwZGF0ZS5hZGQoYmFzZVRleHR1cmUpO1xuICAgICAgICB0aGlzLm9uRXJyb3IuYWRkKGJhc2VUZXh0dXJlKTtcblxuICAgICAgICAvLyBDYWxsIGEgcmVzaXplIGltbWVkaWF0ZSBpZiB3ZSBhbHJlYWR5XG4gICAgICAgIC8vIGhhdmUgdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIHJlc291cmNlXG4gICAgICAgIGlmICh0aGlzLl93aWR0aCB8fCB0aGlzLl9oZWlnaHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMub25SZXNpemUuZW1pdCh0aGlzLl93aWR0aCwgdGhpcy5faGVpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVuYmluZCB0byBhIHBhcmVudCBCYXNlVGV4dHVyZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIFBhcmVudCB0ZXh0dXJlXG4gICAgICovXG4gICAgdW5iaW5kKGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMub25SZXNpemUucmVtb3ZlKGJhc2VUZXh0dXJlKTtcbiAgICAgICAgdGhpcy5vblVwZGF0ZS5yZW1vdmUoYmFzZVRleHR1cmUpO1xuICAgICAgICB0aGlzLm9uRXJyb3IucmVtb3ZlKGJhc2VUZXh0dXJlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyIGEgcmVzaXplIGV2ZW50XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gWCBkaW1lbnNpb25cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IC0gWSBkaW1lbnNpb25cbiAgICAgKi9cbiAgICByZXNpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAod2lkdGggIT09IHRoaXMuX3dpZHRoIHx8IGhlaWdodCAhPT0gdGhpcy5faGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5vblJlc2l6ZS5lbWl0KHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFzIGJlZW4gdmFsaWRhdGVkXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgdmFsaWQoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5fd2lkdGggJiYgISF0aGlzLl9oZWlnaHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFzIGJlZW4gdXBkYXRlZCB0cmlnZ2VyIGV2ZW50XG4gICAgICovXG4gICAgdXBkYXRlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5kZXN0cm95ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMub25VcGRhdGUuZW1pdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBjYW4gYmUgb3ZlcnJpZGRlbiB0byBzdGFydCBwcmVsb2FkaW5nIGEgcmVzb3VyY2VcbiAgICAgKiBvciBkbyBhbnkgb3RoZXIgcHJlcGFyZSBzdGVwLlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPHZvaWQ+fSBIYW5kbGUgdGhlIHZhbGlkYXRlIGV2ZW50XG4gICAgICovXG4gICAgbG9hZCgpOiBQcm9taXNlPFJlc291cmNlPlxuICAgIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIHJlc291cmNlLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCB3aWR0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgaGVpZ2h0KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGxvYWRzIHRoZSB0ZXh0dXJlIG9yIHJldHVybnMgZmFsc2UgaWYgaXQgY2FudCBmb3Igc29tZSByZWFzb24uIE92ZXJyaWRlIHRoaXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0geWVhaCwgcmVuZGVyZXIhXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIHRoZSB0ZXh0dXJlXG4gICAgICogQHBhcmFtIHtQSVhJLkdMVGV4dHVyZX0gZ2xUZXh0dXJlIC0gdGV4dHVyZSBpbnN0YW5jZSBmb3IgdGhpcyB3ZWJnbCBjb250ZXh0XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaXMgc3VjY2Vzc1xuICAgICAqL1xuICAgIGFic3RyYWN0IHVwbG9hZChyZW5kZXJlcjogUmVuZGVyZXIsIGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSwgZ2xUZXh0dXJlOiBHTFRleHR1cmUpOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBzdHlsZSwgb3B0aW9uYWwgdG8gb3ZlcnJpZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSB5ZWFoLCByZW5kZXJlciFcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IGJhc2VUZXh0dXJlIC0gdGhlIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0xUZXh0dXJlfSBnbFRleHR1cmUgLSB0ZXh0dXJlIGluc3RhbmNlIGZvciB0aGlzIHdlYmdsIGNvbnRleHRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gYHRydWVgIGlzIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBzdHlsZShfcmVuZGVyZXI6IFJlbmRlcmVyLCBfYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBfZ2xUZXh0dXJlOiBHTFRleHR1cmUpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgYW55dGhpbmcsIHRoaXMgaGFwcGVucyB3aGVuIGRlc3Ryb3lpbmcgaXMgcmVhZHkuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgZGlzcG9zZSgpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBvdmVycmlkZVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGwgd2hlbiBkZXN0cm95aW5nIHJlc291cmNlLCB1bmJpbmQgYW55IEJhc2VUZXh0dXJlIG9iamVjdFxuICAgICAqIGJlZm9yZSBjYWxsaW5nIHRoaXMgbWV0aG9kLCBhcyByZWZlcmVuY2UgY291bnRzIGFyZSBtYWludGFpbmVkXG4gICAgICogaW50ZXJuYWxseS5cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5kZXN0cm95ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5vbkVycm9yLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgdGhpcy5vbkVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMub25SZXNpemUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICB0aGlzLm9uUmVzaXplID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMub25VcGRhdGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICB0aGlzLm9uVXBkYXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFic3RyYWN0LCB1c2VkIHRvIGF1dG8tZGV0ZWN0IHJlc291cmNlIHR5cGVcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0geyp9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2JqZWN0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiAtIFRoZSBleHRlbnNpb24gb2Ygc291cmNlLCBpZiBzZXRcbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChfc291cmNlOiB1bmtub3duLCBfZXh0ZW5zaW9uPzogc3RyaW5nKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSZXNvdXJjZSB9IGZyb20gJy4vUmVzb3VyY2UnO1xuaW1wb3J0IHsgQUxQSEFfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IElTaXplIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgdHlwZSB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vQmFzZVRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgR0xUZXh0dXJlIH0gZnJvbSAnLi4vR0xUZXh0dXJlJztcbi8qKlxuICogQGludGVyZmFjZSBTaGFyZWRBcnJheUJ1ZmZlclxuICovXG5cbi8qKlxuICogQnVmZmVyIHJlc291cmNlIHdpdGggZGF0YSBvZiB0eXBlZCBhcnJheS5cbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5yZXNvdXJjZXMuUmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICovXG5leHBvcnQgY2xhc3MgQnVmZmVyUmVzb3VyY2UgZXh0ZW5kcyBSZXNvdXJjZVxue1xuICAgIGRhdGE6IEZsb2F0MzJBcnJheXxVaW50OEFycmF5fFVpbnQzMkFycmF5O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl8VWludDhBcnJheXxVaW50MzJBcnJheX0gc291cmNlIC0gU291cmNlIGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gT3B0aW9uc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcHRpb25zLndpZHRoIC0gV2lkdGggb2YgdGhlIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5oZWlnaHQgLSBIZWlnaHQgb2YgdGhlIHRleHR1cmVcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2U6IEZsb2F0MzJBcnJheXxVaW50OEFycmF5fFVpbnQzMkFycmF5LCBvcHRpb25zOiBJU2l6ZSlcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICBpZiAoIXdpZHRoIHx8ICFoZWlnaHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQnVmZmVyUmVzb3VyY2Ugd2lkdGggb3IgaGVpZ2h0IGludmFsaWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyKHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTb3VyY2UgYXJyYXlcbiAgICAgICAgICogQ2Fubm90IGJlIENsYW1wZWRVaW50OEFycmF5IGJlY2F1c2UgaXQgY2FudCBiZSB1cGxvYWRlZCB0byBXZWJHTFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl8VWludDhBcnJheXxVaW50MzJBcnJheX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGF0YSA9IHNvdXJjZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGxvYWQgdGhlIHRleHR1cmUgdG8gdGhlIEdQVS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVXBsb2FkIHRvIHRoZSByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBSZWZlcmVuY2UgdG8gcGFyZW50IHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0xUZXh0dXJlfSBnbFRleHR1cmUgLSBnbFRleHR1cmVcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpcyBzdWNjZXNzXG4gICAgICovXG4gICAgdXBsb2FkKHJlbmRlcmVyOiBSZW5kZXJlciwgYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBnbFRleHR1cmU6IEdMVGV4dHVyZSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGNvbnN0IGdsID0gcmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgZ2wucGl4ZWxTdG9yZWkoZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCBiYXNlVGV4dHVyZS5hbHBoYU1vZGUgPT09IEFMUEhBX01PREVTLlVOUEFDSyk7XG5cbiAgICAgICAgaWYgKGdsVGV4dHVyZS53aWR0aCA9PT0gYmFzZVRleHR1cmUud2lkdGggJiYgZ2xUZXh0dXJlLmhlaWdodCA9PT0gYmFzZVRleHR1cmUuaGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICBnbC50ZXhTdWJJbWFnZTJEKFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLnRhcmdldCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS53aWR0aCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgYmFzZVRleHR1cmUuZm9ybWF0LFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZ2xUZXh0dXJlLndpZHRoID0gYmFzZVRleHR1cmUud2lkdGg7XG4gICAgICAgICAgICBnbFRleHR1cmUuaGVpZ2h0ID0gYmFzZVRleHR1cmUuaGVpZ2h0O1xuXG4gICAgICAgICAgICBnbC50ZXhJbWFnZTJEKFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLnRhcmdldCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIGdsVGV4dHVyZS5pbnRlcm5hbEZvcm1hdCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS53aWR0aCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS5mb3JtYXQsXG4gICAgICAgICAgICAgICAgZ2xUZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSBhbmQgZG9uJ3QgdXNlIGFmdGVyIHRoaXNcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBhdXRvLWRldGVjdCB0aGUgdHlwZSBvZiByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0geyp9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2JqZWN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gYHRydWVgIGlmIDxjYW52YXM+XG4gICAgICovXG4gICAgc3RhdGljIHRlc3Qoc291cmNlOiB1bmtub3duKTogc291cmNlIGlzIEZsb2F0MzJBcnJheXxVaW50OEFycmF5fFVpbnQzMkFycmF5XG4gICAge1xuICAgICAgICByZXR1cm4gc291cmNlIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5XG4gICAgICAgICAgICB8fCBzb3VyY2UgaW5zdGFuY2VvZiBVaW50OEFycmF5XG4gICAgICAgICAgICB8fCBzb3VyY2UgaW5zdGFuY2VvZiBVaW50MzJBcnJheTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQmFzZVRleHR1cmVDYWNoZSwgRXZlbnRFbWl0dGVyLCBpc1BvdzIsIFRleHR1cmVDYWNoZSwgdWlkIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgRk9STUFUUywgU0NBTEVfTU9ERVMsIFRBUkdFVFMsIFRZUEVTLCBBTFBIQV9NT0RFUywgTUlQTUFQX01PREVTLCBXUkFQX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnLi9yZXNvdXJjZXMvUmVzb3VyY2UnO1xuaW1wb3J0IHsgQnVmZmVyUmVzb3VyY2UgfSBmcm9tICcuL3Jlc291cmNlcy9CdWZmZXJSZXNvdXJjZSc7XG5pbXBvcnQgeyBhdXRvRGV0ZWN0UmVzb3VyY2UgfSBmcm9tICcuL3Jlc291cmNlcy9hdXRvRGV0ZWN0UmVzb3VyY2UnO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5cbmltcG9ydCB0eXBlIHsgR0xUZXh0dXJlIH0gZnJvbSAnLi9HTFRleHR1cmUnO1xuXG5jb25zdCBkZWZhdWx0QnVmZmVyT3B0aW9ucyA9IHtcbiAgICBzY2FsZU1vZGU6IFNDQUxFX01PREVTLk5FQVJFU1QsXG4gICAgZm9ybWF0OiBGT1JNQVRTLlJHQkEsXG4gICAgYWxwaGFNb2RlOiBBTFBIQV9NT0RFUy5OUE0sXG59O1xuXG5leHBvcnQgdHlwZSBJbWFnZVNvdXJjZSA9IEhUTUxJbWFnZUVsZW1lbnR8SFRNTENhbnZhc0VsZW1lbnR8SFRNTFZpZGVvRWxlbWVudHxJbWFnZUJpdG1hcDtcblxuZXhwb3J0IGludGVyZmFjZSBJQmFzZVRleHR1cmVPcHRpb25zIHtcbiAgICBhbHBoYU1vZGU/OiBBTFBIQV9NT0RFUztcbiAgICBtaXBtYXA/OiBNSVBNQVBfTU9ERVM7XG4gICAgYW5pc290cm9waWNMZXZlbD86IG51bWJlcjtcbiAgICBzY2FsZU1vZGU/OiBTQ0FMRV9NT0RFUztcbiAgICB3aWR0aD86IG51bWJlcjtcbiAgICBoZWlnaHQ/OiBudW1iZXI7XG4gICAgd3JhcE1vZGU/OiBXUkFQX01PREVTO1xuICAgIGZvcm1hdD86IEZPUk1BVFM7XG4gICAgdHlwZT86IFRZUEVTO1xuICAgIHRhcmdldD86IFRBUkdFVFM7XG4gICAgcmVzb2x1dGlvbj86IG51bWJlcjtcbiAgICByZXNvdXJjZU9wdGlvbnM/OiBhbnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFzZVRleHR1cmUgZXh0ZW5kcyBHbG9iYWxNaXhpbnMuQmFzZVRleHR1cmUsIEV2ZW50RW1pdHRlciB7fVxuXG4vKipcbiAqIEEgVGV4dHVyZSBzdG9yZXMgdGhlIGluZm9ybWF0aW9uIHRoYXQgcmVwcmVzZW50cyBhbiBpbWFnZS5cbiAqIEFsbCB0ZXh0dXJlcyBoYXZlIGEgYmFzZSB0ZXh0dXJlLCB3aGljaCBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgc291cmNlLlxuICogVGhlcmVmb3JlIHlvdSBjYW4gaGF2ZSBtYW55IHRleHR1cmVzIGFsbCB1c2luZyBhIHNpbmdsZSBCYXNlVGV4dHVyZVxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS51dGlscy5FdmVudEVtaXR0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAcGFyYW0ge1BJWEkucmVzb3VyY2VzLlJlc291cmNlfHN0cmluZ3xIVE1MSW1hZ2VFbGVtZW50fEhUTUxDYW52YXNFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnR9IFtyZXNvdXJjZT1udWxsXVxuICogICAgICAgIFRoZSBjdXJyZW50IHJlc291cmNlIHRvIHVzZSwgZm9yIHRoaW5ncyB0aGF0IGFyZW4ndCBSZXNvdXJjZSBvYmplY3RzLCB3aWxsIGJlIGNvbnZlcnRlZFxuICogICAgICAgIGludG8gYSBSZXNvdXJjZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSBDb2xsZWN0aW9uIG9mIG9wdGlvbnNcbiAqIEBwYXJhbSB7UElYSS5NSVBNQVBfTU9ERVN9IFtvcHRpb25zLm1pcG1hcD1QSVhJLnNldHRpbmdzLk1JUE1BUF9URVhUVVJFU10gLSBJZiBtaXBtYXBwaW5nIGlzIGVuYWJsZWQgZm9yIHRleHR1cmVcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5hbmlzb3Ryb3BpY0xldmVsPVBJWEkuc2V0dGluZ3MuQU5JU09UUk9QSUNfTEVWRUxdIC0gQW5pc290cm9waWMgZmlsdGVyaW5nIGxldmVsIG9mIHRleHR1cmVcbiAqIEBwYXJhbSB7UElYSS5XUkFQX01PREVTfSBbb3B0aW9ucy53cmFwTW9kZT1QSVhJLnNldHRpbmdzLldSQVBfTU9ERV0gLSBXcmFwIG1vZGUgZm9yIHRleHR1cmVzXG4gKiBAcGFyYW0ge1BJWEkuU0NBTEVfTU9ERVN9IFtvcHRpb25zLnNjYWxlTW9kZT1QSVhJLnNldHRpbmdzLlNDQUxFX01PREVdIC0gRGVmYXVsdCBzY2FsZSBtb2RlLCBsaW5lYXIsIG5lYXJlc3RcbiAqIEBwYXJhbSB7UElYSS5GT1JNQVRTfSBbb3B0aW9ucy5mb3JtYXQ9UElYSS5GT1JNQVRTLlJHQkFdIC0gR0wgZm9ybWF0IHR5cGVcbiAqIEBwYXJhbSB7UElYSS5UWVBFU30gW29wdGlvbnMudHlwZT1QSVhJLlRZUEVTLlVOU0lHTkVEX0JZVEVdIC0gR0wgZGF0YSB0eXBlXG4gKiBAcGFyYW0ge1BJWEkuVEFSR0VUU30gW29wdGlvbnMudGFyZ2V0PVBJWEkuVEFSR0VUUy5URVhUVVJFXzJEXSAtIEdMIHRleHR1cmUgdGFyZ2V0XG4gKiBAcGFyYW0ge1BJWEkuQUxQSEFfTU9ERVN9IFtvcHRpb25zLmFscGhhTW9kZT1QSVhJLkFMUEhBX01PREVTLlVOUEFDS10gLSBQcmUgbXVsdGlwbHkgdGhlIGltYWdlIGFscGhhXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGg9MF0gLSBXaWR0aCBvZiB0aGUgdGV4dHVyZVxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmhlaWdodD0wXSAtIEhlaWdodCBvZiB0aGUgdGV4dHVyZVxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnJlc29sdXRpb25dIC0gUmVzb2x1dGlvbiBvZiB0aGUgYmFzZSB0ZXh0dXJlXG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnMucmVzb3VyY2VPcHRpb25zXSAtIE9wdGlvbmFsIHJlc291cmNlIG9wdGlvbnMsXG4gKiAgICAgICAgc2VlIHtAbGluayBQSVhJLnJlc291cmNlcy5hdXRvRGV0ZWN0UmVzb3VyY2UgYXV0b0RldGVjdFJlc291cmNlfVxuICovXG5leHBvcnQgY2xhc3MgQmFzZVRleHR1cmUgZXh0ZW5kcyBFdmVudEVtaXR0ZXJcbntcbiAgICBwdWJsaWMgd2lkdGg6IG51bWJlcjtcbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIHJlc29sdXRpb246IG51bWJlcjtcbiAgICBwdWJsaWMgYWxwaGFNb2RlPzogQUxQSEFfTU9ERVM7XG4gICAgcHVibGljIG1pcG1hcD86IE1JUE1BUF9NT0RFUztcbiAgICBwdWJsaWMgYW5pc290cm9waWNMZXZlbD86IG51bWJlcjtcbiAgICBwdWJsaWMgc2NhbGVNb2RlPzogU0NBTEVfTU9ERVM7XG4gICAgcHVibGljIHdyYXBNb2RlPzogV1JBUF9NT0RFUztcbiAgICBwdWJsaWMgZm9ybWF0PzogRk9STUFUUztcbiAgICBwdWJsaWMgdHlwZT86IFRZUEVTO1xuICAgIHB1YmxpYyB0YXJnZXQ/OiBUQVJHRVRTO1xuXG4gICAgcHVibGljIHJlYWRvbmx5IHVpZDogbnVtYmVyO1xuICAgIHRvdWNoZWQ6IG51bWJlcjtcbiAgICBpc1Bvd2VyT2ZUd286IGJvb2xlYW47XG5cbiAgICBfZ2xUZXh0dXJlczogeyBba2V5OiBudW1iZXJdOiBHTFRleHR1cmUgfTtcbiAgICBkaXJ0eUlkOiBudW1iZXI7XG4gICAgZGlydHlTdHlsZUlkOiBudW1iZXI7XG4gICAgcHVibGljIGNhY2hlSWQ6IHN0cmluZztcbiAgICBwdWJsaWMgdmFsaWQ6IGJvb2xlYW47XG4gICAgdGV4dHVyZUNhY2hlSWRzOiBBcnJheTxzdHJpbmc+O1xuICAgIHB1YmxpYyBkZXN0cm95ZWQ6IGJvb2xlYW47XG4gICAgcHVibGljIHJlc291cmNlOiBSZXNvdXJjZTtcbiAgICBfYmF0Y2hFbmFibGVkOiBudW1iZXI7XG4gICAgX2JhdGNoTG9jYXRpb246IG51bWJlcjtcbiAgICBwYXJlbnRUZXh0dXJlQXJyYXk6IEJhc2VUZXh0dXJlO1xuXG4gICAgY29uc3RydWN0b3IocmVzb3VyY2U6IFJlc291cmNlIHwgSW1hZ2VTb3VyY2UgfCBzdHJpbmcgfCBhbnkgPSBudWxsLCBvcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zID0gbnVsbClcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgICAgY29uc3QgeyBhbHBoYU1vZGUsIG1pcG1hcCwgYW5pc290cm9waWNMZXZlbCwgc2NhbGVNb2RlLCB3aWR0aCwgaGVpZ2h0LFxuICAgICAgICAgICAgd3JhcE1vZGUsIGZvcm1hdCwgdHlwZSwgdGFyZ2V0LCByZXNvbHV0aW9uLCByZXNvdXJjZU9wdGlvbnMgfSA9IG9wdGlvbnM7XG5cbiAgICAgICAgLy8gQ29udmVydCB0aGUgcmVzb3VyY2UgdG8gYSBSZXNvdXJjZSBvYmplY3RcbiAgICAgICAgaWYgKHJlc291cmNlICYmICEocmVzb3VyY2UgaW5zdGFuY2VvZiBSZXNvdXJjZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlc291cmNlID0gYXV0b0RldGVjdFJlc291cmNlKHJlc291cmNlLCByZXNvdXJjZU9wdGlvbnMpO1xuICAgICAgICAgICAgcmVzb3VyY2UuaW50ZXJuYWwgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgYmFzZSB0ZXh0dXJlIHNldCB3aGVuIHRoZSBpbWFnZSBoYXMgbG9hZGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggfHwgMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGhlaWdodCBvZiB0aGUgYmFzZSB0ZXh0dXJlIHNldCB3aGVuIHRoZSBpbWFnZSBoYXMgbG9hZGVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodCB8fCAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiB0aGUgdGV4dHVyZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuc2V0dGluZ3MuUkVTT0xVVElPTlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbiB8fCBzZXR0aW5ncy5SRVNPTFVUSU9OO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNaXBtYXAgbW9kZSBvZiB0aGUgdGV4dHVyZSwgYWZmZWN0cyBkb3duc2NhbGVkIGltYWdlc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1JUE1BUF9NT0RFU31cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5zZXR0aW5ncy5NSVBNQVBfVEVYVFVSRVNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWlwbWFwID0gbWlwbWFwICE9PSB1bmRlZmluZWQgPyBtaXBtYXAgOiBzZXR0aW5ncy5NSVBNQVBfVEVYVFVSRVM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuaXNvdHJvcGljIGZpbHRlcmluZyBsZXZlbCBvZiB0ZXh0dXJlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5zZXR0aW5ncy5BTklTT1RST1BJQ19MRVZFTFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbmlzb3Ryb3BpY0xldmVsID0gYW5pc290cm9waWNMZXZlbCAhPT0gdW5kZWZpbmVkID8gYW5pc290cm9waWNMZXZlbCA6IHNldHRpbmdzLkFOSVNPVFJPUElDX0xFVkVMO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIb3cgdGhlIHRleHR1cmUgd3JhcHNcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53cmFwTW9kZSA9IHdyYXBNb2RlIHx8IHNldHRpbmdzLldSQVBfTU9ERTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNjYWxlIG1vZGUgdG8gYXBwbHkgd2hlbiBzY2FsaW5nIHRoaXMgdGV4dHVyZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlNDQUxFX01PREVTfVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLnNldHRpbmdzLlNDQUxFX01PREVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2NhbGVNb2RlID0gc2NhbGVNb2RlICE9PSB1bmRlZmluZWQgPyBzY2FsZU1vZGUgOiBzZXR0aW5ncy5TQ0FMRV9NT0RFO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcGl4ZWwgZm9ybWF0IG9mIHRoZSB0ZXh0dXJlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRk9STUFUU31cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5GT1JNQVRTLlJHQkFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0IHx8IEZPUk1BVFMuUkdCQTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHR5cGUgb2YgcmVzb3VyY2UgZGF0YVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlRZUEVTfVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLlRZUEVTLlVOU0lHTkVEX0JZVEVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGUgfHwgVFlQRVMuVU5TSUdORURfQllURTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRhcmdldCB0eXBlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVEFSR0VUU31cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5UQVJHRVRTLlRFWFRVUkVfMkRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0IHx8IFRBUkdFVFMuVEVYVFVSRV8yRDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSG93IHRvIHRyZWF0IHByZW11bHRpcGxpZWQgYWxwaGEsIHNlZSB7QGxpbmsgUElYSS5BTFBIQV9NT0RFU30uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQUxQSEFfTU9ERVN9XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuQUxQSEFfTU9ERVMuVU5QQUNLXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFscGhhTW9kZSA9IGFscGhhTW9kZSAhPT0gdW5kZWZpbmVkID8gYWxwaGFNb2RlIDogQUxQSEFfTU9ERVMuVU5QQUNLO1xuXG4gICAgICAgIGlmICgob3B0aW9ucyBhcyBhbnkpLnByZW11bHRpcGx5QWxwaGEgIT09IHVuZGVmaW5lZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gdHJpZ2dlcnMgZGVwcmVjYXRpb25cbiAgICAgICAgICAgICh0aGlzIGFzIGFueSkucHJlbXVsdGlwbHlBbHBoYSA9IChvcHRpb25zIGFzIGFueSkucHJlbXVsdGlwbHlBbHBoYTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHbG9iYWwgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoaXMgQmFzZVRleHR1cmVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVpZCA9IHVpZCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VkIGJ5IGF1dG9tYXRpYyB0ZXh0dXJlIEdhcmJhZ2UgQ29sbGVjdGlvbiwgc3RvcmVzIGxhc3QgR0MgdGljayB3aGVuIGl0IHdhcyBib3VuZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudG91Y2hlZCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgb3Igbm90IHRoZSB0ZXh0dXJlIGlzIGEgcG93ZXIgb2YgdHdvLCB0cnkgdG8gdXNlIHBvd2VyIG9mIHR3byB0ZXh0dXJlcyBhcyBtdWNoXG4gICAgICAgICAqIGFzIHlvdSBjYW5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlzUG93ZXJPZlR3byA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWZyZXNoUE9UKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtYXAgb2YgcmVuZGVyIGNvbnRleHQgdGV4dHVyZXMgd2hlcmUgdGhpcyBpcyBib3VuZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9nbFRleHR1cmVzID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZWQgYnkgVGV4dHVyZVN5c3RlbSB0byBvbmx5IHVwZGF0ZSB0ZXh0dXJlIHRvIHRoZSBHUFUgd2hlbiBuZWVkZWQuXG4gICAgICAgICAqIFBsZWFzZSBjYWxsIGB1cGRhdGUoKWAgdG8gaW5jcmVtZW50IGl0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXJ0eUlkID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlZCBieSBUZXh0dXJlU3lzdGVtIHRvIG9ubHkgdXBkYXRlIHRleHR1cmUgc3R5bGUgd2hlbiBuZWVkZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXJ0eVN0eWxlSWQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDdXJyZW50bHkgZGVmYXVsdCBjYWNoZSBJRC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jYWNoZUlkID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2VuZXJhbGx5IHNwZWFraW5nIG1lYW5zIHdoZW4gcmVzb3VyY2UgaXMgbG9hZGVkLlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmFsaWQgPSB3aWR0aCA+IDAgJiYgaGVpZ2h0ID4gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNvbGxlY3Rpb24gb2YgYWx0ZXJuYXRpdmUgY2FjaGUgaWRzLCBzaW5jZSBzb21lIEJhc2VUZXh0dXJlc1xuICAgICAgICAgKiBjYW4gaGF2ZSBtb3JlIHRoYW4gb25lIElELCBzaG9ydCBuYW1lIGFuZCBsb25nZXIgZnVsbCBVUkxcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7QXJyYXk8c3RyaW5nPn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRleHR1cmVDYWNoZUlkcyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGbGFnIGlmIEJhc2VUZXh0dXJlIGhhcyBiZWVuIGRlc3Ryb3llZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVzb3VyY2UgdXNlZCBieSB0aGlzIEJhc2VUZXh0dXJlLCB0aGVyZSBjYW4gb25seVxuICAgICAgICAgKiBiZSBvbmUgcmVzb3VyY2UgcGVyIEJhc2VUZXh0dXJlLCBidXQgdGV4dHVyZXMgY2FuIHNoYXJlXG4gICAgICAgICAqIHJlc291cmNlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5yZXNvdXJjZXMuUmVzb3VyY2V9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNvdXJjZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE51bWJlciBvZiB0aGUgdGV4dHVyZSBiYXRjaCwgdXNlZCBieSBtdWx0aS10ZXh0dXJlIHJlbmRlcmVyc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9iYXRjaEVuYWJsZWQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2NhdGlvbiBpbnNpZGUgdGV4dHVyZSBiYXRjaCwgdXNlZCBieSBtdWx0aS10ZXh0dXJlIHJlbmRlcmVyc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9iYXRjaExvY2F0aW9uID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdHMgYSBwYXJ0IG9mIGFub3RoZXIgdGV4dHVyZSwgaGFuZGxlZCBieSBBcnJheVJlc291cmNlIG9yIEN1YmVSZXNvdXJjZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wYXJlbnRUZXh0dXJlQXJyYXkgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCB3aGVuIGEgbm90LWltbWVkaWF0ZWx5LWF2YWlsYWJsZSBzb3VyY2UgZmluaXNoZXMgbG9hZGluZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAZXZlbnQgUElYSS5CYXNlVGV4dHVyZSNsb2FkZWRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIFJlc291cmNlIGxvYWRlZC5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gYSBub3QtaW1tZWRpYXRlbHktYXZhaWxhYmxlIHNvdXJjZSBmYWlscyB0byBsb2FkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBldmVudCBQSVhJLkJhc2VUZXh0dXJlI2Vycm9yXG4gICAgICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBSZXNvdXJjZSBlcnJvcmVkLlxuICAgICAgICAgKiBAcGFyYW0ge0Vycm9yRXZlbnR9IGV2ZW50IC0gTG9hZCBlcnJvciBldmVudC5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gQmFzZVRleHR1cmUgaXMgdXBkYXRlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAZXZlbnQgUElYSS5CYXNlVGV4dHVyZSNsb2FkZWRcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIFJlc291cmNlIGxvYWRlZC5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gQmFzZVRleHR1cmUgaXMgdXBkYXRlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAZXZlbnQgUElYSS5CYXNlVGV4dHVyZSN1cGRhdGVcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIEluc3RhbmNlIG9mIHRleHR1cmUgYmVpbmcgdXBkYXRlZC5cbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gQmFzZVRleHR1cmUgaXMgZGVzdHJveWVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBldmVudCBQSVhJLkJhc2VUZXh0dXJlI2Rpc3Bvc2VcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIEluc3RhbmNlIG9mIHRleHR1cmUgYmVpbmcgZGVzdHJveWVkLlxuICAgICAgICAgKi9cblxuICAgICAgICAvLyBTZXQgdGhlIHJlc291cmNlXG4gICAgICAgIHRoaXMuc2V0UmVzb3VyY2UocmVzb3VyY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBpeGVsIHdpZHRoIG9mIHRoZSBzb3VyY2Ugb2YgdGhpcyB0ZXh0dXJlXG4gICAgICpcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHJlYWxXaWR0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwoKHRoaXMud2lkdGggKiB0aGlzLnJlc29sdXRpb24pIC0gMWUtNCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGl4ZWwgaGVpZ2h0IG9mIHRoZSBzb3VyY2Ugb2YgdGhpcyB0ZXh0dXJlXG4gICAgICpcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHJlYWxIZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKCh0aGlzLmhlaWdodCAqIHRoaXMucmVzb2x1dGlvbikgLSAxZS00KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHN0eWxlIG9wdGlvbnMgb2YgQmFzZVRleHR1cmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5TQ0FMRV9NT0RFU30gW3NjYWxlTW9kZV0gLSBQaXhpIHNjYWxlbW9kZVxuICAgICAqIEBwYXJhbSB7UElYSS5NSVBNQVBfTU9ERVN9IFttaXBtYXBdIC0gZW5hYmxlIG1pcG1hcHNcbiAgICAgKiBAcmV0dXJucyB7UElYSS5CYXNlVGV4dHVyZX0gdGhpc1xuICAgICAqL1xuICAgIHNldFN0eWxlKHNjYWxlTW9kZT86IFNDQUxFX01PREVTLCBtaXBtYXA/OiBNSVBNQVBfTU9ERVMpOiB0aGlzXG4gICAge1xuICAgICAgICBsZXQgZGlydHk7XG5cbiAgICAgICAgaWYgKHNjYWxlTW9kZSAhPT0gdW5kZWZpbmVkICYmIHNjYWxlTW9kZSAhPT0gdGhpcy5zY2FsZU1vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2NhbGVNb2RlID0gc2NhbGVNb2RlO1xuICAgICAgICAgICAgZGlydHkgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1pcG1hcCAhPT0gdW5kZWZpbmVkICYmIG1pcG1hcCAhPT0gdGhpcy5taXBtYXApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubWlwbWFwID0gbWlwbWFwO1xuICAgICAgICAgICAgZGlydHkgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRpcnR5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRpcnR5U3R5bGVJZCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB3L2gvcmVzb2x1dGlvbi4gVGV4dHVyZSBiZWNvbWVzIHZhbGlkIGlmIHdpZHRoIGFuZCBoZWlnaHQgYXJlIGdyZWF0ZXIgdGhhbiB6ZXJvLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gVmlzdWFsIHdpZHRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodCAtIFZpc3VhbCBoZWlnaHRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb25dIC0gT3B0aW9uYWxseSBzZXQgcmVzb2x1dGlvblxuICAgICAqIEByZXR1cm5zIHtQSVhJLkJhc2VUZXh0dXJlfSB0aGlzXG4gICAgICovXG4gICAgc2V0U2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgcmVzb2x1dGlvbj86IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMucmVzb2x1dGlvbiA9IHJlc29sdXRpb24gfHwgdGhpcy5yZXNvbHV0aW9uO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB0aGlzLl9yZWZyZXNoUE9UKCk7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyByZWFsIHNpemUgb2YgYmFzZVRleHR1cmUsIHByZXNlcnZlcyBjdXJyZW50IHJlc29sdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmVhbFdpZHRoIC0gRnVsbCByZW5kZXJlZCB3aWR0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByZWFsSGVpZ2h0IC0gRnVsbCByZW5kZXJlZCBoZWlnaHRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb25dIC0gT3B0aW9uYWxseSBzZXQgcmVzb2x1dGlvblxuICAgICAqIEByZXR1cm5zIHtQSVhJLkJhc2VUZXh0dXJlfSB0aGlzXG4gICAgICovXG4gICAgc2V0UmVhbFNpemUocmVhbFdpZHRoOiBudW1iZXIsIHJlYWxIZWlnaHQ6IG51bWJlciwgcmVzb2x1dGlvbj86IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMucmVzb2x1dGlvbiA9IHJlc29sdXRpb24gfHwgdGhpcy5yZXNvbHV0aW9uO1xuICAgICAgICB0aGlzLndpZHRoID0gcmVhbFdpZHRoIC8gdGhpcy5yZXNvbHV0aW9uO1xuICAgICAgICB0aGlzLmhlaWdodCA9IHJlYWxIZWlnaHQgLyB0aGlzLnJlc29sdXRpb247XG4gICAgICAgIHRoaXMuX3JlZnJlc2hQT1QoKTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWZyZXNoIGNoZWNrIGZvciBpc1Bvd2VyT2ZUd28gdGV4dHVyZSBiYXNlZCBvbiBzaXplXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfcmVmcmVzaFBPVCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmlzUG93ZXJPZlR3byA9IGlzUG93Mih0aGlzLnJlYWxXaWR0aCkgJiYgaXNQb3cyKHRoaXMucmVhbEhlaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyByZXNvbHV0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmVzb2x1dGlvbiAtIHJlc1xuICAgICAqIEByZXR1cm5zIHtQSVhJLkJhc2VUZXh0dXJlfSB0aGlzXG4gICAgICovXG4gICAgc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uOiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICBjb25zdCBvbGRSZXNvbHV0aW9uID0gdGhpcy5yZXNvbHV0aW9uO1xuXG4gICAgICAgIGlmIChvbGRSZXNvbHV0aW9uID09PSByZXNvbHV0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVzb2x1dGlvbiA9IHJlc29sdXRpb247XG5cbiAgICAgICAgaWYgKHRoaXMudmFsaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLndpZHRoICogb2xkUmVzb2x1dGlvbiAvIHJlc29sdXRpb247XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuaGVpZ2h0ICogb2xkUmVzb2x1dGlvbiAvIHJlc29sdXRpb247XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZScsIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcmVmcmVzaFBPVCgpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHJlc291cmNlIGlmIGl0IHdhc24ndCBzZXQuIFRocm93cyBlcnJvciBpZiByZXNvdXJjZSBhbHJlYWR5IHByZXNlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5yZXNvdXJjZXMuUmVzb3VyY2V9IHJlc291cmNlIC0gdGhhdCBpcyBtYW5hZ2luZyB0aGlzIEJhc2VUZXh0dXJlXG4gICAgICogQHJldHVybnMge1BJWEkuQmFzZVRleHR1cmV9IHRoaXNcbiAgICAgKi9cbiAgICBzZXRSZXNvdXJjZShyZXNvdXJjZTogUmVzb3VyY2UpOiB0aGlzXG4gICAge1xuICAgICAgICBpZiAodGhpcy5yZXNvdXJjZSA9PT0gcmVzb3VyY2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmVzb3VyY2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzb3VyY2UgY2FuIGJlIHNldCBvbmx5IG9uY2UnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc291cmNlLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5yZXNvdXJjZSA9IHJlc291cmNlO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEludmFsaWRhdGVzIHRoZSBvYmplY3QuIFRleHR1cmUgYmVjb21lcyB2YWxpZCBpZiB3aWR0aCBhbmQgaGVpZ2h0IGFyZSBncmVhdGVyIHRoYW4gemVyby5cbiAgICAgKi9cbiAgICB1cGRhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy53aWR0aCA+IDAgJiYgdGhpcy5oZWlnaHQgPiAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnbG9hZGVkJywgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0KCd1cGRhdGUnLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGlydHlJZCsrO1xuICAgICAgICAgICAgdGhpcy5kaXJ0eVN0eWxlSWQrKztcbiAgICAgICAgICAgIHRoaXMuZW1pdCgndXBkYXRlJywgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZXJyb3JzIHdpdGggcmVzb3VyY2VzLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtFcnJvckV2ZW50fSBldmVudCAtIEVycm9yIGV2ZW50IGVtaXR0ZWQuXG4gICAgICovXG4gICAgb25FcnJvcihldmVudDogRXJyb3JFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCB0aGlzLCBldmVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhpcyBiYXNlIHRleHR1cmUuXG4gICAgICogVGhlIG1ldGhvZCBzdG9wcyBpZiByZXNvdXJjZSBkb2Vzbid0IHdhbnQgdGhpcyB0ZXh0dXJlIHRvIGJlIGRlc3Ryb3llZC5cbiAgICAgKiBSZW1vdmVzIHRleHR1cmUgZnJvbSBhbGwgY2FjaGVzLlxuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gcmVtb3ZlIGFuZCBkZXN0cm95IHRoZSByZXNvdXJjZVxuICAgICAgICBpZiAodGhpcy5yZXNvdXJjZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZS51bmJpbmQodGhpcyk7XG4gICAgICAgICAgICAvLyBvbmx5IGRlc3Ryb3kgcmVzb3VyY2VkIGNyZWF0ZWQgaW50ZXJuYWxseVxuICAgICAgICAgICAgaWYgKHRoaXMucmVzb3VyY2UuaW50ZXJuYWwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvdXJjZS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmNhY2hlSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlbGV0ZSBCYXNlVGV4dHVyZUNhY2hlW3RoaXMuY2FjaGVJZF07XG4gICAgICAgICAgICBkZWxldGUgVGV4dHVyZUNhY2hlW3RoaXMuY2FjaGVJZF07XG5cbiAgICAgICAgICAgIHRoaXMuY2FjaGVJZCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaW5hbGx5IGxldCB0aGUgV2ViR0wgcmVuZGVyZXIga25vdy4uXG4gICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuXG4gICAgICAgIEJhc2VUZXh0dXJlLnJlbW92ZUZyb21DYWNoZSh0aGlzKTtcbiAgICAgICAgdGhpcy50ZXh0dXJlQ2FjaGVJZHMgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGcmVlcyB0aGUgdGV4dHVyZSBmcm9tIFdlYkdMIG1lbW9yeSB3aXRob3V0IGRlc3Ryb3lpbmcgdGhpcyB0ZXh0dXJlIG9iamVjdC5cbiAgICAgKiBUaGlzIG1lYW5zIHlvdSBjYW4gc3RpbGwgdXNlIHRoZSB0ZXh0dXJlIGxhdGVyIHdoaWNoIHdpbGwgdXBsb2FkIGl0IHRvIEdQVVxuICAgICAqIG1lbW9yeSBhZ2Fpbi5cbiAgICAgKlxuICAgICAqIEBmaXJlcyBQSVhJLkJhc2VUZXh0dXJlI2Rpc3Bvc2VcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZW1pdCgnZGlzcG9zZScsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIEJhc2VUZXh0dXJlfFRleHR1cmUgY2FzdFxuICAgICAqL1xuICAgIGNhc3RUb0Jhc2VUZXh0dXJlKCk6IEJhc2VUZXh0dXJlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGEgYmFzZSB0ZXh0dXJlIGJhc2VkIG9uIHRoZSBzb3VyY2UgeW91IHByb3ZpZGUuXG4gICAgICogVGhlIHNvdXJjZSBjYW4gYmUgLSBpbWFnZSB1cmwsIGltYWdlIGVsZW1lbnQsIGNhbnZhcyBlbGVtZW50LiBJZiB0aGVcbiAgICAgKiBzb3VyY2UgaXMgYW4gaW1hZ2UgdXJsIG9yIGFuIGltYWdlIGVsZW1lbnQgYW5kIG5vdCBpbiB0aGUgYmFzZSB0ZXh0dXJlXG4gICAgICogY2FjaGUsIGl0IHdpbGwgYmUgY3JlYXRlZCBhbmQgbG9hZGVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfEhUTUxJbWFnZUVsZW1lbnR8SFRNTENhbnZhc0VsZW1lbnR8U1ZHRWxlbWVudHxIVE1MVmlkZW9FbGVtZW50fSBzb3VyY2UgLSBUaGVcbiAgICAgKiAgICAgICAgc291cmNlIHRvIGNyZWF0ZSBiYXNlIHRleHR1cmUgZnJvbS5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIFNlZSB7QGxpbmsgUElYSS5CYXNlVGV4dHVyZX0ncyBjb25zdHJ1Y3RvciBmb3Igb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzdHJpY3RdIC0gRW5mb3JjZSBzdHJpY3QtbW9kZSwgc2VlIHtAbGluayBQSVhJLnNldHRpbmdzLlNUUklDVF9URVhUVVJFX0NBQ0hFfS5cbiAgICAgKiBAcmV0dXJucyB7UElYSS5CYXNlVGV4dHVyZX0gVGhlIG5ldyBiYXNlIHRleHR1cmUuXG4gICAgICovXG4gICAgc3RhdGljIGZyb20oc291cmNlOiBJbWFnZVNvdXJjZXxzdHJpbmcsIG9wdGlvbnM6IElCYXNlVGV4dHVyZU9wdGlvbnMsXG4gICAgICAgIHN0cmljdCA9IHNldHRpbmdzLlNUUklDVF9URVhUVVJFX0NBQ0hFKTogQmFzZVRleHR1cmVcbiAgICB7XG4gICAgICAgIGNvbnN0IGlzRnJhbWUgPSB0eXBlb2Ygc291cmNlID09PSAnc3RyaW5nJztcbiAgICAgICAgbGV0IGNhY2hlSWQgPSBudWxsO1xuXG4gICAgICAgIGlmIChpc0ZyYW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICBjYWNoZUlkID0gc291cmNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCEoc291cmNlIGFzIGFueSkuX3BpeGlJZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAoc291cmNlIGFzIGFueSkuX3BpeGlJZCA9IGBwaXhpaWRfJHt1aWQoKX1gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYWNoZUlkID0gKHNvdXJjZSBhcyBhbnkpLl9waXhpSWQ7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgYmFzZVRleHR1cmUgPSBCYXNlVGV4dHVyZUNhY2hlW2NhY2hlSWRdO1xuXG4gICAgICAgIC8vIFN0cmljdC1tb2RlIHJlamVjdHMgaW52YWxpZCBjYWNoZUlkc1xuICAgICAgICBpZiAoaXNGcmFtZSAmJiBzdHJpY3QgJiYgIWJhc2VUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBjYWNoZUlkIFwiJHtjYWNoZUlkfVwiIGRvZXMgbm90IGV4aXN0IGluIEJhc2VUZXh0dXJlQ2FjaGUuYCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWJhc2VUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICBiYXNlVGV4dHVyZSA9IG5ldyBCYXNlVGV4dHVyZShzb3VyY2UsIG9wdGlvbnMpO1xuICAgICAgICAgICAgYmFzZVRleHR1cmUuY2FjaGVJZCA9IGNhY2hlSWQ7XG4gICAgICAgICAgICBCYXNlVGV4dHVyZS5hZGRUb0NhY2hlKGJhc2VUZXh0dXJlLCBjYWNoZUlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBiYXNlVGV4dHVyZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgQmFzZVRleHR1cmUgd2l0aCBhIEJ1ZmZlclJlc291cmNlIGZyb20gYSBGbG9hdDMyQXJyYXkuXG4gICAgICogUkdCQSB2YWx1ZXMgYXJlIGZsb2F0cyBmcm9tIDAgdG8gMS5cbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl8VWludDhBcnJheX0gYnVmZmVyIC0gVGhlIG9wdGlvbmFsIGFycmF5IHRvIHVzZSwgaWYgbm8gZGF0YVxuICAgICAqICAgICAgICBpcyBwcm92aWRlZCwgYSBuZXcgRmxvYXQzMkFycmF5IGlzIGNyZWF0ZWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gV2lkdGggb2YgdGhlIHJlc291cmNlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodCAtIEhlaWdodCBvZiB0aGUgcmVzb3VyY2VcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIFNlZSB7QGxpbmsgUElYSS5CYXNlVGV4dHVyZX0ncyBjb25zdHJ1Y3RvciBmb3Igb3B0aW9ucy5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkJhc2VUZXh0dXJlfSBUaGUgcmVzdWx0aW5nIG5ldyBCYXNlVGV4dHVyZVxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tQnVmZmVyKGJ1ZmZlcjogRmxvYXQzMkFycmF5fFVpbnQ4QXJyYXksXG4gICAgICAgIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBvcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zKTogQmFzZVRleHR1cmVcbiAgICB7XG4gICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciB8fCBuZXcgRmxvYXQzMkFycmF5KHdpZHRoICogaGVpZ2h0ICogNCk7XG5cbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSBuZXcgQnVmZmVyUmVzb3VyY2UoYnVmZmVyLCB7IHdpZHRoLCBoZWlnaHQgfSk7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBidWZmZXIgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkgPyBUWVBFUy5GTE9BVCA6IFRZUEVTLlVOU0lHTkVEX0JZVEU7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBCYXNlVGV4dHVyZShyZXNvdXJjZSwgT2JqZWN0LmFzc2lnbihkZWZhdWx0QnVmZmVyT3B0aW9ucywgb3B0aW9ucyB8fCB7IHdpZHRoLCBoZWlnaHQsIHR5cGUgfSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBCYXNlVGV4dHVyZSB0byB0aGUgZ2xvYmFsIEJhc2VUZXh0dXJlQ2FjaGUuIFRoaXMgY2FjaGUgaXMgc2hhcmVkIGFjcm9zcyB0aGUgd2hvbGUgUElYSSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZSAtIFRoZSBCYXNlVGV4dHVyZSB0byBhZGQgdG8gdGhlIGNhY2hlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIFRoZSBpZCB0aGF0IHRoZSBCYXNlVGV4dHVyZSB3aWxsIGJlIHN0b3JlZCBhZ2FpbnN0LlxuICAgICAqL1xuICAgIHN0YXRpYyBhZGRUb0NhY2hlKGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSwgaWQ6IHN0cmluZyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChpZClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGJhc2VUZXh0dXJlLnRleHR1cmVDYWNoZUlkcy5pbmRleE9mKGlkKSA9PT0gLTEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmFzZVRleHR1cmUudGV4dHVyZUNhY2hlSWRzLnB1c2goaWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoQmFzZVRleHR1cmVDYWNoZVtpZF0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEJhc2VUZXh0dXJlIGFkZGVkIHRvIHRoZSBjYWNoZSB3aXRoIGFuIGlkIFske2lkfV0gdGhhdCBhbHJlYWR5IGhhZCBhbiBlbnRyeWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBCYXNlVGV4dHVyZUNhY2hlW2lkXSA9IGJhc2VUZXh0dXJlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgQmFzZVRleHR1cmUgZnJvbSB0aGUgZ2xvYmFsIEJhc2VUZXh0dXJlQ2FjaGUuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd8UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBpZCBvZiBhIEJhc2VUZXh0dXJlIHRvIGJlIHJlbW92ZWQsIG9yIGEgQmFzZVRleHR1cmUgaW5zdGFuY2UgaXRzZWxmLlxuICAgICAqIEByZXR1cm4ge1BJWEkuQmFzZVRleHR1cmV8bnVsbH0gVGhlIEJhc2VUZXh0dXJlIHRoYXQgd2FzIHJlbW92ZWQuXG4gICAgICovXG4gICAgc3RhdGljIHJlbW92ZUZyb21DYWNoZShiYXNlVGV4dHVyZTogc3RyaW5nIHwgQmFzZVRleHR1cmUpOiBCYXNlVGV4dHVyZXxudWxsXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIGJhc2VUZXh0dXJlID09PSAnc3RyaW5nJylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYmFzZVRleHR1cmVGcm9tQ2FjaGUgPSBCYXNlVGV4dHVyZUNhY2hlW2Jhc2VUZXh0dXJlXTtcblxuICAgICAgICAgICAgaWYgKGJhc2VUZXh0dXJlRnJvbUNhY2hlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gYmFzZVRleHR1cmVGcm9tQ2FjaGUudGV4dHVyZUNhY2hlSWRzLmluZGV4T2YoYmFzZVRleHR1cmUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZUZyb21DYWNoZS50ZXh0dXJlQ2FjaGVJZHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkZWxldGUgQmFzZVRleHR1cmVDYWNoZVtiYXNlVGV4dHVyZV07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZVRleHR1cmVGcm9tQ2FjaGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYmFzZVRleHR1cmUgJiYgYmFzZVRleHR1cmUudGV4dHVyZUNhY2hlSWRzKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhc2VUZXh0dXJlLnRleHR1cmVDYWNoZUlkcy5sZW5ndGg7ICsraSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgQmFzZVRleHR1cmVDYWNoZVtiYXNlVGV4dHVyZS50ZXh0dXJlQ2FjaGVJZHNbaV1dO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBiYXNlVGV4dHVyZS50ZXh0dXJlQ2FjaGVJZHMubGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgcmV0dXJuIGJhc2VUZXh0dXJlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2xvYmFsIG51bWJlciBvZiB0aGUgdGV4dHVyZSBiYXRjaCwgdXNlZCBieSBtdWx0aS10ZXh0dXJlIHJlbmRlcmVyc1xuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBzdGF0aWMgX2dsb2JhbEJhdGNoID0gMDtcbn1cbiIsICJpbXBvcnQgeyBSZXNvdXJjZSB9IGZyb20gJy4vUmVzb3VyY2UnO1xuaW1wb3J0IHsgQmFzZVRleHR1cmUgfSBmcm9tICcuLi9CYXNlVGV4dHVyZSc7XG5pbXBvcnQgeyBJU2l6ZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgYXV0b0RldGVjdFJlc291cmNlLCBJQXV0b0RldGVjdE9wdGlvbnMgfSBmcm9tICcuL2F1dG9EZXRlY3RSZXNvdXJjZSc7XG5cbi8qKlxuICogUmVzb3VyY2UgdGhhdCBjYW4gbWFuYWdlIHNldmVyYWwgcmVzb3VyY2UgKGl0ZW1zKSBpbnNpZGUuXG4gKiBBbGwgcmVzb3VyY2VzIG5lZWQgdG8gaGF2ZSB0aGUgc2FtZSBwaXhlbCBzaXplLlxuICogUGFyZW50IGNsYXNzIGZvciBDdWJlUmVzb3VyY2UgYW5kIEFycmF5UmVzb3VyY2VcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkucmVzb3VyY2VzLlJlc291cmNlXG4gKiBAbWVtYmVyb2YgUElYSS5yZXNvdXJjZXNcbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gT3B0aW9ucyB0byBmb3IgUmVzb3VyY2UgY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aF0gLSBXaWR0aCBvZiB0aGUgcmVzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5oZWlnaHRdIC0gSGVpZ2h0IG9mIHRoZSByZXNvdXJjZVxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RNdWx0aVJlc291cmNlIGV4dGVuZHMgUmVzb3VyY2VcbntcbiAgICByZWFkb25seSBsZW5ndGg6IG51bWJlcjtcbiAgICBpdGVtczogQXJyYXk8QmFzZVRleHR1cmU+O1xuICAgIGl0ZW1EaXJ0eUlkczogQXJyYXk8bnVtYmVyPjtcbiAgICBwcml2YXRlIF9sb2FkOiBQcm9taXNlPHRoaXM+O1xuXG4gICAgYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlO1xuXG4gICAgY29uc3RydWN0b3IobGVuZ3RoOiBudW1iZXIsIG9wdGlvbnM/OiBJU2l6ZSlcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICBzdXBlcih3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbGxlY3Rpb24gb2YgcGFydGlhbCBiYXNlVGV4dHVyZXMgdGhhdCBjb3JyZXNwb25kIHRvIHJlc291cmNlc1xuICAgICAgICAgKiBAbWVtYmVyIHtBcnJheTxQSVhJLkJhc2VUZXh0dXJlPn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpcnR5IElEcyBmb3IgZWFjaCBwYXJ0XG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5PG51bWJlcj59XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdGVtRGlydHlJZHMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwYXJ0VGV4dHVyZSA9IG5ldyBCYXNlVGV4dHVyZSgpO1xuXG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2gocGFydFRleHR1cmUpO1xuICAgICAgICAgICAgLy8gLTIgLSBmaXJzdCBydW4gb2YgdGV4dHVyZSBhcnJheSB1cGxvYWRcbiAgICAgICAgICAgIC8vIC0xIC0gdGV4dHVyZSBpdGVtIHdhcyBhbGxvY2F0ZWRcbiAgICAgICAgICAgIC8vID49MCAtIHRleHR1cmUgaXRlbSB1cGxvYWRlZCAsIGluIHN5bmMgd2l0aCBpdGVtc1tpXS5kaXJ0eUlkXG4gICAgICAgICAgICB0aGlzLml0ZW1EaXJ0eUlkcy5wdXNoKC0yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBOdW1iZXIgb2YgZWxlbWVudHMgaW4gYXJyYXlcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcm9taXNlIHdoZW4gbG9hZGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtQcm9taXNlfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAZGVmYXVsdCBudWxsXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9sb2FkID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQm91bmQgYmFzZVRleHR1cmUsIHRoZXJlIGNhbiBvbmx5IGJlIG9uZVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5iYXNlVGV4dHVyZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdXNlZCBmcm9tIEFycmF5UmVzb3VyY2UgYW5kIEN1YmVSZXNvdXJjZSBjb25zdHJ1Y3RvcnNcbiAgICAgKiBAcGFyYW0ge0FycmF5PCo+fSByZXNvdXJjZXMgLSBDYW4gYmUgcmVzb3VyY2VzLCBpbWFnZSBlbGVtZW50cywgY2FudmFzLCBldGMuICxcbiAgICAgKiAgbGVuZ3RoIHNob3VsZCBiZSBzYW1lIGFzIGNvbnN0cnVjdG9yIGxlbmd0aFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBkZXRlY3Qgb3B0aW9ucyBmb3IgcmVzb3VyY2VzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBpbml0RnJvbUFycmF5KHJlc291cmNlczogQXJyYXk8YW55Piwgb3B0aW9ucz86IElBdXRvRGV0ZWN0T3B0aW9ucyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFyZXNvdXJjZXNbaV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzb3VyY2VzW2ldLmNhc3RUb0Jhc2VUZXh0dXJlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmFzZVRleHR1cmVBdChyZXNvdXJjZXNbaV0uY2FzdFRvQmFzZVRleHR1cmUoKSwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyZXNvdXJjZXNbaV0gaW5zdGFuY2VvZiBSZXNvdXJjZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlQXQocmVzb3VyY2VzW2ldLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlQXQoYXV0b0RldGVjdFJlc291cmNlKHJlc291cmNlc1tpXSwgb3B0aW9ucyksIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveSB0aGlzIEJhc2VJbWFnZVJlc291cmNlXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgZGlzcG9zZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdGhpcy5sZW5ndGg7IGkgPCBsZW47IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtcyA9IG51bGw7XG4gICAgICAgIHRoaXMuaXRlbURpcnR5SWRzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbG9hZCA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGEgYmFzZVRleHR1cmUgYnkgSURcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBaZXJvLWJhc2VkIGluZGV4IG9mIHJlc291cmNlIHRvIHNldFxuICAgICAqIEByZXR1cm4ge1BJWEkucmVzb3VyY2VzLkFic3RyYWN0TXVsdGlSZXNvdXJjZX0gSW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAgICovXG4gICAgYWJzdHJhY3QgYWRkQmFzZVRleHR1cmVBdChiYXNlVGV4dHVyZTogQmFzZVRleHR1cmUsIGluZGV4OiBudW1iZXIpOiB0aGlzO1xuXG4gICAgLyoqXG4gICAgICogU2V0IGEgcmVzb3VyY2UgYnkgSURcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5yZXNvdXJjZXMuUmVzb3VyY2V9IHJlc291cmNlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gWmVyby1iYXNlZCBpbmRleCBvZiByZXNvdXJjZSB0byBzZXRcbiAgICAgKiBAcmV0dXJuIHtQSVhJLnJlc291cmNlcy5BcnJheVJlc291cmNlfSBJbnN0YW5jZSBmb3IgY2hhaW5pbmdcbiAgICAgKi9cbiAgICBhZGRSZXNvdXJjZUF0KHJlc291cmNlOiBSZXNvdXJjZSwgaW5kZXg6IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5pdGVtc1tpbmRleF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5kZXggJHtpbmRleH0gaXMgb3V0IG9mIGJvdW5kc2ApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5oZXJpdCB0aGUgZmlyc3QgcmVzb3VyY2UgZGltZW5zaW9uc1xuICAgICAgICBpZiAocmVzb3VyY2UudmFsaWQgJiYgIXRoaXMudmFsaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmVzaXplKHJlc291cmNlLndpZHRoLCByZXNvdXJjZS5oZWlnaHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pdGVtc1tpbmRleF0uc2V0UmVzb3VyY2UocmVzb3VyY2UpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgcGFyZW50IGJhc2UgdGV4dHVyZVxuICAgICAqIEBtZW1iZXIge1BJWEkuQmFzZVRleHR1cmV9XG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgYmluZChiYXNlVGV4dHVyZTogQmFzZVRleHR1cmUpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5iYXNlVGV4dHVyZSAhPT0gbnVsbClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IG9uZSBiYXNlIHRleHR1cmUgcGVyIFRleHR1cmVBcnJheSBpcyBhbGxvd2VkJyk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuYmluZChiYXNlVGV4dHVyZSk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zW2ldLnBhcmVudFRleHR1cmVBcnJheSA9IGJhc2VUZXh0dXJlO1xuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXS5vbigndXBkYXRlJywgYmFzZVRleHR1cmUudXBkYXRlLCBiYXNlVGV4dHVyZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVbnNldCB0aGUgcGFyZW50IGJhc2UgdGV4dHVyZVxuICAgICAqIEBtZW1iZXIge1BJWEkuQmFzZVRleHR1cmV9XG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgdW5iaW5kKGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLnVuYmluZChiYXNlVGV4dHVyZSk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zW2ldLnBhcmVudFRleHR1cmVBcnJheSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLml0ZW1zW2ldLm9mZigndXBkYXRlJywgYmFzZVRleHR1cmUudXBkYXRlLCBiYXNlVGV4dHVyZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGFsbCB0aGUgcmVzb3VyY2VzIHNpbXVsdGFuZW91c2x5XG4gICAgICogQG92ZXJyaWRlXG4gICAgICogQHJldHVybiB7UHJvbWlzZTx2b2lkPn0gV2hlbiBsb2FkIGlzIHJlc29sdmVkXG4gICAgICovXG4gICAgbG9hZCgpOiBQcm9taXNlPHRoaXM+XG4gICAge1xuICAgICAgICBpZiAodGhpcy5fbG9hZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLml0ZW1zLm1hcCgoaXRlbSkgPT4gaXRlbS5yZXNvdXJjZSkuZmlsdGVyKChpdGVtKSA9PiBpdGVtKTtcblxuICAgICAgICAvLyBUT0RPOiBhbHNvIGltcGxlbWVudCBsb2FkIHBhcnQtYnktcGFydCBzdHJhdGVneVxuICAgICAgICBjb25zdCBwcm9taXNlcyA9IHJlc291cmNlcy5tYXAoKGl0ZW0pID0+IGl0ZW0ubG9hZCgpKTtcblxuICAgICAgICB0aGlzLl9sb2FkID0gUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAgICAgICAudGhlbigoKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgcmVhbFdpZHRoLCByZWFsSGVpZ2h0IH0gPSB0aGlzLml0ZW1zWzBdO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemUocmVhbFdpZHRoLCByZWFsSGVpZ2h0KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9sb2FkO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBYnN0cmFjdE11bHRpUmVzb3VyY2UgfSBmcm9tICcuL0Fic3RyYWN0TXVsdGlSZXNvdXJjZSc7XG5pbXBvcnQgeyBUQVJHRVRTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vQmFzZVRleHR1cmUnO1xuXG5pbXBvcnQgdHlwZSB7IEJhc2VJbWFnZVJlc291cmNlIH0gZnJvbSAnLi9CYXNlSW1hZ2VSZXNvdXJjZSc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBHTFRleHR1cmUgfSBmcm9tICcuLi9HTFRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBJU2l6ZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG4vKipcbiAqIEEgcmVzb3VyY2UgdGhhdCBjb250YWlucyBhIG51bWJlciBvZiBzb3VyY2VzLlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5yZXNvdXJjZXMuUmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICogQHBhcmFtIHtudW1iZXJ8QXJyYXk8Kj59IHNvdXJjZSAtIE51bWJlciBvZiBpdGVtcyBpbiBhcnJheSBvciB0aGUgY29sbGVjdGlvblxuICogICAgICAgIG9mIGltYWdlIFVSTHMgdG8gdXNlLiBDYW4gYWxzbyBiZSByZXNvdXJjZXMsIGltYWdlIGVsZW1lbnRzLCBjYW52YXMsIGV0Yy5cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBPcHRpb25zIHRvIGFwcGx5IHRvIHtAbGluayBQSVhJLnJlc291cmNlcy5hdXRvRGV0ZWN0UmVzb3VyY2V9XG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGhdIC0gV2lkdGggb2YgdGhlIHJlc291cmNlXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuaGVpZ2h0XSAtIEhlaWdodCBvZiB0aGUgcmVzb3VyY2VcbiAqL1xuZXhwb3J0IGNsYXNzIEFycmF5UmVzb3VyY2UgZXh0ZW5kcyBBYnN0cmFjdE11bHRpUmVzb3VyY2VcbntcbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2U6IG51bWJlcnxBcnJheTxhbnk+LCBvcHRpb25zPzogSVNpemUpXG4gICAge1xuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgICAgbGV0IHVybHM7XG4gICAgICAgIGxldCBsZW5ndGg6IG51bWJlcjtcblxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2UpKVxuICAgICAgICB7XG4gICAgICAgICAgICB1cmxzID0gc291cmNlO1xuICAgICAgICAgICAgbGVuZ3RoID0gc291cmNlLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IHNvdXJjZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyKGxlbmd0aCwgeyB3aWR0aCwgaGVpZ2h0IH0pO1xuXG4gICAgICAgIGlmICh1cmxzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmluaXRGcm9tQXJyYXkodXJscywgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IGEgYmFzZVRleHR1cmUgYnkgSUQsXG4gICAgICogQXJyYXlSZXNvdXJjZSBqdXN0IHRha2VzIHJlc291cmNlIGZyb20gaXQsIG5vdGhpbmcgbW9yZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSBiYXNlVGV4dHVyZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFplcm8tYmFzZWQgaW5kZXggb2YgcmVzb3VyY2UgdG8gc2V0XG4gICAgICogQHJldHVybiB7UElYSS5yZXNvdXJjZXMuQXJyYXlSZXNvdXJjZX0gSW5zdGFuY2UgZm9yIGNoYWluaW5nXG4gICAgICovXG4gICAgYWRkQmFzZVRleHR1cmVBdChiYXNlVGV4dHVyZTogQmFzZVRleHR1cmUsIGluZGV4OiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICBpZiAoYmFzZVRleHR1cmUucmVzb3VyY2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VBdChiYXNlVGV4dHVyZS5yZXNvdXJjZSwgaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcnJheVJlc291cmNlIGRvZXMgbm90IHN1cHBvcnQgUmVuZGVyVGV4dHVyZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGJpbmRpbmdcbiAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlfVxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGJpbmQoYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuYmluZChiYXNlVGV4dHVyZSk7XG5cbiAgICAgICAgYmFzZVRleHR1cmUudGFyZ2V0ID0gVEFSR0VUUy5URVhUVVJFXzJEX0FSUkFZO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZCB0aGUgcmVzb3VyY2VzIHRvIHRoZSBHUFUuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gdGV4dHVyZVxuICAgICAqIEBwYXJhbSB7UElYSS5HTFRleHR1cmV9IGdsVGV4dHVyZVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB3aGV0aGVyIHRleHR1cmUgd2FzIHVwbG9hZGVkXG4gICAgICovXG4gICAgdXBsb2FkKHJlbmRlcmVyOiBSZW5kZXJlciwgdGV4dHVyZTogQmFzZVRleHR1cmUsIGdsVGV4dHVyZTogR0xUZXh0dXJlKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgY29uc3QgeyBsZW5ndGgsIGl0ZW1EaXJ0eUlkcywgaXRlbXMgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHJlbmRlcmVyO1xuXG4gICAgICAgIGlmIChnbFRleHR1cmUuZGlydHlJZCA8IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLnRleEltYWdlM0QoXG4gICAgICAgICAgICAgICAgZ2wuVEVYVFVSRV8yRF9BUlJBWSxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIHRleHR1cmUuZm9ybWF0LFxuICAgICAgICAgICAgICAgIHRoaXMuX3dpZHRoLFxuICAgICAgICAgICAgICAgIHRoaXMuX2hlaWdodCxcbiAgICAgICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlLmZvcm1hdCxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgbnVsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpXTtcblxuICAgICAgICAgICAgaWYgKGl0ZW1EaXJ0eUlkc1tpXSA8IGl0ZW0uZGlydHlJZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpdGVtRGlydHlJZHNbaV0gPSBpdGVtLmRpcnR5SWQ7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0udmFsaWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBnbC50ZXhTdWJJbWFnZTNEKFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2wuVEVYVFVSRV8yRF9BUlJBWSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAwLCAvLyB4b2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICAwLCAvLyB5b2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBpLCAvLyB6b2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnJlc291cmNlLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5yZXNvdXJjZS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZS5mb3JtYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAoaXRlbS5yZXNvdXJjZSBhcyBCYXNlSW1hZ2VSZXNvdXJjZSkuc291cmNlXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnLi9SZXNvdXJjZSc7XG5pbXBvcnQgeyBkZXRlcm1pbmVDcm9zc09yaWdpbiB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IEFMUEhBX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuaW1wb3J0IHR5cGUgeyBCYXNlVGV4dHVyZSwgSW1hZ2VTb3VyY2UgfSBmcm9tICcuLi9CYXNlVGV4dHVyZSc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBHTFRleHR1cmUgfSBmcm9tICcuLi9HTFRleHR1cmUnO1xuLyoqXG4gKiBCYXNlIGZvciBhbGwgdGhlIGltYWdlL2NhbnZhcyByZXNvdXJjZXNcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5yZXNvdXJjZXMuUmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICovXG5leHBvcnQgY2xhc3MgQmFzZUltYWdlUmVzb3VyY2UgZXh0ZW5kcyBSZXNvdXJjZVxue1xuICAgIHB1YmxpYyBzb3VyY2U6IEltYWdlU291cmNlO1xuICAgIHB1YmxpYyBub1N1YkltYWdlOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtIVE1MSW1hZ2VFbGVtZW50fEhUTUxDYW52YXNFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnR8U1ZHRWxlbWVudH0gc291cmNlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc291cmNlOiBJbWFnZVNvdXJjZSlcbiAgICB7XG4gICAgICAgIGNvbnN0IHNvdXJjZUFueSA9IHNvdXJjZSBhcyBhbnk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gc291cmNlQW55Lm5hdHVyYWxXaWR0aCB8fCBzb3VyY2VBbnkudmlkZW9XaWR0aCB8fCBzb3VyY2VBbnkud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHNvdXJjZUFueS5uYXR1cmFsSGVpZ2h0IHx8IHNvdXJjZUFueS52aWRlb0hlaWdodCB8fCBzb3VyY2VBbnkuaGVpZ2h0O1xuXG4gICAgICAgIHN1cGVyKHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc291cmNlIGVsZW1lbnRcbiAgICAgICAgICogQG1lbWJlciB7SFRNTEltYWdlRWxlbWVudHxIVE1MQ2FudmFzRWxlbWVudHxIVE1MVmlkZW9FbGVtZW50fFNWR0VsZW1lbnR9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHNldCB0byBgdHJ1ZWAsIHdpbGwgZm9yY2UgYHRleEltYWdlMkRgIG92ZXIgYHRleFN1YkltYWdlMkRgIGZvciB1cGxvYWRpbmcuXG4gICAgICAgICAqIENlcnRhaW4gdHlwZXMgb2YgbWVkaWEgKGUuZy4gdmlkZW8pIHVzaW5nIGB0ZXhJbWFnZTJEYCBpcyBtb3JlIHBlcmZvcm1hbnQuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5vU3ViSW1hZ2UgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY3Jvc3Mgb3JpZ2luIGJhc2VkIGRldGVjdGluZyB0aGUgdXJsIGFuZCB0aGUgY3Jvc3NvcmlnaW5cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudCAtIEVsZW1lbnQgdG8gYXBwbHkgY3Jvc3NPcmlnaW5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVVJMIHRvIGNoZWNrXG4gICAgICogQHBhcmFtIHtib29sZWFufHN0cmluZ30gW2Nyb3Nzb3JpZ2luPXRydWVdIC0gQ3Jvc3Mgb3JpZ2luIHZhbHVlIHRvIHVzZVxuICAgICAqL1xuICAgIHN0YXRpYyBjcm9zc09yaWdpbihlbGVtZW50OiBIVE1MSW1hZ2VFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnQsIHVybDogc3RyaW5nLCBjcm9zc29yaWdpbjogYm9vbGVhbnxzdHJpbmcpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoY3Jvc3NvcmlnaW4gPT09IHVuZGVmaW5lZCAmJiB1cmwuaW5kZXhPZignZGF0YTonKSAhPT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgZWxlbWVudC5jcm9zc09yaWdpbiA9IGRldGVybWluZUNyb3NzT3JpZ2luKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3Jvc3NvcmlnaW4gIT09IGZhbHNlKVxuICAgICAgICB7XG4gICAgICAgICAgICBlbGVtZW50LmNyb3NzT3JpZ2luID0gdHlwZW9mIGNyb3Nzb3JpZ2luID09PSAnc3RyaW5nJyA/IGNyb3Nzb3JpZ2luIDogJ2Fub255bW91cyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGxvYWQgdGhlIHRleHR1cmUgdG8gdGhlIEdQVS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVXBsb2FkIHRvIHRoZSByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBSZWZlcmVuY2UgdG8gcGFyZW50IHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0xUZXh0dXJlfSBnbFRleHR1cmVcbiAgICAgKiBAcGFyYW0ge0hUTUxJbWFnZUVsZW1lbnR8SFRNTENhbnZhc0VsZW1lbnR8SFRNTFZpZGVvRWxlbWVudHxTVkdFbGVtZW50fSBbc291cmNlXSAob3B0aW9uYWwpXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaXMgc3VjY2Vzc1xuICAgICAqL1xuICAgIHVwbG9hZChyZW5kZXJlcjogUmVuZGVyZXIsIGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSwgZ2xUZXh0dXJlOiBHTFRleHR1cmUsIHNvdXJjZT86IEltYWdlU291cmNlKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgY29uc3QgZ2wgPSByZW5kZXJlci5nbDtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBiYXNlVGV4dHVyZS5yZWFsV2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGJhc2VUZXh0dXJlLnJlYWxIZWlnaHQ7XG5cbiAgICAgICAgc291cmNlID0gc291cmNlIHx8IHRoaXMuc291cmNlO1xuXG4gICAgICAgIGdsLnBpeGVsU3RvcmVpKGdsLlVOUEFDS19QUkVNVUxUSVBMWV9BTFBIQV9XRUJHTCwgYmFzZVRleHR1cmUuYWxwaGFNb2RlID09PSBBTFBIQV9NT0RFUy5VTlBBQ0spO1xuXG4gICAgICAgIGlmICghdGhpcy5ub1N1YkltYWdlXG4gICAgICAgICAgICAmJiBiYXNlVGV4dHVyZS50YXJnZXQgPT09IGdsLlRFWFRVUkVfMkRcbiAgICAgICAgICAgICYmIGdsVGV4dHVyZS53aWR0aCA9PT0gd2lkdGhcbiAgICAgICAgICAgICYmIGdsVGV4dHVyZS5oZWlnaHQgPT09IGhlaWdodClcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wudGV4U3ViSW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCAwLCAwLCBiYXNlVGV4dHVyZS5mb3JtYXQsIGJhc2VUZXh0dXJlLnR5cGUsIHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBnbFRleHR1cmUud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIGdsVGV4dHVyZS5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgIGdsLnRleEltYWdlMkQoYmFzZVRleHR1cmUudGFyZ2V0LCAwLCBiYXNlVGV4dHVyZS5mb3JtYXQsIGJhc2VUZXh0dXJlLmZvcm1hdCwgYmFzZVRleHR1cmUudHlwZSwgc291cmNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBzb3VyY2Ugd2lkdGgvaGVpZ2h0IHdhcyBjaGFuZ2VkLCByZXNpemUgY2FuIGNhdXNlIGV4dHJhIGJhc2VUZXh0dXJlIHVwZGF0ZS5cbiAgICAgKiBUcmlnZ2VycyBvbmUgdXBkYXRlIGluIGFueSBjYXNlLlxuICAgICAqL1xuICAgIHVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5kZXN0cm95ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc291cmNlIGFzIGFueTtcblxuICAgICAgICBjb25zdCB3aWR0aCA9IHNvdXJjZS5uYXR1cmFsV2lkdGggfHwgc291cmNlLnZpZGVvV2lkdGggfHwgc291cmNlLndpZHRoO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBzb3VyY2UubmF0dXJhbEhlaWdodCB8fCBzb3VyY2UudmlkZW9IZWlnaHQgfHwgc291cmNlLmhlaWdodDtcblxuICAgICAgICB0aGlzLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICBzdXBlci51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95IHRoaXMgQmFzZUltYWdlUmVzb3VyY2VcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQmFzZUltYWdlUmVzb3VyY2UgfSBmcm9tICcuL0Jhc2VJbWFnZVJlc291cmNlJztcblxuLyoqXG4gKiBAaW50ZXJmYWNlIE9mZnNjcmVlbkNhbnZhc1xuICovXG5cbi8qKlxuICogUmVzb3VyY2UgdHlwZSBmb3IgSFRNTENhbnZhc0VsZW1lbnQuXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkucmVzb3VyY2VzLkJhc2VJbWFnZVJlc291cmNlXG4gKiBAbWVtYmVyb2YgUElYSS5yZXNvdXJjZXNcbiAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IHNvdXJjZSAtIENhbnZhcyBlbGVtZW50IHRvIHVzZVxuICovXG5leHBvcnQgY2xhc3MgQ2FudmFzUmVzb3VyY2UgZXh0ZW5kcyBCYXNlSW1hZ2VSZXNvdXJjZVxue1xuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gYXV0by1kZXRlY3QgdGhlIHR5cGUgb2YgcmVzb3VyY2UuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudHxPZmZzY3JlZW5DYW52YXN9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2JqZWN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gYHRydWVgIGlmIHNvdXJjZSBpcyBIVE1MQ2FudmFzRWxlbWVudCBvciBPZmZzY3JlZW5DYW52YXNcbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChzb3VyY2U6IHVua25vd24pOiBzb3VyY2UgaXMgT2Zmc2NyZWVuQ2FudmFzfEhUTUxDYW52YXNFbGVtZW50XG4gICAge1xuICAgICAgICBjb25zdCB7IE9mZnNjcmVlbkNhbnZhcyB9ID0gd2luZG93O1xuXG4gICAgICAgIC8vIENoZWNrIGZvciBicm93c2VycyB0aGF0IGRvbid0IHlldCBzdXBwb3J0IE9mZnNjcmVlbkNhbnZhc1xuICAgICAgICBpZiAoT2Zmc2NyZWVuQ2FudmFzICYmIHNvdXJjZSBpbnN0YW5jZW9mIE9mZnNjcmVlbkNhbnZhcylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc291cmNlIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFic3RyYWN0TXVsdGlSZXNvdXJjZSB9IGZyb20gJy4vQWJzdHJhY3RNdWx0aVJlc291cmNlJztcbmltcG9ydCB7IFRBUkdFVFMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IFJlc291cmNlIH0gZnJvbSAnLi9SZXNvdXJjZSc7XG5pbXBvcnQgdHlwZSB7IElTaXplIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgdHlwZSB7IEFycmF5Rml4ZWQgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vQmFzZVRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgR0xUZXh0dXJlIH0gZnJvbSAnLi4vR0xUZXh0dXJlJztcblxuLyoqXG4gKiBDb25zdHJ1Y3RvciBvcHRpb25zIGZvciBDdWJlUmVzb3VyY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJQ3ViZVJlc291cmNlT3B0aW9ucyBleHRlbmRzIElTaXplXG57XG4gICAgYXV0b0xvYWQ/OiBib29sZWFuO1xuICAgIGxpbmtCYXNlVGV4dHVyZT86IGJvb2xlYW47XG59XG5cbi8qKlxuICogUmVzb3VyY2UgZm9yIGEgQ3ViZVRleHR1cmUgd2hpY2ggY29udGFpbnMgc2l4IHJlc291cmNlcy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkucmVzb3VyY2VzLkFycmF5UmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICogQHBhcmFtIHtBcnJheTxzdHJpbmd8UElYSS5yZXNvdXJjZXMuUmVzb3VyY2U+fSBbc291cmNlXSAtIENvbGxlY3Rpb24gb2YgVVJMcyBvciByZXNvdXJjZXNcbiAqICAgICAgICB0byB1c2UgYXMgdGhlIHNpZGVzIG9mIHRoZSBjdWJlLlxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIEltYWdlUmVzb3VyY2Ugb3B0aW9uc1xuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLndpZHRoXSAtIFdpZHRoIG9mIHJlc291cmNlXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuaGVpZ2h0XSAtIEhlaWdodCBvZiByZXNvdXJjZVxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmF1dG9Mb2FkPXRydWVdIC0gV2hldGhlciB0byBhdXRvLWxvYWQgcmVzb3VyY2VzXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMubGlua0Jhc2VUZXh0dXJlPXRydWVdIC0gSW4gY2FzZSBCYXNlVGV4dHVyZXMgYXJlIHN1cHBsaWVkLFxuICogICB3aGV0aGVyIHRvIGNvcHkgdGhlbSBvciB1c2VcbiAqL1xuZXhwb3J0IGNsYXNzIEN1YmVSZXNvdXJjZSBleHRlbmRzIEFic3RyYWN0TXVsdGlSZXNvdXJjZVxue1xuICAgIGl0ZW1zOiBBcnJheUZpeGVkPEJhc2VUZXh0dXJlLCA2PjtcblxuICAgIGxpbmtCYXNlVGV4dHVyZTogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKHNvdXJjZT86IEFycmF5Rml4ZWQ8c3RyaW5nfFJlc291cmNlLCA2Piwgb3B0aW9ucz86IElDdWJlUmVzb3VyY2VPcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0LCBhdXRvTG9hZCwgbGlua0Jhc2VUZXh0dXJlIH0gPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmxlbmd0aCAhPT0gQ3ViZVJlc291cmNlLlNJREVTKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbGVuZ3RoLiBHb3QgJHtzb3VyY2UubGVuZ3RofSwgZXhwZWN0ZWQgNmApO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIoNiwgeyB3aWR0aCwgaGVpZ2h0IH0pO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgQ3ViZVJlc291cmNlLlNJREVTOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbXNbaV0udGFyZ2V0ID0gVEFSR0VUUy5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ggKyBpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluIGNhc2UgQmFzZVRleHR1cmVzIGFyZSBzdXBwbGllZCwgd2hldGhlciB0byB1c2Ugc2FtZSByZXNvdXJjZSBvciBiaW5kIGJhc2VUZXh0dXJlIGl0c2VsZlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxpbmtCYXNlVGV4dHVyZSA9IGxpbmtCYXNlVGV4dHVyZSAhPT0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHNvdXJjZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5pbml0RnJvbUFycmF5KHNvdXJjZSwgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXV0b0xvYWQgIT09IGZhbHNlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmxvYWQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBiaW5kaW5nXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IGJhc2VUZXh0dXJlIC0gcGFyZW50IGJhc2UgdGV4dHVyZVxuICAgICAqL1xuICAgIGJpbmQoYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuYmluZChiYXNlVGV4dHVyZSk7XG5cbiAgICAgICAgYmFzZVRleHR1cmUudGFyZ2V0ID0gVEFSR0VUUy5URVhUVVJFX0NVQkVfTUFQO1xuICAgIH1cblxuICAgIGFkZEJhc2VUZXh0dXJlQXQoYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBpbmRleDogbnVtYmVyLCBsaW5rQmFzZVRleHR1cmU/OiBib29sZWFuKTogdGhpc1xuICAgIHtcbiAgICAgICAgaWYgKGxpbmtCYXNlVGV4dHVyZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBsaW5rQmFzZVRleHR1cmUgPSB0aGlzLmxpbmtCYXNlVGV4dHVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5pdGVtc1tpbmRleF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5kZXggJHtpbmRleH0gaXMgb3V0IG9mIGJvdW5kc2ApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmxpbmtCYXNlVGV4dHVyZVxuICAgICAgICAgICAgfHwgYmFzZVRleHR1cmUucGFyZW50VGV4dHVyZUFycmF5XG4gICAgICAgICAgICB8fCBPYmplY3Qua2V5cyhiYXNlVGV4dHVyZS5fZ2xUZXh0dXJlcykubGVuZ3RoID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY29weSBtb2RlXG4gICAgICAgICAgICBpZiAoYmFzZVRleHR1cmUucmVzb3VyY2UpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSZXNvdXJjZUF0KGJhc2VUZXh0dXJlLnJlc291cmNlLCBpbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDdWJlUmVzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjb3B5aW5nIG9mIHJlbmRlclRleHR1cmUuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBsaW5rIG1vZGUsIHRoZSBkaWZmaWN1bHQgb25lIVxuICAgICAgICAgICAgYmFzZVRleHR1cmUudGFyZ2V0ID0gVEFSR0VUUy5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ggKyBpbmRleDtcbiAgICAgICAgICAgIGJhc2VUZXh0dXJlLnBhcmVudFRleHR1cmVBcnJheSA9IHRoaXMuYmFzZVRleHR1cmU7XG5cbiAgICAgICAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gYmFzZVRleHR1cmU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYmFzZVRleHR1cmUudmFsaWQgJiYgIXRoaXMudmFsaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmVzaXplKGJhc2VUZXh0dXJlLnJlYWxXaWR0aCwgYmFzZVRleHR1cmUucmVhbEhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLml0ZW1zW2luZGV4XSA9IGJhc2VUZXh0dXJlO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZCB0aGUgcmVzb3VyY2VcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlzIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICB1cGxvYWQocmVuZGVyZXI6IFJlbmRlcmVyLCBfYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBnbFRleHR1cmU6IEdMVGV4dHVyZSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gdGhpcy5pdGVtRGlydHlJZHM7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBDdWJlUmVzb3VyY2UuU0lERVM7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3Qgc2lkZSA9IHRoaXMuaXRlbXNbaV07XG5cbiAgICAgICAgICAgIGlmIChkaXJ0eVtpXSA8IHNpZGUuZGlydHlJZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoc2lkZS52YWxpZCAmJiBzaWRlLnJlc291cmNlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc2lkZS5yZXNvdXJjZS51cGxvYWQocmVuZGVyZXIsIHNpZGUsIGdsVGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgICAgIGRpcnR5W2ldID0gc2lkZS5kaXJ0eUlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkaXJ0eVtpXSA8IC0xKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZWl0aGVyIGl0ZW0gaXMgbm90IHZhbGlkIHlldCwgZWl0aGVyIGl0cyBhIHJlbmRlclRleHR1cmVcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxsb2NhdGUgdGhlIG1lbW9yeVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5nbC50ZXhJbWFnZTJEKHNpZGUudGFyZ2V0LCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xUZXh0dXJlLmludGVybmFsRm9ybWF0LFxuICAgICAgICAgICAgICAgICAgICAgICAgX2Jhc2VUZXh0dXJlLnJlYWxXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iYXNlVGV4dHVyZS5yZWFsSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iYXNlVGV4dHVyZS5mb3JtYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBnbFRleHR1cmUudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBkaXJ0eVtpXSA9IC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE51bWJlciBvZiB0ZXh0dXJlIHNpZGVzIHRvIHN0b3JlIGZvciBDdWJlUmVzb3VyY2VzXG4gICAgICpcbiAgICAgKiBAbmFtZSBQSVhJLnJlc291cmNlcy5DdWJlUmVzb3VyY2UuU0lERVNcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDZcbiAgICAgKi9cbiAgICBzdGF0aWMgU0lERVMgPSA2O1xuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBhdXRvLWRldGVjdCB0aGUgdHlwZSBvZiByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc291cmNlIC0gVGhlIHNvdXJjZSBvYmplY3RcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgc291cmNlIGlzIGFuIGFycmF5IG9mIDYgZWxlbWVudHNcbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChzb3VyY2U6IHVua25vd24pOiBzb3VyY2UgaXMgQXJyYXlGaXhlZDxzdHJpbmd8UmVzb3VyY2UsIDY+XG4gICAge1xuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShzb3VyY2UpICYmIHNvdXJjZS5sZW5ndGggPT09IEN1YmVSZXNvdXJjZS5TSURFUztcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQmFzZUltYWdlUmVzb3VyY2UgfSBmcm9tICcuL0Jhc2VJbWFnZVJlc291cmNlJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgQUxQSEFfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vQmFzZVRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgR0xUZXh0dXJlIH0gZnJvbSAnLi4vR0xUZXh0dXJlJztcblxuZXhwb3J0IGludGVyZmFjZSBJSW1hZ2VSZXNvdXJjZU9wdGlvbnNcbntcbiAgICBhdXRvTG9hZD86IGJvb2xlYW47XG4gICAgY3JlYXRlQml0bWFwPzogYm9vbGVhbjtcbiAgICBjcm9zc29yaWdpbj86IGJvb2xlYW58c3RyaW5nO1xuICAgIGFscGhhTW9kZT86IEFMUEhBX01PREVTO1xufVxuXG4vKipcbiAqIFJlc291cmNlIHR5cGUgZm9yIEhUTUxJbWFnZUVsZW1lbnQuXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkucmVzb3VyY2VzLkJhc2VJbWFnZVJlc291cmNlXG4gKiBAbWVtYmVyb2YgUElYSS5yZXNvdXJjZXNcbiAqL1xuZXhwb3J0IGNsYXNzIEltYWdlUmVzb3VyY2UgZXh0ZW5kcyBCYXNlSW1hZ2VSZXNvdXJjZVxue1xuICAgIHVybDogc3RyaW5nO1xuICAgIHByaXZhdGUgX2xvYWQ6IFByb21pc2U8SW1hZ2VSZXNvdXJjZT47XG4gICAgcHJpdmF0ZSBfcHJvY2VzczogUHJvbWlzZTxJbWFnZVJlc291cmNlPjtcbiAgICBwcmVzZXJ2ZUJpdG1hcDogYm9vbGVhbjtcbiAgICBjcmVhdGVCaXRtYXA6IGJvb2xlYW47XG4gICAgYWxwaGFNb2RlOiBBTFBIQV9NT0RFUztcbiAgICBiaXRtYXA6IEltYWdlQml0bWFwO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SFRNTEltYWdlRWxlbWVudHxzdHJpbmd9IHNvdXJjZSAtIGltYWdlIHNvdXJjZSBvciBVUkxcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hdXRvTG9hZD10cnVlXSAtIHN0YXJ0IGxvYWRpbmcgcHJvY2Vzc1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY3JlYXRlQml0bWFwPVBJWEkuc2V0dGluZ3MuQ1JFQVRFX0lNQUdFX0JJVE1BUF0gLSB3aGV0aGVyIGl0cyByZXF1aXJlZCB0byBjcmVhdGVcbiAgICAgKiAgICAgICAgYSBiaXRtYXAgYmVmb3JlIHVwbG9hZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY3Jvc3NvcmlnaW49dHJ1ZV0gLSBMb2FkIGltYWdlIHVzaW5nIGNyb3NzIG9yaWdpblxuICAgICAqIEBwYXJhbSB7UElYSS5BTFBIQV9NT0RFU30gW29wdGlvbnMuYWxwaGFNb2RlPVBJWEkuQUxQSEFfTU9ERVMuVU5QQUNLXSAtIFByZW11bHRpcGx5IGltYWdlIGFscGhhIGluIGJpdG1hcFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNvdXJjZTogSFRNTEltYWdlRWxlbWVudHxzdHJpbmcsIG9wdGlvbnM/OiBJSW1hZ2VSZXNvdXJjZU9wdGlvbnMpXG4gICAge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50KSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VFbGVtZW50ID0gbmV3IEltYWdlKCk7XG5cbiAgICAgICAgICAgIEJhc2VJbWFnZVJlc291cmNlLmNyb3NzT3JpZ2luKGltYWdlRWxlbWVudCwgc291cmNlLCBvcHRpb25zLmNyb3Nzb3JpZ2luKTtcblxuICAgICAgICAgICAgaW1hZ2VFbGVtZW50LnNyYyA9IHNvdXJjZTtcbiAgICAgICAgICAgIHNvdXJjZSA9IGltYWdlRWxlbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyKHNvdXJjZSk7XG5cbiAgICAgICAgLy8gRmlyZUZveCA2OCwgYW5kIHBvc3NpYmx5IG90aGVyIHZlcnNpb25zLCBzZWVtcyBsaWtlIHNldHRpbmcgdGhlIEhUTUxJbWFnZUVsZW1lbnQjd2lkdGggYW5kICNoZWlnaHRcbiAgICAgICAgLy8gdG8gbm9uLXplcm8gdmFsdWVzIGJlZm9yZSBpdHMgbG9hZGluZyBjb21wbGV0ZXMgaWYgaW1hZ2VzIGFyZSBpbiBhIGNhY2hlLlxuICAgICAgICAvLyBCZWNhdXNlIG9mIHRoaXMsIG5lZWQgdG8gc2V0IHRoZSBgX3dpZHRoYCBhbmQgdGhlIGBfaGVpZ2h0YCB0byB6ZXJvIHRvIGF2b2lkIHVwbG9hZGluZyBpbmNvbXBsZXRlIGltYWdlcy5cbiAgICAgICAgLy8gUGxlYXNlIHJlZmVyIHRvIHRoZSBpc3N1ZSAjNTk2OCAoaHR0cHM6Ly9naXRodWIuY29tL3BpeGlqcy9waXhpLmpzL2lzc3Vlcy81OTY4KS5cbiAgICAgICAgaWYgKCFzb3VyY2UuY29tcGxldGUgJiYgISF0aGlzLl93aWR0aCAmJiAhIXRoaXMuX2hlaWdodClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fd2lkdGggPSAwO1xuICAgICAgICAgICAgdGhpcy5faGVpZ2h0ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVUkwgb2YgdGhlIGltYWdlIHNvdXJjZVxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVybCA9IHNvdXJjZS5zcmM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZW4gcHJvY2VzcyBpcyBjb21wbGV0ZWRcbiAgICAgICAgICogQG1lbWJlciB7UHJvbWlzZTx2b2lkPn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Byb2Nlc3MgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgaW1hZ2Ugc2hvdWxkIGJlIGRpc3Bvc2VkIGFmdGVyIHVwbG9hZFxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcmVzZXJ2ZUJpdG1hcCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBjYXBhYmxlLCBjb252ZXJ0IHRoZSBpbWFnZSB1c2luZyBjcmVhdGVJbWFnZUJpdG1hcCBBUElcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5zZXR0aW5ncy5DUkVBVEVfSU1BR0VfQklUTUFQXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNyZWF0ZUJpdG1hcCA9IChvcHRpb25zLmNyZWF0ZUJpdG1hcCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IG9wdGlvbnMuY3JlYXRlQml0bWFwIDogc2V0dGluZ3MuQ1JFQVRFX0lNQUdFX0JJVE1BUCkgJiYgISF3aW5kb3cuY3JlYXRlSW1hZ2VCaXRtYXA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnRyb2xzIHRleHR1cmUgYWxwaGFNb2RlIGZpZWxkXG4gICAgICAgICAqIENvcGllcyBmcm9tIG9wdGlvbnNcbiAgICAgICAgICogRGVmYXVsdCBpcyBgbnVsbGAsIGNvcGllcyBvcHRpb24gZnJvbSBiYXNlVGV4dHVyZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkFMUEhBX01PREVTfG51bGx9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbHBoYU1vZGUgPSB0eXBlb2Ygb3B0aW9ucy5hbHBoYU1vZGUgPT09ICdudW1iZXInID8gb3B0aW9ucy5hbHBoYU1vZGUgOiBudWxsO1xuXG4gICAgICAgIGlmICgob3B0aW9ucyBhcyBhbnkpLnByZW11bHRpcGx5QWxwaGEgIT09IHVuZGVmaW5lZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gdHJpZ2dlcnMgZGVwcmVjYXRpb25cbiAgICAgICAgICAgICh0aGlzIGFzIGFueSkucHJlbXVsdGlwbHlBbHBoYSA9IChvcHRpb25zIGFzIGFueSkucHJlbXVsdGlwbHlBbHBoYTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgSW1hZ2VCaXRtYXAgZWxlbWVudCBjcmVhdGVkIGZvciBIVE1MSW1hZ2VFbGVtZW50XG4gICAgICAgICAqIEBtZW1iZXIge0ltYWdlQml0bWFwfVxuICAgICAgICAgKiBAZGVmYXVsdCBudWxsXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJpdG1hcCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFByb21pc2Ugd2hlbiBsb2FkaW5nXG4gICAgICAgICAqIEBtZW1iZXIge1Byb21pc2U8dm9pZD59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBkZWZhdWx0IG51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xvYWQgPSBudWxsO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmF1dG9Mb2FkICE9PSBmYWxzZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIGEgcHJvbWlzZSB3aGVuIGltYWdlIHdpbGwgYmUgbG9hZGVkIGFuZCBwcm9jZXNzZWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2NyZWF0ZUJpdG1hcF0gLSB3aGV0aGVyIHByb2Nlc3MgaW1hZ2UgaW50byBiaXRtYXBcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgICAgKi9cbiAgICBsb2FkKGNyZWF0ZUJpdG1hcD86IGJvb2xlYW4pOiBQcm9taXNlPEltYWdlUmVzb3VyY2U+XG4gICAge1xuICAgICAgICBpZiAodGhpcy5fbG9hZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY3JlYXRlQml0bWFwICE9PSB1bmRlZmluZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQml0bWFwID0gY3JlYXRlQml0bWFwO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbG9hZCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc291cmNlIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XG5cbiAgICAgICAgICAgIHRoaXMudXJsID0gc291cmNlLnNyYztcblxuICAgICAgICAgICAgY29uc3QgY29tcGxldGVkID0gKCk6IHZvaWQgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZXN0cm95ZWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNvdXJjZS5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNvdXJjZS5vbmVycm9yID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKHNvdXJjZS53aWR0aCwgc291cmNlLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jcmVhdGVCaXRtYXApXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucHJvY2VzcygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoc291cmNlLmNvbXBsZXRlICYmIHNvdXJjZS5zcmMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tcGxldGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc291cmNlLm9ubG9hZCA9IGNvbXBsZXRlZDtcbiAgICAgICAgICAgICAgICBzb3VyY2Uub25lcnJvciA9IChldmVudCk6IHZvaWQgPT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEF2b2lkcyBQcm9taXNlIGZyZWV6aW5nIHdoZW4gcmVzb3VyY2UgYnJva2VuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvci5lbWl0KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fbG9hZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB3ZSBuZWVkIHRvIGNvbnZlcnQgaW1hZ2UgaW50byBCaXRtYXBJbWFnZS5cbiAgICAgKiBDYW4gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLCByZWFsIHByb21pc2UgaXMgY2FjaGVkIGluc2lkZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fSBjYWNoZWQgcHJvbWlzZSB0byBmaWxsIHRoYXQgYml0bWFwXG4gICAgICovXG4gICAgcHJvY2VzcygpOiBQcm9taXNlPEltYWdlUmVzb3VyY2U+XG4gICAge1xuICAgICAgICBjb25zdCBzb3VyY2UgPSB0aGlzLnNvdXJjZSBhcyBIVE1MSW1hZ2VFbGVtZW50O1xuXG4gICAgICAgIGlmICh0aGlzLl9wcm9jZXNzICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvY2VzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5iaXRtYXAgIT09IG51bGwgfHwgIXdpbmRvdy5jcmVhdGVJbWFnZUJpdG1hcClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3Byb2Nlc3MgPSAod2luZG93LmNyZWF0ZUltYWdlQml0bWFwIGFzIGFueSkoc291cmNlLFxuICAgICAgICAgICAgMCwgMCwgc291cmNlLndpZHRoLCBzb3VyY2UuaGVpZ2h0LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZW11bHRpcGx5QWxwaGE6IHRoaXMuYWxwaGFNb2RlID09PSBBTFBIQV9NT0RFUy5VTlBBQ0sgPyAncHJlbXVsdGlwbHknIDogJ25vbmUnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChiaXRtYXA6IEltYWdlQml0bWFwKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlc3Ryb3llZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmJpdG1hcCA9IGJpdG1hcDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3MgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9wcm9jZXNzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZCB0aGUgaW1hZ2UgcmVzb3VyY2UgdG8gR1BVLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFJlbmRlcmVyIHRvIHVwbG9hZCB0b1xuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBCYXNlVGV4dHVyZSBmb3IgdGhpcyByZXNvdXJjZVxuICAgICAqIEBwYXJhbSB7UElYSS5HTFRleHR1cmV9IGdsVGV4dHVyZSAtIEdMVGV4dHVyZSB0byB1c2VcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpcyBzdWNjZXNzXG4gICAgICovXG4gICAgdXBsb2FkKHJlbmRlcmVyOiBSZW5kZXJlciwgYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBnbFRleHR1cmU6IEdMVGV4dHVyZSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5hbHBoYU1vZGUgPT09ICdudW1iZXInKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBiaXRtYXAgc3RvcmVzIHVucGFjayBwcmVtdWx0aXBseSBmbGFnLCB3ZSBkb250IGhhdmUgdG8gbm90aWZ5IHRleEltYWdlMkQgYWJvdXQgaXRcblxuICAgICAgICAgICAgYmFzZVRleHR1cmUuYWxwaGFNb2RlID0gdGhpcy5hbHBoYU1vZGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuY3JlYXRlQml0bWFwKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIudXBsb2FkKHJlbmRlcmVyLCBiYXNlVGV4dHVyZSwgZ2xUZXh0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuYml0bWFwKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB5ZWFoLCBpZ25vcmUgdGhlIG91dHB1dFxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYml0bWFwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyLnVwbG9hZChyZW5kZXJlciwgYmFzZVRleHR1cmUsIGdsVGV4dHVyZSwgdGhpcy5iaXRtYXApO1xuXG4gICAgICAgIGlmICghdGhpcy5wcmVzZXJ2ZUJpdG1hcClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2hlY2tzIGlmIHRoZXJlIGFyZSBvdGhlciByZW5kZXJlcnMgdGhhdCBwb3NzaWJseSBuZWVkIHRoaXMgYml0bWFwXG5cbiAgICAgICAgICAgIGxldCBmbGFnID0gdHJ1ZTtcblxuICAgICAgICAgICAgY29uc3QgZ2xUZXh0dXJlcyA9IGJhc2VUZXh0dXJlLl9nbFRleHR1cmVzO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBnbFRleHR1cmVzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IG90aGVyVGV4ID0gZ2xUZXh0dXJlc1trZXldO1xuXG4gICAgICAgICAgICAgICAgaWYgKG90aGVyVGV4ICE9PSBnbFRleHR1cmUgJiYgb3RoZXJUZXguZGlydHlJZCAhPT0gYmFzZVRleHR1cmUuZGlydHlJZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZmxhZylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5iaXRtYXAuY2xvc2UpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpdG1hcC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuYml0bWFwID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgdGV4dHVyZVxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGRpc3Bvc2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgKHRoaXMuc291cmNlIGFzIEhUTUxJbWFnZUVsZW1lbnQpLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICh0aGlzLnNvdXJjZSBhcyBIVE1MSW1hZ2VFbGVtZW50KS5vbmVycm9yID0gbnVsbDtcblxuICAgICAgICBzdXBlci5kaXNwb3NlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuYml0bWFwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJpdG1hcC5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5iaXRtYXAgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Byb2Nlc3MgPSBudWxsO1xuICAgICAgICB0aGlzLl9sb2FkID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGF1dG8tZGV0ZWN0IHRoZSB0eXBlIG9mIHJlc291cmNlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfEhUTUxJbWFnZUVsZW1lbnR9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2JqZWN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gYHRydWVgIGlmIHNvdXJjZSBpcyBzdHJpbmcgb3IgSFRNTEltYWdlRWxlbWVudFxuICAgICAqL1xuICAgIHN0YXRpYyB0ZXN0KHNvdXJjZTogdW5rbm93bik6IHNvdXJjZSBpcyBzdHJpbmd8SFRNTEltYWdlRWxlbWVudFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBzb3VyY2UgPT09ICdzdHJpbmcnIHx8IHNvdXJjZSBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IHVpZCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IEJhc2VJbWFnZVJlc291cmNlIH0gZnJvbSAnLi9CYXNlSW1hZ2VSZXNvdXJjZSc7XG5cbmltcG9ydCB0eXBlIHsgSVNpemUgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuZXhwb3J0IGludGVyZmFjZSBJU1ZHUmVzb3VyY2VPcHRpb25zXG57XG4gICAgc291cmNlPzogc3RyaW5nO1xuICAgIHNjYWxlPzogbnVtYmVyO1xuICAgIHdpZHRoPzogbnVtYmVyO1xuICAgIGhlaWdodD86IG51bWJlcjtcbiAgICBhdXRvTG9hZD86IGJvb2xlYW47XG4gICAgY3Jvc3NvcmlnaW4/OiBib29sZWFufHN0cmluZztcbn1cbi8qKlxuICogUmVzb3VyY2UgdHlwZSBmb3IgU1ZHIGVsZW1lbnRzIGFuZCBncmFwaGljcy5cbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5yZXNvdXJjZXMuQmFzZUltYWdlUmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZSAtIEJhc2U2NCBlbmNvZGVkIFNWRyBlbGVtZW50IG9yIFVSTCBmb3IgU1ZHIGZpbGUuXG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gT3B0aW9ucyB0byB1c2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5zY2FsZT0xXSAtIFNjYWxlIHRvIGFwcGx5IHRvIFNWRy4gT3ZlcnJpZGRlbiBieS4uLlxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLndpZHRoXSAtIFJhc3Rlcml6ZSBTVkcgdGhpcyB3aWRlLiBBc3BlY3QgcmF0aW8gcHJlc2VydmVkIGlmIGhlaWdodCBub3Qgc3BlY2lmaWVkLlxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmhlaWdodF0gLSBSYXN0ZXJpemUgU1ZHIHRoaXMgaGlnaC4gQXNwZWN0IHJhdGlvIHByZXNlcnZlZCBpZiB3aWR0aCBub3Qgc3BlY2lmaWVkLlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hdXRvTG9hZD10cnVlXSAtIFN0YXJ0IGxvYWRpbmcgcmlnaHQgYXdheS5cbiAqL1xuZXhwb3J0IGNsYXNzIFNWR1Jlc291cmNlIGV4dGVuZHMgQmFzZUltYWdlUmVzb3VyY2VcbntcbiAgICBwdWJsaWMgcmVhZG9ubHkgc3ZnOiBzdHJpbmc7XG4gICAgcHVibGljIHJlYWRvbmx5IHNjYWxlOiBudW1iZXI7XG4gICAgcmVhZG9ubHkgX292ZXJyaWRlV2lkdGg6IG51bWJlcjtcbiAgICByZWFkb25seSBfb3ZlcnJpZGVIZWlnaHQ6IG51bWJlcjtcbiAgICBwcml2YXRlIF9yZXNvbHZlOiAoKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgX2xvYWQ6IFByb21pc2U8U1ZHUmVzb3VyY2U+O1xuICAgIHByaXZhdGUgX2Nyb3Nzb3JpZ2luPzogYm9vbGVhbnxzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2VCYXNlNjQ6IHN0cmluZywgb3B0aW9uczogSVNWR1Jlc291cmNlT3B0aW9ucylcbiAgICB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIHN1cGVyKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpKTtcbiAgICAgICAgdGhpcy5fd2lkdGggPSAwO1xuICAgICAgICB0aGlzLl9oZWlnaHQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYXNlNjQgZW5jb2RlZCBTVkcgZWxlbWVudCBvciBVUkwgZm9yIFNWRyBmaWxlXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN2ZyA9IHNvdXJjZUJhc2U2NDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNvdXJjZSBzY2FsZSB0byBhcHBseSB3aGVuIHJhc3Rlcml6aW5nIG9uIGxvYWRcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2NhbGUgPSBvcHRpb25zLnNjYWxlIHx8IDE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgd2lkdGggb3ZlcnJpZGUgZm9yIHJhc3Rlcml6YXRpb24gb24gbG9hZFxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fb3ZlcnJpZGVXaWR0aCA9IG9wdGlvbnMud2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgaGVpZ2h0IG92ZXJyaWRlIGZvciByYXN0ZXJpemF0aW9uIG9uIGxvYWRcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX292ZXJyaWRlSGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGwgd2hlbiBjb21wbGV0ZWx5IGxvYWRlZFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtmdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Jlc29sdmUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcm9zcyBvcmlnaW4gdmFsdWUgdG8gdXNlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW58c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fY3Jvc3NvcmlnaW4gPSBvcHRpb25zLmNyb3Nzb3JpZ2luO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcm9taXNlIHdoZW4gbG9hZGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtQcm9taXNlPHZvaWQ+fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAZGVmYXVsdCBudWxsXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9sb2FkID0gbnVsbDtcblxuICAgICAgICBpZiAob3B0aW9ucy5hdXRvTG9hZCAhPT0gZmFsc2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbG9hZCgpOiBQcm9taXNlPFNWR1Jlc291cmNlPlxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2xvYWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbG9hZCA9IG5ldyBQcm9taXNlKChyZXNvbHZlKTogdm9pZCA9PlxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBTYXZlIHRoaXMgdW50aWwgYWZ0ZXIgbG9hZCBpcyBmaW5pc2hlZFxuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSA9ICgpOiB2b2lkID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemUodGhpcy5zb3VyY2Uud2lkdGgsIHRoaXMuc291cmNlLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIENvbnZlcnQgU1ZHIGlubGluZSBzdHJpbmcgdG8gZGF0YS11cmlcbiAgICAgICAgICAgIGlmICgoL15cXDxzdmcvKS50ZXN0KHRoaXMuc3ZnLnRyaW0oKSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKCFidG9hKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3VyIGJyb3dzZXIgZG9lc25cXCd0IHN1cHBvcnQgYmFzZTY0IGNvbnZlcnNpb25zLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAodGhpcyBhcyBhbnkpLnN2ZyA9IGBkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LCR7YnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodGhpcy5zdmcpKSl9YDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbG9hZFN2ZygpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fbG9hZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyBhbiBTVkcgaW1hZ2UgZnJvbSBgaW1hZ2VVcmxgIG9yIGBkYXRhIFVSTGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgX2xvYWRTdmcoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdGVtcEltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgICAgICAgQmFzZUltYWdlUmVzb3VyY2UuY3Jvc3NPcmlnaW4odGVtcEltYWdlLCB0aGlzLnN2ZywgdGhpcy5fY3Jvc3NvcmlnaW4pO1xuICAgICAgICB0ZW1wSW1hZ2Uuc3JjID0gdGhpcy5zdmc7XG5cbiAgICAgICAgdGVtcEltYWdlLm9uZXJyb3IgPSAoZXZlbnQpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fcmVzb2x2ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRlbXBJbWFnZS5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMub25FcnJvci5lbWl0KGV2ZW50KTtcbiAgICAgICAgfTtcblxuICAgICAgICB0ZW1wSW1hZ2Uub25sb2FkID0gKCk6IHZvaWQgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9yZXNvbHZlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc3ZnV2lkdGggPSB0ZW1wSW1hZ2Uud2lkdGg7XG4gICAgICAgICAgICBjb25zdCBzdmdIZWlnaHQgPSB0ZW1wSW1hZ2UuaGVpZ2h0O1xuXG4gICAgICAgICAgICBpZiAoIXN2Z1dpZHRoIHx8ICFzdmdIZWlnaHQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgU1ZHIGltYWdlIG11c3QgaGF2ZSB3aWR0aCBhbmQgaGVpZ2h0IGRlZmluZWQgKGluIHBpeGVscyksIGNhbnZhcyBBUEkgbmVlZHMgdGhlbS4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHJlbmRlciBzaXplXG4gICAgICAgICAgICBsZXQgd2lkdGggPSBzdmdXaWR0aCAqIHRoaXMuc2NhbGU7XG4gICAgICAgICAgICBsZXQgaGVpZ2h0ID0gc3ZnSGVpZ2h0ICogdGhpcy5zY2FsZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX292ZXJyaWRlV2lkdGggfHwgdGhpcy5fb3ZlcnJpZGVIZWlnaHQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgd2lkdGggPSB0aGlzLl9vdmVycmlkZVdpZHRoIHx8IHRoaXMuX292ZXJyaWRlSGVpZ2h0IC8gc3ZnSGVpZ2h0ICogc3ZnV2lkdGg7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5fb3ZlcnJpZGVIZWlnaHQgfHwgdGhpcy5fb3ZlcnJpZGVXaWR0aCAvIHN2Z1dpZHRoICogc3ZnSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2lkdGggPSBNYXRoLnJvdW5kKHdpZHRoKTtcbiAgICAgICAgICAgIGhlaWdodCA9IE1hdGgucm91bmQoaGVpZ2h0KTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgY2FudmFzIGVsZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuc291cmNlIGFzIEhUTUxDYW52YXNFbGVtZW50O1xuXG4gICAgICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICAoY2FudmFzIGFzIGFueSkuX3BpeGlJZCA9IGBjYW52YXNfJHt1aWQoKX1gO1xuXG4gICAgICAgICAgICAvLyBEcmF3IHRoZSBTdmcgdG8gdGhlIGNhbnZhc1xuICAgICAgICAgICAgY2FudmFzXG4gICAgICAgICAgICAgICAgLmdldENvbnRleHQoJzJkJylcbiAgICAgICAgICAgICAgICAuZHJhd0ltYWdlKHRlbXBJbWFnZSwgMCwgMCwgc3ZnV2lkdGgsIHN2Z0hlaWdodCwgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUoKTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUgPSBudWxsO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzaXplIGZyb20gYW4gc3ZnIHN0cmluZyB1c2luZyByZWdleHAuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN2Z1N0cmluZyAtIGEgc2VyaWFsaXplZCBzdmcgZWxlbWVudFxuICAgICAqIEByZXR1cm4ge1BJWEkuSVNpemV9IGltYWdlIGV4dGVuc2lvblxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRTaXplKHN2Z1N0cmluZz86IHN0cmluZyk6IElTaXplXG4gICAge1xuICAgICAgICBjb25zdCBzaXplTWF0Y2ggPSBTVkdSZXNvdXJjZS5TVkdfU0laRS5leGVjKHN2Z1N0cmluZyk7XG4gICAgICAgIGNvbnN0IHNpemU6IGFueSA9IHt9O1xuXG4gICAgICAgIGlmIChzaXplTWF0Y2gpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNpemVbc2l6ZU1hdGNoWzFdXSA9IE1hdGgucm91bmQocGFyc2VGbG9hdChzaXplTWF0Y2hbM10pKTtcbiAgICAgICAgICAgIHNpemVbc2l6ZU1hdGNoWzVdXSA9IE1hdGgucm91bmQocGFyc2VGbG9hdChzaXplTWF0Y2hbN10pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzaXplO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgdGV4dHVyZVxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGRpc3Bvc2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuZGlzcG9zZSgpO1xuICAgICAgICB0aGlzLl9yZXNvbHZlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY3Jvc3NvcmlnaW4gPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gYXV0by1kZXRlY3QgdGhlIHR5cGUgb2YgcmVzb3VyY2UuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHsqfSBzb3VyY2UgLSBUaGUgc291cmNlIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gLSBUaGUgZXh0ZW5zaW9uIG9mIHNvdXJjZSwgaWYgc2V0XG4gICAgICovXG4gICAgc3RhdGljIHRlc3Qoc291cmNlOiB1bmtub3duLCBleHRlbnNpb24/OiBzdHJpbmcpOiBib29sZWFuXG4gICAge1xuICAgICAgICAvLyB1cmwgZmlsZSBleHRlbnNpb24gaXMgU1ZHXG4gICAgICAgIHJldHVybiBleHRlbnNpb24gPT09ICdzdmcnXG4gICAgICAgICAgICAvLyBzb3VyY2UgaXMgU1ZHIGRhdGEtdXJpXG4gICAgICAgICAgICB8fCAodHlwZW9mIHNvdXJjZSA9PT0gJ3N0cmluZycgJiYgKC9eZGF0YTppbWFnZVxcL3N2Z1xcK3htbCg7KGNoYXJzZXQ9dXRmOHx1dGY4KSk/O2Jhc2U2NC8pLnRlc3Qoc291cmNlKSlcbiAgICAgICAgICAgIC8vIHNvdXJjZSBpcyBTVkcgaW5saW5lXG4gICAgICAgICAgICB8fCAodHlwZW9mIHNvdXJjZSA9PT0gJ3N0cmluZycgJiYgc291cmNlLmluZGV4T2YoJzxzdmcnKSA9PT0gMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnRXhwIGZvciBTVkcgc2l6ZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAY29uc3RhbnQge1JlZ0V4cHxzdHJpbmd9IFNWR19TSVpFXG4gICAgICogQG1lbWJlcm9mIFBJWEkucmVzb3VyY2VzLlNWR1Jlc291cmNlXG4gICAgICogQGV4YW1wbGUgJmx0O3N2ZyB3aWR0aD1cIjEwMFwiIGhlaWdodD1cIjEwMFwiJmd0OyZsdDsvc3ZnJmd0O1xuICAgICAqL1xuICAgIHN0YXRpYyBTVkdfU0laRSA9IC88c3ZnW14+XSooPzpcXHMod2lkdGh8aGVpZ2h0KT0oJ3xcIikoXFxkKig/OlxcLlxcZCspPykoPzpweCk/KCd8XCIpKVtePl0qKD86XFxzKHdpZHRofGhlaWdodCk9KCd8XCIpKFxcZCooPzpcXC5cXGQrKT8pKD86cHgpPygnfFwiKSlbXj5dKj4vaTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBtYXgtbGVuXG59XG4iLCAiaW1wb3J0IHsgQmFzZUltYWdlUmVzb3VyY2UgfSBmcm9tICcuL0Jhc2VJbWFnZVJlc291cmNlJztcbmltcG9ydCB7IFRpY2tlciB9IGZyb20gJ0BwaXhpL3RpY2tlcic7XG5cbmltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBJVmlkZW9SZXNvdXJjZU9wdGlvbnNcbntcbiAgICBhdXRvTG9hZD86IGJvb2xlYW47XG4gICAgYXV0b1BsYXk/OiBib29sZWFuO1xuICAgIHVwZGF0ZUZQUz86IG51bWJlcjtcbiAgICBjcm9zc29yaWdpbj86IGJvb2xlYW58c3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElWaWRlb1Jlc291cmNlT3B0aW9uc0VsZW1lbnRcbntcbiAgICBzcmM6IHN0cmluZztcbiAgICBtaW1lOiBzdHJpbmc7XG59XG5cbi8qKlxuICogUmVzb3VyY2UgdHlwZSBmb3IgSFRNTFZpZGVvRWxlbWVudC5cbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5yZXNvdXJjZXMuQmFzZUltYWdlUmVzb3VyY2VcbiAqIEBtZW1iZXJvZiBQSVhJLnJlc291cmNlc1xuICogQHBhcmFtIHtIVE1MVmlkZW9FbGVtZW50fG9iamVjdHxzdHJpbmd8QXJyYXk8c3RyaW5nfG9iamVjdD59IHNvdXJjZSAtIFZpZGVvIGVsZW1lbnQgdG8gdXNlLlxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIE9wdGlvbnMgdG8gdXNlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9Mb2FkPXRydWVdIC0gU3RhcnQgbG9hZGluZyB0aGUgdmlkZW8gaW1tZWRpYXRlbHlcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYXV0b1BsYXk9dHJ1ZV0gLSBTdGFydCBwbGF5aW5nIHZpZGVvIGltbWVkaWF0ZWx5XG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMudXBkYXRlRlBTPTBdIC0gSG93IG1hbnkgdGltZXMgYSBzZWNvbmQgdG8gdXBkYXRlIHRoZSB0ZXh0dXJlIGZyb20gdGhlIHZpZGVvLlxuICogTGVhdmUgYXQgMCB0byB1cGRhdGUgYXQgZXZlcnkgcmVuZGVyLlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jcm9zc29yaWdpbj10cnVlXSAtIExvYWQgaW1hZ2UgdXNpbmcgY3Jvc3Mgb3JpZ2luXG4gKi9cbmV4cG9ydCBjbGFzcyBWaWRlb1Jlc291cmNlIGV4dGVuZHMgQmFzZUltYWdlUmVzb3VyY2VcbntcbiAgICBwcm90ZWN0ZWQgX2F1dG9VcGRhdGU6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIF9pc0Nvbm5lY3RlZFRvVGlja2VyOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBfdXBkYXRlRlBTOiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9tc1RvTmV4dFVwZGF0ZTogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBhdXRvUGxheTogYm9vbGVhbjtcbiAgICBwcml2YXRlIF9sb2FkOiBQcm9taXNlPFZpZGVvUmVzb3VyY2U+O1xuICAgIHByaXZhdGUgX3Jlc29sdmU6ICh2YWx1ZT86IFZpZGVvUmVzb3VyY2UgfCBQcm9taXNlTGlrZTxWaWRlb1Jlc291cmNlPikgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKHNvdXJjZT86IEhUTUxWaWRlb0VsZW1lbnR8QXJyYXk8c3RyaW5nfElWaWRlb1Jlc291cmNlT3B0aW9uc0VsZW1lbnQ+fHN0cmluZywgb3B0aW9ucz86IElWaWRlb1Jlc291cmNlT3B0aW9ucylcbiAgICB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB2aWRlb0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpO1xuXG4gICAgICAgICAgICAvLyB3b3JrYXJvdW5kIGZvciBodHRwczovL2dpdGh1Yi5jb20vcGl4aWpzL3BpeGkuanMvaXNzdWVzLzU5OTZcbiAgICAgICAgICAgIHZpZGVvRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3ByZWxvYWQnLCAnYXV0bycpO1xuICAgICAgICAgICAgdmlkZW9FbGVtZW50LnNldEF0dHJpYnV0ZSgnd2Via2l0LXBsYXlzaW5saW5lJywgJycpO1xuICAgICAgICAgICAgdmlkZW9FbGVtZW50LnNldEF0dHJpYnV0ZSgncGxheXNpbmxpbmUnLCAnJyk7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc291cmNlID09PSAnc3RyaW5nJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzb3VyY2UgPSBbc291cmNlXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZmlyc3RTcmMgPSAoc291cmNlWzBdIGFzIElWaWRlb1Jlc291cmNlT3B0aW9uc0VsZW1lbnQpLnNyYyB8fCBzb3VyY2VbMF0gYXMgc3RyaW5nO1xuXG4gICAgICAgICAgICBCYXNlSW1hZ2VSZXNvdXJjZS5jcm9zc09yaWdpbih2aWRlb0VsZW1lbnQsIGZpcnN0U3JjLCBvcHRpb25zLmNyb3Nzb3JpZ2luKTtcblxuICAgICAgICAgICAgLy8gYXJyYXkgb2Ygb2JqZWN0cyBvciBzdHJpbmdzXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5sZW5ndGg7ICsraSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG5cbiAgICAgICAgICAgICAgICBsZXQgeyBzcmMsIG1pbWUgfSA9IHNvdXJjZVtpXSBhcyBJVmlkZW9SZXNvdXJjZU9wdGlvbnNFbGVtZW50O1xuXG4gICAgICAgICAgICAgICAgc3JjID0gc3JjIHx8IHNvdXJjZVtpXSBhcyBzdHJpbmc7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBiYXNlU3JjID0gc3JjLnNwbGl0KCc/Jykuc2hpZnQoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4dCA9IGJhc2VTcmMuc3Vic3RyKGJhc2VTcmMubGFzdEluZGV4T2YoJy4nKSArIDEpO1xuXG4gICAgICAgICAgICAgICAgbWltZSA9IG1pbWUgfHwgVmlkZW9SZXNvdXJjZS5NSU1FX1RZUEVTW2V4dF0gfHwgYHZpZGVvLyR7ZXh0fWA7XG5cbiAgICAgICAgICAgICAgICBzb3VyY2VFbGVtZW50LnNyYyA9IHNyYztcbiAgICAgICAgICAgICAgICBzb3VyY2VFbGVtZW50LnR5cGUgPSBtaW1lO1xuXG4gICAgICAgICAgICAgICAgdmlkZW9FbGVtZW50LmFwcGVuZENoaWxkKHNvdXJjZUVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPdmVycmlkZSB0aGUgc291cmNlXG4gICAgICAgICAgICBzb3VyY2UgPSB2aWRlb0VsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlcihzb3VyY2UpO1xuXG4gICAgICAgIHRoaXMubm9TdWJJbWFnZSA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCB0byB1c2UgUElYSS5UaWNrZXIuc2hhcmVkIHRvIGF1dG8gdXBkYXRlIHRoZSBiYXNlIHRleHR1cmUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9hdXRvVXBkYXRlID0gdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYHRydWVgIGlmIHRoZSBpbnN0YW5jZSBpcyBjdXJyZW50bHkgY29ubmVjdGVkIHRvIFBJWEkuVGlja2VyLnNoYXJlZCB0byBhdXRvIHVwZGF0ZSB0aGUgYmFzZSB0ZXh0dXJlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl91cGRhdGVGUFMgPSBvcHRpb25zLnVwZGF0ZUZQUyB8fCAwO1xuICAgICAgICB0aGlzLl9tc1RvTmV4dFVwZGF0ZSA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZW4gc2V0IHRvIHRydWUgd2lsbCBhdXRvbWF0aWNhbGx5IHBsYXkgdmlkZW9zIHVzZWQgYnkgdGhpcyB0ZXh0dXJlIG9uY2VcbiAgICAgICAgICogdGhleSBhcmUgbG9hZGVkLiBJZiBmYWxzZSwgaXQgd2lsbCBub3QgbW9kaWZ5IHRoZSBwbGF5aW5nIHN0YXRlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1dG9QbGF5ID0gb3B0aW9ucy5hdXRvUGxheSAhPT0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFByb21pc2Ugd2hlbiBsb2FkaW5nXG4gICAgICAgICAqIEBtZW1iZXIge1Byb21pc2U8dm9pZD59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBkZWZhdWx0IG51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xvYWQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsYmFjayB3aGVuIGNvbXBsZXRlZCB3aXRoIGxvYWQuXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9ufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcmVzb2x2ZSA9IG51bGw7XG5cbiAgICAgICAgLy8gQmluZCBmb3IgbGlzdGVuZXJzXG4gICAgICAgIHRoaXMuX29uQ2FuUGxheSA9IHRoaXMuX29uQ2FuUGxheS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vbkVycm9yID0gdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmF1dG9Mb2FkICE9PSBmYWxzZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyIHVwZGF0aW5nIG9mIHRoZSB0ZXh0dXJlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RlbHRhVGltZT0wXSAtIHRpbWUgZGVsdGEgc2luY2UgbGFzdCB0aWNrXG4gICAgICovXG4gICAgdXBkYXRlKF9kZWx0YVRpbWUgPSAwKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmRlc3Ryb3llZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gYWNjb3VudCBmb3IgaWYgdmlkZW8gaGFzIGhhZCBpdHMgcGxheWJhY2tSYXRlIGNoYW5nZWRcbiAgICAgICAgICAgIGNvbnN0IGVsYXBzZWRNUyA9IFRpY2tlci5zaGFyZWQuZWxhcHNlZE1TICogKHRoaXMuc291cmNlIGFzIEhUTUxWaWRlb0VsZW1lbnQpLnBsYXliYWNrUmF0ZTtcblxuICAgICAgICAgICAgdGhpcy5fbXNUb05leHRVcGRhdGUgPSBNYXRoLmZsb29yKHRoaXMuX21zVG9OZXh0VXBkYXRlIC0gZWxhcHNlZE1TKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5fdXBkYXRlRlBTIHx8IHRoaXMuX21zVG9OZXh0VXBkYXRlIDw9IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3VwZXIudXBkYXRlKC8qIGRlbHRhVGltZSovKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tc1RvTmV4dFVwZGF0ZSA9IHRoaXMuX3VwZGF0ZUZQUyA/IE1hdGguZmxvb3IoMTAwMCAvIHRoaXMuX3VwZGF0ZUZQUykgOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcHJlbG9hZGluZyB0aGUgdmlkZW8gcmVzb3VyY2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHJldHVybiB7UHJvbWlzZTx2b2lkPn0gSGFuZGxlIHRoZSB2YWxpZGF0ZSBldmVudFxuICAgICAqL1xuICAgIGxvYWQoKTogUHJvbWlzZTxWaWRlb1Jlc291cmNlPlxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2xvYWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5zb3VyY2UgYXMgSFRNTFZpZGVvRWxlbWVudDtcblxuICAgICAgICBpZiAoKHNvdXJjZS5yZWFkeVN0YXRlID09PSBzb3VyY2UuSEFWRV9FTk9VR0hfREFUQSB8fCBzb3VyY2UucmVhZHlTdGF0ZSA9PT0gc291cmNlLkhBVkVfRlVUVVJFX0RBVEEpXG4gICAgICAgICAgICAmJiBzb3VyY2Uud2lkdGggJiYgc291cmNlLmhlaWdodClcbiAgICAgICAge1xuICAgICAgICAgICAgKHNvdXJjZSBhcyBhbnkpLmNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdwbGF5JywgdGhpcy5fb25QbGF5U3RhcnQuYmluZCh0aGlzKSk7XG4gICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdwYXVzZScsIHRoaXMuX29uUGxheVN0b3AuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgaWYgKCF0aGlzLl9pc1NvdXJjZVJlYWR5KCkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5JywgdGhpcy5fb25DYW5QbGF5KTtcbiAgICAgICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHRoaXMuX29uQ2FuUGxheSk7XG4gICAgICAgICAgICBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9vbkVycm9yLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX29uQ2FuUGxheSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbG9hZCA9IG5ldyBQcm9taXNlKChyZXNvbHZlKTogdm9pZCA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgICAgICAgICAgICAgc291cmNlLmxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHZpZGVvIGVycm9yIGV2ZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfb25FcnJvcihldmVudDogRXJyb3JFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgICh0aGlzLnNvdXJjZSBhcyBIVE1MVmlkZW9FbGVtZW50KS5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuX29uRXJyb3IsIHRydWUpO1xuICAgICAgICB0aGlzLm9uRXJyb3IuZW1pdChldmVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSB1bmRlcmx5aW5nIHNvdXJjZSBpcyBwbGF5aW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHBsYXlpbmcuXG4gICAgICovXG4gICAgcHJpdmF0ZSBfaXNTb3VyY2VQbGF5aW5nKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc291cmNlIGFzIEhUTUxWaWRlb0VsZW1lbnQ7XG5cbiAgICAgICAgcmV0dXJuIChzb3VyY2UuY3VycmVudFRpbWUgPiAwICYmIHNvdXJjZS5wYXVzZWQgPT09IGZhbHNlICYmIHNvdXJjZS5lbmRlZCA9PT0gZmFsc2UgJiYgc291cmNlLnJlYWR5U3RhdGUgPiAyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHVuZGVybHlpbmcgc291cmNlIGlzIHJlYWR5IGZvciBwbGF5aW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHJlYWR5LlxuICAgICAqL1xuICAgIHByaXZhdGUgX2lzU291cmNlUmVhZHkoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5zb3VyY2UgYXMgSFRNTFZpZGVvRWxlbWVudDtcblxuICAgICAgICByZXR1cm4gc291cmNlLnJlYWR5U3RhdGUgPT09IDMgfHwgc291cmNlLnJlYWR5U3RhdGUgPT09IDQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUnVucyB0aGUgdXBkYXRlIGxvb3Agd2hlbiB0aGUgdmlkZW8gaXMgcmVhZHkgdG8gcGxheVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9vblBsYXlTdGFydCgpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBKdXN0IGluIGNhc2UgdGhlIHZpZGVvIGhhcyBub3QgcmVjZWl2ZWQgaXRzIGNhbiBwbGF5IGV2ZW4geWV0Li5cbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9vbkNhblBsYXkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmF1dG9VcGRhdGUgJiYgIXRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIFRpY2tlci5zaGFyZWQuYWRkKHRoaXMudXBkYXRlLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlyZWQgd2hlbiBhIHBhdXNlIGV2ZW50IGlzIHRyaWdnZXJlZCwgc3RvcHMgdGhlIHVwZGF0ZSBsb29wXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgX29uUGxheVN0b3AoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIFRpY2tlci5zaGFyZWQucmVtb3ZlKHRoaXMudXBkYXRlLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmVkIHdoZW4gdGhlIHZpZGVvIGlzIGxvYWRlZCBhbmQgcmVhZHkgdG8gcGxheVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9vbkNhblBsYXkoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5zb3VyY2UgYXMgSFRNTFZpZGVvRWxlbWVudDtcblxuICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheScsIHRoaXMuX29uQ2FuUGxheSk7XG4gICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHRoaXMuX29uQ2FuUGxheSk7XG5cbiAgICAgICAgY29uc3QgdmFsaWQgPSB0aGlzLnZhbGlkO1xuXG4gICAgICAgIHRoaXMucmVzaXplKHNvdXJjZS52aWRlb1dpZHRoLCBzb3VyY2UudmlkZW9IZWlnaHQpO1xuXG4gICAgICAgIC8vIHByZXZlbnQgbXVsdGlwbGUgbG9hZGVkIGRpc3BhdGNoZXMuLlxuICAgICAgICBpZiAoIXZhbGlkICYmIHRoaXMuX3Jlc29sdmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9pc1NvdXJjZVBsYXlpbmcoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fb25QbGF5U3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmF1dG9QbGF5KVxuICAgICAgICB7XG4gICAgICAgICAgICBzb3VyY2UucGxheSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhpcyB0ZXh0dXJlXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgZGlzcG9zZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5faXNDb25uZWN0ZWRUb1RpY2tlcilcbiAgICAgICAge1xuICAgICAgICAgICAgVGlja2VyLnNoYXJlZC5yZW1vdmUodGhpcy51cGRhdGUsIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5zb3VyY2UgYXMgSFRNTFZpZGVvRWxlbWVudDtcblxuICAgICAgICBpZiAoc291cmNlKVxuICAgICAgICB7XG4gICAgICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9vbkVycm9yLCB0cnVlKTtcbiAgICAgICAgICAgIHNvdXJjZS5wYXVzZSgpO1xuICAgICAgICAgICAgc291cmNlLnNyYyA9ICcnO1xuICAgICAgICAgICAgc291cmNlLmxvYWQoKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlci5kaXNwb3NlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdWxkIHRoZSBiYXNlIHRleHR1cmUgYXV0b21hdGljYWxseSB1cGRhdGUgaXRzZWxmLCBzZXQgdG8gdHJ1ZSBieSBkZWZhdWx0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBhdXRvVXBkYXRlKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hdXRvVXBkYXRlO1xuICAgIH1cblxuICAgIHNldCBhdXRvVXBkYXRlKHZhbHVlOiBib29sZWFuKVxuICAgIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9hdXRvVXBkYXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hdXRvVXBkYXRlID0gdmFsdWU7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5fYXV0b1VwZGF0ZSAmJiB0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFRpY2tlci5zaGFyZWQucmVtb3ZlKHRoaXMudXBkYXRlLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9hdXRvVXBkYXRlICYmICF0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyICYmIHRoaXMuX2lzU291cmNlUGxheWluZygpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFRpY2tlci5zaGFyZWQuYWRkKHRoaXMudXBkYXRlLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhvdyBtYW55IHRpbWVzIGEgc2Vjb25kIHRvIHVwZGF0ZSB0aGUgdGV4dHVyZSBmcm9tIHRoZSB2aWRlby4gTGVhdmUgYXQgMCB0byB1cGRhdGUgYXQgZXZlcnkgcmVuZGVyLlxuICAgICAqIEEgbG93ZXIgZnBzIGNhbiBoZWxwIHBlcmZvcm1hbmNlLCBhcyB1cGRhdGluZyB0aGUgdGV4dHVyZSBhdCA2MGZwcyBvbiBhIDMwcHMgdmlkZW8gbWF5IG5vdCBiZSBlZmZpY2llbnQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHVwZGF0ZUZQUygpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVGUFM7XG4gICAgfVxuXG4gICAgc2V0IHVwZGF0ZUZQUyh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl91cGRhdGVGUFMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUZQUyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBhdXRvLWRldGVjdCB0aGUgdHlwZSBvZiByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0geyp9IHNvdXJjZSAtIFRoZSBzb3VyY2Ugb2JqZWN0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiAtIFRoZSBleHRlbnNpb24gb2Ygc291cmNlLCBpZiBzZXRcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgdmlkZW8gc291cmNlXG4gICAgICovXG4gICAgc3RhdGljIHRlc3Qoc291cmNlOiB1bmtub3duLCBleHRlbnNpb24/OiBzdHJpbmcpOiBzb3VyY2UgaXMgSFRNTFZpZGVvRWxlbWVudFxuICAgIHtcbiAgICAgICAgcmV0dXJuIChzb3VyY2UgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KVxuICAgICAgICAgICAgfHwgVmlkZW9SZXNvdXJjZS5UWVBFUy5pbmRleE9mKGV4dGVuc2lvbikgPiAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMaXN0IG9mIGNvbW1vbiB2aWRlbyBmaWxlIGV4dGVuc2lvbnMgc3VwcG9ydGVkIGJ5IFZpZGVvUmVzb3VyY2UuXG4gICAgICogQGNvbnN0YW50XG4gICAgICogQG1lbWJlciB7QXJyYXk8c3RyaW5nPn1cbiAgICAgKiBAc3RhdGljXG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgc3RhdGljIFRZUEVTID0gWydtcDQnLCAnbTR2JywgJ3dlYm0nLCAnb2dnJywgJ29ndicsICdoMjY0JywgJ2F2aScsICdtb3YnXTtcblxuICAgIC8qKlxuICAgICAqIE1hcCBvZiB2aWRlbyBNSU1FIHR5cGVzIHRoYXQgY2FuJ3QgYmUgZGlyZWN0bHkgZGVyaXZlZCBmcm9tIGZpbGUgZXh0ZW5zaW9ucy5cbiAgICAgKiBAY29uc3RhbnRcbiAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICogQHN0YXRpY1xuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHN0YXRpYyBNSU1FX1RZUEVTOiBEaWN0PHN0cmluZz4gPSB7XG4gICAgICAgIG9ndjogJ3ZpZGVvL29nZycsXG4gICAgICAgIG1vdjogJ3ZpZGVvL3F1aWNrdGltZScsXG4gICAgICAgIG00djogJ3ZpZGVvL21wNCcsXG4gICAgfTtcbn1cbiIsICJpbXBvcnQgeyBCYXNlSW1hZ2VSZXNvdXJjZSB9IGZyb20gJy4vQmFzZUltYWdlUmVzb3VyY2UnO1xuXG4vKipcbiAqIFJlc291cmNlIHR5cGUgZm9yIEltYWdlQml0bWFwLlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLnJlc291cmNlcy5CYXNlSW1hZ2VSZXNvdXJjZVxuICogQG1lbWJlcm9mIFBJWEkucmVzb3VyY2VzXG4gKiBAcGFyYW0ge0ltYWdlQml0bWFwfSBzb3VyY2UgLSBJbWFnZSBlbGVtZW50IHRvIHVzZVxuICovXG5leHBvcnQgY2xhc3MgSW1hZ2VCaXRtYXBSZXNvdXJjZSBleHRlbmRzIEJhc2VJbWFnZVJlc291cmNlXG57XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBhdXRvLWRldGVjdCB0aGUgdHlwZSBvZiByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge0ltYWdlQml0bWFwfSBzb3VyY2UgLSBUaGUgc291cmNlIG9iamVjdFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IGB0cnVlYCBpZiBzb3VyY2UgaXMgYW4gSW1hZ2VCaXRtYXBcbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChzb3VyY2U6IHVua25vd24pOiBzb3VyY2UgaXMgSW1hZ2VCaXRtYXBcbiAgICB7XG4gICAgICAgIHJldHVybiAhIXdpbmRvdy5jcmVhdGVJbWFnZUJpdG1hcCAmJiBzb3VyY2UgaW5zdGFuY2VvZiBJbWFnZUJpdG1hcDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgSU5TVEFMTEVEIH0gZnJvbSAnLi9hdXRvRGV0ZWN0UmVzb3VyY2UnO1xuaW1wb3J0IHsgQXJyYXlSZXNvdXJjZSB9IGZyb20gJy4vQXJyYXlSZXNvdXJjZSc7XG5pbXBvcnQgeyBCdWZmZXJSZXNvdXJjZSB9IGZyb20gJy4vQnVmZmVyUmVzb3VyY2UnO1xuaW1wb3J0IHsgQ2FudmFzUmVzb3VyY2UgfSBmcm9tICcuL0NhbnZhc1Jlc291cmNlJztcbmltcG9ydCB7IEN1YmVSZXNvdXJjZSB9IGZyb20gJy4vQ3ViZVJlc291cmNlJztcbmltcG9ydCB7IEltYWdlUmVzb3VyY2UgfSBmcm9tICcuL0ltYWdlUmVzb3VyY2UnO1xuaW1wb3J0IHsgU1ZHUmVzb3VyY2UgfSBmcm9tICcuL1NWR1Jlc291cmNlJztcbmltcG9ydCB7IFZpZGVvUmVzb3VyY2UgfSBmcm9tICcuL1ZpZGVvUmVzb3VyY2UnO1xuaW1wb3J0IHsgSW1hZ2VCaXRtYXBSZXNvdXJjZSB9IGZyb20gJy4vSW1hZ2VCaXRtYXBSZXNvdXJjZSc7XG5cbi8qKlxuICogQ29sbGVjdGlvbiBvZiBiYXNlIHJlc291cmNlIHR5cGVzIHN1cHBvcnRlZCBieSBQaXhpSlMuXG4gKlxuICogUmVzb3VyY2VzIGFyZSB1c2VkIGJ5IHtAbGluayBQSVhJLkJhc2VUZXh0dXJlfSB0byBoYW5kbGUgZGlmZmVyZW50IG1lZGlhIHR5cGVzXG4gKiBzdWNoIGFzIGltYWdlcywgdmlkZW8sIFNWRyBncmFwaGljcywgZXRjLiBJbiBtb3N0IHVzZS1jYXNlcywgeW91IHNob3VsZCBub3RcbiAqIGluc3RhbnRpYXRlIHRoZSByZXNvdXJjZXMgZGlyZWN0bHkuIFRoZSBlYXN5IHRoaW5nIGlzIHRvIHVzZVxuICoge0BsaW5rIFBJWEkuQmFzZVRleHR1cmUuZnJvbX0uXG4gKiBAZXhhbXBsZVxuICogY29uc3QgYmFzZVRleHR1cmUgPSBQSVhJLkJhc2VUZXh0dXJlLmZyb20oJ3BhdGgvdG8vaW1hZ2UuanBnJyk7XG4gKiBAbmFtZXNwYWNlIFBJWEkucmVzb3VyY2VzXG4gKi9cbmV4cG9ydCAqIGZyb20gJy4vUmVzb3VyY2UnO1xuZXhwb3J0ICogZnJvbSAnLi9CYXNlSW1hZ2VSZXNvdXJjZSc7XG5cbklOU1RBTExFRC5wdXNoKFxuICAgIEltYWdlUmVzb3VyY2UsXG4gICAgSW1hZ2VCaXRtYXBSZXNvdXJjZSxcbiAgICBDYW52YXNSZXNvdXJjZSxcbiAgICBWaWRlb1Jlc291cmNlLFxuICAgIFNWR1Jlc291cmNlLFxuICAgIEJ1ZmZlclJlc291cmNlLFxuICAgIEN1YmVSZXNvdXJjZSxcbiAgICBBcnJheVJlc291cmNlXG4pO1xuXG5leHBvcnQgKiBmcm9tICcuL2F1dG9EZXRlY3RSZXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL0Fic3RyYWN0TXVsdGlSZXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL0FycmF5UmVzb3VyY2UnO1xuZXhwb3J0ICogZnJvbSAnLi9CdWZmZXJSZXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL0NhbnZhc1Jlc291cmNlJztcbmV4cG9ydCAqIGZyb20gJy4vQ3ViZVJlc291cmNlJztcbmV4cG9ydCAqIGZyb20gJy4vSW1hZ2VSZXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL1NWR1Jlc291cmNlJztcbmV4cG9ydCAqIGZyb20gJy4vVmlkZW9SZXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL0ltYWdlQml0bWFwUmVzb3VyY2UnO1xuIiwgImltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuL1JlbmRlcmVyJztcblxuLyoqXG4gKiBTeXN0ZW0gaXMgYSBiYXNlIGNsYXNzIHVzZWQgZm9yIGV4dGVuZGluZyBzeXN0ZW1zIHVzZWQgYnkgdGhlIHtAbGluayBQSVhJLlJlbmRlcmVyfVxuICpcbiAqIEBzZWUgUElYSS5SZW5kZXJlciNhZGRTeXN0ZW1cbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFN5c3RlbVxue1xuICAgIC8vIHB1YmxpYyBiZWNhdXNlIG9mIEZpbHRlciB1c2FnZSxcbiAgICAvLyBwcm90ZWN0ZWQgYmVjYXVzZSB1c3VhbGx5IHJlbmRlcmVyIGl0IGFscmVhZHkga25vd24gYnkgdGhvc2Ugd2hvIHVzZSB0aGUgc3lzdGVtXG4gICAgcmVuZGVyZXI6IFJlbmRlcmVyO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBtYW5hZ2VyIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlbmRlcmVyIHRoaXMgbWFuYWdlciB3b3JrcyBmb3IuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVuZGVyZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJpYyBkZXN0cm95IG1ldGhvZHMgdG8gYmUgb3ZlcnJpZGRlbiBieSB0aGUgc3ViY2xhc3NcbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgICh0aGlzIGFzIGFueSkucmVuZGVyZXIgPSBudWxsO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBTFBIQV9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBCdWZmZXJSZXNvdXJjZSB9IGZyb20gJy4vQnVmZmVyUmVzb3VyY2UnO1xuXG5pbXBvcnQgdHlwZSB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vQmFzZVRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgR0xUZXh0dXJlIH0gZnJvbSAnLi4vR0xUZXh0dXJlJztcbi8qKlxuICogUmVzb3VyY2UgdHlwZSBmb3IgRGVwdGhUZXh0dXJlLlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLnJlc291cmNlcy5CdWZmZXJSZXNvdXJjZVxuICogQG1lbWJlcm9mIFBJWEkucmVzb3VyY2VzXG4gKi9cbmV4cG9ydCBjbGFzcyBEZXB0aFJlc291cmNlIGV4dGVuZHMgQnVmZmVyUmVzb3VyY2VcbntcbiAgICAvKipcbiAgICAgKiBVcGxvYWQgdGhlIHRleHR1cmUgdG8gdGhlIEdQVS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVXBsb2FkIHRvIHRoZSByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBSZWZlcmVuY2UgdG8gcGFyZW50IHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0xUZXh0dXJlfSBnbFRleHR1cmUgLSBnbFRleHR1cmVcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpcyBzdWNjZXNzXG4gICAgICovXG4gICAgdXBsb2FkKHJlbmRlcmVyOiBSZW5kZXJlciwgYmFzZVRleHR1cmU6IEJhc2VUZXh0dXJlLCBnbFRleHR1cmU6IEdMVGV4dHVyZSk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGNvbnN0IGdsID0gcmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgZ2wucGl4ZWxTdG9yZWkoZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCBiYXNlVGV4dHVyZS5hbHBoYU1vZGUgPT09IEFMUEhBX01PREVTLlVOUEFDSyk7XG5cbiAgICAgICAgaWYgKGdsVGV4dHVyZS53aWR0aCA9PT0gYmFzZVRleHR1cmUud2lkdGggJiYgZ2xUZXh0dXJlLmhlaWdodCA9PT0gYmFzZVRleHR1cmUuaGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICBnbC50ZXhTdWJJbWFnZTJEKFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLnRhcmdldCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS53aWR0aCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgYmFzZVRleHR1cmUuZm9ybWF0LFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsVGV4dHVyZS53aWR0aCA9IGJhc2VUZXh0dXJlLndpZHRoO1xuICAgICAgICAgICAgZ2xUZXh0dXJlLmhlaWdodCA9IGJhc2VUZXh0dXJlLmhlaWdodDtcblxuICAgICAgICAgICAgZ2wudGV4SW1hZ2UyRChcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS50YXJnZXQsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAvLyAgZ2wuREVQVEhfQ09NUE9ORU5UMTYgTmVlZGVkIGZvciBkZXB0aCB0byByZW5kZXIgcHJvcGVybHkgaW4gd2ViZ2wyLjBcbiAgICAgICAgICAgICAgICByZW5kZXJlci5jb250ZXh0LndlYkdMVmVyc2lvbiA9PT0gMSA/IGdsLkRFUFRIX0NPTVBPTkVOVCA6IGdsLkRFUFRIX0NPTVBPTkVOVDE2LFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLndpZHRoLFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLmhlaWdodCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlLmZvcm1hdCxcbiAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZS50eXBlLFxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgUnVubmVyIH0gZnJvbSAnQHBpeGkvcnVubmVyJztcbmltcG9ydCB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vdGV4dHVyZXMvQmFzZVRleHR1cmUnO1xuaW1wb3J0IHsgRGVwdGhSZXNvdXJjZSB9IGZyb20gJy4uL3RleHR1cmVzL3Jlc291cmNlcy9EZXB0aFJlc291cmNlJztcbmltcG9ydCB7IEZPUk1BVFMsIE1JUE1BUF9NT0RFUywgU0NBTEVfTU9ERVMsIFRZUEVTLCBNU0FBX1FVQUxJVFkgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IEdMRnJhbWVidWZmZXIgfSBmcm9tICcuL0dMRnJhbWVidWZmZXInO1xuXG4vKipcbiAqIEZyYW1lIGJ1ZmZlciB1c2VkIGJ5IHRoZSBCYXNlUmVuZGVyVGV4dHVyZVxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEZyYW1lYnVmZmVyXG57XG4gICAgcHVibGljIHdpZHRoOiBudW1iZXI7XG4gICAgcHVibGljIGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBtdWx0aXNhbXBsZTogTVNBQV9RVUFMSVRZO1xuICAgIHN0ZW5jaWw6IGJvb2xlYW47XG4gICAgZGVwdGg6IGJvb2xlYW47XG4gICAgZGlydHlJZDogbnVtYmVyO1xuICAgIGRpcnR5Rm9ybWF0OiBudW1iZXI7XG4gICAgZGlydHlTaXplOiBudW1iZXI7XG4gICAgZGVwdGhUZXh0dXJlOiBCYXNlVGV4dHVyZTtcbiAgICBjb2xvclRleHR1cmVzOiBBcnJheTxCYXNlVGV4dHVyZT47XG4gICAgZ2xGcmFtZWJ1ZmZlcnM6IHtba2V5OiBzdHJpbmddOiBHTEZyYW1lYnVmZmVyfTtcbiAgICBkaXNwb3NlUnVubmVyOiBSdW5uZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gV2lkdGggb2YgdGhlIGZyYW1lIGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSBIZWlnaHQgb2YgdGhlIGZyYW1lIGJ1ZmZlclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdpZHRoIG9mIGZyYW1lYnVmZmVyIGluIHBpeGVsc1xuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5jZWlsKHdpZHRoIHx8IDEwMCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIZWlnaHQgb2YgZnJhbWVidWZmZXIgaW4gcGl4ZWxzXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gTWF0aC5jZWlsKGhlaWdodCB8fCAxMDApO1xuXG4gICAgICAgIHRoaXMuc3RlbmNpbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRlcHRoID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5kaXJ0eUlkID0gMDtcbiAgICAgICAgdGhpcy5kaXJ0eUZvcm1hdCA9IDA7XG4gICAgICAgIHRoaXMuZGlydHlTaXplID0gMDtcblxuICAgICAgICB0aGlzLmRlcHRoVGV4dHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuY29sb3JUZXh0dXJlcyA9IFtdO1xuXG4gICAgICAgIHRoaXMuZ2xGcmFtZWJ1ZmZlcnMgPSB7fTtcblxuICAgICAgICB0aGlzLmRpc3Bvc2VSdW5uZXIgPSBuZXcgUnVubmVyKCdkaXNwb3NlRnJhbWVidWZmZXInKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVzaXJlZCBudW1iZXIgb2Ygc2FtcGxlcyBmb3IgYW50aWFsaWFzaW5nLiAwIG1lYW5zIEFBIHNob3VsZCBub3QgYmUgdXNlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogRXhwZXJpbWVudGFsIFdlYkdMMiBmZWF0dXJlLCBhbGxvd3MgdG8gdXNlIGFudGlhbGlhc2luZyBpbiBpbmRpdmlkdWFsIHJlbmRlclRleHR1cmVzLlxuICAgICAgICAgKiBBbnRpYWxpYXNpbmcgaXMgdGhlIHNhbWUgYXMgZm9yIG1haW4gYnVmZmVyIHdpdGggcmVuZGVyZXIgYGFudGlhbGlhczp0cnVlYCBvcHRpb25zLlxuICAgICAgICAgKiBTZXJpb3VzbHkgYWZmZWN0cyBHUFUgbWVtb3J5IGNvbnN1bXB0aW9uIGFuZCBHUFUgcGVyZm9ybWFuY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqYGBganNcbiAgICAgICAgICogcmVuZGVyVGV4dHVyZS5mcmFtZWJ1ZmZlci5tdWx0aXNhbXBsZSA9IFBJWEkuTVNBQV9RVUFMSVRZLkhJR0g7XG4gICAgICAgICAqIC8vLi4uXG4gICAgICAgICAqIHJlbmRlcmVyLnJlbmRlcihyZW5kZXJUZXh0dXJlLCBteUNvbnRhaW5lcik7XG4gICAgICAgICAqIHJlbmRlcmVyLmZyYW1lYnVmZmVyLmJsaXQoKTsgLy8gY29waWVzIGRhdGEgZnJvbSBNU0FBIGZyYW1lYnVmZmVyIHRvIHRleHR1cmVcbiAgICAgICAgICogIGBgYFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1TQUFfUVVBTElUWX1cbiAgICAgICAgICogQGRlZmF1bHQgUElYSS5NU0FBX1FVQUxJVFkuTk9ORVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tdWx0aXNhbXBsZSA9IE1TQUFfUVVBTElUWS5OT05FO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZmVyZW5jZSB0byB0aGUgY29sb3JUZXh0dXJlLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5CYXNlVGV4dHVyZVtdfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCBjb2xvclRleHR1cmUoKTogQmFzZVRleHR1cmVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yVGV4dHVyZXNbMF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHRleHR1cmUgdG8gdGhlIGNvbG9yVGV4dHVyZSBhcnJheVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtpbmRleD0wXSAtIEluZGV4IG9mIHRoZSBhcnJheSB0byBhZGQgdGhlIHRleHR1cmUgdG9cbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IFt0ZXh0dXJlXSAtIFRleHR1cmUgdG8gYWRkIHRvIHRoZSBhcnJheVxuICAgICAqL1xuICAgIGFkZENvbG9yVGV4dHVyZShpbmRleCA9IDAsIHRleHR1cmU/OiBCYXNlVGV4dHVyZSk6IHRoaXNcbiAgICB7XG4gICAgICAgIC8vIFRPRE8gYWRkIHNvbWUgdmFsaWRhdGlvbiB0byB0aGUgdGV4dHVyZSAtIHNhbWUgd2lkdGggLyBoZWlnaHQgZXRjP1xuICAgICAgICB0aGlzLmNvbG9yVGV4dHVyZXNbaW5kZXhdID0gdGV4dHVyZSB8fCBuZXcgQmFzZVRleHR1cmUobnVsbCwge1xuICAgICAgICAgICAgc2NhbGVNb2RlOiBTQ0FMRV9NT0RFUy5ORUFSRVNULFxuICAgICAgICAgICAgcmVzb2x1dGlvbjogMSxcbiAgICAgICAgICAgIG1pcG1hcDogTUlQTUFQX01PREVTLk9GRixcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5kaXJ0eUlkKys7XG4gICAgICAgIHRoaXMuZGlydHlGb3JtYXQrKztcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBkZXB0aCB0ZXh0dXJlIHRvIHRoZSBmcmFtZSBidWZmZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gW3RleHR1cmVdIC0gVGV4dHVyZSB0byBhZGRcbiAgICAgKi9cbiAgICBhZGREZXB0aFRleHR1cmUodGV4dHVyZT86IEJhc2VUZXh0dXJlKTogdGhpc1xuICAgIHtcbiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuICAgICAgICB0aGlzLmRlcHRoVGV4dHVyZSA9IHRleHR1cmUgfHwgbmV3IEJhc2VUZXh0dXJlKG5ldyBEZXB0aFJlc291cmNlKG51bGwsIHsgd2lkdGg6IHRoaXMud2lkdGgsIGhlaWdodDogdGhpcy5oZWlnaHQgfSksIHtcbiAgICAgICAgICAgIHNjYWxlTW9kZTogU0NBTEVfTU9ERVMuTkVBUkVTVCxcbiAgICAgICAgICAgIHJlc29sdXRpb246IDEsXG4gICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXG4gICAgICAgICAgICBtaXBtYXA6IE1JUE1BUF9NT0RFUy5PRkYsXG4gICAgICAgICAgICBmb3JtYXQ6IEZPUk1BVFMuREVQVEhfQ09NUE9ORU5ULFxuICAgICAgICAgICAgdHlwZTogVFlQRVMuVU5TSUdORURfU0hPUlQsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuZGlydHlJZCsrO1xuICAgICAgICB0aGlzLmRpcnR5Rm9ybWF0Kys7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIGRlcHRoIG9uIHRoZSBmcmFtZSBidWZmZXJcbiAgICAgKi9cbiAgICBlbmFibGVEZXB0aCgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLmRlcHRoID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmRpcnR5SWQrKztcbiAgICAgICAgdGhpcy5kaXJ0eUZvcm1hdCsrO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuYWJsZSBzdGVuY2lsIG9uIHRoZSBmcmFtZSBidWZmZXJcbiAgICAgKi9cbiAgICBlbmFibGVTdGVuY2lsKCk6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMuc3RlbmNpbCA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5kaXJ0eUlkKys7XG4gICAgICAgIHRoaXMuZGlydHlGb3JtYXQrKztcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNpemUgdGhlIGZyYW1lIGJ1ZmZlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gV2lkdGggb2YgdGhlIGZyYW1lIGJ1ZmZlciB0byByZXNpemUgdG9cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IC0gSGVpZ2h0IG9mIHRoZSBmcmFtZSBidWZmZXIgdG8gcmVzaXplIHRvXG4gICAgICovXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGgpO1xuICAgICAgICBoZWlnaHQgPSBNYXRoLmNlaWwoaGVpZ2h0KTtcblxuICAgICAgICBpZiAod2lkdGggPT09IHRoaXMud2lkdGggJiYgaGVpZ2h0ID09PSB0aGlzLmhlaWdodCkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5kaXJ0eUlkKys7XG4gICAgICAgIHRoaXMuZGlydHlTaXplKys7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNvbG9yVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmUgPSB0aGlzLmNvbG9yVGV4dHVyZXNbaV07XG4gICAgICAgICAgICBjb25zdCByZXNvbHV0aW9uID0gdGV4dHVyZS5yZXNvbHV0aW9uO1xuXG4gICAgICAgICAgICAvLyB0YWtlIGludG8gYWNvdW50IHRoZSBmYWN0IHRoZSB0ZXh0dXJlIG1heSBoYXZlIGEgZGlmZmVyZW50IHJlc29sdXRpb24uLlxuICAgICAgICAgICAgdGV4dHVyZS5zZXRTaXplKHdpZHRoIC8gcmVzb2x1dGlvbiwgaGVpZ2h0IC8gcmVzb2x1dGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXB0aFRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSB0aGlzLmRlcHRoVGV4dHVyZS5yZXNvbHV0aW9uO1xuXG4gICAgICAgICAgICB0aGlzLmRlcHRoVGV4dHVyZS5zZXRTaXplKHdpZHRoIC8gcmVzb2x1dGlvbiwgaGVpZ2h0IC8gcmVzb2x1dGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyBXZWJHTCByZXNvdXJjZXMgdGhhdCBhcmUgY29ubmVjdGVkIHRvIHRoaXMgZ2VvbWV0cnlcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZGlzcG9zZVJ1bm5lci5lbWl0KHRoaXMsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyBhbmQgcmVtb3ZlcyB0aGUgZGVwdGggdGV4dHVyZSBhZGRlZCB0byB0aGlzIGZyYW1lYnVmZmVyLlxuICAgICAqL1xuICAgIGRlc3Ryb3lEZXB0aFRleHR1cmUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuZGVwdGhUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRlcHRoVGV4dHVyZS5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmRlcHRoVGV4dHVyZSA9IG51bGw7XG5cbiAgICAgICAgICAgICsrdGhpcy5kaXJ0eUlkO1xuICAgICAgICAgICAgKyt0aGlzLmRpcnR5Rm9ybWF0O1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi4vdGV4dHVyZXMvQmFzZVRleHR1cmUnO1xuaW1wb3J0IHsgRnJhbWVidWZmZXIgfSBmcm9tICcuLi9mcmFtZWJ1ZmZlci9GcmFtZWJ1ZmZlcic7XG5cbmltcG9ydCB0eXBlIHsgSUJhc2VUZXh0dXJlT3B0aW9ucyB9IGZyb20gJy4uL3RleHR1cmVzL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgTWFza0RhdGEgfSBmcm9tICcuLi9tYXNrL01hc2tEYXRhJztcblxuZXhwb3J0IGludGVyZmFjZSBCYXNlUmVuZGVyVGV4dHVyZSBleHRlbmRzIEdsb2JhbE1peGlucy5CYXNlUmVuZGVyVGV4dHVyZSwgQmFzZVRleHR1cmUge31cblxuLyoqXG4gKiBBIEJhc2VSZW5kZXJUZXh0dXJlIGlzIGEgc3BlY2lhbCB0ZXh0dXJlIHRoYXQgYWxsb3dzIGFueSBQaXhpSlMgZGlzcGxheSBvYmplY3QgdG8gYmUgcmVuZGVyZWQgdG8gaXQuXG4gKlxuICogX19IaW50X186IEFsbCBEaXNwbGF5T2JqZWN0cyAoaS5lLiBTcHJpdGVzKSB0aGF0IHJlbmRlciB0byBhIEJhc2VSZW5kZXJUZXh0dXJlIHNob3VsZCBiZSBwcmVsb2FkZWRcbiAqIG90aGVyd2lzZSBibGFjayByZWN0YW5nbGVzIHdpbGwgYmUgZHJhd24gaW5zdGVhZC5cbiAqXG4gKiBBIEJhc2VSZW5kZXJUZXh0dXJlIHRha2VzIGEgc25hcHNob3Qgb2YgYW55IERpc3BsYXkgT2JqZWN0IGdpdmVuIHRvIGl0cyByZW5kZXIgbWV0aG9kLiBUaGUgcG9zaXRpb25cbiAqIGFuZCByb3RhdGlvbiBvZiB0aGUgZ2l2ZW4gRGlzcGxheSBPYmplY3RzIGlzIGlnbm9yZWQuIEZvciBleGFtcGxlOlxuICpcbiAqIGBgYGpzXG4gKiBsZXQgcmVuZGVyZXIgPSBQSVhJLmF1dG9EZXRlY3RSZW5kZXJlcigpO1xuICogbGV0IGJhc2VSZW5kZXJUZXh0dXJlID0gbmV3IFBJWEkuQmFzZVJlbmRlclRleHR1cmUoeyB3aWR0aDogODAwLCBoZWlnaHQ6IDYwMCB9KTtcbiAqIGxldCByZW5kZXJUZXh0dXJlID0gbmV3IFBJWEkuUmVuZGVyVGV4dHVyZShiYXNlUmVuZGVyVGV4dHVyZSk7XG4gKiBsZXQgc3ByaXRlID0gUElYSS5TcHJpdGUuZnJvbShcInNwaW5PYmpfMDEucG5nXCIpO1xuICpcbiAqIHNwcml0ZS5wb3NpdGlvbi54ID0gODAwLzI7XG4gKiBzcHJpdGUucG9zaXRpb24ueSA9IDYwMC8yO1xuICogc3ByaXRlLmFuY2hvci54ID0gMC41O1xuICogc3ByaXRlLmFuY2hvci55ID0gMC41O1xuICpcbiAqIHJlbmRlcmVyLnJlbmRlcihzcHJpdGUsIHJlbmRlclRleHR1cmUpO1xuICogYGBgXG4gKlxuICogVGhlIFNwcml0ZSBpbiB0aGlzIGNhc2Ugd2lsbCBiZSByZW5kZXJlZCB1c2luZyBpdHMgbG9jYWwgdHJhbnNmb3JtLiBUbyByZW5kZXIgdGhpcyBzcHJpdGUgYXQgMCwwXG4gKiB5b3UgY2FuIGNsZWFyIHRoZSB0cmFuc2Zvcm1cbiAqXG4gKiBgYGBqc1xuICpcbiAqIHNwcml0ZS5zZXRUcmFuc2Zvcm0oKVxuICpcbiAqIGxldCBiYXNlUmVuZGVyVGV4dHVyZSA9IG5ldyBQSVhJLkJhc2VSZW5kZXJUZXh0dXJlKHsgd2lkdGg6IDEwMCwgaGVpZ2h0OiAxMDAgfSk7XG4gKiBsZXQgcmVuZGVyVGV4dHVyZSA9IG5ldyBQSVhJLlJlbmRlclRleHR1cmUoYmFzZVJlbmRlclRleHR1cmUpO1xuICpcbiAqIHJlbmRlcmVyLnJlbmRlcihzcHJpdGUsIHJlbmRlclRleHR1cmUpOyAgLy8gUmVuZGVycyB0byBjZW50ZXIgb2YgUmVuZGVyVGV4dHVyZVxuICogYGBgXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkJhc2VUZXh0dXJlXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQmFzZVJlbmRlclRleHR1cmUgZXh0ZW5kcyBCYXNlVGV4dHVyZVxue1xuICAgIHB1YmxpYyBjbGVhckNvbG9yOiBudW1iZXJbXTtcbiAgICBwdWJsaWMgZnJhbWVidWZmZXI6IEZyYW1lYnVmZmVyO1xuICAgIG1hc2tTdGFjazogQXJyYXk8TWFza0RhdGE+O1xuICAgIGZpbHRlclN0YWNrOiBBcnJheTxhbnk+O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc11cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGg9MTAwXSAtIFRoZSB3aWR0aCBvZiB0aGUgYmFzZSByZW5kZXIgdGV4dHVyZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuaGVpZ2h0PTEwMF0gLSBUaGUgaGVpZ2h0IG9mIHRoZSBiYXNlIHJlbmRlciB0ZXh0dXJlLlxuICAgICAqIEBwYXJhbSB7UElYSS5TQ0FMRV9NT0RFU30gW29wdGlvbnMuc2NhbGVNb2RlXSAtIFNlZSB7QGxpbmsgUElYSS5TQ0FMRV9NT0RFU30gZm9yIHBvc3NpYmxlIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMucmVzb2x1dGlvbj0xXSAtIFRoZSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIHRoZSB0ZXh0dXJlIGJlaW5nIGdlbmVyYXRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zKVxuICAgIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnbnVtYmVyJylcbiAgICAgICAge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLXJlc3QtcGFyYW1zICovXG4gICAgICAgICAgICAvLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IG9mIHNpZ25hdHVyZVxuICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICBjb25zdCBzY2FsZU1vZGUgPSBhcmd1bWVudHNbMl07XG4gICAgICAgICAgICBjb25zdCByZXNvbHV0aW9uID0gYXJndW1lbnRzWzNdO1xuXG4gICAgICAgICAgICBvcHRpb25zID0geyB3aWR0aCwgaGVpZ2h0LCBzY2FsZU1vZGUsIHJlc29sdXRpb24gfTtcbiAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgcHJlZmVyLXJlc3QtcGFyYW1zICovXG4gICAgICAgIH1cblxuICAgICAgICBzdXBlcihudWxsLCBvcHRpb25zKTtcblxuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgICAgLy8gU2V0IGRlZmF1bHRzXG4gICAgICAgIHRoaXMubWlwbWFwID0gMDtcbiAgICAgICAgdGhpcy53aWR0aCA9IE1hdGguY2VpbCh3aWR0aCkgfHwgMTAwO1xuICAgICAgICB0aGlzLmhlaWdodCA9IE1hdGguY2VpbChoZWlnaHQpIHx8IDEwMDtcbiAgICAgICAgdGhpcy52YWxpZCA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5jbGVhckNvbG9yID0gWzAsIDAsIDAsIDBdO1xuXG4gICAgICAgIHRoaXMuZnJhbWVidWZmZXIgPSBuZXcgRnJhbWVidWZmZXIodGhpcy53aWR0aCAqIHRoaXMucmVzb2x1dGlvbiwgdGhpcy5oZWlnaHQgKiB0aGlzLnJlc29sdXRpb24pXG4gICAgICAgICAgICAuYWRkQ29sb3JUZXh0dXJlKDAsIHRoaXMpO1xuXG4gICAgICAgIC8vIFRPRE8gLSBjb3VsZCB0aGlzIGJlIGFkZGVkIHRoZSBzeXN0ZW1zP1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZGF0YSBzdHJ1Y3R1cmUgZm9yIHRoZSBzdGVuY2lsIG1hc2tzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1hc2tEYXRhW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hc2tTdGFjayA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZGF0YSBzdHJ1Y3R1cmUgZm9yIHRoZSBmaWx0ZXJzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyU3RhY2sgPSBbe31dO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2l6ZXMgdGhlIEJhc2VSZW5kZXJUZXh0dXJlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gVGhlIHdpZHRoIHRvIHJlc2l6ZSB0by5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IC0gVGhlIGhlaWdodCB0byByZXNpemUgdG8uXG4gICAgICovXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGgpO1xuICAgICAgICBoZWlnaHQgPSBNYXRoLmNlaWwoaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5mcmFtZWJ1ZmZlci5yZXNpemUod2lkdGggKiB0aGlzLnJlc29sdXRpb24sIGhlaWdodCAqIHRoaXMucmVzb2x1dGlvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnJlZXMgdGhlIHRleHR1cmUgYW5kIGZyYW1lYnVmZmVyIGZyb20gV2ViR0wgbWVtb3J5IHdpdGhvdXQgZGVzdHJveWluZyB0aGlzIHRleHR1cmUgb2JqZWN0LlxuICAgICAqIFRoaXMgbWVhbnMgeW91IGNhbiBzdGlsbCB1c2UgdGhlIHRleHR1cmUgbGF0ZXIgd2hpY2ggd2lsbCB1cGxvYWQgaXQgdG8gR1BVXG4gICAgICogbWVtb3J5IGFnYWluLlxuICAgICAqXG4gICAgICogQGZpcmVzIFBJWEkuQmFzZVRleHR1cmUjZGlzcG9zZVxuICAgICAqL1xuICAgIGRpc3Bvc2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5mcmFtZWJ1ZmZlci5kaXNwb3NlKCk7XG5cbiAgICAgICAgc3VwZXIuZGlzcG9zZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgdGV4dHVyZS5cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyLmRlc3Ryb3lEZXB0aFRleHR1cmUoKTtcbiAgICAgICAgdGhpcy5mcmFtZWJ1ZmZlciA9IG51bGw7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IGdyb3VwRDggfSBmcm9tICdAcGl4aS9tYXRoJztcblxuaW1wb3J0IHR5cGUgeyBSZWN0YW5nbGUsIElTaXplIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogU3RvcmVzIGEgdGV4dHVyZSdzIGZyYW1lIGluIFVWIGNvb3JkaW5hdGVzLCBpblxuICogd2hpY2ggZXZlcnl0aGluZyBsaWVzIGluIHRoZSByZWN0YW5nbGUgYFsoMCwwKSwgKDEsMCksXG4gKiAoMSwxKSwgKDAsMSldYC5cbiAqXG4gKiB8IENvcm5lciAgICAgICB8IENvb3JkaW5hdGVzIHxcbiAqIHwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tfFxuICogfCBUb3AtTGVmdCAgICAgfCBgKHgwLHkwKWAgICB8XG4gKiB8IFRvcC1SaWdodCAgICB8IGAoeDEseTEpYCAgIHxcbiAqIHwgQm90dG9tLVJpZ2h0IHwgYCh4Mix5MilgICAgfFxuICogfCBCb3R0b20tTGVmdCAgfCBgKHgzLHkzKWAgICB8XG4gKlxuICogQGNsYXNzXG4gKiBAcHJvdGVjdGVkXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgVGV4dHVyZVV2c1xue1xuICAgIHB1YmxpYyB4MDogbnVtYmVyO1xuICAgIHB1YmxpYyB5MDogbnVtYmVyO1xuICAgIHB1YmxpYyB4MTogbnVtYmVyO1xuICAgIHB1YmxpYyB5MTogbnVtYmVyO1xuICAgIHB1YmxpYyB4MjogbnVtYmVyO1xuICAgIHB1YmxpYyB5MjogbnVtYmVyO1xuICAgIHB1YmxpYyB4MzogbnVtYmVyO1xuICAgIHB1YmxpYyB5MzogbnVtYmVyO1xuICAgIHB1YmxpYyB1dnNGbG9hdDMyOiBGbG9hdDMyQXJyYXk7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogWC1jb21wb25lbnQgb2YgdG9wLWxlZnQgY29ybmVyIGAoeDAseTApYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy54MCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFktY29tcG9uZW50IG9mIHRvcC1sZWZ0IGNvcm5lciBgKHgwLHkwKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueTAgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBYLWNvbXBvbmVudCBvZiB0b3AtcmlnaHQgY29ybmVyIGAoeDEseTEpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy54MSA9IDE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFktY29tcG9uZW50IG9mIHRvcC1yaWdodCBjb3JuZXIgYCh4MSx5MSlgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnkxID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogWC1jb21wb25lbnQgb2YgYm90dG9tLXJpZ2h0IGNvcm5lciBgKHgyLHkyKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueDIgPSAxO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBZLWNvbXBvbmVudCBvZiBib3R0b20tcmlnaHQgY29ybmVyIGAoeDIseTIpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55MiA9IDE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFgtY29tcG9uZW50IG9mIGJvdHRvbS1sZWZ0IGNvcm5lciBgKHgzLHkzKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueDMgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBZLWNvbXBvbmVudCBvZiBib3R0b20tcmlnaHQgY29ybmVyIGAoeDMseTMpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy55MyA9IDE7XG5cbiAgICAgICAgdGhpcy51dnNGbG9hdDMyID0gbmV3IEZsb2F0MzJBcnJheSg4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB0ZXh0dXJlIFV2cyBiYXNlZCBvbiB0aGUgZ2l2ZW4gZnJhbWUgaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gZnJhbWUgLSBUaGUgZnJhbWUgb2YgdGhlIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBiYXNlRnJhbWUgLSBUaGUgYmFzZSBmcmFtZSBvZiB0aGUgdGV4dHVyZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3RhdGUgLSBSb3RhdGlvbiBvZiBmcmFtZSwgc2VlIHtAbGluayBQSVhJLmdyb3VwRDh9XG4gICAgICovXG4gICAgc2V0KGZyYW1lOiBSZWN0YW5nbGUsIGJhc2VGcmFtZTogSVNpemUsIHJvdGF0ZTogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdHcgPSBiYXNlRnJhbWUud2lkdGg7XG4gICAgICAgIGNvbnN0IHRoID0gYmFzZUZyYW1lLmhlaWdodDtcblxuICAgICAgICBpZiAocm90YXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB3aWR0aCBhbmQgaGVpZ2h0IGRpdiAyIGRpdiBiYXNlRnJhbWUgc2l6ZVxuICAgICAgICAgICAgY29uc3QgdzIgPSBmcmFtZS53aWR0aCAvIDIgLyB0dztcbiAgICAgICAgICAgIGNvbnN0IGgyID0gZnJhbWUuaGVpZ2h0IC8gMiAvIHRoO1xuXG4gICAgICAgICAgICAvLyBjb29yZGluYXRlcyBvZiBjZW50ZXJcbiAgICAgICAgICAgIGNvbnN0IGNYID0gKGZyYW1lLnggLyB0dykgKyB3MjtcbiAgICAgICAgICAgIGNvbnN0IGNZID0gKGZyYW1lLnkgLyB0aCkgKyBoMjtcblxuICAgICAgICAgICAgcm90YXRlID0gZ3JvdXBEOC5hZGQocm90YXRlLCBncm91cEQ4Lk5XKTsgLy8gTlcgaXMgdG9wLWxlZnQgY29ybmVyXG4gICAgICAgICAgICB0aGlzLngwID0gY1ggKyAodzIgKiBncm91cEQ4LnVYKHJvdGF0ZSkpO1xuICAgICAgICAgICAgdGhpcy55MCA9IGNZICsgKGgyICogZ3JvdXBEOC51WShyb3RhdGUpKTtcblxuICAgICAgICAgICAgcm90YXRlID0gZ3JvdXBEOC5hZGQocm90YXRlLCAyKTsgLy8gcm90YXRlIDkwIGRlZ3JlZXMgY2xvY2t3aXNlXG4gICAgICAgICAgICB0aGlzLngxID0gY1ggKyAodzIgKiBncm91cEQ4LnVYKHJvdGF0ZSkpO1xuICAgICAgICAgICAgdGhpcy55MSA9IGNZICsgKGgyICogZ3JvdXBEOC51WShyb3RhdGUpKTtcblxuICAgICAgICAgICAgcm90YXRlID0gZ3JvdXBEOC5hZGQocm90YXRlLCAyKTtcbiAgICAgICAgICAgIHRoaXMueDIgPSBjWCArICh3MiAqIGdyb3VwRDgudVgocm90YXRlKSk7XG4gICAgICAgICAgICB0aGlzLnkyID0gY1kgKyAoaDIgKiBncm91cEQ4LnVZKHJvdGF0ZSkpO1xuXG4gICAgICAgICAgICByb3RhdGUgPSBncm91cEQ4LmFkZChyb3RhdGUsIDIpO1xuICAgICAgICAgICAgdGhpcy54MyA9IGNYICsgKHcyICogZ3JvdXBEOC51WChyb3RhdGUpKTtcbiAgICAgICAgICAgIHRoaXMueTMgPSBjWSArIChoMiAqIGdyb3VwRDgudVkocm90YXRlKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLngwID0gZnJhbWUueCAvIHR3O1xuICAgICAgICAgICAgdGhpcy55MCA9IGZyYW1lLnkgLyB0aDtcblxuICAgICAgICAgICAgdGhpcy54MSA9IChmcmFtZS54ICsgZnJhbWUud2lkdGgpIC8gdHc7XG4gICAgICAgICAgICB0aGlzLnkxID0gZnJhbWUueSAvIHRoO1xuXG4gICAgICAgICAgICB0aGlzLngyID0gKGZyYW1lLnggKyBmcmFtZS53aWR0aCkgLyB0dztcbiAgICAgICAgICAgIHRoaXMueTIgPSAoZnJhbWUueSArIGZyYW1lLmhlaWdodCkgLyB0aDtcblxuICAgICAgICAgICAgdGhpcy54MyA9IGZyYW1lLnggLyB0dztcbiAgICAgICAgICAgIHRoaXMueTMgPSAoZnJhbWUueSArIGZyYW1lLmhlaWdodCkgLyB0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXZzRmxvYXQzMlswXSA9IHRoaXMueDA7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMlsxXSA9IHRoaXMueTA7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMlsyXSA9IHRoaXMueDE7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMlszXSA9IHRoaXMueTE7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMls0XSA9IHRoaXMueDI7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMls1XSA9IHRoaXMueTI7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMls2XSA9IHRoaXMueDM7XG4gICAgICAgIHRoaXMudXZzRmxvYXQzMls3XSA9IHRoaXMueTM7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEJhc2VUZXh0dXJlIH0gZnJvbSAnLi9CYXNlVGV4dHVyZSc7XG5pbXBvcnQgeyBJbWFnZVJlc291cmNlIH0gZnJvbSAnLi9yZXNvdXJjZXMvSW1hZ2VSZXNvdXJjZSc7XG5pbXBvcnQgeyBDYW52YXNSZXNvdXJjZSB9IGZyb20gJy4vcmVzb3VyY2VzL0NhbnZhc1Jlc291cmNlJztcbmltcG9ydCB7IFRleHR1cmVVdnMgfSBmcm9tICcuL1RleHR1cmVVdnMnO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5pbXBvcnQgeyBSZWN0YW5nbGUsIFBvaW50IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyB1aWQsIFRleHR1cmVDYWNoZSwgZ2V0UmVzb2x1dGlvbk9mVXJsLCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmltcG9ydCB0eXBlIHsgSVBvaW50RGF0YSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHR5cGUgeyBJQmFzZVRleHR1cmVPcHRpb25zLCBJbWFnZVNvdXJjZSB9IGZyb20gJy4vQmFzZVRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBUZXh0dXJlTWF0cml4IH0gZnJvbSAnLi9UZXh0dXJlTWF0cml4JztcblxuY29uc3QgREVGQVVMVF9VVlMgPSBuZXcgVGV4dHVyZVV2cygpO1xuXG5leHBvcnQgdHlwZSBUZXh0dXJlU291cmNlID0gc3RyaW5nfEJhc2VUZXh0dXJlfEltYWdlU291cmNlO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRleHR1cmUgZXh0ZW5kcyBHbG9iYWxNaXhpbnMuVGV4dHVyZSwgRXZlbnRFbWl0dGVyIHt9XG5cbi8qKlxuICogQSB0ZXh0dXJlIHN0b3JlcyB0aGUgaW5mb3JtYXRpb24gdGhhdCByZXByZXNlbnRzIGFuIGltYWdlIG9yIHBhcnQgb2YgYW4gaW1hZ2UuXG4gKlxuICogSXQgY2Fubm90IGJlIGFkZGVkIHRvIHRoZSBkaXNwbGF5IGxpc3QgZGlyZWN0bHk7IGluc3RlYWQgdXNlIGl0IGFzIHRoZSB0ZXh0dXJlIGZvciBhIFNwcml0ZS5cbiAqIElmIG5vIGZyYW1lIGlzIHByb3ZpZGVkIGZvciBhIHRleHR1cmUsIHRoZW4gdGhlIHdob2xlIGltYWdlIGlzIHVzZWQuXG4gKlxuICogWW91IGNhbiBkaXJlY3RseSBjcmVhdGUgYSB0ZXh0dXJlIGZyb20gYW4gaW1hZ2UgYW5kIHRoZW4gcmV1c2UgaXQgbXVsdGlwbGUgdGltZXMgbGlrZSB0aGlzIDpcbiAqXG4gKiBgYGBqc1xuICogbGV0IHRleHR1cmUgPSBQSVhJLlRleHR1cmUuZnJvbSgnYXNzZXRzL2ltYWdlLnBuZycpO1xuICogbGV0IHNwcml0ZTEgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiBsZXQgc3ByaXRlMiA9IG5ldyBQSVhJLlNwcml0ZSh0ZXh0dXJlKTtcbiAqIGBgYFxuICpcbiAqIElmIHlvdSBkaWRudCBwYXNzIHRoZSB0ZXh0dXJlIGZyYW1lIHRvIGNvbnN0cnVjdG9yLCBpdCBlbmFibGVzIGBub0ZyYW1lYCBtb2RlOlxuICogaXQgc3Vic2NyaWJlcyBvbiBiYXNlVGV4dHVyZSBldmVudHMsIGl0IGF1dG9tYXRpY2FsbHkgcmVzaXplcyBhdCB0aGUgc2FtZSB0aW1lIGFzIGJhc2VUZXh0dXJlLlxuICpcbiAqIFRleHR1cmVzIG1hZGUgZnJvbSBTVkdzLCBsb2FkZWQgb3Igbm90LCBjYW5ub3QgYmUgdXNlZCBiZWZvcmUgdGhlIGZpbGUgZmluaXNoZXMgcHJvY2Vzc2luZy5cbiAqIFlvdSBjYW4gY2hlY2sgZm9yIHRoaXMgYnkgY2hlY2tpbmcgdGhlIHNwcml0ZSdzIF90ZXh0dXJlSUQgcHJvcGVydHkuXG4gKiBgYGBqc1xuICogdmFyIHRleHR1cmUgPSBQSVhJLlRleHR1cmUuZnJvbSgnYXNzZXRzL2ltYWdlLnN2ZycpO1xuICogdmFyIHNwcml0ZTEgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XG4gKiAvL3Nwcml0ZTEuX3RleHR1cmVJRCBzaG91bGQgbm90IGJlIHVuZGVmaW5lZCBpZiB0aGUgdGV4dHVyZSBoYXMgZmluaXNoZWQgcHJvY2Vzc2luZyB0aGUgU1ZHIGZpbGVcbiAqIGBgYFxuICogWW91IGNhbiB1c2UgYSB0aWNrZXIgb3IgckFGIHRvIGVuc3VyZSB5b3VyIHNwcml0ZXMgbG9hZCB0aGUgZmluaXNoZWQgdGV4dHVyZXMgYWZ0ZXIgcHJvY2Vzc2luZy4gU2VlIGlzc3VlICMzMDY4LlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS51dGlscy5FdmVudEVtaXR0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0dXJlIGV4dGVuZHMgRXZlbnRFbWl0dGVyXG57XG4gICAgcHVibGljIGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZTtcbiAgICBwdWJsaWMgb3JpZzogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyB0cmltOiBSZWN0YW5nbGU7XG4gICAgcHVibGljIHZhbGlkOiBib29sZWFuO1xuICAgIHB1YmxpYyBub0ZyYW1lOiBib29sZWFuO1xuICAgIHB1YmxpYyBkZWZhdWx0QW5jaG9yOiBQb2ludDtcbiAgICBwdWJsaWMgdXZNYXRyaXg6IFRleHR1cmVNYXRyaXg7XG4gICAgcHJvdGVjdGVkIF9yb3RhdGU6IG51bWJlcjtcbiAgICBfdXBkYXRlSUQ6IG51bWJlcjtcbiAgICBfZnJhbWU6IFJlY3RhbmdsZTtcbiAgICBfdXZzOiBUZXh0dXJlVXZzO1xuICAgIHRleHR1cmVDYWNoZUlkczogQXJyYXk8c3RyaW5nPjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gYmFzZVRleHR1cmUgLSBUaGUgYmFzZSB0ZXh0dXJlIHNvdXJjZSB0byBjcmVhdGUgdGhlIHRleHR1cmUgZnJvbVxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtmcmFtZV0gLSBUaGUgcmVjdGFuZ2xlIGZyYW1lIG9mIHRoZSB0ZXh0dXJlIHRvIHNob3dcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBbb3JpZ10gLSBUaGUgYXJlYSBvZiBvcmlnaW5hbCB0ZXh0dXJlXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gW3RyaW1dIC0gVHJpbW1lZCByZWN0YW5nbGUgb2Ygb3JpZ2luYWwgdGV4dHVyZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcm90YXRlXSAtIGluZGljYXRlcyBob3cgdGhlIHRleHR1cmUgd2FzIHJvdGF0ZWQgYnkgdGV4dHVyZSBwYWNrZXIuIFNlZSB7QGxpbmsgUElYSS5ncm91cEQ4fVxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBbYW5jaG9yXSAtIERlZmF1bHQgYW5jaG9yIHBvaW50IHVzZWQgZm9yIHNwcml0ZSBwbGFjZW1lbnQgLyByb3RhdGlvblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZSwgZnJhbWU/OiBSZWN0YW5nbGUsXG4gICAgICAgIG9yaWc/OiBSZWN0YW5nbGUsIHRyaW0/OiBSZWN0YW5nbGUsIHJvdGF0ZT86IG51bWJlciwgYW5jaG9yPzogSVBvaW50RGF0YSlcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERvZXMgdGhpcyBUZXh0dXJlIGhhdmUgYW55IGZyYW1lIGRhdGEgYXNzaWduZWQgdG8gaXQ/XG4gICAgICAgICAqXG4gICAgICAgICAqIFRoaXMgbW9kZSBpcyBlbmFibGVkIGF1dG9tYXRpY2FsbHkgaWYgbm8gZnJhbWUgd2FzIHBhc3NlZCBpbnNpZGUgY29uc3RydWN0b3IuXG4gICAgICAgICAqXG4gICAgICAgICAqIEluIHRoaXMgbW9kZSB0ZXh0dXJlIGlzIHN1YnNjcmliZWQgdG8gYmFzZVRleHR1cmUgZXZlbnRzLCBhbmQgZmlyZXMgYHVwZGF0ZWAgb24gYW55IGNoYW5nZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQmV3YXJlLCBhZnRlciBsb2FkaW5nIG9yIHJlc2l6ZSBvZiBiYXNlVGV4dHVyZSBldmVudCBjYW4gZmlyZWQgdHdvIHRpbWVzIVxuICAgICAgICAgKiBJZiB5b3Ugd2FudCBtb3JlIGNvbnRyb2wsIHN1YnNjcmliZSBvbiBiYXNlVGV4dHVyZSBpdHNlbGYuXG4gICAgICAgICAqXG4gICAgICAgICAqIGBgYGpzXG4gICAgICAgICAqIHRleHR1cmUub24oJ3VwZGF0ZScsICgpID0+IHt9KTtcbiAgICAgICAgICogYGBgXG4gICAgICAgICAqXG4gICAgICAgICAqIEFueSBhc3NpZ25tZW50IG9mIGBmcmFtZWAgc3dpdGNoZXMgb2ZmIGBub0ZyYW1lYCBtb2RlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ub0ZyYW1lID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKCFmcmFtZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5ub0ZyYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgIGZyYW1lID0gbmV3IFJlY3RhbmdsZSgwLCAwLCAxLCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChiYXNlVGV4dHVyZSBpbnN0YW5jZW9mIFRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJhc2VUZXh0dXJlID0gYmFzZVRleHR1cmUuYmFzZVRleHR1cmU7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGJhc2UgdGV4dHVyZSB0aGF0IHRoaXMgdGV4dHVyZSB1c2VzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5iYXNlVGV4dHVyZSA9IGJhc2VUZXh0dXJlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIGlzIHRoZSBhcmVhIG9mIHRoZSBCYXNlVGV4dHVyZSBpbWFnZSB0byBhY3R1YWxseSBjb3B5IHRvIHRoZSBDYW52YXMgLyBXZWJHTCB3aGVuIHJlbmRlcmluZyxcbiAgICAgICAgICogaXJyZXNwZWN0aXZlIG9mIHRoZSBhY3R1YWwgZnJhbWUgc2l6ZSBvciBwbGFjZW1lbnQgKHdoaWNoIGNhbiBiZSBpbmZsdWVuY2VkIGJ5IHRyaW1tZWQgdGV4dHVyZSBhdGxhc2VzKVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2ZyYW1lID0gZnJhbWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgaXMgdGhlIHRyaW1tZWQgYXJlYSBvZiBvcmlnaW5hbCB0ZXh0dXJlLCBiZWZvcmUgaXQgd2FzIHB1dCBpbiBhdGxhc1xuICAgICAgICAgKiBQbGVhc2UgY2FsbCBgdXBkYXRlVXZzKClgIGFmdGVyIHlvdSBjaGFuZ2UgY29vcmRpbmF0ZXMgb2YgYHRyaW1gIG1hbnVhbGx5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHJpbSA9IHRyaW07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgd2lsbCBsZXQgdGhlIHJlbmRlcmVyIGtub3cgaWYgdGhlIHRleHR1cmUgaXMgdmFsaWQuIElmIGl0J3Mgbm90IHRoZW4gaXQgY2Fubm90IGJlIHJlbmRlcmVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgV2ViR0wgVVYgZGF0YSBjYWNoZS4gQ2FuIGJlIHVzZWQgYXMgcXVhZCBVVlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlRleHR1cmVVdnN9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3V2cyA9IERFRkFVTFRfVVZTO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWZhdWx0IFRleHR1cmVNYXRyaXggaW5zdGFuY2UgZm9yIHRoaXMgdGV4dHVyZVxuICAgICAgICAgKiBCeSBkZWZhdWx0IHRoYXQgb2JqZWN0IGlzIG5vdCBjcmVhdGVkIGJlY2F1c2UgaXRzIGhlYXZ5XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZU1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZNYXRyaXggPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIGlzIHRoZSBhcmVhIG9mIG9yaWdpbmFsIHRleHR1cmUsIGJlZm9yZSBpdCB3YXMgcHV0IGluIGF0bGFzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcmlnID0gb3JpZyB8fCBmcmFtZTsvLyBuZXcgUmVjdGFuZ2xlKDAsIDAsIDEsIDEpO1xuXG4gICAgICAgIHRoaXMuX3JvdGF0ZSA9IE51bWJlcihyb3RhdGUgfHwgMCk7XG5cbiAgICAgICAgaWYgKHJvdGF0ZSBhcyBhbnkgPT09IHRydWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgb2xkIHRleHR1cmVwYWNrZXIgbGVnYWN5LCBzb21lIGdhbWVzL2xpYnJhcmllcyBhcmUgcGFzc2luZyBcInRydWVcIiBmb3Igcm90YXRlZCB0ZXh0dXJlc1xuICAgICAgICAgICAgdGhpcy5fcm90YXRlID0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9yb3RhdGUgJSAyICE9PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2F0dGVtcHQgdG8gdXNlIGRpYW1vbmQtc2hhcGVkIFVWcy4gSWYgeW91IGFyZSBzdXJlLCBzZXQgcm90YXRpb24gbWFudWFsbHknKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbmNob3IgcG9pbnQgdGhhdCBpcyB1c2VkIGFzIGRlZmF1bHQgaWYgc3ByaXRlIGlzIGNyZWF0ZWQgd2l0aCB0aGlzIHRleHR1cmUuXG4gICAgICAgICAqIENoYW5naW5nIHRoZSBgZGVmYXVsdEFuY2hvcmAgYXQgYSBsYXRlciBwb2ludCBvZiB0aW1lIHdpbGwgbm90IHVwZGF0ZSBTcHJpdGUncyBhbmNob3IgcG9pbnQuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUG9pbnR9XG4gICAgICAgICAqIEBkZWZhdWx0IHswLDB9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlZmF1bHRBbmNob3IgPSBhbmNob3IgPyBuZXcgUG9pbnQoYW5jaG9yLngsIGFuY2hvci55KSA6IG5ldyBQb2ludCgwLCAwKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIElEIGlzIG9ic2VydmVkIGJ5IHNwcml0ZXMgYW5kIFRleHR1cmVNYXRyaXggaW5zdGFuY2VzLlxuICAgICAgICAgKiBDYWxsIHVwZGF0ZVV2cygpIHRvIGluY3JlbWVudCBpdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZUlEID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGlkcyB1bmRlciB3aGljaCB0aGlzIFRleHR1cmUgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHRleHR1cmUgY2FjaGUuIFRoaXMgaXNcbiAgICAgICAgICogYXV0b21hdGljYWxseSBzZXQgYXMgbG9uZyBhcyBUZXh0dXJlLmFkZFRvQ2FjaGUgaXMgdXNlZCwgYnV0IG1heSBub3QgYmUgc2V0IGlmIGFcbiAgICAgICAgICogVGV4dHVyZSBpcyBhZGRlZCBkaXJlY3RseSB0byB0aGUgVGV4dHVyZUNhY2hlIGFycmF5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmdbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGV4dHVyZUNhY2hlSWRzID0gW107XG5cbiAgICAgICAgaWYgKCFiYXNlVGV4dHVyZS52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgYmFzZVRleHR1cmUub25jZSgnbG9hZGVkJywgdGhpcy5vbkJhc2VUZXh0dXJlVXBkYXRlZCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5ub0ZyYW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBmcmFtZSB3ZSBzaG91bGQgbW9uaXRvciBmb3IgYW55IGJhc2UgdGV4dHVyZSBjaGFuZ2VzLi5cbiAgICAgICAgICAgIGlmIChiYXNlVGV4dHVyZS52YWxpZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQmFzZVRleHR1cmVVcGRhdGVkKGJhc2VUZXh0dXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZnJhbWUgPSBmcmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm5vRnJhbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJhc2VUZXh0dXJlLm9uKCd1cGRhdGUnLCB0aGlzLm9uQmFzZVRleHR1cmVVcGRhdGVkLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhpcyB0ZXh0dXJlIG9uIHRoZSBncHUuXG4gICAgICpcbiAgICAgKiBDYWxscyB0aGUgVGV4dHVyZVJlc291cmNlIHVwZGF0ZS5cbiAgICAgKlxuICAgICAqIElmIHlvdSBhZGp1c3RlZCBgZnJhbWVgIG1hbnVhbGx5LCBwbGVhc2UgY2FsbCBgdXBkYXRlVXZzKClgIGluc3RlYWQuXG4gICAgICpcbiAgICAgKi9cbiAgICB1cGRhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuYmFzZVRleHR1cmUucmVzb3VyY2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZVRleHR1cmUucmVzb3VyY2UudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgYmFzZSB0ZXh0dXJlIGlzIHVwZGF0ZWRcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IGJhc2VUZXh0dXJlIC0gVGhlIGJhc2UgdGV4dHVyZS5cbiAgICAgKi9cbiAgICBvbkJhc2VUZXh0dXJlVXBkYXRlZChiYXNlVGV4dHVyZTogQmFzZVRleHR1cmUpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5ub0ZyYW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYmFzZVRleHR1cmUudmFsaWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9mcmFtZS53aWR0aCA9IGJhc2VUZXh0dXJlLndpZHRoO1xuICAgICAgICAgICAgdGhpcy5fZnJhbWUuaGVpZ2h0ID0gYmFzZVRleHR1cmUuaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy52YWxpZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVV2cygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETyB0aGlzIGNvZGUgbG9va3MgY29uZnVzaW5nLi4gYm9vIHRvIGFidXNpbmcgZ2V0dGVycyBhbmQgc2V0dGVycyFcbiAgICAgICAgICAgIC8vIGlmIHVzZXIgZ2F2ZSB1cyBmcmFtZSB0aGF0IGhhcyBiaWdnZXIgc2l6ZSB0aGFuIHJlc2l6ZWQgdGV4dHVyZSBpdCBjYW4gYmUgYSBwcm9ibGVtXG4gICAgICAgICAgICB0aGlzLmZyYW1lID0gdGhpcy5fZnJhbWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZScsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgdGV4dHVyZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZGVzdHJveUJhc2U9ZmFsc2VdIC0gV2hldGhlciB0byBkZXN0cm95IHRoZSBiYXNlIHRleHR1cmUgYXMgd2VsbFxuICAgICAqL1xuICAgIGRlc3Ryb3koZGVzdHJveUJhc2U/OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuYmFzZVRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChkZXN0cm95QmFzZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNvdXJjZSA9IHRoaXMuYmFzZVRleHR1cmUgYXMgYW55O1xuXG4gICAgICAgICAgICAgICAgLy8gZGVsZXRlIHRoZSB0ZXh0dXJlIGlmIGl0IGV4aXN0cyBpbiB0aGUgdGV4dHVyZSBjYWNoZS4uXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBvbmx5IG5lZWRzIHRvIGJlIHJlbW92ZWQgaWYgdGhlIGJhc2UgdGV4dHVyZSBpcyBhY3R1YWxseSBkZXN0cm95ZWQgdG9vLi5cbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UgJiYgcmVzb3VyY2UudXJsICYmIFRleHR1cmVDYWNoZVtyZXNvdXJjZS51cmxdKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgVGV4dHVyZS5yZW1vdmVGcm9tQ2FjaGUocmVzb3VyY2UudXJsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmJhc2VUZXh0dXJlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5iYXNlVGV4dHVyZS5vZmYoJ2xvYWRlZCcsIHRoaXMub25CYXNlVGV4dHVyZVVwZGF0ZWQsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5iYXNlVGV4dHVyZS5vZmYoJ3VwZGF0ZScsIHRoaXMub25CYXNlVGV4dHVyZVVwZGF0ZWQsIHRoaXMpO1xuXG4gICAgICAgICAgICB0aGlzLmJhc2VUZXh0dXJlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZyYW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdXZzID0gbnVsbDtcbiAgICAgICAgdGhpcy50cmltID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnID0gbnVsbDtcblxuICAgICAgICB0aGlzLnZhbGlkID0gZmFsc2U7XG5cbiAgICAgICAgVGV4dHVyZS5yZW1vdmVGcm9tQ2FjaGUodGhpcyk7XG4gICAgICAgIHRoaXMudGV4dHVyZUNhY2hlSWRzID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRleHR1cmUgb2JqZWN0IHRoYXQgYWN0cyB0aGUgc2FtZSBhcyB0aGlzIG9uZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dHVyZX0gVGhlIG5ldyB0ZXh0dXJlXG4gICAgICovXG4gICAgY2xvbmUoKTogVGV4dHVyZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0dXJlKHRoaXMuYmFzZVRleHR1cmUsXG4gICAgICAgICAgICB0aGlzLmZyYW1lLmNsb25lKCksXG4gICAgICAgICAgICB0aGlzLm9yaWcuY2xvbmUoKSxcbiAgICAgICAgICAgIHRoaXMudHJpbSAmJiB0aGlzLnRyaW0uY2xvbmUoKSxcbiAgICAgICAgICAgIHRoaXMucm90YXRlLFxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0QW5jaG9yXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgaW50ZXJuYWwgV2ViR0wgVVYgY2FjaGUuIFVzZSBpdCBhZnRlciB5b3UgY2hhbmdlIGBmcmFtZWAgb3IgYHRyaW1gIG9mIHRoZSB0ZXh0dXJlLlxuICAgICAqIENhbGwgaXQgYWZ0ZXIgY2hhbmdpbmcgdGhlIGZyYW1lXG4gICAgICovXG4gICAgdXBkYXRlVXZzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl91dnMgPT09IERFRkFVTFRfVVZTKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl91dnMgPSBuZXcgVGV4dHVyZVV2cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdXZzLnNldCh0aGlzLl9mcmFtZSwgdGhpcy5iYXNlVGV4dHVyZSwgdGhpcy5yb3RhdGUpO1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZUlEKys7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRoYXQgY3JlYXRlcyBhIG5ldyBUZXh0dXJlIGJhc2VkIG9uIHRoZSBzb3VyY2UgeW91IHByb3ZpZGUuXG4gICAgICogVGhlIHNvdXJjZSBjYW4gYmUgLSBmcmFtZSBpZCwgaW1hZ2UgdXJsLCB2aWRlbyB1cmwsIGNhbnZhcyBlbGVtZW50LCB2aWRlbyBlbGVtZW50LCBiYXNlIHRleHR1cmVcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xIVE1MSW1hZ2VFbGVtZW50fEhUTUxDYW52YXNFbGVtZW50fEhUTUxWaWRlb0VsZW1lbnR8UElYSS5CYXNlVGV4dHVyZX0gc291cmNlXG4gICAgICogICAgICAgIFNvdXJjZSB0byBjcmVhdGUgdGV4dHVyZSBmcm9tXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSBTZWUge0BsaW5rIFBJWEkuQmFzZVRleHR1cmV9J3MgY29uc3RydWN0b3IgZm9yIG9wdGlvbnMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc3RyaWN0XSAtIEVuZm9yY2Ugc3RyaWN0LW1vZGUsIHNlZSB7QGxpbmsgUElYSS5zZXR0aW5ncy5TVFJJQ1RfVEVYVFVSRV9DQUNIRX0uXG4gICAgICogQHJldHVybiB7UElYSS5UZXh0dXJlfSBUaGUgbmV3bHkgY3JlYXRlZCB0ZXh0dXJlXG4gICAgICovXG4gICAgc3RhdGljIGZyb20oc291cmNlOiBUZXh0dXJlU291cmNlLCBvcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zID0ge30sXG4gICAgICAgIHN0cmljdCA9IHNldHRpbmdzLlNUUklDVF9URVhUVVJFX0NBQ0hFKTogVGV4dHVyZVxuICAgIHtcbiAgICAgICAgY29uc3QgaXNGcmFtZSA9IHR5cGVvZiBzb3VyY2UgPT09ICdzdHJpbmcnO1xuICAgICAgICBsZXQgY2FjaGVJZCA9IG51bGw7XG5cbiAgICAgICAgaWYgKGlzRnJhbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNhY2hlSWQgPSBzb3VyY2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIShzb3VyY2UgYXMgYW55KS5fcGl4aUlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIChzb3VyY2UgYXMgYW55KS5fcGl4aUlkID0gYHBpeGlpZF8ke3VpZCgpfWA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhY2hlSWQgPSAoc291cmNlIGFzIGFueSkuX3BpeGlJZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0ZXh0dXJlID0gVGV4dHVyZUNhY2hlW2NhY2hlSWRdO1xuXG4gICAgICAgIC8vIFN0cmljdC1tb2RlIHJlamVjdHMgaW52YWxpZCBjYWNoZUlkc1xuICAgICAgICBpZiAoaXNGcmFtZSAmJiBzdHJpY3QgJiYgIXRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGNhY2hlSWQgXCIke2NhY2hlSWR9XCIgZG9lcyBub3QgZXhpc3QgaW4gVGV4dHVyZUNhY2hlLmApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0ZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMucmVzb2x1dGlvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnJlc29sdXRpb24gPSBnZXRSZXNvbHV0aW9uT2ZVcmwoc291cmNlIGFzIHN0cmluZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRleHR1cmUgPSBuZXcgVGV4dHVyZShuZXcgQmFzZVRleHR1cmUoc291cmNlLCBvcHRpb25zKSk7XG4gICAgICAgICAgICB0ZXh0dXJlLmJhc2VUZXh0dXJlLmNhY2hlSWQgPSBjYWNoZUlkO1xuXG4gICAgICAgICAgICBCYXNlVGV4dHVyZS5hZGRUb0NhY2hlKHRleHR1cmUuYmFzZVRleHR1cmUsIGNhY2hlSWQpO1xuICAgICAgICAgICAgVGV4dHVyZS5hZGRUb0NhY2hlKHRleHR1cmUsIGNhY2hlSWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0cyBhc3N1bWUgaXRzIGEgYmFzZSB0ZXh0dXJlIVxuICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VmdWwgZm9yIGxvYWRpbmcgdGV4dHVyZXMgdmlhIFVSTHMuIFVzZSBpbnN0ZWFkIG9mIGBUZXh0dXJlLmZyb21gIGJlY2F1c2VcbiAgICAgKiBpdCBkb2VzIGEgYmV0dGVyIGpvYiBvZiBoYW5kbGluZyBmYWlsZWQgVVJMcyBtb3JlIGVmZmVjdGl2ZWx5LiBUaGlzIGFsc28gaWdub3Jlc1xuICAgICAqIGBQSVhJLnNldHRpbmdzLlNUUklDVF9URVhUVVJFX0NBQ0hFYC4gV29ya3MgZm9yIFZpZGVvcywgU1ZHcywgSW1hZ2VzLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgVGhlIHJlbW90ZSBVUkwgdG8gbG9hZC5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIE9wdGlvbmFsIG9wdGlvbnMgdG8gaW5jbHVkZVxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8UElYSS5UZXh0dXJlPn0gQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYSBUZXh0dXJlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tVVJMKHVybDogc3RyaW5nLCBvcHRpb25zPzogSUJhc2VUZXh0dXJlT3B0aW9ucyk6IFByb21pc2U8VGV4dHVyZT5cbiAgICB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBhdXRvTG9hZDogZmFsc2UgfSwgb3B0aW9ucz8ucmVzb3VyY2VPcHRpb25zKTtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IFRleHR1cmUuZnJvbSh1cmwsIE9iamVjdC5hc3NpZ24oeyByZXNvdXJjZU9wdGlvbnMgfSwgb3B0aW9ucyksIGZhbHNlKTtcbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSB0ZXh0dXJlLmJhc2VUZXh0dXJlLnJlc291cmNlIGFzIEltYWdlUmVzb3VyY2U7XG5cbiAgICAgICAgLy8gVGhlIHRleHR1cmUgd2FzIGFscmVhZHkgbG9hZGVkXG4gICAgICAgIGlmICh0ZXh0dXJlLmJhc2VUZXh0dXJlLnZhbGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRleHR1cmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFudWFsbHkgbG9hZCB0aGUgdGV4dHVyZSwgdGhpcyBzaG91bGQgYWxsb3cgdXNlcnMgdG8gaGFuZGxlIGxvYWQgZXJyb3JzXG4gICAgICAgIHJldHVybiByZXNvdXJjZS5sb2FkKCkudGhlbigoKSA9PiBQcm9taXNlLnJlc29sdmUodGV4dHVyZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBUZXh0dXJlIHdpdGggYSBCdWZmZXJSZXNvdXJjZSBmcm9tIGEgRmxvYXQzMkFycmF5LlxuICAgICAqIFJHQkEgdmFsdWVzIGFyZSBmbG9hdHMgZnJvbSAwIHRvIDEuXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7RmxvYXQzMkFycmF5fFVpbnQ4QXJyYXl9IGJ1ZmZlciAtIFRoZSBvcHRpb25hbCBhcnJheSB0byB1c2UsIGlmIG5vIGRhdGFcbiAgICAgKiAgICAgICAgaXMgcHJvdmlkZWQsIGEgbmV3IEZsb2F0MzJBcnJheSBpcyBjcmVhdGVkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCAtIFdpZHRoIG9mIHRoZSByZXNvdXJjZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSBIZWlnaHQgb2YgdGhlIHJlc291cmNlXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSBTZWUge0BsaW5rIFBJWEkuQmFzZVRleHR1cmV9J3MgY29uc3RydWN0b3IgZm9yIG9wdGlvbnMuXG4gICAgICogQHJldHVybiB7UElYSS5UZXh0dXJlfSBUaGUgcmVzdWx0aW5nIG5ldyBCYXNlVGV4dHVyZVxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tQnVmZmVyKGJ1ZmZlcjogRmxvYXQzMkFycmF5fFVpbnQ4QXJyYXksXG4gICAgICAgIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBvcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zKTogVGV4dHVyZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0dXJlKEJhc2VUZXh0dXJlLmZyb21CdWZmZXIoYnVmZmVyLCB3aWR0aCwgaGVpZ2h0LCBvcHRpb25zKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgdGV4dHVyZSBmcm9tIGEgc291cmNlIGFuZCBhZGQgdG8gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7SFRNTEltYWdlRWxlbWVudHxIVE1MQ2FudmFzRWxlbWVudH0gc291cmNlIC0gVGhlIGlucHV0IHNvdXJjZS5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaW1hZ2VVcmwgLSBGaWxlIG5hbWUgb2YgdGV4dHVyZSwgZm9yIGNhY2hlIGFuZCByZXNvbHZpbmcgcmVzb2x1dGlvbi5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW25hbWVdIC0gSHVtYW4gcmVhZGFibGUgbmFtZSBmb3IgdGhlIHRleHR1cmUgY2FjaGUuIElmIG5vIG5hbWUgaXNcbiAgICAgKiAgICAgICAgc3BlY2lmaWVkLCBvbmx5IGBpbWFnZVVybGAgd2lsbCBiZSB1c2VkIGFzIHRoZSBjYWNoZSBJRC5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlRleHR1cmV9IE91dHB1dCB0ZXh0dXJlXG4gICAgICovXG4gICAgc3RhdGljIGZyb21Mb2FkZXIoc291cmNlOiBIVE1MSW1hZ2VFbGVtZW50fEhUTUxDYW52YXNFbGVtZW50LCBpbWFnZVVybDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpOiBUZXh0dXJlXG4gICAge1xuICAgICAgICBjb25zdCByZXNvdXJjZSA9IG5ldyBJbWFnZVJlc291cmNlKHNvdXJjZSBhcyBhbnkpO1xuXG4gICAgICAgIHJlc291cmNlLnVybCA9IGltYWdlVXJsO1xuXG4gICAgICAgIGNvbnN0IGJhc2VUZXh0dXJlID0gbmV3IEJhc2VUZXh0dXJlKHJlc291cmNlLCB7XG4gICAgICAgICAgICBzY2FsZU1vZGU6IHNldHRpbmdzLlNDQUxFX01PREUsXG4gICAgICAgICAgICByZXNvbHV0aW9uOiBnZXRSZXNvbHV0aW9uT2ZVcmwoaW1hZ2VVcmwpLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRleHR1cmUoYmFzZVRleHR1cmUpO1xuXG4gICAgICAgIC8vIE5vIG5hbWUsIHVzZSBpbWFnZVVybCBpbnN0ZWFkXG4gICAgICAgIGlmICghbmFtZSlcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZSA9IGltYWdlVXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0cyBhbHNvIGFkZCB0aGUgZnJhbWUgdG8gcGl4aSdzIGdsb2JhbCBjYWNoZSBmb3IgJ2Zyb21Mb2FkZXInIGZ1bmN0aW9uXG4gICAgICAgIEJhc2VUZXh0dXJlLmFkZFRvQ2FjaGUodGV4dHVyZS5iYXNlVGV4dHVyZSwgbmFtZSk7XG4gICAgICAgIFRleHR1cmUuYWRkVG9DYWNoZSh0ZXh0dXJlLCBuYW1lKTtcblxuICAgICAgICAvLyBhbHNvIGFkZCByZWZlcmVuY2VzIGJ5IHVybCBpZiB0aGV5IGFyZSBkaWZmZXJlbnQuXG4gICAgICAgIGlmIChuYW1lICE9PSBpbWFnZVVybClcbiAgICAgICAge1xuICAgICAgICAgICAgQmFzZVRleHR1cmUuYWRkVG9DYWNoZSh0ZXh0dXJlLmJhc2VUZXh0dXJlLCBpbWFnZVVybCk7XG4gICAgICAgICAgICBUZXh0dXJlLmFkZFRvQ2FjaGUodGV4dHVyZSwgaW1hZ2VVcmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRleHR1cmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIFRleHR1cmUgdG8gdGhlIGdsb2JhbCBUZXh0dXJlQ2FjaGUuIFRoaXMgY2FjaGUgaXMgc2hhcmVkIGFjcm9zcyB0aGUgd2hvbGUgUElYSSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmV9IHRleHR1cmUgLSBUaGUgVGV4dHVyZSB0byBhZGQgdG8gdGhlIGNhY2hlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIFRoZSBpZCB0aGF0IHRoZSBUZXh0dXJlIHdpbGwgYmUgc3RvcmVkIGFnYWluc3QuXG4gICAgICovXG4gICAgc3RhdGljIGFkZFRvQ2FjaGUodGV4dHVyZTogVGV4dHVyZSwgaWQ6IHN0cmluZyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChpZClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRleHR1cmUudGV4dHVyZUNhY2hlSWRzLmluZGV4T2YoaWQpID09PSAtMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZXh0dXJlLnRleHR1cmVDYWNoZUlkcy5wdXNoKGlkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKFRleHR1cmVDYWNoZVtpZF0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFRleHR1cmUgYWRkZWQgdG8gdGhlIGNhY2hlIHdpdGggYW4gaWQgWyR7aWR9XSB0aGF0IGFscmVhZHkgaGFkIGFuIGVudHJ5YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFRleHR1cmVDYWNoZVtpZF0gPSB0ZXh0dXJlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgVGV4dHVyZSBmcm9tIHRoZSBnbG9iYWwgVGV4dHVyZUNhY2hlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfFBJWEkuVGV4dHVyZX0gdGV4dHVyZSAtIGlkIG9mIGEgVGV4dHVyZSB0byBiZSByZW1vdmVkLCBvciBhIFRleHR1cmUgaW5zdGFuY2UgaXRzZWxmXG4gICAgICogQHJldHVybiB7UElYSS5UZXh0dXJlfG51bGx9IFRoZSBUZXh0dXJlIHRoYXQgd2FzIHJlbW92ZWRcbiAgICAgKi9cbiAgICBzdGF0aWMgcmVtb3ZlRnJvbUNhY2hlKHRleHR1cmU6IHN0cmluZ3xUZXh0dXJlKTogVGV4dHVyZXxudWxsXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIHRleHR1cmUgPT09ICdzdHJpbmcnKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0dXJlRnJvbUNhY2hlID0gVGV4dHVyZUNhY2hlW3RleHR1cmVdO1xuXG4gICAgICAgICAgICBpZiAodGV4dHVyZUZyb21DYWNoZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHRleHR1cmVGcm9tQ2FjaGUudGV4dHVyZUNhY2hlSWRzLmluZGV4T2YodGV4dHVyZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHR1cmVGcm9tQ2FjaGUudGV4dHVyZUNhY2hlSWRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIFRleHR1cmVDYWNoZVt0ZXh0dXJlXTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0dXJlRnJvbUNhY2hlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRleHR1cmUgJiYgdGV4dHVyZS50ZXh0dXJlQ2FjaGVJZHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dHVyZS50ZXh0dXJlQ2FjaGVJZHMubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgdGhhdCB0ZXh0dXJlIG1hdGNoZXMgdGhlIG9uZSBiZWluZyBwYXNzZWQgaW4gYmVmb3JlIGRlbGV0aW5nIGl0IGZyb20gdGhlIGNhY2hlLlxuICAgICAgICAgICAgICAgIGlmIChUZXh0dXJlQ2FjaGVbdGV4dHVyZS50ZXh0dXJlQ2FjaGVJZHNbaV1dID09PSB0ZXh0dXJlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIFRleHR1cmVDYWNoZVt0ZXh0dXJlLnRleHR1cmVDYWNoZUlkc1tpXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0ZXh0dXJlLnRleHR1cmVDYWNoZUlkcy5sZW5ndGggPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgcmVzb2x1dGlvbiBvZiBiYXNlVGV4dHVyZVxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCByZXNvbHV0aW9uKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZVRleHR1cmUucmVzb2x1dGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZnJhbWUgc3BlY2lmaWVzIHRoZSByZWdpb24gb2YgdGhlIGJhc2UgdGV4dHVyZSB0aGF0IHRoaXMgdGV4dHVyZSB1c2VzLlxuICAgICAqIFBsZWFzZSBjYWxsIGB1cGRhdGVVdnMoKWAgYWZ0ZXIgeW91IGNoYW5nZSBjb29yZGluYXRlcyBvZiBgZnJhbWVgIG1hbnVhbGx5LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICovXG4gICAgZ2V0IGZyYW1lKCk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lO1xuICAgIH1cblxuICAgIHNldCBmcmFtZShmcmFtZTogUmVjdGFuZ2xlKVxuICAgIHtcbiAgICAgICAgdGhpcy5fZnJhbWUgPSBmcmFtZTtcblxuICAgICAgICB0aGlzLm5vRnJhbWUgPSBmYWxzZTtcblxuICAgICAgICBjb25zdCB7IHgsIHksIHdpZHRoLCBoZWlnaHQgfSA9IGZyYW1lO1xuICAgICAgICBjb25zdCB4Tm90Rml0ID0geCArIHdpZHRoID4gdGhpcy5iYXNlVGV4dHVyZS53aWR0aDtcbiAgICAgICAgY29uc3QgeU5vdEZpdCA9IHkgKyBoZWlnaHQgPiB0aGlzLmJhc2VUZXh0dXJlLmhlaWdodDtcblxuICAgICAgICBpZiAoeE5vdEZpdCB8fCB5Tm90Rml0KVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCByZWxhdGlvbnNoaXAgPSB4Tm90Rml0ICYmIHlOb3RGaXQgPyAnYW5kJyA6ICdvcic7XG4gICAgICAgICAgICBjb25zdCBlcnJvclggPSBgWDogJHt4fSArICR7d2lkdGh9ID0gJHt4ICsgd2lkdGh9ID4gJHt0aGlzLmJhc2VUZXh0dXJlLndpZHRofWA7XG4gICAgICAgICAgICBjb25zdCBlcnJvclkgPSBgWTogJHt5fSArICR7aGVpZ2h0fSA9ICR7eSArIGhlaWdodH0gPiAke3RoaXMuYmFzZVRleHR1cmUuaGVpZ2h0fWA7XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGV4dHVyZSBFcnJvcjogZnJhbWUgZG9lcyBub3QgZml0IGluc2lkZSB0aGUgYmFzZSBUZXh0dXJlIGRpbWVuc2lvbnM6ICdcbiAgICAgICAgICAgICAgICArIGAke2Vycm9yWH0gJHtyZWxhdGlvbnNoaXB9ICR7ZXJyb3JZfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy52YWxpZCA9IHdpZHRoICYmIGhlaWdodCAmJiB0aGlzLmJhc2VUZXh0dXJlLnZhbGlkO1xuXG4gICAgICAgIGlmICghdGhpcy50cmltICYmICF0aGlzLnJvdGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5vcmlnID0gZnJhbWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVVdnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSB0ZXh0dXJlIGlzIHJvdGF0ZWQgaW5zaWRlIHRoZSBhdGxhc1xuICAgICAqIHNldCB0byAyIHRvIGNvbXBlbnNhdGUgZm9yIHRleHR1cmUgcGFja2VyIHJvdGF0aW9uXG4gICAgICogc2V0IHRvIDYgdG8gY29tcGVuc2F0ZSBmb3Igc3BpbmUgcGFja2VyIHJvdGF0aW9uXG4gICAgICogY2FuIGJlIHVzZWQgdG8gcm90YXRlIG9yIG1pcnJvciBzcHJpdGVzXG4gICAgICogU2VlIHtAbGluayBQSVhJLmdyb3VwRDh9IGZvciBleHBsYW5hdGlvblxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCByb3RhdGUoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm90YXRlO1xuICAgIH1cblxuICAgIHNldCByb3RhdGUocm90YXRlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9yb3RhdGUgPSByb3RhdGU7XG4gICAgICAgIGlmICh0aGlzLnZhbGlkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVV2cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHdpZHRoIG9mIHRoZSBUZXh0dXJlIGluIHBpeGVscy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgd2lkdGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5vcmlnLndpZHRoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIFRleHR1cmUgaW4gcGl4ZWxzLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBoZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5vcmlnLmhlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciBCYXNlVGV4dHVyZXxUZXh0dXJlIGNhc3RcbiAgICAgKi9cbiAgICBjYXN0VG9CYXNlVGV4dHVyZSgpOiBCYXNlVGV4dHVyZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZVRleHR1cmU7XG4gICAgfVxuXG4gICAgc3RhdGljIHJlYWRvbmx5IEVNUFRZOiBUZXh0dXJlO1xuICAgIHN0YXRpYyByZWFkb25seSBXSElURTogVGV4dHVyZTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlV2hpdGVUZXh0dXJlKCk6IFRleHR1cmVcbntcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblxuICAgIGNhbnZhcy53aWR0aCA9IDE2O1xuICAgIGNhbnZhcy5oZWlnaHQgPSAxNjtcblxuICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJ3doaXRlJztcbiAgICBjb250ZXh0LmZpbGxSZWN0KDAsIDAsIDE2LCAxNik7XG5cbiAgICByZXR1cm4gbmV3IFRleHR1cmUobmV3IEJhc2VUZXh0dXJlKG5ldyBDYW52YXNSZXNvdXJjZShjYW52YXMpKSk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUFsbEhhbmRsZXJzKHRleDogYW55KTogdm9pZFxue1xuICAgIHRleC5kZXN0cm95ID0gZnVuY3Rpb24gX2VtcHR5RGVzdHJveSgpOiB2b2lkIHsgLyogZW1wdHkgKi8gfTtcbiAgICB0ZXgub24gPSBmdW5jdGlvbiBfZW1wdHlPbigpOiB2b2lkIHsgLyogZW1wdHkgKi8gfTtcbiAgICB0ZXgub25jZSA9IGZ1bmN0aW9uIF9lbXB0eU9uY2UoKTogdm9pZCB7IC8qIGVtcHR5ICovIH07XG4gICAgdGV4LmVtaXQgPSBmdW5jdGlvbiBfZW1wdHlFbWl0KCk6IHZvaWQgeyAvKiBlbXB0eSAqLyB9O1xufVxuXG4vKipcbiAqIEFuIGVtcHR5IHRleHR1cmUsIHVzZWQgb2Z0ZW4gdG8gbm90IGhhdmUgdG8gY3JlYXRlIG11bHRpcGxlIGVtcHR5IHRleHR1cmVzLlxuICogQ2FuIG5vdCBiZSBkZXN0cm95ZWQuXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50XG4gKiBAbWVtYmVyIHtQSVhJLlRleHR1cmV9XG4gKi9cbihUZXh0dXJlIGFzIGFueSkuRU1QVFkgPSBuZXcgVGV4dHVyZShuZXcgQmFzZVRleHR1cmUoKSk7XG5yZW1vdmVBbGxIYW5kbGVycyhUZXh0dXJlLkVNUFRZKTtcbnJlbW92ZUFsbEhhbmRsZXJzKFRleHR1cmUuRU1QVFkuYmFzZVRleHR1cmUpO1xuXG4vKipcbiAqIEEgd2hpdGUgdGV4dHVyZSBvZiAxNngxNiBzaXplLCB1c2VkIGZvciBncmFwaGljcyBhbmQgb3RoZXIgdGhpbmdzXG4gKiBDYW4gbm90IGJlIGRlc3Ryb3llZC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAY29uc3RhbnRcbiAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZX1cbiAqL1xuKFRleHR1cmUgYXMgYW55KS5XSElURSA9IGNyZWF0ZVdoaXRlVGV4dHVyZSgpO1xucmVtb3ZlQWxsSGFuZGxlcnMoVGV4dHVyZS5XSElURSk7XG5yZW1vdmVBbGxIYW5kbGVycyhUZXh0dXJlLldISVRFLmJhc2VUZXh0dXJlKTtcbiIsICJpbXBvcnQgeyBCYXNlUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4vQmFzZVJlbmRlclRleHR1cmUnO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJy4uL3RleHR1cmVzL1RleHR1cmUnO1xuXG5pbXBvcnQgdHlwZSB7IFJlY3RhbmdsZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHR5cGUgeyBGcmFtZWJ1ZmZlciB9IGZyb20gJy4uL2ZyYW1lYnVmZmVyL0ZyYW1lYnVmZmVyJztcbmltcG9ydCB0eXBlIHsgSUJhc2VUZXh0dXJlT3B0aW9ucyB9IGZyb20gJy4uL3RleHR1cmVzL0Jhc2VUZXh0dXJlJztcbi8qKlxuICogQSBSZW5kZXJUZXh0dXJlIGlzIGEgc3BlY2lhbCB0ZXh0dXJlIHRoYXQgYWxsb3dzIGFueSBQaXhpSlMgZGlzcGxheSBvYmplY3QgdG8gYmUgcmVuZGVyZWQgdG8gaXQuXG4gKlxuICogX19IaW50X186IEFsbCBEaXNwbGF5T2JqZWN0cyAoaS5lLiBTcHJpdGVzKSB0aGF0IHJlbmRlciB0byBhIFJlbmRlclRleHR1cmUgc2hvdWxkIGJlIHByZWxvYWRlZFxuICogb3RoZXJ3aXNlIGJsYWNrIHJlY3RhbmdsZXMgd2lsbCBiZSBkcmF3biBpbnN0ZWFkLlxuICpcbiAqIF9fSGludC0yX186IFRoZSBhY3R1YWwgbWVtb3J5IGFsbG9jYXRpb24gd2lsbCBoYXBwZW4gb24gZmlyc3QgcmVuZGVyLlxuICogWW91IHNob3VsZG4ndCBjcmVhdGUgcmVuZGVyVGV4dHVyZXMgZWFjaCBmcmFtZSBqdXN0IHRvIGRlbGV0ZSB0aGVtIGFmdGVyLCB0cnkgdG8gcmV1c2UgdGhlbS5cbiAqXG4gKiBBIFJlbmRlclRleHR1cmUgdGFrZXMgYSBzbmFwc2hvdCBvZiBhbnkgRGlzcGxheSBPYmplY3QgZ2l2ZW4gdG8gaXRzIHJlbmRlciBtZXRob2QuIEZvciBleGFtcGxlOlxuICpcbiAqIGBgYGpzXG4gKiBsZXQgcmVuZGVyZXIgPSBQSVhJLmF1dG9EZXRlY3RSZW5kZXJlcigpO1xuICogbGV0IHJlbmRlclRleHR1cmUgPSBQSVhJLlJlbmRlclRleHR1cmUuY3JlYXRlKHsgd2lkdGg6IDgwMCwgaGVpZ2h0OiA2MDAgfSk7XG4gKiBsZXQgc3ByaXRlID0gUElYSS5TcHJpdGUuZnJvbShcInNwaW5PYmpfMDEucG5nXCIpO1xuICpcbiAqIHNwcml0ZS5wb3NpdGlvbi54ID0gODAwLzI7XG4gKiBzcHJpdGUucG9zaXRpb24ueSA9IDYwMC8yO1xuICogc3ByaXRlLmFuY2hvci54ID0gMC41O1xuICogc3ByaXRlLmFuY2hvci55ID0gMC41O1xuICpcbiAqIHJlbmRlcmVyLnJlbmRlcihzcHJpdGUsIHJlbmRlclRleHR1cmUpO1xuICogYGBgXG4gKlxuICogVGhlIFNwcml0ZSBpbiB0aGlzIGNhc2Ugd2lsbCBiZSByZW5kZXJlZCB1c2luZyBpdHMgbG9jYWwgdHJhbnNmb3JtLiBUbyByZW5kZXIgdGhpcyBzcHJpdGUgYXQgMCwwXG4gKiB5b3UgY2FuIGNsZWFyIHRoZSB0cmFuc2Zvcm1cbiAqXG4gKiBgYGBqc1xuICpcbiAqIHNwcml0ZS5zZXRUcmFuc2Zvcm0oKVxuICpcbiAqIGxldCByZW5kZXJUZXh0dXJlID0gbmV3IFBJWEkuUmVuZGVyVGV4dHVyZS5jcmVhdGUoMTAwLCAxMDApO1xuICpcbiAqIHJlbmRlcmVyLnJlbmRlcihzcHJpdGUsIHJlbmRlclRleHR1cmUpOyAgLy8gUmVuZGVycyB0byBjZW50ZXIgb2YgUmVuZGVyVGV4dHVyZVxuICogYGBgXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLlRleHR1cmVcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBSZW5kZXJUZXh0dXJlIGV4dGVuZHMgVGV4dHVyZVxue1xuICAgIHB1YmxpYyBmaWx0ZXJGcmFtZTogUmVjdGFuZ2xlfG51bGw7XG4gICAgcHVibGljIGZpbHRlclBvb2xLZXk6IHN0cmluZ3xudW1iZXJ8bnVsbDtcbiAgICBsZWdhY3lSZW5kZXJlcjogYW55O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlUmVuZGVyVGV4dHVyZX0gYmFzZVJlbmRlclRleHR1cmUgLSBUaGUgYmFzZSB0ZXh0dXJlIG9iamVjdCB0aGF0IHRoaXMgdGV4dHVyZSB1c2VzXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gW2ZyYW1lXSAtIFRoZSByZWN0YW5nbGUgZnJhbWUgb2YgdGhlIHRleHR1cmUgdG8gc2hvd1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGJhc2VSZW5kZXJUZXh0dXJlOiBCYXNlUmVuZGVyVGV4dHVyZSwgZnJhbWU/OiBSZWN0YW5nbGUpXG4gICAge1xuICAgICAgICAvLyBzdXBwb3J0IGZvciBsZWdhY3kuLlxuICAgICAgICBsZXQgX2xlZ2FjeVJlbmRlcmVyID0gbnVsbDtcblxuICAgICAgICBpZiAoIShiYXNlUmVuZGVyVGV4dHVyZSBpbnN0YW5jZW9mIEJhc2VSZW5kZXJUZXh0dXJlKSlcbiAgICAgICAge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgcHJlZmVyLXJlc3QtcGFyYW1zLCBuby1jb25zb2xlICovXG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgICAgIGNvbnN0IHNjYWxlTW9kZSA9IGFyZ3VtZW50c1szXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSBhcmd1bWVudHNbNF07XG5cbiAgICAgICAgICAgIC8vIHdlIGhhdmUgYW4gb2xkIHJlbmRlciB0ZXh0dXJlLi5cbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgUGxlYXNlIHVzZSBSZW5kZXJUZXh0dXJlLmNyZWF0ZSgke3dpZHRofSwgJHtoZWlnaHR9KSBpbnN0ZWFkIG9mIHRoZSBjdG9yIGRpcmVjdGx5LmApO1xuICAgICAgICAgICAgX2xlZ2FjeVJlbmRlcmVyID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBwcmVmZXItcmVzdC1wYXJhbXMsIG5vLWNvbnNvbGUgKi9cblxuICAgICAgICAgICAgZnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgYmFzZVJlbmRlclRleHR1cmUgPSBuZXcgQmFzZVJlbmRlclRleHR1cmUoe1xuICAgICAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgICAgICBzY2FsZU1vZGUsXG4gICAgICAgICAgICAgICAgcmVzb2x1dGlvbixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBiYXNlIHRleHR1cmUgb2JqZWN0IHRoYXQgdGhpcyB0ZXh0dXJlIHVzZXNcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5CYXNlVGV4dHVyZX1cbiAgICAgICAgICovXG4gICAgICAgIHN1cGVyKGJhc2VSZW5kZXJUZXh0dXJlLCBmcmFtZSk7XG5cbiAgICAgICAgdGhpcy5sZWdhY3lSZW5kZXJlciA9IF9sZWdhY3lSZW5kZXJlcjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyB3aWxsIGxldCB0aGUgcmVuZGVyZXIga25vdyBpZiB0aGUgdGV4dHVyZSBpcyB2YWxpZC4gSWYgaXQncyBub3QgdGhlbiBpdCBjYW5ub3QgYmUgcmVuZGVyZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZhbGlkID0gdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcmVzIGBzb3VyY2VGcmFtZWAgd2hlbiB0aGlzIHRleHR1cmUgaXMgaW5zaWRlIGN1cnJlbnQgZmlsdGVyIHN0YWNrLlxuICAgICAgICAgKiBZb3UgY2FuIHJlYWQgaXQgaW5zaWRlIGZpbHRlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyRnJhbWUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUga2V5IGZvciBwb29sZWQgdGV4dHVyZSBvZiBGaWx0ZXJTeXN0ZW1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlclBvb2xLZXkgPSBudWxsO1xuXG4gICAgICAgIHRoaXMudXBkYXRlVXZzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvcnRjdXQgdG8gYHRoaXMuYmFzZVRleHR1cmUuZnJhbWVidWZmZXJgLCBzYXZlcyBiYXNlVGV4dHVyZSBjYXN0LlxuICAgICAqIEBtZW1iZXIge1BJWEkuRnJhbWVidWZmZXJ9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgZ2V0IGZyYW1lYnVmZmVyKCk6IEZyYW1lYnVmZmVyXG4gICAge1xuICAgICAgICByZXR1cm4gKHRoaXMuYmFzZVRleHR1cmUgYXMgQmFzZVJlbmRlclRleHR1cmUpLmZyYW1lYnVmZmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2l6ZXMgdGhlIFJlbmRlclRleHR1cmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGggLSBUaGUgd2lkdGggdG8gcmVzaXplIHRvLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSBUaGUgaGVpZ2h0IHRvIHJlc2l6ZSB0by5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtyZXNpemVCYXNlVGV4dHVyZT10cnVlXSAtIFNob3VsZCB0aGUgYmFzZVRleHR1cmUud2lkdGggYW5kIGhlaWdodCB2YWx1ZXMgYmUgcmVzaXplZCBhcyB3ZWxsP1xuICAgICAqL1xuICAgIHJlc2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgcmVzaXplQmFzZVRleHR1cmUgPSB0cnVlKTogdm9pZFxuICAgIHtcbiAgICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGgpO1xuICAgICAgICBoZWlnaHQgPSBNYXRoLmNlaWwoaGVpZ2h0KTtcblxuICAgICAgICAvLyBUT0RPIC0gY291bGQgYmUgbm90IHJlcXVpcmVkLi5cbiAgICAgICAgdGhpcy52YWxpZCA9ICh3aWR0aCA+IDAgJiYgaGVpZ2h0ID4gMCk7XG5cbiAgICAgICAgdGhpcy5fZnJhbWUud2lkdGggPSB0aGlzLm9yaWcud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5fZnJhbWUuaGVpZ2h0ID0gdGhpcy5vcmlnLmhlaWdodCA9IGhlaWdodDtcblxuICAgICAgICBpZiAocmVzaXplQmFzZVRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgICh0aGlzLmJhc2VUZXh0dXJlIGFzIEJhc2VSZW5kZXJUZXh0dXJlKS5yZXNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVwZGF0ZVV2cygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIHJlc29sdXRpb24gb2YgYmFzZVRleHR1cmUsIGJ1dCBkb2VzIG5vdCBjaGFuZ2UgZnJhbWVidWZmZXIgc2l6ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByZXNvbHV0aW9uIC0gVGhlIG5ldyByZXNvbHV0aW9uIHRvIGFwcGx5IHRvIFJlbmRlclRleHR1cmVcbiAgICAgKi9cbiAgICBzZXRSZXNvbHV0aW9uKHJlc29sdXRpb246IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgYmFzZVRleHR1cmUgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKGJhc2VUZXh0dXJlLnJlc29sdXRpb24gPT09IHJlc29sdXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGJhc2VUZXh0dXJlLnNldFJlc29sdXRpb24ocmVzb2x1dGlvbik7XG4gICAgICAgIHRoaXMucmVzaXplKGJhc2VUZXh0dXJlLndpZHRoLCBiYXNlVGV4dHVyZS5oZWlnaHQsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHNob3J0IGhhbmQgd2F5IG9mIGNyZWF0aW5nIGEgcmVuZGVyIHRleHR1cmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gT3B0aW9uc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aD0xMDBdIC0gVGhlIHdpZHRoIG9mIHRoZSByZW5kZXIgdGV4dHVyZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5oZWlnaHQ9MTAwXSAtIFRoZSBoZWlnaHQgb2YgdGhlIHJlbmRlciB0ZXh0dXJlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnNjYWxlTW9kZT1QSVhJLnNldHRpbmdzLlNDQUxFX01PREVdIC0gU2VlIHtAbGluayBQSVhJLlNDQUxFX01PREVTfSBmb3IgcG9zc2libGUgdmFsdWVzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnJlc29sdXRpb249MV0gLSBUaGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiB0aGUgdGV4dHVyZSBiZWluZyBnZW5lcmF0ZWRcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlbmRlclRleHR1cmV9IFRoZSBuZXcgcmVuZGVyIHRleHR1cmVcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKG9wdGlvbnM6IElCYXNlVGV4dHVyZU9wdGlvbnMpOiBSZW5kZXJUZXh0dXJlXG4gICAge1xuICAgICAgICAvLyBmYWxsYmFjaywgb2xkLXN0eWxlOiBjcmVhdGUod2lkdGgsIGhlaWdodCwgc2NhbGVNb2RlLCByZXNvbHV0aW9uKVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdudW1iZXInKVxuICAgICAgICB7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItcmVzdC1wYXJhbXMgKi9cbiAgICAgICAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IG9wdGlvbnMsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBhcmd1bWVudHNbMV0sXG4gICAgICAgICAgICAgICAgc2NhbGVNb2RlOiBhcmd1bWVudHNbMl0sXG4gICAgICAgICAgICAgICAgcmVzb2x1dGlvbjogYXJndW1lbnRzWzNdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgcHJlZmVyLXJlc3QtcGFyYW1zICovXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFJlbmRlclRleHR1cmUobmV3IEJhc2VSZW5kZXJUZXh0dXJlKG9wdGlvbnMpKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4vUmVuZGVyVGV4dHVyZSc7XG5pbXBvcnQgeyBCYXNlUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4vQmFzZVJlbmRlclRleHR1cmUnO1xuaW1wb3J0IHsgbmV4dFBvdzIgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmltcG9ydCB0eXBlIHsgSUJhc2VUZXh0dXJlT3B0aW9ucyB9IGZyb20gJy4uL3RleHR1cmVzL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgSVNpemUgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuLyoqXG4gKiBFeHBlcmltZW50YWwhXG4gKlxuICogVGV4dHVyZSBwb29sLCB1c2VkIGJ5IEZpbHRlclN5c3RlbSBhbmQgcGx1Z2luc1xuICogU3RvcmVzIGNvbGxlY3Rpb24gb2YgdGVtcG9yYXJ5IHBvdzIgb3Igc2NyZWVuLXNpemVkIHJlbmRlclRleHR1cmVzXG4gKlxuICogSWYgeW91IHVzZSBjdXN0b20gUmVuZGVyVGV4dHVyZVBvb2wgZm9yIHlvdXIgZmlsdGVycywgeW91IGNhbiB1c2UgbWV0aG9kc1xuICogYGdldEZpbHRlclRleHR1cmVgIGFuZCBgcmV0dXJuRmlsdGVyVGV4dHVyZWAgc2FtZSBhcyBpblxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFJlbmRlclRleHR1cmVQb29sXG57XG4gICAgcHVibGljIHRleHR1cmVPcHRpb25zOiBJQmFzZVRleHR1cmVPcHRpb25zO1xuICAgIHB1YmxpYyBlbmFibGVGdWxsU2NyZWVuOiBib29sZWFuO1xuICAgIHRleHR1cmVQb29sOiB7W3ggaW4gc3RyaW5nfG51bWJlcl06IFJlbmRlclRleHR1cmVbXX07XG4gICAgcHJpdmF0ZSBfcGl4ZWxzV2lkdGg6IG51bWJlcjtcbiAgICBwcml2YXRlIF9waXhlbHNIZWlnaHQ6IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3RleHR1cmVPcHRpb25zXSAtIG9wdGlvbnMgdGhhdCB3aWxsIGJlIHBhc3NlZCB0byBCYXNlUmVuZGVyVGV4dHVyZSBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7UElYSS5TQ0FMRV9NT0RFU30gW3RleHR1cmVPcHRpb25zLnNjYWxlTW9kZV0gLSBTZWUge0BsaW5rIFBJWEkuU0NBTEVfTU9ERVN9IGZvciBwb3NzaWJsZSB2YWx1ZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodGV4dHVyZU9wdGlvbnM/OiBJQmFzZVRleHR1cmVPcHRpb25zKVxuICAgIHtcbiAgICAgICAgdGhpcy50ZXh0dXJlUG9vbCA9IHt9O1xuICAgICAgICB0aGlzLnRleHR1cmVPcHRpb25zID0gdGV4dHVyZU9wdGlvbnMgfHwge307XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbGxvdyByZW5kZXJUZXh0dXJlcyBvZiB0aGUgc2FtZSBzaXplIGFzIHNjcmVlbiwgbm90IGp1c3QgcG93MlxuICAgICAgICAgKlxuICAgICAgICAgKiBBdXRvbWF0aWNhbGx5IHNldHMgdG8gdHJ1ZSBhZnRlciBgc2V0U2NyZWVuU2l6ZWBcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZW5hYmxlRnVsbFNjcmVlbiA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3BpeGVsc1dpZHRoID0gMDtcbiAgICAgICAgdGhpcy5fcGl4ZWxzSGVpZ2h0ID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjcmVhdGVzIG9mIHRleHR1cmUgd2l0aCBwYXJhbXMgdGhhdCB3ZXJlIHNwZWNpZmllZCBpbiBwb29sIGNvbnN0cnVjdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmVhbFdpZHRoIC0gd2lkdGggb2YgdGV4dHVyZSBpbiBwaXhlbHNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmVhbEhlaWdodCAtIGhlaWdodCBvZiB0ZXh0dXJlIGluIHBpeGVsc1xuICAgICAqIEByZXR1cm5zIHtSZW5kZXJUZXh0dXJlfVxuICAgICAqL1xuICAgIGNyZWF0ZVRleHR1cmUocmVhbFdpZHRoOiBudW1iZXIsIHJlYWxIZWlnaHQ6IG51bWJlcik6IFJlbmRlclRleHR1cmVcbiAgICB7XG4gICAgICAgIGNvbnN0IGJhc2VSZW5kZXJUZXh0dXJlID0gbmV3IEJhc2VSZW5kZXJUZXh0dXJlKE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgd2lkdGg6IHJlYWxXaWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogcmVhbEhlaWdodCxcbiAgICAgICAgICAgIHJlc29sdXRpb246IDEsXG4gICAgICAgIH0sIHRoaXMudGV4dHVyZU9wdGlvbnMpKTtcblxuICAgICAgICByZXR1cm4gbmV3IFJlbmRlclRleHR1cmUoYmFzZVJlbmRlclRleHR1cmUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBQb3dlci1vZi1Ud28gcmVuZGVyIHRleHR1cmUgb3IgZnVsbFNjcmVlbiB0ZXh0dXJlXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1pbldpZHRoIC0gVGhlIG1pbmltdW0gd2lkdGggb2YgdGhlIHJlbmRlciB0ZXh0dXJlIGluIHJlYWwgcGl4ZWxzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW5IZWlnaHQgLSBUaGUgbWluaW11bSBoZWlnaHQgb2YgdGhlIHJlbmRlciB0ZXh0dXJlIGluIHJlYWwgcGl4ZWxzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmVzb2x1dGlvbj0xXSAtIFRoZSByZXNvbHV0aW9uIG9mIHRoZSByZW5kZXIgdGV4dHVyZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlbmRlclRleHR1cmV9IFRoZSBuZXcgcmVuZGVyIHRleHR1cmUuXG4gICAgICovXG4gICAgZ2V0T3B0aW1hbFRleHR1cmUobWluV2lkdGg6IG51bWJlciwgbWluSGVpZ2h0OiBudW1iZXIsIHJlc29sdXRpb24gPSAxKTogUmVuZGVyVGV4dHVyZVxuICAgIHtcbiAgICAgICAgbGV0IGtleTogbnVtYmVyfHN0cmluZyA9IFJlbmRlclRleHR1cmVQb29sLlNDUkVFTl9LRVk7XG5cbiAgICAgICAgbWluV2lkdGggKj0gcmVzb2x1dGlvbjtcbiAgICAgICAgbWluSGVpZ2h0ICo9IHJlc29sdXRpb247XG5cbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZ1bGxTY3JlZW4gfHwgbWluV2lkdGggIT09IHRoaXMuX3BpeGVsc1dpZHRoIHx8IG1pbkhlaWdodCAhPT0gdGhpcy5fcGl4ZWxzSGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICBtaW5XaWR0aCA9IG5leHRQb3cyKG1pbldpZHRoKTtcbiAgICAgICAgICAgIG1pbkhlaWdodCA9IG5leHRQb3cyKG1pbkhlaWdodCk7XG4gICAgICAgICAgICBrZXkgPSAoKG1pbldpZHRoICYgMHhGRkZGKSA8PCAxNikgfCAobWluSGVpZ2h0ICYgMHhGRkZGKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy50ZXh0dXJlUG9vbFtrZXldKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnRleHR1cmVQb29sW2tleV0gPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCByZW5kZXJUZXh0dXJlID0gdGhpcy50ZXh0dXJlUG9vbFtrZXldLnBvcCgpO1xuXG4gICAgICAgIGlmICghcmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmVuZGVyVGV4dHVyZSA9IHRoaXMuY3JlYXRlVGV4dHVyZShtaW5XaWR0aCwgbWluSGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlbmRlclRleHR1cmUuZmlsdGVyUG9vbEtleSA9IGtleTtcbiAgICAgICAgcmVuZGVyVGV4dHVyZS5zZXRSZXNvbHV0aW9uKHJlc29sdXRpb24pO1xuXG4gICAgICAgIHJldHVybiByZW5kZXJUZXh0dXJlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgZXh0cmEgdGV4dHVyZSBvZiB0aGUgc2FtZSBzaXplIGFzIGlucHV0IHJlbmRlclRleHR1cmVcbiAgICAgKlxuICAgICAqIGBnZXRGaWx0ZXJUZXh0dXJlKGlucHV0LCAwLjUpYCBvciBgZ2V0RmlsdGVyVGV4dHVyZSgwLjUsIGlucHV0KWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBpbnB1dCAtIHJlbmRlclRleHR1cmUgZnJvbSB3aGljaCBzaXplIGFuZCByZXNvbHV0aW9uIHdpbGwgYmUgY29waWVkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtyZXNvbHV0aW9uXSAtIG92ZXJyaWRlIHJlc29sdXRpb24gb2YgdGhlIHJlbmRlclRleHR1cmVcbiAgICAgKiAgSXQgb3ZlcnJpZGVzLCBpdCBkb2VzIG5vdCBtdWx0aXBseVxuICAgICAqIEByZXR1cm5zIHtQSVhJLlJlbmRlclRleHR1cmV9XG4gICAgICovXG4gICAgZ2V0RmlsdGVyVGV4dHVyZShpbnB1dDogUmVuZGVyVGV4dHVyZSwgcmVzb2x1dGlvbjogbnVtYmVyKTogUmVuZGVyVGV4dHVyZVxuICAgIHtcbiAgICAgICAgY29uc3QgZmlsdGVyVGV4dHVyZSA9IHRoaXMuZ2V0T3B0aW1hbFRleHR1cmUoaW5wdXQud2lkdGgsIGlucHV0LmhlaWdodCwgcmVzb2x1dGlvbiB8fCBpbnB1dC5yZXNvbHV0aW9uKTtcblxuICAgICAgICBmaWx0ZXJUZXh0dXJlLmZpbHRlckZyYW1lID0gaW5wdXQuZmlsdGVyRnJhbWU7XG5cbiAgICAgICAgcmV0dXJuIGZpbHRlclRleHR1cmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGxhY2UgYSByZW5kZXIgdGV4dHVyZSBiYWNrIGludG8gdGhlIHBvb2wuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlclRleHR1cmV9IHJlbmRlclRleHR1cmUgLSBUaGUgcmVuZGVyVGV4dHVyZSB0byBmcmVlXG4gICAgICovXG4gICAgcmV0dXJuVGV4dHVyZShyZW5kZXJUZXh0dXJlOiBSZW5kZXJUZXh0dXJlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qga2V5ID0gcmVuZGVyVGV4dHVyZS5maWx0ZXJQb29sS2V5O1xuXG4gICAgICAgIHJlbmRlclRleHR1cmUuZmlsdGVyRnJhbWUgPSBudWxsO1xuICAgICAgICB0aGlzLnRleHR1cmVQb29sW2tleV0ucHVzaChyZW5kZXJUZXh0dXJlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbGlhcyBmb3IgcmV0dXJuVGV4dHVyZSwgdG8gYmUgY29tcGxpYW50IHdpdGggRmlsdGVyU3lzdGVtIGludGVyZmFjZVxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSByZW5kZXJUZXh0dXJlIC0gVGhlIHJlbmRlclRleHR1cmUgdG8gZnJlZVxuICAgICAqL1xuICAgIHJldHVybkZpbHRlclRleHR1cmUocmVuZGVyVGV4dHVyZTogUmVuZGVyVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMucmV0dXJuVGV4dHVyZShyZW5kZXJUZXh0dXJlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgdGhlIHBvb2xcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2Rlc3Ryb3lUZXh0dXJlcz10cnVlXSAtIGRlc3Ryb3kgYWxsIHN0b3JlZCB0ZXh0dXJlc1xuICAgICAqL1xuICAgIGNsZWFyKGRlc3Ryb3lUZXh0dXJlczogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGRlc3Ryb3lUZXh0dXJlcyA9IGRlc3Ryb3lUZXh0dXJlcyAhPT0gZmFsc2U7XG4gICAgICAgIGlmIChkZXN0cm95VGV4dHVyZXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnRleHR1cmVQb29sKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHR1cmVzID0gdGhpcy50ZXh0dXJlUG9vbFtpXTtcblxuICAgICAgICAgICAgICAgIGlmICh0ZXh0dXJlcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGV4dHVyZXMubGVuZ3RoOyBqKyspXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmVzW2pdLmRlc3Ryb3kodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRleHR1cmVQb29sID0ge307XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgc2NyZWVuIHNpemUgd2FzIGNoYW5nZWQsIGRyb3BzIGFsbCBzY3JlZW4tc2l6ZWQgdGV4dHVyZXMsXG4gICAgICogc2V0cyBuZXcgc2NyZWVuIHNpemUsIHNldHMgYGVuYWJsZUZ1bGxTY3JlZW5gIHRvIHRydWVcbiAgICAgKlxuICAgICAqIFNpemUgaXMgbWVhc3VyZWQgaW4gcGl4ZWxzLCBgcmVuZGVyZXIudmlld2AgY2FuIGJlIHBhc3NlZCBoZXJlLCBub3QgYHJlbmRlcmVyLnNjcmVlbmBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JU2l6ZX0gc2l6ZSAtIEluaXRpYWwgc2l6ZSBvZiBzY3JlZW5cbiAgICAgKi9cbiAgICBzZXRTY3JlZW5TaXplKHNpemU6IElTaXplKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHNpemUud2lkdGggPT09IHRoaXMuX3BpeGVsc1dpZHRoXG4gICAgICAgICAgICAmJiBzaXplLmhlaWdodCA9PT0gdGhpcy5fcGl4ZWxzSGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzY3JlZW5LZXkgPSBSZW5kZXJUZXh0dXJlUG9vbC5TQ1JFRU5fS0VZO1xuICAgICAgICBjb25zdCB0ZXh0dXJlcyA9IHRoaXMudGV4dHVyZVBvb2xbc2NyZWVuS2V5XTtcblxuICAgICAgICB0aGlzLmVuYWJsZUZ1bGxTY3JlZW4gPSBzaXplLndpZHRoID4gMCAmJiBzaXplLmhlaWdodCA+IDA7XG5cbiAgICAgICAgaWYgKHRleHR1cmVzKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRleHR1cmVzLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRleHR1cmVzW2pdLmRlc3Ryb3kodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50ZXh0dXJlUG9vbFtzY3JlZW5LZXldID0gW107XG5cbiAgICAgICAgdGhpcy5fcGl4ZWxzV2lkdGggPSBzaXplLndpZHRoO1xuICAgICAgICB0aGlzLl9waXhlbHNIZWlnaHQgPSBzaXplLmhlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXkgdGhhdCBpcyB1c2VkIHRvIHN0b3JlIGZ1bGxzY3JlZW4gcmVuZGVyVGV4dHVyZXMgaW4gYSBwb29sXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQGNvbnN0IHtzdHJpbmd9XG4gICAgICovXG4gICAgc3RhdGljIFNDUkVFTl9LRVkgPSAnc2NyZWVuJztcbn1cbiIsICJpbXBvcnQgdHlwZSB7IFRZUEVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuXG4vKipcbiAqIEhvbGRzIHRoZSBpbmZvcm1hdGlvbiBmb3IgYSBzaW5nbGUgYXR0cmlidXRlIHN0cnVjdHVyZSByZXF1aXJlZCB0byByZW5kZXIgZ2VvbWV0cnkuXG4gKlxuICogVGhpcyBkb2VzIG5vdCBjb250YWluIHRoZSBhY3R1YWwgZGF0YSwgYnV0IGluc3RlYWQgaGFzIGEgYnVmZmVyIGlkIHRoYXQgbWFwcyB0byBhIHtAbGluayBQSVhJLkJ1ZmZlcn1cbiAqIFRoaXMgY2FuIGluY2x1ZGUgYW55dGhpbmcgZnJvbSBwb3NpdGlvbnMsIHV2cywgbm9ybWFscywgY29sb3JzIGV0Yy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVcbntcbiAgICBwdWJsaWMgYnVmZmVyOiBudW1iZXI7XG4gICAgcHVibGljIHNpemU6IG51bWJlcjtcbiAgICBwdWJsaWMgbm9ybWFsaXplZDogYm9vbGVhbjtcbiAgICBwdWJsaWMgdHlwZTogVFlQRVM7XG4gICAgcHVibGljIHN0cmlkZTogbnVtYmVyO1xuICAgIHB1YmxpYyBzdGFydDogbnVtYmVyO1xuICAgIHB1YmxpYyBpbnN0YW5jZTogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYnVmZmVyIC0gdGhlIGlkIG9mIHRoZSBidWZmZXIgdGhhdCB0aGlzIGF0dHJpYnV0ZSB3aWxsIGxvb2sgZm9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtzaXplPTBdIC0gdGhlIHNpemUgb2YgdGhlIGF0dHJpYnV0ZS4gSWYgeW91IGhhdmUgMiBmbG9hdHMgcGVyIHZlcnRleCAoZWcgcG9zaXRpb24geCBhbmQgeSkgdGhpcyB3b3VsZCBiZSAyLlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW25vcm1hbGl6ZWQ9ZmFsc2VdIC0gc2hvdWxkIHRoZSBkYXRhIGJlIG5vcm1hbGl6ZWQuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFt0eXBlPVBJWEkuVFlQRVMuRkxPQVRdIC0gd2hhdCB0eXBlIG9mIG51bWJlciBpcyB0aGUgYXR0cmlidXRlLiBDaGVjayB7QGxpbmsgUElYSS5UWVBFU30gdG8gc2VlIHRoZSBvbmVzIGF2YWlsYWJsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc3RyaWRlPTBdIC0gSG93IGZhciBhcGFydCAoaW4gZmxvYXRzKSB0aGUgc3RhcnQgb2YgZWFjaCB2YWx1ZSBpcy4gKHVzZWQgZm9yIGludGVybGVhdmluZyBkYXRhKVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnQ9MF0gLSBIb3cgZmFyIGludG8gdGhlIGFycmF5IHRvIHN0YXJ0IHJlYWRpbmcgdmFsdWVzICh1c2VkIGZvciBpbnRlcmxlYXZpbmcgZGF0YSlcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihidWZmZXI6IG51bWJlciwgc2l6ZSA9IDAsIG5vcm1hbGl6ZWQgPSBmYWxzZSwgdHlwZSA9IDUxMjYsIHN0cmlkZT86IG51bWJlciwgc3RhcnQ/OiBudW1iZXIsIGluc3RhbmNlPzogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyO1xuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xuICAgICAgICB0aGlzLm5vcm1hbGl6ZWQgPSBub3JtYWxpemVkO1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLnN0cmlkZSA9IHN0cmlkZTtcbiAgICAgICAgdGhpcy5zdGFydCA9IHN0YXJ0O1xuICAgICAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhlIEF0dHJpYnV0ZS5cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGFuIEF0dHJpYnV0ZSBiYXNlZCBvbiB0aGUgaW5mb3JtYXRpb24gcHJvdmlkZWRcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYnVmZmVyIC0gdGhlIGlkIG9mIHRoZSBidWZmZXIgdGhhdCB0aGlzIGF0dHJpYnV0ZSB3aWxsIGxvb2sgZm9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtzaXplPTBdIC0gdGhlIHNpemUgb2YgdGhlIGF0dHJpYnV0ZS4gSWYgeW91IGhhdmUgMiBmbG9hdHMgcGVyIHZlcnRleCAoZWcgcG9zaXRpb24geCBhbmQgeSkgdGhpcyB3b3VsZCBiZSAyXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbbm9ybWFsaXplZD1mYWxzZV0gLSBzaG91bGQgdGhlIGRhdGEgYmUgbm9ybWFsaXplZC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3R5cGU9UElYSS5UWVBFUy5GTE9BVF0gLSB3aGF0IHR5cGUgb2YgbnVtYmVyIGlzIHRoZSBhdHRyaWJ1dGUuIENoZWNrIHtAbGluayBQSVhJLlRZUEVTfSB0byBzZWUgdGhlIG9uZXMgYXZhaWxhYmxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtzdHJpZGU9MF0gLSBIb3cgZmFyIGFwYXJ0IChpbiBmbG9hdHMpIHRoZSBzdGFydCBvZiBlYWNoIHZhbHVlIGlzLiAodXNlZCBmb3IgaW50ZXJsZWF2aW5nIGRhdGEpXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UElYSS5BdHRyaWJ1dGV9IEEgbmV3IHtAbGluayBQSVhJLkF0dHJpYnV0ZX0gYmFzZWQgb24gdGhlIGluZm9ybWF0aW9uIHByb3ZpZGVkXG4gICAgICovXG4gICAgc3RhdGljIGZyb20oYnVmZmVyOiBudW1iZXIsIHNpemU/OiBudW1iZXIsIG5vcm1hbGl6ZWQ/OiBib29sZWFuLCB0eXBlPzogVFlQRVMsIHN0cmlkZT86IG51bWJlcik6IEF0dHJpYnV0ZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGUoYnVmZmVyLCBzaXplLCBub3JtYWxpemVkLCB0eXBlLCBzdHJpZGUpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSdW5uZXIgfSBmcm9tICdAcGl4aS9ydW5uZXInO1xuXG5pbXBvcnQgdHlwZSB7IEdMQnVmZmVyIH0gZnJvbSAnLi9HTEJ1ZmZlcic7XG5cbmxldCBVSUQgPSAwO1xuLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuXG4vKipcbiAqIE1hcmtzIHBsYWNlcyBpbiBQaXhpSlMgd2hlcmUgeW91IGNhbiBwYXNzIEZsb2F0MzJBcnJheSwgVUludDMyQXJyYXksIGFueSB0eXBlZCBhcnJheXMsIGFuZCBBcnJheUJ1ZmZlclxuICpcbiAqIFNhbWUgYXMgQXJyYXlCdWZmZXIgaW4gdHlwZXNjcmlwdCBsaWIsIGRlZmluZWQgaGVyZSBqdXN0IGZvciBkb2N1bWVudGF0aW9uXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIElBcnJheUJ1ZmZlciBleHRlbmRzIEFycmF5QnVmZmVyXG57XG59XG5cbi8qKlxuICogUGl4aUpTIGNsYXNzZXMgdXNlIHRoaXMgdHlwZSBpbnN0ZWFkIG9mIEFycmF5QnVmZmVyIGFuZCB0eXBlZCBhcnJheXNcbiAqIHRvIHN1cHBvcnQgZXhwcmVzc2lvbnMgbGlrZSBgZ2VvbWV0cnkuYnVmZmVyc1swXS5kYXRhWzBdID0gcG9zaXRpb24ueGAuXG4gKlxuICogR2l2ZXMgYWNjZXNzIHRvIGluZGV4aW5nIGFuZCBgbGVuZ3RoYCBmaWVsZFxuICpcbiAqIEBwb3BlbHlzaGV2OiBJZiBkYXRhIGlzIGFjdHVhbGx5IEFycmF5QnVmZmVyIGFuZCB0aHJvd3MgRXhjZXB0aW9uIG9uIGluZGV4aW5nIC0gaXRzIHVzZXIgcHJvYmxlbSA6KVxuICovXG5leHBvcnQgaW50ZXJmYWNlIElUeXBlZEFycmF5IGV4dGVuZHMgSUFycmF5QnVmZmVyXG57XG4gICAgcmVhZG9ubHkgbGVuZ3RoOiBudW1iZXI7XG4gICAgW2luZGV4OiBudW1iZXJdOiBudW1iZXI7XG4gICAgcmVhZG9ubHkgQllURVNfUEVSX0VMRU1FTlQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBIHdyYXBwZXIgZm9yIGRhdGEgc28gdGhhdCBpdCBjYW4gYmUgdXNlZCBhbmQgdXBsb2FkZWQgYnkgV2ViR0xcbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBCdWZmZXJcbntcbiAgICBwdWJsaWMgZGF0YTogSVR5cGVkQXJyYXk7XG4gICAgcHVibGljIGluZGV4OiBib29sZWFuO1xuICAgIHB1YmxpYyBzdGF0aWM6IGJvb2xlYW47XG4gICAgcHVibGljIGlkOiBudW1iZXI7XG4gICAgIGRpc3Bvc2VSdW5uZXI6IFJ1bm5lcjtcbiAgICBfZ2xCdWZmZXJzOiB7W2tleTogbnVtYmVyXTogR0xCdWZmZXJ9O1xuICAgIF91cGRhdGVJRDogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ8IFNoYXJlZEFycmF5QnVmZmVyfEFycmF5QnVmZmVyVmlld30gZGF0YSAtIHRoZSBkYXRhIHRvIHN0b3JlIGluIHRoZSBidWZmZXIuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbX3N0YXRpYz10cnVlXSAtIGB0cnVlYCBmb3Igc3RhdGljIGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2luZGV4PWZhbHNlXSAtIGB0cnVlYCBmb3IgaW5kZXggYnVmZmVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGF0YT86IElBcnJheUJ1ZmZlciwgX3N0YXRpYyA9IHRydWUsIGluZGV4ID0gZmFsc2UpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRhdGEgaW4gdGhlIGJ1ZmZlciwgYXMgYSB0eXBlZCBhcnJheVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtBcnJheUJ1ZmZlcnwgU2hhcmVkQXJyYXlCdWZmZXIgfCBBcnJheUJ1ZmZlclZpZXd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRhdGEgPSAoZGF0YSB8fCBuZXcgRmxvYXQzMkFycmF5KDEpKSBhcyBJVHlwZWRBcnJheTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBtYXAgb2YgcmVuZGVyZXIgSURzIHRvIHdlYmdsIGJ1ZmZlclxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtvYmplY3Q8bnVtYmVyLCBHTEJ1ZmZlcj59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9nbEJ1ZmZlcnMgPSB7fTtcblxuICAgICAgICB0aGlzLl91cGRhdGVJRCA9IDA7XG5cbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuXG4gICAgICAgIHRoaXMuc3RhdGljID0gX3N0YXRpYztcblxuICAgICAgICB0aGlzLmlkID0gVUlEKys7XG5cbiAgICAgICAgdGhpcy5kaXNwb3NlUnVubmVyID0gbmV3IFJ1bm5lcignZGlzcG9zZUJ1ZmZlcicpO1xuICAgIH1cblxuICAgIC8vIFRPRE8gY291bGQgZXhwbG9yZSBmbGFnZ2luZyBvbmx5IGEgcGFydGlhbCB1cGxvYWQ/XG4gICAgLyoqXG4gICAgICogZmxhZ3MgdGhpcyBidWZmZXIgYXMgcmVxdWlyaW5nIGFuIHVwbG9hZCB0byB0aGUgR1BVXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcnxTaGFyZWRBcnJheUJ1ZmZlcnxBcnJheUJ1ZmZlclZpZXd9IFtkYXRhXSAtIHRoZSBkYXRhIHRvIHVwZGF0ZSBpbiB0aGUgYnVmZmVyLlxuICAgICAqL1xuICAgIHVwZGF0ZShkYXRhPzogSUFycmF5QnVmZmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5kYXRhID0gKGRhdGEgYXMgSVR5cGVkQXJyYXkpIHx8IHRoaXMuZGF0YTtcbiAgICAgICAgdGhpcy5fdXBkYXRlSUQrKztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBkaXNwb3NlcyBXZWJHTCByZXNvdXJjZXMgdGhhdCBhcmUgY29ubmVjdGVkIHRvIHRoaXMgZ2VvbWV0cnlcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZGlzcG9zZVJ1bm5lci5lbWl0KHRoaXMsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgYnVmZmVyXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcblxuICAgICAgICB0aGlzLmRhdGEgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0aGF0IGNyZWF0ZXMgYSBidWZmZXIgYmFzZWQgb24gYW4gYXJyYXkgb3IgVHlwZWRBcnJheVxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJWaWV3IHwgbnVtYmVyW119IGRhdGEgLSB0aGUgVHlwZWRBcnJheSB0aGF0IHRoZSBidWZmZXIgd2lsbCBzdG9yZS4gSWYgdGhpcyBpcyBhIHJlZ3VsYXIgQXJyYXkgaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYSBGbG9hdDMyQXJyYXkuXG4gICAgICogQHJldHVybiB7UElYSS5CdWZmZXJ9IEEgbmV3IEJ1ZmZlciBiYXNlZCBvbiB0aGUgZGF0YSBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbShkYXRhOiBJQXJyYXlCdWZmZXIgfCBudW1iZXJbXSk6IEJ1ZmZlclxuICAgIHtcbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAge1xuICAgICAgICAgICAgZGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IEJ1ZmZlcihkYXRhKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBJVHlwZWRBcnJheSB9IGZyb20gJy4uL0J1ZmZlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCdWZmZXJUeXBlKGFycmF5OiBJVHlwZWRBcnJheSk6IHN0cmluZ3xudWxsXG57XG4gICAgaWYgKGFycmF5LkJZVEVTX1BFUl9FTEVNRU5UID09PSA0KVxuICAgIHtcbiAgICAgICAgaWYgKGFycmF5IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gJ0Zsb2F0MzJBcnJheSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJyYXkgaW5zdGFuY2VvZiBVaW50MzJBcnJheSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICdVaW50MzJBcnJheSc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJ0ludDMyQXJyYXknO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnJheS5CWVRFU19QRVJfRUxFTUVOVCA9PT0gMilcbiAgICB7XG4gICAgICAgIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQxNkFycmF5KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gJ1VpbnQxNkFycmF5JztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcnJheS5CWVRFU19QRVJfRUxFTUVOVCA9PT0gMSlcbiAgICB7XG4gICAgICAgIGlmIChhcnJheSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAnVWludDhBcnJheSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIG1hcCBvdXQgdGhlIHJlc3Qgb2YgdGhlIGFycmF5IGVsZW1lbnRzIVxuICAgIHJldHVybiBudWxsO1xufVxuIiwgImltcG9ydCB7IGdldEJ1ZmZlclR5cGUgfSBmcm9tICcuL2dldEJ1ZmZlclR5cGUnO1xuXG5pbXBvcnQgdHlwZSB7IElUeXBlZEFycmF5IH0gZnJvbSAnLi4vQnVmZmVyJztcbmltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuLyogZXNsaW50LWRpc2FibGUgb2JqZWN0LXNob3J0aGFuZCAqL1xuY29uc3QgbWFwOiBEaWN0PGFueT4gPSB7XG4gICAgRmxvYXQzMkFycmF5OiBGbG9hdDMyQXJyYXksXG4gICAgVWludDMyQXJyYXk6IFVpbnQzMkFycmF5LFxuICAgIEludDMyQXJyYXk6IEludDMyQXJyYXksXG4gICAgVWludDhBcnJheTogVWludDhBcnJheSxcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcmxlYXZlVHlwZWRBcnJheXMoYXJyYXlzOiBBcnJheTxJVHlwZWRBcnJheT4sIHNpemVzOiBBcnJheTxudW1iZXI+KTogRmxvYXQzMkFycmF5XG57XG4gICAgbGV0IG91dFNpemUgPSAwO1xuICAgIGxldCBzdHJpZGUgPSAwO1xuICAgIGNvbnN0IHZpZXdzOiBEaWN0PGFueT4gPSB7fTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlzLmxlbmd0aDsgaSsrKVxuICAgIHtcbiAgICAgICAgc3RyaWRlICs9IHNpemVzW2ldO1xuICAgICAgICBvdXRTaXplICs9IGFycmF5c1tpXS5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc3QgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKG91dFNpemUgKiA0KTtcblxuICAgIGxldCBvdXQgPSBudWxsO1xuICAgIGxldCBsaXR0bGVPZmZzZXQgPSAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspXG4gICAge1xuICAgICAgICBjb25zdCBzaXplID0gc2l6ZXNbaV07XG4gICAgICAgIGNvbnN0IGFycmF5ID0gYXJyYXlzW2ldO1xuXG4gICAgICAgIGNvbnN0IHR5cGUgPSBnZXRCdWZmZXJUeXBlKGFycmF5KTtcblxuICAgICAgICBpZiAoIXZpZXdzW3R5cGVdKVxuICAgICAgICB7XG4gICAgICAgICAgICB2aWV3c1t0eXBlXSA9IG5ldyBtYXBbdHlwZV0oYnVmZmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG91dCA9IHZpZXdzW3R5cGVdO1xuXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXJyYXkubGVuZ3RoOyBqKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4U3RhcnQgPSAoKGogLyBzaXplIHwgMCkgKiBzdHJpZGUpICsgbGl0dGxlT2Zmc2V0O1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBqICUgc2l6ZTtcblxuICAgICAgICAgICAgb3V0W2luZGV4U3RhcnQgKyBpbmRleF0gPSBhcnJheVtqXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxpdHRsZU9mZnNldCArPSBzaXplO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KGJ1ZmZlcik7XG59XG4iLCAiaW1wb3J0IHsgQXR0cmlidXRlIH0gZnJvbSAnLi9BdHRyaWJ1dGUnO1xuaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSAnLi9CdWZmZXInO1xuaW1wb3J0IHsgaW50ZXJsZWF2ZVR5cGVkQXJyYXlzIH0gZnJvbSAnLi91dGlscy9pbnRlcmxlYXZlVHlwZWRBcnJheXMnO1xuaW1wb3J0IHsgZ2V0QnVmZmVyVHlwZSB9IGZyb20gJy4vdXRpbHMvZ2V0QnVmZmVyVHlwZSc7XG5pbXBvcnQgeyBSdW5uZXIgfSBmcm9tICdAcGl4aS9ydW5uZXInO1xuXG5pbXBvcnQgdHlwZSB7IFRZUEVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB0eXBlIHsgSUFycmF5QnVmZmVyIH0gZnJvbSAnLi9CdWZmZXInO1xuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5jb25zdCBieXRlU2l6ZU1hcDoge1trZXk6IG51bWJlcl06IG51bWJlcn0gPSB7IDUxMjY6IDQsIDUxMjM6IDIsIDUxMjE6IDEgfTtcbmxldCBVSUQgPSAwO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBvYmplY3Qtc2hvcnRoYW5kICovXG5jb25zdCBtYXA6IERpY3Q8YW55PiA9IHtcbiAgICBGbG9hdDMyQXJyYXk6IEZsb2F0MzJBcnJheSxcbiAgICBVaW50MzJBcnJheTogVWludDMyQXJyYXksXG4gICAgSW50MzJBcnJheTogSW50MzJBcnJheSxcbiAgICBVaW50OEFycmF5OiBVaW50OEFycmF5LFxuICAgIFVpbnQxNkFycmF5OiBVaW50MTZBcnJheSxcbn07XG5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuLyoqXG4gKiBUaGUgR2VvbWV0cnkgcmVwcmVzZW50cyBhIG1vZGVsLiBJdCBjb25zaXN0cyBvZiB0d28gY29tcG9uZW50czpcbiAqIC0gR2VvbWV0cnlTdHlsZSAtIFRoZSBzdHJ1Y3R1cmUgb2YgdGhlIG1vZGVsIHN1Y2ggYXMgdGhlIGF0dHJpYnV0ZXMgbGF5b3V0XG4gKiAtIEdlb21ldHJ5RGF0YSAtIHRoZSBkYXRhIG9mIHRoZSBtb2RlbCAtIHRoaXMgY29uc2lzdHMgb2YgYnVmZmVycy5cbiAqIFRoaXMgY2FuIGluY2x1ZGUgYW55dGhpbmcgZnJvbSBwb3NpdGlvbnMsIHV2cywgbm9ybWFscywgY29sb3JzIGV0Yy5cbiAqXG4gKiBHZW9tZXRyeSBjYW4gYmUgZGVmaW5lZCB3aXRob3V0IHBhc3NpbmcgaW4gYSBzdHlsZSBvciBkYXRhIGlmIHJlcXVpcmVkICh0aGF0cyBob3cgSSBwcmVmZXIhKVxuICpcbiAqIGBgYGpzXG4gKiBsZXQgZ2VvbWV0cnkgPSBuZXcgUElYSS5HZW9tZXRyeSgpO1xuICpcbiAqIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgncG9zaXRpb25zJywgWzAsIDAsIDEwMCwgMCwgMTAwLCAxMDAsIDAsIDEwMF0sIDIpO1xuICogZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCd1dnMnLCBbMCwwLDEsMCwxLDEsMCwxXSwyKVxuICogZ2VvbWV0cnkuYWRkSW5kZXgoWzAsMSwyLDEsMywyXSlcbiAqXG4gKiBgYGBcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdlb21ldHJ5XG57XG4gICAgcHVibGljIGJ1ZmZlcnM6IEFycmF5PEJ1ZmZlcj47XG4gICAgcHVibGljIGluZGV4QnVmZmVyOiBCdWZmZXI7XG4gICAgcHVibGljIGF0dHJpYnV0ZXM6IHtba2V5OiBzdHJpbmddOiBBdHRyaWJ1dGV9O1xuICAgIHB1YmxpYyBpZDogbnVtYmVyO1xuICAgIHB1YmxpYyBpbnN0YW5jZWQ6IGJvb2xlYW47XG4gICAgcHVibGljIGluc3RhbmNlQ291bnQ6IG51bWJlcjtcbiAgICBnbFZlcnRleEFycmF5T2JqZWN0czoge1trZXk6IG51bWJlcl06IHtba2V5OiBzdHJpbmddOiBXZWJHTFZlcnRleEFycmF5T2JqZWN0fX07XG4gICAgZGlzcG9zZVJ1bm5lcjogUnVubmVyO1xuICAgIHJlZkNvdW50OiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLkJ1ZmZlcltdfSBbYnVmZmVyc10gLSBhbiBhcnJheSBvZiBidWZmZXJzLiBvcHRpb25hbC5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW2F0dHJpYnV0ZXNdIC0gb2YgdGhlIGdlb21ldHJ5LCBvcHRpb25hbCBzdHJ1Y3R1cmUgb2YgdGhlIGF0dHJpYnV0ZXMgbGF5b3V0XG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYnVmZmVyczogQXJyYXk8QnVmZmVyPiA9IFtdLCBhdHRyaWJ1dGVzOiB7W2tleTogc3RyaW5nXTogQXR0cmlidXRlfSA9IHt9KVxuICAgIHtcbiAgICAgICAgdGhpcy5idWZmZXJzID0gYnVmZmVycztcblxuICAgICAgICB0aGlzLmluZGV4QnVmZmVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcCBvZiByZW5kZXJlciBJRHMgdG8gd2ViZ2wgVkFPc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdsVmVydGV4QXJyYXlPYmplY3RzID0ge307XG5cbiAgICAgICAgdGhpcy5pZCA9IFVJRCsrO1xuXG4gICAgICAgIHRoaXMuaW5zdGFuY2VkID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE51bWJlciBvZiBpbnN0YW5jZXMgaW4gdGhpcyBnZW9tZXRyeSwgcGFzcyBpdCB0byBgR2VvbWV0cnlTeXN0ZW0uZHJhdygpYFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5zdGFuY2VDb3VudCA9IDE7XG5cbiAgICAgICAgdGhpcy5kaXNwb3NlUnVubmVyID0gbmV3IFJ1bm5lcignZGlzcG9zZUdlb21ldHJ5Jyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvdW50IG9mIGV4aXN0aW5nIChub3QgZGVzdHJveWVkKSBtZXNoZXMgdGhhdCByZWZlcmVuY2UgdGhpcyBnZW9tZXRyeVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlZkNvdW50ID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqXG4gICAgKiBBZGRzIGFuIGF0dHJpYnV0ZSB0byB0aGUgZ2VvbWV0cnlcbiAgICAqIE5vdGU6IGBzdHJpZGVgIGFuZCBgc3RhcnRgIHNob3VsZCBiZSBgdW5kZWZpbmVkYCBpZiB5b3UgZG9udCBrbm93IHRoZW0sIG5vdCAwIVxuICAgICpcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZCAtIHRoZSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgKG1hdGNoaW5nIHVwIHRvIGEgc2hhZGVyKVxuICAgICogQHBhcmFtIHtQSVhJLkJ1ZmZlcnxudW1iZXJbXX0gW2J1ZmZlcl0gLSB0aGUgYnVmZmVyIHRoYXQgaG9sZHMgdGhlIGRhdGEgb2YgdGhlIGF0dHJpYnV0ZSAuIFlvdSBjYW4gYWxzbyBwcm92aWRlIGFuIEFycmF5IGFuZCBhIGJ1ZmZlciB3aWxsIGJlIGNyZWF0ZWQgZnJvbSBpdC5cbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc2l6ZT0wXSAtIHRoZSBzaXplIG9mIHRoZSBhdHRyaWJ1dGUuIElmIHlvdSBoYXZlIDIgZmxvYXRzIHBlciB2ZXJ0ZXggKGVnIHBvc2l0aW9uIHggYW5kIHkpIHRoaXMgd291bGQgYmUgMlxuICAgICogQHBhcmFtIHtCb29sZWFufSBbbm9ybWFsaXplZD1mYWxzZV0gLSBzaG91bGQgdGhlIGRhdGEgYmUgbm9ybWFsaXplZC5cbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBbdHlwZT1QSVhJLlRZUEVTLkZMT0FUXSAtIHdoYXQgdHlwZSBvZiBudW1iZXIgaXMgdGhlIGF0dHJpYnV0ZS4gQ2hlY2sge1BJWEkuVFlQRVN9IHRvIHNlZSB0aGUgb25lcyBhdmFpbGFibGVcbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc3RyaWRlXSAtIEhvdyBmYXIgYXBhcnQgKGluIGZsb2F0cykgdGhlIHN0YXJ0IG9mIGVhY2ggdmFsdWUgaXMuICh1c2VkIGZvciBpbnRlcmxlYXZpbmcgZGF0YSlcbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRdIC0gSG93IGZhciBpbnRvIHRoZSBhcnJheSB0byBzdGFydCByZWFkaW5nIHZhbHVlcyAodXNlZCBmb3IgaW50ZXJsZWF2aW5nIGRhdGEpXG4gICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpbnN0YW5jZT1mYWxzZV0gLSBJbnN0YW5jaW5nIGZsYWdcbiAgICAqXG4gICAgKiBAcmV0dXJuIHtQSVhJLkdlb21ldHJ5fSByZXR1cm5zIHNlbGYsIHVzZWZ1bCBmb3IgY2hhaW5pbmcuXG4gICAgKi9cbiAgICBhZGRBdHRyaWJ1dGUoaWQ6IHN0cmluZywgYnVmZmVyOiBCdWZmZXJ8RmxvYXQzMkFycmF5fFVpbnQzMkFycmF5fEFycmF5PG51bWJlcj4sIHNpemUgPSAwLCBub3JtYWxpemVkID0gZmFsc2UsXG4gICAgICAgIHR5cGU/OiBUWVBFUywgc3RyaWRlPzogbnVtYmVyLCBzdGFydD86IG51bWJlciwgaW5zdGFuY2UgPSBmYWxzZSk6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmICghYnVmZmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYSBidWZmZXIgd2hlbiBjcmVhdGluZyBhbiBhdHRyaWJ1dGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgaXMgYSBidWZmZXIhXG4gICAgICAgIGlmICghKGJ1ZmZlciBpbnN0YW5jZW9mIEJ1ZmZlcikpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGl0cyBhbiBhcnJheSFcbiAgICAgICAgICAgIGlmIChidWZmZXIgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmZlcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1ZmZlciA9IG5ldyBCdWZmZXIoYnVmZmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlkcyA9IGlkLnNwbGl0KCd8Jyk7XG5cbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPiAxKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZShpZHNbaV0sIGJ1ZmZlciwgc2l6ZSwgbm9ybWFsaXplZCwgdHlwZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGJ1ZmZlckluZGV4ID0gdGhpcy5idWZmZXJzLmluZGV4T2YoYnVmZmVyKTtcblxuICAgICAgICBpZiAoYnVmZmVySW5kZXggPT09IC0xKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaChidWZmZXIpO1xuICAgICAgICAgICAgYnVmZmVySW5kZXggPSB0aGlzLmJ1ZmZlcnMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXR0cmlidXRlc1tpZF0gPSBuZXcgQXR0cmlidXRlKGJ1ZmZlckluZGV4LCBzaXplLCBub3JtYWxpemVkLCB0eXBlLCBzdHJpZGUsIHN0YXJ0LCBpbnN0YW5jZSk7XG5cbiAgICAgICAgLy8gYXNzdW1pbmcgdGhhdCBpZiB0aGVyZSBpcyBpbnN0YW5jZWQgZGF0YSB0aGVuIHRoaXMgd2lsbCBiZSBkcmF3biB3aXRoIGluc3RhbmNpbmchXG4gICAgICAgIHRoaXMuaW5zdGFuY2VkID0gdGhpcy5pbnN0YW5jZWQgfHwgaW5zdGFuY2U7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgcmVxdWVzdGVkIGF0dHJpYnV0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkIC0gdGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSByZXF1aXJlZFxuICAgICAqIEByZXR1cm4ge1BJWEkuQXR0cmlidXRlfSB0aGUgYXR0cmlidXRlIHJlcXVlc3RlZC5cbiAgICAgKi9cbiAgICBnZXRBdHRyaWJ1dGUoaWQ6IHN0cmluZyk6IEF0dHJpYnV0ZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlc1tpZF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgcmVxdWVzdGVkIGJ1ZmZlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkIC0gdGhlIG5hbWUgb2YgdGhlIGJ1ZmZlciByZXF1aXJlZFxuICAgICAqIEByZXR1cm4ge1BJWEkuQnVmZmVyfSB0aGUgYnVmZmVyIHJlcXVlc3RlZC5cbiAgICAgKi9cbiAgICBnZXRCdWZmZXIoaWQ6IHN0cmluZyk6IEJ1ZmZlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyc1t0aGlzLmdldEF0dHJpYnV0ZShpZCkuYnVmZmVyXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqXG4gICAgKiBBZGRzIGFuIGluZGV4IGJ1ZmZlciB0byB0aGUgZ2VvbWV0cnlcbiAgICAqIFRoZSBpbmRleCBidWZmZXIgY29udGFpbnMgaW50ZWdlcnMsIHRocmVlIGZvciBlYWNoIHRyaWFuZ2xlIGluIHRoZSBnZW9tZXRyeSwgd2hpY2ggcmVmZXJlbmNlIHRoZSB2YXJpb3VzIGF0dHJpYnV0ZSBidWZmZXJzIChwb3NpdGlvbiwgY29sb3VyLCBVViBjb29yZGluYXRlcywgb3RoZXIgVVYgY29vcmRpbmF0ZXMsIG5vcm1hbCwgXHUyMDI2KS4gVGhlcmUgaXMgb25seSBPTkUgaW5kZXggYnVmZmVyLlxuICAgICpcbiAgICAqIEBwYXJhbSB7UElYSS5CdWZmZXJ8bnVtYmVyW119IFtidWZmZXJdIC0gdGhlIGJ1ZmZlciB0aGF0IGhvbGRzIHRoZSBkYXRhIG9mIHRoZSBpbmRleCBidWZmZXIuIFlvdSBjYW4gYWxzbyBwcm92aWRlIGFuIEFycmF5IGFuZCBhIGJ1ZmZlciB3aWxsIGJlIGNyZWF0ZWQgZnJvbSBpdC5cbiAgICAqIEByZXR1cm4ge1BJWEkuR2VvbWV0cnl9IHJldHVybnMgc2VsZiwgdXNlZnVsIGZvciBjaGFpbmluZy5cbiAgICAqL1xuICAgIGFkZEluZGV4KGJ1ZmZlcj86IEJ1ZmZlciB8IElBcnJheUJ1ZmZlciB8IG51bWJlcltdKTogR2VvbWV0cnlcbiAgICB7XG4gICAgICAgIGlmICghKGJ1ZmZlciBpbnN0YW5jZW9mIEJ1ZmZlcikpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGl0cyBhbiBhcnJheSFcbiAgICAgICAgICAgIGlmIChidWZmZXIgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBuZXcgVWludDE2QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnVmZmVyID0gbmV3IEJ1ZmZlcihidWZmZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnVmZmVyLmluZGV4ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pbmRleEJ1ZmZlciA9IGJ1ZmZlcjtcblxuICAgICAgICBpZiAodGhpcy5idWZmZXJzLmluZGV4T2YoYnVmZmVyKSA9PT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVycy5wdXNoKGJ1ZmZlcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSBpbmRleCBidWZmZXJcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuQnVmZmVyfSB0aGUgaW5kZXggYnVmZmVyLlxuICAgICAqL1xuICAgIGdldEluZGV4KCk6IEJ1ZmZlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhCdWZmZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGhpcyBmdW5jdGlvbiBtb2RpZmllcyB0aGUgc3RydWN0dXJlIHNvIHRoYXQgYWxsIGN1cnJlbnQgYXR0cmlidXRlcyBiZWNvbWUgaW50ZXJsZWF2ZWQgaW50byBhIHNpbmdsZSBidWZmZXJcbiAgICAgKiBUaGlzIGNhbiBiZSB1c2VmdWwgaWYgeW91ciBtb2RlbCByZW1haW5zIHN0YXRpYyBhcyBpdCBvZmZlcnMgYSBsaXR0bGUgcGVyZm9ybWFuY2UgYm9vc3RcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuR2VvbWV0cnl9IHJldHVybnMgc2VsZiwgdXNlZnVsIGZvciBjaGFpbmluZy5cbiAgICAgKi9cbiAgICBpbnRlcmxlYXZlKCk6IEdlb21ldHJ5XG4gICAge1xuICAgICAgICAvLyBhIHNpbXBsZSBjaGVjayB0byBzZWUgaWYgYnVmZmVycyBhcmUgYWxyZWFkeSBpbnRlcmxlYXZlZC4uXG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlcnMubGVuZ3RoID09PSAxIHx8ICh0aGlzLmJ1ZmZlcnMubGVuZ3RoID09PSAyICYmIHRoaXMuaW5kZXhCdWZmZXIpKSByZXR1cm4gdGhpcztcblxuICAgICAgICAvLyBhc3N1bWUgYWxyZWFkeSB0aGF0IG5vIGJ1ZmZlcnMgYXJlIGludGVybGVhdmVkXG4gICAgICAgIGNvbnN0IGFycmF5cyA9IFtdO1xuICAgICAgICBjb25zdCBzaXplcyA9IFtdO1xuICAgICAgICBjb25zdCBpbnRlcmxlYXZlZEJ1ZmZlciA9IG5ldyBCdWZmZXIoKTtcbiAgICAgICAgbGV0IGk7XG5cbiAgICAgICAgZm9yIChpIGluIHRoaXMuYXR0cmlidXRlcylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGVzW2ldO1xuXG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSB0aGlzLmJ1ZmZlcnNbYXR0cmlidXRlLmJ1ZmZlcl07XG5cbiAgICAgICAgICAgIGFycmF5cy5wdXNoKGJ1ZmZlci5kYXRhKTtcblxuICAgICAgICAgICAgc2l6ZXMucHVzaCgoYXR0cmlidXRlLnNpemUgKiBieXRlU2l6ZU1hcFthdHRyaWJ1dGUudHlwZV0pIC8gNCk7XG5cbiAgICAgICAgICAgIGF0dHJpYnV0ZS5idWZmZXIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaW50ZXJsZWF2ZWRCdWZmZXIuZGF0YSA9IGludGVybGVhdmVUeXBlZEFycmF5cyhhcnJheXMsIHNpemVzKTtcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5idWZmZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5idWZmZXJzW2ldICE9PSB0aGlzLmluZGV4QnVmZmVyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyc1tpXS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbaW50ZXJsZWF2ZWRCdWZmZXJdO1xuXG4gICAgICAgIGlmICh0aGlzLmluZGV4QnVmZmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaCh0aGlzLmluZGV4QnVmZmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGdldFNpemUoKTogbnVtYmVyXG4gICAge1xuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gdGhpcy5hdHRyaWJ1dGVzKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSB0aGlzLmF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSB0aGlzLmJ1ZmZlcnNbYXR0cmlidXRlLmJ1ZmZlcl07XG5cbiAgICAgICAgICAgIHJldHVybiAoYnVmZmVyLmRhdGEgYXMgYW55KS5sZW5ndGggLyAoKGF0dHJpYnV0ZS5zdHJpZGUgLyA0KSB8fCBhdHRyaWJ1dGUuc2l6ZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBkaXNwb3NlcyBXZWJHTCByZXNvdXJjZXMgdGhhdCBhcmUgY29ubmVjdGVkIHRvIHRoaXMgZ2VvbWV0cnlcbiAgICAgKi9cbiAgICBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZGlzcG9zZVJ1bm5lci5lbWl0KHRoaXMsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgZ2VvbWV0cnkuXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcblxuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLmluZGV4QnVmZmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIGEgY2xvbmUgb2YgdGhlIGdlb21ldHJ5XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UElYSS5HZW9tZXRyeX0gYSBuZXcgY2xvbmUgb2YgdGhpcyBnZW9tZXRyeVxuICAgICAqL1xuICAgIGNsb25lKCk6IEdlb21ldHJ5XG4gICAge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBHZW9tZXRyeSgpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5idWZmZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBnZW9tZXRyeS5idWZmZXJzW2ldID0gbmV3IEJ1ZmZlcih0aGlzLmJ1ZmZlcnNbaV0uZGF0YS5zbGljZSgwKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gdGhpcy5hdHRyaWJ1dGVzKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWIgPSB0aGlzLmF0dHJpYnV0ZXNbaV07XG5cbiAgICAgICAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXNbaV0gPSBuZXcgQXR0cmlidXRlKFxuICAgICAgICAgICAgICAgIGF0dHJpYi5idWZmZXIsXG4gICAgICAgICAgICAgICAgYXR0cmliLnNpemUsXG4gICAgICAgICAgICAgICAgYXR0cmliLm5vcm1hbGl6ZWQsXG4gICAgICAgICAgICAgICAgYXR0cmliLnR5cGUsXG4gICAgICAgICAgICAgICAgYXR0cmliLnN0cmlkZSxcbiAgICAgICAgICAgICAgICBhdHRyaWIuc3RhcnQsXG4gICAgICAgICAgICAgICAgYXR0cmliLmluc3RhbmNlXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaW5kZXhCdWZmZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdlb21ldHJ5LmluZGV4QnVmZmVyID0gZ2VvbWV0cnkuYnVmZmVyc1t0aGlzLmJ1ZmZlcnMuaW5kZXhPZih0aGlzLmluZGV4QnVmZmVyKV07XG4gICAgICAgICAgICBnZW9tZXRyeS5pbmRleEJ1ZmZlci5pbmRleCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZ2VvbWV0cnk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbWVyZ2VzIGFuIGFycmF5IG9mIGdlb21ldHJpZXMgaW50byBhIG5ldyBzaW5nbGUgb25lXG4gICAgICogZ2VvbWV0cnkgYXR0cmlidXRlIHN0eWxlcyBtdXN0IG1hdGNoIGZvciB0aGlzIG9wZXJhdGlvbiB0byB3b3JrXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuR2VvbWV0cnlbXX0gZ2VvbWV0cmllcyAtIGFycmF5IG9mIGdlb21ldHJpZXMgdG8gbWVyZ2VcbiAgICAgKiBAcmV0dXJucyB7UElYSS5HZW9tZXRyeX0gc2hpbnkgbmV3IGdlb21ldHJ5IVxuICAgICAqL1xuICAgIHN0YXRpYyBtZXJnZShnZW9tZXRyaWVzOiBBcnJheTxHZW9tZXRyeT4pOiBHZW9tZXRyeVxuICAgIHtcbiAgICAgICAgLy8gdG9kbyBhZGQgYSBnZW9tZXRyeSBjaGVjayFcbiAgICAgICAgLy8gYWxzbyBhIHNpemUgY2hlY2suLiBjYW50IGJlIHRvbyBiaWchXVxuXG4gICAgICAgIGNvbnN0IGdlb21ldHJ5T3V0ID0gbmV3IEdlb21ldHJ5KCk7XG5cbiAgICAgICAgY29uc3QgYXJyYXlzID0gW107XG4gICAgICAgIGNvbnN0IHNpemVzOiBBcnJheTxudW1iZXI+ID0gW107XG4gICAgICAgIGNvbnN0IG9mZnNldHMgPSBbXTtcblxuICAgICAgICBsZXQgZ2VvbWV0cnk7XG5cbiAgICAgICAgLy8gcGFzcyBvbmUuLiBnZXQgc2l6ZXMuLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdlb21ldHJ5ID0gZ2VvbWV0cmllc1tpXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBnZW9tZXRyeS5idWZmZXJzLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNpemVzW2pdID0gc2l6ZXNbal0gfHwgMDtcbiAgICAgICAgICAgICAgICBzaXplc1tqXSArPSBnZW9tZXRyeS5idWZmZXJzW2pdLmRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgICAgIG9mZnNldHNbal0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gYnVpbGQgdGhlIGNvcnJlY3Qgc2l6ZSBhcnJheXMuLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdlb21ldHJ5LmJ1ZmZlcnMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIFRPRE8gdHlwZXMhXG4gICAgICAgICAgICBhcnJheXNbaV0gPSBuZXcgbWFwW2dldEJ1ZmZlclR5cGUoZ2VvbWV0cnkuYnVmZmVyc1tpXS5kYXRhKV0oc2l6ZXNbaV0pO1xuICAgICAgICAgICAgZ2VvbWV0cnlPdXQuYnVmZmVyc1tpXSA9IG5ldyBCdWZmZXIoYXJyYXlzW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBhc3MgdG8gc2V0IGRhdGEuLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdlb21ldHJ5ID0gZ2VvbWV0cmllc1tpXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBnZW9tZXRyeS5idWZmZXJzLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFycmF5c1tqXS5zZXQoZ2VvbWV0cnkuYnVmZmVyc1tqXS5kYXRhLCBvZmZzZXRzW2pdKTtcbiAgICAgICAgICAgICAgICBvZmZzZXRzW2pdICs9IGdlb21ldHJ5LmJ1ZmZlcnNbal0uZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBnZW9tZXRyeU91dC5hdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlcztcblxuICAgICAgICBpZiAoZ2VvbWV0cnkuaW5kZXhCdWZmZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdlb21ldHJ5T3V0LmluZGV4QnVmZmVyID0gZ2VvbWV0cnlPdXQuYnVmZmVyc1tnZW9tZXRyeS5idWZmZXJzLmluZGV4T2YoZ2VvbWV0cnkuaW5kZXhCdWZmZXIpXTtcbiAgICAgICAgICAgIGdlb21ldHJ5T3V0LmluZGV4QnVmZmVyLmluZGV4ID0gdHJ1ZTtcblxuICAgICAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgICAgICBsZXQgc3RyaWRlID0gMDtcbiAgICAgICAgICAgIGxldCBvZmZzZXQyID0gMDtcbiAgICAgICAgICAgIGxldCBidWZmZXJJbmRleFRvQ291bnQgPSAwO1xuXG4gICAgICAgICAgICAvLyBnZXQgYSBidWZmZXJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2VvbWV0cnkuYnVmZmVycy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkuYnVmZmVyc1tpXSAhPT0gZ2VvbWV0cnkuaW5kZXhCdWZmZXIpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBidWZmZXJJbmRleFRvQ291bnQgPSBpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGZpZ3VyZSBvdXQgdGhlIHN0cmlkZSBvZiBvbmUgYnVmZmVyLi5cbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBpbiBnZW9tZXRyeS5hdHRyaWJ1dGVzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGdlb21ldHJ5LmF0dHJpYnV0ZXNbaV07XG5cbiAgICAgICAgICAgICAgICBpZiAoKGF0dHJpYnV0ZS5idWZmZXIgfCAwKSA9PT0gYnVmZmVySW5kZXhUb0NvdW50KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyaWRlICs9ICgoYXR0cmlidXRlLnNpemUgKiBieXRlU2l6ZU1hcFthdHRyaWJ1dGUudHlwZV0pIC8gNCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB0aW1lIHRvIG9mZiBzZXQgYWxsIGluZGV4ZXMuLlxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnZW9tZXRyaWVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4QnVmZmVyRGF0YSA9IGdlb21ldHJpZXNbaV0uaW5kZXhCdWZmZXIuZGF0YTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaW5kZXhCdWZmZXJEYXRhLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnlPdXQuaW5kZXhCdWZmZXIuZGF0YVtqICsgb2Zmc2V0Ml0gKz0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG9mZnNldCArPSBnZW9tZXRyeS5idWZmZXJzW2J1ZmZlckluZGV4VG9Db3VudF0uZGF0YS5sZW5ndGggLyAoc3RyaWRlKTtcbiAgICAgICAgICAgICAgICBvZmZzZXQyICs9IGluZGV4QnVmZmVyRGF0YS5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZ2VvbWV0cnlPdXQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEdlb21ldHJ5IH0gZnJvbSAnLi4vZ2VvbWV0cnkvR2VvbWV0cnknO1xuXG4vKipcbiAqIEhlbHBlciBjbGFzcyB0byBjcmVhdGUgYSBxdWFkXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgUXVhZCBleHRlbmRzIEdlb21ldHJ5XG57XG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSgnYVZlcnRleFBvc2l0aW9uJywgbmV3IEZsb2F0MzJBcnJheShbXG4gICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgMSwgMCxcbiAgICAgICAgICAgIDEsIDEsXG4gICAgICAgICAgICAwLCAxLFxuICAgICAgICBdKSlcbiAgICAgICAgICAgIC5hZGRJbmRleChbMCwgMSwgMywgMl0pO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBHZW9tZXRyeSB9IGZyb20gJy4uL2dlb21ldHJ5L0dlb21ldHJ5JztcbmltcG9ydCB7IEJ1ZmZlciB9IGZyb20gJy4uL2dlb21ldHJ5L0J1ZmZlcic7XG5cbmltcG9ydCB0eXBlIHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogSGVscGVyIGNsYXNzIHRvIGNyZWF0ZSBhIHF1YWQgd2l0aCB1dnMgbGlrZSBpbiB2NFxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBleHRlbmRzIFBJWEkuR2VvbWV0cnlcbiAqL1xuZXhwb3J0IGNsYXNzIFF1YWRVdiBleHRlbmRzIEdlb21ldHJ5XG57XG4gICAgdmVydGV4QnVmZmVyOiBCdWZmZXI7XG4gICAgdXZCdWZmZXI6IEJ1ZmZlcjtcbiAgICB2ZXJ0aWNlczogRmxvYXQzMkFycmF5O1xuICAgIHV2czogRmxvYXQzMkFycmF5O1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gYXJyYXkgb2YgdmVydGljZXNcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7RmxvYXQzMkFycmF5fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoW1xuICAgICAgICAgICAgLTEsIC0xLFxuICAgICAgICAgICAgMSwgLTEsXG4gICAgICAgICAgICAxLCAxLFxuICAgICAgICAgICAgLTEsIDEsXG4gICAgICAgIF0pO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgVXZzIG9mIHRoZSBxdWFkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge0Zsb2F0MzJBcnJheX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZzID0gbmV3IEZsb2F0MzJBcnJheShbXG4gICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgMSwgMCxcbiAgICAgICAgICAgIDEsIDEsXG4gICAgICAgICAgICAwLCAxLFxuICAgICAgICBdKTtcblxuICAgICAgICB0aGlzLnZlcnRleEJ1ZmZlciA9IG5ldyBCdWZmZXIodGhpcy52ZXJ0aWNlcyk7XG4gICAgICAgIHRoaXMudXZCdWZmZXIgPSBuZXcgQnVmZmVyKHRoaXMudXZzKTtcblxuICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSgnYVZlcnRleFBvc2l0aW9uJywgdGhpcy52ZXJ0ZXhCdWZmZXIpXG4gICAgICAgICAgICAuYWRkQXR0cmlidXRlKCdhVGV4dHVyZUNvb3JkJywgdGhpcy51dkJ1ZmZlcilcbiAgICAgICAgICAgIC5hZGRJbmRleChbMCwgMSwgMiwgMCwgMiwgM10pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hcHMgdHdvIFJlY3RhbmdsZSB0byB0aGUgcXVhZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IHRhcmdldFRleHR1cmVGcmFtZSAtIHRoZSBmaXJzdCByZWN0YW5nbGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBkZXN0aW5hdGlvbkZyYW1lIC0gdGhlIHNlY29uZCByZWN0YW5nbGVcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlF1YWR9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIG1hcCh0YXJnZXRUZXh0dXJlRnJhbWU6IFJlY3RhbmdsZSwgZGVzdGluYXRpb25GcmFtZTogUmVjdGFuZ2xlKTogdGhpc1xuICAgIHtcbiAgICAgICAgbGV0IHggPSAwOyAvLyBkZXN0aW5hdGlvbkZyYW1lLnggLyB0YXJnZXRUZXh0dXJlRnJhbWUud2lkdGg7XG4gICAgICAgIGxldCB5ID0gMDsgLy8gZGVzdGluYXRpb25GcmFtZS55IC8gdGFyZ2V0VGV4dHVyZUZyYW1lLmhlaWdodDtcblxuICAgICAgICB0aGlzLnV2c1swXSA9IHg7XG4gICAgICAgIHRoaXMudXZzWzFdID0geTtcblxuICAgICAgICB0aGlzLnV2c1syXSA9IHggKyAoZGVzdGluYXRpb25GcmFtZS53aWR0aCAvIHRhcmdldFRleHR1cmVGcmFtZS53aWR0aCk7XG4gICAgICAgIHRoaXMudXZzWzNdID0geTtcblxuICAgICAgICB0aGlzLnV2c1s0XSA9IHggKyAoZGVzdGluYXRpb25GcmFtZS53aWR0aCAvIHRhcmdldFRleHR1cmVGcmFtZS53aWR0aCk7XG4gICAgICAgIHRoaXMudXZzWzVdID0geSArIChkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCAvIHRhcmdldFRleHR1cmVGcmFtZS5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMudXZzWzZdID0geDtcbiAgICAgICAgdGhpcy51dnNbN10gPSB5ICsgKGRlc3RpbmF0aW9uRnJhbWUuaGVpZ2h0IC8gdGFyZ2V0VGV4dHVyZUZyYW1lLmhlaWdodCk7XG5cbiAgICAgICAgeCA9IGRlc3RpbmF0aW9uRnJhbWUueDtcbiAgICAgICAgeSA9IGRlc3RpbmF0aW9uRnJhbWUueTtcblxuICAgICAgICB0aGlzLnZlcnRpY2VzWzBdID0geDtcbiAgICAgICAgdGhpcy52ZXJ0aWNlc1sxXSA9IHk7XG5cbiAgICAgICAgdGhpcy52ZXJ0aWNlc1syXSA9IHggKyBkZXN0aW5hdGlvbkZyYW1lLndpZHRoO1xuICAgICAgICB0aGlzLnZlcnRpY2VzWzNdID0geTtcblxuICAgICAgICB0aGlzLnZlcnRpY2VzWzRdID0geCArIGRlc3RpbmF0aW9uRnJhbWUud2lkdGg7XG4gICAgICAgIHRoaXMudmVydGljZXNbNV0gPSB5ICsgZGVzdGluYXRpb25GcmFtZS5oZWlnaHQ7XG5cbiAgICAgICAgdGhpcy52ZXJ0aWNlc1s2XSA9IHg7XG4gICAgICAgIHRoaXMudmVydGljZXNbN10gPSB5ICsgZGVzdGluYXRpb25GcmFtZS5oZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbGVnYWN5IHVwbG9hZCBtZXRob2QsIGp1c3QgbWFya3MgYnVmZmVycyBkaXJ0eVxuICAgICAqIEByZXR1cm5zIHtQSVhJLlF1YWRVdn0gUmV0dXJucyBpdHNlbGYuXG4gICAgICovXG4gICAgaW52YWxpZGF0ZSgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLnZlcnRleEJ1ZmZlci5fdXBkYXRlSUQrKztcbiAgICAgICAgdGhpcy51dkJ1ZmZlci5fdXBkYXRlSUQrKztcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHR5cGUgeyBVbmlmb3Jtc1N5bmNDYWxsYmFjayB9IGZyb20gJy4vdXRpbHMnO1xuXG5sZXQgVUlEID0gMDtcblxuLyoqXG4gKiBVbmlmb3JtIGdyb3VwIGhvbGRzIHVuaWZvcm0gbWFwIGFuZCBzb21lIElEJ3MgZm9yIHdvcmtcbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBVbmlmb3JtR3JvdXBcbntcbiAgICBwdWJsaWMgcmVhZG9ubHkgdW5pZm9ybXM6IERpY3Q8YW55PjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgZ3JvdXA6IGJvb2xlYW47XG4gICAgcHVibGljIGlkOiBudW1iZXI7XG4gICAgc3luY1VuaWZvcm1zOiBEaWN0PFVuaWZvcm1zU3luY0NhbGxiYWNrPjtcbiAgICBkaXJ0eUlkOiBudW1iZXI7XG4gICAgc3RhdGljOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFt1bmlmb3Jtc10gLSBDdXN0b20gdW5pZm9ybXMgdG8gdXNlIHRvIGF1Z21lbnQgdGhlIGJ1aWx0LWluIG9uZXMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbX3N0YXRpY10gLSBVbmlmb3JtcyB3b250IGJlIGNoYW5nZWQgYWZ0ZXIgY3JlYXRpb25cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih1bmlmb3JtczogRGljdDxhbnk+LCBfc3RhdGljPzogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiB1bmlmb3JtIHZhbHVlc1xuICAgICAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51bmlmb3JtcyA9IHVuaWZvcm1zO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJdHMgYSBncm91cCBhbmQgbm90IGEgc2luZ2xlIHVuaWZvcm1zXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdyb3VwID0gdHJ1ZTtcblxuICAgICAgICAvLyBsZXRzIGdlbmVyYXRlIHRoaXMgd2hlbiB0aGUgc2hhZGVyID9cbiAgICAgICAgdGhpcy5zeW5jVW5pZm9ybXMgPSB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogZGlydHkgdmVyc2lvblxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlydHlJZCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHVuaXF1ZSBpZFxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaWQgPSBVSUQrKztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVW5pZm9ybXMgd29udCBiZSBjaGFuZ2VkIGFmdGVyIGNyZWF0aW9uXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXRpYyA9ICEhX3N0YXRpYztcbiAgICB9XG5cbiAgICB1cGRhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5kaXJ0eUlkKys7XG4gICAgfVxuXG4gICAgYWRkKG5hbWU6IHN0cmluZywgdW5pZm9ybXM6IERpY3Q8YW55PiwgX3N0YXRpYzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudW5pZm9ybXNbbmFtZV0gPSBuZXcgVW5pZm9ybUdyb3VwKHVuaWZvcm1zLCBfc3RhdGljKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZnJvbSh1bmlmb3JtczogRGljdDxhbnk+LCBfc3RhdGljOiBib29sZWFuKTogVW5pZm9ybUdyb3VwXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IFVuaWZvcm1Hcm91cCh1bmlmb3JtcywgX3N0YXRpYyk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFJlY3RhbmdsZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG5pbXBvcnQgdHlwZSB7IEZpbHRlciB9IGZyb20gJy4vRmlsdGVyJztcbmltcG9ydCB0eXBlIHsgSUZpbHRlclRhcmdldCB9IGZyb20gJy4vSUZpbHRlclRhcmdldCc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlclRleHR1cmUgfSBmcm9tICcuLi9yZW5kZXJUZXh0dXJlL1JlbmRlclRleHR1cmUnO1xuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSBmaWx0ZXIgc3RhdGVzLlxuICpcbiAqIEBjbGFzc1xuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNsYXNzIEZpbHRlclN0YXRlXG57XG4gICAgcmVuZGVyVGV4dHVyZTogUmVuZGVyVGV4dHVyZTtcbiAgICB0YXJnZXQ6IElGaWx0ZXJUYXJnZXQ7XG4gICAgbGVnYWN5OiBib29sZWFuO1xuICAgIHJlc29sdXRpb246IG51bWJlcjtcbiAgICBzb3VyY2VGcmFtZTogUmVjdGFuZ2xlO1xuICAgIGRlc3RpbmF0aW9uRnJhbWU6IFJlY3RhbmdsZTtcbiAgICBmaWx0ZXJzOiBBcnJheTxGaWx0ZXI+O1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgdGhpcy5yZW5kZXJUZXh0dXJlID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGFyZ2V0IG9mIHRoZSBmaWx0ZXJzXG4gICAgICAgICAqIFdlIHN0b3JlIGZvciBjYXNlIHdoZW4gY3VzdG9tIGZpbHRlciB3YW50cyB0byBrbm93IHRoZSBlbGVtZW50IGl0IHdhcyBhcHBsaWVkIG9uXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRGlzcGxheU9iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29tcGF0aWJpbGl0eSB3aXRoIFBpeGlKUyB2NCBmaWx0ZXJzXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxlZ2FjeSA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNvbHV0aW9uIG9mIGZpbHRlcnNcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlc29sdXRpb24gPSAxO1xuXG4gICAgICAgIC8vIG5leHQgdGhyZWUgZmllbGRzIGFyZSBjcmVhdGVkIG9ubHkgZm9yIHJvb3RcbiAgICAgICAgLy8gcmUtYXNzaWduZWQgZm9yIGV2ZXJ5dGhpbmcgZWxzZVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTb3VyY2UgZnJhbWVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNvdXJjZUZyYW1lID0gbmV3IFJlY3RhbmdsZSgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZXN0aW5hdGlvbiBmcmFtZVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVzdGluYXRpb25GcmFtZSA9IG5ldyBSZWN0YW5nbGUoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29sbGVjdGlvbiBvZiBmaWx0ZXJzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRmlsdGVyW119XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZpbHRlcnMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjbGVhcnMgdGhlIHN0YXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnRhcmdldCA9IG51bGw7XG4gICAgICAgIHRoaXMuZmlsdGVycyA9IG51bGw7XG4gICAgICAgIHRoaXMucmVuZGVyVGV4dHVyZSA9IG51bGw7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBSZW5kZXJUZXh0dXJlUG9vbCB9IGZyb20gJy4uL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZVBvb2wnO1xuaW1wb3J0IHsgUXVhZCB9IGZyb20gJy4uL3V0aWxzL1F1YWQnO1xuaW1wb3J0IHsgUXVhZFV2IH0gZnJvbSAnLi4vdXRpbHMvUXVhZFV2JztcbmltcG9ydCB7IFJlY3RhbmdsZSwgTWF0cml4IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBVbmlmb3JtR3JvdXAgfSBmcm9tICcuLi9zaGFkZXIvVW5pZm9ybUdyb3VwJztcbmltcG9ydCB7IERSQVdfTU9ERVMsIENMRUFSX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IGRlcHJlY2F0aW9uIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgRmlsdGVyU3RhdGUgfSBmcm9tICcuL0ZpbHRlclN0YXRlJztcblxuaW1wb3J0IHR5cGUgeyBGaWx0ZXIgfSBmcm9tICcuL0ZpbHRlcic7XG5pbXBvcnQgdHlwZSB7IElGaWx0ZXJUYXJnZXQgfSBmcm9tICcuL0lGaWx0ZXJUYXJnZXQnO1xuaW1wb3J0IHR5cGUgeyBJU3ByaXRlTWFza1RhcmdldCB9IGZyb20gJy4vc3ByaXRlTWFzay9TcHJpdGVNYXNrRmlsdGVyJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4uL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZSc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuLyoqXG4gKiBTeXN0ZW0gcGx1Z2luIHRvIHRoZSByZW5kZXJlciB0byBtYW5hZ2UgdGhlIGZpbHRlcnMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKiBAZXh0ZW5kcyBQSVhJLlN5c3RlbVxuICovXG5leHBvcnQgY2xhc3MgRmlsdGVyU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHVibGljIHJlYWRvbmx5IGRlZmF1bHRGaWx0ZXJTdGFjazogQXJyYXk8RmlsdGVyU3RhdGU+O1xuICAgIHB1YmxpYyBzdGF0ZVBvb2w6IEFycmF5PEZpbHRlclN0YXRlPjtcbiAgICBwdWJsaWMgdGV4dHVyZVBvb2w6IFJlbmRlclRleHR1cmVQb29sO1xuICAgIHB1YmxpYyBmb3JjZUNsZWFyOiBib29sZWFuO1xuICAgIHB1YmxpYyB1c2VNYXhQYWRkaW5nOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBxdWFkOiBRdWFkO1xuICAgIHByb3RlY3RlZCBxdWFkVXY6IFF1YWRVdjtcbiAgICBwcm90ZWN0ZWQgYWN0aXZlU3RhdGU6IEZpbHRlclN0YXRlO1xuICAgIHByb3RlY3RlZCBnbG9iYWxVbmlmb3JtczogVW5pZm9ybUdyb3VwO1xuICAgIHByaXZhdGUgdGVtcFJlY3Q6IFJlY3RhbmdsZTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBTeXN0ZW0gd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogTGlzdCBvZiBmaWx0ZXJzIGZvciB0aGUgRmlsdGVyU3lzdGVtXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdFtdfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVmYXVsdEZpbHRlclN0YWNrID0gW3t9XSBhcyBhbnk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0b3JlcyBhIGJ1bmNoIG9mIFBPMiB0ZXh0dXJlcyB1c2VkIGZvciBmaWx0ZXJpbmdcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZXh0dXJlUG9vbCA9IG5ldyBSZW5kZXJUZXh0dXJlUG9vbCgpO1xuXG4gICAgICAgIHRoaXMudGV4dHVyZVBvb2wuc2V0U2NyZWVuU2l6ZShyZW5kZXJlci52aWV3KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYSBwb29sIGZvciBzdG9yaW5nIGZpbHRlciBzdGF0ZXMsIHNhdmUgdXMgY3JlYXRpbmcgbmV3IG9uZXMgZWFjaCB0aWNrXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdFtdfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGF0ZVBvb2wgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSB2ZXJ5IHNpbXBsZSBnZW9tZXRyeSB1c2VkIHdoZW4gZHJhd2luZyBhIGZpbHRlciBlZmZlY3QgdG8gdGhlIHNjcmVlblxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlF1YWR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1YWQgPSBuZXcgUXVhZCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBRdWFkIFVWc1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlF1YWRVdn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXVhZFV2ID0gbmV3IFF1YWRVdigpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUZW1wb3JhcnkgcmVjdCBmb3IgbWF0aHNcbiAgICAgICAgICogQHR5cGUge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZW1wUmVjdCA9IG5ldyBSZWN0YW5nbGUoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWN0aXZlIHN0YXRlXG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWN0aXZlU3RhdGUgPSB7fSBhcyBhbnk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgdW5pZm9ybSBncm91cCBpcyBhdHRhY2hlZCB0byBmaWx0ZXIgdW5pZm9ybXMgd2hlbiB1c2VkXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVW5pZm9ybUdyb3VwfVxuICAgICAgICAgKiBAcHJvcGVydHkge1BJWEkuUmVjdGFuZ2xlfSBvdXRwdXRGcmFtZVxuICAgICAgICAgKiBAcHJvcGVydHkge0Zsb2F0MzJBcnJheX0gaW5wdXRTaXplXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RmxvYXQzMkFycmF5fSBpbnB1dFBpeGVsXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RmxvYXQzMkFycmF5fSBpbnB1dENsYW1wXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSByZXNvbHV0aW9uXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RmxvYXQzMkFycmF5fSBmaWx0ZXJBcmVhXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RmxvYWQzMkFycmF5fSBmaWx0ZXJDbGFtcFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nbG9iYWxVbmlmb3JtcyA9IG5ldyBVbmlmb3JtR3JvdXAoe1xuICAgICAgICAgICAgb3V0cHV0RnJhbWU6IHRoaXMudGVtcFJlY3QsXG4gICAgICAgICAgICBpbnB1dFNpemU6IG5ldyBGbG9hdDMyQXJyYXkoNCksXG4gICAgICAgICAgICBpbnB1dFBpeGVsOiBuZXcgRmxvYXQzMkFycmF5KDQpLFxuICAgICAgICAgICAgaW5wdXRDbGFtcDogbmV3IEZsb2F0MzJBcnJheSg0KSxcbiAgICAgICAgICAgIHJlc29sdXRpb246IDEsXG5cbiAgICAgICAgICAgIC8vIGxlZ2FjeSB2YXJpYWJsZXNcbiAgICAgICAgICAgIGZpbHRlckFyZWE6IG5ldyBGbG9hdDMyQXJyYXkoNCksXG4gICAgICAgICAgICBmaWx0ZXJDbGFtcDogbmV3IEZsb2F0MzJBcnJheSg0KSxcbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdG8gY2xlYXIgb3V0cHV0IHJlbmRlclRleHR1cmUgaW4gQVVUTy9CTElUIG1vZGUuIFNlZSB7QGxpbmsgUElYSS5DTEVBUl9NT0RFU31cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9yY2VDbGVhciA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbGQgcGFkZGluZyBiZWhhdmlvciBpcyB0byB1c2UgdGhlIG1heCBhbW91bnQgaW5zdGVhZCBvZiBzdW0gcGFkZGluZy5cbiAgICAgICAgICogVXNlIHRoaXMgZmxhZyBpZiB5b3UgbmVlZCB0aGUgb2xkIGJlaGF2aW9yLlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51c2VNYXhQYWRkaW5nID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyBmaWx0ZXIgdG8gdGhlIFN5c3RlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSB0YXJnZXQgLSBUaGUgdGFyZ2V0IG9mIHRoZSBmaWx0ZXIgdG8gcmVuZGVyLlxuICAgICAqIEBwYXJhbSB7UElYSS5GaWx0ZXJbXX0gZmlsdGVycyAtIFRoZSBmaWx0ZXJzIHRvIGFwcGx5LlxuICAgICAqL1xuICAgIHB1c2godGFyZ2V0OiBJRmlsdGVyVGFyZ2V0LCBmaWx0ZXJzOiBBcnJheTxGaWx0ZXI+KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuICAgICAgICBjb25zdCBmaWx0ZXJTdGFjayA9IHRoaXMuZGVmYXVsdEZpbHRlclN0YWNrO1xuICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuc3RhdGVQb29sLnBvcCgpIHx8IG5ldyBGaWx0ZXJTdGF0ZSgpO1xuXG4gICAgICAgIGxldCByZXNvbHV0aW9uID0gZmlsdGVyc1swXS5yZXNvbHV0aW9uO1xuICAgICAgICBsZXQgcGFkZGluZyA9IGZpbHRlcnNbMF0ucGFkZGluZztcbiAgICAgICAgbGV0IGF1dG9GaXQgPSBmaWx0ZXJzWzBdLmF1dG9GaXQ7XG4gICAgICAgIGxldCBsZWdhY3kgPSBmaWx0ZXJzWzBdLmxlZ2FjeTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGZpbHRlcnMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9ICBmaWx0ZXJzW2ldO1xuXG4gICAgICAgICAgICAvLyBsZXRzIHVzZSB0aGUgbG93ZXN0IHJlc29sdXRpb24uLlxuICAgICAgICAgICAgcmVzb2x1dGlvbiA9IE1hdGgubWluKHJlc29sdXRpb24sIGZpbHRlci5yZXNvbHV0aW9uKTtcbiAgICAgICAgICAgIC8vIGZpZ3VyZSBvdXQgdGhlIHBhZGRpbmcgcmVxdWlyZWQgZm9yIGZpbHRlcnNcbiAgICAgICAgICAgIHBhZGRpbmcgPSB0aGlzLnVzZU1heFBhZGRpbmdcbiAgICAgICAgICAgICAgICAvLyBvbGQgYmVoYXZpb3I6IHVzZSBsYXJnZXN0IGFtb3VudCBvZiBwYWRkaW5nIVxuICAgICAgICAgICAgICAgID8gTWF0aC5tYXgocGFkZGluZywgZmlsdGVyLnBhZGRpbmcpXG4gICAgICAgICAgICAgICAgLy8gbmV3IGJlaGF2aW9yOiBzdW0gdGhlIHBhZGRpbmdcbiAgICAgICAgICAgICAgICA6IHBhZGRpbmcgKyBmaWx0ZXIucGFkZGluZztcbiAgICAgICAgICAgIC8vIG9ubHkgYXV0byBmaXQgaWYgYWxsIGZpbHRlcnMgYXJlIGF1dG9maXRcbiAgICAgICAgICAgIGF1dG9GaXQgPSBhdXRvRml0ICYmIGZpbHRlci5hdXRvRml0O1xuXG4gICAgICAgICAgICBsZWdhY3kgPSBsZWdhY3kgfHwgZmlsdGVyLmxlZ2FjeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmaWx0ZXJTdGFjay5sZW5ndGggPT09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdEZpbHRlclN0YWNrWzBdLnJlbmRlclRleHR1cmUgPSByZW5kZXJlci5yZW5kZXJUZXh0dXJlLmN1cnJlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBmaWx0ZXJTdGFjay5wdXNoKHN0YXRlKTtcblxuICAgICAgICBzdGF0ZS5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjtcblxuICAgICAgICBzdGF0ZS5sZWdhY3kgPSBsZWdhY3k7XG5cbiAgICAgICAgc3RhdGUudGFyZ2V0ID0gdGFyZ2V0O1xuXG4gICAgICAgIHN0YXRlLnNvdXJjZUZyYW1lLmNvcHlGcm9tKHRhcmdldC5maWx0ZXJBcmVhIHx8IHRhcmdldC5nZXRCb3VuZHModHJ1ZSkpO1xuXG4gICAgICAgIHN0YXRlLnNvdXJjZUZyYW1lLnBhZChwYWRkaW5nKTtcbiAgICAgICAgaWYgKGF1dG9GaXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN0YXRlLnNvdXJjZUZyYW1lLmZpdCh0aGlzLnJlbmRlcmVyLnJlbmRlclRleHR1cmUuc291cmNlRnJhbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcm91bmQgdG8gd2hvbGUgbnVtYmVyIGJhc2VkIG9uIHJlc29sdXRpb25cbiAgICAgICAgc3RhdGUuc291cmNlRnJhbWUuY2VpbChyZXNvbHV0aW9uKTtcblxuICAgICAgICBzdGF0ZS5yZW5kZXJUZXh0dXJlID0gdGhpcy5nZXRPcHRpbWFsRmlsdGVyVGV4dHVyZShzdGF0ZS5zb3VyY2VGcmFtZS53aWR0aCwgc3RhdGUuc291cmNlRnJhbWUuaGVpZ2h0LCByZXNvbHV0aW9uKTtcbiAgICAgICAgc3RhdGUuZmlsdGVycyA9IGZpbHRlcnM7XG5cbiAgICAgICAgc3RhdGUuZGVzdGluYXRpb25GcmFtZS53aWR0aCA9IHN0YXRlLnJlbmRlclRleHR1cmUud2lkdGg7XG4gICAgICAgIHN0YXRlLmRlc3RpbmF0aW9uRnJhbWUuaGVpZ2h0ID0gc3RhdGUucmVuZGVyVGV4dHVyZS5oZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgZGVzdGluYXRpb25GcmFtZSA9IHRoaXMudGVtcFJlY3Q7XG5cbiAgICAgICAgZGVzdGluYXRpb25GcmFtZS53aWR0aCA9IHN0YXRlLnNvdXJjZUZyYW1lLndpZHRoO1xuICAgICAgICBkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCA9IHN0YXRlLnNvdXJjZUZyYW1lLmhlaWdodDtcblxuICAgICAgICBzdGF0ZS5yZW5kZXJUZXh0dXJlLmZpbHRlckZyYW1lID0gc3RhdGUuc291cmNlRnJhbWU7XG5cbiAgICAgICAgcmVuZGVyZXIucmVuZGVyVGV4dHVyZS5iaW5kKHN0YXRlLnJlbmRlclRleHR1cmUsIHN0YXRlLnNvdXJjZUZyYW1lLCBkZXN0aW5hdGlvbkZyYW1lKTtcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyVGV4dHVyZS5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBvcHMgb2ZmIHRoZSBmaWx0ZXIgYW5kIGFwcGxpZXMgaXQuXG4gICAgICpcbiAgICAgKi9cbiAgICBwb3AoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZmlsdGVyU3RhY2sgPSB0aGlzLmRlZmF1bHRGaWx0ZXJTdGFjaztcbiAgICAgICAgY29uc3Qgc3RhdGUgPSBmaWx0ZXJTdGFjay5wb3AoKTtcbiAgICAgICAgY29uc3QgZmlsdGVycyA9IHN0YXRlLmZpbHRlcnM7XG5cbiAgICAgICAgdGhpcy5hY3RpdmVTdGF0ZSA9IHN0YXRlO1xuXG4gICAgICAgIGNvbnN0IGdsb2JhbFVuaWZvcm1zID0gdGhpcy5nbG9iYWxVbmlmb3Jtcy51bmlmb3JtcztcblxuICAgICAgICBnbG9iYWxVbmlmb3Jtcy5vdXRwdXRGcmFtZSA9IHN0YXRlLnNvdXJjZUZyYW1lO1xuICAgICAgICBnbG9iYWxVbmlmb3Jtcy5yZXNvbHV0aW9uID0gc3RhdGUucmVzb2x1dGlvbjtcblxuICAgICAgICBjb25zdCBpbnB1dFNpemUgPSBnbG9iYWxVbmlmb3Jtcy5pbnB1dFNpemU7XG4gICAgICAgIGNvbnN0IGlucHV0UGl4ZWwgPSBnbG9iYWxVbmlmb3Jtcy5pbnB1dFBpeGVsO1xuICAgICAgICBjb25zdCBpbnB1dENsYW1wID0gZ2xvYmFsVW5pZm9ybXMuaW5wdXRDbGFtcDtcblxuICAgICAgICBpbnB1dFNpemVbMF0gPSBzdGF0ZS5kZXN0aW5hdGlvbkZyYW1lLndpZHRoO1xuICAgICAgICBpbnB1dFNpemVbMV0gPSBzdGF0ZS5kZXN0aW5hdGlvbkZyYW1lLmhlaWdodDtcbiAgICAgICAgaW5wdXRTaXplWzJdID0gMS4wIC8gaW5wdXRTaXplWzBdO1xuICAgICAgICBpbnB1dFNpemVbM10gPSAxLjAgLyBpbnB1dFNpemVbMV07XG5cbiAgICAgICAgaW5wdXRQaXhlbFswXSA9IGlucHV0U2l6ZVswXSAqIHN0YXRlLnJlc29sdXRpb247XG4gICAgICAgIGlucHV0UGl4ZWxbMV0gPSBpbnB1dFNpemVbMV0gKiBzdGF0ZS5yZXNvbHV0aW9uO1xuICAgICAgICBpbnB1dFBpeGVsWzJdID0gMS4wIC8gaW5wdXRQaXhlbFswXTtcbiAgICAgICAgaW5wdXRQaXhlbFszXSA9IDEuMCAvIGlucHV0UGl4ZWxbMV07XG5cbiAgICAgICAgaW5wdXRDbGFtcFswXSA9IDAuNSAqIGlucHV0UGl4ZWxbMl07XG4gICAgICAgIGlucHV0Q2xhbXBbMV0gPSAwLjUgKiBpbnB1dFBpeGVsWzNdO1xuICAgICAgICBpbnB1dENsYW1wWzJdID0gKHN0YXRlLnNvdXJjZUZyYW1lLndpZHRoICogaW5wdXRTaXplWzJdKSAtICgwLjUgKiBpbnB1dFBpeGVsWzJdKTtcbiAgICAgICAgaW5wdXRDbGFtcFszXSA9IChzdGF0ZS5zb3VyY2VGcmFtZS5oZWlnaHQgKiBpbnB1dFNpemVbM10pIC0gKDAuNSAqIGlucHV0UGl4ZWxbM10pO1xuXG4gICAgICAgIC8vIG9ubHkgdXBkYXRlIHRoZSByZWN0IGlmIGl0cyBsZWdhY3kuLlxuICAgICAgICBpZiAoc3RhdGUubGVnYWN5KVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJBcmVhID0gZ2xvYmFsVW5pZm9ybXMuZmlsdGVyQXJlYTtcblxuICAgICAgICAgICAgZmlsdGVyQXJlYVswXSA9IHN0YXRlLmRlc3RpbmF0aW9uRnJhbWUud2lkdGg7XG4gICAgICAgICAgICBmaWx0ZXJBcmVhWzFdID0gc3RhdGUuZGVzdGluYXRpb25GcmFtZS5oZWlnaHQ7XG4gICAgICAgICAgICBmaWx0ZXJBcmVhWzJdID0gc3RhdGUuc291cmNlRnJhbWUueDtcbiAgICAgICAgICAgIGZpbHRlckFyZWFbM10gPSBzdGF0ZS5zb3VyY2VGcmFtZS55O1xuXG4gICAgICAgICAgICBnbG9iYWxVbmlmb3Jtcy5maWx0ZXJDbGFtcCA9IGdsb2JhbFVuaWZvcm1zLmlucHV0Q2xhbXA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmdsb2JhbFVuaWZvcm1zLnVwZGF0ZSgpO1xuXG4gICAgICAgIGNvbnN0IGxhc3RTdGF0ZSA9IGZpbHRlclN0YWNrW2ZpbHRlclN0YWNrLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChzdGF0ZS5yZW5kZXJUZXh0dXJlLmZyYW1lYnVmZmVyLm11bHRpc2FtcGxlID4gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5mcmFtZWJ1ZmZlci5ibGl0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmlsdGVycy5sZW5ndGggPT09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZpbHRlcnNbMF0uYXBwbHkodGhpcywgc3RhdGUucmVuZGVyVGV4dHVyZSwgbGFzdFN0YXRlLnJlbmRlclRleHR1cmUsIENMRUFSX01PREVTLkJMRU5ELCBzdGF0ZSk7XG5cbiAgICAgICAgICAgIHRoaXMucmV0dXJuRmlsdGVyVGV4dHVyZShzdGF0ZS5yZW5kZXJUZXh0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBmbGlwID0gc3RhdGUucmVuZGVyVGV4dHVyZTtcbiAgICAgICAgICAgIGxldCBmbG9wID0gdGhpcy5nZXRPcHRpbWFsRmlsdGVyVGV4dHVyZShcbiAgICAgICAgICAgICAgICBmbGlwLndpZHRoLFxuICAgICAgICAgICAgICAgIGZsaXAuaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHN0YXRlLnJlc29sdXRpb25cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGZsb3AuZmlsdGVyRnJhbWUgPSBmbGlwLmZpbHRlckZyYW1lO1xuXG4gICAgICAgICAgICBsZXQgaSA9IDA7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aCAtIDE7ICsraSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJzW2ldLmFwcGx5KHRoaXMsIGZsaXAsIGZsb3AsIENMRUFSX01PREVTLkNMRUFSLCBzdGF0ZSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZmxpcDtcblxuICAgICAgICAgICAgICAgIGZsaXAgPSBmbG9wO1xuICAgICAgICAgICAgICAgIGZsb3AgPSB0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWx0ZXJzW2ldLmFwcGx5KHRoaXMsIGZsaXAsIGxhc3RTdGF0ZS5yZW5kZXJUZXh0dXJlLCBDTEVBUl9NT0RFUy5CTEVORCwgc3RhdGUpO1xuXG4gICAgICAgICAgICB0aGlzLnJldHVybkZpbHRlclRleHR1cmUoZmxpcCk7XG4gICAgICAgICAgICB0aGlzLnJldHVybkZpbHRlclRleHR1cmUoZmxvcCk7XG4gICAgICAgIH1cblxuICAgICAgICBzdGF0ZS5jbGVhcigpO1xuICAgICAgICB0aGlzLnN0YXRlUG9vbC5wdXNoKHN0YXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCaW5kcyBhIHJlbmRlclRleHR1cmUgd2l0aCBjb3JyZXNwb25kaW5nIGBmaWx0ZXJGcmFtZWAsIGNsZWFycyBpdCBpZiBtb2RlIGNvcnJlc3BvbmRzLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBmaWx0ZXJUZXh0dXJlIC0gcmVuZGVyVGV4dHVyZSB0byBiaW5kLCBzaG91bGQgYmVsb25nIHRvIGZpbHRlciBwb29sIG9yIGZpbHRlciBzdGFja1xuICAgICAqIEBwYXJhbSB7UElYSS5DTEVBUl9NT0RFU30gW2NsZWFyTW9kZV0gLSBjbGVhck1vZGUsIGJ5IGRlZmF1bHQgaXRzIENMRUFSL1lFUy4gU2VlIHtAbGluayBQSVhJLkNMRUFSX01PREVTfVxuICAgICAqL1xuICAgIGJpbmRBbmRDbGVhcihmaWx0ZXJUZXh0dXJlOiBSZW5kZXJUZXh0dXJlLCBjbGVhck1vZGUgPSBDTEVBUl9NT0RFUy5DTEVBUik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChmaWx0ZXJUZXh0dXJlICYmIGZpbHRlclRleHR1cmUuZmlsdGVyRnJhbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uRnJhbWUgPSB0aGlzLnRlbXBSZWN0O1xuXG4gICAgICAgICAgICBkZXN0aW5hdGlvbkZyYW1lLndpZHRoID0gZmlsdGVyVGV4dHVyZS5maWx0ZXJGcmFtZS53aWR0aDtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uRnJhbWUuaGVpZ2h0ID0gZmlsdGVyVGV4dHVyZS5maWx0ZXJGcmFtZS5oZWlnaHQ7XG5cbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyVGV4dHVyZS5iaW5kKGZpbHRlclRleHR1cmUsIGZpbHRlclRleHR1cmUuZmlsdGVyRnJhbWUsIGRlc3RpbmF0aW9uRnJhbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXJUZXh0dXJlLmJpbmQoZmlsdGVyVGV4dHVyZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPOiByZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uXG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJNb2RlID09PSAnYm9vbGVhbicpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNsZWFyTW9kZSA9IGNsZWFyTW9kZSA/IENMRUFSX01PREVTLkNMRUFSIDogQ0xFQVJfTU9ERVMuQkxFTkQ7XG4gICAgICAgICAgICAvLyBnZXQgZGVwcmVjYXRpb24gZnVuY3Rpb24gZnJvbSB1dGlsc1xuICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4xJywgJ1VzZSBDTEVBUl9NT0RFUyB3aGVuIHVzaW5nIGNsZWFyIGFwcGx5RmlsdGVyIG9wdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjbGVhck1vZGUgPT09IENMRUFSX01PREVTLkNMRUFSXG4gICAgICAgICAgICB8fCAoY2xlYXJNb2RlID09PSBDTEVBUl9NT0RFUy5CTElUICYmIHRoaXMuZm9yY2VDbGVhcikpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyVGV4dHVyZS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhd3MgYSBmaWx0ZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRmlsdGVyfSBmaWx0ZXIgLSBUaGUgZmlsdGVyIHRvIGRyYXcuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlclRleHR1cmV9IGlucHV0IC0gVGhlIGlucHV0IHJlbmRlciB0YXJnZXQuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlclRleHR1cmV9IG91dHB1dCAtIFRoZSB0YXJnZXQgdG8gb3V0cHV0IHRvLlxuICAgICAqIEBwYXJhbSB7UElYSS5DTEVBUl9NT0RFU30gW2NsZWFyTW9kZV0gLSBTaG91bGQgdGhlIG91dHB1dCBiZSBjbGVhcmVkIGJlZm9yZSByZW5kZXJpbmcgdG8gaXRcbiAgICAgKi9cbiAgICBhcHBseUZpbHRlcihmaWx0ZXI6IEZpbHRlciwgaW5wdXQ6IFJlbmRlclRleHR1cmUsIG91dHB1dDogUmVuZGVyVGV4dHVyZSwgY2xlYXJNb2RlOiBDTEVBUl9NT0RFUyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlcjtcblxuICAgICAgICB0aGlzLmJpbmRBbmRDbGVhcihvdXRwdXQsIGNsZWFyTW9kZSk7XG5cbiAgICAgICAgLy8gc2V0IHRoZSB1bmlmb3Jtcy4uXG4gICAgICAgIGZpbHRlci51bmlmb3Jtcy51U2FtcGxlciA9IGlucHV0O1xuICAgICAgICBmaWx0ZXIudW5pZm9ybXMuZmlsdGVyR2xvYmFscyA9IHRoaXMuZ2xvYmFsVW5pZm9ybXM7XG5cbiAgICAgICAgLy8gVE9ETyBtYWtlIGl0IHNvIHRoYXQgdGhlIG9yZGVyIG9mIHRoaXMgZG9lcyBub3QgbWF0dGVyLi5cbiAgICAgICAgLy8gYmVjYXVzZSBpdCBkb2VzIGF0IHRoZSBtb21lbnQgY29zIG9mIGdsb2JhbCB1bmlmb3Jtcy5cbiAgICAgICAgLy8gdGhleSBuZWVkIHRvIGdldCByZXN5bmNlZFxuXG4gICAgICAgIHJlbmRlcmVyLnN0YXRlLnNldChmaWx0ZXIuc3RhdGUpO1xuICAgICAgICByZW5kZXJlci5zaGFkZXIuYmluZChmaWx0ZXIpO1xuXG4gICAgICAgIGlmIChmaWx0ZXIubGVnYWN5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnF1YWRVdi5tYXAoaW5wdXQuX2ZyYW1lLCBpbnB1dC5maWx0ZXJGcmFtZSk7XG5cbiAgICAgICAgICAgIHJlbmRlcmVyLmdlb21ldHJ5LmJpbmQodGhpcy5xdWFkVXYpO1xuICAgICAgICAgICAgcmVuZGVyZXIuZ2VvbWV0cnkuZHJhdyhEUkFXX01PREVTLlRSSUFOR0xFUyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5iaW5kKHRoaXMucXVhZCk7XG4gICAgICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5kcmF3KERSQVdfTU9ERVMuVFJJQU5HTEVfU1RSSVApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTXVsdGlwbHkgX2lucHV0IG5vcm1hbGl6ZWQgY29vcmRpbmF0ZXNfIHRvIHRoaXMgbWF0cml4IHRvIGdldCBfc3ByaXRlIHRleHR1cmUgbm9ybWFsaXplZCBjb29yZGluYXRlc18uXG4gICAgICpcbiAgICAgKiBVc2UgYG91dHB1dE1hdHJpeCAqIHZUZXh0dXJlQ29vcmRgIGluIHRoZSBzaGFkZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBvdXRwdXRNYXRyaXggLSBUaGUgbWF0cml4IHRvIG91dHB1dCB0by5cbiAgICAgKiBAcGFyYW0ge1BJWEkuU3ByaXRlfSBzcHJpdGUgLSBUaGUgc3ByaXRlIHRvIG1hcCB0by5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLk1hdHJpeH0gVGhlIG1hcHBlZCBtYXRyaXguXG4gICAgICovXG4gICAgY2FsY3VsYXRlU3ByaXRlTWF0cml4KG91dHB1dE1hdHJpeDogTWF0cml4LCBzcHJpdGU6IElTcHJpdGVNYXNrVGFyZ2V0KTogTWF0cml4XG4gICAge1xuICAgICAgICBjb25zdCB7IHNvdXJjZUZyYW1lLCBkZXN0aW5hdGlvbkZyYW1lIH0gPSB0aGlzLmFjdGl2ZVN0YXRlO1xuICAgICAgICBjb25zdCB7IG9yaWcgfSA9IHNwcml0ZS5fdGV4dHVyZTtcbiAgICAgICAgY29uc3QgbWFwcGVkTWF0cml4ID0gb3V0cHV0TWF0cml4LnNldChkZXN0aW5hdGlvbkZyYW1lLndpZHRoLCAwLCAwLFxuICAgICAgICAgICAgZGVzdGluYXRpb25GcmFtZS5oZWlnaHQsIHNvdXJjZUZyYW1lLngsIHNvdXJjZUZyYW1lLnkpO1xuICAgICAgICBjb25zdCB3b3JsZFRyYW5zZm9ybSA9IHNwcml0ZS53b3JsZFRyYW5zZm9ybS5jb3B5VG8oTWF0cml4LlRFTVBfTUFUUklYKTtcblxuICAgICAgICB3b3JsZFRyYW5zZm9ybS5pbnZlcnQoKTtcbiAgICAgICAgbWFwcGVkTWF0cml4LnByZXBlbmQod29ybGRUcmFuc2Zvcm0pO1xuICAgICAgICBtYXBwZWRNYXRyaXguc2NhbGUoMS4wIC8gb3JpZy53aWR0aCwgMS4wIC8gb3JpZy5oZWlnaHQpO1xuICAgICAgICBtYXBwZWRNYXRyaXgudHJhbnNsYXRlKHNwcml0ZS5hbmNob3IueCwgc3ByaXRlLmFuY2hvci55KTtcblxuICAgICAgICByZXR1cm4gbWFwcGVkTWF0cml4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoaXMgRmlsdGVyIFN5c3RlbS5cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIFRob3NlIHRleHR1cmVzIGhhcyB0byBiZSBkZXN0cm95ZWQgYnkgUmVuZGVyVGV4dHVyZVN5c3RlbSBvciBGcmFtZWJ1ZmZlclN5c3RlbVxuICAgICAgICB0aGlzLnRleHR1cmVQb29sLmNsZWFyKGZhbHNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgUG93ZXItb2YtVHdvIHJlbmRlciB0ZXh0dXJlIG9yIGZ1bGxTY3JlZW4gdGV4dHVyZVxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW5XaWR0aCAtIFRoZSBtaW5pbXVtIHdpZHRoIG9mIHRoZSByZW5kZXIgdGV4dHVyZSBpbiByZWFsIHBpeGVscy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWluSGVpZ2h0IC0gVGhlIG1pbmltdW0gaGVpZ2h0IG9mIHRoZSByZW5kZXIgdGV4dHVyZSBpbiByZWFsIHBpeGVscy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb249MV0gLSBUaGUgcmVzb2x1dGlvbiBvZiB0aGUgcmVuZGVyIHRleHR1cmUuXG4gICAgICogQHJldHVybiB7UElYSS5SZW5kZXJUZXh0dXJlfSBUaGUgbmV3IHJlbmRlciB0ZXh0dXJlLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBnZXRPcHRpbWFsRmlsdGVyVGV4dHVyZShtaW5XaWR0aDogbnVtYmVyLCBtaW5IZWlnaHQ6IG51bWJlciwgcmVzb2x1dGlvbiA9IDEpOiBSZW5kZXJUZXh0dXJlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0dXJlUG9vbC5nZXRPcHRpbWFsVGV4dHVyZShtaW5XaWR0aCwgbWluSGVpZ2h0LCByZXNvbHV0aW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGV4dHJhIHJlbmRlciB0ZXh0dXJlIHRvIHVzZSBpbnNpZGUgY3VycmVudCBmaWx0ZXJcbiAgICAgKiBUbyBiZSBjb21wbGlhbnQgd2l0aCBvbGRlciBmaWx0ZXJzLCB5b3UgY2FuIHVzZSBwYXJhbXMgaW4gYW55IG9yZGVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gW2lucHV0XSAtIHJlbmRlclRleHR1cmUgZnJvbSB3aGljaCBzaXplIGFuZCByZXNvbHV0aW9uIHdpbGwgYmUgY29waWVkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtyZXNvbHV0aW9uXSAtIG92ZXJyaWRlIHJlc29sdXRpb24gb2YgdGhlIHJlbmRlclRleHR1cmVcbiAgICAgKiBAcmV0dXJucyB7UElYSS5SZW5kZXJUZXh0dXJlfVxuICAgICAqL1xuICAgIGdldEZpbHRlclRleHR1cmUoaW5wdXQ/OiBSZW5kZXJUZXh0dXJlLCByZXNvbHV0aW9uPzogbnVtYmVyKTogUmVuZGVyVGV4dHVyZVxuICAgIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHN3YXAgPSBpbnB1dDtcblxuICAgICAgICAgICAgaW5wdXQgPSByZXNvbHV0aW9uIGFzIGFueTtcbiAgICAgICAgICAgIHJlc29sdXRpb24gPSBzd2FwO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5wdXQgPSBpbnB1dCB8fCB0aGlzLmFjdGl2ZVN0YXRlLnJlbmRlclRleHR1cmU7XG5cbiAgICAgICAgY29uc3QgZmlsdGVyVGV4dHVyZSA9IHRoaXMudGV4dHVyZVBvb2wuZ2V0T3B0aW1hbFRleHR1cmUoaW5wdXQud2lkdGgsIGlucHV0LmhlaWdodCwgcmVzb2x1dGlvbiB8fCBpbnB1dC5yZXNvbHV0aW9uKTtcblxuICAgICAgICBmaWx0ZXJUZXh0dXJlLmZpbHRlckZyYW1lID0gaW5wdXQuZmlsdGVyRnJhbWU7XG5cbiAgICAgICAgcmV0dXJuIGZpbHRlclRleHR1cmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnJlZXMgYSByZW5kZXIgdGV4dHVyZSBiYWNrIGludG8gdGhlIHBvb2wuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gcmVuZGVyVGV4dHVyZSAtIFRoZSByZW5kZXJUYXJnZXQgdG8gZnJlZVxuICAgICAqL1xuICAgIHJldHVybkZpbHRlclRleHR1cmUocmVuZGVyVGV4dHVyZTogUmVuZGVyVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudGV4dHVyZVBvb2wucmV0dXJuVGV4dHVyZShyZW5kZXJUZXh0dXJlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbXB0aWVzIHRoZSB0ZXh0dXJlIHBvb2wuXG4gICAgICovXG4gICAgZW1wdHlQb29sKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudGV4dHVyZVBvb2wuY2xlYXIodHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2FsbHMgYHRleHR1cmVQb29sLnJlc2l6ZSgpYCwgYWZmZWN0cyBmdWxsU2NyZWVuIHJlbmRlclRleHR1cmVzXG4gICAgICovXG4gICAgcmVzaXplKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudGV4dHVyZVBvb2wuc2V0U2NyZWVuU2l6ZSh0aGlzLnJlbmRlcmVyLnZpZXcpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuXG4vKipcbiAqIEJhc2UgZm9yIGEgY29tbW9uIG9iamVjdCByZW5kZXJlciB0aGF0IGNhbiBiZSB1c2VkIGFzIGFcbiAqIHN5c3RlbSByZW5kZXJlciBwbHVnaW4uXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLlN5c3RlbVxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIE9iamVjdFJlbmRlcmVyXG57XG4gICAgcHJvdGVjdGVkIHJlbmRlcmVyOiBSZW5kZXJlcjtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgbWFuYWdlciB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByZW5kZXJlciB0aGlzIG1hbmFnZXIgd29ya3MgZm9yLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlJlbmRlcmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0dWIgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZW1wdHkgdGhlIGN1cnJlbnRcbiAgICAgKiBiYXRjaCBieSByZW5kZXJpbmcgb2JqZWN0cyBub3cuXG4gICAgICovXG4gICAgZmx1c2goKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gZmx1c2ghXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJpYyBkZXN0cnVjdGlvbiBtZXRob2QgdGhhdCBmcmVlcyBhbGwgcmVzb3VyY2VzLiBUaGlzXG4gICAgICogc2hvdWxkIGJlIGNhbGxlZCBieSBzdWJjbGFzc2VzLlxuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3R1YiBtZXRob2QgdGhhdCBpbml0aWFsaXplcyBhbnkgc3RhdGUgcmVxdWlyZWQgYmVmb3JlXG4gICAgICogcmVuZGVyaW5nIHN0YXJ0cy4gSXQgaXMgZGlmZmVyZW50IGZyb20gdGhlIGBwcmVyZW5kZXJgXG4gICAgICogc2lnbmFsLCB3aGljaCBvY2N1cnMgZXZlcnkgZnJhbWUsIGluIHRoYXQgaXQgaXMgY2FsbGVkXG4gICAgICogd2hlbmV2ZXIgYW4gb2JqZWN0IHJlcXVlc3RzIF90aGlzXyByZW5kZXJlciBzcGVjaWZpY2FsbHkuXG4gICAgICovXG4gICAgc3RhcnQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gc2V0IHRoZSBzaGFkZXIuLlxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3BzIHRoZSByZW5kZXJlci4gSXQgc2hvdWxkIGZyZWUgdXAgYW55IHN0YXRlIGFuZFxuICAgICAqIGJlY29tZSBkb3JtYW50LlxuICAgICAqL1xuICAgIHN0b3AoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEtlZXBzIHRoZSBvYmplY3QgdG8gcmVuZGVyLiBJdCBkb2Vzbid0IGhhdmUgdG8gYmVcbiAgICAgKiByZW5kZXJlZCBpbW1lZGlhdGVseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBvYmplY3QgLSBUaGUgb2JqZWN0IHRvIHJlbmRlci5cbiAgICAgKi9cbiAgICByZW5kZXIoX29iamVjdDogYW55KTogdm9pZCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbiAgICB7XG4gICAgICAgIC8vIHJlbmRlciB0aGUgb2JqZWN0XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBPYmplY3RSZW5kZXJlciB9IGZyb20gJy4vT2JqZWN0UmVuZGVyZXInO1xuXG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBCYXNlVGV4dHVyZSB9IGZyb20gJy4uL3RleHR1cmVzL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgQmF0Y2hUZXh0dXJlQXJyYXkgfSBmcm9tICcuL0JhdGNoVGV4dHVyZUFycmF5Jztcbi8qKlxuICogU3lzdGVtIHBsdWdpbiB0byB0aGUgcmVuZGVyZXIgdG8gbWFuYWdlIGJhdGNoaW5nLlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqIEBtZW1iZXJvZiBQSVhJLnN5c3RlbXNcbiAqL1xuZXhwb3J0IGNsYXNzIEJhdGNoU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHVibGljIHJlYWRvbmx5IGVtcHR5UmVuZGVyZXI6IE9iamVjdFJlbmRlcmVyO1xuICAgIHB1YmxpYyBjdXJyZW50UmVuZGVyZXI6IE9iamVjdFJlbmRlcmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBlbXB0eSByZW5kZXJlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5PYmplY3RSZW5kZXJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZW1wdHlSZW5kZXJlciA9IG5ldyBPYmplY3RSZW5kZXJlcihyZW5kZXJlcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjdXJyZW50bHkgYWN0aXZlIE9iamVjdFJlbmRlcmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk9iamVjdFJlbmRlcmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jdXJyZW50UmVuZGVyZXIgPSB0aGlzLmVtcHR5UmVuZGVyZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgY3VycmVudCByZW5kZXJlciB0byB0aGUgb25lIGdpdmVuIGluIHBhcmFtZXRlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLk9iamVjdFJlbmRlcmVyfSBvYmplY3RSZW5kZXJlciAtIFRoZSBvYmplY3QgcmVuZGVyZXIgdG8gdXNlLlxuICAgICAqL1xuICAgIHNldE9iamVjdFJlbmRlcmVyKG9iamVjdFJlbmRlcmVyOiBPYmplY3RSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRSZW5kZXJlciA9PT0gb2JqZWN0UmVuZGVyZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3VycmVudFJlbmRlcmVyLnN0b3AoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50UmVuZGVyZXIgPSBvYmplY3RSZW5kZXJlcjtcblxuICAgICAgICB0aGlzLmN1cnJlbnRSZW5kZXJlci5zdGFydCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBpZiB5b3Ugd2lzaCB0byBkbyBzb21lIGN1c3RvbSByZW5kZXJpbmdcbiAgICAgKiBJdCB3aWxsIGJhc2ljYWxseSByZW5kZXIgYW55dGhpbmcgdGhhdCBtYXkgYmUgYmF0Y2hlZCB1cCBzdWNoIGFzIHNwcml0ZXNcbiAgICAgKi9cbiAgICBmbHVzaCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnNldE9iamVjdFJlbmRlcmVyKHRoaXMuZW1wdHlSZW5kZXJlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXQgdGhlIHN5c3RlbSB0byBhbiBlbXB0eSByZW5kZXJlclxuICAgICAqL1xuICAgIHJlc2V0KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuc2V0T2JqZWN0UmVuZGVyZXIodGhpcy5lbXB0eVJlbmRlcmVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5keSBmdW5jdGlvbiBmb3IgYmF0Y2ggcmVuZGVyZXJzOiBjb3BpZXMgYm91bmQgdGV4dHVyZXMgaW4gZmlyc3QgbWF4VGV4dHVyZXMgbG9jYXRpb25zIHRvIGFycmF5XG4gICAgICogc2V0cyBhY3R1YWwgX2JhdGNoTG9jYXRpb24gZm9yIHRoZW1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZVtdfSAtIGFyciBjb3B5IGRlc3RpbmF0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1heFRleHR1cmVzIC0gbnVtYmVyIG9mIGNvcGllZCBlbGVtZW50c1xuICAgICAqL1xuICAgIGNvcHlCb3VuZFRleHR1cmVzKGFycjogQmFzZVRleHR1cmVbXSwgbWF4VGV4dHVyZXM6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgYm91bmRUZXh0dXJlcyB9ID0gdGhpcy5yZW5kZXJlci50ZXh0dXJlO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSBtYXhUZXh0dXJlcyAtIDE7IGkgPj0gMDsgLS1pKVxuICAgICAgICB7XG4gICAgICAgICAgICBhcnJbaV0gPSBib3VuZFRleHR1cmVzW2ldIHx8IG51bGw7XG4gICAgICAgICAgICBpZiAoYXJyW2ldKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFycltpXS5fYmF0Y2hMb2NhdGlvbiA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBc3NpZ25zIGJhdGNoIGxvY2F0aW9ucyB0byB0ZXh0dXJlcyBpbiBhcnJheSBiYXNlZCBvbiBib3VuZFRleHR1cmVzIHN0YXRlLlxuICAgICAqIEFsbCB0ZXh0dXJlcyBpbiB0ZXhBcnJheSBzaG91bGQgaGF2ZSBgX2JhdGNoRW5hYmxlZCA9IF9iYXRjaElkYCxcbiAgICAgKiBhbmQgdGhlaXIgY291bnQgc2hvdWxkIGJlIGxlc3MgdGhhbiBgbWF4VGV4dHVyZXNgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJhdGNoVGV4dHVyZUFycmF5fSB0ZXhBcnJheSAtIHRleHR1cmVzIHRvIGJvdW5kXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlW119IGJvdW5kVGV4dHVyZXMgLSBjdXJyZW50IHN0YXRlIG9mIGJvdW5kIHRleHR1cmVzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJhdGNoSWQgLSBtYXJrZXIgZm9yIF9iYXRjaEVuYWJsZWQgcGFyYW0gb2YgdGV4dHVyZXMgaW4gdGV4QXJyYXlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWF4VGV4dHVyZXMgLSBudW1iZXIgb2YgdGV4dHVyZSBsb2NhdGlvbnMgdG8gbWFuaXB1bGF0ZVxuICAgICAqL1xuICAgIGJvdW5kQXJyYXkodGV4QXJyYXk6IEJhdGNoVGV4dHVyZUFycmF5LCBib3VuZFRleHR1cmVzOiBBcnJheTxCYXNlVGV4dHVyZT4sXG4gICAgICAgIGJhdGNoSWQ6IG51bWJlciwgbWF4VGV4dHVyZXM6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudHMsIGlkcywgY291bnQgfSA9IHRleEFycmF5O1xuICAgICAgICBsZXQgaiA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ZXggPSBlbGVtZW50c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGxvYyA9IHRleC5fYmF0Y2hMb2NhdGlvbjtcblxuICAgICAgICAgICAgaWYgKGxvYyA+PSAwICYmIGxvYyA8IG1heFRleHR1cmVzXG4gICAgICAgICAgICAgICAgJiYgYm91bmRUZXh0dXJlc1tsb2NdID09PSB0ZXgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWRzW2ldID0gbG9jO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAoaiA8IG1heFRleHR1cmVzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kID0gYm91bmRUZXh0dXJlc1tqXTtcblxuICAgICAgICAgICAgICAgIGlmIChib3VuZCAmJiBib3VuZC5fYmF0Y2hFbmFibGVkID09PSBiYXRjaElkXG4gICAgICAgICAgICAgICAgICAgICYmIGJvdW5kLl9iYXRjaExvY2F0aW9uID09PSBqKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZHNbaV0gPSBqO1xuICAgICAgICAgICAgICAgIHRleC5fYmF0Y2hMb2NhdGlvbiA9IGo7XG4gICAgICAgICAgICAgICAgYm91bmRUZXh0dXJlc1tqXSA9IHRleDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBFTlYgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgU3lzdGVtIH0gZnJvbSAnLi4vU3lzdGVtJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG5pbXBvcnQgdHlwZSB7IElSZW5kZXJpbmdDb250ZXh0IH0gZnJvbSAnLi4vSVJlbmRlcmluZ0NvbnRleHQnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcblxubGV0IENPTlRFWFRfVUlEX0NPVU5URVIgPSAwO1xuXG5leHBvcnQgaW50ZXJmYWNlIElTdXBwb3J0RGljdCB7XG4gICAgdWludDMySW5kaWNlczogYm9vbGVhbjtcbn1cbi8qKlxuICogU3lzdGVtIHBsdWdpbiB0byB0aGUgcmVuZGVyZXIgdG8gbWFuYWdlIHRoZSBjb250ZXh0LlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqIEBtZW1iZXJvZiBQSVhJLnN5c3RlbXNcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnRleHRTeXN0ZW0gZXh0ZW5kcyBTeXN0ZW1cbntcbiAgICBwdWJsaWMgd2ViR0xWZXJzaW9uOiBudW1iZXI7XG4gICAgcmVhZG9ubHkgc3VwcG9ydHM6IElTdXBwb3J0RGljdDtcblxuICAgIHByb3RlY3RlZCBDT05URVhUX1VJRDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBnbDogSVJlbmRlcmluZ0NvbnRleHQ7XG4gICAgLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXG4gICAgZXh0ZW5zaW9uczpcbiAgICB7XG4gICAgICAgIGRyYXdCdWZmZXJzPzogV0VCR0xfZHJhd19idWZmZXJzO1xuICAgICAgICBkZXB0aFRleHR1cmU/OiBPRVNfdGV4dHVyZV9mbG9hdDtcbiAgICAgICAgbG9zZUNvbnRleHQ/OiBXRUJHTF9sb3NlX2NvbnRleHQ7XG4gICAgICAgIHZlcnRleEFycmF5T2JqZWN0PzogT0VTX3ZlcnRleF9hcnJheV9vYmplY3Q7XG4gICAgICAgIGFuaXNvdHJvcGljRmlsdGVyaW5nPzogRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljO1xuICAgICAgICB1aW50MzJFbGVtZW50SW5kZXg/OiBPRVNfZWxlbWVudF9pbmRleF91aW50O1xuICAgICAgICBmbG9hdFRleHR1cmU/OiBPRVNfdGV4dHVyZV9mbG9hdDtcbiAgICAgICAgZmxvYXRUZXh0dXJlTGluZWFyPzogT0VTX3RleHR1cmVfZmxvYXRfbGluZWFyO1xuICAgICAgICB0ZXh0dXJlSGFsZkZsb2F0PzogT0VTX3RleHR1cmVfaGFsZl9mbG9hdDtcbiAgICAgICAgdGV4dHVyZUhhbGZGbG9hdExpbmVhcj86IE9FU190ZXh0dXJlX2hhbGZfZmxvYXRfbGluZWFyO1xuICAgICAgICBjb2xvckJ1ZmZlckZsb2F0PzogV0VCR0xfY29sb3JfYnVmZmVyX2Zsb2F0O1xuICAgIH07XG4gICAgLyogZXNsaW50LWVuYWJsZSBjYW1lbGNhc2UgKi9cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBTeXN0ZW0gd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRWl0aGVyIDEgb3IgMiB0byByZWZsZWN0IHRoZSBXZWJHTCB2ZXJzaW9uIGJlaW5nIHVzZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud2ViR0xWZXJzaW9uID0gMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRXh0ZW5zaW9ucyBiZWluZyB1c2VkXG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBwcm9wZXJ0eSB7V0VCR0xfZHJhd19idWZmZXJzfSBkcmF3QnVmZmVycyAtIFdlYkdMIHYxIGV4dGVuc2lvblxuICAgICAgICAgKiBAcHJvcGVydHkge1dFQkdMX2RlcHRoX3RleHR1cmV9IGRlcHRoVGV4dHVyZSAtIFdlYkdMIHYxIGV4dGVuc2lvblxuICAgICAgICAgKiBAcHJvcGVydHkge09FU190ZXh0dXJlX2Zsb2F0fSBmbG9hdFRleHR1cmUgLSBXZWJHTCB2MSBleHRlbnNpb25cbiAgICAgICAgICogQHByb3BlcnR5IHtXRUJHTF9sb3NlX2NvbnRleHR9IGxvc2VDb250ZXh0IC0gV2ViR0wgdjEgZXh0ZW5zaW9uXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7T0VTX3ZlcnRleF9hcnJheV9vYmplY3R9IHZlcnRleEFycmF5T2JqZWN0IC0gV2ViR0wgdjEgZXh0ZW5zaW9uXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7RVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljfSBhbmlzb3Ryb3BpY0ZpbHRlcmluZyAtIFdlYkdMIHYxIGFuZCB2MiBleHRlbnNpb25cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGZWF0dXJlcyBzdXBwb3J0ZWQgYnkgY3VycmVudCBjb250ZXh0XG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdWludDMySW5kaWNlcyAtIFN1cHBvcnRzIG9mIDMyLWJpdCBpbmRpY2VzIGJ1ZmZlclxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdXBwb3J0cyA9IHtcbiAgICAgICAgICAgIHVpbnQzMkluZGljZXM6IGZhbHNlLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEJpbmQgZnVuY3Rpb25zXG4gICAgICAgIHRoaXMuaGFuZGxlQ29udGV4dExvc3QgPSB0aGlzLmhhbmRsZUNvbnRleHRMb3N0LmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGFuZGxlQ29udGV4dFJlc3RvcmVkID0gdGhpcy5oYW5kbGVDb250ZXh0UmVzdG9yZWQuYmluZCh0aGlzKTtcblxuICAgICAgICAocmVuZGVyZXIudmlldyBhcyBhbnkpLmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmdsY29udGV4dGxvc3QnLCB0aGlzLmhhbmRsZUNvbnRleHRMb3N0LCBmYWxzZSk7XG4gICAgICAgIHJlbmRlcmVyLnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignd2ViZ2xjb250ZXh0cmVzdG9yZWQnLCB0aGlzLmhhbmRsZUNvbnRleHRSZXN0b3JlZCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGB0cnVlYCBpZiB0aGUgY29udGV4dCBpcyBsb3N0XG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgaXNMb3N0KCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAoIXRoaXMuZ2wgfHwgdGhpcy5nbC5pc0NvbnRleHRMb3N0KCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgY29udGV4dCBjaGFuZ2UgZXZlbnRcbiAgICAgKiBAcGFyYW0ge1dlYkdMUmVuZGVyaW5nQ29udGV4dH0gZ2wgLSBuZXcgd2ViZ2wgY29udGV4dFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBjb250ZXh0Q2hhbmdlKGdsOiBJUmVuZGVyaW5nQ29udGV4dCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5nbCA9IGdsO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLkNPTlRFWFRfVUlEID0gQ09OVEVYVF9VSURfQ09VTlRFUisrO1xuXG4gICAgICAgIC8vIHJlc3RvcmUgYSBjb250ZXh0IGlmIGl0IHdhcyBwcmV2aW91c2x5IGxvc3RcbiAgICAgICAgaWYgKGdsLmlzQ29udGV4dExvc3QoKSAmJiBnbC5nZXRFeHRlbnNpb24oJ1dFQkdMX2xvc2VfY29udGV4dCcpKVxuICAgICAgICB7XG4gICAgICAgICAgICBnbC5nZXRFeHRlbnNpb24oJ1dFQkdMX2xvc2VfY29udGV4dCcpLnJlc3RvcmVDb250ZXh0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHRoZSBjb250ZXh0XG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtXZWJHTFJlbmRlcmluZ0NvbnRleHR9IGdsIC0gV2ViR0wgY29udGV4dFxuICAgICAqL1xuICAgIGluaXRGcm9tQ29udGV4dChnbDogSVJlbmRlcmluZ0NvbnRleHQpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmdsID0gZ2w7XG4gICAgICAgIHRoaXMudmFsaWRhdGVDb250ZXh0KGdsKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5nbCA9IGdsO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLkNPTlRFWFRfVUlEID0gQ09OVEVYVF9VSURfQ09VTlRFUisrO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJ1bm5lcnMuY29udGV4dENoYW5nZS5lbWl0KGdsKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGZyb20gY29udGV4dCBvcHRpb25zXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSFRNTENhbnZhc0VsZW1lbnQvZ2V0Q29udGV4dFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gY29udGV4dCBhdHRyaWJ1dGVzXG4gICAgICovXG4gICAgaW5pdEZyb21PcHRpb25zKG9wdGlvbnM6IFdlYkdMQ29udGV4dEF0dHJpYnV0ZXMpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuY3JlYXRlQ29udGV4dCh0aGlzLnJlbmRlcmVyLnZpZXcsIG9wdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuaW5pdEZyb21Db250ZXh0KGdsKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgY2xhc3MgdG8gY3JlYXRlIGEgV2ViR0wgQ29udGV4dFxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbnZhcyB7SFRNTENhbnZhc0VsZW1lbnR9IHRoZSBjYW52YXMgZWxlbWVudCB0aGF0IHdlIHdpbGwgZ2V0IHRoZSBjb250ZXh0IGZyb21cbiAgICAgKiBAcGFyYW0gb3B0aW9ucyB7b2JqZWN0fSBBbiBvcHRpb25zIG9iamVjdCB0aGF0IGdldHMgcGFzc2VkIGluIHRvIHRoZSBjYW52YXMgZWxlbWVudCBjb250YWluaW5nIHRoZSBjb250ZXh0IGF0dHJpYnV0ZXNcbiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL2RvY3MvV2ViL0FQSS9IVE1MQ2FudmFzRWxlbWVudC9nZXRDb250ZXh0XG4gICAgICogQHJldHVybiB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSB0aGUgV2ViR0wgY29udGV4dFxuICAgICAqL1xuICAgIGNyZWF0ZUNvbnRleHQoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgb3B0aW9uczogV2ViR0xDb250ZXh0QXR0cmlidXRlcyk6IElSZW5kZXJpbmdDb250ZXh0XG4gICAge1xuICAgICAgICBsZXQgZ2w7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLlBSRUZFUl9FTlYgPj0gRU5WLldFQkdMMilcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wyJywgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2wpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMud2ViR0xWZXJzaW9uID0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMud2ViR0xWZXJzaW9uID0gMTtcblxuICAgICAgICAgICAgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnLCBvcHRpb25zKVxuICAgICAgICAgICAgfHwgY2FudmFzLmdldENvbnRleHQoJ2V4cGVyaW1lbnRhbC13ZWJnbCcsIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICBpZiAoIWdsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGZhaWwsIG5vdCBhYmxlIHRvIGdldCBhIGNvbnRleHRcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IFdlYkdMLiBUcnkgdXNpbmcgdGhlIGNhbnZhcyByZW5kZXJlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5nbCA9IGdsIGFzIElSZW5kZXJpbmdDb250ZXh0O1xuXG4gICAgICAgIHRoaXMuZ2V0RXh0ZW5zaW9ucygpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmdsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEF1dG8tcG9wdWxhdGUgdGhlIGV4dGVuc2lvbnNcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0RXh0ZW5zaW9ucygpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyB0aW1lIHRvIHNldCB1cCBkZWZhdWx0IGV4dGVuc2lvbnMgdGhhdCBQaXhpIHVzZXMuXG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHRoaXMud2ViR0xWZXJzaW9uID09PSAxKVxuICAgICAgICB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZXh0ZW5zaW9ucywge1xuICAgICAgICAgICAgICAgIGRyYXdCdWZmZXJzOiBnbC5nZXRFeHRlbnNpb24oJ1dFQkdMX2RyYXdfYnVmZmVycycpLFxuICAgICAgICAgICAgICAgIGRlcHRoVGV4dHVyZTogZ2wuZ2V0RXh0ZW5zaW9uKCdXRUJHTF9kZXB0aF90ZXh0dXJlJyksXG4gICAgICAgICAgICAgICAgbG9zZUNvbnRleHQ6IGdsLmdldEV4dGVuc2lvbignV0VCR0xfbG9zZV9jb250ZXh0JyksXG4gICAgICAgICAgICAgICAgdmVydGV4QXJyYXlPYmplY3Q6IGdsLmdldEV4dGVuc2lvbignT0VTX3ZlcnRleF9hcnJheV9vYmplY3QnKVxuICAgICAgICAgICAgICAgICAgICB8fCBnbC5nZXRFeHRlbnNpb24oJ01PWl9PRVNfdmVydGV4X2FycmF5X29iamVjdCcpXG4gICAgICAgICAgICAgICAgICAgIHx8IGdsLmdldEV4dGVuc2lvbignV0VCS0lUX09FU192ZXJ0ZXhfYXJyYXlfb2JqZWN0JyksXG4gICAgICAgICAgICAgICAgYW5pc290cm9waWNGaWx0ZXJpbmc6IGdsLmdldEV4dGVuc2lvbignRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljJyksXG4gICAgICAgICAgICAgICAgdWludDMyRWxlbWVudEluZGV4OiBnbC5nZXRFeHRlbnNpb24oJ09FU19lbGVtZW50X2luZGV4X3VpbnQnKSxcbiAgICAgICAgICAgICAgICAvLyBGbG9hdHMgYW5kIGhhbGYtZmxvYXRzXG4gICAgICAgICAgICAgICAgZmxvYXRUZXh0dXJlOiBnbC5nZXRFeHRlbnNpb24oJ09FU190ZXh0dXJlX2Zsb2F0JyksXG4gICAgICAgICAgICAgICAgZmxvYXRUZXh0dXJlTGluZWFyOiBnbC5nZXRFeHRlbnNpb24oJ09FU190ZXh0dXJlX2Zsb2F0X2xpbmVhcicpLFxuICAgICAgICAgICAgICAgIHRleHR1cmVIYWxmRmxvYXQ6IGdsLmdldEV4dGVuc2lvbignT0VTX3RleHR1cmVfaGFsZl9mbG9hdCcpLFxuICAgICAgICAgICAgICAgIHRleHR1cmVIYWxmRmxvYXRMaW5lYXI6IGdsLmdldEV4dGVuc2lvbignT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXInKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMud2ViR0xWZXJzaW9uID09PSAyKVxuICAgICAgICB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZXh0ZW5zaW9ucywge1xuICAgICAgICAgICAgICAgIGFuaXNvdHJvcGljRmlsdGVyaW5nOiBnbC5nZXRFeHRlbnNpb24oJ0VYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYycpLFxuICAgICAgICAgICAgICAgIC8vIEZsb2F0cyBhbmQgaGFsZi1mbG9hdHNcbiAgICAgICAgICAgICAgICBjb2xvckJ1ZmZlckZsb2F0OiBnbC5nZXRFeHRlbnNpb24oJ0VYVF9jb2xvcl9idWZmZXJfZmxvYXQnKSxcbiAgICAgICAgICAgICAgICBmbG9hdFRleHR1cmVMaW5lYXI6IGdsLmdldEV4dGVuc2lvbignT0VTX3RleHR1cmVfZmxvYXRfbGluZWFyJyksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgYSBsb3N0IHdlYmdsIGNvbnRleHRcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1dlYkdMQ29udGV4dEV2ZW50fSBldmVudCAtIFRoZSBjb250ZXh0IGxvc3QgZXZlbnQuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGhhbmRsZUNvbnRleHRMb3N0KGV2ZW50OiBXZWJHTENvbnRleHRFdmVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyBhIHJlc3RvcmVkIHdlYmdsIGNvbnRleHRcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgaGFuZGxlQ29udGV4dFJlc3RvcmVkKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIucnVubmVycy5jb250ZXh0Q2hhbmdlLmVtaXQodGhpcy5nbCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5yZW5kZXJlci52aWV3O1xuXG4gICAgICAgIC8vIHJlbW92ZSBsaXN0ZW5lcnNcbiAgICAgICAgKHZpZXcgYXMgYW55KS5yZW1vdmVFdmVudExpc3RlbmVyKCd3ZWJnbGNvbnRleHRsb3N0JywgdGhpcy5oYW5kbGVDb250ZXh0TG9zdCk7XG4gICAgICAgIHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2ViZ2xjb250ZXh0cmVzdG9yZWQnLCB0aGlzLmhhbmRsZUNvbnRleHRSZXN0b3JlZCk7XG5cbiAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKG51bGwpO1xuXG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMubG9zZUNvbnRleHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucy5sb3NlQ29udGV4dC5sb3NlQ29udGV4dCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHRoZSBwb3N0LXJlbmRlciBydW5uZXIgZXZlbnRcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgcG9zdHJlbmRlcigpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5yZW5kZXJpbmdUb1NjcmVlbilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5nbC5mbHVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgY29udGV4dFxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBnbCAtIFJlbmRlciBjb250ZXh0XG4gICAgICovXG4gICAgcHJvdGVjdGVkIHZhbGlkYXRlQ29udGV4dChnbDogSVJlbmRlcmluZ0NvbnRleHQpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZ2wuZ2V0Q29udGV4dEF0dHJpYnV0ZXMoKTtcblxuICAgICAgICBjb25zdCBpc1dlYkdsMiA9ICdXZWJHTDJSZW5kZXJpbmdDb250ZXh0JyBpbiB3aW5kb3cgJiYgZ2wgaW5zdGFuY2VvZiB3aW5kb3cuV2ViR0wyUmVuZGVyaW5nQ29udGV4dDtcblxuICAgICAgICBpZiAoaXNXZWJHbDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMud2ViR0xWZXJzaW9uID0gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoaXMgaXMgZ29pbmcgdG8gYmUgZmFpcmx5IHNpbXBsZSBmb3Igbm93Li4gYnV0IGF0IGxlYXN0IHdlIGhhdmUgcm9vbSB0byBncm93IVxuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMuc3RlbmNpbClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiwgbm8tY29uc29sZSAqL1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdQcm92aWRlZCBXZWJHTCBjb250ZXh0IGRvZXMgbm90IGhhdmUgYSBzdGVuY2lsIGJ1ZmZlciwgbWFza3MgbWF5IG5vdCByZW5kZXIgY29ycmVjdGx5Jyk7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG1heC1sZW4sIG5vLWNvbnNvbGUgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGhhc3VpbnQzMiA9IGlzV2ViR2wyIHx8ICEhKGdsIGFzIFdlYkdMUmVuZGVyaW5nQ29udGV4dCkuZ2V0RXh0ZW5zaW9uKCdPRVNfZWxlbWVudF9pbmRleF91aW50Jyk7XG5cbiAgICAgICAgdGhpcy5zdXBwb3J0cy51aW50MzJJbmRpY2VzID0gaGFzdWludDMyO1xuXG4gICAgICAgIGlmICghaGFzdWludDMyKVxuICAgICAgICB7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuLCBuby1jb25zb2xlICovXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Byb3ZpZGVkIFdlYkdMIGNvbnRleHQgZG9lcyBub3Qgc3VwcG9ydCAzMiBpbmRleCBidWZmZXIsIGNvbXBsZXggZ3JhcGhpY3MgbWF5IG5vdCByZW5kZXIgY29ycmVjdGx5Jyk7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG1heC1sZW4sIG5vLWNvbnNvbGUgKi9cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBNU0FBX1FVQUxJVFkgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IEZyYW1lYnVmZmVyIH0gZnJvbSAnLi9GcmFtZWJ1ZmZlcic7XG5cbi8qKlxuICogSW50ZXJuYWwgZnJhbWVidWZmZXIgZm9yIFdlYkdMIGNvbnRleHRcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdMRnJhbWVidWZmZXJcbntcbiAgICBwdWJsaWMgZnJhbWVidWZmZXI6IFdlYkdMRnJhbWVidWZmZXI7XG4gICAgcHVibGljIHN0ZW5jaWw6IFdlYkdMUmVuZGVyYnVmZmVyO1xuICAgIHB1YmxpYyBtdWx0aXNhbXBsZTogTVNBQV9RVUFMSVRZO1xuICAgIHB1YmxpYyBtc2FhQnVmZmVyOiBXZWJHTFJlbmRlcmJ1ZmZlcjtcbiAgICBwdWJsaWMgYmxpdEZyYW1lYnVmZmVyOiBGcmFtZWJ1ZmZlcjtcbiAgICBkaXJ0eUlkOiBudW1iZXI7XG4gICAgZGlydHlGb3JtYXQ6IG51bWJlcjtcbiAgICBkaXJ0eVNpemU6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKGZyYW1lYnVmZmVyOiBXZWJHTFRleHR1cmUpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFdlYkdMIGZyYW1lYnVmZmVyXG4gICAgICAgICAqIEBtZW1iZXIge1dlYkdMRnJhbWVidWZmZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyID0gZnJhbWVidWZmZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzdGVuY2lsK2RlcHRoICwgdXN1YWxseSBjb3N0cyAzMmJpdHMgcGVyIHBpeGVsXG4gICAgICAgICAqIEBtZW1iZXIge1dlYkdMUmVuZGVyYnVmZmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGVuY2lsID0gbnVsbDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGxhdGVzdCBrbm93biB2ZXJzaW9uIG9mIGZyYW1lYnVmZmVyXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXJ0eUlkID0gMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGxhdGVzdCBrbm93biB2ZXJzaW9uIG9mIGZyYW1lYnVmZmVyIGZvcm1hdFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlydHlGb3JtYXQgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogbGF0ZXN0IGtub3duIHZlcnNpb24gb2YgZnJhbWVidWZmZXIgc2l6ZVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlydHlTaXplID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGV0ZWN0ZWQgQUEgc2FtcGxlcyBudW1iZXJcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NU0FBX1FVQUxJVFl9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11bHRpc2FtcGxlID0gTVNBQV9RVUFMSVRZLk5PTkU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluIGNhc2UgTVNBQSwgd2UgdXNlIHRoaXMgUmVuZGVyYnVmZmVyIGluc3RlYWQgb2YgY29sb3JUZXh0dXJlc1swXSB3aGVuIHdlIHdyaXRlIGluZm9cbiAgICAgICAgICogQG1lbWJlciB7V2ViR0xSZW5kZXJidWZmZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1zYWFCdWZmZXIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbiBjYXNlIHdlIHVzZSBNU0FBLCB0aGlzIGlzIGFjdHVhbCBmcmFtZWJ1ZmZlciB0aGF0IGhhcyBjb2xvclRleHR1cmVzWzBdXG4gICAgICAgICAqIFRoZSBjb250ZW50cyBvZiB0aGF0IGZyYW1lYnVmZmVyIGFyZSByZWFkIHdoZW4gd2UgdXNlIHRoYXQgcmVuZGVyVGV4dHVyZSBpbiBzcHJpdGVzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRnJhbWVidWZmZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJsaXRGcmFtZWJ1ZmZlciA9IG51bGw7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IEVOViwgQlVGRkVSX0JJVFMsIE1TQUFfUVVBTElUWSB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzJztcbmltcG9ydCB7IEZyYW1lYnVmZmVyIH0gZnJvbSAnLi9GcmFtZWJ1ZmZlcic7XG5pbXBvcnQgeyBHTEZyYW1lYnVmZmVyIH0gZnJvbSAnLi9HTEZyYW1lYnVmZmVyJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgSVJlbmRlcmluZ0NvbnRleHQgfSBmcm9tICcuLi9JUmVuZGVyaW5nQ29udGV4dCc7XG5cbmNvbnN0IHRlbXBSZWN0YW5nbGUgPSBuZXcgUmVjdGFuZ2xlKCk7XG5cbi8qKlxuICogU3lzdGVtIHBsdWdpbiB0byB0aGUgcmVuZGVyZXIgdG8gbWFuYWdlIGZyYW1lYnVmZmVycy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCBjbGFzcyBGcmFtZWJ1ZmZlclN5c3RlbSBleHRlbmRzIFN5c3RlbVxue1xuICAgIHB1YmxpYyByZWFkb25seSBtYW5hZ2VkRnJhbWVidWZmZXJzOiBBcnJheTxGcmFtZWJ1ZmZlcj47XG4gICAgcHVibGljIGN1cnJlbnQ6IEZyYW1lYnVmZmVyO1xuICAgIHB1YmxpYyB2aWV3cG9ydDogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyBoYXNNUlQ6IGJvb2xlYW47XG4gICAgcHVibGljIHdyaXRlRGVwdGhUZXh0dXJlOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBDT05URVhUX1VJRDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBnbDogSVJlbmRlcmluZ0NvbnRleHQ7XG4gICAgcHJvdGVjdGVkIHVua25vd25GcmFtZWJ1ZmZlcjogRnJhbWVidWZmZXI7XG4gICAgcHJvdGVjdGVkIG1zYWFTYW1wbGVzOiBBcnJheTxudW1iZXI+O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgbWFuYWdlZCBmcmFtZWJ1ZmZlcnNcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5GcmFtZWJ1ZmZlcltdfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWFuYWdlZEZyYW1lYnVmZmVycyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGcmFtZWJ1ZmZlciB2YWx1ZSB0aGF0IHNob3dzIHRoYXQgd2UgZG9uJ3Qga25vdyB3aGF0IGlzIGJvdW5kXG4gICAgICAgICAqIEBtZW1iZXIge0ZyYW1lYnVmZmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudW5rbm93bkZyYW1lYnVmZmVyID0gbmV3IEZyYW1lYnVmZmVyKDEwLCAxMCk7XG5cbiAgICAgICAgdGhpcy5tc2FhU2FtcGxlcyA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB1cCB0aGUgcmVuZGVyZXIgY29udGV4dCBhbmQgbmVjZXNzYXJ5IGJ1ZmZlcnMuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNvbnRleHRDaGFuZ2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZ2wgPSB0aGlzLmdsID0gdGhpcy5yZW5kZXJlci5nbDtcblxuICAgICAgICB0aGlzLkNPTlRFWFRfVUlEID0gdGhpcy5yZW5kZXJlci5DT05URVhUX1VJRDtcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy51bmtub3duRnJhbWVidWZmZXI7XG4gICAgICAgIHRoaXMudmlld3BvcnQgPSBuZXcgUmVjdGFuZ2xlKCk7XG4gICAgICAgIHRoaXMuaGFzTVJUID0gdHJ1ZTtcbiAgICAgICAgdGhpcy53cml0ZURlcHRoVGV4dHVyZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5kaXNwb3NlQWxsKHRydWUpO1xuXG4gICAgICAgIC8vIHdlYmdsMlxuICAgICAgICBpZiAodGhpcy5yZW5kZXJlci5jb250ZXh0LndlYkdMVmVyc2lvbiA9PT0gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gd2ViZ2wgMSFcbiAgICAgICAgICAgIGxldCBuYXRpdmVEcmF3QnVmZmVyc0V4dGVuc2lvbiA9IHRoaXMucmVuZGVyZXIuY29udGV4dC5leHRlbnNpb25zLmRyYXdCdWZmZXJzO1xuICAgICAgICAgICAgbGV0IG5hdGl2ZURlcHRoVGV4dHVyZUV4dGVuc2lvbiA9IHRoaXMucmVuZGVyZXIuY29udGV4dC5leHRlbnNpb25zLmRlcHRoVGV4dHVyZTtcblxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLlBSRUZFUl9FTlYgPT09IEVOVi5XRUJHTF9MRUdBQ1kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmF0aXZlRHJhd0J1ZmZlcnNFeHRlbnNpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgIG5hdGl2ZURlcHRoVGV4dHVyZUV4dGVuc2lvbiA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuYXRpdmVEcmF3QnVmZmVyc0V4dGVuc2lvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC5kcmF3QnVmZmVycyA9IChhY3RpdmVUZXh0dXJlczogbnVtYmVyW10pOiB2b2lkID0+XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZURyYXdCdWZmZXJzRXh0ZW5zaW9uLmRyYXdCdWZmZXJzV0VCR0woYWN0aXZlVGV4dHVyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzTVJUID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZ2wuZHJhd0J1ZmZlcnMgPSAoKTogdm9pZCA9PlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZW1wdHlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIW5hdGl2ZURlcHRoVGV4dHVyZUV4dGVuc2lvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRlRGVwdGhUZXh0dXJlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBXZWJHTDJcbiAgICAgICAgICAgIC8vIGNhY2hlIHBvc3NpYmxlIE1TQUEgc2FtcGxlc1xuICAgICAgICAgICAgdGhpcy5tc2FhU2FtcGxlcyA9IGdsLmdldEludGVybmFsZm9ybWF0UGFyYW1ldGVyKGdsLlJFTkRFUkJVRkZFUiwgZ2wuUkdCQTgsIGdsLlNBTVBMRVMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQmluZCBhIGZyYW1lYnVmZmVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRnJhbWVidWZmZXJ9IGZyYW1lYnVmZmVyXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gW2ZyYW1lXSBmcmFtZSwgZGVmYXVsdCBpcyBmcmFtZWJ1ZmZlciBzaXplXG4gICAgICovXG4gICAgYmluZChmcmFtZWJ1ZmZlcj86IEZyYW1lYnVmZmVyLCBmcmFtZT86IFJlY3RhbmdsZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKGZyYW1lYnVmZmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUT0RPIGNhY2hpbmcgbGF5ZXIhXG5cbiAgICAgICAgICAgIGNvbnN0IGZibyA9IGZyYW1lYnVmZmVyLmdsRnJhbWVidWZmZXJzW3RoaXMuQ09OVEVYVF9VSURdIHx8IHRoaXMuaW5pdEZyYW1lYnVmZmVyKGZyYW1lYnVmZmVyKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudCAhPT0gZnJhbWVidWZmZXIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gZnJhbWVidWZmZXI7XG4gICAgICAgICAgICAgICAgZ2wuYmluZEZyYW1lYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBmYm8uZnJhbWVidWZmZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIGFsbCB0ZXh0dXJlcyBhcmUgdW5ib3VuZC4uXG5cbiAgICAgICAgICAgIC8vIG5vdyBjaGVjayBmb3IgdXBkYXRlcy4uLlxuICAgICAgICAgICAgaWYgKGZiby5kaXJ0eUlkICE9PSBmcmFtZWJ1ZmZlci5kaXJ0eUlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZiby5kaXJ0eUlkID0gZnJhbWVidWZmZXIuZGlydHlJZDtcblxuICAgICAgICAgICAgICAgIGlmIChmYm8uZGlydHlGb3JtYXQgIT09IGZyYW1lYnVmZmVyLmRpcnR5Rm9ybWF0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZmJvLmRpcnR5Rm9ybWF0ID0gZnJhbWVidWZmZXIuZGlydHlGb3JtYXQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRnJhbWVidWZmZXIoZnJhbWVidWZmZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChmYm8uZGlydHlTaXplICE9PSBmcmFtZWJ1ZmZlci5kaXJ0eVNpemUpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBmYm8uZGlydHlTaXplID0gZnJhbWVidWZmZXIuZGlydHlTaXplO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZUZyYW1lYnVmZmVyKGZyYW1lYnVmZmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZnJhbWVidWZmZXIuY29sb3JUZXh0dXJlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXggPSBmcmFtZWJ1ZmZlci5jb2xvclRleHR1cmVzW2ldO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci50ZXh0dXJlLnVuYmluZCh0ZXgucGFyZW50VGV4dHVyZUFycmF5IHx8IHRleCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmcmFtZWJ1ZmZlci5kZXB0aFRleHR1cmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci50ZXh0dXJlLnVuYmluZChmcmFtZWJ1ZmZlci5kZXB0aFRleHR1cmUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZnJhbWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWaWV3cG9ydChmcmFtZS54LCBmcmFtZS55LCBmcmFtZS53aWR0aCwgZnJhbWUuaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZpZXdwb3J0KDAsIDAsIGZyYW1lYnVmZmVyLndpZHRoLCBmcmFtZWJ1ZmZlci5oZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgbnVsbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmcmFtZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZpZXdwb3J0KGZyYW1lLngsIGZyYW1lLnksIGZyYW1lLndpZHRoLCBmcmFtZS5oZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Vmlld3BvcnQoMCwgMCwgdGhpcy5yZW5kZXJlci53aWR0aCwgdGhpcy5yZW5kZXJlci5oZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBXZWJHTFJlbmRlcmluZ0NvbnRleHQncyB2aWV3cG9ydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4IC0gWCBwb3NpdGlvbiBvZiB2aWV3cG9ydFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5IC0gWSBwb3NpdGlvbiBvZiB2aWV3cG9ydFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aCAtIFdpZHRoIG9mIHZpZXdwb3J0XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodCAtIEhlaWdodCBvZiB2aWV3cG9ydFxuICAgICAqL1xuICAgIHNldFZpZXdwb3J0KHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHYgPSB0aGlzLnZpZXdwb3J0O1xuXG4gICAgICAgIGlmICh2LndpZHRoICE9PSB3aWR0aCB8fCB2LmhlaWdodCAhPT0gaGVpZ2h0IHx8IHYueCAhPT0geCB8fCB2LnkgIT09IHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHYueCA9IHg7XG4gICAgICAgICAgICB2LnkgPSB5O1xuICAgICAgICAgICAgdi53aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgdi5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgIHRoaXMuZ2wudmlld3BvcnQoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHNpemUgb2YgdGhlIGN1cnJlbnQgd2lkdGggYW5kIGhlaWdodC4gUmV0dXJucyBvYmplY3Qgd2l0aCBgd2lkdGhgIGFuZCBgaGVpZ2h0YCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgZ2V0IHNpemUoKTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETyBzdG9yZSB0ZW1wXG4gICAgICAgICAgICByZXR1cm4geyB4OiAwLCB5OiAwLCB3aWR0aDogdGhpcy5jdXJyZW50LndpZHRoLCBoZWlnaHQ6IHRoaXMuY3VycmVudC5oZWlnaHQgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHg6IDAsIHk6IDAsIHdpZHRoOiB0aGlzLnJlbmRlcmVyLndpZHRoLCBoZWlnaHQ6IHRoaXMucmVuZGVyZXIuaGVpZ2h0IH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIGNvbG9yIG9mIHRoZSBjb250ZXh0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gciAtIFJlZCB2YWx1ZSBmcm9tIDAgdG8gMVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBnIC0gR3JlZW4gdmFsdWUgZnJvbSAwIHRvIDFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYiAtIEJsdWUgdmFsdWUgZnJvbSAwIHRvIDFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYSAtIEFscGhhIHZhbHVlIGZyb20gMCB0byAxXG4gICAgICogQHBhcmFtIHtQSVhJLkJVRkZFUl9CSVRTfSBbbWFzaz1CVUZGRVJfQklUUy5DT0xPUiB8IEJVRkZFUl9CSVRTLkRFUFRIXSAtIEJpdHdpc2UgT1Igb2YgbWFza3NcbiAgICAgKiAgdGhhdCBpbmRpY2F0ZSB0aGUgYnVmZmVycyB0byBiZSBjbGVhcmVkLCBieSBkZWZhdWx0IENPTE9SIGFuZCBERVBUSCBidWZmZXJzLlxuICAgICAqL1xuICAgIGNsZWFyKHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIsIGE6IG51bWJlciwgbWFzazogQlVGRkVSX0JJVFMgPSBCVUZGRVJfQklUUy5DT0xPUiB8IEJVRkZFUl9CSVRTLkRFUFRIKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcztcblxuICAgICAgICAvLyBUT0RPIGNsZWFyIGNvbG9yIGNhbiBiZSBzZXQgb25seSBvbmUgcmlnaHQ/XG4gICAgICAgIGdsLmNsZWFyQ29sb3IociwgZywgYiwgYSk7XG4gICAgICAgIGdsLmNsZWFyKG1hc2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgZnJhbWVidWZmZXIgZm9yIHRoaXMgY29udGV4dFxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5GcmFtZWJ1ZmZlcn0gZnJhbWVidWZmZXJcbiAgICAgKiBAcmV0dXJucyB7UElYSS5HTEZyYW1lYnVmZmVyfSBjcmVhdGVkIEdMRnJhbWVidWZmZXJcbiAgICAgKi9cbiAgICBpbml0RnJhbWVidWZmZXIoZnJhbWVidWZmZXI6IEZyYW1lYnVmZmVyKTogR0xGcmFtZWJ1ZmZlclxuICAgIHtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgZmJvID0gbmV3IEdMRnJhbWVidWZmZXIoZ2wuY3JlYXRlRnJhbWVidWZmZXIoKSk7XG5cbiAgICAgICAgZmJvLm11bHRpc2FtcGxlID0gdGhpcy5kZXRlY3RTYW1wbGVzKGZyYW1lYnVmZmVyLm11bHRpc2FtcGxlKTtcbiAgICAgICAgZnJhbWVidWZmZXIuZ2xGcmFtZWJ1ZmZlcnNbdGhpcy5DT05URVhUX1VJRF0gPSBmYm87XG5cbiAgICAgICAgdGhpcy5tYW5hZ2VkRnJhbWVidWZmZXJzLnB1c2goZnJhbWVidWZmZXIpO1xuICAgICAgICBmcmFtZWJ1ZmZlci5kaXNwb3NlUnVubmVyLmFkZCh0aGlzKTtcblxuICAgICAgICByZXR1cm4gZmJvO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2l6ZSB0aGUgZnJhbWVidWZmZXJcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuRnJhbWVidWZmZXJ9IGZyYW1lYnVmZmVyXG4gICAgICovXG4gICAgcmVzaXplRnJhbWVidWZmZXIoZnJhbWVidWZmZXI6IEZyYW1lYnVmZmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcztcblxuICAgICAgICBjb25zdCBmYm8gPSBmcmFtZWJ1ZmZlci5nbEZyYW1lYnVmZmVyc1t0aGlzLkNPTlRFWFRfVUlEXTtcblxuICAgICAgICBpZiAoZmJvLnN0ZW5jaWwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmJpbmRSZW5kZXJidWZmZXIoZ2wuUkVOREVSQlVGRkVSLCBmYm8uc3RlbmNpbCk7XG4gICAgICAgICAgICBnbC5yZW5kZXJidWZmZXJTdG9yYWdlKGdsLlJFTkRFUkJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTCwgZnJhbWVidWZmZXIud2lkdGgsIGZyYW1lYnVmZmVyLmhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb2xvclRleHR1cmVzID0gZnJhbWVidWZmZXIuY29sb3JUZXh0dXJlcztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbG9yVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIudGV4dHVyZS5iaW5kKGNvbG9yVGV4dHVyZXNbaV0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZyYW1lYnVmZmVyLmRlcHRoVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci50ZXh0dXJlLmJpbmQoZnJhbWVidWZmZXIuZGVwdGhUZXh0dXJlLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgZnJhbWVidWZmZXJcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuRnJhbWVidWZmZXJ9IGZyYW1lYnVmZmVyXG4gICAgICovXG4gICAgdXBkYXRlRnJhbWVidWZmZXIoZnJhbWVidWZmZXI6IEZyYW1lYnVmZmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcztcblxuICAgICAgICBjb25zdCBmYm8gPSBmcmFtZWJ1ZmZlci5nbEZyYW1lYnVmZmVyc1t0aGlzLkNPTlRFWFRfVUlEXTtcblxuICAgICAgICAvLyBiaW5kIHRoZSBjb2xvciB0ZXh0dXJlXG4gICAgICAgIGNvbnN0IGNvbG9yVGV4dHVyZXMgPSBmcmFtZWJ1ZmZlci5jb2xvclRleHR1cmVzO1xuXG4gICAgICAgIGxldCBjb3VudCA9IGNvbG9yVGV4dHVyZXMubGVuZ3RoO1xuXG4gICAgICAgIGlmICghZ2wuZHJhd0J1ZmZlcnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvdW50ID0gTWF0aC5taW4oY291bnQsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZiby5tdWx0aXNhbXBsZSA+IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZiby5tc2FhQnVmZmVyID0gZ2wuY3JlYXRlUmVuZGVyYnVmZmVyKCk7XG4gICAgICAgICAgICBnbC5iaW5kUmVuZGVyYnVmZmVyKGdsLlJFTkRFUkJVRkZFUiwgZmJvLm1zYWFCdWZmZXIpO1xuICAgICAgICAgICAgZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKGdsLlJFTkRFUkJVRkZFUiwgZmJvLm11bHRpc2FtcGxlLFxuICAgICAgICAgICAgICAgIGdsLlJHQkE4LCBmcmFtZWJ1ZmZlci53aWR0aCwgZnJhbWVidWZmZXIuaGVpZ2h0KTtcbiAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBnbC5DT0xPUl9BVFRBQ0hNRU5UMCwgZ2wuUkVOREVSQlVGRkVSLCBmYm8ubXNhYUJ1ZmZlcik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhY3RpdmVUZXh0dXJlcyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGkgPT09IDAgJiYgZmJvLm11bHRpc2FtcGxlID4gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IGZyYW1lYnVmZmVyLmNvbG9yVGV4dHVyZXNbaV07XG4gICAgICAgICAgICBjb25zdCBwYXJlbnRUZXh0dXJlID0gdGV4dHVyZS5wYXJlbnRUZXh0dXJlQXJyYXkgfHwgdGV4dHVyZTtcblxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci50ZXh0dXJlLmJpbmQocGFyZW50VGV4dHVyZSwgMCk7XG5cbiAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyVGV4dHVyZTJEKGdsLkZSQU1FQlVGRkVSLFxuICAgICAgICAgICAgICAgIGdsLkNPTE9SX0FUVEFDSE1FTlQwICsgaSxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwYXJlbnRUZXh0dXJlLl9nbFRleHR1cmVzW3RoaXMuQ09OVEVYVF9VSURdLnRleHR1cmUsXG4gICAgICAgICAgICAgICAgMCk7XG5cbiAgICAgICAgICAgIGFjdGl2ZVRleHR1cmVzLnB1c2goZ2wuQ09MT1JfQVRUQUNITUVOVDAgKyBpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVUZXh0dXJlcy5sZW5ndGggPiAxKVxuICAgICAgICB7XG4gICAgICAgICAgICBnbC5kcmF3QnVmZmVycyhhY3RpdmVUZXh0dXJlcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZnJhbWVidWZmZXIuZGVwdGhUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB3cml0ZURlcHRoVGV4dHVyZSA9IHRoaXMud3JpdGVEZXB0aFRleHR1cmU7XG5cbiAgICAgICAgICAgIGlmICh3cml0ZURlcHRoVGV4dHVyZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXB0aFRleHR1cmUgPSBmcmFtZWJ1ZmZlci5kZXB0aFRleHR1cmU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnRleHR1cmUuYmluZChkZXB0aFRleHR1cmUsIDApO1xuXG4gICAgICAgICAgICAgICAgZ2wuZnJhbWVidWZmZXJUZXh0dXJlMkQoZ2wuRlJBTUVCVUZGRVIsXG4gICAgICAgICAgICAgICAgICAgIGdsLkRFUFRIX0FUVEFDSE1FTlQsXG4gICAgICAgICAgICAgICAgICAgIGdsLlRFWFRVUkVfMkQsXG4gICAgICAgICAgICAgICAgICAgIGRlcHRoVGV4dHVyZS5fZ2xUZXh0dXJlc1t0aGlzLkNPTlRFWFRfVUlEXS50ZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZmJvLnN0ZW5jaWwgJiYgKGZyYW1lYnVmZmVyLnN0ZW5jaWwgfHwgZnJhbWVidWZmZXIuZGVwdGgpKVxuICAgICAgICB7XG4gICAgICAgICAgICBmYm8uc3RlbmNpbCA9IGdsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO1xuXG4gICAgICAgICAgICBnbC5iaW5kUmVuZGVyYnVmZmVyKGdsLlJFTkRFUkJVRkZFUiwgZmJvLnN0ZW5jaWwpO1xuXG4gICAgICAgICAgICBnbC5yZW5kZXJidWZmZXJTdG9yYWdlKGdsLlJFTkRFUkJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTCwgZnJhbWVidWZmZXIud2lkdGgsIGZyYW1lYnVmZmVyLmhlaWdodCk7XG4gICAgICAgICAgICAvLyBUT0RPLi4gdGhpcyBpcyBkZXB0aCBBTkQgc3RlbmNpbD9cbiAgICAgICAgICAgIGlmICghZnJhbWVidWZmZXIuZGVwdGhUZXh0dXJlKVxuICAgICAgICAgICAgeyAvLyB5b3UgY2FuJ3QgaGF2ZSBib3RoLCBzbyBvbmUgc2hvdWxkIHRha2UgcHJpb3JpdHkgaWYgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGdsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBnbC5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQsIGdsLlJFTkRFUkJVRkZFUiwgZmJvLnN0ZW5jaWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZWN0cyBudW1iZXIgb2Ygc2FtcGxlcyB0aGF0IGlzIG5vdCBtb3JlIHRoYW4gYSBwYXJhbSBidXQgYXMgY2xvc2UgdG8gaXQgYXMgcG9zc2libGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NU0FBX1FVQUxJVFl9IHNhbXBsZXMgLSBudW1iZXIgb2Ygc2FtcGxlc1xuICAgICAqIEByZXR1cm5zIHtQSVhJLk1TQUFfUVVBTElUWX0gLSByZWNvbW1lbmRlZCBudW1iZXIgb2Ygc2FtcGxlc1xuICAgICAqL1xuICAgIHByb3RlY3RlZCBkZXRlY3RTYW1wbGVzKHNhbXBsZXM6IE1TQUFfUVVBTElUWSk6IE1TQUFfUVVBTElUWVxuICAgIHtcbiAgICAgICAgY29uc3QgeyBtc2FhU2FtcGxlcyB9ID0gdGhpcztcbiAgICAgICAgbGV0IHJlcyA9IE1TQUFfUVVBTElUWS5OT05FO1xuXG4gICAgICAgIGlmIChzYW1wbGVzIDw9IDEgfHwgbXNhYVNhbXBsZXMgPT09IG51bGwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtc2FhU2FtcGxlcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKG1zYWFTYW1wbGVzW2ldIDw9IHNhbXBsZXMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzID0gbXNhYVNhbXBsZXNbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVzID09PSAxKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXMgPSBNU0FBX1FVQUxJVFkuTk9ORTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT25seSB3b3JrcyB3aXRoIFdlYkdMMlxuICAgICAqXG4gICAgICogYmxpdHMgZnJhbWVidWZmZXIgdG8gYW5vdGhlciBvZiB0aGUgc2FtZSBvciBiaWdnZXIgc2l6ZVxuICAgICAqIGFmdGVyIHRoYXQgdGFyZ2V0IGZyYW1lYnVmZmVyIGlzIGJvdW5kXG4gICAgICpcbiAgICAgKiBGYWlscyB3aXRoIFdlYkdMIHdhcm5pbmcgaWYgYmxpdHMgbXVsdGlzYW1wbGUgZnJhbWVidWZmZXIgdG8gZGlmZmVyZW50IHNpemVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5GcmFtZWJ1ZmZlcn0gW2ZyYW1lYnVmZmVyXSAtIGJ5IGRlZmF1bHQgaXQgYmxpdHMgXCJpbnRvIGl0c2VsZlwiLCBmcm9tIHJlbmRlckJ1ZmZlciB0byB0ZXh0dXJlLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtzb3VyY2VQaXhlbHNdIC0gc291cmNlIHJlY3RhbmdsZSBpbiBwaXhlbHNcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBbZGVzdFBpeGVsc10gLSBkZXN0IHJlY3RhbmdsZSBpbiBwaXhlbHMsIGFzc3VtZWQgdG8gYmUgdGhlIHNhbWUgYXMgc291cmNlUGl4ZWxzXG4gICAgICovXG4gICAgcHVibGljIGJsaXQoZnJhbWVidWZmZXI/OiBGcmFtZWJ1ZmZlciwgc291cmNlUGl4ZWxzPzogUmVjdGFuZ2xlLCBkZXN0UGl4ZWxzPzogUmVjdGFuZ2xlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBjdXJyZW50LCByZW5kZXJlciwgZ2wsIENPTlRFWFRfVUlEIH0gPSB0aGlzO1xuXG4gICAgICAgIGlmIChyZW5kZXJlci5jb250ZXh0LndlYkdMVmVyc2lvbiAhPT0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjdXJyZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmJvID0gY3VycmVudC5nbEZyYW1lYnVmZmVyc1tDT05URVhUX1VJRF07XG5cbiAgICAgICAgaWYgKCFmYm8pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZyYW1lYnVmZmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoZmJvLm11bHRpc2FtcGxlIDw9IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFmYm8uYmxpdEZyYW1lYnVmZmVyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZiby5ibGl0RnJhbWVidWZmZXIgPSBuZXcgRnJhbWVidWZmZXIoY3VycmVudC53aWR0aCwgY3VycmVudC5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIGZiby5ibGl0RnJhbWVidWZmZXIuYWRkQ29sb3JUZXh0dXJlKDAsIGN1cnJlbnQuY29sb3JUZXh0dXJlc1swXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmcmFtZWJ1ZmZlciA9IGZiby5ibGl0RnJhbWVidWZmZXI7XG4gICAgICAgICAgICBmcmFtZWJ1ZmZlci53aWR0aCA9IGN1cnJlbnQud2lkdGg7XG4gICAgICAgICAgICBmcmFtZWJ1ZmZlci5oZWlnaHQgPSBjdXJyZW50LmhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc291cmNlUGl4ZWxzKVxuICAgICAgICB7XG4gICAgICAgICAgICBzb3VyY2VQaXhlbHMgPSB0ZW1wUmVjdGFuZ2xlO1xuICAgICAgICAgICAgc291cmNlUGl4ZWxzLndpZHRoID0gY3VycmVudC53aWR0aDtcbiAgICAgICAgICAgIHNvdXJjZVBpeGVscy5oZWlnaHQgPSBjdXJyZW50LmhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlc3RQaXhlbHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlc3RQaXhlbHMgPSBzb3VyY2VQaXhlbHM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzYW1lU2l6ZSA9IHNvdXJjZVBpeGVscy53aWR0aCA9PT0gZGVzdFBpeGVscy53aWR0aCAmJiBzb3VyY2VQaXhlbHMuaGVpZ2h0ID09PSBkZXN0UGl4ZWxzLmhlaWdodDtcblxuICAgICAgICB0aGlzLmJpbmQoZnJhbWVidWZmZXIpO1xuICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuUkVBRF9GUkFNRUJVRkZFUiwgZmJvLmZyYW1lYnVmZmVyKTtcbiAgICAgICAgZ2wuYmxpdEZyYW1lYnVmZmVyKHNvdXJjZVBpeGVscy54LCBzb3VyY2VQaXhlbHMueSwgc291cmNlUGl4ZWxzLndpZHRoLCBzb3VyY2VQaXhlbHMuaGVpZ2h0LFxuICAgICAgICAgICAgZGVzdFBpeGVscy54LCBkZXN0UGl4ZWxzLnksIGRlc3RQaXhlbHMud2lkdGgsIGRlc3RQaXhlbHMuaGVpZ2h0LFxuICAgICAgICAgICAgZ2wuQ09MT1JfQlVGRkVSX0JJVCwgc2FtZVNpemUgPyBnbC5ORUFSRVNUIDogZ2wuTElORUFSXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcG9zZXMgZnJhbWVidWZmZXJcbiAgICAgKiBAcGFyYW0ge1BJWEkuRnJhbWVidWZmZXJ9IGZyYW1lYnVmZmVyIC0gZnJhbWVidWZmZXIgdGhhdCBoYXMgdG8gYmUgZGlzcG9zZWQgb2ZcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtjb250ZXh0TG9zdD1mYWxzZV0gLSBJZiBjb250ZXh0IHdhcyBsb3N0LCB3ZSBzdXBwcmVzcyBhbGwgZGVsZXRlIGZ1bmN0aW9uIGNhbGxzXG4gICAgICovXG4gICAgZGlzcG9zZUZyYW1lYnVmZmVyKGZyYW1lYnVmZmVyOiBGcmFtZWJ1ZmZlciwgY29udGV4dExvc3Q/OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZmJvID0gZnJhbWVidWZmZXIuZ2xGcmFtZWJ1ZmZlcnNbdGhpcy5DT05URVhUX1VJRF07XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbDtcblxuICAgICAgICBpZiAoIWZibylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVsZXRlIGZyYW1lYnVmZmVyLmdsRnJhbWVidWZmZXJzW3RoaXMuQ09OVEVYVF9VSURdO1xuXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5tYW5hZ2VkRnJhbWVidWZmZXJzLmluZGV4T2YoZnJhbWVidWZmZXIpO1xuXG4gICAgICAgIGlmIChpbmRleCA+PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZWRGcmFtZWJ1ZmZlcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZyYW1lYnVmZmVyLmRpc3Bvc2VSdW5uZXIucmVtb3ZlKHRoaXMpO1xuXG4gICAgICAgIGlmICghY29udGV4dExvc3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmRlbGV0ZUZyYW1lYnVmZmVyKGZiby5mcmFtZWJ1ZmZlcik7XG5cbiAgICAgICAgICAgIGlmIChmYm8uc3RlbmNpbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC5kZWxldGVSZW5kZXJidWZmZXIoZmJvLnN0ZW5jaWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcG9zZXMgYWxsIGZyYW1lYnVmZmVycywgYnV0IG5vdCB0ZXh0dXJlcyBib3VuZCB0byB0aGVtXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbY29udGV4dExvc3Q9ZmFsc2VdIC0gSWYgY29udGV4dCB3YXMgbG9zdCwgd2Ugc3VwcHJlc3MgYWxsIGRlbGV0ZSBmdW5jdGlvbiBjYWxsc1xuICAgICAqL1xuICAgIGRpc3Bvc2VBbGwoY29udGV4dExvc3Q/OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMubWFuYWdlZEZyYW1lYnVmZmVycztcblxuICAgICAgICAodGhpcy5tYW5hZ2VkRnJhbWVidWZmZXJzIGFzIGFueSkgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZUZyYW1lYnVmZmVyKGxpc3RbaV0sIGNvbnRleHRMb3N0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcmNpbmcgY3JlYXRpb24gb2Ygc3RlbmNpbCBidWZmZXIgZm9yIGN1cnJlbnQgZnJhbWVidWZmZXIsIGlmIGl0IHdhc24ndCBkb25lIGJlZm9yZS5cbiAgICAgKiBVc2VkIGJ5IE1hc2tTeXN0ZW0sIHdoZW4gaXRzIHRpbWUgdG8gdXNlIHN0ZW5jaWwgbWFzayBmb3IgR3JhcGhpY3MgZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEl0cyBhbiBhbHRlcm5hdGl2ZSBmb3IgcHVibGljIGxhenkgYGZyYW1lYnVmZmVyLmVuYWJsZVN0ZW5jaWxgLCBpbiBjYXNlIHdlIG5lZWQgc3RlbmNpbCB3aXRob3V0IHJlYmluZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZm9yY2VTdGVuY2lsKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGZyYW1lYnVmZmVyID0gdGhpcy5jdXJyZW50O1xuXG4gICAgICAgIGlmICghZnJhbWVidWZmZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZibyA9IGZyYW1lYnVmZmVyLmdsRnJhbWVidWZmZXJzW3RoaXMuQ09OVEVYVF9VSURdO1xuXG4gICAgICAgIGlmICghZmJvIHx8IGZiby5zdGVuY2lsKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZnJhbWVidWZmZXIuZW5hYmxlU3RlbmNpbCgpO1xuXG4gICAgICAgIGNvbnN0IHcgPSBmcmFtZWJ1ZmZlci53aWR0aDtcbiAgICAgICAgY29uc3QgaCA9IGZyYW1lYnVmZmVyLmhlaWdodDtcbiAgICAgICAgY29uc3QgZ2wgPSB0aGlzLmdsO1xuICAgICAgICBjb25zdCBzdGVuY2lsID0gZ2wuY3JlYXRlUmVuZGVyYnVmZmVyKCk7XG5cbiAgICAgICAgZ2wuYmluZFJlbmRlcmJ1ZmZlcihnbC5SRU5ERVJCVUZGRVIsIHN0ZW5jaWwpO1xuICAgICAgICBnbC5yZW5kZXJidWZmZXJTdG9yYWdlKGdsLlJFTkRFUkJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTCwgdywgaCk7XG5cbiAgICAgICAgZmJvLnN0ZW5jaWwgPSBzdGVuY2lsO1xuICAgICAgICBnbC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgZ2wuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULCBnbC5SRU5ERVJCVUZGRVIsIHN0ZW5jaWwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlc2V0cyBmcmFtZWJ1ZmZlciBzdG9yZWQgc3RhdGUsIGJpbmRzIHNjcmVlbiBmcmFtZWJ1ZmZlclxuICAgICAqXG4gICAgICogc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgcmVuZGVyVGV4dHVyZSByZXNldCgpXG4gICAgICovXG4gICAgcmVzZXQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy51bmtub3duRnJhbWVidWZmZXI7XG4gICAgICAgIHRoaXMudmlld3BvcnQgPSBuZXcgUmVjdGFuZ2xlKCk7XG4gICAgfVxufVxuIiwgImV4cG9ydCBjbGFzcyBHTEJ1ZmZlclxue1xuICAgIGJ1ZmZlcjogV2ViR0xCdWZmZXI7XG4gICAgdXBkYXRlSUQ6IG51bWJlcjtcbiAgICBieXRlTGVuZ3RoOiBudW1iZXI7XG4gICAgcmVmQ291bnQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKGJ1ZmZlcj86IFdlYkdMQnVmZmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBidWZmZXIgfHwgbnVsbDtcbiAgICAgICAgdGhpcy51cGRhdGVJRCA9IC0xO1xuICAgICAgICB0aGlzLmJ5dGVMZW5ndGggPSAtMTtcbiAgICAgICAgdGhpcy5yZWZDb3VudCA9IDA7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBHTEJ1ZmZlciB9IGZyb20gJy4vR0xCdWZmZXInO1xuaW1wb3J0IHsgRU5WIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi4vc2V0dGluZ3MnO1xuXG5pbXBvcnQgdHlwZSB7IERSQVdfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgSVJlbmRlcmluZ0NvbnRleHQgfSBmcm9tICcuLi9JUmVuZGVyaW5nQ29udGV4dCc7XG5pbXBvcnQgdHlwZSB7IEdlb21ldHJ5IH0gZnJvbSAnLi9HZW9tZXRyeSc7XG5pbXBvcnQgdHlwZSB7IFNoYWRlciB9IGZyb20gJy4uL3NoYWRlci9TaGFkZXInO1xuaW1wb3J0IHR5cGUgeyBQcm9ncmFtIH0gZnJvbSAnLi4vc2hhZGVyL1Byb2dyYW0nO1xuaW1wb3J0IHR5cGUgeyBCdWZmZXIgfSBmcm9tICcuL0J1ZmZlcic7XG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmNvbnN0IGJ5dGVTaXplTWFwOiB7W2tleTogbnVtYmVyXTogbnVtYmVyfSA9IHsgNTEyNjogNCwgNTEyMzogMiwgNTEyMTogMSB9O1xuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSBnZW9tZXRyeS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCBjbGFzcyBHZW9tZXRyeVN5c3RlbSBleHRlbmRzIFN5c3RlbVxue1xuICAgIHB1YmxpYyBoYXNWYW86IGJvb2xlYW47XG4gICAgcHVibGljIGhhc0luc3RhbmNlOiBib29sZWFuO1xuICAgIHB1YmxpYyBjYW5Vc2VVSW50MzJFbGVtZW50SW5kZXg6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIENPTlRFWFRfVUlEOiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIGdsOiBJUmVuZGVyaW5nQ29udGV4dDtcbiAgICBwcm90ZWN0ZWQgX2FjdGl2ZUdlb21ldHJ5OiBHZW9tZXRyeTtcbiAgICBwcm90ZWN0ZWQgX2FjdGl2ZVZhbzogV2ViR0xWZXJ0ZXhBcnJheU9iamVjdDtcbiAgICBwcm90ZWN0ZWQgX2JvdW5kQnVmZmVyOiBHTEJ1ZmZlcjtcbiAgICByZWFkb25seSBtYW5hZ2VkR2VvbWV0cmllczoge1trZXk6IG51bWJlcl06IEdlb21ldHJ5fTtcbiAgICByZWFkb25seSBtYW5hZ2VkQnVmZmVyczoge1trZXk6IG51bWJlcl06IEJ1ZmZlcn07XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgU3lzdGVtIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgdGhpcy5fYWN0aXZlR2VvbWV0cnkgPSBudWxsO1xuICAgICAgICB0aGlzLl9hY3RpdmVWYW8gPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBgdHJ1ZWAgaWYgd2UgaGFzIGAqX3ZlcnRleF9hcnJheV9vYmplY3RgIGV4dGVuc2lvblxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFzVmFvID0gdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYHRydWVgIGlmIGhhcyBgQU5HTEVfaW5zdGFuY2VkX2FycmF5c2AgZXh0ZW5zaW9uXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oYXNJbnN0YW5jZSA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCBpZiBzdXBwb3J0IGBnbC5VTlNJR05FRF9JTlRgIGluIGBnbC5kcmF3RWxlbWVudHNgIG9yIGBnbC5kcmF3RWxlbWVudHNJbnN0YW5jZWRgXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jYW5Vc2VVSW50MzJFbGVtZW50SW5kZXggPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FjaGUgZm9yIGFsbCBnZW9tZXRyaWVzIGJ5IGlkLCB1c2VkIGluIGNhc2UgcmVuZGVyZXIgZ2V0cyBkZXN0cm95ZWQgb3IgZm9yIHByb2ZpbGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYW5hZ2VkR2VvbWV0cmllcyA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWNoZSBmb3IgYWxsIGJ1ZmZlcnMgYnkgaWQsIHVzZWQgaW4gY2FzZSByZW5kZXJlciBnZXRzIGRlc3Ryb3llZCBvciBmb3IgcHJvZmlsaW5nXG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hbmFnZWRCdWZmZXJzID0ge307XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB1cCB0aGUgcmVuZGVyZXIgY29udGV4dCBhbmQgbmVjZXNzYXJ5IGJ1ZmZlcnMuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNvbnRleHRDaGFuZ2UoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlQWxsKHRydWUpO1xuXG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbCA9IHRoaXMucmVuZGVyZXIuZ2w7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLnJlbmRlcmVyLmNvbnRleHQ7XG5cbiAgICAgICAgdGhpcy5DT05URVhUX1VJRCA9IHRoaXMucmVuZGVyZXIuQ09OVEVYVF9VSUQ7XG5cbiAgICAgICAgLy8gd2ViZ2wyXG4gICAgICAgIGlmIChjb250ZXh0LndlYkdMVmVyc2lvbiAhPT0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gd2ViZ2wgMSFcbiAgICAgICAgICAgIGxldCBuYXRpdmVWYW9FeHRlbnNpb24gPSB0aGlzLnJlbmRlcmVyLmNvbnRleHQuZXh0ZW5zaW9ucy52ZXJ0ZXhBcnJheU9iamVjdDtcblxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLlBSRUZFUl9FTlYgPT09IEVOVi5XRUJHTF9MRUdBQ1kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmFvRXh0ZW5zaW9uID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5hdGl2ZVZhb0V4dGVuc2lvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC5jcmVhdGVWZXJ0ZXhBcnJheSA9ICgpOiBXZWJHTFZlcnRleEFycmF5T2JqZWN0ID0+XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVZhb0V4dGVuc2lvbi5jcmVhdGVWZXJ0ZXhBcnJheU9FUygpO1xuXG4gICAgICAgICAgICAgICAgZ2wuYmluZFZlcnRleEFycmF5ID0gKHZhbyk6IHZvaWQgPT5cbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmFvRXh0ZW5zaW9uLmJpbmRWZXJ0ZXhBcnJheU9FUyh2YW8pO1xuXG4gICAgICAgICAgICAgICAgZ2wuZGVsZXRlVmVydGV4QXJyYXkgPSAodmFvKTogdm9pZCA9PlxuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWYW9FeHRlbnNpb24uZGVsZXRlVmVydGV4QXJyYXlPRVModmFvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc1ZhbyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGdsLmNyZWF0ZVZlcnRleEFycmF5ID0gKCk6IFdlYkdMVmVydGV4QXJyYXlPYmplY3QgPT5cbiAgICAgICAgICAgICAgICAgICAgbnVsbDtcblxuICAgICAgICAgICAgICAgIGdsLmJpbmRWZXJ0ZXhBcnJheSA9ICgpOiB2b2lkID0+XG4gICAgICAgICAgICAgICAgICAgIG51bGw7XG5cbiAgICAgICAgICAgICAgICBnbC5kZWxldGVWZXJ0ZXhBcnJheSA9ICgpOiB2b2lkID0+XG4gICAgICAgICAgICAgICAgICAgIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dC53ZWJHTFZlcnNpb24gIT09IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlRXh0ID0gZ2wuZ2V0RXh0ZW5zaW9uKCdBTkdMRV9pbnN0YW5jZWRfYXJyYXlzJyk7XG5cbiAgICAgICAgICAgIGlmIChpbnN0YW5jZUV4dClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC52ZXJ0ZXhBdHRyaWJEaXZpc29yID0gKGEsIGIpOiB2b2lkID0+XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlRXh0LnZlcnRleEF0dHJpYkRpdmlzb3JBTkdMRShhLCBiKTtcblxuICAgICAgICAgICAgICAgIGdsLmRyYXdFbGVtZW50c0luc3RhbmNlZCA9IChhLCBiLCBjLCBkLCBlKTogdm9pZCA9PlxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUV4dC5kcmF3RWxlbWVudHNJbnN0YW5jZWRBTkdMRShhLCBiLCBjLCBkLCBlKTtcblxuICAgICAgICAgICAgICAgIGdsLmRyYXdBcnJheXNJbnN0YW5jZWQgPSAoYSwgYiwgYywgZCk6IHZvaWQgPT5cbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VFeHQuZHJhd0FycmF5c0luc3RhbmNlZEFOR0xFKGEsIGIsIGMsIGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzSW5zdGFuY2UgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2FuVXNlVUludDMyRWxlbWVudEluZGV4ID0gY29udGV4dC53ZWJHTFZlcnNpb24gPT09IDIgfHwgISFjb250ZXh0LmV4dGVuc2lvbnMudWludDMyRWxlbWVudEluZGV4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJpbmRzIGdlb21ldHJ5IHNvIHRoYXQgaXMgY2FuIGJlIGRyYXduLiBDcmVhdGluZyBhIFZhbyBpZiByZXF1aXJlZFxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkdlb21ldHJ5fSBnZW9tZXRyeSAtIGluc3RhbmNlIG9mIGdlb21ldHJ5IHRvIGJpbmRcbiAgICAgKiBAcGFyYW0ge1BJWEkuU2hhZGVyfSBbc2hhZGVyXSAtIGluc3RhbmNlIG9mIHNoYWRlciB0byB1c2UgdmFvIGZvclxuICAgICAqL1xuICAgIGJpbmQoZ2VvbWV0cnk/OiBHZW9tZXRyeSwgc2hhZGVyPzogU2hhZGVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgc2hhZGVyID0gc2hhZGVyIHx8IHRoaXMucmVuZGVyZXIuc2hhZGVyLnNoYWRlcjtcblxuICAgICAgICBjb25zdCB7IGdsIH0gPSB0aGlzO1xuXG4gICAgICAgIC8vIG5vdCBzdXJlIHRoZSBiZXN0IHdheSB0byBhZGRyZXNzIHRoaXMuLlxuICAgICAgICAvLyBjdXJyZW50bHkgZGlmZmVyZW50IHNoYWRlcnMgcmVxdWlyZSBkaWZmZXJlbnQgVkFPcyBmb3IgdGhlIHNhbWUgZ2VvbWV0cnlcbiAgICAgICAgLy8gU3RpbGwgbXVsbGluZyBvdmVyIHRoZSBiZXN0IHdheSB0byBzb2x2ZSB0aGlzIG9uZS4uXG4gICAgICAgIC8vIHdpbGwgbGlrZWx5IG5lZWQgdG8gbW9kaWZ5IHRoZSBzaGFkZXIgYXR0cmlidXRlIGxvY2F0aW9ucyBhdCBydW4gdGltZSFcbiAgICAgICAgbGV0IHZhb3MgPSBnZW9tZXRyeS5nbFZlcnRleEFycmF5T2JqZWN0c1t0aGlzLkNPTlRFWFRfVUlEXTtcbiAgICAgICAgbGV0IGluY1JlZkNvdW50ID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKCF2YW9zKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZWRHZW9tZXRyaWVzW2dlb21ldHJ5LmlkXSA9IGdlb21ldHJ5O1xuICAgICAgICAgICAgZ2VvbWV0cnkuZGlzcG9zZVJ1bm5lci5hZGQodGhpcyk7XG4gICAgICAgICAgICBnZW9tZXRyeS5nbFZlcnRleEFycmF5T2JqZWN0c1t0aGlzLkNPTlRFWFRfVUlEXSA9IHZhb3MgPSB7fTtcbiAgICAgICAgICAgIGluY1JlZkNvdW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbyA9IHZhb3Nbc2hhZGVyLnByb2dyYW0uaWRdIHx8IHRoaXMuaW5pdEdlb21ldHJ5VmFvKGdlb21ldHJ5LCBzaGFkZXIucHJvZ3JhbSwgaW5jUmVmQ291bnQpO1xuXG4gICAgICAgIHRoaXMuX2FjdGl2ZUdlb21ldHJ5ID0gZ2VvbWV0cnk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2FjdGl2ZVZhbyAhPT0gdmFvKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hY3RpdmVWYW8gPSB2YW87XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmhhc1ZhbylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC5iaW5kVmVydGV4QXJyYXkodmFvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2YXRlVmFvKGdlb21ldHJ5LCBzaGFkZXIucHJvZ3JhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPIC0gb3B0aW1pc2UgbGF0ZXIhXG4gICAgICAgIC8vIGRvbid0IG5lZWQgdG8gbG9vcCB0aHJvdWdoIGlmIG5vdGhpbmcgY2hhbmdlZCFcbiAgICAgICAgLy8gbWF5YmUgbG9vayB0byBhZGQgYW4gJ2F1dG91cGRhdGUnIHRvIGdlb21ldHJ5P1xuICAgICAgICB0aGlzLnVwZGF0ZUJ1ZmZlcnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldCBhbmQgdW5iaW5kIGFueSBhY3RpdmUgVkFPIGFuZCBnZW9tZXRyeVxuICAgICAqL1xuICAgIHJlc2V0KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGJ1ZmZlcnNcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgdXBkYXRlQnVmZmVycygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuX2FjdGl2ZUdlb21ldHJ5O1xuICAgICAgICBjb25zdCB7IGdsIH0gPSB0aGlzO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2VvbWV0cnkuYnVmZmVycy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gZ2VvbWV0cnkuYnVmZmVyc1tpXTtcblxuICAgICAgICAgICAgY29uc3QgZ2xCdWZmZXIgPSBidWZmZXIuX2dsQnVmZmVyc1t0aGlzLkNPTlRFWFRfVUlEXTtcblxuICAgICAgICAgICAgaWYgKGJ1ZmZlci5fdXBkYXRlSUQgIT09IGdsQnVmZmVyLnVwZGF0ZUlEKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGdsQnVmZmVyLnVwZGF0ZUlEID0gYnVmZmVyLl91cGRhdGVJRDtcblxuICAgICAgICAgICAgICAgIC8vIFRPRE8gY2FuIGNhY2hlIHRoaXMgb24gYnVmZmVyISBtYXliZSBhZGRlZCBhIGdldHRlciAvIHNldHRlcj9cbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gYnVmZmVyLmluZGV4ID8gZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIgOiBnbC5BUlJBWV9CVUZGRVI7XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPIHRoaXMgY291bGQgY2hhbmdlIGlmIHRoZSBWQU8gY2hhbmdlcy4uLlxuICAgICAgICAgICAgICAgIC8vIG5lZWQgdG8gY29tZSB1cCB3aXRoIGEgYmV0dGVyIHdheSB0byBjYWNoZS4uXG4gICAgICAgICAgICAgICAgLy8gaWYgKHRoaXMuYm91bmRCdWZmZXJzW3R5cGVdICE9PSBnbEJ1ZmZlcilcbiAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5ib3VuZEJ1ZmZlcnNbdHlwZV0gPSBnbEJ1ZmZlcjtcbiAgICAgICAgICAgICAgICBnbC5iaW5kQnVmZmVyKHR5cGUsIGdsQnVmZmVyLmJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRCdWZmZXIgPSBnbEJ1ZmZlcjtcblxuICAgICAgICAgICAgICAgIGlmIChnbEJ1ZmZlci5ieXRlTGVuZ3RoID49IGJ1ZmZlci5kYXRhLmJ5dGVMZW5ndGgpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyBvZmZzZXQgaXMgYWx3YXlzIHplcm8gZm9yIG5vdyFcbiAgICAgICAgICAgICAgICAgICAgZ2wuYnVmZmVyU3ViRGF0YSh0eXBlLCAwLCBidWZmZXIuZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRyYXdUeXBlID0gYnVmZmVyLnN0YXRpYyA/IGdsLlNUQVRJQ19EUkFXIDogZ2wuRFlOQU1JQ19EUkFXO1xuXG4gICAgICAgICAgICAgICAgICAgIGdsQnVmZmVyLmJ5dGVMZW5ndGggPSBidWZmZXIuZGF0YS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBnbC5idWZmZXJEYXRhKHR5cGUsIGJ1ZmZlci5kYXRhLCBkcmF3VHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgY29tcGFiaWxpdHkgYmV0d2VlbiBhIGdlb21ldHJ5IGFuZCBhIHByb2dyYW1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLkdlb21ldHJ5fSBnZW9tZXRyeSAtIEdlb21ldHJ5IGluc3RhbmNlXG4gICAgICogQHBhcmFtIHtQSVhJLlByb2dyYW19IHByb2dyYW0gLSBQcm9ncmFtIGluc3RhbmNlXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNoZWNrQ29tcGF0aWJpbGl0eShnZW9tZXRyeTogR2VvbWV0cnksIHByb2dyYW06IFByb2dyYW0pOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBnZW9tZXRyeSBtdXN0IGhhdmUgYXQgbGVhc3QgYWxsIHRoZSBhdHRyaWJ1dGVzIHRoYXQgdGhlIHNoYWRlciByZXF1aXJlcy5cbiAgICAgICAgY29uc3QgZ2VvbWV0cnlBdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlcztcbiAgICAgICAgY29uc3Qgc2hhZGVyQXR0cmlidXRlcyA9IHByb2dyYW0uYXR0cmlidXRlRGF0YTtcblxuICAgICAgICBmb3IgKGNvbnN0IGogaW4gc2hhZGVyQXR0cmlidXRlcylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFnZW9tZXRyeUF0dHJpYnV0ZXNbal0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaGFkZXIgYW5kIGdlb21ldHJ5IGluY29tcGF0aWJsZSwgZ2VvbWV0cnkgbWlzc2luZyB0aGUgXCIke2p9XCIgYXR0cmlidXRlYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIGdlb21ldHJ5IGFuZCBwcm9ncmFtIGFuZCBnZW5lcmF0ZXMgYSB1bmlxdWUgc2lnbmF0dXJlIGZvciB0aGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkdlb21ldHJ5fSBnZW9tZXRyeSAtIHRvIGdldCBzaWduYXR1cmUgZnJvbVxuICAgICAqIEBwYXJhbSB7UElYSS5Qcm9ncmFtfSBwcm9ncmFtIC0gdG8gdGVzdCBnZW9tZXRyeSBhZ2FpbnN0XG4gICAgICogQHJldHVybnMge1N0cmluZ30gVW5pcXVlIHNpZ25hdHVyZSBvZiB0aGUgZ2VvbWV0cnkgYW5kIHByb2dyYW1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGdldFNpZ25hdHVyZShnZW9tZXRyeTogR2VvbWV0cnksIHByb2dyYW06IFByb2dyYW0pOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuICAgICAgICBjb25zdCBzaGFkZXJBdHRyaWJ1dGVzID0gcHJvZ3JhbS5hdHRyaWJ1dGVEYXRhO1xuXG4gICAgICAgIGNvbnN0IHN0cmluZ3MgPSBbJ2cnLCBnZW9tZXRyeS5pZF07XG5cbiAgICAgICAgZm9yIChjb25zdCBpIGluIGF0dHJpYnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChzaGFkZXJBdHRyaWJ1dGVzW2ldKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0cmluZ3MucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdHJpbmdzLmpvaW4oJy0nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIG9yIGdldHMgVmFvIHdpdGggdGhlIHNhbWUgc3RydWN0dXJlIGFzIHRoZSBnZW9tZXRyeSBhbmQgc3RvcmVzIGl0IG9uIHRoZSBnZW9tZXRyeS5cbiAgICAgKiBJZiB2YW8gaXMgY3JlYXRlZCwgaXQgaXMgYm91bmQgYXV0b21hdGljYWxseS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuR2VvbWV0cnl9IGdlb21ldHJ5IC0gSW5zdGFuY2Ugb2YgZ2VvbWV0cnkgdG8gdG8gZ2VuZXJhdGUgVmFvIGZvclxuICAgICAqIEBwYXJhbSB7UElYSS5Qcm9ncmFtfSBwcm9ncmFtIC0gSW5zdGFuY2Ugb2YgcHJvZ3JhbVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2luY1JlZkNvdW50PWZhbHNlXSAtIEluY3JlbWVudCByZWZDb3VudCBvZiBhbGwgZ2VvbWV0cnkgYnVmZmVyc1xuICAgICAqL1xuICAgIHByb3RlY3RlZCBpbml0R2VvbWV0cnlWYW8oZ2VvbWV0cnk6IEdlb21ldHJ5LCBwcm9ncmFtOiBQcm9ncmFtLCBpbmNSZWZDb3VudCA9IHRydWUpOiBXZWJHTFZlcnRleEFycmF5T2JqZWN0XG4gICAge1xuICAgICAgICB0aGlzLmNoZWNrQ29tcGF0aWJpbGl0eShnZW9tZXRyeSwgcHJvZ3JhbSk7XG5cbiAgICAgICAgY29uc3QgZ2wgPSB0aGlzLmdsO1xuICAgICAgICBjb25zdCBDT05URVhUX1VJRCA9IHRoaXMuQ09OVEVYVF9VSUQ7XG5cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gdGhpcy5nZXRTaWduYXR1cmUoZ2VvbWV0cnksIHByb2dyYW0pO1xuXG4gICAgICAgIGNvbnN0IHZhb09iamVjdEhhc2ggPSBnZW9tZXRyeS5nbFZlcnRleEFycmF5T2JqZWN0c1t0aGlzLkNPTlRFWFRfVUlEXTtcblxuICAgICAgICBsZXQgdmFvID0gdmFvT2JqZWN0SGFzaFtzaWduYXR1cmVdO1xuXG4gICAgICAgIGlmICh2YW8pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBnaXZlIHVzIGVhc3kgYWNjZXNzIHRvIHRoZSB2YW9cbiAgICAgICAgICAgIHZhb09iamVjdEhhc2hbcHJvZ3JhbS5pZF0gPSB2YW87XG5cbiAgICAgICAgICAgIHJldHVybiB2YW87XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBidWZmZXJzID0gZ2VvbWV0cnkuYnVmZmVycztcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGdlb21ldHJ5LmF0dHJpYnV0ZXM7XG4gICAgICAgIGNvbnN0IHRlbXBTdHJpZGU6IERpY3Q8bnVtYmVyPiA9IHt9O1xuICAgICAgICBjb25zdCB0ZW1wU3RhcnQ6IERpY3Q8bnVtYmVyPiA9IHt9O1xuXG4gICAgICAgIGZvciAoY29uc3QgaiBpbiBidWZmZXJzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wU3RyaWRlW2pdID0gMDtcbiAgICAgICAgICAgIHRlbXBTdGFydFtqXSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGogaW4gYXR0cmlidXRlcylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2pdLnNpemUgJiYgcHJvZ3JhbS5hdHRyaWJ1dGVEYXRhW2pdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNbal0uc2l6ZSA9IHByb2dyYW0uYXR0cmlidXRlRGF0YVtqXS5zaXplO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWF0dHJpYnV0ZXNbal0uc2l6ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFBJWEkgR2VvbWV0cnkgYXR0cmlidXRlICcke2p9JyBzaXplIGNhbm5vdCBiZSBkZXRlcm1pbmVkIChsaWtlbHkgdGhlIGJvdW5kIHNoYWRlciBkb2VzIG5vdCBoYXZlIHRoZSBhdHRyaWJ1dGUpYCk7ICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRlbXBTdHJpZGVbYXR0cmlidXRlc1tqXS5idWZmZXJdICs9IGF0dHJpYnV0ZXNbal0uc2l6ZSAqIGJ5dGVTaXplTWFwW2F0dHJpYnV0ZXNbal0udHlwZV07XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGogaW4gYXR0cmlidXRlcylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYlNpemUgPSBhdHRyaWJ1dGUuc2l6ZTtcblxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5zdHJpZGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodGVtcFN0cmlkZVthdHRyaWJ1dGUuYnVmZmVyXSA9PT0gYXR0cmliU2l6ZSAqIGJ5dGVTaXplTWFwW2F0dHJpYnV0ZS50eXBlXSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5zdHJpZGUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuc3RyaWRlID0gdGVtcFN0cmlkZVthdHRyaWJ1dGUuYnVmZmVyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuc3RhcnQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuc3RhcnQgPSB0ZW1wU3RhcnRbYXR0cmlidXRlLmJ1ZmZlcl07XG5cbiAgICAgICAgICAgICAgICB0ZW1wU3RhcnRbYXR0cmlidXRlLmJ1ZmZlcl0gKz0gYXR0cmliU2l6ZSAqIGJ5dGVTaXplTWFwW2F0dHJpYnV0ZS50eXBlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhbyA9IGdsLmNyZWF0ZVZlcnRleEFycmF5KCk7XG5cbiAgICAgICAgZ2wuYmluZFZlcnRleEFycmF5KHZhbyk7XG5cbiAgICAgICAgLy8gZmlyc3QgdXBkYXRlIC0gYW5kIGNyZWF0ZSB0aGUgYnVmZmVycyFcbiAgICAgICAgLy8gb25seSBjcmVhdGUgYSBnbCBidWZmZXIgaWYgaXQgYWN0dWFsbHkgZ2V0c1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlcnMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGJ1ZmZlcnNbaV07XG5cbiAgICAgICAgICAgIGlmICghYnVmZmVyLl9nbEJ1ZmZlcnNbQ09OVEVYVF9VSURdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJ1ZmZlci5fZ2xCdWZmZXJzW0NPTlRFWFRfVUlEXSA9IG5ldyBHTEJ1ZmZlcihnbC5jcmVhdGVCdWZmZXIoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYW5hZ2VkQnVmZmVyc1tidWZmZXIuaWRdID0gYnVmZmVyO1xuICAgICAgICAgICAgICAgIGJ1ZmZlci5kaXNwb3NlUnVubmVyLmFkZCh0aGlzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGluY1JlZkNvdW50KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJ1ZmZlci5fZ2xCdWZmZXJzW0NPTlRFWFRfVUlEXS5yZWZDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETyAtIG1heWJlIG1ha2UgdGhpcyBhIGRhdGEgb2JqZWN0P1xuICAgICAgICAvLyBsZXRzIHdhaXQgdG8gc2VlIGlmIHdlIG5lZWQgdG8gZmlyc3QhXG5cbiAgICAgICAgdGhpcy5hY3RpdmF0ZVZhbyhnZW9tZXRyeSwgcHJvZ3JhbSk7XG5cbiAgICAgICAgdGhpcy5fYWN0aXZlVmFvID0gdmFvO1xuXG4gICAgICAgIC8vIGFkZCBpdCB0byB0aGUgY2FjaGUhXG4gICAgICAgIHZhb09iamVjdEhhc2hbcHJvZ3JhbS5pZF0gPSB2YW87XG4gICAgICAgIHZhb09iamVjdEhhc2hbc2lnbmF0dXJlXSA9IHZhbztcblxuICAgICAgICByZXR1cm4gdmFvO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7UElYSS5CdWZmZXJ9IGJ1ZmZlciAtIGJ1ZmZlciB3aXRoIGRhdGFcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtjb250ZXh0TG9zdD1mYWxzZV0gLSBJZiBjb250ZXh0IHdhcyBsb3N0LCB3ZSBzdXBwcmVzcyBkZWxldGVWZXJ0ZXhBcnJheVxuICAgICAqL1xuICAgIGRpc3Bvc2VCdWZmZXIoYnVmZmVyOiBCdWZmZXIsIGNvbnRleHRMb3N0PzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5tYW5hZ2VkQnVmZmVyc1tidWZmZXIuaWRdKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VkQnVmZmVyc1tidWZmZXIuaWRdO1xuXG4gICAgICAgIGNvbnN0IGdsQnVmZmVyID0gYnVmZmVyLl9nbEJ1ZmZlcnNbdGhpcy5DT05URVhUX1VJRF07XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbDtcblxuICAgICAgICBidWZmZXIuZGlzcG9zZVJ1bm5lci5yZW1vdmUodGhpcyk7XG5cbiAgICAgICAgaWYgKCFnbEJ1ZmZlcilcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjb250ZXh0TG9zdClcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wuZGVsZXRlQnVmZmVyKGdsQnVmZmVyLmJ1ZmZlcik7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgYnVmZmVyLl9nbEJ1ZmZlcnNbdGhpcy5DT05URVhUX1VJRF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcG9zZXMgZ2VvbWV0cnlcbiAgICAgKiBAcGFyYW0ge1BJWEkuR2VvbWV0cnl9IGdlb21ldHJ5IC0gR2VvbWV0cnkgd2l0aCBidWZmZXJzLiBPbmx5IFZBTyB3aWxsIGJlIGRpc3Bvc2VkXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbY29udGV4dExvc3Q9ZmFsc2VdIC0gSWYgY29udGV4dCB3YXMgbG9zdCwgd2Ugc3VwcHJlc3MgZGVsZXRlVmVydGV4QXJyYXlcbiAgICAgKi9cbiAgICBkaXNwb3NlR2VvbWV0cnkoZ2VvbWV0cnk6IEdlb21ldHJ5LCBjb250ZXh0TG9zdD86IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMubWFuYWdlZEdlb21ldHJpZXNbZ2VvbWV0cnkuaWRdKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VkR2VvbWV0cmllc1tnZW9tZXRyeS5pZF07XG5cbiAgICAgICAgY29uc3QgdmFvcyA9IGdlb21ldHJ5LmdsVmVydGV4QXJyYXlPYmplY3RzW3RoaXMuQ09OVEVYVF9VSURdO1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuZ2w7XG4gICAgICAgIGNvbnN0IGJ1ZmZlcnMgPSBnZW9tZXRyeS5idWZmZXJzO1xuXG4gICAgICAgIGdlb21ldHJ5LmRpc3Bvc2VSdW5uZXIucmVtb3ZlKHRoaXMpO1xuXG4gICAgICAgIGlmICghdmFvcylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBidWYgPSBidWZmZXJzW2ldLl9nbEJ1ZmZlcnNbdGhpcy5DT05URVhUX1VJRF07XG5cbiAgICAgICAgICAgIGJ1Zi5yZWZDb3VudC0tO1xuICAgICAgICAgICAgaWYgKGJ1Zi5yZWZDb3VudCA9PT0gMCAmJiAhY29udGV4dExvc3QpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwb3NlQnVmZmVyKGJ1ZmZlcnNbaV0sIGNvbnRleHRMb3N0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY29udGV4dExvc3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdmFvSWQgaW4gdmFvcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgb25seSBzaWduYXR1cmVzLCBldmVyeXRoaW5nIGVsc2UgYXJlIGNvcGllc1xuICAgICAgICAgICAgICAgIGlmICh2YW9JZFswXSA9PT0gJ2cnKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFvID0gdmFvc1t2YW9JZF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGl2ZVZhbyA9PT0gdmFvKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdsLmRlbGV0ZVZlcnRleEFycmF5KHZhbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZGVsZXRlIGdlb21ldHJ5LmdsVmVydGV4QXJyYXlPYmplY3RzW3RoaXMuQ09OVEVYVF9VSURdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGRpc3Bvc2UgYWxsIFdlYkdMIHJlc291cmNlcyBvZiBhbGwgbWFuYWdlZCBnZW9tZXRyaWVzIGFuZCBidWZmZXJzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbY29udGV4dExvc3Q9ZmFsc2VdIC0gSWYgY29udGV4dCB3YXMgbG9zdCwgd2Ugc3VwcHJlc3MgYGdsLmRlbGV0ZWAgY2FsbHNcbiAgICAgKi9cbiAgICBkaXNwb3NlQWxsKGNvbnRleHRMb3N0PzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCBhbGw6IEFycmF5PGFueT4gPSBPYmplY3Qua2V5cyh0aGlzLm1hbmFnZWRHZW9tZXRyaWVzKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbC5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5kaXNwb3NlR2VvbWV0cnkodGhpcy5tYW5hZ2VkR2VvbWV0cmllc1thbGxbaV1dLCBjb250ZXh0TG9zdCk7XG4gICAgICAgIH1cbiAgICAgICAgYWxsID0gT2JqZWN0LmtleXModGhpcy5tYW5hZ2VkQnVmZmVycyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRpc3Bvc2VCdWZmZXIodGhpcy5tYW5hZ2VkQnVmZmVyc1thbGxbaV1dLCBjb250ZXh0TG9zdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBY3RpdmF0ZSB2ZXJ0ZXggYXJyYXkgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLkdlb21ldHJ5fSBnZW9tZXRyeSAtIEdlb21ldHJ5IGluc3RhbmNlXG4gICAgICogQHBhcmFtIHtQSVhJLlByb2dyYW19IHByb2dyYW0gLSBTaGFkZXIgcHJvZ3JhbSBpbnN0YW5jZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhY3RpdmF0ZVZhbyhnZW9tZXRyeTogR2VvbWV0cnksIHByb2dyYW06IFByb2dyYW0pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuZ2w7XG4gICAgICAgIGNvbnN0IENPTlRFWFRfVUlEID0gdGhpcy5DT05URVhUX1VJRDtcbiAgICAgICAgY29uc3QgYnVmZmVycyA9IGdlb21ldHJ5LmJ1ZmZlcnM7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuXG4gICAgICAgIGlmIChnZW9tZXRyeS5pbmRleEJ1ZmZlcilcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gZmlyc3QgdXBkYXRlIHRoZSBpbmRleCBidWZmZXIgaWYgd2UgaGF2ZSBvbmUuLlxuICAgICAgICAgICAgZ2wuYmluZEJ1ZmZlcihnbC5FTEVNRU5UX0FSUkFZX0JVRkZFUiwgZ2VvbWV0cnkuaW5kZXhCdWZmZXIuX2dsQnVmZmVyc1tDT05URVhUX1VJRF0uYnVmZmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBsYXN0QnVmZmVyID0gbnVsbDtcblxuICAgICAgICAvLyBhZGQgYSBuZXcgb25lIVxuICAgICAgICBmb3IgKGNvbnN0IGogaW4gYXR0cmlidXRlcylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGJ1ZmZlcnNbYXR0cmlidXRlLmJ1ZmZlcl07XG4gICAgICAgICAgICBjb25zdCBnbEJ1ZmZlciA9IGJ1ZmZlci5fZ2xCdWZmZXJzW0NPTlRFWFRfVUlEXTtcblxuICAgICAgICAgICAgaWYgKHByb2dyYW0uYXR0cmlidXRlRGF0YVtqXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAobGFzdEJ1ZmZlciAhPT0gZ2xCdWZmZXIpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgZ2xCdWZmZXIuYnVmZmVyKTtcblxuICAgICAgICAgICAgICAgICAgICBsYXN0QnVmZmVyID0gZ2xCdWZmZXI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBwcm9ncmFtLmF0dHJpYnV0ZURhdGFbal0ubG9jYXRpb247XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPIGludHJvZHVjZSBzdGF0ZSBhZ2FpblxuICAgICAgICAgICAgICAgIC8vIHdlIGNhbiBvcHRpbWlzZSB0aGlzIGZvciBvbGRlciBkZXZpY2VzIHRoYXQgaGF2ZSBubyBWQU9zXG4gICAgICAgICAgICAgICAgZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkobG9jYXRpb24pO1xuXG4gICAgICAgICAgICAgICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihsb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLnNpemUsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS50eXBlIHx8IGdsLkZMT0FULFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUubm9ybWFsaXplZCxcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLnN0cmlkZSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLnN0YXJ0KTtcblxuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuaW5zdGFuY2UpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIGNhbGN1bGF0ZSBpbnN0YW5jZSBjb3VudCBiYXNlZCBvZiB0aGlzLi4uXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0luc3RhbmNlKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnbC52ZXJ0ZXhBdHRyaWJEaXZpc29yKGxvY2F0aW9uLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZ2VvbWV0cnkgZXJyb3IsIEdQVSBJbnN0YW5jaW5nIGlzIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBkZXZpY2UnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERyYXcgdGhlIGdlb21ldHJ5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gdHlwZSAtIHRoZSB0eXBlIHByaW1pdGl2ZSB0byByZW5kZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3NpemVdIC0gdGhlIG51bWJlciBvZiBlbGVtZW50cyB0byBiZSByZW5kZXJlZFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbc3RhcnRdIC0gU3RhcnRpbmcgaW5kZXhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2luc3RhbmNlQ291bnRdIC0gdGhlIG51bWJlciBvZiBpbnN0YW5jZXMgb2YgdGhlIHNldCBvZiBlbGVtZW50cyB0byBleGVjdXRlXG4gICAgICovXG4gICAgZHJhdyh0eXBlOiBEUkFXX01PREVTLCBzaXplPzogbnVtYmVyLCBzdGFydD86IG51bWJlciwgaW5zdGFuY2VDb3VudD86IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5fYWN0aXZlR2VvbWV0cnk7XG5cbiAgICAgICAgLy8gVE9ETy4uIHRoaXMgc2hvdWxkIG5vdCBjaGFuZ2Ugc28gbWF5YmUgY2FjaGUgdGhlIGZ1bmN0aW9uP1xuXG4gICAgICAgIGlmIChnZW9tZXRyeS5pbmRleEJ1ZmZlcilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYnl0ZVNpemUgPSBnZW9tZXRyeS5pbmRleEJ1ZmZlci5kYXRhLkJZVEVTX1BFUl9FTEVNRU5UO1xuICAgICAgICAgICAgY29uc3QgZ2xUeXBlID0gYnl0ZVNpemUgPT09IDIgPyBnbC5VTlNJR05FRF9TSE9SVCA6IGdsLlVOU0lHTkVEX0lOVDtcblxuICAgICAgICAgICAgaWYgKGJ5dGVTaXplID09PSAyIHx8IChieXRlU2l6ZSA9PT0gNCAmJiB0aGlzLmNhblVzZVVJbnQzMkVsZW1lbnRJbmRleCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGdlb21ldHJ5Lmluc3RhbmNlZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cbiAgICAgICAgICAgICAgICAgICAgZ2wuZHJhd0VsZW1lbnRzSW5zdGFuY2VkKHR5cGUsIHNpemUgfHwgZ2VvbWV0cnkuaW5kZXhCdWZmZXIuZGF0YS5sZW5ndGgsIGdsVHlwZSwgKHN0YXJ0IHx8IDApICogYnl0ZVNpemUsIGluc3RhbmNlQ291bnQgfHwgMSk7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgbWF4LWxlbiAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG4gICAgICAgICAgICAgICAgICAgIGdsLmRyYXdFbGVtZW50cyh0eXBlLCBzaXplIHx8IGdlb21ldHJ5LmluZGV4QnVmZmVyLmRhdGEubGVuZ3RoLCBnbFR5cGUsIChzdGFydCB8fCAwKSAqIGJ5dGVTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBtYXgtbGVuICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybigndW5zdXBwb3J0ZWQgaW5kZXggYnVmZmVyIHR5cGU6IHVpbnQzMicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdlb21ldHJ5Lmluc3RhbmNlZClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETyBuZWVkIGEgYmV0dGVyIHdheSB0byBjYWxjdWxhdGUgc2l6ZS4uXG4gICAgICAgICAgICBnbC5kcmF3QXJyYXlzSW5zdGFuY2VkKHR5cGUsIHN0YXJ0LCBzaXplIHx8IGdlb21ldHJ5LmdldFNpemUoKSwgaW5zdGFuY2VDb3VudCB8fCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmRyYXdBcnJheXModHlwZSwgc3RhcnQsIHNpemUgfHwgZ2VvbWV0cnkuZ2V0U2l6ZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVuYmluZC9yZXNldCBldmVyeXRoaW5nXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCB1bmJpbmQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5nbC5iaW5kVmVydGV4QXJyYXkobnVsbCk7XG4gICAgICAgIHRoaXMuX2FjdGl2ZVZhbyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2FjdGl2ZUdlb21ldHJ5ID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgTUFTS19UWVBFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbmltcG9ydCB0eXBlIHsgUmVjdGFuZ2xlLCBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgSUZpbHRlclRhcmdldCB9IGZyb20gJy4uL2ZpbHRlcnMvSUZpbHRlclRhcmdldCc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElNYXNrVGFyZ2V0IGV4dGVuZHMgSUZpbHRlclRhcmdldFxue1xuICAgIHJlbmRlcmFibGU6IGJvb2xlYW47XG4gICAgaXNTcHJpdGU/OiBib29sZWFuO1xuICAgIHdvcmxkVHJhbnNmb3JtOiBNYXRyaXg7XG4gICAgaXNGYXN0UmVjdD8oKTogYm9vbGVhbjtcbiAgICBnZXRCb3VuZHMoc2tpcFVwZGF0ZT86IGJvb2xlYW4pOiBSZWN0YW5nbGU7XG4gICAgcmVuZGVyKHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWQ7XG59XG4vKipcbiAqIENvbXBvbmVudCBmb3IgbWFza2VkIGVsZW1lbnRzXG4gKlxuICogSG9sZHMgbWFzayBtb2RlIGFuZCB0ZW1wb3JhcnkgZGF0YSBhYm91dCBjdXJyZW50IG1hc2tcbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBNYXNrRGF0YVxue1xuICAgIHB1YmxpYyB0eXBlOiBNQVNLX1RZUEVTO1xuICAgIHB1YmxpYyBhdXRvRGV0ZWN0OiBib29sZWFuO1xuICAgIHB1YmxpYyBtYXNrT2JqZWN0OiBJTWFza1RhcmdldDtcbiAgICBwdWJsaWMgcG9vbGVkOiBib29sZWFuO1xuICAgIHB1YmxpYyBpc01hc2tEYXRhOiB0cnVlO1xuICAgIF9zdGVuY2lsQ291bnRlcjogbnVtYmVyO1xuICAgIF9zY2lzc29yQ291bnRlcjogbnVtYmVyO1xuICAgIF9zY2lzc29yUmVjdDogUmVjdGFuZ2xlO1xuICAgIF90YXJnZXQ6IElNYXNrVGFyZ2V0O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIE1hc2tEYXRhXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gW21hc2tPYmplY3Q9bnVsbF0gLSBvYmplY3QgdGhhdCBkZXNjcmliZXMgdGhlIG1hc2tcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihtYXNrT2JqZWN0OiBJTWFza1RhcmdldCA9IG51bGwpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFzayB0eXBlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuTUFTS19UWVBFU31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IE1BU0tfVFlQRVMuTk9ORTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB3ZSBrbm93IHRoZSBtYXNrIHR5cGUgYmVmb3JlaGFuZFxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1dG9EZXRlY3QgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGljaCBlbGVtZW50IHdlIHVzZSB0byBtYXNrXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRGlzcGxheU9iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWFza09iamVjdCA9IG1hc2tPYmplY3QgfHwgbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCBiZWxvbmdzIHRvIE1hc2tTeXN0ZW0gcG9vbFxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wb29sZWQgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5kaWNhdG9yIG9mIHRoZSB0eXBlXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlzTWFza0RhdGEgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdGVuY2lsIGNvdW50ZXIgYWJvdmUgdGhlIG1hc2sgaW4gc3RhY2tcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc3RlbmNpbENvdW50ZXIgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2Npc3NvciBjb3VudGVyIGFib3ZlIHRoZSBtYXNrIGluIHN0YWNrXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3NjaXNzb3JDb3VudGVyID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2Npc3NvciBvcGVyYXRpb24gYWJvdmUgdGhlIG1hc2sgaW4gc3RhY2suXG4gICAgICAgICAqIE51bGwgaWYgX3NjaXNzb3JDb3VudGVyIGlzIHplcm8sIHJlY3RhbmdsZSBpbnN0YW5jZSBpZiBwb3NpdGl2ZS5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9zY2lzc29yUmVjdCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRhcmdldGVkIGVsZW1lbnQuIFRlbXBvcmFyeSB2YXJpYWJsZSBzZXQgYnkgTWFza1N5c3RlbVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkRpc3BsYXlPYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90YXJnZXQgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlc2V0cyB0aGUgbWFzayBkYXRhIGFmdGVyIHBvcE1hc2soKVxuICAgICAqL1xuICAgIHJlc2V0KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLnBvb2xlZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5tYXNrT2JqZWN0ID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy50eXBlID0gTUFTS19UWVBFUy5OT05FO1xuXG4gICAgICAgICAgICB0aGlzLmF1dG9EZXRlY3QgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb3BpZXMgY291bnRlcnMgZnJvbSBtYXNrRGF0YSBhYm92ZSwgY2FsbGVkIGZyb20gcHVzaE1hc2soKVxuICAgICAqIEBwYXJhbSB7UElYSS5NYXNrRGF0YXxudWxsfSBtYXNrQWJvdmVcbiAgICAgKi9cbiAgICBjb3B5Q291bnRlcnNPclJlc2V0KG1hc2tBYm92ZT86IE1hc2tEYXRhKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKG1hc2tBYm92ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fc3RlbmNpbENvdW50ZXIgPSBtYXNrQWJvdmUuX3N0ZW5jaWxDb3VudGVyO1xuICAgICAgICAgICAgdGhpcy5fc2Npc3NvckNvdW50ZXIgPSBtYXNrQWJvdmUuX3NjaXNzb3JDb3VudGVyO1xuICAgICAgICAgICAgdGhpcy5fc2Npc3NvclJlY3QgPSBtYXNrQWJvdmUuX3NjaXNzb3JSZWN0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fc3RlbmNpbENvdW50ZXIgPSAwO1xuICAgICAgICAgICAgdGhpcy5fc2Npc3NvckNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgdGhpcy5fc2Npc3NvclJlY3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIGdsIHtXZWJHTFJlbmRlcmluZ0NvbnRleHR9IFRoZSBjdXJyZW50IFdlYkdMIGNvbnRleHQge1dlYkdMUHJvZ3JhbX1cbiAqIEBwYXJhbSB0eXBlIHtOdW1iZXJ9IHRoZSB0eXBlLCBjYW4gYmUgZWl0aGVyIFZFUlRFWF9TSEFERVIgb3IgRlJBR01FTlRfU0hBREVSXG4gKiBAcGFyYW0gc3JjIHtzdHJpbmd9IFRoZSB2ZXJ0ZXggc2hhZGVyIHNvdXJjZSBhcyBhbiBhcnJheSBvZiBzdHJpbmdzLlxuICogQHJldHVybiB7V2ViR0xTaGFkZXJ9IHRoZSBzaGFkZXJcbiAqL1xuZnVuY3Rpb24gY29tcGlsZVNoYWRlcihnbDogV2ViR0xSZW5kZXJpbmdDb250ZXh0QmFzZSwgdHlwZTogbnVtYmVyLCBzcmM6IHN0cmluZyk6IFdlYkdMU2hhZGVyXG57XG4gICAgY29uc3Qgc2hhZGVyID0gZ2wuY3JlYXRlU2hhZGVyKHR5cGUpO1xuXG4gICAgZ2wuc2hhZGVyU291cmNlKHNoYWRlciwgc3JjKTtcbiAgICBnbC5jb21waWxlU2hhZGVyKHNoYWRlcik7XG5cbiAgICByZXR1cm4gc2hhZGVyO1xufVxuXG4vKipcbiAqIEBtZXRob2QgY29tcGlsZVByb2dyYW1cbiAqIEBwcml2YXRlXG4gKiBAbWVtYmVyb2YgUElYSS5nbENvcmUuc2hhZGVyXG4gKiBAcGFyYW0gZ2wge1dlYkdMUmVuZGVyaW5nQ29udGV4dH0gVGhlIGN1cnJlbnQgV2ViR0wgY29udGV4dCB7V2ViR0xQcm9ncmFtfVxuICogQHBhcmFtIHZlcnRleFNyYyB7c3RyaW5nfHN0cmluZ1tdfSBUaGUgdmVydGV4IHNoYWRlciBzb3VyY2UgYXMgYW4gYXJyYXkgb2Ygc3RyaW5ncy5cbiAqIEBwYXJhbSBmcmFnbWVudFNyYyB7c3RyaW5nfHN0cmluZ1tdfSBUaGUgZnJhZ21lbnQgc2hhZGVyIHNvdXJjZSBhcyBhbiBhcnJheSBvZiBzdHJpbmdzLlxuICogQHBhcmFtIGF0dHJpYnV0ZUxvY2F0aW9ucyB7T2JqZWN0fSBBbiBhdHRyaWJ1dGUgbG9jYXRpb24gbWFwIHRoYXQgbGV0cyB5b3UgbWFudWFsbHkgc2V0IHRoZSBhdHRyaWJ1dGUgbG9jYXRpb25zXG4gKiBAcmV0dXJuIHtXZWJHTFByb2dyYW19IHRoZSBzaGFkZXIgcHJvZ3JhbVxuICovXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVByb2dyYW0oZ2w6IFdlYkdMUmVuZGVyaW5nQ29udGV4dEJhc2UsIHZlcnRleFNyYzogc3RyaW5nLCBmcmFnbWVudFNyYzogc3RyaW5nLFxuICAgIGF0dHJpYnV0ZUxvY2F0aW9ucz86IERpY3Q8bnVtYmVyPik6IFdlYkdMUHJvZ3JhbVxue1xuICAgIGNvbnN0IGdsVmVydFNoYWRlciA9IGNvbXBpbGVTaGFkZXIoZ2wsIGdsLlZFUlRFWF9TSEFERVIsIHZlcnRleFNyYyk7XG4gICAgY29uc3QgZ2xGcmFnU2hhZGVyID0gY29tcGlsZVNoYWRlcihnbCwgZ2wuRlJBR01FTlRfU0hBREVSLCBmcmFnbWVudFNyYyk7XG5cbiAgICBsZXQgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcblxuICAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBnbFZlcnRTaGFkZXIpO1xuICAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBnbEZyYWdTaGFkZXIpO1xuXG4gICAgLy8gb3B0aW9uYWxseSwgc2V0IHRoZSBhdHRyaWJ1dGVzIG1hbnVhbGx5IGZvciB0aGUgcHJvZ3JhbSByYXRoZXIgdGhhbiBsZXR0aW5nIFdlYkdMIGRlY2lkZS4uXG4gICAgaWYgKGF0dHJpYnV0ZUxvY2F0aW9ucylcbiAgICB7XG4gICAgICAgIGZvciAoY29uc3QgaSBpbiBhdHRyaWJ1dGVMb2NhdGlvbnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmJpbmRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCBhdHRyaWJ1dGVMb2NhdGlvbnNbaV0sIGkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XG5cbiAgICAvLyBpZiBsaW5raW5nIGZhaWxzLCB0aGVuIGxvZyBhbmQgY2xlYW51cFxuICAgIGlmICghZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5MSU5LX1NUQVRVUykpXG4gICAge1xuICAgICAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihnbFZlcnRTaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKHZlcnRleFNyYyk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGdsLmdldFNoYWRlckluZm9Mb2coZ2xWZXJ0U2hhZGVyKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihnbEZyYWdTaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGZyYWdtZW50U3JjKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZ2wuZ2V0U2hhZGVySW5mb0xvZyhnbEZyYWdTaGFkZXIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BpeGkuanMgRXJyb3I6IENvdWxkIG5vdCBpbml0aWFsaXplIHNoYWRlci4nKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignZ2wuVkFMSURBVEVfU1RBVFVTJywgZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5WQUxJREFURV9TVEFUVVMpKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignZ2wuZ2V0RXJyb3IoKScsIGdsLmdldEVycm9yKCkpO1xuXG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgcHJvZ3JhbSBpbmZvIGxvZywgbG9nIGl0XG4gICAgICAgIGlmIChnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKSAhPT0gJycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignUGl4aS5qcyBXYXJuaW5nOiBnbC5nZXRQcm9ncmFtSW5mb0xvZygpJywgZ2wuZ2V0UHJvZ3JhbUluZm9Mb2cocHJvZ3JhbSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtKTtcbiAgICAgICAgcHJvZ3JhbSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gY2xlYW4gdXAgc29tZSBzaGFkZXJzXG4gICAgZ2wuZGVsZXRlU2hhZGVyKGdsVmVydFNoYWRlcik7XG4gICAgZ2wuZGVsZXRlU2hhZGVyKGdsRnJhZ1NoYWRlcik7XG5cbiAgICByZXR1cm4gcHJvZ3JhbTtcbn1cbiIsICJmdW5jdGlvbiBib29sZWFuQXJyYXkoc2l6ZTogbnVtYmVyKTogQXJyYXk8Ym9vbGVhbj5cbntcbiAgICBjb25zdCBhcnJheSA9IG5ldyBBcnJheShzaXplKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspXG4gICAge1xuICAgICAgICBhcnJheVtpXSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBhcnJheTtcbn1cblxuLyoqXG4gKiBAbWV0aG9kIGRlZmF1bHRWYWx1ZVxuICogQG1lbWJlcm9mIFBJWEkuZ2xDb3JlLnNoYWRlclxuICogQHBhcmFtIHR5cGUge1N0cmluZ30gVHlwZSBvZiB2YWx1ZVxuICogQHBhcmFtIHNpemUge051bWJlcn1cbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0VmFsdWUodHlwZTogc3RyaW5nLCBzaXplOiBudW1iZXIpOiBudW1iZXJ8RmxvYXQzMkFycmF5fEludDMyQXJyYXl8Ym9vbGVhbnxib29sZWFuW11cbntcbiAgICBzd2l0Y2ggKHR5cGUpXG4gICAge1xuICAgICAgICBjYXNlICdmbG9hdCc6XG4gICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICBjYXNlICd2ZWMyJzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KDIgKiBzaXplKTtcblxuICAgICAgICBjYXNlICd2ZWMzJzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KDMgKiBzaXplKTtcblxuICAgICAgICBjYXNlICd2ZWM0JzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KDQgKiBzaXplKTtcblxuICAgICAgICBjYXNlICdpbnQnOlxuICAgICAgICBjYXNlICdzYW1wbGVyMkQnOlxuICAgICAgICBjYXNlICdzYW1wbGVyMkRBcnJheSc6XG4gICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICBjYXNlICdpdmVjMic6XG4gICAgICAgICAgICByZXR1cm4gbmV3IEludDMyQXJyYXkoMiAqIHNpemUpO1xuXG4gICAgICAgIGNhc2UgJ2l2ZWMzJzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheSgzICogc2l6ZSk7XG5cbiAgICAgICAgY2FzZSAnaXZlYzQnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnQzMkFycmF5KDQgKiBzaXplKTtcblxuICAgICAgICBjYXNlICdib29sJzpcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjYXNlICdidmVjMic6XG5cbiAgICAgICAgICAgIHJldHVybiBib29sZWFuQXJyYXkoMiAqIHNpemUpO1xuXG4gICAgICAgIGNhc2UgJ2J2ZWMzJzpcbiAgICAgICAgICAgIHJldHVybiBib29sZWFuQXJyYXkoMyAqIHNpemUpO1xuXG4gICAgICAgIGNhc2UgJ2J2ZWM0JzpcbiAgICAgICAgICAgIHJldHVybiBib29sZWFuQXJyYXkoNCAqIHNpemUpO1xuXG4gICAgICAgIGNhc2UgJ21hdDInOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoWzEsIDAsXG4gICAgICAgICAgICAgICAgMCwgMV0pO1xuXG4gICAgICAgIGNhc2UgJ21hdDMnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoWzEsIDAsIDAsXG4gICAgICAgICAgICAgICAgMCwgMSwgMCxcbiAgICAgICAgICAgICAgICAwLCAwLCAxXSk7XG5cbiAgICAgICAgY2FzZSAnbWF0NCc6XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZsb2F0MzJBcnJheShbMSwgMCwgMCwgMCxcbiAgICAgICAgICAgICAgICAwLCAxLCAwLCAwLFxuICAgICAgICAgICAgICAgIDAsIDAsIDEsIDAsXG4gICAgICAgICAgICAgICAgMCwgMCwgMCwgMV0pO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xufVxuIiwgImltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnLi4vLi4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRU5WIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuY29uc3QgdW5rbm93bkNvbnRleHQgPSB7fTtcbmxldCBjb250ZXh0OiBXZWJHTFJlbmRlcmluZ0NvbnRleHQgfCBXZWJHTDJSZW5kZXJpbmdDb250ZXh0ID0gdW5rbm93bkNvbnRleHQgYXMgYW55O1xuXG4vKipcbiAqIHJldHVybnMgYSBsaXR0bGUgV2ViR0wgY29udGV4dCB0byB1c2UgZm9yIHByb2dyYW0gaW5zcGVjdGlvbi5cbiAqXG4gKiBAc3RhdGljXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybnMge1dlYkdMUmVuZGVyaW5nQ29udGV4dH0gYSBnbCBjb250ZXh0IHRvIHRlc3Qgd2l0aFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVzdENvbnRleHQoKTogV2ViR0xSZW5kZXJpbmdDb250ZXh0IHwgV2ViR0wyUmVuZGVyaW5nQ29udGV4dFxue1xuICAgIGlmIChjb250ZXh0ID09PSB1bmtub3duQ29udGV4dCB8fCAoY29udGV4dCAmJiBjb250ZXh0LmlzQ29udGV4dExvc3QoKSkpXG4gICAge1xuICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcblxuICAgICAgICBsZXQgZ2w6IFdlYkdMUmVuZGVyaW5nQ29udGV4dCB8IFdlYkdMMlJlbmRlcmluZ0NvbnRleHQ7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLlBSRUZFUl9FTlYgPj0gRU5WLldFQkdMMilcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wyJywge30pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFnbClcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnLCB7fSlcbiAgICAgICAgICAgIHx8IChjYW52YXMuZ2V0Q29udGV4dCgnZXhwZXJpbWVudGFsLXdlYmdsJywge30pIGFzIFdlYkdMUmVuZGVyaW5nQ29udGV4dCk7XG5cbiAgICAgICAgICAgIGlmICghZ2wpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gZmFpbCwgbm90IGFibGUgdG8gZ2V0IGEgY29udGV4dFxuICAgICAgICAgICAgICAgIGdsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBmb3Igc2hhZGVyIHRlc3RpbmcuLlxuICAgICAgICAgICAgICAgIGdsLmdldEV4dGVuc2lvbignV0VCR0xfZHJhd19idWZmZXJzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb250ZXh0ID0gZ2w7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRleHQ7XG59XG4iLCAiaW1wb3J0IHsgZ2V0VGVzdENvbnRleHQgfSBmcm9tICcuL2dldFRlc3RDb250ZXh0JztcbmltcG9ydCB7IFBSRUNJU0lPTiB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbmxldCBtYXhGcmFnbWVudFByZWNpc2lvbjogc3RyaW5nO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWF4RnJhZ21lbnRQcmVjaXNpb24oKTogc3RyaW5nXG57XG4gICAgaWYgKCFtYXhGcmFnbWVudFByZWNpc2lvbilcbiAgICB7XG4gICAgICAgIG1heEZyYWdtZW50UHJlY2lzaW9uID0gUFJFQ0lTSU9OLk1FRElVTTtcbiAgICAgICAgY29uc3QgZ2wgPSBnZXRUZXN0Q29udGV4dCgpO1xuXG4gICAgICAgIGlmIChnbClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGdsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaGFkZXJGcmFnbWVudCA9IGdsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdChnbC5GUkFHTUVOVF9TSEFERVIsIGdsLkhJR0hfRkxPQVQpO1xuXG4gICAgICAgICAgICAgICAgbWF4RnJhZ21lbnRQcmVjaXNpb24gPSBzaGFkZXJGcmFnbWVudC5wcmVjaXNpb24gPyBQUkVDSVNJT04uSElHSCA6IFBSRUNJU0lPTi5NRURJVU07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbWF4RnJhZ21lbnRQcmVjaXNpb247XG59XG4iLCAiaW1wb3J0IHsgUFJFQ0lTSU9OIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuLyoqXG4gKiBTZXRzIHRoZSBmbG9hdCBwcmVjaXNpb24gb24gdGhlIHNoYWRlciwgZW5zdXJpbmcgdGhlIGRldmljZSBzdXBwb3J0cyB0aGUgcmVxdWVzdCBwcmVjaXNpb24uXG4gKiBJZiB0aGUgcHJlY2lzaW9uIGlzIGFscmVhZHkgcHJlc2VudCwgaXQganVzdCBlbnN1cmVzIHRoYXQgdGhlIGRldmljZSBpcyBhYmxlIHRvIGhhbmRsZSBpdC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtzdHJpbmd9IHNyYyAtIFRoZSBzaGFkZXIgc291cmNlXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVxdWVzdGVkUHJlY2lzaW9uIC0gVGhlIHJlcXVlc3QgZmxvYXQgcHJlY2lzaW9uIG9mIHRoZSBzaGFkZXIuIE9wdGlvbnMgYXJlICdsb3dwJywgJ21lZGl1bXAnIG9yICdoaWdocCcuXG4gKiBAcGFyYW0ge3N0cmluZ30gbWF4U3VwcG9ydGVkUHJlY2lzaW9uIC0gVGhlIG1heGltdW0gcHJlY2lzaW9uIHRoZSBzaGFkZXIgc3VwcG9ydHMuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBtb2RpZmllZCBzaGFkZXIgc291cmNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRQcmVjaXNpb24oc3JjOiBzdHJpbmcsIHJlcXVlc3RlZFByZWNpc2lvbjogc3RyaW5nLCBtYXhTdXBwb3J0ZWRQcmVjaXNpb246IHN0cmluZyk6IHN0cmluZ1xue1xuICAgIGlmIChzcmMuc3Vic3RyaW5nKDAsIDkpICE9PSAncHJlY2lzaW9uJylcbiAgICB7XG4gICAgICAgIC8vIG5vIHByZWNpc2lvbiBzdXBwbGllZCwgc28gUGl4aUpTIHdpbGwgYWRkIHRoZSByZXF1ZXN0ZWQgbGV2ZWwuXG4gICAgICAgIGxldCBwcmVjaXNpb24gPSByZXF1ZXN0ZWRQcmVjaXNpb247XG5cbiAgICAgICAgLy8gSWYgaGlnaHAgaXMgcmVxdWVzdGVkIGJ1dCBub3Qgc3VwcG9ydGVkLCBkb3duZ3JhZGUgcHJlY2lzaW9uIHRvIGEgbGV2ZWwgYWxsIGRldmljZXMgc3VwcG9ydC5cbiAgICAgICAgaWYgKHJlcXVlc3RlZFByZWNpc2lvbiA9PT0gUFJFQ0lTSU9OLkhJR0ggJiYgbWF4U3VwcG9ydGVkUHJlY2lzaW9uICE9PSBQUkVDSVNJT04uSElHSClcbiAgICAgICAge1xuICAgICAgICAgICAgcHJlY2lzaW9uID0gUFJFQ0lTSU9OLk1FRElVTTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBgcHJlY2lzaW9uICR7cHJlY2lzaW9ufSBmbG9hdDtcXG4ke3NyY31gO1xuICAgIH1cbiAgICBlbHNlIGlmIChtYXhTdXBwb3J0ZWRQcmVjaXNpb24gIT09IFBSRUNJU0lPTi5ISUdIICYmIHNyYy5zdWJzdHJpbmcoMCwgMTUpID09PSAncHJlY2lzaW9uIGhpZ2hwJylcbiAgICB7XG4gICAgICAgIC8vIHByZWNpc2lvbiB3YXMgc3VwcGxpZWQsIGJ1dCBhdCBhIGxldmVsIHRoaXMgZGV2aWNlIGRvZXMgbm90IHN1cHBvcnQsIHNvIGRvd25ncmFkaW5nIHRvIG1lZGl1bXAuXG4gICAgICAgIHJldHVybiBzcmMucmVwbGFjZSgncHJlY2lzaW9uIGhpZ2hwJywgJ3ByZWNpc2lvbiBtZWRpdW1wJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNyYztcbn1cbiIsICJpbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmNvbnN0IEdMU0xfVE9fU0laRTogRGljdDxudW1iZXI+ID0ge1xuICAgIGZsb2F0OiAgICAxLFxuICAgIHZlYzI6ICAgICAyLFxuICAgIHZlYzM6ICAgICAzLFxuICAgIHZlYzQ6ICAgICA0LFxuXG4gICAgaW50OiAgICAgIDEsXG4gICAgaXZlYzI6ICAgIDIsXG4gICAgaXZlYzM6ICAgIDMsXG4gICAgaXZlYzQ6ICAgIDQsXG5cbiAgICBib29sOiAgICAgMSxcbiAgICBidmVjMjogICAgMixcbiAgICBidmVjMzogICAgMyxcbiAgICBidmVjNDogICAgNCxcblxuICAgIG1hdDI6ICAgICA0LFxuICAgIG1hdDM6ICAgICA5LFxuICAgIG1hdDQ6ICAgICAxNixcblxuICAgIHNhbXBsZXIyRDogIDEsXG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBAbWV0aG9kIG1hcFNpemVcbiAqIEBtZW1iZXJvZiBQSVhJLmdsQ29yZS5zaGFkZXJcbiAqIEBwYXJhbSB0eXBlIHtTdHJpbmd9XG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBTaXplKHR5cGU6IHN0cmluZyk6IG51bWJlclxue1xuICAgIHJldHVybiBHTFNMX1RPX1NJWkVbdHlwZV07XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5sZXQgR0xfVEFCTEU6IERpY3Q8c3RyaW5nPiA9IG51bGw7XG5cbmNvbnN0IEdMX1RPX0dMU0xfVFlQRVM6IERpY3Q8c3RyaW5nPiA9IHtcbiAgICBGTE9BVDogICAgICAgJ2Zsb2F0JyxcbiAgICBGTE9BVF9WRUMyOiAgJ3ZlYzInLFxuICAgIEZMT0FUX1ZFQzM6ICAndmVjMycsXG4gICAgRkxPQVRfVkVDNDogICd2ZWM0JyxcblxuICAgIElOVDogICAgICAgICAnaW50JyxcbiAgICBJTlRfVkVDMjogICAgJ2l2ZWMyJyxcbiAgICBJTlRfVkVDMzogICAgJ2l2ZWMzJyxcbiAgICBJTlRfVkVDNDogICAgJ2l2ZWM0JyxcblxuICAgIEJPT0w6ICAgICAgICAnYm9vbCcsXG4gICAgQk9PTF9WRUMyOiAgICdidmVjMicsXG4gICAgQk9PTF9WRUMzOiAgICdidmVjMycsXG4gICAgQk9PTF9WRUM0OiAgICdidmVjNCcsXG5cbiAgICBGTE9BVF9NQVQyOiAgJ21hdDInLFxuICAgIEZMT0FUX01BVDM6ICAnbWF0MycsXG4gICAgRkxPQVRfTUFUNDogICdtYXQ0JyxcblxuICAgIFNBTVBMRVJfMkQ6ICAgICAgICAgICAgICAnc2FtcGxlcjJEJyxcbiAgICBJTlRfU0FNUExFUl8yRDogICAgICAgICAgJ3NhbXBsZXIyRCcsXG4gICAgVU5TSUdORURfSU5UX1NBTVBMRVJfMkQ6ICdzYW1wbGVyMkQnLFxuICAgIFNBTVBMRVJfQ1VCRTogICAgICAgICAgICAgICdzYW1wbGVyQ3ViZScsXG4gICAgSU5UX1NBTVBMRVJfQ1VCRTogICAgICAgICAgJ3NhbXBsZXJDdWJlJyxcbiAgICBVTlNJR05FRF9JTlRfU0FNUExFUl9DVUJFOiAnc2FtcGxlckN1YmUnLFxuICAgIFNBTVBMRVJfMkRfQVJSQVk6ICAgICAgICAgICAgICAnc2FtcGxlcjJEQXJyYXknLFxuICAgIElOVF9TQU1QTEVSXzJEX0FSUkFZOiAgICAgICAgICAnc2FtcGxlcjJEQXJyYXknLFxuICAgIFVOU0lHTkVEX0lOVF9TQU1QTEVSXzJEX0FSUkFZOiAnc2FtcGxlcjJEQXJyYXknLFxufTtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbmV4cG9ydCBmdW5jdGlvbiBtYXBUeXBlKGdsOiBhbnksIHR5cGU6IG51bWJlcik6IHN0cmluZ1xue1xuICAgIGlmICghR0xfVEFCTEUpXG4gICAge1xuICAgICAgICBjb25zdCB0eXBlTmFtZXMgPSBPYmplY3Qua2V5cyhHTF9UT19HTFNMX1RZUEVTKTtcblxuICAgICAgICBHTF9UQUJMRSA9IHt9O1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHlwZU5hbWVzLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0biA9IHR5cGVOYW1lc1tpXTtcblxuICAgICAgICAgICAgR0xfVEFCTEVbZ2xbdG5dXSA9IEdMX1RPX0dMU0xfVFlQRVNbdG5dO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIEdMX1RBQkxFW3R5cGVdO1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXMgKi9cbi8vIFBhcnNlcnMsIGVhY2ggb25lIG9mIHRoZXNlIHdpbGwgdGFrZSBhIGxvb2sgYXQgdGhlIHR5cGUgb2Ygc2hhZGVyIHByb3BlcnR5IGFuZCB1bmlmb3JtLlxuLy8gaWYgdGhleSBwYXNzIHRoZSB0ZXN0IGZ1bmN0aW9uIHRoZW4gdGhlIGNvZGUgZnVuY3Rpb24gaXMgY2FsbGVkIHRoYXQgcmV0dXJucyBhIHRoZSBzaGFkZXIgdXBsb2FkIGNvZGUgZm9yIHRoYXQgdW5pZm9ybS5cbi8vIFNoYWRlciB1cGxvYWQgY29kZSBpcyBhdXRvbWFnaWNhbGx5IGdlbmVyYXRlZCB3aXRoIHRoZXNlIHBhcnNlcnMuXG4vLyBJZiBubyBwYXJzZXIgaXMgdmFsaWQgdGhlbiB0aGUgZGVmYXVsdCB1cGxvYWQgZnVuY3Rpb25zIGFyZSB1c2VkLlxuLy8gZXhwb3NpbmcgUGFyc2VycyBtZWFucyB0aGF0IGN1c3RvbSB1cGxvYWQgbG9naWMgY2FuIGJlIGFkZGVkIHRvIHBpeGkncyBzaGFkZXJzLlxuLy8gQSBnb29kIGV4YW1wbGUgd291bGQgYmUgYSBwaXhpIHJlY3RhbmdsZSBjYW4gYmUgZGlyZWN0bHkgc2V0IG9uIGEgdW5pZm9ybS5cbi8vIElmIHRoZSBzaGFkZXIgc2VlcyBpdCBpdCBrbm93cyBob3cgdG8gdXBsb2FkIHRoZSByZWN0YW5nbGUgc3RydWN0dXJlIGFzIGEgdmVjNFxuLy8gZm9ybWF0IGlzIGFzIGZvbGxvd3M6XG4vL1xuLy8ge1xuLy8gICAgIHRlc3Q6IChkYXRhLCB1bmlmb3JtKSA9PiB7fSA8LS0tIHRlc3QgaXMgdGhpcyBjb2RlIHNob3VsZCBiZSB1c2VkIGZvciB0aGlzIHVuaWZvcm1cbi8vICAgICBjb2RlOiAobmFtZSwgdW5pZm9ybSkgPT4ge30gPC0tLSByZXR1cm5zIHRoZSBzdHJpbmcgb2YgdGhlIHBpZWNlIG9mIGNvZGUgdGhhdCB1cGxvYWRzIHRoZSB1bmlmb3JtXG4vLyB9XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVVuaWZvcm1QYXJzZXJcbntcbiAgICB0ZXN0KGRhdGE6IHVua25vd24sIHVuaWZvcm06IGFueSk6IGJvb2xlYW47XG4gICAgY29kZShuYW1lOiBzdHJpbmcsIHVuaWZvcm06IGFueSk6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IHVuaWZvcm1QYXJzZXJzOiBJVW5pZm9ybVBhcnNlcltdID0gW1xuXG4gICAgLy8gYSBmbG9hdCBjYWNoZSBsYXllclxuICAgIHtcbiAgICAgICAgdGVzdDogKGRhdGE6IGFueSk6IGJvb2xlYW4gPT5cbiAgICAgICAgICAgIGRhdGEudHlwZSA9PT0gJ2Zsb2F0JyAmJiBkYXRhLnNpemUgPT09IDEsXG4gICAgICAgIGNvZGU6IChuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICAgIGlmKHV2W1wiJHtuYW1lfVwiXSAhPT0gdWRbXCIke25hbWV9XCJdLnZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVkW1wiJHtuYW1lfVwiXS52YWx1ZSA9IHV2W1wiJHtuYW1lfVwiXVxuICAgICAgICAgICAgICAgIGdsLnVuaWZvcm0xZih1ZFtcIiR7bmFtZX1cIl0ubG9jYXRpb24sIHV2W1wiJHtuYW1lfVwiXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGAsXG4gICAgfSxcbiAgICAvLyBoYW5kbGluZyBzYW1wbGVyc1xuICAgIHtcbiAgICAgICAgdGVzdDogKGRhdGE6IGFueSk6IGJvb2xlYW4gPT5cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuXG4gICAgICAgICAgICAoZGF0YS50eXBlID09PSAnc2FtcGxlcjJEJyB8fCBkYXRhLnR5cGUgPT09ICdzYW1wbGVyQ3ViZScgfHwgZGF0YS50eXBlID09PSAnc2FtcGxlcjJEQXJyYXknKSAmJiBkYXRhLnNpemUgPT09IDEgJiYgIWRhdGEuaXNBcnJheSxcbiAgICAgICAgY29kZTogKG5hbWU6IHN0cmluZyk6IHN0cmluZyA9PiBgdCA9IHN5bmNEYXRhLnRleHR1cmVDb3VudCsrO1xuXG4gICAgICAgICAgICByZW5kZXJlci50ZXh0dXJlLmJpbmQodXZbXCIke25hbWV9XCJdLCB0KTtcblxuICAgICAgICAgICAgaWYodWRbXCIke25hbWV9XCJdLnZhbHVlICE9PSB0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVkW1wiJHtuYW1lfVwiXS52YWx1ZSA9IHQ7XG4gICAgICAgICAgICAgICAgZ2wudW5pZm9ybTFpKHVkW1wiJHtuYW1lfVwiXS5sb2NhdGlvbiwgdCk7XFxuOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG1heC1sZW5cbiAgICAgICAgICAgIH1gLFxuICAgIH0sXG4gICAgLy8gdXBsb2FkaW5nIHBpeGkgbWF0cml4IG9iamVjdCB0byBtYXQzXG4gICAge1xuICAgICAgICB0ZXN0OiAoZGF0YTogYW55LCB1bmlmb3JtOiBhbnkpOiBib29sZWFuID0+XG4gICAgICAgICAgICBkYXRhLnR5cGUgPT09ICdtYXQzJyAmJiBkYXRhLnNpemUgPT09IDEgJiYgdW5pZm9ybS5hICE9PSB1bmRlZmluZWQsXG4gICAgICAgIGNvZGU6IChuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT5cblxuICAgICAgICAgICAgLy8gVE9ETyBhbmQgc29tZSBzbWFydCBjYWNoaW5nIGRpcnR5IGlkcyBoZXJlIVxuICAgICAgICAgICAgYFxuICAgICAgICAgICAgZ2wudW5pZm9ybU1hdHJpeDNmdih1ZFtcIiR7bmFtZX1cIl0ubG9jYXRpb24sIGZhbHNlLCB1dltcIiR7bmFtZX1cIl0udG9BcnJheSh0cnVlKSk7XG4gICAgICAgICAgICBgXG4gICAgICAgICxcblxuICAgIH0sXG4gICAgLy8gdXBsb2FkaW5nIGEgcGl4aSBwb2ludCBhcyBhIHZlYzIgd2l0aCBjYWNoaW5nIGxheWVyXG4gICAge1xuICAgICAgICB0ZXN0OiAoZGF0YTogYW55LCB1bmlmb3JtOiBhbnkpOiBib29sZWFuID0+XG4gICAgICAgICAgICBkYXRhLnR5cGUgPT09ICd2ZWMyJyAmJiBkYXRhLnNpemUgPT09IDEgJiYgdW5pZm9ybS54ICE9PSB1bmRlZmluZWQsXG4gICAgICAgIGNvZGU6IChuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgICBjdiA9IHVkW1wiJHtuYW1lfVwiXS52YWx1ZTtcbiAgICAgICAgICAgICAgICB2ID0gdXZbXCIke25hbWV9XCJdO1xuXG4gICAgICAgICAgICAgICAgaWYoY3ZbMF0gIT09IHYueCB8fCBjdlsxXSAhPT0gdi55KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY3ZbMF0gPSB2Lng7XG4gICAgICAgICAgICAgICAgICAgIGN2WzFdID0gdi55O1xuICAgICAgICAgICAgICAgICAgICBnbC51bmlmb3JtMmYodWRbXCIke25hbWV9XCJdLmxvY2F0aW9uLCB2LngsIHYueSk7XG4gICAgICAgICAgICAgICAgfWAsXG4gICAgfSxcbiAgICAvLyBjYWNoaW5nIGxheWVyIGZvciBhIHZlYzJcbiAgICB7XG4gICAgICAgIHRlc3Q6IChkYXRhOiBhbnkpOiBib29sZWFuID0+XG4gICAgICAgICAgICBkYXRhLnR5cGUgPT09ICd2ZWMyJyAmJiBkYXRhLnNpemUgPT09IDEsXG4gICAgICAgIGNvZGU6IChuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgICBjdiA9IHVkW1wiJHtuYW1lfVwiXS52YWx1ZTtcbiAgICAgICAgICAgICAgICB2ID0gdXZbXCIke25hbWV9XCJdO1xuXG4gICAgICAgICAgICAgICAgaWYoY3ZbMF0gIT09IHZbMF0gfHwgY3ZbMV0gIT09IHZbMV0pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjdlswXSA9IHZbMF07XG4gICAgICAgICAgICAgICAgICAgIGN2WzFdID0gdlsxXTtcbiAgICAgICAgICAgICAgICAgICAgZ2wudW5pZm9ybTJmKHVkW1wiJHtuYW1lfVwiXS5sb2NhdGlvbiwgdlswXSwgdlsxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYCxcbiAgICB9LFxuICAgIC8vIHVwbG9hZCBhIHBpeGkgcmVjdGFuZ2xlIGFzIGEgdmVjNCB3aXRoIGNhY2hpbmcgbGF5ZXJcbiAgICB7XG4gICAgICAgIHRlc3Q6IChkYXRhOiBhbnksIHVuaWZvcm06IGFueSk6IGJvb2xlYW4gPT5cbiAgICAgICAgICAgIGRhdGEudHlwZSA9PT0gJ3ZlYzQnICYmIGRhdGEuc2l6ZSA9PT0gMSAmJiB1bmlmb3JtLndpZHRoICE9PSB1bmRlZmluZWQsXG5cbiAgICAgICAgY29kZTogKG5hbWU6IHN0cmluZyk6IHN0cmluZyA9PlxuICAgICAgICAgICAgYFxuICAgICAgICAgICAgICAgIGN2ID0gdWRbXCIke25hbWV9XCJdLnZhbHVlO1xuICAgICAgICAgICAgICAgIHYgPSB1dltcIiR7bmFtZX1cIl07XG5cbiAgICAgICAgICAgICAgICBpZihjdlswXSAhPT0gdi54IHx8IGN2WzFdICE9PSB2LnkgfHwgY3ZbMl0gIT09IHYud2lkdGggfHwgY3ZbM10gIT09IHYuaGVpZ2h0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY3ZbMF0gPSB2Lng7XG4gICAgICAgICAgICAgICAgICAgIGN2WzFdID0gdi55O1xuICAgICAgICAgICAgICAgICAgICBjdlsyXSA9IHYud2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIGN2WzNdID0gdi5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIGdsLnVuaWZvcm00Zih1ZFtcIiR7bmFtZX1cIl0ubG9jYXRpb24sIHYueCwgdi55LCB2LndpZHRoLCB2LmhlaWdodClcbiAgICAgICAgICAgICAgICB9YCxcbiAgICB9LFxuICAgIC8vIGEgY2FjaGluZyBsYXllciBmb3IgdmVjNCB1cGxvYWRpbmdcbiAgICB7XG4gICAgICAgIHRlc3Q6IChkYXRhOiBhbnkpOiBib29sZWFuID0+XG4gICAgICAgICAgICBkYXRhLnR5cGUgPT09ICd2ZWM0JyAmJiBkYXRhLnNpemUgPT09IDEsXG4gICAgICAgIGNvZGU6IChuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgICBjdiA9IHVkW1wiJHtuYW1lfVwiXS52YWx1ZTtcbiAgICAgICAgICAgICAgICB2ID0gdXZbXCIke25hbWV9XCJdO1xuXG4gICAgICAgICAgICAgICAgaWYoY3ZbMF0gIT09IHZbMF0gfHwgY3ZbMV0gIT09IHZbMV0gfHwgY3ZbMl0gIT09IHZbMl0gfHwgY3ZbM10gIT09IHZbM10pXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjdlswXSA9IHZbMF07XG4gICAgICAgICAgICAgICAgICAgIGN2WzFdID0gdlsxXTtcbiAgICAgICAgICAgICAgICAgICAgY3ZbMl0gPSB2WzJdO1xuICAgICAgICAgICAgICAgICAgICBjdlszXSA9IHZbM107XG5cbiAgICAgICAgICAgICAgICAgICAgZ2wudW5pZm9ybTRmKHVkW1wiJHtuYW1lfVwiXS5sb2NhdGlvbiwgdlswXSwgdlsxXSwgdlsyXSwgdlszXSlcbiAgICAgICAgICAgICAgICB9YCxcbiAgICB9LFxuXTtcblxuIiwgImltcG9ydCB7IHVuaWZvcm1QYXJzZXJzIH0gZnJvbSAnLi91bmlmb3JtUGFyc2Vycyc7XG5cbmltcG9ydCB0eXBlIHsgVW5pZm9ybUdyb3VwIH0gZnJvbSAnLi4vVW5pZm9ybUdyb3VwJztcbmltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgVW5pZm9ybXNTeW5jQ2FsbGJhY2sgPSAoLi4uYXJnczogYW55W10pID0+IHZvaWQ7XG5cbi8vIGN2ID0gQ2FjaGVkVmFsdWVcbi8vIHYgPSB2YWx1ZVxuLy8gdWQgPSB1bmlmb3JtRGF0YVxuLy8gdXYgPSB1bmlmb3JtVmFsdWVcbi8vIGwgPSBsb2NhdGlvblxuY29uc3QgR0xTTF9UT19TSU5HTEVfU0VUVEVSU19DQUNIRUQ6IERpY3Q8c3RyaW5nPiA9IHtcblxuICAgIGZsb2F0OiBgXG4gICAgaWYoY3YgIT09IHYpXG4gICAge1xuICAgICAgICBjdi52ID0gdjtcbiAgICAgICAgZ2wudW5pZm9ybTFmKGxvY2F0aW9uLCB2KVxuICAgIH1gLFxuXG4gICAgdmVjMjogYFxuICAgIGlmKGN2WzBdICE9PSB2WzBdIHx8IGN2WzFdICE9PSB2WzFdKVxuICAgIHtcbiAgICAgICAgY3ZbMF0gPSB2WzBdO1xuICAgICAgICBjdlsxXSA9IHZbMV07XG4gICAgICAgIGdsLnVuaWZvcm0yZihsb2NhdGlvbiwgdlswXSwgdlsxXSlcbiAgICB9YCxcblxuICAgIHZlYzM6IGBcbiAgICBpZihjdlswXSAhPT0gdlswXSB8fCBjdlsxXSAhPT0gdlsxXSB8fCBjdlsyXSAhPT0gdlsyXSlcbiAgICB7XG4gICAgICAgIGN2WzBdID0gdlswXTtcbiAgICAgICAgY3ZbMV0gPSB2WzFdO1xuICAgICAgICBjdlsyXSA9IHZbMl07XG5cbiAgICAgICAgZ2wudW5pZm9ybTNmKGxvY2F0aW9uLCB2WzBdLCB2WzFdLCB2WzJdKVxuICAgIH1gLFxuXG4gICAgdmVjNDogICAgICdnbC51bmlmb3JtNGYobG9jYXRpb24sIHZbMF0sIHZbMV0sIHZbMl0sIHZbM10pJyxcblxuICAgIGludDogICAgICAnZ2wudW5pZm9ybTFpKGxvY2F0aW9uLCB2KScsXG4gICAgaXZlYzI6ICAgICdnbC51bmlmb3JtMmkobG9jYXRpb24sIHZbMF0sIHZbMV0pJyxcbiAgICBpdmVjMzogICAgJ2dsLnVuaWZvcm0zaShsb2NhdGlvbiwgdlswXSwgdlsxXSwgdlsyXSknLFxuICAgIGl2ZWM0OiAgICAnZ2wudW5pZm9ybTRpKGxvY2F0aW9uLCB2WzBdLCB2WzFdLCB2WzJdLCB2WzNdKScsXG5cbiAgICBib29sOiAgICAgJ2dsLnVuaWZvcm0xaShsb2NhdGlvbiwgdiknLFxuICAgIGJ2ZWMyOiAgICAnZ2wudW5pZm9ybTJpKGxvY2F0aW9uLCB2WzBdLCB2WzFdKScsXG4gICAgYnZlYzM6ICAgICdnbC51bmlmb3JtM2kobG9jYXRpb24sIHZbMF0sIHZbMV0sIHZbMl0pJyxcbiAgICBidmVjNDogICAgJ2dsLnVuaWZvcm00aShsb2NhdGlvbiwgdlswXSwgdlsxXSwgdlsyXSwgdlszXSknLFxuXG4gICAgbWF0MjogICAgICdnbC51bmlmb3JtTWF0cml4MmZ2KGxvY2F0aW9uLCBmYWxzZSwgdiknLFxuICAgIG1hdDM6ICAgICAnZ2wudW5pZm9ybU1hdHJpeDNmdihsb2NhdGlvbiwgZmFsc2UsIHYpJyxcbiAgICBtYXQ0OiAgICAgJ2dsLnVuaWZvcm1NYXRyaXg0ZnYobG9jYXRpb24sIGZhbHNlLCB2KScsXG5cbiAgICBzYW1wbGVyMkQ6ICAgICAgJ2dsLnVuaWZvcm0xaShsb2NhdGlvbiwgdiknLFxuICAgIHNhbXBsZXJDdWJlOiAgICAnZ2wudW5pZm9ybTFpKGxvY2F0aW9uLCB2KScsXG4gICAgc2FtcGxlcjJEQXJyYXk6ICdnbC51bmlmb3JtMWkobG9jYXRpb24sIHYpJyxcbn07XG5cbmNvbnN0IEdMU0xfVE9fQVJSQVlfU0VUVEVSUzogRGljdDxzdHJpbmc+ID0ge1xuXG4gICAgZmxvYXQ6ICAgIGBnbC51bmlmb3JtMWZ2KGxvY2F0aW9uLCB2KWAsXG5cbiAgICB2ZWMyOiAgICAgYGdsLnVuaWZvcm0yZnYobG9jYXRpb24sIHYpYCxcbiAgICB2ZWMzOiAgICAgYGdsLnVuaWZvcm0zZnYobG9jYXRpb24sIHYpYCxcbiAgICB2ZWM0OiAgICAgJ2dsLnVuaWZvcm00ZnYobG9jYXRpb24sIHYpJyxcblxuICAgIG1hdDQ6ICAgICAnZ2wudW5pZm9ybU1hdHJpeDRmdihsb2NhdGlvbiwgZmFsc2UsIHYpJyxcbiAgICBtYXQzOiAgICAgJ2dsLnVuaWZvcm1NYXRyaXgzZnYobG9jYXRpb24sIGZhbHNlLCB2KScsXG4gICAgbWF0MjogICAgICdnbC51bmlmb3JtTWF0cml4MmZ2KGxvY2F0aW9uLCBmYWxzZSwgdiknLFxuXG4gICAgaW50OiAgICAgICdnbC51bmlmb3JtMWl2KGxvY2F0aW9uLCB2KScsXG4gICAgaXZlYzI6ICAgICdnbC51bmlmb3JtMml2KGxvY2F0aW9uLCB2KScsXG4gICAgaXZlYzM6ICAgICdnbC51bmlmb3JtM2l2KGxvY2F0aW9uLCB2KScsXG4gICAgaXZlYzQ6ICAgICdnbC51bmlmb3JtNGl2KGxvY2F0aW9uLCB2KScsXG5cbiAgICBib29sOiAgICAgJ2dsLnVuaWZvcm0xaXYobG9jYXRpb24sIHYpJyxcbiAgICBidmVjMjogICAgJ2dsLnVuaWZvcm0yaXYobG9jYXRpb24sIHYpJyxcbiAgICBidmVjMzogICAgJ2dsLnVuaWZvcm0zaXYobG9jYXRpb24sIHYpJyxcbiAgICBidmVjNDogICAgJ2dsLnVuaWZvcm00aXYobG9jYXRpb24sIHYpJyxcblxuICAgIHNhbXBsZXIyRDogICAgICAnZ2wudW5pZm9ybTFpdihsb2NhdGlvbiwgdiknLFxuICAgIHNhbXBsZXJDdWJlOiAgICAnZ2wudW5pZm9ybTFpdihsb2NhdGlvbiwgdiknLFxuICAgIHNhbXBsZXIyREFycmF5OiAnZ2wudW5pZm9ybTFpdihsb2NhdGlvbiwgdiknLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVW5pZm9ybXNTeW5jKGdyb3VwOiBVbmlmb3JtR3JvdXAsIHVuaWZvcm1EYXRhOiBEaWN0PGFueT4pOiBVbmlmb3Jtc1N5bmNDYWxsYmFja1xue1xuICAgIGNvbnN0IGZ1bmNGcmFnbWVudHMgPSBbYFxuICAgICAgICB2YXIgdiA9IG51bGw7XG4gICAgICAgIHZhciBjdiA9IG51bGxcbiAgICAgICAgdmFyIHQgPSAwO1xuICAgICAgICB2YXIgZ2wgPSByZW5kZXJlci5nbFxuICAgIGBdO1xuXG4gICAgZm9yIChjb25zdCBpIGluIGdyb3VwLnVuaWZvcm1zKVxuICAgIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHVuaWZvcm1EYXRhW2ldO1xuXG4gICAgICAgIGlmICghZGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGdyb3VwLnVuaWZvcm1zW2ldLmdyb3VwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZ1bmNGcmFnbWVudHMucHVzaChgXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnNoYWRlci5zeW5jVW5pZm9ybUdyb3VwKHV2W1wiJHtpfVwiXSwgc3luY0RhdGEpO1xuICAgICAgICAgICAgICAgIGApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVuaWZvcm0gPSBncm91cC51bmlmb3Jtc1tpXTtcblxuICAgICAgICBsZXQgcGFyc2VkID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB1bmlmb3JtUGFyc2Vycy5sZW5ndGg7IGorKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHVuaWZvcm1QYXJzZXJzW2pdLnRlc3QoZGF0YSwgdW5pZm9ybSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZnVuY0ZyYWdtZW50cy5wdXNoKHVuaWZvcm1QYXJzZXJzW2pdLmNvZGUoaSwgdW5pZm9ybSkpO1xuICAgICAgICAgICAgICAgIHBhcnNlZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcGFyc2VkKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZVR5cGUgPSAoZGF0YS5zaXplID09PSAxKSA/IEdMU0xfVE9fU0lOR0xFX1NFVFRFUlNfQ0FDSEVEIDogR0xTTF9UT19BUlJBWV9TRVRURVJTO1xuXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9ICB0ZW1wbGF0ZVR5cGVbZGF0YS50eXBlXS5yZXBsYWNlKCdsb2NhdGlvbicsIGB1ZFtcIiR7aX1cIl0ubG9jYXRpb25gKTtcblxuICAgICAgICAgICAgZnVuY0ZyYWdtZW50cy5wdXNoKGBcbiAgICAgICAgICAgIGN2ID0gdWRbXCIke2l9XCJdLnZhbHVlO1xuICAgICAgICAgICAgdiA9IHV2W1wiJHtpfVwiXTtcbiAgICAgICAgICAgICR7dGVtcGxhdGV9O2ApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGhlIGludHJvZHVjdGlvbiBvZiBzeW5jRGF0YSBpcyB0byBzb2x2ZSBhbiBpc3N1ZSB3aGVyZSB0ZXh0dXJlcyBpbiB1bmlmb3JtIGdyb3VwcyBhcmUgbm90IHNldCBjb3JyZWN0bHlcbiAgICAgKiB0aGUgdGV4dHVyZSBjb3VudCB3YXMgYWx3YXlzIHN0YXJ0aW5nIGZyb20gMCBpbiBlYWNoIGdyb3VwLiBUaGlzIG5lZWRzIHRvIGluY3JlbWVudCBlYWNoIHRpbWUgYSB0ZXh0dXJlIGlzIHVzZWRcbiAgICAgKiBubyBtYXR0ZXIgd2hpY2ggZ3JvdXAgaXMgYmVpbmcgdXNlZFxuICAgICAqXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbigndWQnLCAndXYnLCAncmVuZGVyZXInLCAnc3luY0RhdGEnLCBmdW5jRnJhZ21lbnRzLmpvaW4oJ1xcbicpKSBhcyBVbmlmb3Jtc1N5bmNDYWxsYmFjaztcbn1cblxuIiwgImltcG9ydCB0eXBlIHsgSVJlbmRlcmluZ0NvbnRleHQgfSBmcm9tICcuLi8uLi9JUmVuZGVyaW5nQ29udGV4dCc7XG5cbmNvbnN0IGZyYWdUZW1wbGF0ZSA9IFtcbiAgICAncHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7JyxcbiAgICAndm9pZCBtYWluKHZvaWQpeycsXG4gICAgJ2Zsb2F0IHRlc3QgPSAwLjE7JyxcbiAgICAnJWZvcmxvb3AlJyxcbiAgICAnZ2xfRnJhZ0NvbG9yID0gdmVjNCgwLjApOycsXG4gICAgJ30nLFxuXS5qb2luKCdcXG4nKTtcblxuZnVuY3Rpb24gZ2VuZXJhdGVJZlRlc3RTcmMobWF4SWZzOiBudW1iZXIpOiBzdHJpbmdcbntcbiAgICBsZXQgc3JjID0gJyc7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heElmczsgKytpKVxuICAgIHtcbiAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICB7XG4gICAgICAgICAgICBzcmMgKz0gJ1xcbmVsc2UgJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpIDwgbWF4SWZzIC0gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgc3JjICs9IGBpZih0ZXN0ID09ICR7aX0uMCl7fWA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3JjO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tNYXhJZlN0YXRlbWVudHNJblNoYWRlcihtYXhJZnM6IG51bWJlciwgZ2w6IElSZW5kZXJpbmdDb250ZXh0KTogbnVtYmVyXG57XG4gICAgaWYgKG1heElmcyA9PT0gMClcbiAgICB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBvZiBgMGAgcGFzc2VkIHRvIGBjaGVja01heElmU3RhdGVtZW50c0luU2hhZGVyYCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihnbC5GUkFHTUVOVF9TSEFERVIpO1xuXG4gICAgd2hpbGUgKHRydWUpIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAge1xuICAgICAgICBjb25zdCBmcmFnbWVudFNyYyA9IGZyYWdUZW1wbGF0ZS5yZXBsYWNlKC8lZm9ybG9vcCUvZ2ksIGdlbmVyYXRlSWZUZXN0U3JjKG1heElmcykpO1xuXG4gICAgICAgIGdsLnNoYWRlclNvdXJjZShzaGFkZXIsIGZyYWdtZW50U3JjKTtcbiAgICAgICAgZ2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xuXG4gICAgICAgIGlmICghZ2wuZ2V0U2hhZGVyUGFyYW1ldGVyKHNoYWRlciwgZ2wuQ09NUElMRV9TVEFUVVMpKVxuICAgICAgICB7XG4gICAgICAgICAgICBtYXhJZnMgPSAobWF4SWZzIC8gMikgfCAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gdmFsaWQhXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBtYXhJZnM7XG59XG4iLCAiLy8gQ2FjaGUgdGhlIHJlc3VsdCB0byBwcmV2ZW50IHJ1bm5pbmcgdGhpcyBvdmVyIGFuZCBvdmVyXG5sZXQgdW5zYWZlRXZhbDogYm9vbGVhbjtcblxuLyoqXG4gKiBOb3QgYWxsIHBsYXRmb3JtcyBhbGxvdyB0byBnZW5lcmF0ZSBmdW5jdGlvbiBjb2RlIChlLmcuLCBgbmV3IEZ1bmN0aW9uYCkuXG4gKiB0aGlzIHByb3ZpZGVzIHRoZSBwbGF0Zm9ybS1sZXZlbCBkZXRlY3Rpb24uXG4gKlxuICogQHByaXZhdGVcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlRXZhbFN1cHBvcnRlZCgpOiBib29sZWFuXG57XG4gICAgaWYgKHR5cGVvZiB1bnNhZmVFdmFsID09PSAnYm9vbGVhbicpXG4gICAge1xuICAgICAgICByZXR1cm4gdW5zYWZlRXZhbDtcbiAgICB9XG5cbiAgICB0cnlcbiAgICB7XG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLW5ldy1mdW5jICovXG4gICAgICAgIGNvbnN0IGZ1bmMgPSBuZXcgRnVuY3Rpb24oJ3BhcmFtMScsICdwYXJhbTInLCAncGFyYW0zJywgJ3JldHVybiBwYXJhbTFbcGFyYW0yXSA9PT0gcGFyYW0zOycpO1xuICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLW5ldy1mdW5jICovXG5cbiAgICAgICAgdW5zYWZlRXZhbCA9IGZ1bmMoeyBhOiAnYicgfSwgJ2EnLCAnYicpID09PSB0cnVlO1xuICAgIH1cbiAgICBjYXRjaCAoZSlcbiAgICB7XG4gICAgICAgIHVuc2FmZUV2YWwgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5zYWZlRXZhbDtcbn1cbiIsICJpbXBvcnQgeyBzZXRQcmVjaXNpb24sXG4gICAgZGVmYXVsdFZhbHVlLFxuICAgIGNvbXBpbGVQcm9ncmFtLFxuICAgIG1hcFNpemUsXG4gICAgbWFwVHlwZSxcbiAgICBnZXRUZXN0Q29udGV4dCxcbiAgICBnZXRNYXhGcmFnbWVudFByZWNpc2lvbiB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgUHJvZ3JhbUNhY2hlIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IGRlZmF1bHRGcmFnbWVudCBmcm9tICcuL2RlZmF1bHRQcm9ncmFtLmZyYWcnO1xuaW1wb3J0IGRlZmF1bHRWZXJ0ZXggZnJvbSAnLi9kZWZhdWx0UHJvZ3JhbS52ZXJ0JztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgUFJFQ0lTSU9OIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuaW1wb3J0IHR5cGUgeyBHTFByb2dyYW0gfSBmcm9tICcuL0dMUHJvZ3JhbSc7XG5cbmxldCBVSUQgPSAwO1xuXG5jb25zdCBuYW1lQ2FjaGU6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7fTtcblxuZXhwb3J0IGludGVyZmFjZSBJQXR0cmlidXRlRGF0YVxue1xuICAgIHR5cGU6IHN0cmluZztcbiAgICBzaXplOiBudW1iZXI7XG4gICAgbG9jYXRpb246IG51bWJlcjtcbiAgICBuYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVVuaWZvcm1EYXRhXG57XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIHNpemU6IG51bWJlcjtcbiAgICBpc0FycmF5OiBSZWdFeHBNYXRjaEFycmF5O1xuICAgIHZhbHVlOiBhbnk7XG59XG5cbi8qKlxuICogSGVscGVyIGNsYXNzIHRvIGNyZWF0ZSBhIHNoYWRlciBwcm9ncmFtLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFByb2dyYW1cbntcbiAgICBwdWJsaWMgaWQ6IG51bWJlcjtcbiAgICBwdWJsaWMgdmVydGV4U3JjOiBzdHJpbmc7XG4gICAgcHVibGljIGZyYWdtZW50U3JjOiBzdHJpbmc7XG4gICAgbmFtZUNhY2hlOiBhbnk7XG4gICAgZ2xQcm9ncmFtczogeyBbIGtleTogbnVtYmVyIF06IEdMUHJvZ3JhbX07XG4gICAgc3luY1VuaWZvcm1zOiBhbnk7XG4gICAgYXR0cmlidXRlRGF0YTogeyBba2V5OiBzdHJpbmddOiBJQXR0cmlidXRlRGF0YX07XG4gICAgdW5pZm9ybURhdGE6IHtba2V5OiBzdHJpbmddOiBJVW5pZm9ybURhdGF9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbdmVydGV4U3JjXSAtIFRoZSBzb3VyY2Ugb2YgdGhlIHZlcnRleCBzaGFkZXIuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtmcmFnbWVudFNyY10gLSBUaGUgc291cmNlIG9mIHRoZSBmcmFnbWVudCBzaGFkZXIuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtuYW1lXSAtIE5hbWUgZm9yIHNoYWRlclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHZlcnRleFNyYz86IHN0cmluZywgZnJhZ21lbnRTcmM/OiBzdHJpbmcsIG5hbWUgPSAncGl4aS1zaGFkZXInKVxuICAgIHtcbiAgICAgICAgdGhpcy5pZCA9IFVJRCsrO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdmVydGV4IHNoYWRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52ZXJ0ZXhTcmMgPSB2ZXJ0ZXhTcmMgfHwgUHJvZ3JhbS5kZWZhdWx0VmVydGV4U3JjO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZnJhZ21lbnQgc2hhZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZyYWdtZW50U3JjID0gZnJhZ21lbnRTcmMgfHwgUHJvZ3JhbS5kZWZhdWx0RnJhZ21lbnRTcmM7XG5cbiAgICAgICAgdGhpcy52ZXJ0ZXhTcmMgPSB0aGlzLnZlcnRleFNyYy50cmltKCk7XG4gICAgICAgIHRoaXMuZnJhZ21lbnRTcmMgPSB0aGlzLmZyYWdtZW50U3JjLnRyaW0oKTtcblxuICAgICAgICBpZiAodGhpcy52ZXJ0ZXhTcmMuc3Vic3RyaW5nKDAsIDgpICE9PSAnI3ZlcnNpb24nKVxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9cXHMrL2csICctJyk7XG5cbiAgICAgICAgICAgIGlmIChuYW1lQ2FjaGVbbmFtZV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZUNhY2hlW25hbWVdKys7XG4gICAgICAgICAgICAgICAgbmFtZSArPSBgLSR7bmFtZUNhY2hlW25hbWVdfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZUNhY2hlW25hbWVdID0gMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy52ZXJ0ZXhTcmMgPSBgI2RlZmluZSBTSEFERVJfTkFNRSAke25hbWV9XFxuJHt0aGlzLnZlcnRleFNyY31gO1xuICAgICAgICAgICAgdGhpcy5mcmFnbWVudFNyYyA9IGAjZGVmaW5lIFNIQURFUl9OQU1FICR7bmFtZX1cXG4ke3RoaXMuZnJhZ21lbnRTcmN9YDtcblxuICAgICAgICAgICAgdGhpcy52ZXJ0ZXhTcmMgPSBzZXRQcmVjaXNpb24odGhpcy52ZXJ0ZXhTcmMsIHNldHRpbmdzLlBSRUNJU0lPTl9WRVJURVgsIFBSRUNJU0lPTi5ISUdIKTtcbiAgICAgICAgICAgIHRoaXMuZnJhZ21lbnRTcmMgPSBzZXRQcmVjaXNpb24odGhpcy5mcmFnbWVudFNyYywgc2V0dGluZ3MuUFJFQ0lTSU9OX0ZSQUdNRU5ULCBnZXRNYXhGcmFnbWVudFByZWNpc2lvbigpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGN1cnJlbnRseSB0aGlzIGRvZXMgbm90IGV4dHJhY3Qgc3RydWN0cyBvbmx5IGRlZmF1bHQgdHlwZXNcbiAgICAgICAgdGhpcy5leHRyYWN0RGF0YSh0aGlzLnZlcnRleFNyYywgdGhpcy5mcmFnbWVudFNyYyk7XG5cbiAgICAgICAgLy8gdGhpcyBpcyB3aGVyZSB3ZSBzdG9yZSBzaGFkZXIgcmVmZXJlbmNlcy4uXG4gICAgICAgIHRoaXMuZ2xQcm9ncmFtcyA9IHt9O1xuXG4gICAgICAgIHRoaXMuc3luY1VuaWZvcm1zID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0cyB0aGUgZGF0YSBmb3IgYSBidXkgY3JlYXRpbmcgYSBzbWFsbCB0ZXN0IHByb2dyYW1cbiAgICAgKiBvciByZWFkaW5nIHRoZSBzcmMgZGlyZWN0bHkuXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFt2ZXJ0ZXhTcmNdIC0gVGhlIHNvdXJjZSBvZiB0aGUgdmVydGV4IHNoYWRlci5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2ZyYWdtZW50U3JjXSAtIFRoZSBzb3VyY2Ugb2YgdGhlIGZyYWdtZW50IHNoYWRlci5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZXh0cmFjdERhdGEodmVydGV4U3JjOiBzdHJpbmcsIGZyYWdtZW50U3JjOiBzdHJpbmcpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IGdldFRlc3RDb250ZXh0KCk7XG5cbiAgICAgICAgaWYgKGdsKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwcm9ncmFtID0gY29tcGlsZVByb2dyYW0oZ2wsIHZlcnRleFNyYywgZnJhZ21lbnRTcmMpO1xuXG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZURhdGEgPSB0aGlzLmdldEF0dHJpYnV0ZURhdGEocHJvZ3JhbSwgZ2wpO1xuICAgICAgICAgICAgdGhpcy51bmlmb3JtRGF0YSA9IHRoaXMuZ2V0VW5pZm9ybURhdGEocHJvZ3JhbSwgZ2wpO1xuXG4gICAgICAgICAgICBnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51bmlmb3JtRGF0YSA9IHt9O1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVEYXRhID0ge307XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSBhdHRyaWJ1dGUgZGF0YSBmcm9tIHRoZSBwcm9ncmFtXG4gICAgICogQHByaXZhdGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7V2ViR0xQcm9ncmFtfSBbcHJvZ3JhbV0gLSB0aGUgV2ViR0wgcHJvZ3JhbVxuICAgICAqIEBwYXJhbSB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBbZ2xdIC0gdGhlIFdlYkdMIGNvbnRleHRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHRoZSBhdHRyaWJ1dGUgZGF0YSBmb3IgdGhpcyBwcm9ncmFtXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGdldEF0dHJpYnV0ZURhdGEocHJvZ3JhbTogV2ViR0xQcm9ncmFtLCBnbDogV2ViR0xSZW5kZXJpbmdDb250ZXh0QmFzZSk6IHtba2V5OiBzdHJpbmddOiBJQXR0cmlidXRlRGF0YX1cbiAgICB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXM6IHtba2V5OiBzdHJpbmddOiBJQXR0cmlidXRlRGF0YX0gPSB7fTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlc0FycmF5OiBBcnJheTxJQXR0cmlidXRlRGF0YT4gPSBbXTtcblxuICAgICAgICBjb25zdCB0b3RhbEF0dHJpYnV0ZXMgPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIGdsLkFDVElWRV9BVFRSSUJVVEVTKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsQXR0cmlidXRlczsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJEYXRhID0gZ2wuZ2V0QWN0aXZlQXR0cmliKHByb2dyYW0sIGkpO1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IG1hcFR5cGUoZ2wsIGF0dHJpYkRhdGEudHlwZSk7XG5cbiAgICAgICAgICAgIC8qZXNsaW50LWRpc2FibGUgKi9cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBuYW1lOiBhdHRyaWJEYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgc2l6ZTogbWFwU2l6ZSh0eXBlKSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbjogMCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlICovXG5cbiAgICAgICAgICAgIGF0dHJpYnV0ZXNbYXR0cmliRGF0YS5uYW1lXSA9IGRhdGE7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzQXJyYXkucHVzaChkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF0dHJpYnV0ZXNBcnJheS5zb3J0KChhLCBiKSA9PiAoYS5uYW1lID4gYi5uYW1lKSA/IDEgOiAtMSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uZnVzaW5nLWFycm93XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXNBcnJheVtpXS5sb2NhdGlvbiA9IGk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSB1bmlmb3JtIGRhdGEgZnJvbSB0aGUgcHJvZ3JhbVxuICAgICAqIEBwcml2YXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3dlYkdMLXByb2dyYW19IFtwcm9ncmFtXSAtIHRoZSB3ZWJnbCBwcm9ncmFtXG4gICAgICogQHBhcmFtIHtjb250ZXh0fSBbZ2xdIC0gdGhlIFdlYkdMIGNvbnRleHRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHRoZSB1bmlmb3JtIGRhdGEgZm9yIHRoaXMgcHJvZ3JhbVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0VW5pZm9ybURhdGEocHJvZ3JhbTogV2ViR0xQcm9ncmFtLCBnbDogV2ViR0xSZW5kZXJpbmdDb250ZXh0QmFzZSk6IHtba2V5OiBzdHJpbmddOiBJVW5pZm9ybURhdGF9XG4gICAge1xuICAgICAgICBjb25zdCB1bmlmb3Jtczoge1trZXk6IHN0cmluZ106IElVbmlmb3JtRGF0YX0gPSB7fTtcblxuICAgICAgICBjb25zdCB0b3RhbFVuaWZvcm1zID0gZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5BQ1RJVkVfVU5JRk9STVMpO1xuXG4gICAgICAgIC8vIFRPRE8gZXhwb3NlIHRoaXMgYXMgYSBwcm9wP1xuICAgICAgICAvLyBjb25zdCBtYXNrUmVnZXggPSBuZXcgUmVnRXhwKCdeKHByb2plY3Rpb25NYXRyaXh8dVNhbXBsZXJ8dHJhbnNsYXRpb25NYXRyaXgpJCcpO1xuICAgICAgICAvLyBjb25zdCBtYXNrUmVnZXggPSBuZXcgUmVnRXhwKCdeKHByb2plY3Rpb25NYXRyaXh8dVNhbXBsZXJ8dHJhbnNsYXRpb25NYXRyaXgpJCcpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWxVbmlmb3JtczsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB1bmlmb3JtRGF0YSA9IGdsLmdldEFjdGl2ZVVuaWZvcm0ocHJvZ3JhbSwgaSk7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gdW5pZm9ybURhdGEubmFtZS5yZXBsYWNlKC9cXFsuKj9cXF0kLywgJycpO1xuXG4gICAgICAgICAgICBjb25zdCBpc0FycmF5ID0gdW5pZm9ybURhdGEubmFtZS5tYXRjaCgvXFxbLio/XFxdJC8pO1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IG1hcFR5cGUoZ2wsIHVuaWZvcm1EYXRhLnR5cGUpO1xuXG4gICAgICAgICAgICAvKmVzbGludC1kaXNhYmxlICovXG4gICAgICAgICAgICB1bmlmb3Jtc1tuYW1lXSA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIHNpemU6IHVuaWZvcm1EYXRhLnNpemUsXG4gICAgICAgICAgICAgICAgaXNBcnJheTppc0FycmF5LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBkZWZhdWx0VmFsdWUodHlwZSwgdW5pZm9ybURhdGEuc2l6ZSksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSAqL1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHVuaWZvcm1zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBkZWZhdWx0IHZlcnRleCBzaGFkZXIgc291cmNlXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQGNvbnN0YW50XG4gICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAqL1xuICAgIHN0YXRpYyBnZXQgZGVmYXVsdFZlcnRleFNyYygpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmVydGV4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBkZWZhdWx0IGZyYWdtZW50IHNoYWRlciBzb3VyY2VcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAY29uc3RhbnRcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICovXG4gICAgc3RhdGljIGdldCBkZWZhdWx0RnJhZ21lbnRTcmMoKTogc3RyaW5nXG4gICAge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEZyYWdtZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc2hvcnQgaGFuZCBmdW5jdGlvbiB0byBjcmVhdGUgYSBwcm9ncmFtIGJhc2VkIG9mIGEgdmVydGV4IGFuZCBmcmFnbWVudCBzaGFkZXJcbiAgICAgKiB0aGlzIG1ldGhvZCB3aWxsIGFsc28gY2hlY2sgdG8gc2VlIGlmIHRoZXJlIGlzIGEgY2FjaGVkIHByb2dyYW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3ZlcnRleFNyY10gLSBUaGUgc291cmNlIG9mIHRoZSB2ZXJ0ZXggc2hhZGVyLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbZnJhZ21lbnRTcmNdIC0gVGhlIHNvdXJjZSBvZiB0aGUgZnJhZ21lbnQgc2hhZGVyLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbmFtZT1waXhpLXNoYWRlcl0gLSBOYW1lIGZvciBzaGFkZXJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQSVhJLlByb2dyYW19IGFuIHNoaW55IG5ldyBQaXhpIHNoYWRlciFcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbSh2ZXJ0ZXhTcmM/OiBzdHJpbmcsIGZyYWdtZW50U3JjPzogc3RyaW5nLCBuYW1lPzogc3RyaW5nKTogUHJvZ3JhbVxuICAgIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdmVydGV4U3JjICsgZnJhZ21lbnRTcmM7XG5cbiAgICAgICAgbGV0IHByb2dyYW0gPSBQcm9ncmFtQ2FjaGVba2V5XTtcblxuICAgICAgICBpZiAoIXByb2dyYW0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIFByb2dyYW1DYWNoZVtrZXldID0gcHJvZ3JhbSA9IG5ldyBQcm9ncmFtKHZlcnRleFNyYywgZnJhZ21lbnRTcmMsIG5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb2dyYW07XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFByb2dyYW0gfSBmcm9tICcuL1Byb2dyYW0nO1xuaW1wb3J0IHsgVW5pZm9ybUdyb3VwIH0gZnJvbSAnLi9Vbmlmb3JtR3JvdXAnO1xuXG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbi8qKlxuICogQSBoZWxwZXIgY2xhc3MgZm9yIHNoYWRlcnNcbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBTaGFkZXJcbntcbiAgICBwdWJsaWMgcHJvZ3JhbTogUHJvZ3JhbTtcbiAgICBwdWJsaWMgdW5pZm9ybUdyb3VwOiBVbmlmb3JtR3JvdXA7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlByb2dyYW19IFtwcm9ncmFtXSAtIFRoZSBwcm9ncmFtIHRoZSBzaGFkZXIgd2lsbCB1c2UuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFt1bmlmb3Jtc10gLSBDdXN0b20gdW5pZm9ybXMgdG8gdXNlIHRvIGF1Z21lbnQgdGhlIGJ1aWx0LWluIG9uZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJvZ3JhbTogUHJvZ3JhbSwgdW5pZm9ybXM6IERpY3Q8YW55PilcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcm9ncmFtIHRoYXQgdGhlIHNoYWRlciB1c2VzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUHJvZ3JhbX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW07XG5cbiAgICAgICAgLy8gbGV0cyBzZWUgd2hhdHMgYmVlbiBwYXNzZWQgaW5cbiAgICAgICAgLy8gdW5pZm9ybXMgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHVuaWZvcm0gZ3JvdXBcbiAgICAgICAgaWYgKHVuaWZvcm1zKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodW5pZm9ybXMgaW5zdGFuY2VvZiBVbmlmb3JtR3JvdXApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmlmb3JtR3JvdXAgPSB1bmlmb3JtcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuaWZvcm1Hcm91cCA9IG5ldyBVbmlmb3JtR3JvdXAodW5pZm9ybXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51bmlmb3JtR3JvdXAgPSBuZXcgVW5pZm9ybUdyb3VwKHt9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRpbWUgdG8gYnVpbGQgc29tZSBnZXR0ZXJzIGFuZCBzZXR0ZXJzIVxuICAgICAgICAvLyBJIGd1ZXNzIGRvd24gdGhlIGxpbmUgdGhpcyBjb3VsZCBzb3J0IG9mIGdlbmVyYXRlIGFuIGluc3RydWN0aW9uIGxpc3QgcmF0aGVyIHRoYW4gdXNlIGRpcnR5IGlkcz9cbiAgICAgICAgLy8gZG9lcyB0aGUgdHJpY2sgZm9yIG5vdyB0aG91Z2ghXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiBwcm9ncmFtLnVuaWZvcm1EYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy51bmlmb3JtR3JvdXAudW5pZm9ybXNbaV0gaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuaWZvcm1Hcm91cC51bmlmb3Jtc1tpXSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy51bmlmb3JtR3JvdXAudW5pZm9ybXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVE9ETyBtb3ZlIHRvIHNoYWRlciBzeXN0ZW0uLlxuICAgIGNoZWNrVW5pZm9ybUV4aXN0cyhuYW1lOiBzdHJpbmcsIGdyb3VwOiBVbmlmb3JtR3JvdXApOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAoZ3JvdXAudW5pZm9ybXNbbmFtZV0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBpIGluIGdyb3VwLnVuaWZvcm1zKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB1bmlmb3JtID0gZ3JvdXAudW5pZm9ybXNbaV07XG5cbiAgICAgICAgICAgIGlmICh1bmlmb3JtLmdyb3VwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrVW5pZm9ybUV4aXN0cyhuYW1lLCB1bmlmb3JtKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIHVzYWdlIGNvdW50IG9uIHByb2dyYW1zP1xuICAgICAgICAvLyByZW1vdmUgaWYgbm90IHVzZWQhXG4gICAgICAgIHRoaXMudW5pZm9ybUdyb3VwID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaGFkZXIgdW5pZm9ybSB2YWx1ZXMsIHNob3J0Y3V0IGZvciBgdW5pZm9ybUdyb3VwLnVuaWZvcm1zYFxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgKi9cbiAgICBnZXQgdW5pZm9ybXMoKTogRGljdDxhbnk+XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy51bmlmb3JtR3JvdXAudW5pZm9ybXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzaG9ydCBoYW5kIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHNoYWRlciBiYXNlZCBvZiBhIHZlcnRleCBhbmQgZnJhZ21lbnQgc2hhZGVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3ZlcnRleFNyY10gLSBUaGUgc291cmNlIG9mIHRoZSB2ZXJ0ZXggc2hhZGVyLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbZnJhZ21lbnRTcmNdIC0gVGhlIHNvdXJjZSBvZiB0aGUgZnJhZ21lbnQgc2hhZGVyLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbdW5pZm9ybXNdIC0gQ3VzdG9tIHVuaWZvcm1zIHRvIHVzZSB0byBhdWdtZW50IHRoZSBidWlsdC1pbiBvbmVzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1BJWEkuU2hhZGVyfSBhbiBzaGlueSBuZXcgUGl4aSBzaGFkZXIhXG4gICAgICovXG4gICAgc3RhdGljIGZyb20odmVydGV4U3JjPzogc3RyaW5nLCBmcmFnbWVudFNyYz86IHN0cmluZywgdW5pZm9ybXM/OiBEaWN0PGFueT4pOiBTaGFkZXJcbiAgICB7XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSBQcm9ncmFtLmZyb20odmVydGV4U3JjLCBmcmFnbWVudFNyYyk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBTaGFkZXIocHJvZ3JhbSwgdW5pZm9ybXMpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBCTEVORF9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuY29uc3QgQkxFTkQgPSAwO1xuY29uc3QgT0ZGU0VUID0gMTtcbmNvbnN0IENVTExJTkcgPSAyO1xuY29uc3QgREVQVEhfVEVTVCA9IDM7XG5jb25zdCBXSU5ESU5HID0gNDtcblxuLyoqXG4gKiBUaGlzIGlzIGEgV2ViR0wgc3RhdGUsIGFuZCBpcyBpcyBwYXNzZWQgVGhlIFdlYkdMIFN0YXRlTWFuYWdlci5cbiAqXG4gKiBFYWNoIG1lc2ggcmVuZGVyZWQgbWF5IHJlcXVpcmUgV2ViR0wgdG8gYmUgaW4gYSBkaWZmZXJlbnQgc3RhdGUuXG4gKiBGb3IgZXhhbXBsZSB5b3UgbWF5IHdhbnQgZGlmZmVyZW50IGJsZW5kIG1vZGUgb3IgdG8gZW5hYmxlIHBvbHlnb24gb2Zmc2V0c1xuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFN0YXRlXG57XG4gICAgZGF0YTogbnVtYmVyO1xuICAgIF9ibGVuZE1vZGU6IEJMRU5EX01PREVTO1xuICAgIF9wb2x5Z29uT2Zmc2V0OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICB0aGlzLmRhdGEgPSAwO1xuXG4gICAgICAgIHRoaXMuYmxlbmRNb2RlID0gQkxFTkRfTU9ERVMuTk9STUFMO1xuICAgICAgICB0aGlzLnBvbHlnb25PZmZzZXQgPSAwO1xuXG4gICAgICAgIHRoaXMuYmxlbmQgPSB0cnVlO1xuICAgICAgICAvLyAgdGhpcy5kZXB0aFRlc3QgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFjdGl2YXRlcyBibGVuZGluZyBvZiB0aGUgY29tcHV0ZWQgZnJhZ21lbnQgY29sb3IgdmFsdWVzXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBibGVuZCgpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gISEodGhpcy5kYXRhICYgKDEgPDwgQkxFTkQpKTtcbiAgICB9XG5cbiAgICBzZXQgYmxlbmQodmFsdWU6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAoISEodGhpcy5kYXRhICYgKDEgPDwgQkxFTkQpKSAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSBePSAoMSA8PCBCTEVORCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBY3RpdmF0ZXMgYWRkaW5nIGFuIG9mZnNldCB0byBkZXB0aCB2YWx1ZXMgb2YgcG9seWdvbidzIGZyYWdtZW50c1xuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAqL1xuICAgIGdldCBvZmZzZXRzKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAhISh0aGlzLmRhdGEgJiAoMSA8PCBPRkZTRVQpKTtcbiAgICB9XG5cbiAgICBzZXQgb2Zmc2V0cyh2YWx1ZTogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICghISh0aGlzLmRhdGEgJiAoMSA8PCBPRkZTRVQpKSAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSBePSAoMSA8PCBPRkZTRVQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWN0aXZhdGVzIGN1bGxpbmcgb2YgcG9seWdvbnMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICovXG4gICAgZ2V0IGN1bGxpbmcoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuICEhKHRoaXMuZGF0YSAmICgxIDw8IENVTExJTkcpKTtcbiAgICB9XG5cbiAgICBzZXQgY3VsbGluZyh2YWx1ZTogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICghISh0aGlzLmRhdGEgJiAoMSA8PCBDVUxMSU5HKSkgIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgXj0gKDEgPDwgQ1VMTElORyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBY3RpdmF0ZXMgZGVwdGggY29tcGFyaXNvbnMgYW5kIHVwZGF0ZXMgdG8gdGhlIGRlcHRoIGJ1ZmZlci5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgKi9cbiAgICBnZXQgZGVwdGhUZXN0KCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiAhISh0aGlzLmRhdGEgJiAoMSA8PCBERVBUSF9URVNUKSk7XG4gICAgfVxuXG4gICAgc2V0IGRlcHRoVGVzdCh2YWx1ZTogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICghISh0aGlzLmRhdGEgJiAoMSA8PCBERVBUSF9URVNUKSkgIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgXj0gKDEgPDwgREVQVEhfVEVTVCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgZnJvbnQgb3IgYmFjay1mYWNpbmcgcG9seWdvbnMgY2FuIGJlIGN1bGxlZC5cbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICovXG4gICAgZ2V0IGNsb2Nrd2lzZUZyb250RmFjZSgpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gISEodGhpcy5kYXRhICYgKDEgPDwgV0lORElORykpO1xuICAgIH1cblxuICAgIHNldCBjbG9ja3dpc2VGcm9udEZhY2UodmFsdWU6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAoISEodGhpcy5kYXRhICYgKDEgPDwgV0lORElORykpICE9PSB2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5kYXRhIF49ICgxIDw8IFdJTkRJTkcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJsZW5kIG1vZGUgdG8gYmUgYXBwbGllZCB3aGVuIHRoaXMgc3RhdGUgaXMgc2V0LiBBcHBseSBhIHZhbHVlIG9mIGBQSVhJLkJMRU5EX01PREVTLk5PUk1BTGAgdG8gcmVzZXQgdGhlIGJsZW5kIG1vZGUuXG4gICAgICogU2V0dGluZyB0aGlzIG1vZGUgdG8gYW55dGhpbmcgb3RoZXIgdGhhbiBOT19CTEVORCB3aWxsIGF1dG9tYXRpY2FsbHkgc3dpdGNoIGJsZW5kaW5nIG9uLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMXG4gICAgICogQHNlZSBQSVhJLkJMRU5EX01PREVTXG4gICAgICovXG4gICAgZ2V0IGJsZW5kTW9kZSgpOiBCTEVORF9NT0RFU1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JsZW5kTW9kZTtcbiAgICB9XG5cbiAgICBzZXQgYmxlbmRNb2RlKHZhbHVlOiBCTEVORF9NT0RFUylcbiAgICB7XG4gICAgICAgIHRoaXMuYmxlbmQgPSAodmFsdWUgIT09IEJMRU5EX01PREVTLk5PTkUpO1xuICAgICAgICB0aGlzLl9ibGVuZE1vZGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcG9seWdvbiBvZmZzZXQuIFNldHRpbmcgdGhpcyBwcm9wZXJ0eSB0byBhbnl0aGluZyBvdGhlciB0aGFuIDAgd2lsbCBhdXRvbWF0aWNhbGx5IGVuYWJsZSBwb2x5Z29uIG9mZnNldCBmaWxsLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDBcbiAgICAgKi9cbiAgICBnZXQgcG9seWdvbk9mZnNldCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb2x5Z29uT2Zmc2V0O1xuICAgIH1cblxuICAgIHNldCBwb2x5Z29uT2Zmc2V0KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLm9mZnNldHMgPSAhIXZhbHVlO1xuICAgICAgICB0aGlzLl9wb2x5Z29uT2Zmc2V0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgc3RhdGljIGZvcjJkKCk6IFN0YXRlXG4gICAge1xuICAgICAgICBjb25zdCBzdGF0ZSA9IG5ldyBTdGF0ZSgpO1xuXG4gICAgICAgIHN0YXRlLmRlcHRoVGVzdCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5ibGVuZCA9IHRydWU7XG5cbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cbn1cblxuIiwgImltcG9ydCB7IFNoYWRlciB9IGZyb20gJy4uL3NoYWRlci9TaGFkZXInO1xuaW1wb3J0IHsgUHJvZ3JhbSB9IGZyb20gJy4uL3NoYWRlci9Qcm9ncmFtJztcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvU3RhdGUnO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5pbXBvcnQgZGVmYXVsdFZlcnRleCBmcm9tICcuL2RlZmF1bHRGaWx0ZXIudmVydCc7XG5pbXBvcnQgZGVmYXVsdEZyYWdtZW50IGZyb20gJy4vZGVmYXVsdEZpbHRlci5mcmFnJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJUZXh0dXJlIH0gZnJvbSAnLi4vcmVuZGVyVGV4dHVyZS9SZW5kZXJUZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgRmlsdGVyU3lzdGVtIH0gZnJvbSAnLi9GaWx0ZXJTeXN0ZW0nO1xuaW1wb3J0IHR5cGUgeyBGaWx0ZXJTdGF0ZSB9IGZyb20gJy4vRmlsdGVyU3RhdGUnO1xuaW1wb3J0IHR5cGUgeyBCTEVORF9NT0RFUywgQ0xFQVJfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG4vKipcbiAqIEZpbHRlciBpcyBhIHNwZWNpYWwgdHlwZSBvZiBXZWJHTCBzaGFkZXIgdGhhdCBpcyBhcHBsaWVkIHRvIHRoZSBzY3JlZW4uXG4gKlxuICoge0BsaW5rIGh0dHA6Ly9waXhpanMuaW8vZXhhbXBsZXMvIy9maWx0ZXJzL2JsdXItZmlsdGVyLmpzIEV4YW1wbGV9IG9mIHRoZVxuICoge0BsaW5rIFBJWEkuZmlsdGVycy5CbHVyRmlsdGVyIEJsdXJGaWx0ZXJ9LlxuICpcbiAqICMjIyBVc2FnZVxuICogRmlsdGVycyBjYW4gYmUgYXBwbGllZCB0byBhbnkgRGlzcGxheU9iamVjdCBvciBDb250YWluZXIuXG4gKiBQaXhpSlMnIGBGaWx0ZXJTeXN0ZW1gIHJlbmRlcnMgdGhlIGNvbnRhaW5lciBpbnRvIHRlbXBvcmFyeSBGcmFtZWJ1ZmZlcixcbiAqIHRoZW4gZmlsdGVyIHJlbmRlcnMgaXQgdG8gdGhlIHNjcmVlbi5cbiAqIE11bHRpcGxlIGZpbHRlcnMgY2FuIGJlIGFkZGVkIHRvIHRoZSBgZmlsdGVyc2AgYXJyYXkgcHJvcGVydHkgYW5kIHN0YWNrZWQgb24gZWFjaCBvdGhlci5cbiAqXG4gKiBgYGBcbiAqIGNvbnN0IGZpbHRlciA9IG5ldyBQSVhJLkZpbHRlcihteVNoYWRlclZlcnQsIG15U2hhZGVyRnJhZywgeyBteVVuaWZvcm06IDAuNSB9KTtcbiAqIGNvbnN0IGNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICogY29udGFpbmVyLmZpbHRlcnMgPSBbZmlsdGVyXTtcbiAqIGBgYFxuICpcbiAqICMjIyBQcmV2aW91cyBWZXJzaW9uIERpZmZlcmVuY2VzXG4gKlxuICogSW4gUGl4aUpTICoqdjMqKiwgYSBmaWx0ZXIgd2FzIGFsd2F5cyBhcHBsaWVkIHRvIF93aG9sZSBzY3JlZW5fLlxuICpcbiAqIEluIFBpeGlKUyAqKnY0KiosIGEgZmlsdGVyIGNhbiBiZSBhcHBsaWVkIF9vbmx5IHBhcnQgb2YgdGhlIHNjcmVlbl8uXG4gKiBEZXZlbG9wZXJzIGhhZCB0byBjcmVhdGUgYSBzZXQgb2YgdW5pZm9ybXMgdG8gZGVhbCB3aXRoIGNvb3JkaW5hdGVzLlxuICpcbiAqIEluIFBpeGlKUyAqKnY1KiogY29tYmluZXMgX2JvdGggYXBwcm9hY2hlc18uXG4gKiBEZXZlbG9wZXJzIGNhbiB1c2Ugbm9ybWFsIGNvb3JkaW5hdGVzIG9mIHYzIGFuZCB0aGVuIGFsbG93IGZpbHRlciB0byB1c2UgcGFydGlhbCBGcmFtZWJ1ZmZlcnMsXG4gKiBicmluZ2luZyB0aG9zZSBleHRyYSB1bmlmb3JtcyBpbnRvIGFjY291bnQuXG4gKlxuICogQWxzbyBiZSBhd2FyZSB0aGF0IHdlIGhhdmUgY2hhbmdlZCBkZWZhdWx0IHZlcnRleCBzaGFkZXIsIHBsZWFzZSBjb25zdWx0XG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3BpeGlqcy9waXhpLmpzL3dpa2kvdjUtQ3JlYXRpbmctZmlsdGVycyBXaWtpfS5cbiAqXG4gKiAjIyMgQnVpbHQtaW4gVW5pZm9ybXNcbiAqXG4gKiBQaXhpSlMgdmlld3BvcnQgdXNlcyBzY3JlZW4gKENTUykgY29vcmRpbmF0ZXMsIGAoMCwgMCwgcmVuZGVyZXIuc2NyZWVuLndpZHRoLCByZW5kZXJlci5zY3JlZW4uaGVpZ2h0KWAsXG4gKiBhbmQgYHByb2plY3Rpb25NYXRyaXhgIHVuaWZvcm0gbWFwcyBpdCB0byB0aGUgZ2wgdmlld3BvcnQuXG4gKlxuICogKip1U2FtcGxlcioqXG4gKlxuICogVGhlIG1vc3QgaW1wb3J0YW50IHVuaWZvcm0gaXMgdGhlIGlucHV0IHRleHR1cmUgdGhhdCBjb250YWluZXIgd2FzIHJlbmRlcmVkIGludG8uXG4gKiBfSW1wb3J0YW50IG5vdGU6IGFzIHdpdGggYWxsIEZyYW1lYnVmZmVycyBpbiBQaXhpSlMsIGJvdGggaW5wdXQgYW5kIG91dHB1dCBhcmVcbiAqIHByZW11bHRpcGxpZWQgYnkgYWxwaGEuX1xuICpcbiAqIEJ5IGRlZmF1bHQsIGlucHV0IG5vcm1hbGl6ZWQgY29vcmRpbmF0ZXMgYXJlIHBhc3NlZCB0byBmcmFnbWVudCBzaGFkZXIgd2l0aCBgdlRleHR1cmVDb29yZGAuXG4gKiBVc2UgaXQgdG8gc2FtcGxlIHRoZSBpbnB1dC5cbiAqXG4gKiBgYGBcbiAqIGNvbnN0IGZyYWdtZW50ID0gYFxuICogdmFyeWluZyB2ZWMyIHZUZXh0dXJlQ29vcmQ7XG4gKiB1bmlmb3JtIHNhbXBsZXIyRCB1U2FtcGxlcjtcbiAqIHZvaWQgbWFpbih2b2lkKVxuICoge1xuICogICAgZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKHVTYW1wbGVyLCB2VGV4dHVyZUNvb3JkKTtcbiAqIH1cbiAqIGA7XG4gKlxuICogY29uc3QgbXlGaWx0ZXIgPSBuZXcgUElYSS5GaWx0ZXIobnVsbCwgZnJhZ21lbnQpO1xuICogYGBgXG4gKlxuICogVGhpcyBmaWx0ZXIgaXMganVzdCBvbmUgdW5pZm9ybSBsZXNzIHRoYW4ge0BsaW5rIFBJWEkuZmlsdGVycy5BbHBoYUZpbHRlciBBbHBoYUZpbHRlcn0uXG4gKlxuICogKipvdXRwdXRGcmFtZSoqXG4gKlxuICogVGhlIGBvdXRwdXRGcmFtZWAgaG9sZHMgdGhlIHJlY3RhbmdsZSB3aGVyZSBmaWx0ZXIgaXMgYXBwbGllZCBpbiBzY3JlZW4gKENTUykgY29vcmRpbmF0ZXMuXG4gKiBJdCdzIHRoZSBzYW1lIGFzIGByZW5kZXJlci5zY3JlZW5gIGZvciBhIGZ1bGxzY3JlZW4gZmlsdGVyLlxuICogT25seSBhIHBhcnQgb2YgIGBvdXRwdXRGcmFtZS56d2Agc2l6ZSBvZiB0ZW1wb3JhcnkgRnJhbWVidWZmZXIgaXMgdXNlZCxcbiAqIGAoMCwgMCwgb3V0cHV0RnJhbWUud2lkdGgsIG91dHB1dEZyYW1lLmhlaWdodClgLFxuICpcbiAqIEZpbHRlcnMgdXNlcyB0aGlzIHF1YWQgdG8gbm9ybWFsaXplZCAoMC0xKSBzcGFjZSwgaXRzIHBhc3NlZCBpbnRvIGBhVmVydGV4UG9zaXRpb25gIGF0dHJpYnV0ZS5cbiAqIFRvIGNhbGN1bGF0ZSB2ZXJ0ZXggcG9zaXRpb24gaW4gc2NyZWVuIHNwYWNlIHVzaW5nIG5vcm1hbGl6ZWQgKDAtMSkgc3BhY2U6XG4gKlxuICogYGBgXG4gKiB2ZWM0IGZpbHRlclZlcnRleFBvc2l0aW9uKCB2b2lkIClcbiAqIHtcbiAqICAgICB2ZWMyIHBvc2l0aW9uID0gYVZlcnRleFBvc2l0aW9uICogbWF4KG91dHB1dEZyYW1lLnp3LCB2ZWMyKDAuKSkgKyBvdXRwdXRGcmFtZS54eTtcbiAqICAgICByZXR1cm4gdmVjNCgocHJvamVjdGlvbk1hdHJpeCAqIHZlYzMocG9zaXRpb24sIDEuMCkpLnh5LCAwLjAsIDEuMCk7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiAqKmlucHV0U2l6ZSoqXG4gKlxuICogVGVtcG9yYXJ5IGZyYW1lYnVmZmVyIGlzIGRpZmZlcmVudCwgaXQgY2FuIGJlIGVpdGhlciB0aGUgc2l6ZSBvZiBzY3JlZW4sIGVpdGhlciBwb3dlci1vZi10d28uXG4gKiBUaGUgYGlucHV0U2l6ZS54eWAgYXJlIHNpemUgb2YgdGVtcG9yYXJ5IGZyYW1lYnVmZmVyIHRoYXQgaG9sZHMgaW5wdXQuXG4gKiBUaGUgYGlucHV0U2l6ZS56d2AgaXMgaW52ZXJ0ZWQsIGl0J3MgYSBzaG9ydGN1dCB0byBldmFkZSBkaXZpc2lvbiBpbnNpZGUgdGhlIHNoYWRlci5cbiAqXG4gKiBTZXQgYGlucHV0U2l6ZS54eSA9IG91dHB1dEZyYW1lLnp3YCBmb3IgYSBmdWxsc2NyZWVuIGZpbHRlci5cbiAqXG4gKiBUbyBjYWxjdWxhdGUgaW5wdXQgbm9ybWFsaXplZCBjb29yZGluYXRlLCB5b3UgaGF2ZSB0byBtYXAgaXQgdG8gZmlsdGVyIG5vcm1hbGl6ZWQgc3BhY2UuXG4gKiBNdWx0aXBseSBieSBgb3V0cHV0RnJhbWUuendgIHRvIGdldCBpbnB1dCBjb29yZGluYXRlLlxuICogRGl2aWRlIGJ5IGBpbnB1dFNpemUueHlgIHRvIGdldCBpbnB1dCBub3JtYWxpemVkIGNvb3JkaW5hdGUuXG4gKlxuICogYGBgXG4gKiB2ZWMyIGZpbHRlclRleHR1cmVDb29yZCggdm9pZCApXG4gKiB7XG4gKiAgICAgcmV0dXJuIGFWZXJ0ZXhQb3NpdGlvbiAqIChvdXRwdXRGcmFtZS56dyAqIGlucHV0U2l6ZS56dyk7IC8vIHNhbWUgYXMgL2lucHV0U2l6ZS54eVxuICogfVxuICogYGBgXG4gKiAqKnJlc29sdXRpb24qKlxuICpcbiAqIFRoZSBgcmVzb2x1dGlvbmAgaXMgdGhlIHJhdGlvIG9mIHNjcmVlbiAoQ1NTKSBwaXhlbHMgdG8gcmVhbCBwaXhlbHMuXG4gKlxuICogKippbnB1dFBpeGVsKipcbiAqXG4gKiBgaW5wdXRQaXhlbC54eWAgaXMgdGhlIHNpemUgb2YgZnJhbWVidWZmZXIgaW4gcmVhbCBwaXhlbHMsIHNhbWUgYXMgYGlucHV0U2l6ZS54eSAqIHJlc29sdXRpb25gXG4gKiBgaW5wdXRQaXhlbC56d2AgaXMgaW52ZXJ0ZWQgYGlucHV0UGl4ZWwueHlgLlxuICpcbiAqIEl0J3MgaGFuZHkgZm9yIGZpbHRlcnMgdGhhdCB1c2UgbmVpZ2hib3VyIHBpeGVscywgbGlrZSB7QGxpbmsgUElYSS5maWx0ZXJzLkZYQUFGaWx0ZXIgRlhBQUZpbHRlcn0uXG4gKlxuICogKippbnB1dENsYW1wKipcbiAqXG4gKiBJZiB5b3UgdHJ5IHRvIGdldCBpbmZvIGZyb20gb3V0c2lkZSBvZiB1c2VkIHBhcnQgb2YgRnJhbWVidWZmZXIgLSB5b3UnbGwgZ2V0IHVuZGVmaW5lZCBiZWhhdmlvdXIuXG4gKiBGb3IgZGlzcGxhY2VtZW50cywgY29vcmRpbmF0ZXMgaGFzIHRvIGJlIGNsYW1wZWQuXG4gKlxuICogVGhlIGBpbnB1dENsYW1wLnh5YCBpcyBsZWZ0LXRvcCBwaXhlbCBjZW50ZXIsIHlvdSBtYXkgaWdub3JlIGl0LCBiZWNhdXNlIHdlIHVzZSBsZWZ0LXRvcCBwYXJ0IG9mIEZyYW1lYnVmZmVyXG4gKiBgaW5wdXRDbGFtcC56d2AgaXMgYm90dG9tLXJpZ2h0IHBpeGVsIGNlbnRlci5cbiAqXG4gKiBgYGBcbiAqIHZlYzQgY29sb3IgPSB0ZXh0dXJlMkQodVNhbXBsZXIsIGNsYW1wKG1vZGlmaWdlZFRleHR1cmVDb29yZCwgaW5wdXRDbGFtcC54eSwgaW5wdXRDbGFtcC56dykpXG4gKiBgYGBcbiAqIE9SXG4gKiBgYGBcbiAqIHZlYzQgY29sb3IgPSB0ZXh0dXJlMkQodVNhbXBsZXIsIG1pbihtb2RpZmlnZWRUZXh0dXJlQ29vcmQsIGlucHV0Q2xhbXAuencpKVxuICogYGBgXG4gKlxuICogIyMjIEFkZGl0aW9uYWwgSW5mb3JtYXRpb25cbiAqXG4gKiBDb21wbGV0ZSBkb2N1bWVudGF0aW9uIG9uIEZpbHRlciB1c2FnZSBpcyBsb2NhdGVkIGluIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9waXhpanMvcGl4aS5qcy93aWtpL3Y1LUNyZWF0aW5nLWZpbHRlcnMgV2lraX0uXG4gKlxuICogU2luY2UgUGl4aUpTIG9ubHkgaGFkIGEgaGFuZGZ1bCBvZiBidWlsdC1pbiBmaWx0ZXJzLCBhZGRpdGlvbmFsIGZpbHRlcnMgY2FuIGJlIGRvd25sb2FkZWRcbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vcGl4aWpzL3BpeGktZmlsdGVycyBoZXJlfSBmcm9tIHRoZSBQaXhpSlMgRmlsdGVycyByZXBvc2l0b3J5LlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBleHRlbmRzIFBJWEkuU2hhZGVyXG4gKi9cbmV4cG9ydCBjbGFzcyBGaWx0ZXIgZXh0ZW5kcyBTaGFkZXJcbntcbiAgICBwdWJsaWMgcGFkZGluZzogbnVtYmVyO1xuICAgIHB1YmxpYyByZXNvbHV0aW9uOiBudW1iZXI7XG4gICAgcHVibGljIGVuYWJsZWQ6IGJvb2xlYW47XG4gICAgcHVibGljIGF1dG9GaXQ6IGJvb2xlYW47XG4gICAgcHVibGljIGxlZ2FjeTogYm9vbGVhbjtcbiAgICBzdGF0ZTogU3RhdGU7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFt2ZXJ0ZXhTcmNdIC0gVGhlIHNvdXJjZSBvZiB0aGUgdmVydGV4IHNoYWRlci5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2ZyYWdtZW50U3JjXSAtIFRoZSBzb3VyY2Ugb2YgdGhlIGZyYWdtZW50IHNoYWRlci5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3VuaWZvcm1zXSAtIEN1c3RvbSB1bmlmb3JtcyB0byB1c2UgdG8gYXVnbWVudCB0aGUgYnVpbHQtaW4gb25lcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih2ZXJ0ZXhTcmM/OiBzdHJpbmcsIGZyYWdtZW50U3JjPzogc3RyaW5nLCB1bmlmb3Jtcz86IERpY3Q8YW55PilcbiAgICB7XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSBQcm9ncmFtLmZyb20odmVydGV4U3JjIHx8IEZpbHRlci5kZWZhdWx0VmVydGV4U3JjLFxuICAgICAgICAgICAgZnJhZ21lbnRTcmMgfHwgRmlsdGVyLmRlZmF1bHRGcmFnbWVudFNyYyk7XG5cbiAgICAgICAgc3VwZXIocHJvZ3JhbSwgdW5pZm9ybXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcGFkZGluZyBvZiB0aGUgZmlsdGVyLiBTb21lIGZpbHRlcnMgcmVxdWlyZSBleHRyYSBzcGFjZSB0byBicmVhdGggc3VjaCBhcyBhIGJsdXIuXG4gICAgICAgICAqIEluY3JlYXNpbmcgdGhpcyB3aWxsIGFkZCBleHRyYSB3aWR0aCBhbmQgaGVpZ2h0IHRvIHRoZSBib3VuZHMgb2YgdGhlIG9iamVjdCB0aGF0IHRoZVxuICAgICAgICAgKiBmaWx0ZXIgaXMgYXBwbGllZCB0by5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wYWRkaW5nID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlc29sdXRpb24gb2YgdGhlIGZpbHRlci4gU2V0dGluZyB0aGlzIHRvIGJlIGxvd2VyIHdpbGwgbG93ZXIgdGhlIHF1YWxpdHkgYnV0XG4gICAgICAgICAqIGluY3JlYXNlIHRoZSBwZXJmb3JtYW5jZSBvZiB0aGUgZmlsdGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlc29sdXRpb24gPSBzZXR0aW5ncy5GSUxURVJfUkVTT0xVVElPTjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgZW5hYmxlZCBpcyB0cnVlIHRoZSBmaWx0ZXIgaXMgYXBwbGllZCwgaWYgZmFsc2UgaXQgd2lsbCBub3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBlbmFibGVkLCBQaXhpSlMgd2lsbCBmaXQgdGhlIGZpbHRlciBhcmVhIGludG8gYm91bmRhcmllcyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLlxuICAgICAgICAgKiBTd2l0Y2ggaXQgb2ZmIGlmIGl0IGRvZXMgbm90IHdvcmsgZm9yIHNwZWNpZmljIHNoYWRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYXV0b0ZpdCA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExlZ2FjeSBmaWx0ZXJzIHVzZSBwb3NpdGlvbiBhbmQgdXZzIGZyb20gYXR0cmlidXRlc1xuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGVnYWN5ID0gISF0aGlzLnByb2dyYW0uYXR0cmlidXRlRGF0YS5hVGV4dHVyZUNvb3JkO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgV2ViR0wgc3RhdGUgdGhlIGZpbHRlciByZXF1aXJlcyB0byByZW5kZXJcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TdGF0ZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3RhdGUgPSBuZXcgU3RhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBmaWx0ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbX0gZmlsdGVyTWFuYWdlciAtIFRoZSByZW5kZXJlciB0byByZXRyaWV2ZSB0aGUgZmlsdGVyIGZyb21cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gaW5wdXQgLSBUaGUgaW5wdXQgcmVuZGVyIHRhcmdldC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gb3V0cHV0IC0gVGhlIHRhcmdldCB0byBvdXRwdXQgdG8uXG4gICAgICogQHBhcmFtIHtQSVhJLkNMRUFSX01PREVTfSBjbGVhck1vZGUgLSBTaG91bGQgdGhlIG91dHB1dCBiZSBjbGVhcmVkIGJlZm9yZSByZW5kZXJpbmcgdG8gaXQuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtjdXJyZW50U3RhdGVdIC0gSXQncyBjdXJyZW50IHN0YXRlIG9mIGZpbHRlci5cbiAgICAgKiAgICAgICAgVGhlcmUgYXJlIHNvbWUgdXNlZnVsIHByb3BlcnRpZXMgaW4gdGhlIGN1cnJlbnRTdGF0ZSA6XG4gICAgICogICAgICAgIHRhcmdldCwgZmlsdGVycywgc291cmNlRnJhbWUsIGRlc3RpbmF0aW9uRnJhbWUsIHJlbmRlclRhcmdldCwgcmVzb2x1dGlvblxuICAgICAqL1xuICAgIGFwcGx5KGZpbHRlck1hbmFnZXI6IEZpbHRlclN5c3RlbSwgaW5wdXQ6IFJlbmRlclRleHR1cmUsIG91dHB1dDogUmVuZGVyVGV4dHVyZSwgY2xlYXJNb2RlOiBDTEVBUl9NT0RFUyxcbiAgICAgICAgX2N1cnJlbnRTdGF0ZT86IEZpbHRlclN0YXRlKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gZG8gYXMgeW91IHBsZWFzZSFcblxuICAgICAgICBmaWx0ZXJNYW5hZ2VyLmFwcGx5RmlsdGVyKHRoaXMsIGlucHV0LCBvdXRwdXQsIGNsZWFyTW9kZSk7XG5cbiAgICAgICAgLy8gb3IganVzdCBkbyBhIHJlZ3VsYXIgcmVuZGVyLi5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBibGVuZG1vZGUgb2YgdGhlIGZpbHRlclxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMXG4gICAgICovXG4gICAgZ2V0IGJsZW5kTW9kZSgpOiBCTEVORF9NT0RFU1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuYmxlbmRNb2RlO1xuICAgIH1cblxuICAgIHNldCBibGVuZE1vZGUodmFsdWU6IEJMRU5EX01PREVTKVxuICAgIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5ibGVuZE1vZGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVmYXVsdCB2ZXJ0ZXggc2hhZGVyIHNvdXJjZVxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICogQGNvbnN0YW50XG4gICAgICovXG4gICAgc3RhdGljIGdldCBkZWZhdWx0VmVydGV4U3JjKCk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWZXJ0ZXg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGRlZmF1bHQgZnJhZ21lbnQgc2hhZGVyIHNvdXJjZVxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICogQGNvbnN0YW50XG4gICAgICovXG4gICAgc3RhdGljIGdldCBkZWZhdWx0RnJhZ21lbnRTcmMoKTogc3RyaW5nXG4gICAge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEZyYWdtZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWQgZm9yIGNhY2hpbmcgc2hhZGVyIElEc1xuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHN0YXRpYyBTT1VSQ0VfS0VZX01BUDogRGljdDxzdHJpbmc+O1xufVxuIiwgImltcG9ydCB7IE1hdHJpeCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG5pbXBvcnQgdHlwZSB7IFRleHR1cmUgfSBmcm9tICcuL1RleHR1cmUnO1xuXG5jb25zdCB0ZW1wTWF0ID0gbmV3IE1hdHJpeCgpO1xuXG4vKipcbiAqIENsYXNzIGNvbnRyb2xzIHV2IG1hcHBpbmcgZnJvbSBUZXh0dXJlIG5vcm1hbCBzcGFjZSB0byBCYXNlVGV4dHVyZSBub3JtYWwgc3BhY2UuXG4gKlxuICogVGFrZXMgYHRyaW1gIGFuZCBgcm90YXRlYCBpbnRvIGFjY291bnQuIE1heSBjb250YWluIGNsYW1wIHNldHRpbmdzIGZvciBNZXNoZXMgYW5kIFRpbGluZ1Nwcml0ZS5cbiAqXG4gKiBDYW4gYmUgdXNlZCBpbiBUZXh0dXJlIGB1dk1hdHJpeGAgZmllbGQsIG9yIHNlcGFyYXRlbHksIHlvdSBjYW4gdXNlIGRpZmZlcmVudCBjbGFtcCBzZXR0aW5ncyBvbiB0aGUgc2FtZSB0ZXh0dXJlLlxuICogSWYgeW91IHdhbnQgdG8gYWRkIHN1cHBvcnQgZm9yIHRleHR1cmUgcmVnaW9uIG9mIGNlcnRhaW4gZmVhdHVyZSBvciBmaWx0ZXIsIHRoYXQncyB3aGF0IHlvdSdyZSBsb29raW5nIGZvci5cbiAqXG4gKiBUYWtlcyB0cmFjayBvZiBUZXh0dXJlIGNoYW5nZXMgdGhyb3VnaCBgX2xhc3RUZXh0dXJlSURgIHByaXZhdGUgZmllbGQuXG4gKiBVc2UgYHVwZGF0ZSgpYCBtZXRob2QgY2FsbCB0byB0cmFjayBpdCBmcm9tIG91dHNpZGUuXG4gKlxuICogQHNlZSBQSVhJLlRleHR1cmVcbiAqIEBzZWUgUElYSS5NZXNoXG4gKiBAc2VlIFBJWEkuVGlsaW5nU3ByaXRlXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0dXJlTWF0cml4XG57XG4gICAgcHVibGljIG1hcENvb3JkOiBNYXRyaXg7XG4gICAgcHVibGljIGNsYW1wT2Zmc2V0OiBudW1iZXI7XG4gICAgcHVibGljIGNsYW1wTWFyZ2luOiBudW1iZXI7XG4gICAgcmVhZG9ubHkgdUNsYW1wRnJhbWU6IEZsb2F0MzJBcnJheTtcbiAgICByZWFkb25seSB1Q2xhbXBPZmZzZXQ6IEZsb2F0MzJBcnJheTtcbiAgICBfdGV4dHVyZUlEOiBudW1iZXI7XG4gICAgX3VwZGF0ZUlEOiBudW1iZXI7XG4gICAgX3RleHR1cmU6IFRleHR1cmU7XG4gICAgaXNTaW1wbGU6IGJvb2xlYW47XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gdGV4dHVyZSAtIG9ic2VydmVkIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2NsYW1wTWFyZ2luXSAtIENoYW5nZXMgZnJhbWUgY2xhbXBpbmcsIDAuNSBieSBkZWZhdWx0LiBVc2UgLTAuNSBmb3IgZXh0cmEgYm9yZGVyLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRleHR1cmU6IFRleHR1cmUsIGNsYW1wTWFyZ2luPzogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IHRleHR1cmU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hdHJpeCBvcGVyYXRpb24gdGhhdCBjb252ZXJ0cyB0ZXh0dXJlIHJlZ2lvbiBjb29yZHMgdG8gdGV4dHVyZSBjb29yZHNcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NYXRyaXh9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXBDb29yZCA9IG5ldyBNYXRyaXgoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xhbXAgcmVnaW9uIGZvciBub3JtYWxpemVkIGNvb3JkcywgbGVmdC10b3AgcGl4ZWwgY2VudGVyIGluIHh5ICwgYm90dG9tLXJpZ2h0IGluIHp3LlxuICAgICAgICAgKiBDYWxjdWxhdGVkIGJhc2VkIG9uIGNsYW1wT2Zmc2V0LlxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51Q2xhbXBGcmFtZSA9IG5ldyBGbG9hdDMyQXJyYXkoNCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5vcm1hbGl6ZWQgY2xhbXAgb2Zmc2V0LlxuICAgICAgICAgKiBDYWxjdWxhdGVkIGJhc2VkIG9uIGNsYW1wT2Zmc2V0LlxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51Q2xhbXBPZmZzZXQgPSBuZXcgRmxvYXQzMkFycmF5KDIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmFja3MgVGV4dHVyZSBmcmFtZSBjaGFuZ2VzXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gLTE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYWNrcyBUZXh0dXJlIGZyYW1lIGNoYW5nZXNcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl91cGRhdGVJRCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoYW5nZXMgZnJhbWUgY2xhbXBpbmdcbiAgICAgICAgICogV29ya3Mgd2l0aCBUaWxpbmdTcHJpdGUgYW5kIE1lc2hcbiAgICAgICAgICogQ2hhbmdlIHRvIDEuNSBpZiB5b3UgdGV4dHVyZSBoYXMgcmVwZWF0ZWQgcmlnaHQgYW5kIGJvdHRvbSBsaW5lcywgdGhhdCBsZWFkcyB0byBzbW9vdGhlciBib3JkZXJzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jbGFtcE9mZnNldCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoYW5nZXMgZnJhbWUgY2xhbXBpbmdcbiAgICAgICAgICogV29ya3Mgd2l0aCBUaWxpbmdTcHJpdGUgYW5kIE1lc2hcbiAgICAgICAgICogQ2hhbmdlIHRvIC0wLjUgdG8gYWRkIGEgcGl4ZWwgdG8gdGhlIGVkZ2UsIHJlY29tbWVuZGVkIGZvciB0cmFuc3BhcmVudCB0cmltbWVkIHRleHR1cmVzIGluIGF0bGFzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IDAuNVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsYW1wTWFyZ2luID0gKHR5cGVvZiBjbGFtcE1hcmdpbiA9PT0gJ3VuZGVmaW5lZCcpID8gMC41IDogY2xhbXBNYXJnaW47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRleHR1cmUgc2l6ZSBpcyB0aGUgc2FtZSBhcyBiYXNlVGV4dHVyZVxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXNTaW1wbGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0ZXh0dXJlIHByb3BlcnR5XG4gICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlfVxuICAgICAqL1xuICAgIGdldCB0ZXh0dXJlKCk6IFRleHR1cmVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0dXJlO1xuICAgIH1cblxuICAgIHNldCB0ZXh0dXJlKHZhbHVlOiBUZXh0dXJlKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLl90ZXh0dXJlSUQgPSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNdWx0aXBsaWVzIHV2cyBhcnJheSB0byB0cmFuc2Zvcm1cbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gdXZzIC0gbWVzaCB1dnNcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gW291dD11dnNdIG91dHB1dFxuICAgICAqIEByZXR1cm5zIHtGbG9hdDMyQXJyYXl9IG91dHB1dFxuICAgICAqL1xuICAgIG11bHRpcGx5VXZzKHV2czogRmxvYXQzMkFycmF5LCBvdXQ/OiBGbG9hdDMyQXJyYXkpOiBGbG9hdDMyQXJyYXlcbiAgICB7XG4gICAgICAgIGlmIChvdXQgPT09IHVuZGVmaW5lZClcbiAgICAgICAge1xuICAgICAgICAgICAgb3V0ID0gdXZzO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWF0ID0gdGhpcy5tYXBDb29yZDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV2cy5sZW5ndGg7IGkgKz0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeCA9IHV2c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHkgPSB1dnNbaSArIDFdO1xuXG4gICAgICAgICAgICBvdXRbaV0gPSAoeCAqIG1hdC5hKSArICh5ICogbWF0LmMpICsgbWF0LnR4O1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9ICh4ICogbWF0LmIpICsgKHkgKiBtYXQuZCkgKyBtYXQudHk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHVwZGF0ZXMgbWF0cmljZXMgaWYgdGV4dHVyZSB3YXMgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2ZvcmNlVXBkYXRlPWZhbHNlXSAtIGlmIHRydWUsIG1hdHJpY2VzIHdpbGwgYmUgdXBkYXRlZCBhbnkgY2FzZVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB3aGV0aGVyIG9yIG5vdCBpdCB3YXMgdXBkYXRlZFxuICAgICAqL1xuICAgIHVwZGF0ZShmb3JjZVVwZGF0ZT86IGJvb2xlYW4pOiBib29sZWFuXG4gICAge1xuICAgICAgICBjb25zdCB0ZXggPSB0aGlzLl90ZXh0dXJlO1xuXG4gICAgICAgIGlmICghdGV4IHx8ICF0ZXgudmFsaWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZm9yY2VVcGRhdGVcbiAgICAgICAgICAgICYmIHRoaXMuX3RleHR1cmVJRCA9PT0gdGV4Ll91cGRhdGVJRClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gdGV4Ll91cGRhdGVJRDtcbiAgICAgICAgdGhpcy5fdXBkYXRlSUQrKztcblxuICAgICAgICBjb25zdCB1dnMgPSB0ZXguX3V2cztcblxuICAgICAgICB0aGlzLm1hcENvb3JkLnNldCh1dnMueDEgLSB1dnMueDAsIHV2cy55MSAtIHV2cy55MCwgdXZzLngzIC0gdXZzLngwLCB1dnMueTMgLSB1dnMueTAsIHV2cy54MCwgdXZzLnkwKTtcblxuICAgICAgICBjb25zdCBvcmlnID0gdGV4Lm9yaWc7XG4gICAgICAgIGNvbnN0IHRyaW0gPSB0ZXgudHJpbTtcblxuICAgICAgICBpZiAodHJpbSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcE1hdC5zZXQob3JpZy53aWR0aCAvIHRyaW0ud2lkdGgsIDAsIDAsIG9yaWcuaGVpZ2h0IC8gdHJpbS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgLXRyaW0ueCAvIHRyaW0ud2lkdGgsIC10cmltLnkgLyB0cmltLmhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLm1hcENvb3JkLmFwcGVuZCh0ZW1wTWF0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRleEJhc2UgPSB0ZXguYmFzZVRleHR1cmU7XG4gICAgICAgIGNvbnN0IGZyYW1lID0gdGhpcy51Q2xhbXBGcmFtZTtcbiAgICAgICAgY29uc3QgbWFyZ2luID0gdGhpcy5jbGFtcE1hcmdpbiAvIHRleEJhc2UucmVzb2x1dGlvbjtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5jbGFtcE9mZnNldDtcblxuICAgICAgICBmcmFtZVswXSA9ICh0ZXguX2ZyYW1lLnggKyBtYXJnaW4gKyBvZmZzZXQpIC8gdGV4QmFzZS53aWR0aDtcbiAgICAgICAgZnJhbWVbMV0gPSAodGV4Ll9mcmFtZS55ICsgbWFyZ2luICsgb2Zmc2V0KSAvIHRleEJhc2UuaGVpZ2h0O1xuICAgICAgICBmcmFtZVsyXSA9ICh0ZXguX2ZyYW1lLnggKyB0ZXguX2ZyYW1lLndpZHRoIC0gbWFyZ2luICsgb2Zmc2V0KSAvIHRleEJhc2Uud2lkdGg7XG4gICAgICAgIGZyYW1lWzNdID0gKHRleC5fZnJhbWUueSArIHRleC5fZnJhbWUuaGVpZ2h0IC0gbWFyZ2luICsgb2Zmc2V0KSAvIHRleEJhc2UuaGVpZ2h0O1xuICAgICAgICB0aGlzLnVDbGFtcE9mZnNldFswXSA9IG9mZnNldCAvIHRleEJhc2UucmVhbFdpZHRoO1xuICAgICAgICB0aGlzLnVDbGFtcE9mZnNldFsxXSA9IG9mZnNldCAvIHRleEJhc2UucmVhbEhlaWdodDtcblxuICAgICAgICB0aGlzLmlzU2ltcGxlID0gdGV4Ll9mcmFtZS53aWR0aCA9PT0gdGV4QmFzZS53aWR0aFxuICAgICAgICAgICAgJiYgdGV4Ll9mcmFtZS5oZWlnaHQgPT09IHRleEJhc2UuaGVpZ2h0XG4gICAgICAgICAgICAmJiB0ZXgucm90YXRlID09PSAwO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBGaWx0ZXIgfSBmcm9tICcuLi9GaWx0ZXInO1xuaW1wb3J0IHsgTWF0cml4LCBQb2ludCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgQ0xFQVJfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHZlcnRleCBmcm9tICcuL3Nwcml0ZU1hc2tGaWx0ZXIudmVydCc7XG5pbXBvcnQgZnJhZ21lbnQgZnJvbSAnLi9zcHJpdGVNYXNrRmlsdGVyLmZyYWcnO1xuaW1wb3J0IHsgVGV4dHVyZU1hdHJpeCB9IGZyb20gJy4uLy4uL3RleHR1cmVzL1RleHR1cmVNYXRyaXgnO1xuXG5pbXBvcnQgdHlwZSB7IEZpbHRlclN5c3RlbSB9IGZyb20gJy4uL0ZpbHRlclN5c3RlbSc7XG5pbXBvcnQgdHlwZSB7IElNYXNrVGFyZ2V0IH0gZnJvbSAnLi4vLi4vbWFzay9NYXNrRGF0YSc7XG5pbXBvcnQgdHlwZSB7IFRleHR1cmUgfSBmcm9tICcuLi8uLi90ZXh0dXJlcy9UZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4uLy4uL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVNwcml0ZU1hc2tUYXJnZXQgZXh0ZW5kcyBJTWFza1RhcmdldFxue1xuICAgIF90ZXh0dXJlOiBUZXh0dXJlO1xuICAgIHdvcmxkQWxwaGE6IG51bWJlcjtcbiAgICBhbmNob3I6IFBvaW50O1xufVxuXG4vKipcbiAqIFRoaXMgaGFuZGxlcyBhIFNwcml0ZSBhY3RpbmcgYXMgYSBtYXNrLCBhcyBvcHBvc2VkIHRvIGEgR3JhcGhpYy5cbiAqXG4gKiBXZWJHTCBvbmx5LlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5GaWx0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJpdGVNYXNrRmlsdGVyIGV4dGVuZHMgRmlsdGVyXG57XG4gICAgbWFza1Nwcml0ZTogSU1hc2tUYXJnZXQ7XG4gICAgbWFza01hdHJpeDogTWF0cml4O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5TcHJpdGV9IHNwcml0ZSAtIHRoZSB0YXJnZXQgc3ByaXRlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3ByaXRlOiBJTWFza1RhcmdldClcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hc2tNYXRyaXggPSBuZXcgTWF0cml4KCk7XG5cbiAgICAgICAgc3VwZXIodmVydGV4LCBmcmFnbWVudCk7XG5cbiAgICAgICAgc3ByaXRlLnJlbmRlcmFibGUgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU3ByaXRlIG1hc2tcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TcHJpdGV9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hc2tTcHJpdGUgPSBzcHJpdGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hc2sgbWF0cml4XG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuTWF0cml4fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXNrTWF0cml4ID0gbWFza01hdHJpeDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBmaWx0ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbX0gZmlsdGVyTWFuYWdlciAtIFRoZSByZW5kZXJlciB0byByZXRyaWV2ZSB0aGUgZmlsdGVyIGZyb21cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gaW5wdXQgLSBUaGUgaW5wdXQgcmVuZGVyIHRhcmdldC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gb3V0cHV0IC0gVGhlIHRhcmdldCB0byBvdXRwdXQgdG8uXG4gICAgICogQHBhcmFtIHtQSVhJLkNMRUFSX01PREVTfSBjbGVhck1vZGUgLSBTaG91bGQgdGhlIG91dHB1dCBiZSBjbGVhcmVkIGJlZm9yZSByZW5kZXJpbmcgdG8gaXQuXG4gICAgICovXG4gICAgYXBwbHkoZmlsdGVyTWFuYWdlcjogRmlsdGVyU3lzdGVtLCBpbnB1dDogUmVuZGVyVGV4dHVyZSwgb3V0cHV0OiBSZW5kZXJUZXh0dXJlLCBjbGVhck1vZGU6IENMRUFSX01PREVTKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWFza1Nwcml0ZSA9IHRoaXMubWFza1Nwcml0ZSBhcyBJU3ByaXRlTWFza1RhcmdldDtcbiAgICAgICAgY29uc3QgdGV4ID0gbWFza1Nwcml0ZS5fdGV4dHVyZTtcblxuICAgICAgICBpZiAoIXRleC52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGV4LnV2TWF0cml4KVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBtYXJnaW4gPSAwLjAsIGxldCBpdCBibGVlZCBhIGJpdCwgc2hhZGVyIGNvZGUgYmVjb21lcyBlYXNpZXJcbiAgICAgICAgICAgIC8vIGFzc3VtaW5nIHRoYXQgYXRsYXMgdGV4dHVyZXMgd2VyZSBtYWRlIHdpdGggMS1waXhlbCBwYWRkaW5nXG4gICAgICAgICAgICB0ZXgudXZNYXRyaXggPSBuZXcgVGV4dHVyZU1hdHJpeCh0ZXgsIDAuMCk7XG4gICAgICAgIH1cbiAgICAgICAgdGV4LnV2TWF0cml4LnVwZGF0ZSgpO1xuXG4gICAgICAgIHRoaXMudW5pZm9ybXMubnBtQWxwaGEgPSB0ZXguYmFzZVRleHR1cmUuYWxwaGFNb2RlID8gMC4wIDogMS4wO1xuICAgICAgICB0aGlzLnVuaWZvcm1zLm1hc2sgPSB0ZXg7XG4gICAgICAgIC8vIGdldCBfbm9ybWFsaXplZCBzcHJpdGUgdGV4dHVyZSBjb29yZHNfIGFuZCBjb252ZXJ0IHRoZW0gdG8gX25vcm1hbGl6ZWQgYXRsYXMgdGV4dHVyZSBjb29yZHNfIHdpdGggYHByZXBlbmRgXG4gICAgICAgIHRoaXMudW5pZm9ybXMub3RoZXJNYXRyaXggPSBmaWx0ZXJNYW5hZ2VyLmNhbGN1bGF0ZVNwcml0ZU1hdHJpeCh0aGlzLm1hc2tNYXRyaXgsIG1hc2tTcHJpdGUpXG4gICAgICAgICAgICAucHJlcGVuZCh0ZXgudXZNYXRyaXgubWFwQ29vcmQpO1xuICAgICAgICB0aGlzLnVuaWZvcm1zLmFscGhhID0gbWFza1Nwcml0ZS53b3JsZEFscGhhO1xuICAgICAgICB0aGlzLnVuaWZvcm1zLm1hc2tDbGFtcCA9IHRleC51dk1hdHJpeC51Q2xhbXBGcmFtZTtcblxuICAgICAgICBmaWx0ZXJNYW5hZ2VyLmFwcGx5RmlsdGVyKHRoaXMsIGlucHV0LCBvdXRwdXQsIGNsZWFyTW9kZSk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBNYXNrRGF0YSB9IGZyb20gJy4vTWFza0RhdGEnO1xuaW1wb3J0IHsgU3ByaXRlTWFza0ZpbHRlciB9IGZyb20gJy4uL2ZpbHRlcnMvc3ByaXRlTWFzay9TcHJpdGVNYXNrRmlsdGVyJztcbmltcG9ydCB7IE1BU0tfVFlQRVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IElNYXNrVGFyZ2V0IH0gZnJvbSAnLi9NYXNrRGF0YSc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSBtYXNrcy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCBjbGFzcyBNYXNrU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHVibGljIGVuYWJsZVNjaXNzb3I6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGFscGhhTWFza1Bvb2w6IEFycmF5PFNwcml0ZU1hc2tGaWx0ZXJbXT47XG4gICAgcHJvdGVjdGVkIGFscGhhTWFza0luZGV4OiBudW1iZXI7XG4gICAgcHJpdmF0ZSByZWFkb25seSBtYXNrRGF0YVBvb2w6IEFycmF5PE1hc2tEYXRhPjtcbiAgICBwcml2YXRlIG1hc2tTdGFjazogQXJyYXk8TWFza0RhdGE+O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFbmFibGUgc2Npc3NvclxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZW5hYmxlU2Npc3NvciA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQb29sIG9mIHVzZWQgc3ByaXRlIG1hc2sgZmlsdGVyc1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlNwcml0ZU1hc2tGaWx0ZXJbXX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFscGhhTWFza1Bvb2wgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUG9vbCBvZiBtYXNrIGRhdGFcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NYXNrRGF0YVtdfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWFza0RhdGFQb29sID0gW107XG5cbiAgICAgICAgdGhpcy5tYXNrU3RhY2sgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VycmVudCBpbmRleCBvZiBhbHBoYSBtYXNrIHBvb2xcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbHBoYU1hc2tJbmRleCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgbWFzayBzdGFjayB0aGF0IGlzIHVzZWQgYnkgdGhpcyBTeXN0ZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWFza0RhdGFbXX0gbWFza1N0YWNrIC0gVGhlIG1hc2sgc3RhY2tcbiAgICAgKi9cbiAgICBzZXRNYXNrU3RhY2sobWFza1N0YWNrOiBBcnJheTxNYXNrRGF0YT4pOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLm1hc2tTdGFjayA9IG1hc2tTdGFjaztcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zY2lzc29yLnNldE1hc2tTdGFjayhtYXNrU3RhY2spO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnN0ZW5jaWwuc2V0TWFza1N0YWNrKG1hc2tTdGFjayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgTWFzayBhbmQgYWRkcyBpdCB0byB0aGUgY3VycmVudCBmaWx0ZXIgc3RhY2suXG4gICAgICogUmVuZGVyZXIgYmF0Y2ggbXVzdCBiZSBmbHVzaGVkIGJlZm9yZWhhbmQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gdGFyZ2V0IC0gRGlzcGxheSBPYmplY3QgdG8gcHVzaCB0aGUgbWFzayB0b1xuICAgICAqIEBwYXJhbSB7UElYSS5NYXNrRGF0YXxQSVhJLlNwcml0ZXxQSVhJLkdyYXBoaWNzfFBJWEkuRGlzcGxheU9iamVjdH0gbWFza0RhdGEgLSBUaGUgbWFza2luZyBkYXRhLlxuICAgICAqL1xuICAgIHB1c2godGFyZ2V0OiBJTWFza1RhcmdldCwgbWFza0RhdGFPclRhcmdldDogTWFza0RhdGF8SU1hc2tUYXJnZXQpOiB2b2lkXG4gICAge1xuICAgICAgICBsZXQgbWFza0RhdGEgPSBtYXNrRGF0YU9yVGFyZ2V0IGFzIE1hc2tEYXRhO1xuXG4gICAgICAgIGlmICghbWFza0RhdGEuaXNNYXNrRGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZCA9IHRoaXMubWFza0RhdGFQb29sLnBvcCgpIHx8IG5ldyBNYXNrRGF0YSgpO1xuXG4gICAgICAgICAgICBkLnBvb2xlZCA9IHRydWU7XG4gICAgICAgICAgICBkLm1hc2tPYmplY3QgPSBtYXNrRGF0YU9yVGFyZ2V0IGFzIElNYXNrVGFyZ2V0O1xuICAgICAgICAgICAgbWFza0RhdGEgPSBkO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1hc2tEYXRhLmF1dG9EZXRlY3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZGV0ZWN0KG1hc2tEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hc2tEYXRhLmNvcHlDb3VudGVyc09yUmVzZXQodGhpcy5tYXNrU3RhY2tbdGhpcy5tYXNrU3RhY2subGVuZ3RoIC0gMV0pO1xuICAgICAgICBtYXNrRGF0YS5fdGFyZ2V0ID0gdGFyZ2V0O1xuXG4gICAgICAgIHN3aXRjaCAobWFza0RhdGEudHlwZSlcbiAgICAgICAge1xuICAgICAgICAgICAgY2FzZSBNQVNLX1RZUEVTLlNDSVNTT1I6XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrU3RhY2sucHVzaChtYXNrRGF0YSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zY2lzc29yLnB1c2gobWFza0RhdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNQVNLX1RZUEVTLlNURU5DSUw6XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrU3RhY2sucHVzaChtYXNrRGF0YSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zdGVuY2lsLnB1c2gobWFza0RhdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNQVNLX1RZUEVTLlNQUklURTpcbiAgICAgICAgICAgICAgICBtYXNrRGF0YS5jb3B5Q291bnRlcnNPclJlc2V0KG51bGwpO1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaFNwcml0ZU1hc2sobWFza0RhdGEpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFza1N0YWNrLnB1c2gobWFza0RhdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIGxhc3QgbWFzayBmcm9tIHRoZSBtYXNrIHN0YWNrIGFuZCBkb2Vzbid0IHJldHVybiBpdC5cbiAgICAgKiBSZW5kZXJlciBiYXRjaCBtdXN0IGJlIGZsdXNoZWQgYmVmb3JlaGFuZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSB0YXJnZXQgLSBEaXNwbGF5IE9iamVjdCB0byBwb3AgdGhlIG1hc2sgZnJvbVxuICAgICAqL1xuICAgIHBvcCh0YXJnZXQ6IElNYXNrVGFyZ2V0KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWFza0RhdGEgPSB0aGlzLm1hc2tTdGFjay5wb3AoKTtcblxuICAgICAgICBpZiAoIW1hc2tEYXRhIHx8IG1hc2tEYXRhLl90YXJnZXQgIT09IHRhcmdldClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETzogYWRkIGFuIGFzc2VydCB3aGVuIHdlIGhhdmUgaXRcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChtYXNrRGF0YS50eXBlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjYXNlIE1BU0tfVFlQRVMuU0NJU1NPUjpcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNjaXNzb3IucG9wKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIE1BU0tfVFlQRVMuU1RFTkNJTDpcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnN0ZW5jaWwucG9wKG1hc2tEYXRhLm1hc2tPYmplY3QpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNQVNLX1RZUEVTLlNQUklURTpcbiAgICAgICAgICAgICAgICB0aGlzLnBvcFNwcml0ZU1hc2soKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBtYXNrRGF0YS5yZXNldCgpO1xuXG4gICAgICAgIGlmIChtYXNrRGF0YS5wb29sZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubWFza0RhdGFQb29sLnB1c2gobWFza0RhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0eXBlIG9mIE1hc2tEYXRhIGJhc2VkIG9uIGl0cyBtYXNrT2JqZWN0XG4gICAgICogQHBhcmFtIHtQSVhJLk1hc2tEYXRhfSBtYXNrRGF0YVxuICAgICAqL1xuICAgIGRldGVjdChtYXNrRGF0YTogTWFza0RhdGEpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXNrT2JqZWN0ID0gbWFza0RhdGEubWFza09iamVjdDtcblxuICAgICAgICBpZiAobWFza09iamVjdC5pc1Nwcml0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgbWFza0RhdGEudHlwZSA9IE1BU0tfVFlQRVMuU1BSSVRFO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbWFza0RhdGEudHlwZSA9IE1BU0tfVFlQRVMuU1RFTkNJTDtcbiAgICAgICAgLy8gZGV0ZWN0IHNjaXNzb3IgaW4gZ3JhcGhpY3NcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlU2Npc3NvclxuICAgICAgICAgICAgJiYgbWFza09iamVjdC5pc0Zhc3RSZWN0XG4gICAgICAgICAgICAmJiBtYXNrT2JqZWN0LmlzRmFzdFJlY3QoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbWF0cml4ID0gbWFza09iamVjdC53b3JsZFRyYW5zZm9ybTtcblxuICAgICAgICAgICAgLy8gVE9ETzogbW92ZSB0aGUgY2hlY2sgdG8gdGhlIG1hdHJpeCBpdHNlbGZcbiAgICAgICAgICAgIC8vIHdlIGFyZSBjaGVja2luZyB0aGF0IGl0cyBvcnRob2dvbmFsIGFuZCB4IHJvdGF0aW9uIGlzIDAgOTAgMTgwIG9yIDI3MFxuXG4gICAgICAgICAgICBsZXQgcm90WCA9IE1hdGguYXRhbjIobWF0cml4LmIsIG1hdHJpeC5hKTtcbiAgICAgICAgICAgIGxldCByb3RYWSA9IE1hdGguYXRhbjIobWF0cml4LmQsIG1hdHJpeC5jKTtcblxuICAgICAgICAgICAgLy8gdXNlIHRoZSBuZWFyZXN0IGRlZ3JlZSB0byAwLjAxXG4gICAgICAgICAgICByb3RYID0gTWF0aC5yb3VuZChyb3RYICogKDE4MCAvIE1hdGguUEkpICogMTAwKTtcbiAgICAgICAgICAgIHJvdFhZID0gTWF0aC5yb3VuZChyb3RYWSAqICgxODAgLyBNYXRoLlBJKSAqIDEwMCkgLSByb3RYO1xuXG4gICAgICAgICAgICByb3RYID0gKChyb3RYICUgOTAwMCkgKyA5MDAwKSAlIDkwMDA7XG4gICAgICAgICAgICByb3RYWSA9ICgocm90WFkgJSAxODAwMCkgKyAxODAwMCkgJSAxODAwMDtcblxuICAgICAgICAgICAgaWYgKHJvdFggPT09IDAgJiYgcm90WFkgPT09IDkwMDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWFza0RhdGEudHlwZSA9IE1BU0tfVFlQRVMuU0NJU1NPUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIE1hc2sgYW5kIGFkZHMgaXQgdG8gdGhlIGN1cnJlbnQgZmlsdGVyIHN0YWNrLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLk1hc2tEYXRhfSBtYXNrRGF0YSAtIFNwcml0ZSB0byBiZSB1c2VkIGFzIHRoZSBtYXNrXG4gICAgICovXG4gICAgcHVzaFNwcml0ZU1hc2sobWFza0RhdGE6IE1hc2tEYXRhKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBtYXNrT2JqZWN0IH0gPSBtYXNrRGF0YTtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gbWFza0RhdGEuX3RhcmdldDtcbiAgICAgICAgbGV0IGFscGhhTWFza0ZpbHRlciA9IHRoaXMuYWxwaGFNYXNrUG9vbFt0aGlzLmFscGhhTWFza0luZGV4XTtcblxuICAgICAgICBpZiAoIWFscGhhTWFza0ZpbHRlcilcbiAgICAgICAge1xuICAgICAgICAgICAgYWxwaGFNYXNrRmlsdGVyID0gdGhpcy5hbHBoYU1hc2tQb29sW3RoaXMuYWxwaGFNYXNrSW5kZXhdID0gW25ldyBTcHJpdGVNYXNrRmlsdGVyKG1hc2tPYmplY3QpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFscGhhTWFza0ZpbHRlclswXS5yZXNvbHV0aW9uID0gdGhpcy5yZW5kZXJlci5yZXNvbHV0aW9uO1xuICAgICAgICBhbHBoYU1hc2tGaWx0ZXJbMF0ubWFza1Nwcml0ZSA9IG1hc2tPYmplY3Q7XG5cbiAgICAgICAgY29uc3Qgc3Rhc2hGaWx0ZXJBcmVhID0gdGFyZ2V0LmZpbHRlckFyZWE7XG5cbiAgICAgICAgdGFyZ2V0LmZpbHRlckFyZWEgPSBtYXNrT2JqZWN0LmdldEJvdW5kcyh0cnVlKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5maWx0ZXIucHVzaCh0YXJnZXQsIGFscGhhTWFza0ZpbHRlcik7XG4gICAgICAgIHRhcmdldC5maWx0ZXJBcmVhID0gc3Rhc2hGaWx0ZXJBcmVhO1xuXG4gICAgICAgIHRoaXMuYWxwaGFNYXNrSW5kZXgrKztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBsYXN0IGZpbHRlciBmcm9tIHRoZSBmaWx0ZXIgc3RhY2sgYW5kIGRvZXNuJ3QgcmV0dXJuIGl0LlxuICAgICAqL1xuICAgIHBvcFNwcml0ZU1hc2soKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5maWx0ZXIucG9wKCk7XG4gICAgICAgIHRoaXMuYWxwaGFNYXNrSW5kZXgtLTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgU3lzdGVtIH0gZnJvbSAnLi4vU3lzdGVtJztcblxuaW1wb3J0IHR5cGUgeyBNYXNrRGF0YSB9IGZyb20gJy4vTWFza0RhdGEnO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcblxuLyoqXG4gKiBTeXN0ZW0gcGx1Z2luIHRvIHRoZSByZW5kZXJlciB0byBtYW5hZ2UgbWFza3Mgb2YgY2VydGFpbiB0eXBlXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLlN5c3RlbVxuICogQG1lbWJlcm9mIFBJWEkuc3lzdGVtc1xuICovXG5leHBvcnQgY2xhc3MgQWJzdHJhY3RNYXNrU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHJvdGVjdGVkIG1hc2tTdGFjazogQXJyYXk8TWFza0RhdGE+O1xuICAgIHByb3RlY3RlZCBnbENvbnN0OiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWFzayBzdGFja1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1hc2tEYXRhW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hc2tTdGFjayA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdGFudCBmb3IgZ2wuZW5hYmxlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2xDb25zdCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0cyBjb3VudCBvZiBtYXNrcyBvZiBjZXJ0YWluIHR5cGVcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldFN0YWNrTGVuZ3RoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFza1N0YWNrLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBtYXNrIHN0YWNrIHRoYXQgaXMgdXNlZCBieSB0aGlzIFN5c3RlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXNrRGF0YVtdfSBtYXNrU3RhY2sgLSBUaGUgbWFzayBzdGFja1xuICAgICAqL1xuICAgIHNldE1hc2tTdGFjayhtYXNrU3RhY2s6IEFycmF5PE1hc2tEYXRhPik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXMucmVuZGVyZXI7XG4gICAgICAgIGNvbnN0IGN1clN0YWNrTGVuID0gdGhpcy5nZXRTdGFja0xlbmd0aCgpO1xuXG4gICAgICAgIHRoaXMubWFza1N0YWNrID0gbWFza1N0YWNrO1xuXG4gICAgICAgIGNvbnN0IG5ld1N0YWNrTGVuID0gdGhpcy5nZXRTdGFja0xlbmd0aCgpO1xuXG4gICAgICAgIGlmIChuZXdTdGFja0xlbiAhPT0gY3VyU3RhY2tMZW4pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChuZXdTdGFja0xlbiA9PT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbC5kaXNhYmxlKHRoaXMuZ2xDb25zdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZ2wuZW5hYmxlKHRoaXMuZ2xDb25zdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXNlQ3VycmVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0dXAgcmVuZGVyZXIgdG8gdXNlIHRoZSBjdXJyZW50IG1hc2sgZGF0YS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfdXNlQ3VycmVudCgpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBPVkVSV1JJVEU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhlIG1hc2sgc3RhY2suXG4gICAgICpcbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLm1hc2tTdGFjayA9IG51bGw7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFic3RyYWN0TWFza1N5c3RlbSB9IGZyb20gJy4vQWJzdHJhY3RNYXNrU3lzdGVtJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgTWFza0RhdGEgfSBmcm9tICcuL01hc2tEYXRhJztcblxuLyoqXG4gKiBTeXN0ZW0gcGx1Z2luIHRvIHRoZSByZW5kZXJlciB0byBtYW5hZ2Ugc2Npc3NvciByZWN0cyAodXNlZCBmb3IgbWFza3MpLlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqIEBtZW1iZXJvZiBQSVhJLnN5c3RlbXNcbiAqL1xuZXhwb3J0IGNsYXNzIFNjaXNzb3JTeXN0ZW0gZXh0ZW5kcyBBYnN0cmFjdE1hc2tTeXN0ZW1cbntcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgU3lzdGVtIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgdGhpcy5nbENvbnN0ID0gV2ViR0xSZW5kZXJpbmdDb250ZXh0LlNDSVNTT1JfVEVTVDtcbiAgICB9XG5cbiAgICBnZXRTdGFja0xlbmd0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hc2tEYXRhID0gdGhpcy5tYXNrU3RhY2tbdGhpcy5tYXNrU3RhY2subGVuZ3RoIC0gMV07XG5cbiAgICAgICAgaWYgKG1hc2tEYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gbWFza0RhdGEuX3NjaXNzb3JDb3VudGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgTWFzayBhbmQgYWRkcyBpdCB0byB0aGUgY3VycmVudCBzdGVuY2lsIHN0YWNrLiBAYWx2aW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXNrRGF0YX0gbWFza0RhdGEgLSBUaGUgbWFzayBkYXRhXG4gICAgICovXG4gICAgcHVzaChtYXNrRGF0YTogTWFza0RhdGEpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXNrT2JqZWN0ID0gbWFza0RhdGEubWFza09iamVjdDtcblxuICAgICAgICBtYXNrT2JqZWN0LnJlbmRlcmFibGUgPSB0cnVlO1xuXG4gICAgICAgIGNvbnN0IHByZXZEYXRhID0gbWFza0RhdGEuX3NjaXNzb3JSZWN0O1xuICAgICAgICBjb25zdCBib3VuZHMgPSBtYXNrT2JqZWN0LmdldEJvdW5kcyh0cnVlKTtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcy5yZW5kZXJlcjtcblxuICAgICAgICBtYXNrT2JqZWN0LnJlbmRlcmFibGUgPSBmYWxzZTtcblxuICAgICAgICBpZiAocHJldkRhdGEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJvdW5kcy5maXQocHJldkRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wuZW5hYmxlKGdsLlNDSVNTT1JfVEVTVCk7XG4gICAgICAgIH1cblxuICAgICAgICBtYXNrRGF0YS5fc2Npc3NvckNvdW50ZXIrKztcbiAgICAgICAgbWFza0RhdGEuX3NjaXNzb3JSZWN0ID0gYm91bmRzO1xuICAgICAgICB0aGlzLl91c2VDdXJyZW50KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUG9wcyBzY2lzc29yIG1hc2suIE1hc2tEYXRhIGlzIGFscmVhZHkgcmVtb3ZlZCBmcm9tIHN0YWNrXG4gICAgICovXG4gICAgcG9wKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXMucmVuZGVyZXI7XG5cbiAgICAgICAgaWYgKHRoaXMuZ2V0U3RhY2tMZW5ndGgoKSA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3VzZUN1cnJlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmRpc2FibGUoZ2wuU0NJU1NPUl9URVNUKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHVwIHJlbmRlcmVyIHRvIHVzZSB0aGUgY3VycmVudCBzY2lzc29yIGRhdGEuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdXNlQ3VycmVudCgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5tYXNrU3RhY2tbdGhpcy5tYXNrU3RhY2subGVuZ3RoIC0gMV0uX3NjaXNzb3JSZWN0O1xuICAgICAgICBjb25zdCBydCA9IHRoaXMucmVuZGVyZXIucmVuZGVyVGV4dHVyZS5jdXJyZW50O1xuICAgICAgICBjb25zdCB7IHRyYW5zZm9ybSwgc291cmNlRnJhbWUsIGRlc3RpbmF0aW9uRnJhbWUgfSA9IHRoaXMucmVuZGVyZXIucHJvamVjdGlvbjtcbiAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IHJ0ID8gcnQucmVzb2x1dGlvbiA6IHRoaXMucmVuZGVyZXIucmVzb2x1dGlvbjtcbiAgICAgICAgbGV0IHggPSAoKHJlY3QueCAtIHNvdXJjZUZyYW1lLngpICogcmVzb2x1dGlvbikgKyBkZXN0aW5hdGlvbkZyYW1lLng7XG4gICAgICAgIGxldCB5ID0gKChyZWN0LnkgLSBzb3VyY2VGcmFtZS55KSAqIHJlc29sdXRpb24pICsgZGVzdGluYXRpb25GcmFtZS55O1xuICAgICAgICBjb25zdCB3aWR0aCA9IHJlY3Qud2lkdGggKiByZXNvbHV0aW9uO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSByZWN0LmhlaWdodCAqIHJlc29sdXRpb247XG5cbiAgICAgICAgaWYgKHRyYW5zZm9ybSlcbiAgICAgICAge1xuICAgICAgICAgICAgeCArPSB0cmFuc2Zvcm0udHggKiByZXNvbHV0aW9uO1xuICAgICAgICAgICAgeSArPSB0cmFuc2Zvcm0udHkgKiByZXNvbHV0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGZsaXBZLiBJbiBmdXR1cmUgd2UnbGwgaGF2ZSBpdCBvdmVyIHJlbmRlclRleHR1cmVzIGFzIGFuIG9wdGlvblxuICAgICAgICAgICAgeSA9IHRoaXMucmVuZGVyZXIuaGVpZ2h0IC0gaGVpZ2h0IC0geTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVuZGVyZXIuZ2wuc2Npc3Nvcih4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQWJzdHJhY3RNYXNrU3lzdGVtIH0gZnJvbSAnLi9BYnN0cmFjdE1hc2tTeXN0ZW0nO1xuXG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBJTWFza1RhcmdldCwgTWFza0RhdGEgfSBmcm9tICcuL01hc2tEYXRhJztcblxuLyoqXG4gKiBTeXN0ZW0gcGx1Z2luIHRvIHRoZSByZW5kZXJlciB0byBtYW5hZ2Ugc3RlbmNpbHMgKHVzZWQgZm9yIG1hc2tzKS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCBjbGFzcyBTdGVuY2lsU3lzdGVtIGV4dGVuZHMgQWJzdHJhY3RNYXNrU3lzdGVtXG57XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIHRoaXMuZ2xDb25zdCA9IFdlYkdMUmVuZGVyaW5nQ29udGV4dC5TVEVOQ0lMX1RFU1Q7XG4gICAgfVxuXG4gICAgZ2V0U3RhY2tMZW5ndGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICBjb25zdCBtYXNrRGF0YSA9IHRoaXMubWFza1N0YWNrW3RoaXMubWFza1N0YWNrLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChtYXNrRGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIG1hc2tEYXRhLl9zdGVuY2lsQ291bnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIE1hc2sgYW5kIGFkZHMgaXQgdG8gdGhlIGN1cnJlbnQgc3RlbmNpbCBzdGFjay5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5NYXNrRGF0YX0gbWFza0RhdGEgLSBUaGUgbWFzayBkYXRhXG4gICAgICovXG4gICAgcHVzaChtYXNrRGF0YTogTWFza0RhdGEpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXNrT2JqZWN0ID0gbWFza0RhdGEubWFza09iamVjdDtcbiAgICAgICAgY29uc3QgeyBnbCB9ID0gdGhpcy5yZW5kZXJlcjtcbiAgICAgICAgY29uc3QgcHJldk1hc2tDb3VudCA9IG1hc2tEYXRhLl9zdGVuY2lsQ291bnRlcjtcblxuICAgICAgICBpZiAocHJldk1hc2tDb3VudCA9PT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gZm9yY2UgdXNlIHN0ZW5jaWwgdGV4dHVyZSBpbiBjdXJyZW50IGZyYW1lYnVmZmVyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmZyYW1lYnVmZmVyLmZvcmNlU3RlbmNpbCgpO1xuICAgICAgICAgICAgZ2wuZW5hYmxlKGdsLlNURU5DSUxfVEVTVCk7XG4gICAgICAgIH1cblxuICAgICAgICBtYXNrRGF0YS5fc3RlbmNpbENvdW50ZXIrKztcblxuICAgICAgICAvLyBJbmNyZW1lbnQgdGhlIHJlZmVyZW5jZSBzdGVuY2lsIHZhbHVlIHdoZXJlIHRoZSBuZXcgbWFzayBvdmVybGFwcyB3aXRoIHRoZSBvbGQgb25lcy5cbiAgICAgICAgZ2wuY29sb3JNYXNrKGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgZ2wuc3RlbmNpbEZ1bmMoZ2wuRVFVQUwsIHByZXZNYXNrQ291bnQsIHRoaXMuX2dldEJpdHdpc2VNYXNrKCkpO1xuICAgICAgICBnbC5zdGVuY2lsT3AoZ2wuS0VFUCwgZ2wuS0VFUCwgZ2wuSU5DUik7XG5cbiAgICAgICAgbWFza09iamVjdC5yZW5kZXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgbWFza09iamVjdC5yZW5kZXIodGhpcy5yZW5kZXJlcik7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuYmF0Y2guZmx1c2goKTtcbiAgICAgICAgbWFza09iamVjdC5yZW5kZXJhYmxlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fdXNlQ3VycmVudCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBvcHMgc3RlbmNpbCBtYXNrLiBNYXNrRGF0YSBpcyBhbHJlYWR5IHJlbW92ZWQgZnJvbSBzdGFja1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IG1hc2tPYmplY3QgLSBvYmplY3Qgb2YgcG9wcGVkIG1hc2sgZGF0YVxuICAgICAqL1xuICAgIHBvcChtYXNrT2JqZWN0OiBJTWFza1RhcmdldCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5yZW5kZXJlci5nbDtcblxuICAgICAgICBpZiAodGhpcy5nZXRTdGFja0xlbmd0aCgpID09PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB0aGUgc3RhY2sgaXMgZW1wdHkhXG4gICAgICAgICAgICBnbC5kaXNhYmxlKGdsLlNURU5DSUxfVEVTVCk7XG4gICAgICAgICAgICBnbC5jbGVhcihnbC5TVEVOQ0lMX0JVRkZFUl9CSVQpO1xuICAgICAgICAgICAgZ2wuY2xlYXJTdGVuY2lsKDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gRGVjcmVtZW50IHRoZSByZWZlcmVuY2Ugc3RlbmNpbCB2YWx1ZSB3aGVyZSB0aGUgcG9wcGVkIG1hc2sgb3ZlcmxhcHMgd2l0aCB0aGUgb3RoZXIgb25lc1xuICAgICAgICAgICAgZ2wuY29sb3JNYXNrKGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIGdsLnN0ZW5jaWxPcChnbC5LRUVQLCBnbC5LRUVQLCBnbC5ERUNSKTtcblxuICAgICAgICAgICAgbWFza09iamVjdC5yZW5kZXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIG1hc2tPYmplY3QucmVuZGVyKHRoaXMucmVuZGVyZXIpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5iYXRjaC5mbHVzaCgpO1xuICAgICAgICAgICAgbWFza09iamVjdC5yZW5kZXJhYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHRoaXMuX3VzZUN1cnJlbnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHVwIHJlbmRlcmVyIHRvIHVzZSB0aGUgY3VycmVudCBzdGVuY2lsIGRhdGEuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdXNlQ3VycmVudCgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMucmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgZ2wuY29sb3JNYXNrKHRydWUsIHRydWUsIHRydWUsIHRydWUpO1xuICAgICAgICBnbC5zdGVuY2lsRnVuYyhnbC5FUVVBTCwgdGhpcy5nZXRTdGFja0xlbmd0aCgpLCB0aGlzLl9nZXRCaXR3aXNlTWFzaygpKTtcbiAgICAgICAgZ2wuc3RlbmNpbE9wKGdsLktFRVAsIGdsLktFRVAsIGdsLktFRVApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbGwgMXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBhY2l0dmUgc3RlbmNpbCBtYXNrcy5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIGJpdHdpc2UgbWFzay5cbiAgICAgKi9cbiAgICBfZ2V0Qml0d2lzZU1hc2soKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gKDEgPDwgdGhpcy5nZXRTdGFja0xlbmd0aCgpKSAtIDE7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFN5c3RlbSB9IGZyb20gJy4uL1N5c3RlbSc7XG5pbXBvcnQgeyBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcblxuaW1wb3J0IHR5cGUgeyBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi9SZW5kZXJlcic7XG5cbi8qKlxuICogU3lzdGVtIHBsdWdpbiB0byB0aGUgcmVuZGVyZXIgdG8gbWFuYWdlIHRoZSBwcm9qZWN0aW9uIG1hdHJpeC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cblxuZXhwb3J0IGNsYXNzIFByb2plY3Rpb25TeXN0ZW0gZXh0ZW5kcyBTeXN0ZW1cbntcbiAgICBwdWJsaWMgZGVzdGluYXRpb25GcmFtZTogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyBzb3VyY2VGcmFtZTogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyBkZWZhdWx0RnJhbWU6IFJlY3RhbmdsZTtcbiAgICBwdWJsaWMgcHJvamVjdGlvbk1hdHJpeDogTWF0cml4O1xuICAgIHB1YmxpYyB0cmFuc2Zvcm06IE1hdHJpeDtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBTeXN0ZW0gd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVzdGluYXRpb24gZnJhbWVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbkZyYW1lID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU291cmNlIGZyYW1lXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc291cmNlRnJhbWUgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWZhdWx0IGRlc3RpbmF0aW9uIGZyYW1lXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVmYXVsdEZyYW1lID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJvamVjdCBtYXRyaXhcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NYXRyaXh9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wcm9qZWN0aW9uTWF0cml4ID0gbmV3IE1hdHJpeCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRyYW5zZm9ybSB0aGF0IHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIHByb2plY3Rpb24gbWF0cml4XG4gICAgICAgICAqIGlmIG51bGwsIG5vdGhpbmcgd2lsbCBiZSBhcHBsaWVkXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuTWF0cml4fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHByb2plY3Rpb24gbWF0cml4IGJhc2VkIG9uIGEgcHJvamVjdGlvbiBmcmFtZSAod2hpY2ggaXMgYSByZWN0YW5nbGUpLlxuICAgICAqXG4gICAgICogTWFrZSBzdXJlIHRvIHJ1biBgcmVuZGVyZXIuZnJhbWVidWZmZXIuc2V0Vmlld3BvcnQoZGVzdGluYXRpb25GcmFtZSlgIGFmdGVyIGNhbGxpbmcgdGhpcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IGRlc3RpbmF0aW9uRnJhbWUgLSBUaGUgZGVzdGluYXRpb24gZnJhbWUuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gc291cmNlRnJhbWUgLSBUaGUgc291cmNlIGZyYW1lLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByZXNvbHV0aW9uIC0gUmVzb2x1dGlvblxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gcm9vdCAtIElmIGlzIHJvb3RcbiAgICAgKi9cbiAgICB1cGRhdGUoZGVzdGluYXRpb25GcmFtZTogUmVjdGFuZ2xlLCBzb3VyY2VGcmFtZTogUmVjdGFuZ2xlLCByZXNvbHV0aW9uOiBudW1iZXIsIHJvb3Q6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uRnJhbWUgPSBkZXN0aW5hdGlvbkZyYW1lIHx8IHRoaXMuZGVzdGluYXRpb25GcmFtZSB8fCB0aGlzLmRlZmF1bHRGcmFtZTtcbiAgICAgICAgdGhpcy5zb3VyY2VGcmFtZSA9IHNvdXJjZUZyYW1lIHx8IHRoaXMuc291cmNlRnJhbWUgfHwgZGVzdGluYXRpb25GcmFtZTtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgb2JqZWN0LXNwYWNlIHRvIGNsaXAtc3BhY2UgcHJvamVjdGlvblxuICAgICAgICB0aGlzLmNhbGN1bGF0ZVByb2plY3Rpb24odGhpcy5kZXN0aW5hdGlvbkZyYW1lLCB0aGlzLnNvdXJjZUZyYW1lLCByZXNvbHV0aW9uLCByb290KTtcblxuICAgICAgICBpZiAodGhpcy50cmFuc2Zvcm0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucHJvamVjdGlvbk1hdHJpeC5hcHBlbmQodGhpcy50cmFuc2Zvcm0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSAgdGhpcy5yZW5kZXJlcjtcblxuICAgICAgICByZW5kZXJlci5nbG9iYWxVbmlmb3Jtcy51bmlmb3Jtcy5wcm9qZWN0aW9uTWF0cml4ID0gdGhpcy5wcm9qZWN0aW9uTWF0cml4O1xuICAgICAgICByZW5kZXJlci5nbG9iYWxVbmlmb3Jtcy51cGRhdGUoKTtcblxuICAgICAgICAvLyB0aGlzIHdpbGwgd29yayBmb3Igbm93XG4gICAgICAgIC8vIGJ1dCB3b3VsZCBiZSBzd2VldCB0byBzdGljayBhbmQgZXZlbiBvbiB0aGUgZ2xvYmFsIHVuaWZvcm1zLi5cbiAgICAgICAgaWYgKHJlbmRlcmVyLnNoYWRlci5zaGFkZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlbmRlcmVyLnNoYWRlci5zeW5jVW5pZm9ybUdyb3VwKHJlbmRlcmVyLnNoYWRlci5zaGFkZXIudW5pZm9ybXMuZ2xvYmFscyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBwcm9qZWN0aW9uIG1hdHJpeCBiYXNlZCBvbiBhIHByb2plY3Rpb24gZnJhbWUgKHdoaWNoIGlzIGEgcmVjdGFuZ2xlKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlY3RhbmdsZX0gZGVzdGluYXRpb25GcmFtZSAtIFRoZSBkZXN0aW5hdGlvbiBmcmFtZS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVjdGFuZ2xlfSBzb3VyY2VGcmFtZSAtIFRoZSBzb3VyY2UgZnJhbWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJlc29sdXRpb24gLSBSZXNvbHV0aW9uXG4gICAgICogQHBhcmFtIHtib29sZWFufSByb290IC0gSWYgaXMgcm9vdFxuICAgICAqL1xuICAgIGNhbGN1bGF0ZVByb2plY3Rpb24oX2Rlc3RpbmF0aW9uRnJhbWU6IFJlY3RhbmdsZSwgc291cmNlRnJhbWU6IFJlY3RhbmdsZSwgX3Jlc29sdXRpb246IG51bWJlciwgcm9vdDogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHBtID0gdGhpcy5wcm9qZWN0aW9uTWF0cml4O1xuICAgICAgICBjb25zdCBzaWduID0gIXJvb3QgPyAxIDogLTE7XG5cbiAgICAgICAgcG0uaWRlbnRpdHkoKTtcblxuICAgICAgICBwbS5hID0gKDEgLyBzb3VyY2VGcmFtZS53aWR0aCAqIDIpO1xuICAgICAgICBwbS5kID0gc2lnbiAqICgxIC8gc291cmNlRnJhbWUuaGVpZ2h0ICogMik7XG5cbiAgICAgICAgcG0udHggPSAtMSAtIChzb3VyY2VGcmFtZS54ICogcG0uYSk7XG4gICAgICAgIHBtLnR5ID0gLXNpZ24gLSAoc291cmNlRnJhbWUueSAqIHBtLmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHRyYW5zZm9ybSBvZiB0aGUgYWN0aXZlIHJlbmRlciB0YXJnZXQgdG8gdGhlIGdpdmVuIG1hdHJpeFxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gbWF0cml4IC0gVGhlIHRyYW5zZm9ybWF0aW9uIG1hdHJpeFxuICAgICAqL1xuICAgIHNldFRyYW5zZm9ybShfbWF0cml4OiBNYXRyaXgpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyB0aGlzLl9hY3RpdmVSZW5kZXJUYXJnZXQudHJhbnNmb3JtID0gbWF0cml4O1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi9TeXN0ZW0nO1xuaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBCVUZGRVJfQklUUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi9SZW5kZXJlcic7XG5pbXBvcnQgdHlwZSB7IFJlbmRlclRleHR1cmUgfSBmcm9tICcuL1JlbmRlclRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBCYXNlUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4vQmFzZVJlbmRlclRleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBNYXNrRGF0YSB9IGZyb20gJy4uL21hc2svTWFza0RhdGEnO1xuXG4vLyBUZW1wb3JhcnkgcmVjdGFuZ2xlIGZvciBhc3NpZ25lZCBzb3VyY2VGcmFtZSBvciBkZXN0aW5hdGlvbkZyYW1lXG5jb25zdCB0ZW1wUmVjdCA9IG5ldyBSZWN0YW5nbGUoKTtcblxuLy8gVGVtcG9yYXJ5IHJlY3RhbmdsZSBmb3IgcmVuZGVyVGV4dHVyZSBkZXN0aW5hdGlvbkZyYW1lXG5jb25zdCB0ZW1wUmVjdDIgPSBuZXcgUmVjdGFuZ2xlKCk7XG5cbi8vIFRlbXBvcmFyeSByZWN0YW5nbGUgZm9yIHBhc3NpbmcgdGhlIGZyYW1lYnVmZmVyIHZpZXdwb3J0XG5jb25zdCB2aWV3cG9ydEZyYW1lID0gbmV3IFJlY3RhbmdsZSgpO1xuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSByZW5kZXIgdGV4dHVyZXMuXG4gKlxuICogU2hvdWxkIGJlIGFkZGVkIGFmdGVyIEZyYW1lYnVmZmVyU3lzdGVtXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLlN5c3RlbVxuICogQG1lbWJlcm9mIFBJWEkuc3lzdGVtc1xuICovXG5leHBvcnQgY2xhc3MgUmVuZGVyVGV4dHVyZVN5c3RlbSBleHRlbmRzIFN5c3RlbVxue1xuICAgIHB1YmxpYyBjbGVhckNvbG9yOiBudW1iZXJbXTtcbiAgICBwdWJsaWMgZGVmYXVsdE1hc2tTdGFjazogQXJyYXk8TWFza0RhdGE+O1xuICAgIHB1YmxpYyBjdXJyZW50OiBSZW5kZXJUZXh0dXJlO1xuICAgIHB1YmxpYyByZWFkb25seSBzb3VyY2VGcmFtZTogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyByZWFkb25seSBkZXN0aW5hdGlvbkZyYW1lOiBSZWN0YW5nbGU7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgU3lzdGVtIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjbGVhciBiYWNrZ3JvdW5kIGNvbG9yIGFzIHJnYmFcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsZWFyQ29sb3IgPSByZW5kZXJlci5fYmFja2dyb3VuZENvbG9yUmdiYTtcblxuICAgICAgICAvLyBUT0RPIG1vdmUgdGhpcyBwcm9wZXJ0eSBzb21ld2hlcmUgZWxzZSFcbiAgICAgICAgLyoqXG4gICAgICAgICAqIExpc3Qgb2YgbWFza3MgZm9yIHRoZSBTdGVuY2lsU3lzdGVtXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuR3JhcGhpY3NbXX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlZmF1bHRNYXNrU3RhY2sgPSBbXTtcblxuICAgICAgICAvLyBlbXB0eSByZW5kZXIgdGV4dHVyZT9cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlciB0ZXh0dXJlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVuZGVyVGV4dHVyZX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTb3VyY2UgZnJhbWVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zb3VyY2VGcmFtZSA9IG5ldyBSZWN0YW5nbGUoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVzdGluYXRpb24gZnJhbWVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5SZWN0YW5nbGV9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbkZyYW1lID0gbmV3IFJlY3RhbmdsZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJpbmQgdGhlIGN1cnJlbnQgcmVuZGVyIHRleHR1cmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBbcmVuZGVyVGV4dHVyZV0gLSBSZW5kZXJUZXh0dXJlIHRvIGJpbmQsIGJ5IGRlZmF1bHQgaXRzIGBudWxsYCwgdGhlIHNjcmVlblxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtzb3VyY2VGcmFtZV0gLSBwYXJ0IG9mIHNjcmVlbiB0aGF0IGlzIG1hcHBlZCB0byB0aGUgcmVuZGVyVGV4dHVyZVxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtkZXN0aW5hdGlvbkZyYW1lXSAtIHBhcnQgb2YgcmVuZGVyVGV4dHVyZSwgYnkgZGVmYXVsdCBpdCBoYXMgdGhlIHNhbWUgc2l6ZSBhcyBzb3VyY2VGcmFtZVxuICAgICAqL1xuICAgIGJpbmQocmVuZGVyVGV4dHVyZTogUmVuZGVyVGV4dHVyZSA9IG51bGwsIHNvdXJjZUZyYW1lPzogUmVjdGFuZ2xlLCBkZXN0aW5hdGlvbkZyYW1lPzogUmVjdGFuZ2xlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuXG4gICAgICAgIHRoaXMuY3VycmVudCA9IHJlbmRlclRleHR1cmU7XG5cbiAgICAgICAgbGV0IGJhc2VUZXh0dXJlOiBCYXNlUmVuZGVyVGV4dHVyZTtcbiAgICAgICAgbGV0IGZyYW1lYnVmZmVyO1xuICAgICAgICBsZXQgcmVzb2x1dGlvbjtcblxuICAgICAgICBpZiAocmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgYmFzZVRleHR1cmUgPSByZW5kZXJUZXh0dXJlLmJhc2VUZXh0dXJlIGFzIEJhc2VSZW5kZXJUZXh0dXJlO1xuXG4gICAgICAgICAgICByZXNvbHV0aW9uID0gYmFzZVRleHR1cmUucmVzb2x1dGlvbjtcblxuICAgICAgICAgICAgaWYgKCFzb3VyY2VGcmFtZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZW1wUmVjdC53aWR0aCA9IHJlbmRlclRleHR1cmUuZnJhbWUud2lkdGg7XG4gICAgICAgICAgICAgICAgdGVtcFJlY3QuaGVpZ2h0ID0gcmVuZGVyVGV4dHVyZS5mcmFtZS5oZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBzb3VyY2VGcmFtZSA9IHRlbXBSZWN0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWRlc3RpbmF0aW9uRnJhbWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGVtcFJlY3QyLnggPSByZW5kZXJUZXh0dXJlLmZyYW1lLng7XG4gICAgICAgICAgICAgICAgdGVtcFJlY3QyLnkgPSByZW5kZXJUZXh0dXJlLmZyYW1lLnk7XG4gICAgICAgICAgICAgICAgdGVtcFJlY3QyLndpZHRoID0gc291cmNlRnJhbWUud2lkdGg7XG4gICAgICAgICAgICAgICAgdGVtcFJlY3QyLmhlaWdodCA9IHNvdXJjZUZyYW1lLmhlaWdodDtcblxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRnJhbWUgPSB0ZW1wUmVjdDI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZyYW1lYnVmZmVyID0gYmFzZVRleHR1cmUuZnJhbWVidWZmZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXNvbHV0aW9uID0gcmVuZGVyZXIucmVzb2x1dGlvbjtcblxuICAgICAgICAgICAgaWYgKCFzb3VyY2VGcmFtZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZW1wUmVjdC53aWR0aCA9IHJlbmRlcmVyLnNjcmVlbi53aWR0aDtcbiAgICAgICAgICAgICAgICB0ZW1wUmVjdC5oZWlnaHQgPSByZW5kZXJlci5zY3JlZW4uaGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgc291cmNlRnJhbWUgPSB0ZW1wUmVjdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbkZyYW1lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRnJhbWUgPSB0ZW1wUmVjdDtcblxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uRnJhbWUud2lkdGggPSBzb3VyY2VGcmFtZS53aWR0aDtcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCA9IHNvdXJjZUZyYW1lLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZpZXdwb3J0RnJhbWUueCA9IGRlc3RpbmF0aW9uRnJhbWUueCAqIHJlc29sdXRpb247XG4gICAgICAgIHZpZXdwb3J0RnJhbWUueSA9IGRlc3RpbmF0aW9uRnJhbWUueSAqIHJlc29sdXRpb247XG4gICAgICAgIHZpZXdwb3J0RnJhbWUud2lkdGggPSBkZXN0aW5hdGlvbkZyYW1lLndpZHRoICogcmVzb2x1dGlvbjtcbiAgICAgICAgdmlld3BvcnRGcmFtZS5oZWlnaHQgPSBkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCAqIHJlc29sdXRpb247XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5mcmFtZWJ1ZmZlci5iaW5kKGZyYW1lYnVmZmVyLCB2aWV3cG9ydEZyYW1lKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5wcm9qZWN0aW9uLnVwZGF0ZShkZXN0aW5hdGlvbkZyYW1lLCBzb3VyY2VGcmFtZSwgcmVzb2x1dGlvbiwgIWZyYW1lYnVmZmVyKTtcblxuICAgICAgICBpZiAocmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5tYXNrLnNldE1hc2tTdGFjayhiYXNlVGV4dHVyZS5tYXNrU3RhY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5tYXNrLnNldE1hc2tTdGFjayh0aGlzLmRlZmF1bHRNYXNrU3RhY2spO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zb3VyY2VGcmFtZS5jb3B5RnJvbShzb3VyY2VGcmFtZSk7XG4gICAgICAgIHRoaXMuZGVzdGluYXRpb25GcmFtZS5jb3B5RnJvbShkZXN0aW5hdGlvbkZyYW1lKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFcmFzZXMgdGhlIHJlbmRlciB0ZXh0dXJlIGFuZCBmaWxscyB0aGUgZHJhd2luZyBhcmVhIHdpdGggYSBjb2xvdXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IFtjbGVhckNvbG9yXSAtIFRoZSBjb2xvciBhcyByZ2JhLCBkZWZhdWx0IHRvIHVzZSB0aGUgcmVuZGVyZXIgYmFja2dyb3VuZENvbG9yXG4gICAgICogQHBhcmFtIHtQSVhJLkJVRkZFUl9CSVRTfSBbbWFzaz1CVUZGRVJfQklUUy5DT0xPUiB8IEJVRkZFUl9CSVRTLkRFUFRIXSAtIEJpdHdpc2UgT1Igb2YgbWFza3NcbiAgICAgKiAgdGhhdCBpbmRpY2F0ZSB0aGUgYnVmZmVycyB0byBiZSBjbGVhcmVkLCBieSBkZWZhdWx0IENPTE9SIGFuZCBERVBUSCBidWZmZXJzLlxuICAgICAqIEByZXR1cm4ge1BJWEkuUmVuZGVyZXJ9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGNsZWFyKGNsZWFyQ29sb3I/OiBudW1iZXJbXSwgbWFzaz86IEJVRkZFUl9CSVRTKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudClcbiAgICAgICAge1xuICAgICAgICAgICAgY2xlYXJDb2xvciA9IGNsZWFyQ29sb3IgfHwgKHRoaXMuY3VycmVudC5iYXNlVGV4dHVyZSBhcyBCYXNlUmVuZGVyVGV4dHVyZSkuY2xlYXJDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNsZWFyQ29sb3IgPSBjbGVhckNvbG9yIHx8IHRoaXMuY2xlYXJDb2xvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVuZGVyZXIuZnJhbWVidWZmZXIuY2xlYXIoY2xlYXJDb2xvclswXSwgY2xlYXJDb2xvclsxXSwgY2xlYXJDb2xvclsyXSwgY2xlYXJDb2xvclszXSwgbWFzayk7XG4gICAgfVxuXG4gICAgcmVzaXplKCk6IHZvaWQgLy8gc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodClcbiAgICB7XG4gICAgICAgIC8vIHJlc2l6ZSB0aGUgcm9vdCBvbmx5IVxuICAgICAgICB0aGlzLmJpbmQobnVsbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIHJlbmRlclRleHR1cmUgc3RhdGVcbiAgICAgKi9cbiAgICByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmJpbmQobnVsbCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgRGljdCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIElHTFVuaWZvcm1EYXRhXG57XG4gICAgbG9jYXRpb246IFdlYkdMVW5pZm9ybUxvY2F0aW9uO1xuICAgIHZhbHVlOiBudW1iZXIgfCBib29sZWFuIHwgRmxvYXQzMkFycmF5IHwgSW50MzJBcnJheSB8IGJvb2xlYW5bXTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgY2xhc3MgdG8gY3JlYXRlIGEgV2ViR0wgUHJvZ3JhbVxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdMUHJvZ3JhbVxue1xuICAgIHB1YmxpYyBwcm9ncmFtOiBXZWJHTFByb2dyYW07XG4gICAgcHVibGljIHVuaWZvcm1EYXRhOiBEaWN0PGFueT47XG4gICAgcHVibGljIHVuaWZvcm1Hcm91cHM6IERpY3Q8YW55PjtcbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIG5ldyBQaXhpIHByb2dyYW1cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcm9ncmFtIHtXZWJHTFByb2dyYW19IHdlYmdsIHByb2dyYW1cbiAgICAgKiBAcGFyYW0gdW5pZm9ybURhdGEge09iamVjdH0gdW5pZm9ybXNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihwcm9ncmFtOiBXZWJHTFByb2dyYW0sIHVuaWZvcm1EYXRhOiB7W2tleTogc3RyaW5nXTogSUdMVW5pZm9ybURhdGF9KVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzaGFkZXIgcHJvZ3JhbVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtXZWJHTFByb2dyYW19XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBob2xkcyB0aGUgdW5pZm9ybSBkYXRhIHdoaWNoIGNvbnRhaW5zIHVuaWZvcm0gbG9jYXRpb25zXG4gICAgICAgICAqIGFuZCBjdXJyZW50IHVuaWZvcm0gdmFsdWVzIHVzZWQgZm9yIGNhY2hpbmcgYW5kIHByZXZlbnRpbmcgdW5uZWVkZWQgR1BVIGNvbW1hbmRzXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudW5pZm9ybURhdGEgPSB1bmlmb3JtRGF0YTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdW5pZm9ybUdyb3VwcyBob2xkcyB0aGUgdmFyaW91cyB1cGxvYWQgZnVuY3Rpb25zIGZvciB0aGUgc2hhZGVyLiBFYWNoIHVuaWZvcm0gZ3JvdXBcbiAgICAgICAgICogYW5kIHByb2dyYW0gaGF2ZSBhIHVuaXF1ZSB1cGxvYWQgZnVuY3Rpb24gZ2VuZXJhdGVkLlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVuaWZvcm1Hcm91cHMgPSB7fTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGlzIHByb2dyYW1cbiAgICAgKi9cbiAgICBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudW5pZm9ybURhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLnVuaWZvcm1Hcm91cHMgPSBudWxsO1xuICAgICAgICB0aGlzLnByb2dyYW0gPSBudWxsO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi9TeXN0ZW0nO1xuaW1wb3J0IHsgR0xQcm9ncmFtIH0gZnJvbSAnLi9HTFByb2dyYW0nO1xuaW1wb3J0IHsgZ2VuZXJhdGVVbmlmb3Jtc1N5bmMsIHVuc2FmZUV2YWxTdXBwb3J0ZWQsIGRlZmF1bHRWYWx1ZSwgY29tcGlsZVByb2dyYW0gfSBmcm9tICcuL3V0aWxzJztcblxuaW1wb3J0IHR5cGUgeyBJR0xVbmlmb3JtRGF0YSB9IGZyb20gJy4vR0xQcm9ncmFtJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi9SZW5kZXJlcic7XG5pbXBvcnQgdHlwZSB7IElSZW5kZXJpbmdDb250ZXh0IH0gZnJvbSAnLi4vSVJlbmRlcmluZ0NvbnRleHQnO1xuaW1wb3J0IHR5cGUgeyBTaGFkZXIgfSBmcm9tICcuL1NoYWRlcic7XG5pbXBvcnQgdHlwZSB7IFByb2dyYW0gfSBmcm9tICcuL1Byb2dyYW0nO1xuaW1wb3J0IHR5cGUgeyBVbmlmb3JtR3JvdXAgfSBmcm9tICcuL1VuaWZvcm1Hcm91cCc7XG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IFVuaWZvcm1zU3luY0NhbGxiYWNrIH0gZnJvbSAnLi91dGlscyc7XG5cbmxldCBVSUQgPSAwO1xuLy8gZGVmdWFsdCBzeW5jIGRhdGEgc28gd2UgZG9uJ3QgY3JlYXRlIGEgbmV3IG9uZSBlYWNoIHRpbWUhXG5jb25zdCBkZWZhdWx0U3luY0RhdGEgPSB7IHRleHR1cmVDb3VudDogMCB9O1xuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSBzaGFkZXJzLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWEkuc3lzdGVtc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqL1xuZXhwb3J0IGNsYXNzIFNoYWRlclN5c3RlbSBleHRlbmRzIFN5c3RlbVxue1xuICAgIHByb3RlY3RlZCBnbDogSVJlbmRlcmluZ0NvbnRleHQ7XG4gICAgcHVibGljIHNoYWRlcjogU2hhZGVyO1xuICAgIHB1YmxpYyBwcm9ncmFtOiBQcm9ncmFtO1xuICAgIHB1YmxpYyBpZDogbnVtYmVyO1xuICAgIHB1YmxpYyBkZXN0cm95ZWQgPSBmYWxzZTtcbiAgICBwcml2YXRlIGNhY2hlOiBEaWN0PFVuaWZvcm1zU3luY0NhbGxiYWNrPjtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgU3lzdGVtIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgLy8gVmFsaWRhdGlvbiBjaGVjayB0aGF0IHRoaXMgZW52aXJvbm1lbnQgc3VwcG9ydCBgbmV3IEZ1bmN0aW9uYFxuICAgICAgICB0aGlzLnN5c3RlbUNoZWNrKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjdXJyZW50IFdlYkdMIHJlbmRlcmluZyBjb250ZXh0XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1dlYkdMUmVuZGVyaW5nQ29udGV4dH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2wgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuc2hhZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9ncmFtID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FjaGUgdG8gaG9sZHMgdGhlIGdlbmVyYXRlZCBmdW5jdGlvbnMuIFN0b3JlZCBhZ2FpbnN0IFVuaWZvcm1PYmplY3RzIHVuaXF1ZSBzaWduYXR1cmVcbiAgICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2FjaGUgPSB7fTtcblxuICAgICAgICB0aGlzLmlkID0gVUlEKys7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGVhYmxlIGZ1bmN0aW9uIGJ5IGBAcGl4aS91bnNhZmUtZXZhbGAgdG8gc2lsZW5jZVxuICAgICAqIHRocm93aW5nIGFuIGVycm9yIGlmIHBsYXRmb3JtIGRvZXNuJ3Qgc3VwcG9ydCB1bnNhZmUtZXZhbHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN5c3RlbUNoZWNrKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdW5zYWZlRXZhbFN1cHBvcnRlZCgpKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0N1cnJlbnQgZW52aXJvbm1lbnQgZG9lcyBub3QgYWxsb3cgdW5zYWZlLWV2YWwsICdcbiAgICAgICAgICAgICAgICArICdwbGVhc2UgdXNlIEBwaXhpL3Vuc2FmZS1ldmFsIG1vZHVsZSB0byBlbmFibGUgc3VwcG9ydC4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBjb250ZXh0Q2hhbmdlKGdsOiBJUmVuZGVyaW5nQ29udGV4dCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGN1cnJlbnQgc2hhZGVyIHRvIHRoZSBvbmUgZ2l2ZW4gaW4gcGFyYW1ldGVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuU2hhZGVyfSBzaGFkZXIgLSB0aGUgbmV3IHNoYWRlclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2RvbnRTeW5jXSAtIGZhbHNlIGlmIHRoZSBzaGFkZXIgc2hvdWxkIGF1dG9tYXRpY2FsbHkgc3luYyBpdHMgdW5pZm9ybXMuXG4gICAgICogQHJldHVybnMge1BJWEkuR0xQcm9ncmFtfSB0aGUgZ2xQcm9ncmFtIHRoYXQgYmVsb25ncyB0byB0aGUgc2hhZGVyLlxuICAgICAqL1xuICAgIGJpbmQoc2hhZGVyOiBTaGFkZXIsIGRvbnRTeW5jPzogYm9vbGVhbik6IEdMUHJvZ3JhbVxuICAgIHtcbiAgICAgICAgc2hhZGVyLnVuaWZvcm1zLmdsb2JhbHMgPSB0aGlzLnJlbmRlcmVyLmdsb2JhbFVuaWZvcm1zO1xuXG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSBzaGFkZXIucHJvZ3JhbTtcbiAgICAgICAgY29uc3QgZ2xQcm9ncmFtID0gcHJvZ3JhbS5nbFByb2dyYW1zW3RoaXMucmVuZGVyZXIuQ09OVEVYVF9VSURdIHx8IHRoaXMuZ2VuZXJhdGVTaGFkZXIoc2hhZGVyKTtcblxuICAgICAgICB0aGlzLnNoYWRlciA9IHNoYWRlcjtcblxuICAgICAgICAvLyBUT0RPIC0gc29tZSBjdXJyZW50IFBpeGkgcGx1Z2lucyBieXBhc3MgdGhpcy4uIHNvIGl0IG5vdCBzYWZlIHRvIHVzZSB5ZXQuLlxuICAgICAgICBpZiAodGhpcy5wcm9ncmFtICE9PSBwcm9ncmFtKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKGdsUHJvZ3JhbS5wcm9ncmFtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZG9udFN5bmMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlZmF1bHRTeW5jRGF0YS50ZXh0dXJlQ291bnQgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLnN5bmNVbmlmb3JtR3JvdXAoc2hhZGVyLnVuaWZvcm1Hcm91cCwgZGVmYXVsdFN5bmNEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnbFByb2dyYW07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBsb2FkcyB0aGUgdW5pZm9ybXMgdmFsdWVzIHRvIHRoZSBjdXJyZW50bHkgYm91bmQgc2hhZGVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHVuaWZvcm1zIC0gdGhlIHVuaWZvcm1zIHZhbHVlcyB0aGF0IGJlIGFwcGxpZWQgdG8gdGhlIGN1cnJlbnQgc2hhZGVyXG4gICAgICovXG4gICAgc2V0VW5pZm9ybXModW5pZm9ybXM6IERpY3Q8YW55Pik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHNoYWRlciA9IHRoaXMuc2hhZGVyLnByb2dyYW07XG4gICAgICAgIGNvbnN0IGdsUHJvZ3JhbSA9IHNoYWRlci5nbFByb2dyYW1zW3RoaXMucmVuZGVyZXIuQ09OVEVYVF9VSURdO1xuXG4gICAgICAgIHNoYWRlci5zeW5jVW5pZm9ybXMoZ2xQcm9ncmFtLnVuaWZvcm1EYXRhLCB1bmlmb3JtcywgdGhpcy5yZW5kZXJlcik7XG4gICAgfVxuXG4gICAgLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlcyAqL1xuICAgIC8qKlxuICAgICAqXG4gICAgICogc3luY3MgdW5pZm9ybXMgb24gdGhlIGdyb3VwXG4gICAgICogQHBhcmFtIHsqfSBncm91cCAtIHRoZSB1bmlmb3JtIGdyb3VwIHRvIHN5bmNcbiAgICAgKiBAcGFyYW0geyp9IFtzeW5jRGF0YV0gLSB0aGlzIGlzIGRhdGEgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIHN5bmMgZnVuY3Rpb24gYW5kIGFueSBuZXN0ZWQgc3luYyBmdW5jdGlvbnNcbiAgICAgKi9cbiAgICBzeW5jVW5pZm9ybUdyb3VwKGdyb3VwOiBVbmlmb3JtR3JvdXAsIHN5bmNEYXRhPzogYW55KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZ2xQcm9ncmFtID0gdGhpcy5nZXRnbFByb2dyYW0oKTtcblxuICAgICAgICBpZiAoIWdyb3VwLnN0YXRpYyB8fCBncm91cC5kaXJ0eUlkICE9PSBnbFByb2dyYW0udW5pZm9ybUdyb3Vwc1tncm91cC5pZF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsUHJvZ3JhbS51bmlmb3JtR3JvdXBzW2dyb3VwLmlkXSA9IGdyb3VwLmRpcnR5SWQ7XG5cbiAgICAgICAgICAgIHRoaXMuc3luY1VuaWZvcm1zKGdyb3VwLCBnbFByb2dyYW0sIHN5bmNEYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlYWJsZSBieSB0aGUgQHBpeGkvdW5zYWZlLWV2YWwgcGFja2FnZSB0byB1c2Ugc3RhdGljXG4gICAgICogc3luY1VuZm9ybXMgaW5zdGVhZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgc3luY1VuaWZvcm1zKGdyb3VwOiBVbmlmb3JtR3JvdXAsIGdsUHJvZ3JhbTogR0xQcm9ncmFtLCBzeW5jRGF0YTogYW55KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qgc3luY0Z1bmMgPSBncm91cC5zeW5jVW5pZm9ybXNbdGhpcy5zaGFkZXIucHJvZ3JhbS5pZF0gfHwgdGhpcy5jcmVhdGVTeW5jR3JvdXBzKGdyb3VwKTtcblxuICAgICAgICBzeW5jRnVuYyhnbFByb2dyYW0udW5pZm9ybURhdGEsIGdyb3VwLnVuaWZvcm1zLCB0aGlzLnJlbmRlcmVyLCBzeW5jRGF0YSk7XG4gICAgfVxuICAgIC8qIGVzbGludC1lbmFibGUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlcyAqL1xuXG4gICAgY3JlYXRlU3luY0dyb3Vwcyhncm91cDogVW5pZm9ybUdyb3VwKTogVW5pZm9ybXNTeW5jQ2FsbGJhY2tcbiAgICB7XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRTaWduYXR1cmUoZ3JvdXAsIHRoaXMuc2hhZGVyLnByb2dyYW0udW5pZm9ybURhdGEpO1xuXG4gICAgICAgIGlmICghdGhpcy5jYWNoZVtpZF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVbaWRdID0gZ2VuZXJhdGVVbmlmb3Jtc1N5bmMoZ3JvdXAsIHRoaXMuc2hhZGVyLnByb2dyYW0udW5pZm9ybURhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ3JvdXAuc3luY1VuaWZvcm1zW3RoaXMuc2hhZGVyLnByb2dyYW0uaWRdID0gdGhpcy5jYWNoZVtpZF07XG5cbiAgICAgICAgcmV0dXJuIGdyb3VwLnN5bmNVbmlmb3Jtc1t0aGlzLnNoYWRlci5wcm9ncmFtLmlkXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIHVuaWZvcm0gZ3JvdXAgYW5kIGRhdGEgYW5kIGdlbmVyYXRlcyBhIHVuaXF1ZSBzaWduYXR1cmUgZm9yIHRoZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuVW5pZm9ybUdyb3VwfSBncm91cCAtIHRoZSB1bmlmb3JtIGdyb3VwIHRvIGdldCBzaWduYXR1cmUgb2ZcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdW5pZm9ybURhdGEgLSB1bmlmb3JtIGluZm9ybWF0aW9uIGdlbmVyYXRlZCBieSB0aGUgc2hhZGVyXG4gICAgICogQHJldHVybnMge1N0cmluZ30gVW5pcXVlIHNpZ25hdHVyZSBvZiB0aGUgdW5pZm9ybSBncm91cFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZXRTaWduYXR1cmUoZ3JvdXA6IFVuaWZvcm1Hcm91cCwgdW5pZm9ybURhdGE6IERpY3Q8YW55Pik6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBncm91cC51bmlmb3JtcztcblxuICAgICAgICBjb25zdCBzdHJpbmdzID0gW107XG5cbiAgICAgICAgZm9yIChjb25zdCBpIGluIHVuaWZvcm1zKVxuICAgICAgICB7XG4gICAgICAgICAgICBzdHJpbmdzLnB1c2goaSk7XG5cbiAgICAgICAgICAgIGlmICh1bmlmb3JtRGF0YVtpXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdHJpbmdzLnB1c2godW5pZm9ybURhdGFbaV0udHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RyaW5ncy5qb2luKCctJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBHTFNoYWRlIHJvZiB0aGUgY3VycmVudGx5IGJvdW5kIHNoYWRlci5cbiAgICAgKiBUaGlzIGNhbiBiZSBoYW5keSBmb3Igd2hlbiB5b3UgdG8gaGF2ZSBhIGxpdHRsZSBtb3JlIGNvbnRyb2wgb3ZlciB0aGUgc2V0dGluZyBvZiB5b3VyIHVuaWZvcm1zLlxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5HTFByb2dyYW19IHRoZSBnbFByb2dyYW0gZm9yIHRoZSBjdXJyZW50bHkgYm91bmQgU2hhZGVyIGZvciB0aGlzIGNvbnRleHRcbiAgICAgKi9cbiAgICBnZXRnbFByb2dyYW0oKTogR0xQcm9ncmFtXG4gICAge1xuICAgICAgICBpZiAodGhpcy5zaGFkZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNoYWRlci5wcm9ncmFtLmdsUHJvZ3JhbXNbdGhpcy5yZW5kZXJlci5DT05URVhUX1VJRF07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgYSBnbFByb2dyYW0gdmVyc2lvbiBvZiB0aGUgU2hhZGVyIHByb3ZpZGVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuU2hhZGVyfSBzaGFkZXIgLSB0aGUgc2hhZGVyIHRoYXQgdGhlIGdsUHJvZ3JhbSB3aWxsIGJlIGJhc2VkIG9uLlxuICAgICAqIEByZXR1cm4ge1BJWEkuR0xQcm9ncmFtfSBBIHNoaW55IG5ldyBnbFByb2dyYW0hXG4gICAgICovXG4gICAgZ2VuZXJhdGVTaGFkZXIoc2hhZGVyOiBTaGFkZXIpOiBHTFByb2dyYW1cbiAgICB7XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbDtcblxuICAgICAgICBjb25zdCBwcm9ncmFtID0gc2hhZGVyLnByb2dyYW07XG5cbiAgICAgICAgY29uc3QgYXR0cmliTWFwOiBEaWN0PG51bWJlcj4gPSB7fTtcblxuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gcHJvZ3JhbS5hdHRyaWJ1dGVEYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJNYXBbaV0gPSBwcm9ncmFtLmF0dHJpYnV0ZURhdGFbaV0ubG9jYXRpb247XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzaGFkZXJQcm9ncmFtID0gY29tcGlsZVByb2dyYW0oZ2wsIHByb2dyYW0udmVydGV4U3JjLCBwcm9ncmFtLmZyYWdtZW50U3JjLCBhdHRyaWJNYXApO1xuICAgICAgICBjb25zdCB1bmlmb3JtRGF0YToge1trZXk6IHN0cmluZ106IElHTFVuaWZvcm1EYXRhfSA9IHt9O1xuXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiBwcm9ncmFtLnVuaWZvcm1EYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcHJvZ3JhbS51bmlmb3JtRGF0YVtpXTtcblxuICAgICAgICAgICAgdW5pZm9ybURhdGFbaV0gPSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb246IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihzaGFkZXJQcm9ncmFtLCBpKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZGVmYXVsdFZhbHVlKGRhdGEudHlwZSwgZGF0YS5zaXplKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBnbFByb2dyYW0gPSBuZXcgR0xQcm9ncmFtKHNoYWRlclByb2dyYW0sIHVuaWZvcm1EYXRhKTtcblxuICAgICAgICBwcm9ncmFtLmdsUHJvZ3JhbXNbdGhpcy5yZW5kZXJlci5DT05URVhUX1VJRF0gPSBnbFByb2dyYW07XG5cbiAgICAgICAgcmV0dXJuIGdsUHJvZ3JhbTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgU2hhZGVyU3lzdGVtIHN0YXRlLCBkb2VzIG5vdCBhZmZlY3QgV2ViR0wgc3RhdGVcbiAgICAgKi9cbiAgICByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnByb2dyYW0gPSBudWxsO1xuICAgICAgICB0aGlzLnNoYWRlciA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhpcyBTeXN0ZW0gYW5kIHJlbW92ZXMgYWxsIGl0cyB0ZXh0dXJlc1xuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gVE9ETyBpbXBsZW1lbnQgZGVzdHJveSBtZXRob2QgZm9yIFNoYWRlclN5c3RlbVxuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEJMRU5EX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuLyoqXG4gKiBNYXBzIGdsIGJsZW5kIGNvbWJpbmF0aW9ucyB0byBXZWJHTC5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGZ1bmN0aW9uIG1hcFdlYkdMQmxlbmRNb2Rlc1RvUGl4aVxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBnbCAtIFRoZSByZW5kZXJpbmcgY29udGV4dC5cbiAqIEBwYXJhbSB7bnVtYmVyW11bXX0gW2FycmF5PVtdXSAtIFRoZSBhcnJheSB0byBvdXRwdXQgaW50by5cbiAqIEByZXR1cm4ge251bWJlcltdW119IE1hcHBlZCBtb2Rlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcFdlYkdMQmxlbmRNb2Rlc1RvUGl4aShnbDogV2ViR0xSZW5kZXJpbmdDb250ZXh0QmFzZSwgYXJyYXk6IG51bWJlcltdW10gPSBbXSk6IG51bWJlcltdW11cbntcbiAgICAvLyBUT0RPIC0gcHJlbXVsdGlwbHkgYWxwaGEgd291bGQgYmUgZGlmZmVyZW50LlxuICAgIC8vIGFkZCBhIGJvb2xlYW4gZm9yIHRoYXQhXG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuTk9STUFMXSA9IFtnbC5PTkUsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEFdO1xuICAgIGFycmF5W0JMRU5EX01PREVTLkFERF0gPSBbZ2wuT05FLCBnbC5PTkVdO1xuICAgIGFycmF5W0JMRU5EX01PREVTLk1VTFRJUExZXSA9IFtnbC5EU1RfQ09MT1IsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEEsIGdsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuU0NSRUVOXSA9IFtnbC5PTkUsIGdsLk9ORV9NSU5VU19TUkNfQ09MT1IsIGdsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuT1ZFUkxBWV0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5EQVJLRU5dID0gW2dsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuTElHSFRFTl0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5DT0xPUl9ET0RHRV0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5DT0xPUl9CVVJOXSA9IFtnbC5PTkUsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEFdO1xuICAgIGFycmF5W0JMRU5EX01PREVTLkhBUkRfTElHSFRdID0gW2dsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuU09GVF9MSUdIVF0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5ESUZGRVJFTkNFXSA9IFtnbC5PTkUsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEFdO1xuICAgIGFycmF5W0JMRU5EX01PREVTLkVYQ0xVU0lPTl0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5IVUVdID0gW2dsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuU0FUVVJBVElPTl0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5DT0xPUl0gPSBbZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5MVU1JTk9TSVRZXSA9IFtnbC5PTkUsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEFdO1xuICAgIGFycmF5W0JMRU5EX01PREVTLk5PTkVdID0gWzAsIDBdO1xuXG4gICAgLy8gbm90LXByZW11bHRpcGxpZWQgYmxlbmQgbW9kZXNcbiAgICBhcnJheVtCTEVORF9NT0RFUy5OT1JNQUxfTlBNXSA9IFtnbC5TUkNfQUxQSEEsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEEsIGdsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuQUREX05QTV0gPSBbZ2wuU1JDX0FMUEhBLCBnbC5PTkUsIGdsLk9ORSwgZ2wuT05FXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5TQ1JFRU5fTlBNXSA9IFtnbC5TUkNfQUxQSEEsIGdsLk9ORV9NSU5VU19TUkNfQ09MT1IsIGdsLk9ORSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG5cbiAgICAvLyBjb21wb3NpdGUgb3BlcmF0aW9uc1xuICAgIGFycmF5W0JMRU5EX01PREVTLlNSQ19JTl0gPSBbZ2wuRFNUX0FMUEhBLCBnbC5aRVJPXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5TUkNfT1VUXSA9IFtnbC5PTkVfTUlOVVNfRFNUX0FMUEhBLCBnbC5aRVJPXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5TUkNfQVRPUF0gPSBbZ2wuRFNUX0FMUEhBLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5EU1RfT1ZFUl0gPSBbZ2wuT05FX01JTlVTX0RTVF9BTFBIQSwgZ2wuT05FXTtcbiAgICBhcnJheVtCTEVORF9NT0RFUy5EU1RfSU5dID0gW2dsLlpFUk8sIGdsLlNSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuRFNUX09VVF0gPSBbZ2wuWkVSTywgZ2wuT05FX01JTlVTX1NSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuRFNUX0FUT1BdID0gW2dsLk9ORV9NSU5VU19EU1RfQUxQSEEsIGdsLlNSQ19BTFBIQV07XG4gICAgYXJyYXlbQkxFTkRfTU9ERVMuWE9SXSA9IFtnbC5PTkVfTUlOVVNfRFNUX0FMUEhBLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBXTtcblxuICAgIC8vIFNVQlRSQUNUIGZyb20gZmxhc2hcbiAgICBhcnJheVtCTEVORF9NT0RFUy5TVUJUUkFDVF0gPSBbZ2wuT05FLCBnbC5PTkUsIGdsLk9ORSwgZ2wuT05FLCBnbC5GVU5DX1JFVkVSU0VfU1VCVFJBQ1QsIGdsLkZVTkNfQUREXTtcblxuICAgIHJldHVybiBhcnJheTtcbn1cbiIsICJpbXBvcnQgeyBtYXBXZWJHTEJsZW5kTW9kZXNUb1BpeGkgfSBmcm9tICcuL3V0aWxzL21hcFdlYkdMQmxlbmRNb2Rlc1RvUGl4aSc7XG5pbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi9TeXN0ZW0nO1xuaW1wb3J0IHsgU3RhdGUgfSBmcm9tICcuL1N0YXRlJztcbmltcG9ydCB7IEJMRU5EX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuaW1wb3J0IHR5cGUgeyBJUmVuZGVyaW5nQ29udGV4dCB9IGZyb20gJy4uL0lSZW5kZXJpbmdDb250ZXh0JztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi9SZW5kZXJlcic7XG5cbmNvbnN0IEJMRU5EID0gMDtcbmNvbnN0IE9GRlNFVCA9IDE7XG5jb25zdCBDVUxMSU5HID0gMjtcbmNvbnN0IERFUFRIX1RFU1QgPSAzO1xuY29uc3QgV0lORElORyA9IDQ7XG5cbi8qKlxuICogU3lzdGVtIHBsdWdpbiB0byB0aGUgcmVuZGVyZXIgdG8gbWFuYWdlIFdlYkdMIHN0YXRlIG1hY2hpbmVzLlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqIEBtZW1iZXJvZiBQSVhJLnN5c3RlbXNcbiAqL1xuZXhwb3J0IGNsYXNzIFN0YXRlU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHVibGljIHN0YXRlSWQ6IG51bWJlcjtcbiAgICBwdWJsaWMgcG9seWdvbk9mZnNldDogbnVtYmVyO1xuICAgIHB1YmxpYyBibGVuZE1vZGU6IEJMRU5EX01PREVTO1xuICAgIHByb3RlY3RlZCBfYmxlbmRFcTogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgZ2w6IElSZW5kZXJpbmdDb250ZXh0O1xuICAgIHByb3RlY3RlZCBibGVuZE1vZGVzOiBudW1iZXJbXVtdO1xuICAgIHByb3RlY3RlZCByZWFkb25seSBtYXA6IEFycmF5PCh2YWx1ZTogYm9vbGVhbikgPT4gdm9pZD47XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGNoZWNrczogQXJyYXk8KHN5c3RlbTogdGhpcywgc3RhdGU6IFN0YXRlKSA9PiB2b2lkPjtcbiAgICBwcm90ZWN0ZWQgZGVmYXVsdFN0YXRlOiBTdGF0ZTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgU3lzdGVtIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdMIGNvbnRleHRcbiAgICAgICAgICogQG1lbWJlciB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2wgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdGF0ZSBJRFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGF0ZUlkID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUG9seWdvbiBvZmZzZXRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucG9seWdvbk9mZnNldCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJsZW5kIG1vZGVcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLkJMRU5EX01PREVTLk5PTkVcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJsZW5kTW9kZSA9IEJMRU5EX01PREVTLk5PTkU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgY3VycmVudCBibGVuZCBlcXVhdGlvbiBpcyBkaWZmZXJlbnRcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmxlbmRFcSA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb2xsZWN0aW9uIG9mIGNhbGxzXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9uW119XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXAgPSBbXTtcblxuICAgICAgICAvLyBtYXAgZnVuY3Rpb25zIGZvciB3aGVuIHdlIHNldCBzdGF0ZS4uXG4gICAgICAgIHRoaXMubWFwW0JMRU5EXSA9IHRoaXMuc2V0QmxlbmQ7XG4gICAgICAgIHRoaXMubWFwW09GRlNFVF0gPSB0aGlzLnNldE9mZnNldDtcbiAgICAgICAgdGhpcy5tYXBbQ1VMTElOR10gPSB0aGlzLnNldEN1bGxGYWNlO1xuICAgICAgICB0aGlzLm1hcFtERVBUSF9URVNUXSA9IHRoaXMuc2V0RGVwdGhUZXN0O1xuICAgICAgICB0aGlzLm1hcFtXSU5ESU5HXSA9IHRoaXMuc2V0RnJvbnRGYWNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb2xsZWN0aW9uIG9mIGNoZWNrIGNhbGxzXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9uW119XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jaGVja3MgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVmYXVsdCBXZWJHTCBTdGF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlN0YXRlfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGVmYXVsdFN0YXRlID0gbmV3IFN0YXRlKCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFN0YXRlLmJsZW5kID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBjb250ZXh0Q2hhbmdlKGdsOiBJUmVuZGVyaW5nQ29udGV4dCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcblxuICAgICAgICB0aGlzLmJsZW5kTW9kZXMgPSBtYXBXZWJHTEJsZW5kTW9kZXNUb1BpeGkoZ2wpO1xuXG4gICAgICAgIHRoaXMuc2V0KHRoaXMuZGVmYXVsdFN0YXRlKTtcblxuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCBzdGF0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSBzdGF0ZSAtIFRoZSBzdGF0ZSB0byBzZXQuXG4gICAgICovXG4gICAgc2V0KHN0YXRlOiBTdGF0ZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN0YXRlID0gc3RhdGUgfHwgdGhpcy5kZWZhdWx0U3RhdGU7XG5cbiAgICAgICAgLy8gVE9ETyBtYXliZSB0byBhbiBvYmplY3QgY2hlY2s/ICggdGhpcy5zdGF0ZSA9PT0gc3RhdGUgKT9cbiAgICAgICAgaWYgKHRoaXMuc3RhdGVJZCAhPT0gc3RhdGUuZGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGRpZmYgPSB0aGlzLnN0YXRlSWQgXiBzdGF0ZS5kYXRhO1xuICAgICAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgICAgICAvLyBvcmRlciBmcm9tIGxlYXN0IHRvIG1vc3QgY29tbW9uXG4gICAgICAgICAgICB3aGlsZSAoZGlmZilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoZGlmZiAmIDEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyBzdGF0ZSBjaGFuZ2UhXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFwW2ldLmNhbGwodGhpcywgISEoc3RhdGUuZGF0YSAmICgxIDw8IGkpKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZGlmZiA9IGRpZmYgPj4gMTtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc3RhdGVJZCA9IHN0YXRlLmRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBiYXNlZCBvbiB0aGUgYWJvdmUgc2V0dGluZ3Mgd2UgY2hlY2sgZm9yIHNwZWNpZmljIG1vZGVzLi5cbiAgICAgICAgLy8gZm9yIGV4YW1wbGUgaWYgYmxlbmQgaXMgYWN0aXZlIHdlIGNoZWNrIGFuZCBzZXQgdGhlIGJsZW5kIG1vZGVzXG4gICAgICAgIC8vIG9yIG9mIHBvbHlnb24gb2Zmc2V0IGlzIGFjdGl2ZSB3ZSBjaGVjayB0aGUgcG9seSBkZXB0aC5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoZWNrcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jaGVja3NbaV0odGhpcywgc3RhdGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc3RhdGUsIHdoZW4gcHJldmlvdXMgc3RhdGUgaXMgdW5rbm93blxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSBzdGF0ZSAtIFRoZSBzdGF0ZSB0byBzZXRcbiAgICAgKi9cbiAgICBmb3JjZVN0YXRlKHN0YXRlOiBTdGF0ZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN0YXRlID0gc3RhdGUgfHwgdGhpcy5kZWZhdWx0U3RhdGU7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYXAubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubWFwW2ldLmNhbGwodGhpcywgISEoc3RhdGUuZGF0YSAmICgxIDw8IGkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoZWNrcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jaGVja3NbaV0odGhpcywgc3RhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGF0ZUlkID0gc3RhdGUuZGF0YTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmFibGVzIG9yIGRpc2FibGVkIGJsZW5kaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSB2YWx1ZSAtIFR1cm4gb24gb3Igb2ZmIHdlYmdsIGJsZW5kaW5nLlxuICAgICAqL1xuICAgIHNldEJsZW5kKHZhbHVlOiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy51cGRhdGVDaGVjayhTdGF0ZVN5c3RlbS5jaGVja0JsZW5kTW9kZSwgdmFsdWUpO1xuXG4gICAgICAgIHRoaXMuZ2xbdmFsdWUgPyAnZW5hYmxlJyA6ICdkaXNhYmxlJ10odGhpcy5nbC5CTEVORCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBvciBkaXNhYmxlIHBvbHlnb24gb2Zmc2V0IGZpbGxcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWUgLSBUdXJuIG9uIG9yIG9mZiB3ZWJnbCBwb2x5Z29uIG9mZnNldCB0ZXN0aW5nLlxuICAgICAqL1xuICAgIHNldE9mZnNldCh2YWx1ZTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudXBkYXRlQ2hlY2soU3RhdGVTeXN0ZW0uY2hlY2tQb2x5Z29uT2Zmc2V0LCB2YWx1ZSk7XG5cbiAgICAgICAgdGhpcy5nbFt2YWx1ZSA/ICdlbmFibGUnIDogJ2Rpc2FibGUnXSh0aGlzLmdsLlBPTFlHT05fT0ZGU0VUX0ZJTEwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgd2hldGhlciB0byBlbmFibGUgb3IgZGlzYWJsZSBkZXB0aCB0ZXN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSB2YWx1ZSAtIFR1cm4gb24gb3Igb2ZmIHdlYmdsIGRlcHRoIHRlc3RpbmcuXG4gICAgICovXG4gICAgc2V0RGVwdGhUZXN0KHZhbHVlOiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5nbFt2YWx1ZSA/ICdlbmFibGUnIDogJ2Rpc2FibGUnXSh0aGlzLmdsLkRFUFRIX1RFU1QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgd2hldGhlciB0byBlbmFibGUgb3IgZGlzYWJsZSBjdWxsIGZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHZhbHVlIC0gVHVybiBvbiBvciBvZmYgd2ViZ2wgY3VsbCBmYWNlLlxuICAgICAqL1xuICAgIHNldEN1bGxGYWNlKHZhbHVlOiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5nbFt2YWx1ZSA/ICdlbmFibGUnIDogJ2Rpc2FibGUnXSh0aGlzLmdsLkNVTExfRkFDRSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZ2wgZnJvbnQgZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWUgLSB0cnVlIGlzIGNsb2Nrd2lzZSBhbmQgZmFsc2UgaXMgY291bnRlci1jbG9ja3dpc2VcbiAgICAgKi9cbiAgICBzZXRGcm9udEZhY2UodmFsdWU6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmdsLmZyb250RmFjZSh0aGlzLmdsW3ZhbHVlID8gJ0NXJyA6ICdDQ1cnXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYmxlbmQgbW9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIFRoZSBibGVuZCBtb2RlIHRvIHNldCB0by5cbiAgICAgKi9cbiAgICBzZXRCbGVuZE1vZGUodmFsdWU6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5ibGVuZE1vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYmxlbmRNb2RlID0gdmFsdWU7XG5cbiAgICAgICAgY29uc3QgbW9kZSA9IHRoaXMuYmxlbmRNb2Rlc1t2YWx1ZV07XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbDtcblxuICAgICAgICBpZiAobW9kZS5sZW5ndGggPT09IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmJsZW5kRnVuYyhtb2RlWzBdLCBtb2RlWzFdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmJsZW5kRnVuY1NlcGFyYXRlKG1vZGVbMF0sIG1vZGVbMV0sIG1vZGVbMl0sIG1vZGVbM10pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlLmxlbmd0aCA9PT0gNilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fYmxlbmRFcSA9IHRydWU7XG4gICAgICAgICAgICBnbC5ibGVuZEVxdWF0aW9uU2VwYXJhdGUobW9kZVs0XSwgbW9kZVs1XSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fYmxlbmRFcSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fYmxlbmRFcSA9IGZhbHNlO1xuICAgICAgICAgICAgZ2wuYmxlbmRFcXVhdGlvblNlcGFyYXRlKGdsLkZVTkNfQURELCBnbC5GVU5DX0FERCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwb2x5Z29uIG9mZnNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIHRoZSBwb2x5Z29uIG9mZnNldFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZSAtIHRoZSBwb2x5Z29uIG9mZnNldCBzY2FsZVxuICAgICAqL1xuICAgIHNldFBvbHlnb25PZmZzZXQodmFsdWU6IG51bWJlciwgc2NhbGU6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZ2wucG9seWdvbk9mZnNldCh2YWx1ZSwgc2NhbGUpO1xuICAgIH1cblxuICAgIC8vIHVzZWRcbiAgICAvKipcbiAgICAgKiBSZXNldHMgYWxsIHRoZSBsb2dpYyBhbmQgZGlzYWJsZXMgdGhlIHZhb3NcbiAgICAgKi9cbiAgICByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmdsLnBpeGVsU3RvcmVpKHRoaXMuZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgZmFsc2UpO1xuXG4gICAgICAgIHRoaXMuZm9yY2VTdGF0ZSh0aGlzLmRlZmF1bHRTdGF0ZSk7XG5cbiAgICAgICAgdGhpcy5fYmxlbmRFcSA9IHRydWU7XG4gICAgICAgIHRoaXMuYmxlbmRNb2RlID0gLTE7XG4gICAgICAgIHRoaXMuc2V0QmxlbmRNb2RlKDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNoZWNrcyB0byBzZWUgd2hpY2ggdXBkYXRlcyBzaG91bGQgYmUgY2hlY2tlZCBiYXNlZCBvbiB3aGljaCBzZXR0aW5ncyBoYXZlIGJlZW4gYWN0aXZhdGVkLlxuICAgICAqIEZvciBleGFtcGxlLCBpZiBibGVuZCBpcyBlbmFibGVkIHRoZW4gd2Ugc2hvdWxkIGNoZWNrIHRoZSBibGVuZCBtb2RlcyBlYWNoIHRpbWUgdGhlIHN0YXRlIGlzIGNoYW5nZWRcbiAgICAgKiBvciBpZiBwb2x5Z29uIGZpbGwgaXMgYWN0aXZhdGVkIHRoZW4gd2UgbmVlZCB0byBjaGVjayBpZiB0aGUgcG9seWdvbiBvZmZzZXQgY2hhbmdlcy5cbiAgICAgKiBUaGUgaWRlYSBpcyB0aGF0IHdlIG9ubHkgY2hlY2sgd2hhdCB3ZSBoYXZlIHRvby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgLSB0aGUgY2hlY2tpbmcgZnVuY3Rpb24gdG8gYWRkIG9yIHJlbW92ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWUgLSBzaG91bGQgdGhlIGNoZWNrIGZ1bmN0aW9uIGJlIGFkZGVkIG9yIHJlbW92ZWQuXG4gICAgICovXG4gICAgdXBkYXRlQ2hlY2soZnVuYzogKHN5c3RlbTogdGhpcywgc3RhdGU6IFN0YXRlKSA9PiB2b2lkLCB2YWx1ZTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGVja3MuaW5kZXhPZihmdW5jKTtcblxuICAgICAgICBpZiAodmFsdWUgJiYgaW5kZXggPT09IC0xKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrcy5wdXNoKGZ1bmMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF2YWx1ZSAmJiBpbmRleCAhPT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHByaXZhdGUgbGl0dGxlIHdyYXBwZXIgZnVuY3Rpb24gdGhhdCB3ZSBjYWxsIHRvIGNoZWNrIHRoZSBibGVuZCBtb2RlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtQSVhJLlN0YXRlU3lzdGVtfSBTeXN0ZW0gLSB0aGUgU3lzdGVtIHRvIHBlcmZvcm0gdGhlIHN0YXRlIGNoZWNrIG9uXG4gICAgICogQHBhcmFtIHtQSVhJLlN0YXRlfSBzdGF0ZSAtIHRoZSBzdGF0ZSB0aGF0IHRoZSBibGVuZE1vZGUgd2lsbCBwdWxsZWQgZnJvbVxuICAgICAqL1xuICAgIHN0YXRpYyBjaGVja0JsZW5kTW9kZShzeXN0ZW06IFN0YXRlU3lzdGVtLCBzdGF0ZTogU3RhdGUpOiB2b2lkXG4gICAge1xuICAgICAgICBzeXN0ZW0uc2V0QmxlbmRNb2RlKHN0YXRlLmJsZW5kTW9kZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBwcml2YXRlIGxpdHRsZSB3cmFwcGVyIGZ1bmN0aW9uIHRoYXQgd2UgY2FsbCB0byBjaGVjayB0aGUgcG9seWdvbiBvZmZzZXQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuU3RhdGVTeXN0ZW19IFN5c3RlbSAtIHRoZSBTeXN0ZW0gdG8gcGVyZm9ybSB0aGUgc3RhdGUgY2hlY2sgb25cbiAgICAgKiBAcGFyYW0ge1BJWEkuU3RhdGV9IHN0YXRlIC0gdGhlIHN0YXRlIHRoYXQgdGhlIGJsZW5kTW9kZSB3aWxsIHB1bGxlZCBmcm9tXG4gICAgICovXG4gICAgc3RhdGljIGNoZWNrUG9seWdvbk9mZnNldChzeXN0ZW06IFN0YXRlU3lzdGVtLCBzdGF0ZTogU3RhdGUpOiB2b2lkXG4gICAge1xuICAgICAgICBzeXN0ZW0uc2V0UG9seWdvbk9mZnNldCgxLCBzdGF0ZS5wb2x5Z29uT2Zmc2V0KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgU3lzdGVtIH0gZnJvbSAnLi4vU3lzdGVtJztcbmltcG9ydCB7IEdDX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuXG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBUZXh0dXJlIH0gZnJvbSAnLi9UZXh0dXJlJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyVGV4dHVyZSB9IGZyb20gJy4uL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVVubG9hZGFibGVUZXh0dXJlIHtcbiAgICBfdGV4dHVyZTogVGV4dHVyZSB8IFJlbmRlclRleHR1cmU7XG4gICAgY2hpbGRyZW46IElVbmxvYWRhYmxlVGV4dHVyZVtdO1xufVxuXG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSB0ZXh0dXJlIGdhcmJhZ2UgY29sbGVjdGlvbiBvbiB0aGUgR1BVLFxuICogZW5zdXJpbmcgdGhhdCBpdCBkb2VzIG5vdCBnZXQgY2xvZ2dlZCB1cCB3aXRoIHRleHR1cmVzIHRoYXQgYXJlIG5vIGxvbmdlciBiZWluZyB1c2VkLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWEkuc3lzdGVtc1xuICogQGV4dGVuZHMgUElYSS5TeXN0ZW1cbiAqL1xuZXhwb3J0IGNsYXNzIFRleHR1cmVHQ1N5c3RlbSBleHRlbmRzIFN5c3RlbVxue1xuICAgIHB1YmxpYyBjb3VudDogbnVtYmVyO1xuICAgIHB1YmxpYyBjaGVja0NvdW50OiBudW1iZXI7XG4gICAgcHVibGljIG1heElkbGU6IG51bWJlcjtcbiAgICBwdWJsaWMgY2hlY2tDb3VudE1heDogbnVtYmVyO1xuICAgIHB1YmxpYyBtb2RlOiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlciB0aGlzIFN5c3RlbSB3b3JrcyBmb3IuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXI6IFJlbmRlcmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb3VudFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoZWNrIGNvdW50XG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrQ291bnQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXhpbXVtIGlkbGUgdGltZSwgaW4gc2Vjb25kc1xuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBzZWUgUElYSS5zZXR0aW5ncy5HQ19NQVhfSURMRVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXhJZGxlID0gc2V0dGluZ3MuR0NfTUFYX0lETEU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1heGltdW0gbnVtYmVyIG9mIGl0ZW0gdG8gY2hlY2tcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAc2VlIFBJWEkuc2V0dGluZ3MuR0NfTUFYX0NIRUNLX0NPVU5UXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoZWNrQ291bnRNYXggPSBzZXR0aW5ncy5HQ19NQVhfQ0hFQ0tfQ09VTlQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEN1cnJlbnQgZ2FyYWJhZ2UgY29sbGVjdGlvbiBtb2RlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuR0NfTU9ERVN9XG4gICAgICAgICAqIEBzZWUgUElYSS5zZXR0aW5ncy5HQ19NT0RFXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1vZGUgPSBzZXR0aW5ncy5HQ19NT0RFO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0byBzZWUgd2hlbiB0aGUgbGFzdCB0aW1lIGEgdGV4dHVyZSB3YXMgdXNlZFxuICAgICAqIGlmIHRoZSB0ZXh0dXJlIGhhcyBub3QgYmVlbiB1c2VkIGZvciBhIHNwZWNpZmllZCBhbW91bnQgb2YgdGltZSBpdCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgR1BVXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHBvc3RyZW5kZXIoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnJlbmRlcmVyLnJlbmRlcmluZ1RvU2NyZWVuKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvdW50Kys7XG5cbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gR0NfTU9ERVMuTUFOVUFMKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNoZWNrQ291bnQrKztcblxuICAgICAgICBpZiAodGhpcy5jaGVja0NvdW50ID4gdGhpcy5jaGVja0NvdW50TWF4KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrQ291bnQgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLnJ1bigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRvIHNlZSB3aGVuIHRoZSBsYXN0IHRpbWUgYSB0ZXh0dXJlIHdhcyB1c2VkXG4gICAgICogaWYgdGhlIHRleHR1cmUgaGFzIG5vdCBiZWVuIHVzZWQgZm9yIGEgc3BlY2lmaWVkIGFtb3VudCBvZiB0aW1lIGl0IHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBHUFVcbiAgICAgKi9cbiAgICBydW4oKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdG0gPSB0aGlzLnJlbmRlcmVyLnRleHR1cmU7XG4gICAgICAgIGNvbnN0IG1hbmFnZWRUZXh0dXJlcyA9ICB0bS5tYW5hZ2VkVGV4dHVyZXM7XG4gICAgICAgIGxldCB3YXNSZW1vdmVkID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYW5hZ2VkVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmUgPSBtYW5hZ2VkVGV4dHVyZXNbaV07XG5cbiAgICAgICAgICAgIC8vIG9ubHkgc3VwcG9ydHMgbm9uIGdlbmVyYXRlZCB0ZXh0dXJlcyBhdCB0aGUgbW9tZW50IVxuICAgICAgICAgICAgaWYgKCEodGV4dHVyZSBhcyBhbnkpLmZyYW1lYnVmZmVyICYmIHRoaXMuY291bnQgLSB0ZXh0dXJlLnRvdWNoZWQgPiB0aGlzLm1heElkbGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdG0uZGVzdHJveVRleHR1cmUodGV4dHVyZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgbWFuYWdlZFRleHR1cmVzW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICB3YXNSZW1vdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3YXNSZW1vdmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgaiA9IDA7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFuYWdlZFRleHR1cmVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChtYW5hZ2VkVGV4dHVyZXNbaV0gIT09IG51bGwpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYW5hZ2VkVGV4dHVyZXNbaisrXSA9IG1hbmFnZWRUZXh0dXJlc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1hbmFnZWRUZXh0dXJlcy5sZW5ndGggPSBqO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbGwgdGhlIHRleHR1cmVzIHdpdGhpbiB0aGUgc3BlY2lmaWVkIGRpc3BsYXlPYmplY3QgYW5kIGl0cyBjaGlsZHJlbiBmcm9tIHRoZSBHUFVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBkaXNwbGF5T2JqZWN0IC0gdGhlIGRpc3BsYXlPYmplY3QgdG8gcmVtb3ZlIHRoZSB0ZXh0dXJlcyBmcm9tLlxuICAgICAqL1xuICAgIHVubG9hZChkaXNwbGF5T2JqZWN0OiBJVW5sb2FkYWJsZVRleHR1cmUpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB0bSA9IHRoaXMucmVuZGVyZXIudGV4dHVyZTtcblxuICAgICAgICAvLyBvbmx5IGRlc3Ryb3kgbm9uIGdlbmVyYXRlZCB0ZXh0dXJlc1xuICAgICAgICBpZiAoKGRpc3BsYXlPYmplY3QuX3RleHR1cmUgYXMgUmVuZGVyVGV4dHVyZSk/LmZyYW1lYnVmZmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0bS5kZXN0cm95VGV4dHVyZShkaXNwbGF5T2JqZWN0Ll90ZXh0dXJlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSBkaXNwbGF5T2JqZWN0LmNoaWxkcmVuLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnVubG9hZChkaXNwbGF5T2JqZWN0LmNoaWxkcmVuW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICIvKipcbiAqIEludGVybmFsIHRleHR1cmUgZm9yIFdlYkdMIGNvbnRleHRcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdMVGV4dHVyZVxue1xuICAgIHB1YmxpYyB0ZXh0dXJlOiBXZWJHTFRleHR1cmU7XG4gICAgcHVibGljIHdpZHRoOiBudW1iZXI7XG4gICAgcHVibGljIGhlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyBtaXBtYXA6IGJvb2xlYW47XG4gICAgcHVibGljIHdyYXBNb2RlOiBudW1iZXI7XG4gICAgcHVibGljIHR5cGU6IG51bWJlcjtcbiAgICBwdWJsaWMgaW50ZXJuYWxGb3JtYXQ6IG51bWJlcjtcbiAgICBkaXJ0eUlkOiBudW1iZXI7XG4gICAgZGlydHlTdHlsZUlkOiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3Rvcih0ZXh0dXJlOiBXZWJHTFRleHR1cmUpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFdlYkdMIHRleHR1cmVcbiAgICAgICAgICogQG1lbWJlciB7V2ViR0xUZXh0dXJlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZXh0dXJlID0gdGV4dHVyZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2lkdGggb2YgdGV4dHVyZSB0aGF0IHdhcyB1c2VkIGluIHRleEltYWdlMkRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53aWR0aCA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIZWlnaHQgb2YgdGV4dHVyZSB0aGF0IHdhcyB1c2VkIGluIHRleEltYWdlMkRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oZWlnaHQgPSAtMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGV4dHVyZSBjb250ZW50cyBkaXJ0eSBmbGFnXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlydHlJZCA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUZXh0dXJlIHN0eWxlIGRpcnR5IGZsYWdcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXJ0eVN0eWxlSWQgPSAtMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBtaXAgbGV2ZWxzIGhhcyB0byBiZSBnZW5lcmF0ZWRcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWlwbWFwID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdyYXBNb2RlIGNvcGllZCBmcm9tIGJhc2VUZXh0dXJlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud3JhcE1vZGUgPSAzMzA3MTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVHlwZSBjb3BpZWQgZnJvbSBiYXNlVGV4dHVyZVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSA2NDA4O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUeXBlIGNvcGllZCBmcm9tIGJhc2VUZXh0dXJlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW50ZXJuYWxGb3JtYXQgPSA1MTIxO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi9TeXN0ZW0nO1xuaW1wb3J0IHsgQmFzZVRleHR1cmUgfSBmcm9tICcuL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB7IEdMVGV4dHVyZSB9IGZyb20gJy4vR0xUZXh0dXJlJztcbmltcG9ydCB7IHJlbW92ZUl0ZW1zIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgTUlQTUFQX01PREVTLCBXUkFQX01PREVTLCBTQ0FMRV9NT0RFUywgVFlQRVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IFRleHR1cmUgfSBmcm9tICcuL1RleHR1cmUnO1xuaW1wb3J0IHR5cGUgeyBJUmVuZGVyaW5nQ29udGV4dCB9IGZyb20gJy4uL0lSZW5kZXJpbmdDb250ZXh0JztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICcuLi9SZW5kZXJlcic7XG4vKipcbiAqIFN5c3RlbSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyIHRvIG1hbmFnZSB0ZXh0dXJlcy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3lzdGVtXG4gKiBAbWVtYmVyb2YgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0dXJlU3lzdGVtIGV4dGVuZHMgU3lzdGVtXG57XG4gICAgcHVibGljIGJvdW5kVGV4dHVyZXM6IEJhc2VUZXh0dXJlW107XG4gICAgcHVibGljIG1hbmFnZWRUZXh0dXJlczogQXJyYXk8QmFzZVRleHR1cmU+O1xuICAgIHByb3RlY3RlZCBDT05URVhUX1VJRDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBnbDogSVJlbmRlcmluZ0NvbnRleHQ7XG4gICAgcHJvdGVjdGVkIHdlYkdMVmVyc2lvbjogbnVtYmVyO1xuICAgIHByb3RlY3RlZCB1bmtub3duVGV4dHVyZTogQmFzZVRleHR1cmU7XG4gICAgcHJvdGVjdGVkIF91bmtub3duQm91bmRUZXh0dXJlczogYm9vbGVhbjtcbiAgICBjdXJyZW50TG9jYXRpb246IG51bWJlcjtcbiAgICBlbXB0eVRleHR1cmVzOiB7W2tleTogbnVtYmVyXTogR0xUZXh0dXJlfTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBTeXN0ZW0gd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvLyBUT0RPIHNldCB0byBtYXggdGV4dHVyZXMuLi5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJvdW5kIHRleHR1cmVzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQmFzZVRleHR1cmVbXX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJvdW5kVGV4dHVyZXMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEN1cnJlbnQgbG9jYXRpb25cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3VycmVudExvY2F0aW9uID0gLTE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExpc3Qgb2YgbWFuYWdlZCB0ZXh0dXJlc1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlW119XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYW5hZ2VkVGV4dHVyZXMgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlkIHNvbWVvbmUgdGVtcGVyIHdpdGggdGV4dHVyZXMgc3RhdGU/IFdlJ2xsIG92ZXJ3cml0ZSB0aGVtIHdoZW4gd2UgbmVlZCB0byB1bmJpbmQgc29tZXRoaW5nLlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdW5rbm93bkJvdW5kVGV4dHVyZXMgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQmFzZVRleHR1cmUgdmFsdWUgdGhhdCBzaG93cyB0aGF0IHdlIGRvbid0IGtub3cgd2hhdCBpcyBib3VuZFxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJhc2VUZXh0dXJlfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudW5rbm93blRleHR1cmUgPSBuZXcgQmFzZVRleHR1cmUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIHRoZSByZW5kZXJlciBjb250ZXh0IGFuZCBuZWNlc3NhcnkgYnVmZmVycy5cbiAgICAgKi9cbiAgICBjb250ZXh0Q2hhbmdlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGdsID0gdGhpcy5nbCA9IHRoaXMucmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgdGhpcy5DT05URVhUX1VJRCA9IHRoaXMucmVuZGVyZXIuQ09OVEVYVF9VSUQ7XG5cbiAgICAgICAgdGhpcy53ZWJHTFZlcnNpb24gPSB0aGlzLnJlbmRlcmVyLmNvbnRleHQud2ViR0xWZXJzaW9uO1xuXG4gICAgICAgIGNvbnN0IG1heFRleHR1cmVzID0gZ2wuZ2V0UGFyYW1ldGVyKGdsLk1BWF9URVhUVVJFX0lNQUdFX1VOSVRTKTtcblxuICAgICAgICB0aGlzLmJvdW5kVGV4dHVyZXMubGVuZ3RoID0gbWF4VGV4dHVyZXM7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhUZXh0dXJlczsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJvdW5kVGV4dHVyZXNbaV0gPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETyBtb3ZlIHRoaXMuLiB0byBhIG5pY2UgbWFrZSBlbXB0eSB0ZXh0dXJlcyBjbGFzcy4uXG4gICAgICAgIHRoaXMuZW1wdHlUZXh0dXJlcyA9IHt9O1xuXG4gICAgICAgIGNvbnN0IGVtcHR5VGV4dHVyZTJEID0gbmV3IEdMVGV4dHVyZShnbC5jcmVhdGVUZXh0dXJlKCkpO1xuXG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIGVtcHR5VGV4dHVyZTJELnRleHR1cmUpO1xuICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIDEsIDEsIDAsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIG5ldyBVaW50OEFycmF5KDQpKTtcblxuICAgICAgICB0aGlzLmVtcHR5VGV4dHVyZXNbZ2wuVEVYVFVSRV8yRF0gPSBlbXB0eVRleHR1cmUyRDtcbiAgICAgICAgdGhpcy5lbXB0eVRleHR1cmVzW2dsLlRFWFRVUkVfQ1VCRV9NQVBdID0gbmV3IEdMVGV4dHVyZShnbC5jcmVhdGVUZXh0dXJlKCkpO1xuXG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfQ1VCRV9NQVAsIHRoaXMuZW1wdHlUZXh0dXJlc1tnbC5URVhUVVJFX0NVQkVfTUFQXS50ZXh0dXJlKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgZ2wudGV4SW1hZ2UyRChnbC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ggKyBpLCAwLCBnbC5SR0JBLCAxLCAxLCAwLCBnbC5SR0JBLCBnbC5VTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV9DVUJFX01BUCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5MSU5FQVIpO1xuICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfQ1VCRV9NQVAsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgZ2wuTElORUFSKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm91bmRUZXh0dXJlcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5iaW5kKG51bGwsIGkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQmluZCBhIHRleHR1cmUgdG8gYSBzcGVjaWZpYyBsb2NhdGlvblxuICAgICAqXG4gICAgICogSWYgeW91IHdhbnQgdG8gdW5iaW5kIHNvbWV0aGluZywgcGxlYXNlIHVzZSBgdW5iaW5kKHRleHR1cmUpYCBpbnN0ZWFkIG9mIGBiaW5kKG51bGwsIHRleHR1cmVMb2NhdGlvbilgXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZXxQSVhJLkJhc2VUZXh0dXJlfSB0ZXh0dXJlXyAtIFRleHR1cmUgdG8gYmluZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbbG9jYXRpb249MF0gLSBMb2NhdGlvbiB0byBiaW5kIGF0XG4gICAgICovXG4gICAgYmluZCh0ZXh0dXJlOiBUZXh0dXJlfEJhc2VUZXh0dXJlLCBsb2NhdGlvbiA9IDApOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB7IGdsIH0gPSB0aGlzO1xuXG4gICAgICAgIGlmICh0ZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0dXJlID0gdGV4dHVyZS5jYXN0VG9CYXNlVGV4dHVyZSgpO1xuXG4gICAgICAgICAgICBpZiAodGV4dHVyZS5wYXJlbnRUZXh0dXJlQXJyYXkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gY2Fubm90IGJpbmQgcGFydGlhbCB0ZXh0dXJlXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogcmVwb3J0IGEgd2FybmluZ1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRleHR1cmUudmFsaWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGV4dHVyZS50b3VjaGVkID0gdGhpcy5yZW5kZXJlci50ZXh0dXJlR0MuY291bnQ7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBnbFRleHR1cmUgPSB0ZXh0dXJlLl9nbFRleHR1cmVzW3RoaXMuQ09OVEVYVF9VSURdIHx8IHRoaXMuaW5pdFRleHR1cmUodGV4dHVyZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ib3VuZFRleHR1cmVzW2xvY2F0aW9uXSAhPT0gdGV4dHVyZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2NhdGlvbiAhPT0gbG9jYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwICsgbG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdsLmJpbmRUZXh0dXJlKHRleHR1cmUudGFyZ2V0LCBnbFRleHR1cmUudGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGdsVGV4dHVyZS5kaXJ0eUlkICE9PSB0ZXh0dXJlLmRpcnR5SWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9jYXRpb24gIT09IGxvY2F0aW9uKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRMb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCArIGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRleHR1cmUodGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5ib3VuZFRleHR1cmVzW2xvY2F0aW9uXSA9IHRleHR1cmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9jYXRpb24gIT09IGxvY2F0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudExvY2F0aW9uID0gbG9jYXRpb247XG4gICAgICAgICAgICAgICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCArIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGhpcy5lbXB0eVRleHR1cmVzW2dsLlRFWFRVUkVfMkRdLnRleHR1cmUpO1xuICAgICAgICAgICAgdGhpcy5ib3VuZFRleHR1cmVzW2xvY2F0aW9uXSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGV4dHVyZSBsb2NhdGlvbiBhbmQgYm91bmQgdGV4dHVyZXNcbiAgICAgKlxuICAgICAqIEFjdHVhbCBgYmluZChudWxsLCBpKWAgY2FsbHMgd2lsbCBiZSBwZXJmb3JtZWQgYXQgbmV4dCBgdW5iaW5kKClgIGNhbGxcbiAgICAgKi9cbiAgICByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLl91bmtub3duQm91bmRUZXh0dXJlcyA9IHRydWU7XG4gICAgICAgIHRoaXMuY3VycmVudExvY2F0aW9uID0gLTE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvdW5kVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYm91bmRUZXh0dXJlc1tpXSA9IHRoaXMudW5rbm93blRleHR1cmU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVbmJpbmQgYSB0ZXh0dXJlXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSB0ZXh0dXJlIC0gVGV4dHVyZSB0byBiaW5kXG4gICAgICovXG4gICAgdW5iaW5kKHRleHR1cmU/OiBCYXNlVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wsIGJvdW5kVGV4dHVyZXMgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Vua25vd25Cb3VuZFRleHR1cmVzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl91bmtub3duQm91bmRUZXh0dXJlcyA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gc29tZW9uZSBjaGFuZ2VkIHdlYkdMIHN0YXRlLFxuICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBiZSBzdXJlIHRoYXQgb3VyIHRleHR1cmUgZG9lcyBub3QgYXBwZWFyIGluIG11bHRpLXRleHR1cmUgcmVuZGVyZXIgc2FtcGxlcnNcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm91bmRUZXh0dXJlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoYm91bmRUZXh0dXJlc1tpXSA9PT0gdGhpcy51bmtub3duVGV4dHVyZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZChudWxsLCBpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvdW5kVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChib3VuZFRleHR1cmVzW2ldID09PSB0ZXh0dXJlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2NhdGlvbiAhPT0gaSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGdsLmFjdGl2ZVRleHR1cmUoZ2wuVEVYVFVSRTAgKyBpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50TG9jYXRpb24gPSBpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdsLmJpbmRUZXh0dXJlKHRleHR1cmUudGFyZ2V0LCB0aGlzLmVtcHR5VGV4dHVyZXNbdGV4dHVyZS50YXJnZXRdLnRleHR1cmUpO1xuICAgICAgICAgICAgICAgIGJvdW5kVGV4dHVyZXNbaV0gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIHRleHR1cmVcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSB0ZXh0dXJlIC0gVGV4dHVyZSB0byBpbml0aWFsaXplXG4gICAgICovXG4gICAgaW5pdFRleHR1cmUodGV4dHVyZTogQmFzZVRleHR1cmUpOiBHTFRleHR1cmVcbiAgICB7XG4gICAgICAgIGNvbnN0IGdsVGV4dHVyZSA9IG5ldyBHTFRleHR1cmUodGhpcy5nbC5jcmVhdGVUZXh0dXJlKCkpO1xuXG4gICAgICAgIC8vIGd1YXJhbnRlZSBhbiB1cGRhdGUuLlxuICAgICAgICBnbFRleHR1cmUuZGlydHlJZCA9IC0xO1xuXG4gICAgICAgIHRleHR1cmUuX2dsVGV4dHVyZXNbdGhpcy5DT05URVhUX1VJRF0gPSBnbFRleHR1cmU7XG5cbiAgICAgICAgdGhpcy5tYW5hZ2VkVGV4dHVyZXMucHVzaCh0ZXh0dXJlKTtcbiAgICAgICAgdGV4dHVyZS5vbignZGlzcG9zZScsIHRoaXMuZGVzdHJveVRleHR1cmUsIHRoaXMpO1xuXG4gICAgICAgIHJldHVybiBnbFRleHR1cmU7XG4gICAgfVxuXG4gICAgaW5pdFRleHR1cmVUeXBlKHRleHR1cmU6IEJhc2VUZXh0dXJlLCBnbFRleHR1cmU6IEdMVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGdsVGV4dHVyZS5pbnRlcm5hbEZvcm1hdCA9IHRleHR1cmUuZm9ybWF0O1xuICAgICAgICBnbFRleHR1cmUudHlwZSA9IHRleHR1cmUudHlwZTtcbiAgICAgICAgaWYgKHRoaXMud2ViR0xWZXJzaW9uICE9PSAyKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZ2wgPSB0aGlzLnJlbmRlcmVyLmdsO1xuXG4gICAgICAgIGlmICh0ZXh0dXJlLnR5cGUgPT09IGdsLkZMT0FUXG4gICAgICAgICAgICAmJiB0ZXh0dXJlLmZvcm1hdCA9PT0gZ2wuUkdCQSlcbiAgICAgICAge1xuICAgICAgICAgICAgZ2xUZXh0dXJlLmludGVybmFsRm9ybWF0ID0gZ2wuUkdCQTMyRjtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGF0J3MgV2ViR0wxIEhBTEZfRkxPQVRfT0VTXG4gICAgICAgIC8vIHdlIGhhdmUgdG8gY29udmVydCBpdCB0byBXZWJHTCBIQUxGX0ZMT0FUXG4gICAgICAgIGlmICh0ZXh0dXJlLnR5cGUgPT09IFRZUEVTLkhBTEZfRkxPQVQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsVGV4dHVyZS50eXBlID0gZ2wuSEFMRl9GTE9BVDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2xUZXh0dXJlLnR5cGUgPT09IGdsLkhBTEZfRkxPQVRcbiAgICAgICAgICAgICYmIHRleHR1cmUuZm9ybWF0ID09PSBnbC5SR0JBKVxuICAgICAgICB7XG4gICAgICAgICAgICBnbFRleHR1cmUuaW50ZXJuYWxGb3JtYXQgPSBnbC5SR0JBMTZGO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGEgdGV4dHVyZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IHRleHR1cmUgLSBUZXh0dXJlIHRvIGluaXRpYWxpemVcbiAgICAgKi9cbiAgICB1cGRhdGVUZXh0dXJlKHRleHR1cmU6IEJhc2VUZXh0dXJlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZ2xUZXh0dXJlID0gdGV4dHVyZS5fZ2xUZXh0dXJlc1t0aGlzLkNPTlRFWFRfVUlEXTtcblxuICAgICAgICBpZiAoIWdsVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuXG4gICAgICAgIHRoaXMuaW5pdFRleHR1cmVUeXBlKHRleHR1cmUsIGdsVGV4dHVyZSk7XG5cbiAgICAgICAgaWYgKHRleHR1cmUucmVzb3VyY2UgJiYgdGV4dHVyZS5yZXNvdXJjZS51cGxvYWQocmVuZGVyZXIsIHRleHR1cmUsIGdsVGV4dHVyZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHRleHR1cmUgaXMgdXBsb2FkZWQsIGRvbnQgZG8gYW55dGhpbmchXG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBkZWZhdWx0LCByZW5kZXJUZXh0dXJlLWxpa2UgbG9naWNcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gdGV4dHVyZS5yZWFsV2lkdGg7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSB0ZXh0dXJlLnJlYWxIZWlnaHQ7XG4gICAgICAgICAgICBjb25zdCBnbCA9IHJlbmRlcmVyLmdsO1xuXG4gICAgICAgICAgICBpZiAoZ2xUZXh0dXJlLndpZHRoICE9PSB3aWR0aFxuICAgICAgICAgICAgICAgIHx8IGdsVGV4dHVyZS5oZWlnaHQgIT09IGhlaWdodFxuICAgICAgICAgICAgICAgIHx8IGdsVGV4dHVyZS5kaXJ0eUlkIDwgMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBnbFRleHR1cmUud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgICAgICBnbFRleHR1cmUuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgZ2wudGV4SW1hZ2UyRCh0ZXh0dXJlLnRhcmdldCwgMCxcbiAgICAgICAgICAgICAgICAgICAgZ2xUZXh0dXJlLmludGVybmFsRm9ybWF0LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLmZvcm1hdCxcbiAgICAgICAgICAgICAgICAgICAgZ2xUZXh0dXJlLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0cyBvbmx5IHVwZGF0ZSB3aGF0IGNoYW5nZXMuLlxuICAgICAgICBpZiAodGV4dHVyZS5kaXJ0eVN0eWxlSWQgIT09IGdsVGV4dHVyZS5kaXJ0eVN0eWxlSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGV4dHVyZVN0eWxlKHRleHR1cmUpO1xuICAgICAgICB9XG4gICAgICAgIGdsVGV4dHVyZS5kaXJ0eUlkID0gdGV4dHVyZS5kaXJ0eUlkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZXMgdGhlIHRleHR1cmUgZnJvbSBXZWJHTFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV8UElYSS5UZXh0dXJlfSB0ZXh0dXJlXyAtIHRoZSB0ZXh0dXJlIHRvIGRlc3Ryb3lcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwUmVtb3ZlPWZhbHNlXSAtIFdoZXRoZXIgdG8gc2tpcCByZW1vdmluZyB0aGUgdGV4dHVyZSBmcm9tIHRoZSBUZXh0dXJlTWFuYWdlci5cbiAgICAgKi9cbiAgICBkZXN0cm95VGV4dHVyZSh0ZXh0dXJlOiBCYXNlVGV4dHVyZXxUZXh0dXJlLCBza2lwUmVtb3ZlPzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgZ2wgfSA9IHRoaXM7XG5cbiAgICAgICAgdGV4dHVyZSA9IHRleHR1cmUuY2FzdFRvQmFzZVRleHR1cmUoKTtcblxuICAgICAgICBpZiAodGV4dHVyZS5fZ2xUZXh0dXJlc1t0aGlzLkNPTlRFWFRfVUlEXSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51bmJpbmQodGV4dHVyZSk7XG5cbiAgICAgICAgICAgIGdsLmRlbGV0ZVRleHR1cmUodGV4dHVyZS5fZ2xUZXh0dXJlc1t0aGlzLkNPTlRFWFRfVUlEXS50ZXh0dXJlKTtcbiAgICAgICAgICAgIHRleHR1cmUub2ZmKCdkaXNwb3NlJywgdGhpcy5kZXN0cm95VGV4dHVyZSwgdGhpcyk7XG5cbiAgICAgICAgICAgIGRlbGV0ZSB0ZXh0dXJlLl9nbFRleHR1cmVzW3RoaXMuQ09OVEVYVF9VSURdO1xuXG4gICAgICAgICAgICBpZiAoIXNraXBSZW1vdmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMubWFuYWdlZFRleHR1cmVzLmluZGV4T2YodGV4dHVyZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaSAhPT0gLTEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVJdGVtcyh0aGlzLm1hbmFnZWRUZXh0dXJlcywgaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRleHR1cmUgc3R5bGUgc3VjaCBhcyBtaXBtYXAgZmxhZ1xuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmFzZVRleHR1cmV9IHRleHR1cmUgLSBUZXh0dXJlIHRvIHVwZGF0ZVxuICAgICAqL1xuICAgIHVwZGF0ZVRleHR1cmVTdHlsZSh0ZXh0dXJlOiBCYXNlVGV4dHVyZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGdsVGV4dHVyZSA9IHRleHR1cmUuX2dsVGV4dHVyZXNbdGhpcy5DT05URVhUX1VJRF07XG5cbiAgICAgICAgaWYgKCFnbFRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgodGV4dHVyZS5taXBtYXAgPT09IE1JUE1BUF9NT0RFUy5QT1cyIHx8IHRoaXMud2ViR0xWZXJzaW9uICE9PSAyKSAmJiAhdGV4dHVyZS5pc1Bvd2VyT2ZUd28pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsVGV4dHVyZS5taXBtYXAgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsVGV4dHVyZS5taXBtYXAgPSB0ZXh0dXJlLm1pcG1hcCA+PSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMud2ViR0xWZXJzaW9uICE9PSAyICYmICF0ZXh0dXJlLmlzUG93ZXJPZlR3bylcbiAgICAgICAge1xuICAgICAgICAgICAgZ2xUZXh0dXJlLndyYXBNb2RlID0gV1JBUF9NT0RFUy5DTEFNUDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsVGV4dHVyZS53cmFwTW9kZSA9IHRleHR1cmUud3JhcE1vZGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGV4dHVyZS5yZXNvdXJjZSAmJiB0ZXh0dXJlLnJlc291cmNlLnN0eWxlKHRoaXMucmVuZGVyZXIsIHRleHR1cmUsIGdsVGV4dHVyZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHN0eWxlIGlzIHNldCwgZG9udCBkbyBhbnl0aGluZyFcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3R5bGUodGV4dHVyZSwgZ2xUZXh0dXJlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdsVGV4dHVyZS5kaXJ0eVN0eWxlSWQgPSB0ZXh0dXJlLmRpcnR5U3R5bGVJZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgc3R5bGUgZm9yIHRleHR1cmVcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtQSVhJLkJhc2VUZXh0dXJlfSB0ZXh0dXJlIC0gVGV4dHVyZSB0byB1cGRhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuR0xUZXh0dXJlfSBnbFRleHR1cmVcbiAgICAgKi9cbiAgICBzZXRTdHlsZSh0ZXh0dXJlOiBCYXNlVGV4dHVyZSwgZ2xUZXh0dXJlOiBHTFRleHR1cmUpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuZ2w7XG5cbiAgICAgICAgaWYgKGdsVGV4dHVyZS5taXBtYXApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLmdlbmVyYXRlTWlwbWFwKHRleHR1cmUudGFyZ2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdsLnRleFBhcmFtZXRlcmkodGV4dHVyZS50YXJnZXQsIGdsLlRFWFRVUkVfV1JBUF9TLCBnbFRleHR1cmUud3JhcE1vZGUpO1xuICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKHRleHR1cmUudGFyZ2V0LCBnbC5URVhUVVJFX1dSQVBfVCwgZ2xUZXh0dXJlLndyYXBNb2RlKTtcblxuICAgICAgICBpZiAoZ2xUZXh0dXJlLm1pcG1hcClcbiAgICAgICAge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaSh0ZXh0dXJlLnRhcmdldCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCB0ZXh0dXJlLnNjYWxlTW9kZSA9PT0gU0NBTEVfTU9ERVMuTElORUFSID8gZ2wuTElORUFSX01JUE1BUF9MSU5FQVIgOiBnbC5ORUFSRVNUX01JUE1BUF9ORUFSRVNUKTtcbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuICAgICAgICAgICAgY29uc3QgYW5pc290cm9waWNFeHQgPSB0aGlzLnJlbmRlcmVyLmNvbnRleHQuZXh0ZW5zaW9ucy5hbmlzb3Ryb3BpY0ZpbHRlcmluZztcblxuICAgICAgICAgICAgaWYgKGFuaXNvdHJvcGljRXh0ICYmIHRleHR1cmUuYW5pc290cm9waWNMZXZlbCA+IDAgJiYgdGV4dHVyZS5zY2FsZU1vZGUgPT09IFNDQUxFX01PREVTLkxJTkVBUilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IE1hdGgubWluKHRleHR1cmUuYW5pc290cm9waWNMZXZlbCwgZ2wuZ2V0UGFyYW1ldGVyKGFuaXNvdHJvcGljRXh0Lk1BWF9URVhUVVJFX01BWF9BTklTT1RST1BZX0VYVCkpO1xuXG4gICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyZih0ZXh0dXJlLnRhcmdldCwgYW5pc290cm9waWNFeHQuVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQsIGxldmVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkodGV4dHVyZS50YXJnZXQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgdGV4dHVyZS5zY2FsZU1vZGUgPT09IFNDQUxFX01PREVTLkxJTkVBUiA/IGdsLkxJTkVBUiA6IGdsLk5FQVJFU1QpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2wudGV4UGFyYW1ldGVyaSh0ZXh0dXJlLnRhcmdldCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCB0ZXh0dXJlLnNjYWxlTW9kZSA9PT0gU0NBTEVfTU9ERVMuTElORUFSID8gZ2wuTElORUFSIDogZ2wuTkVBUkVTVCk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU3lzdGVtcyBhcmUgaW5kaXZpZHVhbCBjb21wb25lbnRzIHRvIHRoZSBSZW5kZXJlciBwaXBlbGluZS5cbiAqIEBuYW1lc3BhY2UgUElYSS5zeXN0ZW1zXG4gKi9cbmV4cG9ydCAqIGZyb20gJy4vZmlsdGVycy9GaWx0ZXJTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9iYXRjaC9CYXRjaFN5c3RlbSc7XG5leHBvcnQgKiBmcm9tICcuL2NvbnRleHQvQ29udGV4dFN5c3RlbSc7XG5leHBvcnQgKiBmcm9tICcuL2ZyYW1lYnVmZmVyL0ZyYW1lYnVmZmVyU3lzdGVtJztcbmV4cG9ydCAqIGZyb20gJy4vZ2VvbWV0cnkvR2VvbWV0cnlTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9tYXNrL01hc2tTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9tYXNrL1NjaXNzb3JTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9tYXNrL1N0ZW5jaWxTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9wcm9qZWN0aW9uL1Byb2plY3Rpb25TeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9yZW5kZXJUZXh0dXJlL1JlbmRlclRleHR1cmVTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi9zaGFkZXIvU2hhZGVyU3lzdGVtJztcbmV4cG9ydCAqIGZyb20gJy4vc3RhdGUvU3RhdGVTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi90ZXh0dXJlcy9UZXh0dXJlR0NTeXN0ZW0nO1xuZXhwb3J0ICogZnJvbSAnLi90ZXh0dXJlcy9UZXh0dXJlU3lzdGVtJztcbiIsICJpbXBvcnQgeyBoZXgyc3RyaW5nLCBoZXgycmdiLCBkZXByZWNhdGlvbiwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgTWF0cml4LCBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IFJFTkRFUkVSX1RZUEUgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5pbXBvcnQgeyBEaXNwbGF5T2JqZWN0IH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBSZW5kZXJUZXh0dXJlIH0gZnJvbSAnLi9yZW5kZXJUZXh0dXJlL1JlbmRlclRleHR1cmUnO1xuXG5pbXBvcnQgdHlwZSB7IFNDQUxFX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB0eXBlIHsgSVJlbmRlcmluZ0NvbnRleHQgfSBmcm9tICcuL0lSZW5kZXJpbmdDb250ZXh0JztcbmltcG9ydCB0eXBlIHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5cbmNvbnN0IHRlbXBNYXRyaXggPSBuZXcgTWF0cml4KCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlbmRlcmVyT3B0aW9ucyBleHRlbmRzIEdsb2JhbE1peGlucy5JUmVuZGVyZXJPcHRpb25zXG57XG4gICAgd2lkdGg/OiBudW1iZXI7XG4gICAgaGVpZ2h0PzogbnVtYmVyO1xuICAgIHZpZXc/OiBIVE1MQ2FudmFzRWxlbWVudDtcbiAgICB0cmFuc3BhcmVudD86IGJvb2xlYW4gfCAnbm90TXVsdGlwbGllZCc7XG4gICAgYXV0b0RlbnNpdHk/OiBib29sZWFuO1xuICAgIGFudGlhbGlhcz86IGJvb2xlYW47XG4gICAgcmVzb2x1dGlvbj86IG51bWJlcjtcbiAgICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI/OiBib29sZWFuO1xuICAgIGNsZWFyQmVmb3JlUmVuZGVyPzogYm9vbGVhbjtcbiAgICBiYWNrZ3JvdW5kQ29sb3I/OiBudW1iZXI7XG4gICAgcG93ZXJQcmVmZXJlbmNlPzogV2ViR0xQb3dlclByZWZlcmVuY2U7XG4gICAgY29udGV4dD86IElSZW5kZXJpbmdDb250ZXh0O1xufVxuXG5pbnRlcmZhY2UgSVJlbmRlcmVyT3B0aW9uc0xlZ2FjeSBleHRlbmRzIElSZW5kZXJlck9wdGlvbnNcbntcbiAgICBhdXRvUmVzaXplPzogYm9vbGVhbjtcbiAgICByb3VuZFBpeGVscz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlbmRlcmVyUGx1Z2luc1xue1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuLyoqXG4gKiBUaGUgQWJzdHJhY3RSZW5kZXJlciBpcyB0aGUgYmFzZSBmb3IgYSBQaXhpSlMgUmVuZGVyZXIuIEl0IGlzIGV4dGVuZGVkIGJ5IHRoZSB7QGxpbmsgUElYSS5DYW52YXNSZW5kZXJlcn1cbiAqIGFuZCB7QGxpbmsgUElYSS5SZW5kZXJlcn0gd2hpY2ggY2FuIGJlIHVzZWQgZm9yIHJlbmRlcmluZyBhIFBpeGlKUyBzY2VuZS5cbiAqXG4gKiBAYWJzdHJhY3RcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS51dGlscy5FdmVudEVtaXR0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFJlbmRlcmVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyXG57XG4gICAgcHVibGljIHJlc29sdXRpb246IG51bWJlcjtcbiAgICBwdWJsaWMgY2xlYXJCZWZvcmVSZW5kZXI/OiBib29sZWFuO1xuICAgIHB1YmxpYyByZWFkb25seSBvcHRpb25zOiBJUmVuZGVyZXJPcHRpb25zO1xuICAgIHB1YmxpYyByZWFkb25seSB0eXBlOiBSRU5ERVJFUl9UWVBFO1xuICAgIHB1YmxpYyByZWFkb25seSBzY3JlZW46IFJlY3RhbmdsZTtcbiAgICBwdWJsaWMgcmVhZG9ubHkgdmlldzogSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgcHVibGljIHJlYWRvbmx5IHBsdWdpbnM6IElSZW5kZXJlclBsdWdpbnM7XG4gICAgcHVibGljIHJlYWRvbmx5IHRyYW5zcGFyZW50OiBib29sZWFuIHwgJ25vdE11bHRpcGxpZWQnO1xuICAgIHB1YmxpYyByZWFkb25seSBhdXRvRGVuc2l0eTogYm9vbGVhbjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBib29sZWFuO1xuXG4gICAgcHJvdGVjdGVkIF9iYWNrZ3JvdW5kQ29sb3I6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2JhY2tncm91bmRDb2xvclN0cmluZzogc3RyaW5nO1xuICAgIF9iYWNrZ3JvdW5kQ29sb3JSZ2JhOiBudW1iZXJbXTtcbiAgICBfbGFzdE9iamVjdFJlbmRlcmVkOiBEaXNwbGF5T2JqZWN0O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN5c3RlbSAtIFRoZSBuYW1lIG9mIHRoZSBzeXN0ZW0gdGhpcyByZW5kZXJlciBpcyBmb3IuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25hbCByZW5kZXJlciBwYXJhbWV0ZXJzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aD04MDBdIC0gVGhlIHdpZHRoIG9mIHRoZSBzY3JlZW4uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmhlaWdodD02MDBdIC0gVGhlIGhlaWdodCBvZiB0aGUgc2NyZWVuLlxuICAgICAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IFtvcHRpb25zLnZpZXddIC0gVGhlIGNhbnZhcyB0byB1c2UgYXMgYSB2aWV3LCBvcHRpb25hbC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnRyYW5zcGFyZW50PWZhbHNlXSAtIElmIHRoZSByZW5kZXIgdmlldyBpcyB0cmFuc3BhcmVudC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9EZW5zaXR5PWZhbHNlXSAtIFJlc2l6ZXMgcmVuZGVyZXIgdmlldyBpbiBDU1MgcGl4ZWxzIHRvIGFsbG93IGZvclxuICAgICAqICAgcmVzb2x1dGlvbnMgb3RoZXIgdGhhbiAxLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYW50aWFsaWFzPWZhbHNlXSAtIFNldHMgYW50aWFsaWFzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnJlc29sdXRpb249MV0gLSBUaGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiB0aGUgcmVuZGVyZXIuIFRoZVxuICAgICAqICByZXNvbHV0aW9uIG9mIHRoZSByZW5kZXJlciByZXRpbmEgd291bGQgYmUgMi5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlcj1mYWxzZV0gLSBFbmFibGVzIGRyYXdpbmcgYnVmZmVyIHByZXNlcnZhdGlvbixcbiAgICAgKiAgZW5hYmxlIHRoaXMgaWYgeW91IG5lZWQgdG8gY2FsbCB0b0RhdGFVcmwgb24gdGhlIFdlYkdMIGNvbnRleHQuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jbGVhckJlZm9yZVJlbmRlcj10cnVlXSAtIFRoaXMgc2V0cyBpZiB0aGUgcmVuZGVyZXIgd2lsbCBjbGVhciB0aGUgY2FudmFzIG9yXG4gICAgICogICAgICBub3QgYmVmb3JlIHRoZSBuZXcgcmVuZGVyIHBhc3MuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmJhY2tncm91bmRDb2xvcj0weDAwMDAwMF0gLSBUaGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgcmVuZGVyZWQgYXJlYVxuICAgICAqICAoc2hvd24gaWYgbm90IHRyYW5zcGFyZW50KS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0eXBlOiBSRU5ERVJFUl9UWVBFID0gUkVOREVSRVJfVFlQRS5VTktOT1dOLCBvcHRpb25zPzogSVJlbmRlcmVyT3B0aW9ucylcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgLy8gQWRkIHRoZSBkZWZhdWx0IHJlbmRlciBvcHRpb25zXG4gICAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBzZXR0aW5ncy5SRU5ERVJfT1BUSU9OUywgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gRGVwcmVjYXRpb24gbm90aWNlIGZvciByZW5kZXJlciByb3VuZFBpeGVscyBvcHRpb25cbiAgICAgICAgaWYgKChvcHRpb25zIGFzIElSZW5kZXJlck9wdGlvbnNMZWdhY3kpLnJvdW5kUGl4ZWxzKVxuICAgICAgICB7XG4gICAgICAgICAgICBzZXR0aW5ncy5ST1VORF9QSVhFTFMgPSAob3B0aW9ucyBhcyBJUmVuZGVyZXJPcHRpb25zTGVnYWN5KS5yb3VuZFBpeGVscztcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjAuMCcsICdSZW5kZXJlciByb3VuZFBpeGVscyBvcHRpb24gaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSBQSVhJLnNldHRpbmdzLlJPVU5EX1BJWEVMUycsIDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzdXBwbGllZCBjb25zdHJ1Y3RvciBvcHRpb25zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9XG4gICAgICAgICAqIEByZWFkT25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHR5cGUgb2YgdGhlIHJlbmRlcmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuUkVOREVSRVJfVFlQRS5VTktOT1dOXG4gICAgICAgICAqIEBzZWUgUElYSS5SRU5ERVJFUl9UWVBFXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNZWFzdXJlbWVudHMgb2YgdGhlIHNjcmVlbi4gKDAsIDAsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBJdHMgc2FmZSB0byB1c2UgYXMgZmlsdGVyQXJlYSBvciBoaXRBcmVhIGZvciB0aGUgd2hvbGUgc3RhZ2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zY3JlZW4gPSBuZXcgUmVjdGFuZ2xlKDAsIDAsIG9wdGlvbnMud2lkdGgsIG9wdGlvbnMuaGVpZ2h0KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNhbnZhcyBlbGVtZW50IHRoYXQgZXZlcnl0aGluZyBpcyBkcmF3biB0by5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7SFRNTENhbnZhc0VsZW1lbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZpZXcgPSBvcHRpb25zLnZpZXcgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIHRoZSByZW5kZXJlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlc29sdXRpb24gPSBvcHRpb25zLnJlc29sdXRpb24gfHwgc2V0dGluZ3MuUkVTT0xVVElPTjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGUgcmVuZGVyIHZpZXcgaXMgdHJhbnNwYXJlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRyYW5zcGFyZW50ID0gb3B0aW9ucy50cmFuc3BhcmVudDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBDU1MgZGltZW5zaW9ucyBvZiBjYW52YXMgdmlldyBzaG91bGQgYmUgcmVzaXplZCB0byBzY3JlZW4gZGltZW5zaW9ucyBhdXRvbWF0aWNhbGx5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hdXRvRGVuc2l0eSA9IG9wdGlvbnMuYXV0b0RlbnNpdHkgfHwgKG9wdGlvbnMgYXMgSVJlbmRlcmVyT3B0aW9uc0xlZ2FjeSkuYXV0b1Jlc2l6ZSB8fCBmYWxzZTtcbiAgICAgICAgLy8gYXV0b1Jlc2l6ZSBpcyBkZXByZWNhdGVkLCBwcm92aWRlcyBmYWxsYmFjayBzdXBwb3J0XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB2YWx1ZSBvZiB0aGUgcHJlc2VydmVEcmF3aW5nQnVmZmVyIGZsYWcgYWZmZWN0cyB3aGV0aGVyIG9yIG5vdCB0aGUgY29udGVudHMgb2ZcbiAgICAgICAgICogdGhlIHN0ZW5jaWwgYnVmZmVyIGlzIHJldGFpbmVkIGFmdGVyIHJlbmRlcmluZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJlc2VydmVEcmF3aW5nQnVmZmVyID0gb3B0aW9ucy5wcmVzZXJ2ZURyYXdpbmdCdWZmZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgc2V0cyBpZiB0aGUgQ2FudmFzUmVuZGVyZXIgd2lsbCBjbGVhciB0aGUgY2FudmFzIG9yIG5vdCBiZWZvcmUgdGhlIG5ldyByZW5kZXIgcGFzcy5cbiAgICAgICAgICogSWYgdGhlIHNjZW5lIGlzIE5PVCB0cmFuc3BhcmVudCBQaXhpSlMgd2lsbCB1c2UgYSBjYW52YXMgc2l6ZWQgZmlsbFJlY3Qgb3BlcmF0aW9uIGV2ZXJ5XG4gICAgICAgICAqIGZyYW1lIHRvIHNldCB0aGUgY2FudmFzIGJhY2tncm91bmQgY29sb3IuIElmIHRoZSBzY2VuZSBpcyB0cmFuc3BhcmVudCBQaXhpSlMgd2lsbCB1c2UgY2xlYXJSZWN0XG4gICAgICAgICAqIHRvIGNsZWFyIHRoZSBjYW52YXMgZXZlcnkgZnJhbWUuIERpc2FibGUgdGhpcyBieSBzZXR0aW5nIHRoaXMgdG8gZmFsc2UuIEZvciBleGFtcGxlLCBpZlxuICAgICAgICAgKiB5b3VyIGdhbWUgaGFzIGEgY2FudmFzIGZpbGxpbmcgYmFja2dyb3VuZCBpbWFnZSB5b3Ugb2Z0ZW4gZG9uJ3QgbmVlZCB0aGlzIHNldC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2xlYXJCZWZvcmVSZW5kZXIgPSBvcHRpb25zLmNsZWFyQmVmb3JlUmVuZGVyO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYmFja2dyb3VuZCBjb2xvciBhcyBhIG51bWJlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9iYWNrZ3JvdW5kQ29sb3IgPSAweDAwMDAwMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGJhY2tncm91bmQgY29sb3IgYXMgYW4gW1IsIEcsIEJdIGFycmF5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmFja2dyb3VuZENvbG9yUmdiYSA9IFswLCAwLCAwLCAwXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGJhY2tncm91bmQgY29sb3IgYXMgYSBzdHJpbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmFja2dyb3VuZENvbG9yU3RyaW5nID0gJyMwMDAwMDAnO1xuXG4gICAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3IgfHwgdGhpcy5fYmFja2dyb3VuZENvbG9yOyAvLyBydW4gYmcgY29sb3Igc2V0dGVyXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsYXN0IHJvb3Qgb2JqZWN0IHRoYXQgdGhlIHJlbmRlcmVyIHRyaWVkIHRvIHJlbmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5EaXNwbGF5T2JqZWN0fVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9sYXN0T2JqZWN0UmVuZGVyZWQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb2xsZWN0aW9uIG9mIHBsdWdpbnMuXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBsdWdpbnMgPSB7fTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIHRoZSBwbHVnaW5zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzdGF0aWNNYXAgLSBUaGUgZGljdGlvbmFyeSBvZiBzdGF0aWNhbGx5IHNhdmVkIHBsdWdpbnMuXG4gICAgICovXG4gICAgaW5pdFBsdWdpbnMoc3RhdGljTWFwOiBJUmVuZGVyZXJQbHVnaW5zKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChjb25zdCBvIGluIHN0YXRpY01hcClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW5zW29dID0gbmV3IChzdGF0aWNNYXBbb10pKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FtZSBhcyB2aWV3LndpZHRoLCBhY3R1YWwgbnVtYmVyIG9mIHBpeGVscyBpbiB0aGUgY2FudmFzIGJ5IGhvcml6b250YWwuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQGRlZmF1bHQgODAwXG4gICAgICovXG4gICAgZ2V0IHdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlldy53aWR0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYW1lIGFzIHZpZXcuaGVpZ2h0LCBhY3R1YWwgbnVtYmVyIG9mIHBpeGVscyBpbiB0aGUgY2FudmFzIGJ5IHZlcnRpY2FsLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBkZWZhdWx0IDYwMFxuICAgICAqL1xuICAgIGdldCBoZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3LmhlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNpemVzIHRoZSBzY3JlZW4gYW5kIGNhbnZhcyB0byB0aGUgc3BlY2lmaWVkIHdpZHRoIGFuZCBoZWlnaHQuXG4gICAgICogQ2FudmFzIGRpbWVuc2lvbnMgYXJlIG11bHRpcGxpZWQgYnkgcmVzb2x1dGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY3JlZW5XaWR0aCAtIFRoZSBuZXcgd2lkdGggb2YgdGhlIHNjcmVlbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2NyZWVuSGVpZ2h0IC0gVGhlIG5ldyBoZWlnaHQgb2YgdGhlIHNjcmVlbi5cbiAgICAgKi9cbiAgICByZXNpemUoc2NyZWVuV2lkdGg6IG51bWJlciwgc2NyZWVuSGVpZ2h0OiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnNjcmVlbi53aWR0aCA9IHNjcmVlbldpZHRoO1xuICAgICAgICB0aGlzLnNjcmVlbi5oZWlnaHQgPSBzY3JlZW5IZWlnaHQ7XG5cbiAgICAgICAgdGhpcy52aWV3LndpZHRoID0gc2NyZWVuV2lkdGggKiB0aGlzLnJlc29sdXRpb247XG4gICAgICAgIHRoaXMudmlldy5oZWlnaHQgPSBzY3JlZW5IZWlnaHQgKiB0aGlzLnJlc29sdXRpb247XG5cbiAgICAgICAgaWYgKHRoaXMuYXV0b0RlbnNpdHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5zdHlsZS53aWR0aCA9IGAke3NjcmVlbldpZHRofXB4YDtcbiAgICAgICAgICAgIHRoaXMudmlldy5zdHlsZS5oZWlnaHQgPSBgJHtzY3JlZW5IZWlnaHR9cHhgO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIGFmdGVyIHZpZXcgaGFzIGJlZW4gcmVzaXplZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV2ZW50IFBJWEkuUmVuZGVyZXIjcmVzaXplXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY3JlZW5XaWR0aCAtIFRoZSBuZXcgd2lkdGggb2YgdGhlIHNjcmVlbi5cbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNjcmVlbkhlaWdodCAtIFRoZSBuZXcgaGVpZ2h0IG9mIHRoZSBzY3JlZW4uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVtaXQoJ3Jlc2l6ZScsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWZ1bCBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSB0ZXh0dXJlIG9mIHRoZSBkaXNwbGF5IG9iamVjdCB0aGF0IGNhbiB0aGVuIGJlIHVzZWQgdG8gY3JlYXRlIHNwcml0ZXNcbiAgICAgKiBUaGlzIGNhbiBiZSBxdWl0ZSB1c2VmdWwgaWYgeW91ciBkaXNwbGF5T2JqZWN0IGlzIGNvbXBsaWNhdGVkIGFuZCBuZWVkcyB0byBiZSByZXVzZWQgbXVsdGlwbGUgdGltZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gZGlzcGxheU9iamVjdCAtIFRoZSBkaXNwbGF5T2JqZWN0IHRoZSBvYmplY3Qgd2lsbCBiZSBnZW5lcmF0ZWQgZnJvbS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuU0NBTEVfTU9ERVN9IHNjYWxlTW9kZSAtIFRoZSBzY2FsZSBtb2RlIG9mIHRoZSB0ZXh0dXJlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByZXNvbHV0aW9uIC0gVGhlIHJlc29sdXRpb24gLyBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgdGhlIHRleHR1cmUgYmVpbmcgZ2VuZXJhdGVkLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtyZWdpb25dIC0gVGhlIHJlZ2lvbiBvZiB0aGUgZGlzcGxheU9iamVjdCwgdGhhdCBzaGFsbCBiZSByZW5kZXJlZCxcbiAgICAgKiAgICAgICAgaWYgbm8gcmVnaW9uIGlzIHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdGhlIGxvY2FsIGJvdW5kcyBvZiB0aGUgZGlzcGxheU9iamVjdC5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlbmRlclRleHR1cmV9IEEgdGV4dHVyZSBvZiB0aGUgZ3JhcGhpY3Mgb2JqZWN0LlxuICAgICAqL1xuICAgIGdlbmVyYXRlVGV4dHVyZShkaXNwbGF5T2JqZWN0OiBEaXNwbGF5T2JqZWN0LFxuICAgICAgICBzY2FsZU1vZGU/OiBTQ0FMRV9NT0RFUywgcmVzb2x1dGlvbj86IG51bWJlciwgcmVnaW9uPzogUmVjdGFuZ2xlKTogUmVuZGVyVGV4dHVyZVxuICAgIHtcbiAgICAgICAgcmVnaW9uID0gcmVnaW9uIHx8IChkaXNwbGF5T2JqZWN0IGFzIENvbnRhaW5lcikuZ2V0TG9jYWxCb3VuZHMobnVsbCwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gbWluaW11bSB0ZXh0dXJlIHNpemUgaXMgMXgxLCAweDAgd2lsbCB0aHJvdyBhbiBlcnJvclxuICAgICAgICBpZiAocmVnaW9uLndpZHRoID09PSAwKSByZWdpb24ud2lkdGggPSAxO1xuICAgICAgICBpZiAocmVnaW9uLmhlaWdodCA9PT0gMCkgcmVnaW9uLmhlaWdodCA9IDE7XG5cbiAgICAgICAgY29uc3QgcmVuZGVyVGV4dHVyZSA9IFJlbmRlclRleHR1cmUuY3JlYXRlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHdpZHRoOiByZWdpb24ud2lkdGggfCAwLFxuICAgICAgICAgICAgICAgIGhlaWdodDogcmVnaW9uLmhlaWdodCB8IDAsXG4gICAgICAgICAgICAgICAgc2NhbGVNb2RlLFxuICAgICAgICAgICAgICAgIHJlc29sdXRpb24sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0ZW1wTWF0cml4LnR4ID0gLXJlZ2lvbi54O1xuICAgICAgICB0ZW1wTWF0cml4LnR5ID0gLXJlZ2lvbi55O1xuXG4gICAgICAgIHRoaXMucmVuZGVyKGRpc3BsYXlPYmplY3QsIHJlbmRlclRleHR1cmUsIGZhbHNlLCB0ZW1wTWF0cml4LCAhIWRpc3BsYXlPYmplY3QucGFyZW50KTtcblxuICAgICAgICByZXR1cm4gcmVuZGVyVGV4dHVyZTtcbiAgICB9XG5cbiAgICBhYnN0cmFjdCByZW5kZXIoZGlzcGxheU9iamVjdDogRGlzcGxheU9iamVjdCwgcmVuZGVyVGV4dHVyZT86IFJlbmRlclRleHR1cmUsXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyPzogYm9vbGVhbiwgdHJhbnNmb3JtPzogTWF0cml4LCBza2lwVXBkYXRlVHJhbnNmb3JtPzogYm9vbGVhbik6IHZvaWQ7XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGV2ZXJ5dGhpbmcgZnJvbSB0aGUgcmVuZGVyZXIgYW5kIG9wdGlvbmFsbHkgcmVtb3ZlcyB0aGUgQ2FudmFzIERPTSBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbcmVtb3ZlVmlldz1mYWxzZV0gLSBSZW1vdmVzIHRoZSBDYW52YXMgZWxlbWVudCBmcm9tIHRoZSBET00uXG4gICAgICovXG4gICAgZGVzdHJveShyZW1vdmVWaWV3PzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGZvciAoY29uc3QgbyBpbiB0aGlzLnBsdWdpbnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luc1tvXS5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbnNbb10gPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlbW92ZVZpZXcgJiYgdGhpcy52aWV3LnBhcmVudE5vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMudmlldyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0aGlzQW55ID0gdGhpcyBhcyBhbnk7XG5cbiAgICAgICAgLy8gbnVsbC1pbmcgYWxsIG9iamVjdHMsIHRoYXQncyBhIHRyYWRpdGlvbiFcblxuICAgICAgICB0aGlzQW55LnBsdWdpbnMgPSBudWxsO1xuICAgICAgICB0aGlzQW55LnR5cGUgPSBSRU5ERVJFUl9UWVBFLlVOS05PV047XG4gICAgICAgIHRoaXNBbnkudmlldyA9IG51bGw7XG4gICAgICAgIHRoaXNBbnkuc2NyZWVuID0gbnVsbDtcbiAgICAgICAgdGhpc0FueS5fdGVtcERpc3BsYXlPYmplY3RQYXJlbnQgPSBudWxsO1xuICAgICAgICB0aGlzQW55Lm9wdGlvbnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9iYWNrZ3JvdW5kQ29sb3JSZ2JhID0gbnVsbDtcbiAgICAgICAgdGhpcy5fYmFja2dyb3VuZENvbG9yU3RyaW5nID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbGFzdE9iamVjdFJlbmRlcmVkID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFja2dyb3VuZCBjb2xvciB0byBmaWxsIGlmIG5vdCB0cmFuc3BhcmVudFxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBiYWNrZ3JvdW5kQ29sb3IoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYmFja2dyb3VuZENvbG9yO1xuICAgIH1cblxuICAgIHNldCBiYWNrZ3JvdW5kQ29sb3IodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX2JhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9iYWNrZ3JvdW5kQ29sb3JTdHJpbmcgPSBoZXgyc3RyaW5nKHZhbHVlKTtcbiAgICAgICAgaGV4MnJnYih2YWx1ZSwgdGhpcy5fYmFja2dyb3VuZENvbG9yUmdiYSk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgc2F5SGVsbG8sIGlzV2ViR0xTdXBwb3J0ZWQgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgeyBNYXNrU3lzdGVtIH0gZnJvbSAnLi9tYXNrL01hc2tTeXN0ZW0nO1xuaW1wb3J0IHsgU3RlbmNpbFN5c3RlbSB9IGZyb20gJy4vbWFzay9TdGVuY2lsU3lzdGVtJztcbmltcG9ydCB7IFNjaXNzb3JTeXN0ZW0gfSBmcm9tICcuL21hc2svU2Npc3NvclN5c3RlbSc7XG5pbXBvcnQgeyBGaWx0ZXJTeXN0ZW0gfSBmcm9tICcuL2ZpbHRlcnMvRmlsdGVyU3lzdGVtJztcbmltcG9ydCB7IEZyYW1lYnVmZmVyU3lzdGVtIH0gZnJvbSAnLi9mcmFtZWJ1ZmZlci9GcmFtZWJ1ZmZlclN5c3RlbSc7XG5pbXBvcnQgeyBSZW5kZXJUZXh0dXJlU3lzdGVtIH0gZnJvbSAnLi9yZW5kZXJUZXh0dXJlL1JlbmRlclRleHR1cmVTeXN0ZW0nO1xuaW1wb3J0IHsgVGV4dHVyZVN5c3RlbSB9IGZyb20gJy4vdGV4dHVyZXMvVGV4dHVyZVN5c3RlbSc7XG5pbXBvcnQgeyBQcm9qZWN0aW9uU3lzdGVtIH0gZnJvbSAnLi9wcm9qZWN0aW9uL1Byb2plY3Rpb25TeXN0ZW0nO1xuaW1wb3J0IHsgU3RhdGVTeXN0ZW0gfSBmcm9tICcuL3N0YXRlL1N0YXRlU3lzdGVtJztcbmltcG9ydCB7IEdlb21ldHJ5U3lzdGVtIH0gZnJvbSAnLi9nZW9tZXRyeS9HZW9tZXRyeVN5c3RlbSc7XG5pbXBvcnQgeyBTaGFkZXJTeXN0ZW0gfSBmcm9tICcuL3NoYWRlci9TaGFkZXJTeXN0ZW0nO1xuaW1wb3J0IHsgQ29udGV4dFN5c3RlbSB9IGZyb20gJy4vY29udGV4dC9Db250ZXh0U3lzdGVtJztcbmltcG9ydCB7IEJhdGNoU3lzdGVtIH0gZnJvbSAnLi9iYXRjaC9CYXRjaFN5c3RlbSc7XG5pbXBvcnQgeyBUZXh0dXJlR0NTeXN0ZW0gfSBmcm9tICcuL3RleHR1cmVzL1RleHR1cmVHQ1N5c3RlbSc7XG5pbXBvcnQgeyBSRU5ERVJFUl9UWVBFIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IFVuaWZvcm1Hcm91cCB9IGZyb20gJy4vc2hhZGVyL1VuaWZvcm1Hcm91cCc7XG5pbXBvcnQgeyBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IFJ1bm5lciB9IGZyb20gJ0BwaXhpL3J1bm5lcic7XG5cbmltcG9ydCB0eXBlIHsgSVJlbmRlcmVyT3B0aW9ucywgSVJlbmRlcmVyUGx1Z2lucyB9IGZyb20gJy4vQWJzdHJhY3RSZW5kZXJlcic7XG5pbXBvcnQgdHlwZSB7IFJlbmRlclRleHR1cmUgfSBmcm9tICcuL3JlbmRlclRleHR1cmUvUmVuZGVyVGV4dHVyZSc7XG5pbXBvcnQgdHlwZSB7IERpc3BsYXlPYmplY3QgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB0eXBlIHsgU3lzdGVtIH0gZnJvbSAnLi9TeXN0ZW0nO1xuaW1wb3J0IHR5cGUgeyBJUmVuZGVyaW5nQ29udGV4dCB9IGZyb20gJy4vSVJlbmRlcmluZ0NvbnRleHQnO1xuaW1wb3J0IHR5cGUgeyBFeHRyYWN0IH0gZnJvbSAnQHBpeGkvZXh0cmFjdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlbmRlcmVyUGx1Z2luQ29uc3RydWN0b3Ige1xuICAgIG5ldyAocmVuZGVyZXI6IFJlbmRlcmVyLCBvcHRpb25zPzogYW55KTogSVJlbmRlcmVyUGx1Z2luO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElSZW5kZXJlclBsdWdpbiB7XG4gICAgZGVzdHJveSgpOiB2b2lkO1xufVxuXG4vKipcbiAqIFRoZSBSZW5kZXJlciBkcmF3cyB0aGUgc2NlbmUgYW5kIGFsbCBpdHMgY29udGVudCBvbnRvIGEgV2ViR0wgZW5hYmxlZCBjYW52YXMuXG4gKlxuICogVGhpcyByZW5kZXJlciBzaG91bGQgYmUgdXNlZCBmb3IgYnJvd3NlcnMgdGhhdCBzdXBwb3J0IFdlYkdMLlxuICpcbiAqIFRoaXMgcmVuZGVyZXIgd29ya3MgYnkgYXV0b21hdGljYWxseSBtYW5hZ2luZyBXZWJHTEJhdGNoZXNtLCBzbyBubyBuZWVkIGZvciBTcHJpdGUgQmF0Y2hlcyBvciBTcHJpdGUgQ2xvdWRzLlxuICogRG9uJ3QgZm9yZ2V0IHRvIGFkZCB0aGUgdmlldyB0byB5b3VyIERPTSBvciB5b3Ugd2lsbCBub3Qgc2VlIGFueXRoaW5nIVxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBleHRlbmRzIFBJWEkuQWJzdHJhY3RSZW5kZXJlclxuICovXG5leHBvcnQgY2xhc3MgUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyXG57XG4gICAgcHVibGljIGdsOiBJUmVuZGVyaW5nQ29udGV4dDtcbiAgICBwdWJsaWMgZ2xvYmFsVW5pZm9ybXM6IFVuaWZvcm1Hcm91cDtcbiAgICBwdWJsaWMgQ09OVEVYVF9VSUQ6IG51bWJlcjtcbiAgICBwdWJsaWMgcmVuZGVyaW5nVG9TY3JlZW46IGJvb2xlYW47XG4gICAgcHVibGljIGV4dHJhY3Q6IEV4dHJhY3Q7XG4gICAgLy8gc3lzdGVtc1xuICAgIHB1YmxpYyBtYXNrOiBNYXNrU3lzdGVtO1xuICAgIHB1YmxpYyBjb250ZXh0OiBDb250ZXh0U3lzdGVtO1xuICAgIHB1YmxpYyBzdGF0ZTogU3RhdGVTeXN0ZW07XG4gICAgcHVibGljIHNoYWRlcjogU2hhZGVyU3lzdGVtO1xuICAgIHB1YmxpYyB0ZXh0dXJlOiBUZXh0dXJlU3lzdGVtO1xuICAgIHB1YmxpYyBnZW9tZXRyeTogR2VvbWV0cnlTeXN0ZW07XG4gICAgcHVibGljIGZyYW1lYnVmZmVyOiBGcmFtZWJ1ZmZlclN5c3RlbTtcbiAgICBwdWJsaWMgc2Npc3NvcjogU2Npc3NvclN5c3RlbTtcbiAgICBwdWJsaWMgc3RlbmNpbDogU3RlbmNpbFN5c3RlbTtcbiAgICBwdWJsaWMgcHJvamVjdGlvbjogUHJvamVjdGlvblN5c3RlbTtcbiAgICBwdWJsaWMgdGV4dHVyZUdDOiBUZXh0dXJlR0NTeXN0ZW07XG4gICAgcHVibGljIGZpbHRlcjogRmlsdGVyU3lzdGVtO1xuICAgIHB1YmxpYyByZW5kZXJUZXh0dXJlOiBSZW5kZXJUZXh0dXJlU3lzdGVtO1xuICAgIHB1YmxpYyBiYXRjaDogQmF0Y2hTeXN0ZW07XG5cbiAgICBydW5uZXJzOiB7W2tleTogc3RyaW5nXTogUnVubmVyfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSByZW5kZXJlciBpZiBXZWJHTCBpcyBhdmFpbGFibGUuIE92ZXJyaWRlYWJsZVxuICAgICAqIGJ5IHRoZSAqKkBwaXhpL2NhbnZhcy1yZW5kZXJlcioqIHBhY2thZ2UgdG8gYWxsb3cgZmFsbGJhY2suXG4gICAgICogdGhyb3dzIGVycm9yIGlmIFdlYkdMIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShvcHRpb25zOiBJUmVuZGVyZXJPcHRpb25zKTogQWJzdHJhY3RSZW5kZXJlclxuICAgIHtcbiAgICAgICAgaWYgKGlzV2ViR0xTdXBwb3J0ZWQoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZW5kZXJlcihvcHRpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV2ViR0wgdW5zdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyLCB1c2UgXCJwaXhpLmpzLWxlZ2FjeVwiIGZvciBmYWxsYmFjayBjYW52YXMyZCBzdXBwb3J0LicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBUaGUgb3B0aW9uYWwgcmVuZGVyZXIgcGFyYW1ldGVycy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGg9ODAwXSAtIFRoZSB3aWR0aCBvZiB0aGUgc2NyZWVuLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5oZWlnaHQ9NjAwXSAtIFRoZSBoZWlnaHQgb2YgdGhlIHNjcmVlbi5cbiAgICAgKiBAcGFyYW0ge0hUTUxDYW52YXNFbGVtZW50fSBbb3B0aW9ucy52aWV3XSAtIFRoZSBjYW52YXMgdG8gdXNlIGFzIGEgdmlldywgb3B0aW9uYWwuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50cmFuc3BhcmVudD1mYWxzZV0gLSBJZiB0aGUgcmVuZGVyIHZpZXcgaXMgdHJhbnNwYXJlbnQuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hdXRvRGVuc2l0eT1mYWxzZV0gLSBSZXNpemVzIHJlbmRlcmVyIHZpZXcgaW4gQ1NTIHBpeGVscyB0byBhbGxvdyBmb3JcbiAgICAgKiAgIHJlc29sdXRpb25zIG90aGVyIHRoYW4gMS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmFudGlhbGlhcz1mYWxzZV0gLSBTZXRzIGFudGlhbGlhcy4gSWYgbm90IGF2YWlsYWJsZSBuYXRpdmVseSB0aGVuIEZYQUFcbiAgICAgKiAgYW50aWFsaWFzaW5nIGlzIHVzZWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnJlc29sdXRpb249MV0gLSBUaGUgcmVzb2x1dGlvbiAvIGRldmljZSBwaXhlbCByYXRpbyBvZiB0aGUgcmVuZGVyZXIuXG4gICAgICogIFRoZSByZXNvbHV0aW9uIG9mIHRoZSByZW5kZXJlciByZXRpbmEgd291bGQgYmUgMi5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmNsZWFyQmVmb3JlUmVuZGVyPXRydWVdIC0gVGhpcyBzZXRzIGlmIHRoZSByZW5kZXJlciB3aWxsIGNsZWFyXG4gICAgICogIHRoZSBjYW52YXMgb3Igbm90IGJlZm9yZSB0aGUgbmV3IHJlbmRlciBwYXNzLiBJZiB5b3Ugd2lzaCB0byBzZXQgdGhpcyB0byBmYWxzZSwgeW91ICptdXN0KiBzZXRcbiAgICAgKiAgcHJlc2VydmVEcmF3aW5nQnVmZmVyIHRvIGB0cnVlYC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlcj1mYWxzZV0gLSBFbmFibGVzIGRyYXdpbmcgYnVmZmVyIHByZXNlcnZhdGlvbixcbiAgICAgKiAgZW5hYmxlIHRoaXMgaWYgeW91IG5lZWQgdG8gY2FsbCB0b0RhdGFVcmwgb24gdGhlIFdlYkdMIGNvbnRleHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmJhY2tncm91bmRDb2xvcj0weDAwMDAwMF0gLSBUaGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgcmVuZGVyZWQgYXJlYVxuICAgICAqICAoc2hvd24gaWYgbm90IHRyYW5zcGFyZW50KS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMucG93ZXJQcmVmZXJlbmNlXSAtIFBhcmFtZXRlciBwYXNzZWQgdG8gV2ViR0wgY29udGV4dCwgc2V0IHRvIFwiaGlnaC1wZXJmb3JtYW5jZVwiXG4gICAgICogIGZvciBkZXZpY2VzIHdpdGggZHVhbCBncmFwaGljcyBjYXJkLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9ucy5jb250ZXh0XSAtIElmIFdlYkdMIGNvbnRleHQgYWxyZWFkeSBleGlzdHMsIGFsbCBwYXJhbWV0ZXJzIG11c3QgYmUgdGFrZW4gZnJvbSBpdC5cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucz8gOiBJUmVuZGVyZXJPcHRpb25zKVxuICAgIHtcbiAgICAgICAgc3VwZXIoUkVOREVSRVJfVFlQRS5XRUJHTCwgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gdGhlIG9wdGlvbnMgd2lsbCBoYXZlIGJlZW4gbW9kaWZpZWQgaGVyZSBpbiB0aGUgc3VwZXIgY29uc3RydWN0b3Igd2l0aCBwaXhpJ3MgZGVmYXVsdCBzZXR0aW5ncy4uXG4gICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdlYkdMIGNvbnRleHQsIHNldCBieSB0aGUgY29udGV4dFN5c3RlbSAodGhpcy5jb250ZXh0KVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nbCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5DT05URVhUX1VJRCA9IDA7XG5cbiAgICAgICAgLy8gVE9ETyBsZWdhY3khXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIHNpZ25hbCBpbnN0YW5jZXMgb2YgKipydW5uZXIqKiwgdGhlc2VcbiAgICAgICAgICogYXJlIGFzc2lnbmVkIHRvIGVhY2ggc3lzdGVtIGNyZWF0ZWQuXG4gICAgICAgICAqIEBzZWUgUElYSS5SdW5uZXJcbiAgICAgICAgICogQG5hbWUgUElYSS5SZW5kZXJlciNydW5uZXJzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAcHJvcGVydHkge1BJWEkuUnVubmVyfSBkZXN0cm95IC0gRGVzdHJveSBydW5uZXJcbiAgICAgICAgICogQHByb3BlcnR5IHtQSVhJLlJ1bm5lcn0gY29udGV4dENoYW5nZSAtIENvbnRleHQgY2hhbmdlIHJ1bm5lclxuICAgICAgICAgKiBAcHJvcGVydHkge1BJWEkuUnVubmVyfSByZXNldCAtIFJlc2V0IHJ1bm5lclxuICAgICAgICAgKiBAcHJvcGVydHkge1BJWEkuUnVubmVyfSB1cGRhdGUgLSBVcGRhdGUgcnVubmVyXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7UElYSS5SdW5uZXJ9IHBvc3RyZW5kZXIgLSBQb3N0LXJlbmRlciBydW5uZXJcbiAgICAgICAgICogQHByb3BlcnR5IHtQSVhJLlJ1bm5lcn0gcHJlcmVuZGVyIC0gUHJlLXJlbmRlciBydW5uZXJcbiAgICAgICAgICogQHByb3BlcnR5IHtQSVhJLlJ1bm5lcn0gcmVzaXplIC0gUmVzaXplIHJ1bm5lclxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ydW5uZXJzID0ge1xuICAgICAgICAgICAgZGVzdHJveTogbmV3IFJ1bm5lcignZGVzdHJveScpLFxuICAgICAgICAgICAgY29udGV4dENoYW5nZTogbmV3IFJ1bm5lcignY29udGV4dENoYW5nZScpLFxuICAgICAgICAgICAgcmVzZXQ6IG5ldyBSdW5uZXIoJ3Jlc2V0JyksXG4gICAgICAgICAgICB1cGRhdGU6IG5ldyBSdW5uZXIoJ3VwZGF0ZScpLFxuICAgICAgICAgICAgcG9zdHJlbmRlcjogbmV3IFJ1bm5lcigncG9zdHJlbmRlcicpLFxuICAgICAgICAgICAgcHJlcmVuZGVyOiBuZXcgUnVubmVyKCdwcmVyZW5kZXInKSxcbiAgICAgICAgICAgIHJlc2l6ZTogbmV3IFJ1bm5lcigncmVzaXplJyksXG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdsb2JhbCB1bmlmb3Jtc1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlVuaWZvcm1Hcm91cH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2xvYmFsVW5pZm9ybXMgPSBuZXcgVW5pZm9ybUdyb3VwKHtcbiAgICAgICAgICAgIHByb2plY3Rpb25NYXRyaXg6IG5ldyBNYXRyaXgoKSxcbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hc2sgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuc3lzdGVtcy5NYXNrU3lzdGVtfSBtYXNrXG4gICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLlJlbmRlcmVyI1xuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWRkU3lzdGVtKE1hc2tTeXN0ZW0sICdtYXNrJylcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29udGV4dCBzeXN0ZW0gaW5zdGFuY2VcbiAgICAgICAgICAgICAqIEBtZW1iZXIge1BJWEkuc3lzdGVtcy5Db250ZXh0U3lzdGVtfSBjb250ZXh0XG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKENvbnRleHRTeXN0ZW0sICdjb250ZXh0JylcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogU3RhdGUgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuU3RhdGVTeXN0ZW19IHN0YXRlXG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKFN0YXRlU3lzdGVtLCAnc3RhdGUnKVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTaGFkZXIgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuU2hhZGVyU3lzdGVtfSBzaGFkZXJcbiAgICAgICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLlJlbmRlcmVyI1xuICAgICAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC5hZGRTeXN0ZW0oU2hhZGVyU3lzdGVtLCAnc2hhZGVyJylcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVGV4dHVyZSBzeXN0ZW0gaW5zdGFuY2VcbiAgICAgICAgICAgICAqIEBtZW1iZXIge1BJWEkuc3lzdGVtcy5UZXh0dXJlU3lzdGVtfSB0ZXh0dXJlXG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKFRleHR1cmVTeXN0ZW0sICd0ZXh0dXJlJylcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogR2VvbWV0cnkgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuR2VvbWV0cnlTeXN0ZW19IGdlb21ldHJ5XG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKEdlb21ldHJ5U3lzdGVtLCAnZ2VvbWV0cnknKVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBGcmFtZWJ1ZmZlciBzeXN0ZW0gaW5zdGFuY2VcbiAgICAgICAgICAgICAqIEBtZW1iZXIge1BJWEkuc3lzdGVtcy5GcmFtZWJ1ZmZlclN5c3RlbX0gZnJhbWVidWZmZXJcbiAgICAgICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLlJlbmRlcmVyI1xuICAgICAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC5hZGRTeXN0ZW0oRnJhbWVidWZmZXJTeXN0ZW0sICdmcmFtZWJ1ZmZlcicpXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFNjaXNzb3Igc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuU2Npc3NvclN5c3RlbX0gc2Npc3NvclxuICAgICAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuUmVuZGVyZXIjXG4gICAgICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLmFkZFN5c3RlbShTY2lzc29yU3lzdGVtLCAnc2Npc3NvcicpXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFN0ZW5jaWwgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuU3RlbmNpbFN5c3RlbX0gc3RlbmNpbFxuICAgICAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuUmVuZGVyZXIjXG4gICAgICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLmFkZFN5c3RlbShTdGVuY2lsU3lzdGVtLCAnc3RlbmNpbCcpXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFByb2plY3Rpb24gc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuUHJvamVjdGlvblN5c3RlbX0gcHJvamVjdGlvblxuICAgICAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuUmVuZGVyZXIjXG4gICAgICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLmFkZFN5c3RlbShQcm9qZWN0aW9uU3lzdGVtLCAncHJvamVjdGlvbicpXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRleHR1cmUgZ2FyYmFnZSBjb2xsZWN0b3Igc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuVGV4dHVyZUdDU3lzdGVtfSB0ZXh0dXJlR0NcbiAgICAgICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLlJlbmRlcmVyI1xuICAgICAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC5hZGRTeXN0ZW0oVGV4dHVyZUdDU3lzdGVtLCAndGV4dHVyZUdDJylcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRmlsdGVyIHN5c3RlbSBpbnN0YW5jZVxuICAgICAgICAgICAgICogQG1lbWJlciB7UElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbX0gZmlsdGVyXG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKEZpbHRlclN5c3RlbSwgJ2ZpbHRlcicpXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFJlbmRlclRleHR1cmUgc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuUmVuZGVyVGV4dHVyZVN5c3RlbX0gcmVuZGVyVGV4dHVyZVxuICAgICAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuUmVuZGVyZXIjXG4gICAgICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLmFkZFN5c3RlbShSZW5kZXJUZXh0dXJlU3lzdGVtLCAncmVuZGVyVGV4dHVyZScpXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQmF0Y2ggc3lzdGVtIGluc3RhbmNlXG4gICAgICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLnN5c3RlbXMuQmF0Y2hTeXN0ZW19IGJhdGNoXG4gICAgICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAuYWRkU3lzdGVtKEJhdGNoU3lzdGVtLCAnYmF0Y2gnKTtcblxuICAgICAgICB0aGlzLmluaXRQbHVnaW5zKFJlbmRlcmVyLl9fcGx1Z2lucyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBvcHRpb25zIHBhc3NlZCBpbiB0byBjcmVhdGUgYSBuZXcgV2ViR0wgY29udGV4dC5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChvcHRpb25zLmNvbnRleHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5pbml0RnJvbUNvbnRleHQob3B0aW9ucy5jb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5pbml0RnJvbU9wdGlvbnMoe1xuICAgICAgICAgICAgICAgIGFscGhhOiAhIXRoaXMudHJhbnNwYXJlbnQsXG4gICAgICAgICAgICAgICAgYW50aWFsaWFzOiBvcHRpb25zLmFudGlhbGlhcyxcbiAgICAgICAgICAgICAgICBwcmVtdWx0aXBsaWVkQWxwaGE6IHRoaXMudHJhbnNwYXJlbnQgJiYgdGhpcy50cmFuc3BhcmVudCAhPT0gJ25vdE11bHRpcGxpZWQnLFxuICAgICAgICAgICAgICAgIHN0ZW5jaWw6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlcixcbiAgICAgICAgICAgICAgICBwb3dlclByZWZlcmVuY2U6IHRoaXMub3B0aW9ucy5wb3dlclByZWZlcmVuY2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGbGFnIGlmIHdlIGFyZSByZW5kZXJpbmcgdG8gdGhlIHNjcmVlbiB2cyByZW5kZXJUZXh0dXJlXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlbmRlcmluZ1RvU2NyZWVuID0gdHJ1ZTtcblxuICAgICAgICBzYXlIZWxsbyh0aGlzLmNvbnRleHQud2ViR0xWZXJzaW9uID09PSAyID8gJ1dlYkdMIDInIDogJ1dlYkdMIDEnKTtcblxuICAgICAgICB0aGlzLnJlc2l6ZSh0aGlzLm9wdGlvbnMud2lkdGgsIHRoaXMub3B0aW9ucy5oZWlnaHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIG5ldyBzeXN0ZW0gdG8gdGhlIHJlbmRlcmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IENsYXNzUmVmIC0gQ2xhc3MgcmVmZXJlbmNlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtuYW1lXSAtIFByb3BlcnR5IG5hbWUgZm9yIHN5c3RlbSwgaWYgbm90IHNwZWNpZmllZFxuICAgICAqICAgICAgICB3aWxsIHVzZSBhIHN0YXRpYyBgbmFtZWAgcHJvcGVydHkgb24gdGhlIGNsYXNzIGl0c2VsZi4gVGhpc1xuICAgICAqICAgICAgICBuYW1lIHdpbGwgYmUgYXNzaWduZWQgYXMgcyBwcm9wZXJ0eSBvbiB0aGUgUmVuZGVyZXIgc28gbWFrZVxuICAgICAqICAgICAgICBzdXJlIGl0IGRvZXNuJ3QgY29sbGlkZSB3aXRoIHByb3BlcnRpZXMgb24gUmVuZGVyZXIuXG4gICAgICogQHJldHVybiB7UElYSS5SZW5kZXJlcn0gUmV0dXJuIGluc3RhbmNlIG9mIHJlbmRlcmVyXG4gICAgICovXG4gICAgYWRkU3lzdGVtPFQgZXh0ZW5kcyBTeXN0ZW0+KENsYXNzUmVmOiB7IG5ldyhyZW5kZXJlcjogUmVuZGVyZXIpOiBUfSwgbmFtZTogc3RyaW5nKTogdGhpc1xuICAgIHtcbiAgICAgICAgaWYgKCFuYW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lID0gQ2xhc3NSZWYubmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN5c3RlbSA9IG5ldyBDbGFzc1JlZih0aGlzKTtcblxuICAgICAgICBpZiAoKHRoaXMgYXMgYW55KVtuYW1lXSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBXaG9vcHMhIFRoZSBuYW1lIFwiJHtuYW1lfVwiIGlzIGFscmVhZHkgaW4gdXNlYCk7XG4gICAgICAgIH1cblxuICAgICAgICAodGhpcyBhcyBhbnkpW25hbWVdID0gc3lzdGVtO1xuXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnJ1bm5lcnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucnVubmVyc1tpXS5hZGQoc3lzdGVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZCBhZnRlciByZW5kZXJpbmcgZmluaXNoZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBldmVudCBQSVhJLlJlbmRlcmVyI3Bvc3RyZW5kZXJcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIGJlZm9yZSByZW5kZXJpbmcgc3RhcnRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5SZW5kZXJlciNwcmVyZW5kZXJcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVkIHdoZW4gdGhlIFdlYkdMIGNvbnRleHQgaXMgc2V0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXZlbnQgUElYSS5SZW5kZXJlciNjb250ZXh0XG4gICAgICAgICAqIEBwYXJhbSB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBnbCAtIFdlYkdMIGNvbnRleHQuXG4gICAgICAgICAqL1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgdGhlIG9iamVjdCB0byBpdHMgV2ViR0wgdmlld1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGRpc3BsYXlPYmplY3QgLSBUaGUgb2JqZWN0IHRvIGJlIHJlbmRlcmVkLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBbcmVuZGVyVGV4dHVyZV0gLSBUaGUgcmVuZGVyIHRleHR1cmUgdG8gcmVuZGVyIHRvLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2NsZWFyPXRydWVdIC0gU2hvdWxkIHRoZSBjYW52YXMgYmUgY2xlYXJlZCBiZWZvcmUgdGhlIG5ldyByZW5kZXIuXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gW3RyYW5zZm9ybV0gLSBBIHRyYW5zZm9ybSB0byBhcHBseSB0byB0aGUgcmVuZGVyIHRleHR1cmUgYmVmb3JlIHJlbmRlcmluZy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwVXBkYXRlVHJhbnNmb3JtPWZhbHNlXSAtIFNob3VsZCB3ZSBza2lwIHRoZSB1cGRhdGUgdHJhbnNmb3JtIHBhc3M/XG4gICAgICovXG4gICAgcmVuZGVyKGRpc3BsYXlPYmplY3Q6IERpc3BsYXlPYmplY3QsIHJlbmRlclRleHR1cmU/OiBSZW5kZXJUZXh0dXJlLFxuICAgICAgICBjbGVhcj86IGJvb2xlYW4sIHRyYW5zZm9ybT86IE1hdHJpeCwgc2tpcFVwZGF0ZVRyYW5zZm9ybT86IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBjYW4gYmUgaGFuZHkgdG8ga25vdyFcbiAgICAgICAgdGhpcy5yZW5kZXJpbmdUb1NjcmVlbiA9ICFyZW5kZXJUZXh0dXJlO1xuXG4gICAgICAgIHRoaXMucnVubmVycy5wcmVyZW5kZXIuZW1pdCgpO1xuICAgICAgICB0aGlzLmVtaXQoJ3ByZXJlbmRlcicpO1xuXG4gICAgICAgIC8vIGFwcGx5IGEgdHJhbnNmb3JtIGF0IGEgR1BVIGxldmVsXG4gICAgICAgIHRoaXMucHJvamVjdGlvbi50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XG5cbiAgICAgICAgLy8gbm8gcG9pbnQgcmVuZGVyaW5nIGlmIG91ciBjb250ZXh0IGhhcyBiZWVuIGJsb3duIHVwIVxuICAgICAgICBpZiAodGhpcy5jb250ZXh0LmlzTG9zdClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZW5kZXJUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9sYXN0T2JqZWN0UmVuZGVyZWQgPSBkaXNwbGF5T2JqZWN0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFza2lwVXBkYXRlVHJhbnNmb3JtKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB1cGRhdGUgdGhlIHNjZW5lIGdyYXBoXG4gICAgICAgICAgICBjb25zdCBjYWNoZVBhcmVudCA9IGRpc3BsYXlPYmplY3QuZW5hYmxlVGVtcFBhcmVudCgpO1xuXG4gICAgICAgICAgICBkaXNwbGF5T2JqZWN0LnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgZGlzcGxheU9iamVjdC5kaXNhYmxlVGVtcFBhcmVudChjYWNoZVBhcmVudCk7XG4gICAgICAgICAgICAvLyBkaXNwbGF5T2JqZWN0LmhpdEFyZWEgPSAvL1RPRE8gYWRkIGEgdGVtcCBoaXQgYXJlYVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUZXh0dXJlLmJpbmQocmVuZGVyVGV4dHVyZSk7XG4gICAgICAgIHRoaXMuYmF0Y2guY3VycmVudFJlbmRlcmVyLnN0YXJ0KCk7XG5cbiAgICAgICAgaWYgKGNsZWFyICE9PSB1bmRlZmluZWQgPyBjbGVhciA6IHRoaXMuY2xlYXJCZWZvcmVSZW5kZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVGV4dHVyZS5jbGVhcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGlzcGxheU9iamVjdC5yZW5kZXIodGhpcyk7XG5cbiAgICAgICAgLy8gYXBwbHkgdHJhbnNmb3JtLi5cbiAgICAgICAgdGhpcy5iYXRjaC5jdXJyZW50UmVuZGVyZXIuZmx1c2goKTtcblxuICAgICAgICBpZiAocmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmVuZGVyVGV4dHVyZS5iYXNlVGV4dHVyZS51cGRhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucnVubmVycy5wb3N0cmVuZGVyLmVtaXQoKTtcblxuICAgICAgICAvLyByZXNldCB0cmFuc2Zvcm0gYWZ0ZXIgcmVuZGVyXG4gICAgICAgIHRoaXMucHJvamVjdGlvbi50cmFuc2Zvcm0gPSBudWxsO1xuXG4gICAgICAgIHRoaXMuZW1pdCgncG9zdHJlbmRlcicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2l6ZXMgdGhlIFdlYkdMIHZpZXcgdG8gdGhlIHNwZWNpZmllZCB3aWR0aCBhbmQgaGVpZ2h0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNjcmVlbldpZHRoIC0gVGhlIG5ldyB3aWR0aCBvZiB0aGUgc2NyZWVuLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY3JlZW5IZWlnaHQgLSBUaGUgbmV3IGhlaWdodCBvZiB0aGUgc2NyZWVuLlxuICAgICAqL1xuICAgIHJlc2l6ZShzY3JlZW5XaWR0aDogbnVtYmVyLCBzY3JlZW5IZWlnaHQ6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLnJlc2l6ZShzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0KTtcblxuICAgICAgICB0aGlzLnJ1bm5lcnMucmVzaXplLmVtaXQoc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBXZWJHTCBzdGF0ZSBzbyB5b3UgY2FuIHJlbmRlciB0aGluZ3MgaG93ZXZlciB5b3UgZmFuY3khXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlbmRlcmVyfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICByZXNldCgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLnJ1bm5lcnMucmVzZXQuZW1pdCgpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSBmcmFtZSBidWZmZXJcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlbmRlclRleHR1cmUuYmluZCgpO1xuICAgICAgICB0aGlzLnJlbmRlclRleHR1cmUuY2xlYXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGV2ZXJ5dGhpbmcgZnJvbSB0aGUgcmVuZGVyZXIgKGV2ZW50IGxpc3RlbmVycywgc3ByaXRlYmF0Y2gsIGV0Yy4uLilcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3JlbW92ZVZpZXc9ZmFsc2VdIC0gUmVtb3ZlcyB0aGUgQ2FudmFzIGVsZW1lbnQgZnJvbSB0aGUgRE9NLlxuICAgICAqICBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9waXhpanMvcGl4aS5qcy9pc3N1ZXMvMjIzM1xuICAgICAqL1xuICAgIGRlc3Ryb3kocmVtb3ZlVmlldz86IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJ1bm5lcnMuZGVzdHJveS5lbWl0KCk7XG5cbiAgICAgICAgZm9yIChjb25zdCByIGluIHRoaXMucnVubmVycylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5ydW5uZXJzW3JdLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhbGwgYmFzZSBkZXN0cm95XG4gICAgICAgIHN1cGVyLmRlc3Ryb3kocmVtb3ZlVmlldyk7XG5cbiAgICAgICAgLy8gVE9ETyBudWxsaWZ5IGFsbCB0aGUgbWFuYWdlcnMuLlxuICAgICAgICB0aGlzLmdsID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb2xsZWN0aW9uIG9mIGluc3RhbGxlZCBwbHVnaW5zLiBUaGVzZSBhcmUgaW5jbHVkZWQgYnkgZGVmYXVsdCBpbiBQSVhJLCBidXQgY2FuIGJlIGV4Y2x1ZGVkXG4gICAgICogYnkgY3JlYXRpbmcgYSBjdXN0b20gYnVpbGQuIENvbnN1bHQgdGhlIFJFQURNRSBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBjcmVhdGluZyBjdXN0b21cbiAgICAgKiBidWlsZHMgYW5kIGV4Y2x1ZGluZyBwbHVnaW5zLlxuICAgICAqIEBuYW1lIFBJWEkuUmVuZGVyZXIjcGx1Z2luc1xuICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQHByb3BlcnR5IHtQSVhJLkFjY2Vzc2liaWxpdHlNYW5hZ2VyfSBhY2Nlc3NpYmlsaXR5IFN1cHBvcnQgdGFiYmluZyBpbnRlcmFjdGl2ZSBlbGVtZW50cy5cbiAgICAgKiBAcHJvcGVydHkge1BJWEkuRXh0cmFjdH0gZXh0cmFjdCBFeHRyYWN0IGltYWdlIGRhdGEgZnJvbSByZW5kZXJlci5cbiAgICAgKiBAcHJvcGVydHkge1BJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyfSBpbnRlcmFjdGlvbiBIYW5kbGVzIG1vdXNlLCB0b3VjaCBhbmQgcG9pbnRlciBldmVudHMuXG4gICAgICogQHByb3BlcnR5IHtQSVhJLlByZXBhcmV9IHByZXBhcmUgUHJlLXJlbmRlciBkaXNwbGF5IG9iamVjdHMuXG4gICAgICovXG5cbiAgICBzdGF0aWMgX19wbHVnaW5zOiBJUmVuZGVyZXJQbHVnaW5zO1xuICAgIC8qKlxuICAgICAqIEFkZHMgYSBwbHVnaW4gdG8gdGhlIHJlbmRlcmVyLlxuICAgICAqXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwbHVnaW5OYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHBsdWdpbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdG9yIC0gVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIG9yIGNsYXNzIGZvciB0aGUgcGx1Z2luLlxuICAgICAqL1xuICAgIHN0YXRpYyByZWdpc3RlclBsdWdpbihwbHVnaW5OYW1lOiBzdHJpbmcsIGN0b3I6IElSZW5kZXJlclBsdWdpbkNvbnN0cnVjdG9yKTogdm9pZFxuICAgIHtcbiAgICAgICAgUmVuZGVyZXIuX19wbHVnaW5zID0gUmVuZGVyZXIuX19wbHVnaW5zIHx8IHt9O1xuICAgICAgICBSZW5kZXJlci5fX3BsdWdpbnNbcGx1Z2luTmFtZV0gPSBjdG9yO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4vUmVuZGVyZXInO1xuaW1wb3J0IHR5cGUgeyBBYnN0cmFjdFJlbmRlcmVyLCBJUmVuZGVyZXJPcHRpb25zIH0gZnJvbSAnLi9BYnN0cmFjdFJlbmRlcmVyJztcblxuZXhwb3J0IGludGVyZmFjZSBJUmVuZGVyZXJPcHRpb25zQXV0byBleHRlbmRzIElSZW5kZXJlck9wdGlvbnNcbntcbiAgICBmb3JjZUNhbnZhcz86IGJvb2xlYW47XG59XG4vKipcbiAqIFRoaXMgaGVscGVyIGZ1bmN0aW9uIHdpbGwgYXV0b21hdGljYWxseSBkZXRlY3Qgd2hpY2ggcmVuZGVyZXIgeW91IHNob3VsZCBiZSB1c2luZy5cbiAqIFdlYkdMIGlzIHRoZSBwcmVmZXJyZWQgcmVuZGVyZXIgYXMgaXQgaXMgYSBsb3QgZmFzdGVyLiBJZiBXZWJHTCBpcyBub3Qgc3VwcG9ydGVkIGJ5XG4gKiB0aGUgYnJvd3NlciB0aGVuIHRoaXMgZnVuY3Rpb24gd2lsbCByZXR1cm4gYSBjYW52YXMgcmVuZGVyZXJcbiAqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGZ1bmN0aW9uIGF1dG9EZXRlY3RSZW5kZXJlclxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25hbCByZW5kZXJlciBwYXJhbWV0ZXJzXG4gKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGg9ODAwXSAtIHRoZSB3aWR0aCBvZiB0aGUgcmVuZGVyZXJzIHZpZXdcbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5oZWlnaHQ9NjAwXSAtIHRoZSBoZWlnaHQgb2YgdGhlIHJlbmRlcmVycyB2aWV3XG4gKiBAcGFyYW0ge0hUTUxDYW52YXNFbGVtZW50fSBbb3B0aW9ucy52aWV3XSAtIHRoZSBjYW52YXMgdG8gdXNlIGFzIGEgdmlldywgb3B0aW9uYWxcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudHJhbnNwYXJlbnQ9ZmFsc2VdIC0gSWYgdGhlIHJlbmRlciB2aWV3IGlzIHRyYW5zcGFyZW50LCBkZWZhdWx0IGZhbHNlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9EZW5zaXR5PWZhbHNlXSAtIFJlc2l6ZXMgcmVuZGVyZXIgdmlldyBpbiBDU1MgcGl4ZWxzIHRvIGFsbG93IGZvclxuICogICByZXNvbHV0aW9ucyBvdGhlciB0aGFuIDFcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYW50aWFsaWFzPWZhbHNlXSAtIHNldHMgYW50aWFsaWFzXG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlcj1mYWxzZV0gLSBlbmFibGVzIGRyYXdpbmcgYnVmZmVyIHByZXNlcnZhdGlvbiwgZW5hYmxlIHRoaXMgaWYgeW91XG4gKiAgbmVlZCB0byBjYWxsIHRvRGF0YVVybCBvbiB0aGUgd2ViZ2wgY29udGV4dFxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmJhY2tncm91bmRDb2xvcj0weDAwMDAwMF0gLSBUaGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgcmVuZGVyZWQgYXJlYVxuICogIChzaG93biBpZiBub3QgdHJhbnNwYXJlbnQpLlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jbGVhckJlZm9yZVJlbmRlcj10cnVlXSAtIFRoaXMgc2V0cyBpZiB0aGUgcmVuZGVyZXIgd2lsbCBjbGVhciB0aGUgY2FudmFzIG9yXG4gKiAgIG5vdCBiZWZvcmUgdGhlIG5ldyByZW5kZXIgcGFzcy5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5yZXNvbHV0aW9uPTFdIC0gVGhlIHJlc29sdXRpb24gLyBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgdGhlIHJlbmRlcmVyLCByZXRpbmEgd291bGQgYmUgMlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5mb3JjZUNhbnZhcz1mYWxzZV0gLSBwcmV2ZW50cyBzZWxlY3Rpb24gb2YgV2ViR0wgcmVuZGVyZXIsIGV2ZW4gaWYgc3VjaCBpcyBwcmVzZW50LCB0aGlzXG4gKiAgIG9wdGlvbiBvbmx5IGlzIGF2YWlsYWJsZSB3aGVuIHVzaW5nICoqcGl4aS5qcy1sZWdhY3kqKiBvciAqKkBwaXhpL2NhbnZhcy1yZW5kZXJlcioqIG1vZHVsZXMsIG90aGVyd2lzZVxuICogICBpdCBpcyBpZ25vcmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnBvd2VyUHJlZmVyZW5jZV0gLSBQYXJhbWV0ZXIgcGFzc2VkIHRvIHdlYmdsIGNvbnRleHQsIHNldCB0byBcImhpZ2gtcGVyZm9ybWFuY2VcIlxuICogIGZvciBkZXZpY2VzIHdpdGggZHVhbCBncmFwaGljcyBjYXJkICoqd2ViZ2wgb25seSoqXG4gKiBAcmV0dXJuIHtQSVhJLlJlbmRlcmVyfFBJWEkuQ2FudmFzUmVuZGVyZXJ9IFJldHVybnMgV2ViR0wgcmVuZGVyZXIgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgQ2FudmFzUmVuZGVyZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGF1dG9EZXRlY3RSZW5kZXJlcihvcHRpb25zOiBJUmVuZGVyZXJPcHRpb25zQXV0byk6IEFic3RyYWN0UmVuZGVyZXJcbntcbiAgICByZXR1cm4gUmVuZGVyZXIuY3JlYXRlKG9wdGlvbnMpO1xufVxuIiwgImltcG9ydCB7IERSQVdfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuXG5pbXBvcnQgdHlwZSB7IEJMRU5EX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB0eXBlIHsgQmF0Y2hUZXh0dXJlQXJyYXkgfSBmcm9tICcuL0JhdGNoVGV4dHVyZUFycmF5JztcblxuLyoqXG4gKiBVc2VkIGJ5IHRoZSBiYXRjaGVyIHRvIGRyYXcgYmF0Y2hlcy5cbiAqIEVhY2ggb25lIG9mIHRoZXNlIGNvbnRhaW5zIGFsbCBpbmZvcm1hdGlvbiByZXF1aXJlZCB0byBkcmF3IGEgYm91bmQgZ2VvbWV0cnkuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQmF0Y2hEcmF3Q2FsbFxue1xuICAgIHRleEFycmF5OiBCYXRjaFRleHR1cmVBcnJheTtcbiAgICB0eXBlOiBEUkFXX01PREVTO1xuICAgIGJsZW5kOiBCTEVORF9NT0RFUztcbiAgICBzdGFydDogbnVtYmVyO1xuICAgIHNpemU6IG51bWJlcjtcbiAgICBkYXRhOiBhbnk7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICB0aGlzLnRleEFycmF5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5ibGVuZCA9IDA7XG4gICAgICAgIHRoaXMudHlwZSA9IERSQVdfTU9ERVMuVFJJQU5HTEVTO1xuXG4gICAgICAgIHRoaXMuc3RhcnQgPSAwO1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBkYXRhIGZvciB1bmlmb3JtcyBvciBjdXN0b20gd2ViZ2wgc3RhdGVcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBCYXNlVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG4vKipcbiAqIFVzZWQgYnkgdGhlIGJhdGNoZXIgdG8gYnVpbGQgdGV4dHVyZSBiYXRjaGVzLlxuICogSG9sZHMgbGlzdCBvZiB0ZXh0dXJlcyBhbmQgdGhlaXIgcmVzcGVjdGl2ZSBsb2NhdGlvbnMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQmF0Y2hUZXh0dXJlQXJyYXlcbntcbiAgICBwdWJsaWMgZWxlbWVudHM6IEJhc2VUZXh0dXJlW107XG4gICAgcHVibGljIGlkczogbnVtYmVyW107XG4gICAgcHVibGljIGNvdW50OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogaW5zaWRlIHRleHR1cmVzIGFycmF5XG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQmFzZVRleHR1cmVbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZWxlbWVudHMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlc3BlY3RpdmUgbG9jYXRpb25zIGZvciB0ZXh0dXJlc1xuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaWRzID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBudW1iZXIgb2YgZmlsbGVkIGVsZW1lbnRzXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgIH1cblxuICAgIGNsZWFyKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jb3VudDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2ldID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvdW50ID0gMDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBJVHlwZWRBcnJheSB9IGZyb20gJy4vQnVmZmVyJztcblxuLyoqXG4gKiBGbGV4aWJsZSB3cmFwcGVyIGFyb3VuZCBgQXJyYXlCdWZmZXJgIHRoYXQgYWxzbyBwcm92aWRlc1xuICogdHlwZWQgYXJyYXkgdmlld3Mgb24gZGVtYW5kLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFZpZXdhYmxlQnVmZmVyXG57XG4gICAgcHVibGljIHNpemU6IG51bWJlcjtcbiAgICBwdWJsaWMgcmF3QmluYXJ5RGF0YTogQXJyYXlCdWZmZXI7XG4gICAgcHVibGljIHVpbnQzMlZpZXc6IFVpbnQzMkFycmF5O1xuICAgIHB1YmxpYyBmbG9hdDMyVmlldzogRmxvYXQzMkFycmF5O1xuXG4gICAgcHJpdmF0ZSBfaW50OFZpZXc6IEludDhBcnJheTtcbiAgICBwcml2YXRlIF91aW50OFZpZXc6IFVpbnQ4QXJyYXk7XG4gICAgcHJpdmF0ZSBfaW50MTZWaWV3OiBJbnQxNkFycmF5O1xuICAgIHByaXZhdGUgX3VpbnQxNlZpZXc6IFVpbnQxNkFycmF5O1xuICAgIHByaXZhdGUgX2ludDMyVmlldzogSW50MzJBcnJheTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzaXplIC0gVGhlIHNpemUgb2YgdGhlIGJ1ZmZlciBpbiBieXRlcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzaXplOiBudW1iZXIpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVW5kZXJseWluZyBgQXJyYXlCdWZmZXJgIHRoYXQgaG9sZHMgYWxsIHRoZSBkYXRhXG4gICAgICAgICAqIGFuZCBpcyBvZiBjYXBhY2l0eSBgc2l6ZWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5QnVmZmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yYXdCaW5hcnlEYXRhID0gbmV3IEFycmF5QnVmZmVyKHNpemUpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWaWV3IG9uIHRoZSByYXcgYmluYXJ5IGRhdGEgYXMgYSBgVWludDMyQXJyYXlgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtVaW50MzJBcnJheX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudWludDMyVmlldyA9IG5ldyBVaW50MzJBcnJheSh0aGlzLnJhd0JpbmFyeURhdGEpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWaWV3IG9uIHRoZSByYXcgYmluYXJ5IGRhdGEgYXMgYSBgRmxvYXQzMkFycmF5YC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7RmxvYXQzMkFycmF5fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mbG9hdDMyVmlldyA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5yYXdCaW5hcnlEYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWaWV3IG9uIHRoZSByYXcgYmluYXJ5IGRhdGEgYXMgYSBgSW50OEFycmF5YC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge0ludDhBcnJheX1cbiAgICAgKi9cbiAgICBnZXQgaW50OFZpZXcoKTogSW50OEFycmF5XG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX2ludDhWaWV3KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9pbnQ4VmlldyA9IG5ldyBJbnQ4QXJyYXkodGhpcy5yYXdCaW5hcnlEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnQ4VmlldztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWaWV3IG9uIHRoZSByYXcgYmluYXJ5IGRhdGEgYXMgYSBgVWludDhBcnJheWAuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtVaW50OEFycmF5fVxuICAgICAqL1xuICAgIGdldCB1aW50OFZpZXcoKTogVWludDhBcnJheVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl91aW50OFZpZXcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3VpbnQ4VmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMucmF3QmluYXJ5RGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5fdWludDhWaWV3O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZpZXcgb24gdGhlIHJhdyBiaW5hcnkgZGF0YSBhcyBhIGBJbnQxNkFycmF5YC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge0ludDE2QXJyYXl9XG4gICAgICovXG4gICAgZ2V0IGludDE2VmlldygpOiBJbnQxNkFycmF5XG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX2ludDE2VmlldylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faW50MTZWaWV3ID0gbmV3IEludDE2QXJyYXkodGhpcy5yYXdCaW5hcnlEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnQxNlZpZXc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmlldyBvbiB0aGUgcmF3IGJpbmFyeSBkYXRhIGFzIGEgYFVpbnQxNkFycmF5YC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1VpbnQxNkFycmF5fVxuICAgICAqL1xuICAgIGdldCB1aW50MTZWaWV3KCk6IFVpbnQxNkFycmF5XG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX3VpbnQxNlZpZXcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3VpbnQxNlZpZXcgPSBuZXcgVWludDE2QXJyYXkodGhpcy5yYXdCaW5hcnlEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl91aW50MTZWaWV3O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZpZXcgb24gdGhlIHJhdyBiaW5hcnkgZGF0YSBhcyBhIGBJbnQzMkFycmF5YC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge0ludDMyQXJyYXl9XG4gICAgICovXG4gICAgZ2V0IGludDMyVmlldygpOiBJbnQzMkFycmF5XG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuX2ludDMyVmlldylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faW50MzJWaWV3ID0gbmV3IEludDMyQXJyYXkodGhpcy5yYXdCaW5hcnlEYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnQzMlZpZXc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmlldyBvZiB0aGUgZ2l2ZW4gdHlwZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gT25lIG9mIGBpbnQ4YCwgYHVpbnQ4YCwgYGludDE2YCxcbiAgICAgKiAgICBgdWludDE2YCwgYGludDMyYCwgYHVpbnQzMmAsIGFuZCBgZmxvYXQzMmAuXG4gICAgICogQHJldHVybiB7b2JqZWN0fSB0eXBlZCBhcnJheSBvZiBnaXZlbiB0eXBlXG4gICAgICovXG4gICAgdmlldyh0eXBlOiBzdHJpbmcpOiBJVHlwZWRBcnJheVxuICAgIHtcbiAgICAgICAgcmV0dXJuICh0aGlzIGFzIGFueSlbYCR7dHlwZX1WaWV3YF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgYWxsIGJ1ZmZlciByZWZlcmVuY2VzLiBEbyBub3QgdXNlIGFmdGVyIGNhbGxpbmdcbiAgICAgKiB0aGlzLlxuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5yYXdCaW5hcnlEYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW50OFZpZXcgPSBudWxsO1xuICAgICAgICB0aGlzLl91aW50OFZpZXcgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbnQxNlZpZXcgPSBudWxsO1xuICAgICAgICB0aGlzLl91aW50MTZWaWV3ID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW50MzJWaWV3ID0gbnVsbDtcbiAgICAgICAgdGhpcy51aW50MzJWaWV3ID0gbnVsbDtcbiAgICAgICAgdGhpcy5mbG9hdDMyVmlldyA9IG51bGw7XG4gICAgfVxuXG4gICAgc3RhdGljIHNpemVPZih0eXBlOiBzdHJpbmcpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHN3aXRjaCAodHlwZSlcbiAgICAgICAge1xuICAgICAgICAgICAgY2FzZSAnaW50OCc6XG4gICAgICAgICAgICBjYXNlICd1aW50OCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlICdpbnQxNic6XG4gICAgICAgICAgICBjYXNlICd1aW50MTYnOlxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSAnaW50MzInOlxuICAgICAgICAgICAgY2FzZSAndWludDMyJzpcbiAgICAgICAgICAgIGNhc2UgJ2Zsb2F0MzInOlxuICAgICAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dHlwZX0gaXNuJ3QgYSB2YWxpZCB2aWV3IHR5cGVgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBCYXRjaERyYXdDYWxsIH0gZnJvbSAnLi9CYXRjaERyYXdDYWxsJztcbmltcG9ydCB7IEJhdGNoVGV4dHVyZUFycmF5IH0gZnJvbSAnLi9CYXRjaFRleHR1cmVBcnJheSc7XG5pbXBvcnQgeyBCYXNlVGV4dHVyZSB9IGZyb20gJy4uL3RleHR1cmVzL0Jhc2VUZXh0dXJlJztcbmltcG9ydCB7IE9iamVjdFJlbmRlcmVyIH0gZnJvbSAnLi9PYmplY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL1N0YXRlJztcbmltcG9ydCB7IFZpZXdhYmxlQnVmZmVyIH0gZnJvbSAnLi4vZ2VvbWV0cnkvVmlld2FibGVCdWZmZXInO1xuXG5pbXBvcnQgeyBjaGVja01heElmU3RhdGVtZW50c0luU2hhZGVyIH0gZnJvbSAnLi4vc2hhZGVyL3V0aWxzL2NoZWNrTWF4SWZTdGF0ZW1lbnRzSW5TaGFkZXInO1xuXG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJ0BwaXhpL3NldHRpbmdzJztcbmltcG9ydCB7IHByZW11bHRpcGx5QmxlbmRNb2RlLCBwcmVtdWx0aXBseVRpbnQsIG5leHRQb3cyLCBsb2cyIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgRU5WIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJy4uL1JlbmRlcmVyJztcbmltcG9ydCB0eXBlIHsgU2hhZGVyIH0gZnJvbSAnLi4vc2hhZGVyL1NoYWRlcic7XG5pbXBvcnQgdHlwZSB7IEJhdGNoU2hhZGVyR2VuZXJhdG9yIH0gZnJvbSAnLi9CYXRjaFNoYWRlckdlbmVyYXRvcic7XG5pbXBvcnQgdHlwZSB7IEJhdGNoR2VvbWV0cnkgfSBmcm9tICcuL0JhdGNoR2VvbWV0cnknO1xuaW1wb3J0IHR5cGUgeyBUZXh0dXJlIH0gZnJvbSAnLi4vdGV4dHVyZXMvVGV4dHVyZSc7XG5pbXBvcnQgdHlwZSB7IEJMRU5EX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIGVsZW1lbnRzIGxpa2UgU3ByaXRlLCBNZXNoIGV0Yy4gZm9yIGJhdGNoaW5nLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElCYXRjaGFibGVFbGVtZW50IHtcbiAgICBfdGV4dHVyZTogVGV4dHVyZTtcbiAgICB2ZXJ0ZXhEYXRhOiBGbG9hdDMyQXJyYXk7XG4gICAgaW5kaWNlczogVWludDE2QXJyYXkgfCBVaW50MzJBcnJheSB8IEFycmF5PG51bWJlcj47XG4gICAgdXZzOiBGbG9hdDMyQXJyYXk7XG4gICAgd29ybGRBbHBoYTogbnVtYmVyO1xuICAgIF90aW50UkdCOiBudW1iZXI7XG4gICAgYmxlbmRNb2RlOiBCTEVORF9NT0RFUztcbn1cblxuLyoqXG4gKiBSZW5kZXJlciBkZWRpY2F0ZWQgdG8gZHJhd2luZyBhbmQgYmF0Y2hpbmcgc3ByaXRlcy5cbiAqXG4gKiBUaGlzIGlzIHRoZSBkZWZhdWx0IGJhdGNoIHJlbmRlcmVyLiBJdCBidWZmZXJzIG9iamVjdHNcbiAqIHdpdGggdGV4dHVyZS1iYXNlZCBnZW9tZXRyaWVzIGFuZCByZW5kZXJzIHRoZW0gaW5cbiAqIGJhdGNoZXMuIEl0IHVwbG9hZHMgbXVsdGlwbGUgdGV4dHVyZXMgdG8gdGhlIEdQVSB0b1xuICogcmVkdWNlIHRvIHRoZSBudW1iZXIgb2YgZHJhdyBjYWxscy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwcm90ZWN0ZWRcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAZXh0ZW5kcyBQSVhJLk9iamVjdFJlbmRlcmVyXG4gKi9cbmV4cG9ydCBjbGFzcyBBYnN0cmFjdEJhdGNoUmVuZGVyZXIgZXh0ZW5kcyBPYmplY3RSZW5kZXJlclxue1xuICAgIHB1YmxpYyByZWFkb25seSBzdGF0ZTogU3RhdGU7XG4gICAgcHVibGljIHNpemU6IG51bWJlcjtcbiAgICBwdWJsaWMgTUFYX1RFWFRVUkVTOiBudW1iZXI7XG5cbiAgICBwcm90ZWN0ZWQgc2hhZGVyR2VuZXJhdG9yOiBCYXRjaFNoYWRlckdlbmVyYXRvcjtcbiAgICBwcm90ZWN0ZWQgZ2VvbWV0cnlDbGFzczogdHlwZW9mIEJhdGNoR2VvbWV0cnk7XG4gICAgcHJvdGVjdGVkIHZlcnRleFNpemU6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3ZlcnRleENvdW50OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9pbmRleENvdW50OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9idWZmZXJlZEVsZW1lbnRzOiBBcnJheTxJQmF0Y2hhYmxlRWxlbWVudD47XG4gICAgcHJvdGVjdGVkIF9idWZmZXJlZFRleHR1cmVzOiBBcnJheTxCYXNlVGV4dHVyZT47XG4gICAgcHJvdGVjdGVkIF9idWZmZXJTaXplOiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9zaGFkZXI6IFNoYWRlcjtcbiAgICBwcm90ZWN0ZWQgX2ZsdXNoSWQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2FCdWZmZXJzOiBBcnJheTxWaWV3YWJsZUJ1ZmZlcj47XG4gICAgcHJvdGVjdGVkIF9pQnVmZmVyczogQXJyYXk8VWludDE2QXJyYXk+O1xuICAgIHByb3RlY3RlZCBfZGNJbmRleDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfYUluZGV4OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF9pSW5kZXg6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2F0dHJpYnV0ZUJ1ZmZlcjogVmlld2FibGVCdWZmZXI7XG4gICAgcHJvdGVjdGVkIF9pbmRleEJ1ZmZlcjogVWludDE2QXJyYXk7XG4gICAgcHJvdGVjdGVkIF90ZW1wQm91bmRUZXh0dXJlczogQmFzZVRleHR1cmVbXTtcblxuICAgIHByaXZhdGUgX3BhY2tlZEdlb21ldHJpZXM6IEFycmF5PEJhdGNoR2VvbWV0cnk+O1xuICAgIHByaXZhdGUgX3BhY2tlZEdlb21ldHJ5UG9vbFNpemU6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgd2lsbCBob29rIG9udG8gdGhlIHJlbmRlcmVyJ3MgYGNvbnRleHRDaGFuZ2VgXG4gICAgICogYW5kIGBwcmVyZW5kZXJgIHNpZ25hbHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBpcyB1c2VkIHRvIGdlbmVyYXRlIGEgc2hhZGVyIHRoYXQgY2FuXG4gICAgICAgICAqIGNvbG9yIGVhY2ggdmVydGV4IGJhc2VkIG9uIGEgYGFUZXh0dXJlSWRgXG4gICAgICAgICAqIGF0dHJpYnV0ZSB0aGF0IHBvaW50cyB0byBhbiB0ZXh0dXJlIGluIGB1U2FtcGxlcmAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoaXMgZW5hYmxlcyB0aGUgb2JqZWN0cyB3aXRoIGRpZmZlcmVudCB0ZXh0dXJlc1xuICAgICAgICAgKiB0byBiZSBkcmF3biBpbiB0aGUgc2FtZSBkcmF3IGNhbGwuXG4gICAgICAgICAqXG4gICAgICAgICAqIFlvdSBjYW4gY3VzdG9taXplIHlvdXIgc2hhZGVyIGJ5IGNyZWF0aW5nIHlvdXJcbiAgICAgICAgICogY3VzdG9tIHNoYWRlciBnZW5lcmF0b3IuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQmF0Y2hTaGFkZXJHZW5lcmF0b3J9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hhZGVyR2VuZXJhdG9yID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyB0aGUgZ2VvbWV0cnkgb2Ygb2JqZWN0c1xuICAgICAgICAgKiB0aGF0IGFyZSBnb2luZyB0byBiZSBiYXRjaGVkIHdpdGggdGhpcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0fVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLkJhdGNoR2VvbWV0cnlcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nZW9tZXRyeUNsYXNzID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2l6ZSBvZiBkYXRhIGJlaW5nIGJ1ZmZlcmVkIHBlciB2ZXJ0ZXggaW4gdGhlXG4gICAgICAgICAqIGF0dHJpYnV0ZSBidWZmZXJzIChpbiBmbG9hdHMpLiBCeSBkZWZhdWx0LCB0aGVcbiAgICAgICAgICogYmF0Y2gtcmVuZGVyZXIgcGx1Z2luIHVzZXMgNjpcbiAgICAgICAgICpcbiAgICAgICAgICogfCBhVmVydGV4UG9zaXRpb24gfCAyIHxcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tfC0tLXxcbiAgICAgICAgICogfCBhVGV4dHVyZUNvb3JkcyAgfCAyIHxcbiAgICAgICAgICogfCBhQ29sb3IgICAgICAgICAgfCAxIHxcbiAgICAgICAgICogfCBhVGV4dHVyZUlkICAgICAgfCAxIHxcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmVydGV4U2l6ZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBXZWJHTCBzdGF0ZSBpbiB3aGljaCB0aGlzIHJlbmRlcmVyIHdpbGwgd29yay5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TdGF0ZX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuZm9yMmQoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBidWZmZXJhYmxlIG9iamVjdHMgYmVmb3JlIGEgZmx1c2hcbiAgICAgICAgICogb2NjdXJzIGF1dG9tYXRpY2FsbHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgc2V0dGluZ3MuU1BSSVRFX0JBVENIX1NJWkUgKiA0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNpemUgPSBzZXR0aW5ncy5TUFJJVEVfQkFUQ0hfU0laRSAqIDQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvdGFsIGNvdW50IG9mIGFsbCB2ZXJ0aWNlcyB1c2VkIGJ5IHRoZSBjdXJyZW50bHlcbiAgICAgICAgICogYnVmZmVyZWQgb2JqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdmVydGV4Q291bnQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUb3RhbCBjb3VudCBvZiBhbGwgaW5kaWNlcyB1c2VkIGJ5IHRoZSBjdXJyZW50bHlcbiAgICAgICAgICogYnVmZmVyZWQgb2JqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faW5kZXhDb3VudCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1ZmZlciBvZiBvYmplY3RzIHRoYXQgYXJlIHlldCB0byBiZSByZW5kZXJlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5EaXNwbGF5T2JqZWN0W119XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9idWZmZXJlZEVsZW1lbnRzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERhdGEgZm9yIHRleHR1cmUgYmF0Y2ggYnVpbGRlciwgaGVscHMgdG8gc2F2ZSBhIGJpdCBvZiBDUFUgb24gYSBwYXNzLlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5CYXNlVGV4dHVyZVtdfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYnVmZmVyZWRUZXh0dXJlcyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBOdW1iZXIgb2YgZWxlbWVudHMgdGhhdCBhcmUgYnVmZmVyZWQgYW5kIGFyZVxuICAgICAgICAgKiB3YWl0aW5nIHRvIGJlIGZsdXNoZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2J1ZmZlclNpemUgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIHNoYWRlciBpcyBnZW5lcmF0ZWQgYnkgYHRoaXMuc2hhZGVyR2VuZXJhdG9yYC5cbiAgICAgICAgICpcbiAgICAgICAgICogSXQgaXMgZ2VuZXJhdGVkIHNwZWNpZmljYWxseSB0byBoYW5kbGUgdGhlIHJlcXVpcmVkXG4gICAgICAgICAqIG51bWJlciBvZiB0ZXh0dXJlcyBiZWluZyBiYXRjaGVkIHRvZ2V0aGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlNoYWRlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc2hhZGVyID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUG9vbCBvZiBgdGhpcy5nZW9tZXRyeUNsYXNzYCBnZW9tZXRyeSBvYmplY3RzXG4gICAgICAgICAqIHRoYXQgc3RvcmUgYnVmZmVycy4gVGhleSBhcmUgdXNlZCB0byBwYXNzIGRhdGFcbiAgICAgICAgICogdG8gdGhlIHNoYWRlciBvbiBlYWNoIGRyYXcgY2FsbC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlc2UgYXJlIG5ldmVyIHJlLWFsbG9jYXRlZCBhZ2FpbiwgdW5sZXNzIGFcbiAgICAgICAgICogY29udGV4dCBjaGFuZ2Ugb2NjdXJzOyBob3dldmVyLCB0aGUgcG9vbCBtYXlcbiAgICAgICAgICogYmUgZXhwYW5kZWQgaWYgcmVxdWlyZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuR2VvbWV0cnlbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHNlZSBQSVhJLkFic3RyYWN0QmF0Y2hSZW5kZXJlci5jb250ZXh0Q2hhbmdlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9wYWNrZWRHZW9tZXRyaWVzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpemUgb2YgYHRoaXMuX3BhY2tlZEdlb21ldHJpZXNgLiBJdCBjYW4gYmUgZXhwYW5kZWRcbiAgICAgICAgICogaWYgbW9yZSB0aGFuIGB0aGlzLl9wYWNrZWRHZW9tZXRyeVBvb2xTaXplYCBmbHVzaGVzXG4gICAgICAgICAqIG9jY3VyIGluIGEgc2luZ2xlIGZyYW1lLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9wYWNrZWRHZW9tZXRyeVBvb2xTaXplID0gMjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbHVzaCBtYXkgb2NjdXIgbXVsdGlwbGUgdGltZXMgaW4gYSBzaW5nbGVcbiAgICAgICAgICogZnJhbWUuIE9uIGlPUyBkZXZpY2VzIG9yIHdoZW5cbiAgICAgICAgICogYHNldHRpbmdzLkNBTl9VUExPQURfU0FNRV9CVUZGRVJgIGlzIGZhbHNlLCB0aGVcbiAgICAgICAgICogYmF0Y2ggcmVuZGVyZXIgZG9lcyBub3QgdXBsb2FkIGRhdGEgdG8gdGhlIHNhbWVcbiAgICAgICAgICogYFdlYkdMQnVmZmVyYCBmb3IgcGVyZm9ybWFuY2UgcmVhc29ucy5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBpcyB0aGUgaW5kZXggaW50byBgcGFja2VkR2VvbWV0cmllc2AgdGhhdCBwb2ludHMgdG9cbiAgICAgICAgICogZ2VvbWV0cnkgaG9sZGluZyB0aGUgbW9zdCByZWNlbnQgYnVmZmVycy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZmx1c2hJZCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBvb2wgb2YgYFZpZXdhYmxlQnVmZmVyYCBvYmplY3RzIHRoYXQgYXJlIHNvcnRlZCBpblxuICAgICAgICAgKiBvcmRlciBvZiBpbmNyZWFzaW5nIHNpemUuIFRoZSBmbHVzaCBtZXRob2QgdXNlc1xuICAgICAgICAgKiB0aGUgYnVmZmVyIHdpdGggdGhlIGxlYXN0IHNpemUgYWJvdmUgdGhlIGFtb3VudFxuICAgICAgICAgKiBpdCByZXF1aXJlcy4gVGhlc2UgYXJlIHVzZWQgZm9yIHBhc3NpbmcgYXR0cmlidXRlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGZpcnN0IGJ1ZmZlciBoYXMgYSBzaXplIG9mIDg7IGVhY2ggc3Vic2VxdWVudFxuICAgICAgICAgKiBidWZmZXIgaGFzIGRvdWJsZSBjYXBhY2l0eSBvZiBpdHMgcHJldmlvdXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVmlld2FibGVCdWZmZXJbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHNlZSBQSVhJLkFic3RyYWN0QmF0Y2hSZW5kZXJlciNnZXRBdHRyaWJ1dGVCdWZmZXJcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2FCdWZmZXJzID0ge30gYXMgYW55O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQb29sIG9mIGBVaW50MTZBcnJheWAgb2JqZWN0cyB0aGF0IGFyZSBzb3J0ZWQgaW5cbiAgICAgICAgICogb3JkZXIgb2YgaW5jcmVhc2luZyBzaXplLiBUaGUgZmx1c2ggbWV0aG9kIHVzZXNcbiAgICAgICAgICogdGhlIGJ1ZmZlciB3aXRoIHRoZSBsZWFzdCBzaXplIGFib3ZlIHRoZSBhbW91bnRcbiAgICAgICAgICogaXQgcmVxdWlyZXMuIFRoZXNlIGFyZSB1c2VkIGZvciBwYXNzaW5nIGluZGljZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBmaXJzdCBidWZmZXIgaGFzIGEgc2l6ZSBvZiAxMjsgZWFjaCBzdWJzZXF1ZW50XG4gICAgICAgICAqIGJ1ZmZlciBoYXMgZG91YmxlIGNhcGFjaXR5IG9mIGl0cyBwcmV2aW91cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7VWludDE2QXJyYXlbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHNlZSBQSVhJLkFic3RyYWN0QmF0Y2hSZW5kZXJlciNnZXRJbmRleEJ1ZmZlclxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faUJ1ZmZlcnMgPSB7fSBhcyBhbnk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1heGltdW0gbnVtYmVyIG9mIHRleHR1cmVzIHRoYXQgY2FuIGJlIHVwbG9hZGVkIHRvXG4gICAgICAgICAqIHRoZSBHUFUgdW5kZXIgdGhlIGN1cnJlbnQgY29udGV4dC4gSXQgaXMgaW5pdGlhbGl6ZWRcbiAgICAgICAgICogcHJvcGVybHkgaW4gYHRoaXMuY29udGV4dENoYW5nZWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHNlZSBQSVhJLkFic3RyYWN0QmF0Y2hSZW5kZXJlciNjb250ZXh0Q2hhbmdlXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5NQVhfVEVYVFVSRVMgPSAxO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIub24oJ3ByZXJlbmRlcicsIHRoaXMub25QcmVyZW5kZXIsIHRoaXMpO1xuICAgICAgICByZW5kZXJlci5ydW5uZXJzLmNvbnRleHRDaGFuZ2UuYWRkKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX2RjSW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9hSW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9pSW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9hdHRyaWJ1dGVCdWZmZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbmRleEJ1ZmZlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RlbXBCb3VuZFRleHR1cmVzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyB0aGUgYGNvbnRleHRDaGFuZ2VgIHNpZ25hbC5cbiAgICAgKlxuICAgICAqIEl0IGNhbGN1bGF0ZXMgYHRoaXMuTUFYX1RFWFRVUkVTYCBhbmQgYWxsb2NhdGluZyB0aGVcbiAgICAgKiBwYWNrZWQtZ2VvbWV0cnkgb2JqZWN0IHBvb2wuXG4gICAgICovXG4gICAgY29udGV4dENoYW5nZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMucmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLlBSRUZFUl9FTlYgPT09IEVOVi5XRUJHTF9MRUdBQ1kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuTUFYX1RFWFRVUkVTID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHN0ZXAgMTogZmlyc3QgY2hlY2sgbWF4IHRleHR1cmVzIHRoZSBHUFUgY2FuIGhhbmRsZS5cbiAgICAgICAgICAgIHRoaXMuTUFYX1RFWFRVUkVTID0gTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgZ2wuZ2V0UGFyYW1ldGVyKGdsLk1BWF9URVhUVVJFX0lNQUdFX1VOSVRTKSxcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5TUFJJVEVfTUFYX1RFWFRVUkVTKTtcblxuICAgICAgICAgICAgLy8gc3RlcCAyOiBjaGVjayB0aGUgbWF4aW11bSBudW1iZXIgb2YgaWYgc3RhdGVtZW50cyB0aGUgc2hhZGVyIGNhbiBoYXZlIHRvby4uXG4gICAgICAgICAgICB0aGlzLk1BWF9URVhUVVJFUyA9IGNoZWNrTWF4SWZTdGF0ZW1lbnRzSW5TaGFkZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5NQVhfVEVYVFVSRVMsIGdsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3NoYWRlciA9IHRoaXMuc2hhZGVyR2VuZXJhdG9yLmdlbmVyYXRlU2hhZGVyKHRoaXMuTUFYX1RFWFRVUkVTKTtcblxuICAgICAgICAvLyB3ZSB1c2UgdGhlIHNlY29uZCBzaGFkZXIgYXMgdGhlIGZpcnN0IG9uZSBkZXBlbmRpbmcgb24geW91ciBicm93c2VyXG4gICAgICAgIC8vIG1heSBvbWl0IGFUZXh0dXJlSWQgYXMgaXQgaXMgbm90IHVzZWQgYnkgdGhlIHNoYWRlciBzbyBpcyBvcHRpbWl6ZWQgb3V0LlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX3BhY2tlZEdlb21ldHJ5UG9vbFNpemU7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuICAgICAgICAgICAgdGhpcy5fcGFja2VkR2VvbWV0cmllc1tpXSA9IG5ldyAodGhpcy5nZW9tZXRyeUNsYXNzKSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbml0Rmx1c2hCdWZmZXJzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFrZXMgc3VyZSB0aGF0IHN0YXRpYyBhbmQgZHluYW1pYyBmbHVzaCBwb29sZWQgb2JqZWN0cyBoYXZlIGNvcnJlY3QgZGltZW5zaW9uc1xuICAgICAqL1xuICAgIGluaXRGbHVzaEJ1ZmZlcnMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgX2RyYXdDYWxsUG9vbCxcbiAgICAgICAgICAgIF90ZXh0dXJlQXJyYXlQb29sLFxuICAgICAgICB9ID0gQWJzdHJhY3RCYXRjaFJlbmRlcmVyO1xuICAgICAgICAvLyBtYXggZHJhdyBjYWxsc1xuICAgICAgICBjb25zdCBNQVhfU1BSSVRFUyA9IHRoaXMuc2l6ZSAvIDQ7XG4gICAgICAgIC8vIG1heCB0ZXh0dXJlIGFycmF5c1xuICAgICAgICBjb25zdCBNQVhfVEEgPSBNYXRoLmZsb29yKE1BWF9TUFJJVEVTIC8gdGhpcy5NQVhfVEVYVFVSRVMpICsgMTtcblxuICAgICAgICB3aGlsZSAoX2RyYXdDYWxsUG9vbC5sZW5ndGggPCBNQVhfU1BSSVRFUylcbiAgICAgICAge1xuICAgICAgICAgICAgX2RyYXdDYWxsUG9vbC5wdXNoKG5ldyBCYXRjaERyYXdDYWxsKCkpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChfdGV4dHVyZUFycmF5UG9vbC5sZW5ndGggPCBNQVhfVEEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIF90ZXh0dXJlQXJyYXlQb29sLnB1c2gobmV3IEJhdGNoVGV4dHVyZUFycmF5KCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5NQVhfVEVYVFVSRVM7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fdGVtcEJvdW5kVGV4dHVyZXNbaV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyB0aGUgYHByZXJlbmRlcmAgc2lnbmFsLlxuICAgICAqXG4gICAgICogSXQgZW5zdXJlcyB0aGF0IGZsdXNoZXMgc3RhcnQgZnJvbSB0aGUgZmlyc3QgZ2VvbWV0cnlcbiAgICAgKiBvYmplY3QgYWdhaW4uXG4gICAgICovXG4gICAgb25QcmVyZW5kZXIoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fZmx1c2hJZCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVmZmVycyB0aGUgXCJiYXRjaGFibGVcIiBvYmplY3QuIEl0IG5lZWQgbm90IGJlIHJlbmRlcmVkXG4gICAgICogaW1tZWRpYXRlbHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gZWxlbWVudCAtIHRoZSBlbGVtZW50IHRvIHJlbmRlciB3aGVuXG4gICAgICogICAgdXNpbmcgdGhpcyByZW5kZXJlclxuICAgICAqL1xuICAgIHJlbmRlcihlbGVtZW50OiBJQmF0Y2hhYmxlRWxlbWVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghZWxlbWVudC5fdGV4dHVyZS52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX3ZlcnRleENvdW50ICsgKGVsZW1lbnQudmVydGV4RGF0YS5sZW5ndGggLyAyKSA+IHRoaXMuc2l6ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdmVydGV4Q291bnQgKz0gZWxlbWVudC52ZXJ0ZXhEYXRhLmxlbmd0aCAvIDI7XG4gICAgICAgIHRoaXMuX2luZGV4Q291bnQgKz0gZWxlbWVudC5pbmRpY2VzLmxlbmd0aDtcbiAgICAgICAgdGhpcy5fYnVmZmVyZWRUZXh0dXJlc1t0aGlzLl9idWZmZXJTaXplXSA9IGVsZW1lbnQuX3RleHR1cmUuYmFzZVRleHR1cmU7XG4gICAgICAgIHRoaXMuX2J1ZmZlcmVkRWxlbWVudHNbdGhpcy5fYnVmZmVyU2l6ZSsrXSA9IGVsZW1lbnQ7XG4gICAgfVxuXG4gICAgYnVpbGRUZXh0dXJlc0FuZERyYXdDYWxscygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBfYnVmZmVyZWRUZXh0dXJlczogdGV4dHVyZXMsXG4gICAgICAgICAgICBNQVhfVEVYVFVSRVMsXG4gICAgICAgIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB0ZXh0dXJlQXJyYXlzID0gQWJzdHJhY3RCYXRjaFJlbmRlcmVyLl90ZXh0dXJlQXJyYXlQb29sO1xuICAgICAgICBjb25zdCBiYXRjaCA9IHRoaXMucmVuZGVyZXIuYmF0Y2g7XG4gICAgICAgIGNvbnN0IGJvdW5kVGV4dHVyZXMgPSB0aGlzLl90ZW1wQm91bmRUZXh0dXJlcztcbiAgICAgICAgY29uc3QgdG91Y2ggPSB0aGlzLnJlbmRlcmVyLnRleHR1cmVHQy5jb3VudDtcblxuICAgICAgICBsZXQgVElDSyA9ICsrQmFzZVRleHR1cmUuX2dsb2JhbEJhdGNoO1xuICAgICAgICBsZXQgY291bnRUZXhBcnJheXMgPSAwO1xuICAgICAgICBsZXQgdGV4QXJyYXkgPSB0ZXh0dXJlQXJyYXlzWzBdO1xuICAgICAgICBsZXQgc3RhcnQgPSAwO1xuXG4gICAgICAgIGJhdGNoLmNvcHlCb3VuZFRleHR1cmVzKGJvdW5kVGV4dHVyZXMsIE1BWF9URVhUVVJFUyk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9idWZmZXJTaXplOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRleCA9IHRleHR1cmVzW2ldO1xuXG4gICAgICAgICAgICB0ZXh0dXJlc1tpXSA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGV4Ll9iYXRjaEVuYWJsZWQgPT09IFRJQ0spXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0ZXhBcnJheS5jb3VudCA+PSBNQVhfVEVYVFVSRVMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmF0Y2guYm91bmRBcnJheSh0ZXhBcnJheSwgYm91bmRUZXh0dXJlcywgVElDSywgTUFYX1RFWFRVUkVTKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkRHJhd0NhbGxzKHRleEFycmF5LCBzdGFydCwgaSk7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBpO1xuICAgICAgICAgICAgICAgIHRleEFycmF5ID0gdGV4dHVyZUFycmF5c1srK2NvdW50VGV4QXJyYXlzXTtcbiAgICAgICAgICAgICAgICArK1RJQ0s7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRleC5fYmF0Y2hFbmFibGVkID0gVElDSztcbiAgICAgICAgICAgIHRleC50b3VjaGVkID0gdG91Y2g7XG4gICAgICAgICAgICB0ZXhBcnJheS5lbGVtZW50c1t0ZXhBcnJheS5jb3VudCsrXSA9IHRleDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0ZXhBcnJheS5jb3VudCA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJhdGNoLmJvdW5kQXJyYXkodGV4QXJyYXksIGJvdW5kVGV4dHVyZXMsIFRJQ0ssIE1BWF9URVhUVVJFUyk7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRHJhd0NhbGxzKHRleEFycmF5LCBzdGFydCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICArK2NvdW50VGV4QXJyYXlzO1xuICAgICAgICAgICAgKytUSUNLO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYW4tdXBcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvdW5kVGV4dHVyZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJvdW5kVGV4dHVyZXNbaV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIEJhc2VUZXh0dXJlLl9nbG9iYWxCYXRjaCA9IFRJQ0s7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUG9wdWxhdGluZyBkcmF3Y2FsbHMgZm9yIHJlbmRlcmluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkJhdGNoVGV4dHVyZUFycmF5fSB0ZXhBcnJheVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBmaW5pc2hcbiAgICAgKi9cbiAgICBidWlsZERyYXdDYWxscyh0ZXhBcnJheTogQmF0Y2hUZXh0dXJlQXJyYXksIHN0YXJ0OiBudW1iZXIsIGZpbmlzaDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgX2J1ZmZlcmVkRWxlbWVudHM6IGVsZW1lbnRzLFxuICAgICAgICAgICAgX2F0dHJpYnV0ZUJ1ZmZlcixcbiAgICAgICAgICAgIF9pbmRleEJ1ZmZlcixcbiAgICAgICAgICAgIHZlcnRleFNpemUsXG4gICAgICAgIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBkcmF3Q2FsbHMgPSBBYnN0cmFjdEJhdGNoUmVuZGVyZXIuX2RyYXdDYWxsUG9vbDtcblxuICAgICAgICBsZXQgZGNJbmRleCA9IHRoaXMuX2RjSW5kZXg7XG4gICAgICAgIGxldCBhSW5kZXggPSB0aGlzLl9hSW5kZXg7XG4gICAgICAgIGxldCBpSW5kZXggPSB0aGlzLl9pSW5kZXg7XG5cbiAgICAgICAgbGV0IGRyYXdDYWxsID0gZHJhd0NhbGxzW2RjSW5kZXhdO1xuXG4gICAgICAgIGRyYXdDYWxsLnN0YXJ0ID0gdGhpcy5faUluZGV4O1xuICAgICAgICBkcmF3Q2FsbC50ZXhBcnJheSA9IHRleEFycmF5O1xuXG4gICAgICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGZpbmlzaDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBzcHJpdGUgPSBlbGVtZW50c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHRleCA9IHNwcml0ZS5fdGV4dHVyZS5iYXNlVGV4dHVyZTtcbiAgICAgICAgICAgIGNvbnN0IHNwcml0ZUJsZW5kTW9kZSA9IHByZW11bHRpcGx5QmxlbmRNb2RlW1xuICAgICAgICAgICAgICAgIHRleC5hbHBoYU1vZGUgPyAxIDogMF1bc3ByaXRlLmJsZW5kTW9kZV07XG5cbiAgICAgICAgICAgIGVsZW1lbnRzW2ldID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHN0YXJ0IDwgaSAmJiBkcmF3Q2FsbC5ibGVuZCAhPT0gc3ByaXRlQmxlbmRNb2RlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRyYXdDYWxsLnNpemUgPSBpSW5kZXggLSBkcmF3Q2FsbC5zdGFydDtcbiAgICAgICAgICAgICAgICBzdGFydCA9IGk7XG4gICAgICAgICAgICAgICAgZHJhd0NhbGwgPSBkcmF3Q2FsbHNbKytkY0luZGV4XTtcbiAgICAgICAgICAgICAgICBkcmF3Q2FsbC50ZXhBcnJheSA9IHRleEFycmF5O1xuICAgICAgICAgICAgICAgIGRyYXdDYWxsLnN0YXJ0ID0gaUluZGV4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnBhY2tJbnRlcmxlYXZlZEdlb21ldHJ5KHNwcml0ZSwgX2F0dHJpYnV0ZUJ1ZmZlciwgX2luZGV4QnVmZmVyLCBhSW5kZXgsIGlJbmRleCk7XG4gICAgICAgICAgICBhSW5kZXggKz0gc3ByaXRlLnZlcnRleERhdGEubGVuZ3RoIC8gMiAqIHZlcnRleFNpemU7XG4gICAgICAgICAgICBpSW5kZXggKz0gc3ByaXRlLmluZGljZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICBkcmF3Q2FsbC5ibGVuZCA9IHNwcml0ZUJsZW5kTW9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdGFydCA8IGZpbmlzaClcbiAgICAgICAge1xuICAgICAgICAgICAgZHJhd0NhbGwuc2l6ZSA9IGlJbmRleCAtIGRyYXdDYWxsLnN0YXJ0O1xuICAgICAgICAgICAgKytkY0luZGV4O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZGNJbmRleCA9IGRjSW5kZXg7XG4gICAgICAgIHRoaXMuX2FJbmRleCA9IGFJbmRleDtcbiAgICAgICAgdGhpcy5faUluZGV4ID0gaUluZGV4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJpbmQgdGV4dHVyZXMgZm9yIGN1cnJlbnQgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmF0Y2hUZXh0dXJlQXJyYXl9IHRleEFycmF5XG4gICAgICovXG4gICAgYmluZEFuZENsZWFyVGV4QXJyYXkodGV4QXJyYXk6IEJhdGNoVGV4dHVyZUFycmF5KTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZVN5c3RlbSA9IHRoaXMucmVuZGVyZXIudGV4dHVyZTtcblxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRleEFycmF5LmNvdW50OyBqKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRleHR1cmVTeXN0ZW0uYmluZCh0ZXhBcnJheS5lbGVtZW50c1tqXSwgdGV4QXJyYXkuaWRzW2pdKTtcbiAgICAgICAgICAgIHRleEFycmF5LmVsZW1lbnRzW2pdID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0ZXhBcnJheS5jb3VudCA9IDA7XG4gICAgfVxuXG4gICAgdXBkYXRlR2VvbWV0cnkoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgX3BhY2tlZEdlb21ldHJpZXM6IHBhY2tlZEdlb21ldHJpZXMsXG4gICAgICAgICAgICBfYXR0cmlidXRlQnVmZmVyOiBhdHRyaWJ1dGVCdWZmZXIsXG4gICAgICAgICAgICBfaW5kZXhCdWZmZXI6IGluZGV4QnVmZmVyLFxuICAgICAgICB9ID0gdGhpcztcblxuICAgICAgICBpZiAoIXNldHRpbmdzLkNBTl9VUExPQURfU0FNRV9CVUZGRVIpXG4gICAgICAgIHsgLyogVXN1YWxseSBvbiBpT1MgZGV2aWNlcywgd2hlcmUgdGhlIGJyb3dzZXIgZG9lc24ndFxuICAgICAgICAgICAgbGlrZSB1cGxvYWRzIHRvIHRoZSBzYW1lIGJ1ZmZlciBpbiBhIHNpbmdsZSBmcmFtZS4gKi9cbiAgICAgICAgICAgIGlmICh0aGlzLl9wYWNrZWRHZW9tZXRyeVBvb2xTaXplIDw9IHRoaXMuX2ZsdXNoSWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFja2VkR2VvbWV0cnlQb29sU2l6ZSsrO1xuICAgICAgICAgICAgICAgIHBhY2tlZEdlb21ldHJpZXNbdGhpcy5fZmx1c2hJZF0gPSBuZXcgKHRoaXMuZ2VvbWV0cnlDbGFzcykoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGFja2VkR2VvbWV0cmllc1t0aGlzLl9mbHVzaElkXS5fYnVmZmVyLnVwZGF0ZShhdHRyaWJ1dGVCdWZmZXIucmF3QmluYXJ5RGF0YSk7XG4gICAgICAgICAgICBwYWNrZWRHZW9tZXRyaWVzW3RoaXMuX2ZsdXNoSWRdLl9pbmRleEJ1ZmZlci51cGRhdGUoaW5kZXhCdWZmZXIpO1xuXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmdlb21ldHJ5LmJpbmQocGFja2VkR2VvbWV0cmllc1t0aGlzLl9mbHVzaElkXSk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmdlb21ldHJ5LnVwZGF0ZUJ1ZmZlcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2ZsdXNoSWQrKztcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGxldHMgdXNlIHRoZSBmYXN0ZXIgb3B0aW9uLCBhbHdheXMgdXNlIGJ1ZmZlciBudW1iZXIgMFxuICAgICAgICAgICAgcGFja2VkR2VvbWV0cmllc1t0aGlzLl9mbHVzaElkXS5fYnVmZmVyLnVwZGF0ZShhdHRyaWJ1dGVCdWZmZXIucmF3QmluYXJ5RGF0YSk7XG4gICAgICAgICAgICBwYWNrZWRHZW9tZXRyaWVzW3RoaXMuX2ZsdXNoSWRdLl9pbmRleEJ1ZmZlci51cGRhdGUoaW5kZXhCdWZmZXIpO1xuXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmdlb21ldHJ5LnVwZGF0ZUJ1ZmZlcnMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXdCYXRjaGVzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGRjQ291bnQgPSB0aGlzLl9kY0luZGV4O1xuICAgICAgICBjb25zdCB7IGdsLCBzdGF0ZTogc3RhdGVTeXN0ZW0gfSA9IHRoaXMucmVuZGVyZXI7XG4gICAgICAgIGNvbnN0IGRyYXdDYWxscyA9IEFic3RyYWN0QmF0Y2hSZW5kZXJlci5fZHJhd0NhbGxQb29sO1xuXG4gICAgICAgIGxldCBjdXJUZXhBcnJheSA9IG51bGw7XG5cbiAgICAgICAgLy8gVXBsb2FkIHRleHR1cmVzIGFuZCBkbyB0aGUgZHJhdyBjYWxsc1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRjQ291bnQ7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeyB0ZXhBcnJheSwgdHlwZSwgc2l6ZSwgc3RhcnQsIGJsZW5kIH0gPSBkcmF3Q2FsbHNbaV07XG5cbiAgICAgICAgICAgIGlmIChjdXJUZXhBcnJheSAhPT0gdGV4QXJyYXkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY3VyVGV4QXJyYXkgPSB0ZXhBcnJheTtcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRBbmRDbGVhclRleEFycmF5KHRleEFycmF5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ibGVuZE1vZGUgPSBibGVuZDtcbiAgICAgICAgICAgIHN0YXRlU3lzdGVtLnNldCh0aGlzLnN0YXRlKTtcbiAgICAgICAgICAgIGdsLmRyYXdFbGVtZW50cyh0eXBlLCBzaXplLCBnbC5VTlNJR05FRF9TSE9SVCwgc3RhcnQgKiAyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgdGhlIGNvbnRlbnQgX25vd18gYW5kIGVtcHRpZXMgdGhlIGN1cnJlbnQgYmF0Y2guXG4gICAgICovXG4gICAgZmx1c2goKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3ZlcnRleENvdW50ID09PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9hdHRyaWJ1dGVCdWZmZXIgPSB0aGlzLmdldEF0dHJpYnV0ZUJ1ZmZlcih0aGlzLl92ZXJ0ZXhDb3VudCk7XG4gICAgICAgIHRoaXMuX2luZGV4QnVmZmVyID0gdGhpcy5nZXRJbmRleEJ1ZmZlcih0aGlzLl9pbmRleENvdW50KTtcbiAgICAgICAgdGhpcy5fYUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5faUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fZGNJbmRleCA9IDA7XG5cbiAgICAgICAgdGhpcy5idWlsZFRleHR1cmVzQW5kRHJhd0NhbGxzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlR2VvbWV0cnkoKTtcbiAgICAgICAgdGhpcy5kcmF3QmF0Y2hlcygpO1xuXG4gICAgICAgIC8vIHJlc2V0IGVsZW1lbnRzIGJ1ZmZlciBmb3IgdGhlIG5leHQgZmx1c2hcbiAgICAgICAgdGhpcy5fYnVmZmVyU2l6ZSA9IDA7XG4gICAgICAgIHRoaXMuX3ZlcnRleENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5faW5kZXhDb3VudCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgbmV3IHNwcml0ZSBiYXRjaC5cbiAgICAgKi9cbiAgICBzdGFydCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnN0YXRlLnNldCh0aGlzLnN0YXRlKTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNoYWRlci5iaW5kKHRoaXMuX3NoYWRlcik7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLkNBTl9VUExPQURfU0FNRV9CVUZGRVIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGJpbmQgYnVmZmVyICMwLCB3ZSBkb24ndCBuZWVkIG90aGVyc1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5nZW9tZXRyeS5iaW5kKHRoaXMuX3BhY2tlZEdlb21ldHJpZXNbdGhpcy5fZmx1c2hJZF0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcHMgYW5kIGZsdXNoZXMgdGhlIGN1cnJlbnQgYmF0Y2guXG4gICAgICovXG4gICAgc3RvcCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhpcyBgQWJzdHJhY3RCYXRjaFJlbmRlcmVyYC4gSXQgY2Fubm90IGJlIHVzZWQgYWdhaW4uXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX3BhY2tlZEdlb21ldHJ5UG9vbFNpemU7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BhY2tlZEdlb21ldHJpZXNbaV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFja2VkR2VvbWV0cmllc1tpXS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlbmRlcmVyLm9mZigncHJlcmVuZGVyJywgdGhpcy5vblByZXJlbmRlciwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5fYUJ1ZmZlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pQnVmZmVycyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BhY2tlZEdlb21ldHJpZXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9hdHRyaWJ1dGVCdWZmZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbmRleEJ1ZmZlciA9IG51bGw7XG5cbiAgICAgICAgaWYgKHRoaXMuX3NoYWRlcilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fc2hhZGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuX3NoYWRlciA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyBhbiBhdHRyaWJ1dGUgYnVmZmVyIGZyb20gYHRoaXMuX2FCdWZmZXJzYCB0aGF0XG4gICAgICogY2FuIGhvbGQgYXRsZWFzdCBgc2l6ZWAgZmxvYXRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBtaW5pbXVtIGNhcGFjaXR5IHJlcXVpcmVkXG4gICAgICogQHJldHVybiB7Vmlld2FibGVCdWZmZXJ9IC0gYnVmZmVyIHRoYW4gY2FuIGhvbGQgYXRsZWFzdCBgc2l6ZWAgZmxvYXRzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBnZXRBdHRyaWJ1dGVCdWZmZXIoc2l6ZTogbnVtYmVyKTogVmlld2FibGVCdWZmZXJcbiAgICB7XG4gICAgICAgIC8vIDggdmVydGljZXMgaXMgZW5vdWdoIGZvciAyIHF1YWRzXG4gICAgICAgIGNvbnN0IHJvdW5kZWRQMiA9IG5leHRQb3cyKE1hdGguY2VpbChzaXplIC8gOCkpO1xuICAgICAgICBjb25zdCByb3VuZGVkU2l6ZUluZGV4ID0gbG9nMihyb3VuZGVkUDIpO1xuICAgICAgICBjb25zdCByb3VuZGVkU2l6ZSA9IHJvdW5kZWRQMiAqIDg7XG5cbiAgICAgICAgaWYgKHRoaXMuX2FCdWZmZXJzLmxlbmd0aCA8PSByb3VuZGVkU2l6ZUluZGV4KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9pQnVmZmVycy5sZW5ndGggPSByb3VuZGVkU2l6ZUluZGV4ICsgMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBidWZmZXIgPSB0aGlzLl9hQnVmZmVyc1tyb3VuZGVkU2l6ZV07XG5cbiAgICAgICAgaWYgKCFidWZmZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2FCdWZmZXJzW3JvdW5kZWRTaXplXSA9IGJ1ZmZlciA9IG5ldyBWaWV3YWJsZUJ1ZmZlcihyb3VuZGVkU2l6ZSAqIHRoaXMudmVydGV4U2l6ZSAqIDQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaGVzIGFuIGluZGV4IGJ1ZmZlciBmcm9tIGB0aGlzLl9pQnVmZmVyc2AgdGhhdCBjYW5cbiAgICAgKiBoYXZlIGF0IGxlYXN0IGBzaXplYCBjYXBhY2l0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzaXplIC0gbWluaW11bSByZXF1aXJlZCBjYXBhY2l0eVxuICAgICAqIEByZXR1cm4ge1VpbnQxNkFycmF5fSAtIGJ1ZmZlciB0aGF0IGNhbiBmaXQgYHNpemVgXG4gICAgICogICAgaW5kaWNlcy5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGdldEluZGV4QnVmZmVyKHNpemU6IG51bWJlcik6IFVpbnQxNkFycmF5XG4gICAge1xuICAgICAgICAvLyAxMiBpbmRpY2VzIGlzIGVub3VnaCBmb3IgMiBxdWFkc1xuICAgICAgICBjb25zdCByb3VuZGVkUDIgPSBuZXh0UG93MihNYXRoLmNlaWwoc2l6ZSAvIDEyKSk7XG4gICAgICAgIGNvbnN0IHJvdW5kZWRTaXplSW5kZXggPSBsb2cyKHJvdW5kZWRQMik7XG4gICAgICAgIGNvbnN0IHJvdW5kZWRTaXplID0gcm91bmRlZFAyICogMTI7XG5cbiAgICAgICAgaWYgKHRoaXMuX2lCdWZmZXJzLmxlbmd0aCA8PSByb3VuZGVkU2l6ZUluZGV4KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9pQnVmZmVycy5sZW5ndGggPSByb3VuZGVkU2l6ZUluZGV4ICsgMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBidWZmZXIgPSB0aGlzLl9pQnVmZmVyc1tyb3VuZGVkU2l6ZUluZGV4XTtcblxuICAgICAgICBpZiAoIWJ1ZmZlcilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5faUJ1ZmZlcnNbcm91bmRlZFNpemVJbmRleF0gPSBidWZmZXIgPSBuZXcgVWludDE2QXJyYXkocm91bmRlZFNpemUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyB0aGUgZm91ciBiYXRjaGluZyBwYXJhbWV0ZXJzIG9mIGBlbGVtZW50YCwgaW50ZXJsZWF2ZXNcbiAgICAgKiBhbmQgcHVzaGVzIHRoZW0gaW50byB0aGUgYmF0Y2hpbmcgYXR0cmlidXRlL2luZGV4IGJ1ZmZlcnMgZ2l2ZW4uXG4gICAgICpcbiAgICAgKiBJdCB1c2VzIHRoZXNlIHByb3BlcnRpZXM6IGB2ZXJ0ZXhEYXRhYCBgdXZzYCwgYHRleHR1cmVJZGAgYW5kXG4gICAgICogYGluZGljaWVzYC4gSXQgYWxzbyB1c2VzIHRoZSBcInRpbnRcIiBvZiB0aGUgYmFzZS10ZXh0dXJlLCBpZlxuICAgICAqIHByZXNlbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuU3ByaXRlfSBlbGVtZW50IC0gZWxlbWVudCBiZWluZyByZW5kZXJlZFxuICAgICAqIEBwYXJhbSB7UElYSS5WaWV3YWJsZUJ1ZmZlcn0gYXR0cmlidXRlQnVmZmVyIC0gYXR0cmlidXRlIGJ1ZmZlci5cbiAgICAgKiBAcGFyYW0ge1VpbnQxNkFycmF5fSBpbmRleEJ1ZmZlciAtIGluZGV4IGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhSW5kZXggLSBudW1iZXIgb2YgZmxvYXRzIGFscmVhZHkgaW4gdGhlIGF0dHJpYnV0ZSBidWZmZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaUluZGV4IC0gbnVtYmVyIG9mIGluZGljZXMgYWxyZWFkeSBpbiBgaW5kZXhCdWZmZXJgXG4gICAgICovXG4gICAgcGFja0ludGVybGVhdmVkR2VvbWV0cnkoZWxlbWVudDogSUJhdGNoYWJsZUVsZW1lbnQsIGF0dHJpYnV0ZUJ1ZmZlcjogVmlld2FibGVCdWZmZXIsIGluZGV4QnVmZmVyOiBVaW50MTZBcnJheSxcbiAgICAgICAgYUluZGV4OiBudW1iZXIsIGlJbmRleDogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgdWludDMyVmlldyxcbiAgICAgICAgICAgIGZsb2F0MzJWaWV3LFxuICAgICAgICB9ID0gYXR0cmlidXRlQnVmZmVyO1xuXG4gICAgICAgIGNvbnN0IHBhY2tlZFZlcnRpY2VzID0gYUluZGV4IC8gdGhpcy52ZXJ0ZXhTaXplO1xuICAgICAgICBjb25zdCB1dnMgPSBlbGVtZW50LnV2cztcbiAgICAgICAgY29uc3QgaW5kaWNpZXMgPSBlbGVtZW50LmluZGljZXM7XG4gICAgICAgIGNvbnN0IHZlcnRleERhdGEgPSBlbGVtZW50LnZlcnRleERhdGE7XG4gICAgICAgIGNvbnN0IHRleHR1cmVJZCA9IGVsZW1lbnQuX3RleHR1cmUuYmFzZVRleHR1cmUuX2JhdGNoTG9jYXRpb247XG5cbiAgICAgICAgY29uc3QgYWxwaGEgPSBNYXRoLm1pbihlbGVtZW50LndvcmxkQWxwaGEsIDEuMCk7XG4gICAgICAgIGNvbnN0IGFyZ2IgPSAoYWxwaGEgPCAxLjBcbiAgICAgICAgICAgICYmIGVsZW1lbnQuX3RleHR1cmUuYmFzZVRleHR1cmUuYWxwaGFNb2RlKVxuICAgICAgICAgICAgPyBwcmVtdWx0aXBseVRpbnQoZWxlbWVudC5fdGludFJHQiwgYWxwaGEpXG4gICAgICAgICAgICA6IGVsZW1lbnQuX3RpbnRSR0IgKyAoYWxwaGEgKiAyNTUgPDwgMjQpO1xuXG4gICAgICAgIC8vIGxldHMgbm90IHdvcnJ5IGFib3V0IHRpbnQhIGZvciBub3cuLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRleERhdGEubGVuZ3RoOyBpICs9IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZsb2F0MzJWaWV3W2FJbmRleCsrXSA9IHZlcnRleERhdGFbaV07XG4gICAgICAgICAgICBmbG9hdDMyVmlld1thSW5kZXgrK10gPSB2ZXJ0ZXhEYXRhW2kgKyAxXTtcbiAgICAgICAgICAgIGZsb2F0MzJWaWV3W2FJbmRleCsrXSA9IHV2c1tpXTtcbiAgICAgICAgICAgIGZsb2F0MzJWaWV3W2FJbmRleCsrXSA9IHV2c1tpICsgMV07XG4gICAgICAgICAgICB1aW50MzJWaWV3W2FJbmRleCsrXSA9IGFyZ2I7XG4gICAgICAgICAgICBmbG9hdDMyVmlld1thSW5kZXgrK10gPSB0ZXh0dXJlSWQ7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluZGljaWVzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpbmRleEJ1ZmZlcltpSW5kZXgrK10gPSBwYWNrZWRWZXJ0aWNlcyArIGluZGljaWVzW2ldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUG9vbCBvZiBgQmF0Y2hEcmF3Q2FsbGAgb2JqZWN0cyB0aGF0IGBmbHVzaGAgdXNlZFxuICAgICAqIHRvIGNyZWF0ZSBcImJhdGNoZXNcIiBvZiB0aGUgb2JqZWN0cyBiZWluZyByZW5kZXJlZC5cbiAgICAgKlxuICAgICAqIFRoZXNlIGFyZSBuZXZlciByZS1hbGxvY2F0ZWQgYWdhaW4uXG4gICAgICogU2hhcmVkIGJldHdlZW4gYWxsIGJhdGNoIHJlbmRlcmVycyBiZWNhdXNlIGl0IGNhbiBiZSBvbmx5IG9uZSBcImZsdXNoXCIgd29ya2luZyBhdCB0aGUgbW9tZW50LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge1BJWEkuQmF0Y2hEcmF3Q2FsbFtdfVxuICAgICAqL1xuICAgIHN0YXRpYyBfZHJhd0NhbGxQb29sOiBBcnJheTxCYXRjaERyYXdDYWxsPiA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogUG9vbCBvZiBgQmF0Y2hEcmF3Q2FsbGAgb2JqZWN0cyB0aGF0IGBmbHVzaGAgdXNlZFxuICAgICAqIHRvIGNyZWF0ZSBcImJhdGNoZXNcIiBvZiB0aGUgb2JqZWN0cyBiZWluZyByZW5kZXJlZC5cbiAgICAgKlxuICAgICAqIFRoZXNlIGFyZSBuZXZlciByZS1hbGxvY2F0ZWQgYWdhaW4uXG4gICAgICogU2hhcmVkIGJldHdlZW4gYWxsIGJhdGNoIHJlbmRlcmVycyBiZWNhdXNlIGl0IGNhbiBiZSBvbmx5IG9uZSBcImZsdXNoXCIgd29ya2luZyBhdCB0aGUgbW9tZW50LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge1BJWEkuQmF0Y2hUZXh0dXJlQXJyYXlbXX1cbiAgICAgKi9cbiAgICBzdGF0aWMgX3RleHR1cmVBcnJheVBvb2w6IEFycmF5PEJhdGNoVGV4dHVyZUFycmF5PiA9IFtdO1xufVxuIiwgImltcG9ydCB7IFNoYWRlciB9IGZyb20gJy4uL3NoYWRlci9TaGFkZXInO1xuaW1wb3J0IHsgUHJvZ3JhbSB9IGZyb20gJy4uL3NoYWRlci9Qcm9ncmFtJztcbmltcG9ydCB7IFVuaWZvcm1Hcm91cCB9IGZyb20gJy4uL3NoYWRlci9Vbmlmb3JtR3JvdXAnO1xuaW1wb3J0IHsgTWF0cml4IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogSGVscGVyIHRoYXQgZ2VuZXJhdGVzIGJhdGNoaW5nIG11bHRpLXRleHR1cmUgc2hhZGVyLiBVc2UgaXQgd2l0aCB5b3VyIG5ldyBCYXRjaFJlbmRlcmVyXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQmF0Y2hTaGFkZXJHZW5lcmF0b3JcbntcbiAgICBwdWJsaWMgdmVydGV4U3JjOiBzdHJpbmc7XG4gICAgcHVibGljIGZyYWdUZW1wbGF0ZTogc3RyaW5nO1xuICAgIHByb2dyYW1DYWNoZToge1trZXk6IG51bWJlcl06IFByb2dyYW19O1xuICAgIGRlZmF1bHRHcm91cENhY2hlOiB7W2tleTogbnVtYmVyXTogVW5pZm9ybUdyb3VwfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmVydGV4U3JjIC0gVmVydGV4IHNoYWRlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmcmFnVGVtcGxhdGUgLSBGcmFnbWVudCBzaGFkZXIgdGVtcGxhdGVcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih2ZXJ0ZXhTcmM6IHN0cmluZywgZnJhZ1RlbXBsYXRlOiBzdHJpbmcpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIHRoZSB2ZXJ0ZXggc2hhZGVyIHNvdXJjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52ZXJ0ZXhTcmMgPSB2ZXJ0ZXhTcmM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZmVyZW5jZSB0byB0aGUgZnJhZ2VtZW50IHNoYWRlciB0ZW1wbGF0ZS4gTXVzdCBjb250YWluIFwiJWNvdW50JVwiIGFuZCBcIiVmb3Jsb29wJVwiLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZyYWdUZW1wbGF0ZSA9IGZyYWdUZW1wbGF0ZTtcblxuICAgICAgICB0aGlzLnByb2dyYW1DYWNoZSA9IHt9O1xuICAgICAgICB0aGlzLmRlZmF1bHRHcm91cENhY2hlID0ge307XG5cbiAgICAgICAgaWYgKGZyYWdUZW1wbGF0ZS5pbmRleE9mKCclY291bnQlJykgPCAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZyYWdtZW50IHRlbXBsYXRlIG11c3QgY29udGFpbiBcIiVjb3VudCVcIi4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmcmFnVGVtcGxhdGUuaW5kZXhPZignJWZvcmxvb3AlJykgPCAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZyYWdtZW50IHRlbXBsYXRlIG11c3QgY29udGFpbiBcIiVmb3Jsb29wJVwiLicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVTaGFkZXIobWF4VGV4dHVyZXM6IG51bWJlcik6IFNoYWRlclxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLnByb2dyYW1DYWNoZVttYXhUZXh0dXJlc10pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHNhbXBsZVZhbHVlcyA9IG5ldyBJbnQzMkFycmF5KG1heFRleHR1cmVzKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhUZXh0dXJlczsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNhbXBsZVZhbHVlc1tpXSA9IGk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdEdyb3VwQ2FjaGVbbWF4VGV4dHVyZXNdID0gVW5pZm9ybUdyb3VwLmZyb20oeyB1U2FtcGxlcnM6IHNhbXBsZVZhbHVlcyB9LCB0cnVlKTtcblxuICAgICAgICAgICAgbGV0IGZyYWdtZW50U3JjID0gdGhpcy5mcmFnVGVtcGxhdGU7XG5cbiAgICAgICAgICAgIGZyYWdtZW50U3JjID0gZnJhZ21lbnRTcmMucmVwbGFjZSgvJWNvdW50JS9naSwgYCR7bWF4VGV4dHVyZXN9YCk7XG4gICAgICAgICAgICBmcmFnbWVudFNyYyA9IGZyYWdtZW50U3JjLnJlcGxhY2UoLyVmb3Jsb29wJS9naSwgdGhpcy5nZW5lcmF0ZVNhbXBsZVNyYyhtYXhUZXh0dXJlcykpO1xuXG4gICAgICAgICAgICB0aGlzLnByb2dyYW1DYWNoZVttYXhUZXh0dXJlc10gPSBuZXcgUHJvZ3JhbSh0aGlzLnZlcnRleFNyYywgZnJhZ21lbnRTcmMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSB7XG4gICAgICAgICAgICB0aW50OiBuZXcgRmxvYXQzMkFycmF5KFsxLCAxLCAxLCAxXSksXG4gICAgICAgICAgICB0cmFuc2xhdGlvbk1hdHJpeDogbmV3IE1hdHJpeCgpLFxuICAgICAgICAgICAgZGVmYXVsdDogdGhpcy5kZWZhdWx0R3JvdXBDYWNoZVttYXhUZXh0dXJlc10sXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5ldyBTaGFkZXIodGhpcy5wcm9ncmFtQ2FjaGVbbWF4VGV4dHVyZXNdLCB1bmlmb3Jtcyk7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVTYW1wbGVTcmMobWF4VGV4dHVyZXM6IG51bWJlcik6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgbGV0IHNyYyA9ICcnO1xuXG4gICAgICAgIHNyYyArPSAnXFxuJztcbiAgICAgICAgc3JjICs9ICdcXG4nO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4VGV4dHVyZXM7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGkgPiAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNyYyArPSAnXFxuZWxzZSAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaSA8IG1heFRleHR1cmVzIC0gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzcmMgKz0gYGlmKHZUZXh0dXJlSWQgPCAke2l9LjUpYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3JjICs9ICdcXG57JztcbiAgICAgICAgICAgIHNyYyArPSBgXFxuXFx0Y29sb3IgPSB0ZXh0dXJlMkQodVNhbXBsZXJzWyR7aX1dLCB2VGV4dHVyZUNvb3JkKTtgO1xuICAgICAgICAgICAgc3JjICs9ICdcXG59JztcbiAgICAgICAgfVxuXG4gICAgICAgIHNyYyArPSAnXFxuJztcbiAgICAgICAgc3JjICs9ICdcXG4nO1xuXG4gICAgICAgIHJldHVybiBzcmM7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRZUEVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IEdlb21ldHJ5IH0gZnJvbSAnLi4vZ2VvbWV0cnkvR2VvbWV0cnknO1xuaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSAnLi4vZ2VvbWV0cnkvQnVmZmVyJztcblxuLyoqXG4gKiBHZW9tZXRyeSB1c2VkIHRvIGJhdGNoIHN0YW5kYXJkIFBJWEkgY29udGVudCAoZS5nLiBNZXNoLCBTcHJpdGUsIEdyYXBoaWNzIG9iamVjdHMpLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEJhdGNoR2VvbWV0cnkgZXh0ZW5kcyBHZW9tZXRyeVxue1xuICAgIF9idWZmZXI6IEJ1ZmZlcjtcbiAgICBfaW5kZXhCdWZmZXI6IEJ1ZmZlcjtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtfc3RhdGljPWZhbHNlXSAtIE9wdGltaXphdGlvbiBmbGFnLCB3aGVyZSBgZmFsc2VgXG4gICAgICogICAgICAgIGlzIHVwZGF0ZWQgZXZlcnkgZnJhbWUsIGB0cnVlYCBkb2Vzbid0IGNoYW5nZSBmcmFtZS10by1mcmFtZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihfc3RhdGljID0gZmFsc2UpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCdWZmZXIgdXNlZCBmb3IgcG9zaXRpb24sIGNvbG9yLCB0ZXh0dXJlIElEc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJ1ZmZlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYnVmZmVyID0gbmV3IEJ1ZmZlcihudWxsLCBfc3RhdGljLCBmYWxzZSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluZGV4IGJ1ZmZlciBkYXRhXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQnVmZmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9pbmRleEJ1ZmZlciA9IG5ldyBCdWZmZXIobnVsbCwgX3N0YXRpYywgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5hZGRBdHRyaWJ1dGUoJ2FWZXJ0ZXhQb3NpdGlvbicsIHRoaXMuX2J1ZmZlciwgMiwgZmFsc2UsIFRZUEVTLkZMT0FUKVxuICAgICAgICAgICAgLmFkZEF0dHJpYnV0ZSgnYVRleHR1cmVDb29yZCcsIHRoaXMuX2J1ZmZlciwgMiwgZmFsc2UsIFRZUEVTLkZMT0FUKVxuICAgICAgICAgICAgLmFkZEF0dHJpYnV0ZSgnYUNvbG9yJywgdGhpcy5fYnVmZmVyLCA0LCB0cnVlLCBUWVBFUy5VTlNJR05FRF9CWVRFKVxuICAgICAgICAgICAgLmFkZEF0dHJpYnV0ZSgnYVRleHR1cmVJZCcsIHRoaXMuX2J1ZmZlciwgMSwgdHJ1ZSwgVFlQRVMuRkxPQVQpXG4gICAgICAgICAgICAuYWRkSW5kZXgodGhpcy5faW5kZXhCdWZmZXIpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBCYXRjaFNoYWRlckdlbmVyYXRvciB9IGZyb20gJy4vQmF0Y2hTaGFkZXJHZW5lcmF0b3InO1xuaW1wb3J0IHsgQmF0Y2hHZW9tZXRyeSB9IGZyb20gJy4vQmF0Y2hHZW9tZXRyeSc7XG5pbXBvcnQgeyBBYnN0cmFjdEJhdGNoUmVuZGVyZXIgfSBmcm9tICcuL0Fic3RyYWN0QmF0Y2hSZW5kZXJlcic7XG5cbmltcG9ydCBkZWZhdWx0VmVydGV4IGZyb20gJy4vdGV4dHVyZS52ZXJ0JztcbmltcG9ydCBkZWZhdWx0RnJhZ21lbnQgZnJvbSAnLi90ZXh0dXJlLmZyYWcnO1xuXG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vUmVuZGVyZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElCYXRjaEZhY3RvcnlPcHRpb25zXG57XG4gICAgdmVydGV4Pzogc3RyaW5nO1xuICAgIGZyYWdtZW50Pzogc3RyaW5nO1xuICAgIGdlb21ldHJ5Q2xhc3M/OiB0eXBlb2YgQmF0Y2hHZW9tZXRyeTtcbiAgICB2ZXJ0ZXhTaXplPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBoaWRlY29uc3RydWN0b3JcbiAqL1xuZXhwb3J0IGNsYXNzIEJhdGNoUGx1Z2luRmFjdG9yeVxue1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBCYXRjaFJlbmRlcmVyIHBsdWdpbiBmb3IgUmVuZGVyZXIuIHRoaXMgY29udmVuaWVuY2UgY2FuIHByb3ZpZGUgYW4gZWFzeSB3YXlcbiAgICAgKiB0byBleHRlbmQgQmF0Y2hSZW5kZXJlciB3aXRoIGFsbCB0aGUgbmVjZXNzYXJ5IHBpZWNlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGZyYWdtZW50ID0gYFxuICAgICAqIHZhcnlpbmcgdmVjMiB2VGV4dHVyZUNvb3JkO1xuICAgICAqIHZhcnlpbmcgdmVjNCB2Q29sb3I7XG4gICAgICogdmFyeWluZyBmbG9hdCB2VGV4dHVyZUlkO1xuICAgICAqIHVuaWZvcm0gc2FtcGxlcjJEIHVTYW1wbGVyc1slY291bnQlXTtcbiAgICAgKlxuICAgICAqIHZvaWQgbWFpbih2b2lkKXtcbiAgICAgKiAgICAgdmVjNCBjb2xvcjtcbiAgICAgKiAgICAgJWZvcmxvb3AlXG4gICAgICogICAgIGdsX0ZyYWdDb2xvciA9IHZDb2xvciAqIHZlYzQoY29sb3IuYSAtIGNvbG9yLnJnYiwgY29sb3IuYSk7XG4gICAgICogfVxuICAgICAqIGA7XG4gICAgICogY29uc3QgSW52ZXJ0QmF0Y2hSZW5kZXJlciA9IFBJWEkuQmF0Y2hQbHVnaW5GYWN0b3J5LmNyZWF0ZSh7IGZyYWdtZW50IH0pO1xuICAgICAqIFBJWEkuUmVuZGVyZXIucmVnaXN0ZXJQbHVnaW4oJ2ludmVydCcsIEludmVydEJhdGNoUmVuZGVyZXIpO1xuICAgICAqIGNvbnN0IHNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZSgpO1xuICAgICAqIHNwcml0ZS5wbHVnaW5OYW1lID0gJ2ludmVydCc7XG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy52ZXJ0ZXg9UElYSS5CYXRjaFBsdWdpbkZhY3RvcnkuZGVmYXVsdFZlcnRleFNyY10gLSBWZXJ0ZXggc2hhZGVyIHNvdXJjZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5mcmFnbWVudD1QSVhJLkJhdGNoUGx1Z2luRmFjdG9yeS5kZWZhdWx0RnJhZ21lbnRUZW1wbGF0ZV0gLSBGcmFnbWVudCBzaGFkZXIgdGVtcGxhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMudmVydGV4U2l6ZT02XSAtIFZlcnRleCBzaXplXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zLmdlb21ldHJ5Q2xhc3M9UElYSS5CYXRjaEdlb21ldHJ5XVxuICAgICAqIEByZXR1cm4geyp9IE5ldyBiYXRjaCByZW5kZXJlciBwbHVnaW5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKG9wdGlvbnM/OiBJQmF0Y2hGYWN0b3J5T3B0aW9ucyk6IHR5cGVvZiBBYnN0cmFjdEJhdGNoUmVuZGVyZXJcbiAgICB7XG4gICAgICAgIGNvbnN0IHsgdmVydGV4LCBmcmFnbWVudCwgdmVydGV4U2l6ZSwgZ2VvbWV0cnlDbGFzcyB9ID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB2ZXJ0ZXg6IGRlZmF1bHRWZXJ0ZXgsXG4gICAgICAgICAgICBmcmFnbWVudDogZGVmYXVsdEZyYWdtZW50LFxuICAgICAgICAgICAgZ2VvbWV0cnlDbGFzczogQmF0Y2hHZW9tZXRyeSxcbiAgICAgICAgICAgIHZlcnRleFNpemU6IDYsXG4gICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgIHJldHVybiBjbGFzcyBCYXRjaFBsdWdpbiBleHRlbmRzIEFic3RyYWN0QmF0Y2hSZW5kZXJlclxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3VwZXIocmVuZGVyZXIpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkZXJHZW5lcmF0b3IgPSBuZXcgQmF0Y2hTaGFkZXJHZW5lcmF0b3IodmVydGV4LCBmcmFnbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5nZW9tZXRyeUNsYXNzID0gZ2VvbWV0cnlDbGFzcztcbiAgICAgICAgICAgICAgICB0aGlzLnZlcnRleFNpemUgPSB2ZXJ0ZXhTaXplO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBkZWZhdWx0IHZlcnRleCBzaGFkZXIgc291cmNlXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKiBAY29uc3RhbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRWZXJ0ZXhTcmMoKTogc3RyaW5nXG4gICAge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZlcnRleDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVmYXVsdCBmcmFnbWVudCBzaGFkZXIgc291cmNlXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKiBAY29uc3RhbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRGcmFnbWVudFRlbXBsYXRlKCk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRGcmFnbWVudDtcbiAgICB9XG59XG5cbi8vIFNldHVwIHRoZSBkZWZhdWx0IEJhdGNoUmVuZGVyZXIgcGx1Z2luLCB0aGlzIGlzIHdoYXRcbi8vIHdlJ2xsIGFjdHVhbGx5IGV4cG9ydCBhdCB0aGUgcm9vdCBsZXZlbFxuZXhwb3J0IGNvbnN0IEJhdGNoUmVuZGVyZXIgPSBCYXRjaFBsdWdpbkZhY3RvcnkuY3JlYXRlKCk7XG4iLCAiaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBhdXRvRGV0ZWN0UmVuZGVyZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuaW1wb3J0IHR5cGUgeyBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIsIElSZW5kZXJlck9wdGlvbnNBdXRvLCBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuXG5leHBvcnQgaW50ZXJmYWNlIElBcHBsaWNhdGlvblBsdWdpbiB7XG4gICAgaW5pdDogKC4uLnBhcmFtczogYW55W10pID0+IGFueTtcbiAgICBkZXN0cm95OiAoLi4ucGFyYW1zOiBhbnlbXSkgPT4gYW55O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElBcHBsaWNhdGlvbk9wdGlvbnMgZXh0ZW5kcyBJUmVuZGVyZXJPcHRpb25zQXV0byB7XG4gICAgYXV0b1N0YXJ0PzogYm9vbGVhbjtcbiAgICBzaGFyZWRUaWNrZXI/OiBib29sZWFuO1xuICAgIHNoYXJlZExvYWRlcj86IGJvb2xlYW47XG4gICAgcmVzaXplVG8/OiBXaW5kb3cgfCBIVE1MRWxlbWVudDtcbiAgICByZXNpemVUaHJvdHRsZT86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBDb252ZW5pZW5jZSBjbGFzcyB0byBjcmVhdGUgYSBuZXcgUElYSSBhcHBsaWNhdGlvbi5cbiAqXG4gKiBUaGlzIGNsYXNzIGF1dG9tYXRpY2FsbHkgY3JlYXRlcyB0aGUgcmVuZGVyZXIsIHRpY2tlciBhbmQgcm9vdCBjb250YWluZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENyZWF0ZSB0aGUgYXBwbGljYXRpb25cbiAqIGNvbnN0IGFwcCA9IG5ldyBQSVhJLkFwcGxpY2F0aW9uKCk7XG4gKlxuICogLy8gQWRkIHRoZSB2aWV3IHRvIHRoZSBET01cbiAqIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYXBwLnZpZXcpO1xuICpcbiAqIC8vIGV4LCBhZGQgZGlzcGxheSBvYmplY3RzXG4gKiBhcHAuc3RhZ2UuYWRkQ2hpbGQoUElYSS5TcHJpdGUuZnJvbSgnc29tZXRoaW5nLnBuZycpKTtcbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBBcHBsaWNhdGlvblxue1xuICAgIHB1YmxpYyBzdGF0aWMgX3BsdWdpbnM6IElBcHBsaWNhdGlvblBsdWdpbltdO1xuXG4gICAgcHVibGljIHN0YWdlOiBDb250YWluZXI7XG4gICAgcHVibGljIHJlbmRlcmVyOiBSZW5kZXJlcnxBYnN0cmFjdFJlbmRlcmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25hbCByZW5kZXJlciBwYXJhbWV0ZXJzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYXV0b1N0YXJ0PXRydWVdIC0gQXV0b21hdGljYWxseSBzdGFydHMgdGhlIHJlbmRlcmluZyBhZnRlciB0aGUgY29uc3RydWN0aW9uLlxuICAgICAqICAgICAqKk5vdGUqKjogU2V0dGluZyB0aGlzIHBhcmFtZXRlciB0byBmYWxzZSBkb2VzIE5PVCBzdG9wIHRoZSBzaGFyZWQgdGlja2VyIGV2ZW4gaWYgeW91IHNldFxuICAgICAqICAgICBvcHRpb25zLnNoYXJlZFRpY2tlciB0byB0cnVlIGluIGNhc2UgdGhhdCBpdCBpcyBhbHJlYWR5IHN0YXJ0ZWQuIFN0b3AgaXQgYnkgeW91ciBvd24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLndpZHRoPTgwMF0gLSBUaGUgd2lkdGggb2YgdGhlIHJlbmRlcmVycyB2aWV3LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5oZWlnaHQ9NjAwXSAtIFRoZSBoZWlnaHQgb2YgdGhlIHJlbmRlcmVycyB2aWV3LlxuICAgICAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IFtvcHRpb25zLnZpZXddIC0gVGhlIGNhbnZhcyB0byB1c2UgYXMgYSB2aWV3LCBvcHRpb25hbC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnRyYW5zcGFyZW50PWZhbHNlXSAtIElmIHRoZSByZW5kZXIgdmlldyBpcyB0cmFuc3BhcmVudC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmF1dG9EZW5zaXR5PWZhbHNlXSAtIFJlc2l6ZXMgcmVuZGVyZXIgdmlldyBpbiBDU1MgcGl4ZWxzIHRvIGFsbG93IGZvclxuICAgICAqICAgcmVzb2x1dGlvbnMgb3RoZXIgdGhhbiAxLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYW50aWFsaWFzPWZhbHNlXSAtIFNldHMgYW50aWFsaWFzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5wcmVzZXJ2ZURyYXdpbmdCdWZmZXI9ZmFsc2VdIC0gRW5hYmxlcyBkcmF3aW5nIGJ1ZmZlciBwcmVzZXJ2YXRpb24sIGVuYWJsZSB0aGlzIGlmIHlvdVxuICAgICAqICBuZWVkIHRvIGNhbGwgdG9EYXRhVXJsIG9uIHRoZSBXZWJHTCBjb250ZXh0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5yZXNvbHV0aW9uPTFdIC0gVGhlIHJlc29sdXRpb24gLyBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgdGhlIHJlbmRlcmVyLCByZXRpbmEgd291bGQgYmUgMi5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmZvcmNlQ2FudmFzPWZhbHNlXSAtIHByZXZlbnRzIHNlbGVjdGlvbiBvZiBXZWJHTCByZW5kZXJlciwgZXZlbiBpZiBzdWNoIGlzIHByZXNlbnQsIHRoaXNcbiAgICAgKiAgIG9wdGlvbiBvbmx5IGlzIGF2YWlsYWJsZSB3aGVuIHVzaW5nICoqcGl4aS5qcy1sZWdhY3kqKiBvciAqKkBwaXhpL2NhbnZhcy1yZW5kZXJlcioqIG1vZHVsZXMsIG90aGVyd2lzZVxuICAgICAqICAgaXQgaXMgaWdub3JlZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuYmFja2dyb3VuZENvbG9yPTB4MDAwMDAwXSAtIFRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSByZW5kZXJlZCBhcmVhXG4gICAgICogIChzaG93biBpZiBub3QgdHJhbnNwYXJlbnQpLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2xlYXJCZWZvcmVSZW5kZXI9dHJ1ZV0gLSBUaGlzIHNldHMgaWYgdGhlIHJlbmRlcmVyIHdpbGwgY2xlYXIgdGhlIGNhbnZhcyBvclxuICAgICAqICAgbm90IGJlZm9yZSB0aGUgbmV3IHJlbmRlciBwYXNzLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5wb3dlclByZWZlcmVuY2VdIC0gUGFyYW1ldGVyIHBhc3NlZCB0byB3ZWJnbCBjb250ZXh0LCBzZXQgdG8gXCJoaWdoLXBlcmZvcm1hbmNlXCJcbiAgICAgKiAgZm9yIGRldmljZXMgd2l0aCBkdWFsIGdyYXBoaWNzIGNhcmQuICoqKFdlYkdMIG9ubHkpKiouXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5zaGFyZWRUaWNrZXI9ZmFsc2VdIC0gYHRydWVgIHRvIHVzZSBQSVhJLlRpY2tlci5zaGFyZWQsIGBmYWxzZWAgdG8gY3JlYXRlIG5ldyB0aWNrZXIuXG4gICAgICogIElmIHNldCB0byBmYWxzZSwgeW91IGNhbm5vdCByZWdpc3RlciBhIGhhbmRsZXIgdG8gb2NjdXIgYmVmb3JlIGFueXRoaW5nIHRoYXQgcnVucyBvbiB0aGUgc2hhcmVkIHRpY2tlci5cbiAgICAgKiAgVGhlIHN5c3RlbSB0aWNrZXIgd2lsbCBhbHdheXMgcnVuIGJlZm9yZSBib3RoIHRoZSBzaGFyZWQgdGlja2VyIGFuZCB0aGUgYXBwIHRpY2tlci5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnNoYXJlZExvYWRlcj1mYWxzZV0gLSBgdHJ1ZWAgdG8gdXNlIFBJWEkuTG9hZGVyLnNoYXJlZCwgYGZhbHNlYCB0byBjcmVhdGUgbmV3IExvYWRlci5cbiAgICAgKiBAcGFyYW0ge1dpbmRvd3xIVE1MRWxlbWVudH0gW29wdGlvbnMucmVzaXplVG9dIC0gRWxlbWVudCB0byBhdXRvbWF0aWNhbGx5IHJlc2l6ZSBzdGFnZSB0by5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zPzogSUFwcGxpY2F0aW9uT3B0aW9ucylcbiAgICB7XG4gICAgICAgIC8vIFRoZSBkZWZhdWx0IG9wdGlvbnNcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgZm9yY2VDYW52YXM6IGZhbHNlLFxuICAgICAgICB9LCBvcHRpb25zKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2ViR0wgcmVuZGVyZXIgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgQ2FudmFzUmVuZGVyZXIuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUmVuZGVyZXJ8UElYSS5DYW52YXNSZW5kZXJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBhdXRvRGV0ZWN0UmVuZGVyZXIob3B0aW9ucyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByb290IGRpc3BsYXkgY29udGFpbmVyIHRoYXQncyByZW5kZXJlZC5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5Db250YWluZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YWdlID0gbmV3IENvbnRhaW5lcigpO1xuXG4gICAgICAgIC8vIGluc3RhbGwgcGx1Z2lucyBoZXJlXG4gICAgICAgIEFwcGxpY2F0aW9uLl9wbHVnaW5zLmZvckVhY2goKHBsdWdpbikgPT5cbiAgICAgICAge1xuICAgICAgICAgICAgcGx1Z2luLmluaXQuY2FsbCh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgYSBtaWRkbGV3YXJlIHBsdWdpbiBmb3IgdGhlIGFwcGxpY2F0aW9uXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7UElYSS5BcHBsaWNhdGlvbi5QbHVnaW59IHBsdWdpbiAtIFBsdWdpbiBiZWluZyBpbnN0YWxsZWRcbiAgICAgKi9cbiAgICBzdGF0aWMgcmVnaXN0ZXJQbHVnaW4ocGx1Z2luOiBJQXBwbGljYXRpb25QbHVnaW4pOiB2b2lkXG4gICAge1xuICAgICAgICBBcHBsaWNhdGlvbi5fcGx1Z2lucy5wdXNoKHBsdWdpbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBjdXJyZW50IHN0YWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyByZW5kZXIoKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gVE9ETzogU2luY2UgQ2FudmFzUmVuZGVyZXIgaGFzIG5vdCBiZWVuIGNvbnZlcnRlZCB0aGlzIGZ1bmN0aW9uIHRoaW5rcyBpdCB0YWtlcyBEaXNwbGF5T2JqZWN0ICYgUElYSS5EaXNwbGF5T2JqZWN0XG4gICAgICAgIC8vIFRoaXMgY2FuIGJlIGZpeGVkIHdoZW4gQ2FudmFzUmVuZGVyZXIgaXMgY29udmVydGVkLlxuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnN0YWdlIGFzIGFueSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmZXJlbmNlIHRvIHRoZSByZW5kZXJlcidzIGNhbnZhcyBlbGVtZW50LlxuICAgICAqIEBtZW1iZXIge0hUTUxDYW52YXNFbGVtZW50fVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCB2aWV3KCk6IEhUTUxDYW52YXNFbGVtZW50XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci52aWV3O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZmVyZW5jZSB0byB0aGUgcmVuZGVyZXIncyBzY3JlZW4gcmVjdGFuZ2xlLiBJdHMgc2FmZSB0byB1c2UgYXMgYGZpbHRlckFyZWFgIG9yIGBoaXRBcmVhYCBmb3IgdGhlIHdob2xlIHNjcmVlbi5cbiAgICAgKiBAbWVtYmVyIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgc2NyZWVuKCk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuc2NyZWVuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgYW5kIGRvbid0IHVzZSBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3JlbW92ZVZpZXc9ZmFsc2VdIC0gQXV0b21hdGljYWxseSByZW1vdmUgY2FudmFzIGZyb20gRE9NLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fGJvb2xlYW59IFtzdGFnZU9wdGlvbnNdIC0gT3B0aW9ucyBwYXJhbWV0ZXIuIEEgYm9vbGVhbiB3aWxsIGFjdCBhcyBpZiBhbGwgb3B0aW9uc1xuICAgICAqICBoYXZlIGJlZW4gc2V0IHRvIHRoYXQgdmFsdWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzdGFnZU9wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gaWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlIHRoZWlyIGRlc3Ryb3lcbiAgICAgKiAgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnc3RhZ2VPcHRpb25zJyB3aWxsIGJlIHBhc3NlZCBvbiB0byB0aG9zZSBjYWxscy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzdGFnZU9wdGlvbnMudGV4dHVyZT1mYWxzZV0gLSBPbmx5IHVzZWQgZm9yIGNoaWxkIFNwcml0ZXMgaWYgc3RhZ2VPcHRpb25zLmNoaWxkcmVuIGlzIHNldFxuICAgICAqICB0byB0cnVlLiBTaG91bGQgaXQgZGVzdHJveSB0aGUgdGV4dHVyZSBvZiB0aGUgY2hpbGQgc3ByaXRlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc3RhZ2VPcHRpb25zLmJhc2VUZXh0dXJlPWZhbHNlXSAtIE9ubHkgdXNlZCBmb3IgY2hpbGQgU3ByaXRlcyBpZiBzdGFnZU9wdGlvbnMuY2hpbGRyZW4gaXMgc2V0XG4gICAgICogIHRvIHRydWUuIFNob3VsZCBpdCBkZXN0cm95IHRoZSBiYXNlIHRleHR1cmUgb2YgdGhlIGNoaWxkIHNwcml0ZVxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KHJlbW92ZVZpZXc/OiBib29sZWFuLCBzdGFnZU9wdGlvbnM/OiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIERlc3Ryb3kgcGx1Z2lucyBpbiB0aGUgb3Bwb3NpdGUgb3JkZXJcbiAgICAgICAgLy8gd2hpY2ggdGhleSB3ZXJlIGNvbnN0cnVjdGVkXG4gICAgICAgIGNvbnN0IHBsdWdpbnMgPSBBcHBsaWNhdGlvbi5fcGx1Z2lucy5zbGljZSgwKTtcblxuICAgICAgICBwbHVnaW5zLnJldmVyc2UoKTtcbiAgICAgICAgcGx1Z2lucy5mb3JFYWNoKChwbHVnaW4pID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHBsdWdpbi5kZXN0cm95LmNhbGwodGhpcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc3RhZ2UuZGVzdHJveShzdGFnZU9wdGlvbnMpO1xuICAgICAgICB0aGlzLnN0YWdlID0gbnVsbDtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLmRlc3Ryb3kocmVtb3ZlVmlldyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBudWxsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS5BcHBsaWNhdGlvblxuICogQHR5cGVkZWYge29iamVjdH0gUGx1Z2luXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9ufSBpbml0IC0gQ2FsbGVkIHdoZW4gQXBwbGljYXRpb24gaXMgY29uc3RydWN0ZWQsIHNjb3BlZCB0byBBcHBsaWNhdGlvbiBpbnN0YW5jZS5cbiAqICBQYXNzZXMgaW4gYG9wdGlvbnNgIGFzIHRoZSBvbmx5IGFyZ3VtZW50LCB3aGljaCBhcmUgQXBwbGljYXRpb24gY29uc3RydWN0b3Igb3B0aW9ucy5cbiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb259IGRlc3Ryb3kgLSBDYWxsZWQgd2hlbiBkZXN0cm95aW5nIEFwcGxpY2F0aW9uLCBzY29wZWQgdG8gQXBwbGljYXRpb24gaW5zdGFuY2VcbiAqL1xuXG4vKipcbiAqIENvbGxlY3Rpb24gb2YgaW5zdGFsbGVkIHBsdWdpbnMuXG4gKiBAc3RhdGljXG4gKiBAcHJpdmF0ZVxuICogQHR5cGUge1BJWEkuQXBwbGljYXRpb24uUGx1Z2luW119XG4gKi9cbkFwcGxpY2F0aW9uLl9wbHVnaW5zID0gW107XG4iLCAiaW1wb3J0IHR5cGUgeyBDYW52YXNSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NhbnZhcy1yZW5kZXJlcic7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElBcHBsaWNhdGlvbk9wdGlvbnMgfSBmcm9tICcuL0FwcGxpY2F0aW9uJztcblxuLyoqXG4gKiBNaWRkbGV3YXJlIGZvciBmb3IgQXBwbGljYXRpb24ncyByZXNpemUgZnVuY3Rpb25hbGl0eVxuICogQHByaXZhdGVcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgUmVzaXplUGx1Z2luXG57XG4gICAgcHVibGljIHN0YXRpYyByZXNpemVUbzogV2luZG93fEhUTUxFbGVtZW50O1xuICAgIHB1YmxpYyBzdGF0aWMgcmVzaXplOiAoKSA9PiB2b2lkO1xuICAgIHB1YmxpYyBzdGF0aWMgcmVuZGVyZXI6IFJlbmRlcmVyfENhbnZhc1JlbmRlcmVyO1xuICAgIHB1YmxpYyBzdGF0aWMgcXVldWVSZXNpemU6ICgpID0+IHZvaWQ7XG4gICAgcHJpdmF0ZSBzdGF0aWMgX3Jlc2l6ZUlkOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBzdGF0aWMgX3Jlc2l6ZVRvOiBXaW5kb3d8SFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzdGF0aWMgY2FuY2VsUmVzaXplOiAoKSA9PiB2b2lkO1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGUgcGx1Z2luIHdpdGggc2NvcGUgb2YgYXBwbGljYXRpb24gaW5zdGFuY2VcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gU2VlIGFwcGxpY2F0aW9uIG9wdGlvbnNcbiAgICAgKi9cbiAgICBzdGF0aWMgaW5pdChvcHRpb25zPzogSUFwcGxpY2F0aW9uT3B0aW9ucyk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgSFRNTCBlbGVtZW50IG9yIHdpbmRvdyB0byBhdXRvbWF0aWNhbGx5IHJlc2l6ZSB0aGVcbiAgICAgICAgICogcmVuZGVyZXIncyB2aWV3IGVsZW1lbnQgdG8gbWF0Y2ggd2lkdGggYW5kIGhlaWdodC5cbiAgICAgICAgICogQHR5cGUge1dpbmRvd3xIVE1MRWxlbWVudH1cbiAgICAgICAgICogQG5hbWUgcmVzaXplVG9cbiAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuQXBwbGljYXRpb24jXG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3Jlc2l6ZVRvJyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzZXQoZG9tOiBXaW5kb3d8SFRNTEVsZW1lbnQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5xdWV1ZVJlc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZVRvID0gZG9tO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5xdWV1ZVJlc2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBnZXQoKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc2l6ZVRvO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVzaXplIGlzIHRocm90dGxlZCwgc28gaXQnc1xuICAgICAgICAgKiBzYWZlIHRvIGNhbGwgdGhpcyBtdWx0aXBsZSB0aW1lcyBwZXIgZnJhbWUgYW5kIGl0J2xsXG4gICAgICAgICAqIG9ubHkgYmUgY2FsbGVkIG9uY2UuXG4gICAgICAgICAqIEBtZXRob2QgUElYSS5BcHBsaWNhdGlvbiNxdWV1ZVJlc2l6ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xdWV1ZVJlc2l6ZSA9ICgpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fcmVzaXplVG8pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNhbmNlbFJlc2l6ZSgpO1xuXG4gICAgICAgICAgICAvLyAvLyBUaHJvdHRsZSByZXNpemUgZXZlbnRzIHBlciByYWZcbiAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMucmVzaXplKCkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYW5jZWwgdGhlIHJlc2l6ZSBxdWV1ZS5cbiAgICAgICAgICogQG1ldGhvZCBQSVhJLkFwcGxpY2F0aW9uI2NhbmNlbFJlc2l6ZVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jYW5jZWxSZXNpemUgPSAoKTogdm9pZCA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVzaXplSWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5fcmVzaXplSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZUlkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRXhlY3V0ZSBhbiBpbW1lZGlhdGUgcmVzaXplIG9uIHRoZSByZW5kZXJlciwgdGhpcyBpcyBub3RcbiAgICAgICAgICogdGhyb3R0bGVkIGFuZCBjYW4gYmUgZXhwZW5zaXZlIHRvIGNhbGwgbWFueSB0aW1lcyBpbiBhIHJvdy5cbiAgICAgICAgICogV2lsbCByZXNpemUgb25seSBpZiBgcmVzaXplVG9gIHByb3BlcnR5IGlzIHNldC5cbiAgICAgICAgICogQG1ldGhvZCBQSVhJLkFwcGxpY2F0aW9uI3Jlc2l6ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNpemUgPSAoKTogdm9pZCA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3Jlc2l6ZVRvKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY2xlYXIgcXVldWUgcmVzaXplXG4gICAgICAgICAgICB0aGlzLmNhbmNlbFJlc2l6ZSgpO1xuXG4gICAgICAgICAgICBsZXQgd2lkdGg6IG51bWJlcjtcbiAgICAgICAgICAgIGxldCBoZWlnaHQ6IG51bWJlcjtcblxuICAgICAgICAgICAgLy8gUmVzaXplIHRvIHRoZSB3aW5kb3dcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZXNpemVUbyA9PT0gd2luZG93KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmVzaXplIHRvIG90aGVyIEhUTUwgZW50aXRpZXNcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGNsaWVudFdpZHRoLCBjbGllbnRIZWlnaHQgfSA9IHRoaXMuX3Jlc2l6ZVRvIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgICAgICAgICAgd2lkdGggPSBjbGllbnRXaWR0aDtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVzaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIE9uIHJlc2l6ZVxuICAgICAgICB0aGlzLl9yZXNpemVJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jlc2l6ZVRvID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXNpemVUbyA9IG9wdGlvbnMucmVzaXplVG8gfHwgbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCB0aGUgdGlja2VyLCBzY29wZWQgdG8gYXBwbGljYXRpb25cbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBzdGF0aWMgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmNhbmNlbFJlc2l6ZSgpO1xuICAgICAgICB0aGlzLmNhbmNlbFJlc2l6ZSA9IG51bGw7XG4gICAgICAgIHRoaXMucXVldWVSZXNpemUgPSBudWxsO1xuICAgICAgICB0aGlzLnJlc2l6ZVRvID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXNpemUgPSBudWxsO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHBsaWNhdGlvbiB9IGZyb20gJy4vQXBwbGljYXRpb24nO1xuaW1wb3J0IHsgUmVzaXplUGx1Z2luIH0gZnJvbSAnLi9SZXNpemVQbHVnaW4nO1xuXG5BcHBsaWNhdGlvbi5yZWdpc3RlclBsdWdpbihSZXNpemVQbHVnaW4pO1xuXG5leHBvcnQgKiBmcm9tICcuL0FwcGxpY2F0aW9uJztcbiIsICJpbXBvcnQgeyBDYW52YXNSZW5kZXJUYXJnZXQgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IFJlbmRlclRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciwgSVJlbmRlcmVyUGx1Z2luIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IERpc3BsYXlPYmplY3QgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcblxuY29uc3QgVEVNUF9SRUNUID0gbmV3IFJlY3RhbmdsZSgpO1xuY29uc3QgQllURVNfUEVSX1BJWEVMID0gNDtcblxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIHJlbmRlcmVyLXNwZWNpZmljIHBsdWdpbnMgZm9yIGV4cG9ydGluZyBjb250ZW50IGZyb20gYSByZW5kZXJlci5cbiAqIEZvciBpbnN0YW5jZSwgdGhlc2UgcGx1Z2lucyBjYW4gYmUgdXNlZCBmb3Igc2F2aW5nIGFuIEltYWdlLCBDYW52YXMgZWxlbWVudCBvciBmb3IgZXhwb3J0aW5nIHRoZSByYXcgaW1hZ2UgZGF0YSAocGl4ZWxzKS5cbiAqXG4gKiBEbyBub3QgaW5zdGFudGlhdGUgdGhlc2UgcGx1Z2lucyBkaXJlY3RseS4gSXQgaXMgYXZhaWxhYmxlIGZyb20gdGhlIGByZW5kZXJlci5wbHVnaW5zYCBwcm9wZXJ0eS5cbiAqIFNlZSB7QGxpbmsgUElYSS5DYW52YXNSZW5kZXJlciNwbHVnaW5zfSBvciB7QGxpbmsgUElYSS5SZW5kZXJlciNwbHVnaW5zfS5cbiAqIEBleGFtcGxlXG4gKiAvLyBDcmVhdGUgYSBuZXcgYXBwICh3aWxsIGF1dG8tYWRkIGV4dHJhY3QgcGx1Z2luIHRvIHJlbmRlcmVyKVxuICogY29uc3QgYXBwID0gbmV3IFBJWEkuQXBwbGljYXRpb24oKTtcbiAqXG4gKiAvLyBEcmF3IGEgcmVkIGNpcmNsZVxuICogY29uc3QgZ3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpXG4gKiAgICAgLmJlZ2luRmlsbCgweEZGMDAwMClcbiAqICAgICAuZHJhd0NpcmNsZSgwLCAwLCA1MCk7XG4gKlxuICogLy8gUmVuZGVyIHRoZSBncmFwaGljcyBhcyBhbiBIVE1MSW1hZ2VFbGVtZW50XG4gKiBjb25zdCBpbWFnZSA9IGFwcC5yZW5kZXJlci5wbHVnaW5zLmV4dHJhY3QuaW1hZ2UoZ3JhcGhpY3MpO1xuICogZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbWFnZSk7XG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBFeHRyYWN0IGltcGxlbWVudHMgSVJlbmRlcmVyUGx1Z2luXG57XG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXI7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb2xsZWN0aW9uIG9mIG1ldGhvZHMgZm9yIGV4dHJhY3RpbmcgZGF0YSAoaW1hZ2UsIHBpeGVscywgZXRjLikgZnJvbSBhIGRpc3BsYXkgb2JqZWN0IG9yIHJlbmRlciB0ZXh0dXJlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRXh0cmFjdH0gZXh0cmFjdFxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5SZW5kZXJlciNcbiAgICAgICAgICogQHNlZSBQSVhJLkV4dHJhY3RcbiAgICAgICAgICovXG4gICAgICAgIHJlbmRlcmVyLmV4dHJhY3QgPSB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdpbGwgcmV0dXJuIGEgSFRNTCBJbWFnZSBvZiB0aGUgdGFyZ2V0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdHxQSVhJLlJlbmRlclRleHR1cmV9IHRhcmdldCAtIEEgZGlzcGxheU9iamVjdCBvciByZW5kZXJUZXh0dXJlXG4gICAgICogIHRvIGNvbnZlcnQuIElmIGxlZnQgZW1wdHkgd2lsbCB1c2UgdGhlIG1haW4gcmVuZGVyZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2Zvcm1hdF0gLSBJbWFnZSBmb3JtYXQsIGUuZy4gXCJpbWFnZS9qcGVnXCIgb3IgXCJpbWFnZS93ZWJwXCIuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtxdWFsaXR5XSAtIEpQRUcgb3IgV2VicCBjb21wcmVzc2lvbiBmcm9tIDAgdG8gMS4gRGVmYXVsdCBpcyAwLjkyLlxuICAgICAqIEByZXR1cm4ge0hUTUxJbWFnZUVsZW1lbnR9IEhUTUwgSW1hZ2Ugb2YgdGhlIHRhcmdldFxuICAgICAqL1xuICAgIHB1YmxpYyBpbWFnZSh0YXJnZXQ6IERpc3BsYXlPYmplY3R8UmVuZGVyVGV4dHVyZSwgZm9ybWF0Pzogc3RyaW5nLCBxdWFsaXR5PzogbnVtYmVyKTogSFRNTEltYWdlRWxlbWVudFxuICAgIHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblxuICAgICAgICBpbWFnZS5zcmMgPSB0aGlzLmJhc2U2NCh0YXJnZXQsIGZvcm1hdCwgcXVhbGl0eSk7XG5cbiAgICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdpbGwgcmV0dXJuIGEgYSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcgb2YgdGhpcyB0YXJnZXQuIEl0IHdvcmtzIGJ5IGNhbGxpbmdcbiAgICAgKiAgYEV4dHJhY3QuZ2V0Q2FudmFzYCBhbmQgdGhlbiBydW5uaW5nIHRvRGF0YVVSTCBvbiB0aGF0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R8UElYSS5SZW5kZXJUZXh0dXJlfSB0YXJnZXQgLSBBIGRpc3BsYXlPYmplY3Qgb3IgcmVuZGVyVGV4dHVyZVxuICAgICAqICB0byBjb252ZXJ0LiBJZiBsZWZ0IGVtcHR5IHdpbGwgdXNlIHRoZSBtYWluIHJlbmRlcmVyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtmb3JtYXRdIC0gSW1hZ2UgZm9ybWF0LCBlLmcuIFwiaW1hZ2UvanBlZ1wiIG9yIFwiaW1hZ2Uvd2VicFwiLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcXVhbGl0eV0gLSBKUEVHIG9yIFdlYnAgY29tcHJlc3Npb24gZnJvbSAwIHRvIDEuIERlZmF1bHQgaXMgMC45Mi5cbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IEEgYmFzZTY0IGVuY29kZWQgc3RyaW5nIG9mIHRoZSB0ZXh0dXJlLlxuICAgICAqL1xuICAgIHB1YmxpYyBiYXNlNjQodGFyZ2V0OiBEaXNwbGF5T2JqZWN0fFJlbmRlclRleHR1cmUsIGZvcm1hdD86IHN0cmluZywgcXVhbGl0eT86IG51bWJlcik6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzKHRhcmdldCkudG9EYXRhVVJMKGZvcm1hdCwgcXVhbGl0eSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIENhbnZhcyBlbGVtZW50LCByZW5kZXJzIHRoaXMgdGFyZ2V0IHRvIGl0IGFuZCB0aGVuIHJldHVybnMgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdHxQSVhJLlJlbmRlclRleHR1cmV9IHRhcmdldCAtIEEgZGlzcGxheU9iamVjdCBvciByZW5kZXJUZXh0dXJlXG4gICAgICogIHRvIGNvbnZlcnQuIElmIGxlZnQgZW1wdHkgd2lsbCB1c2UgdGhlIG1haW4gcmVuZGVyZXJcbiAgICAgKiBAcmV0dXJuIHtIVE1MQ2FudmFzRWxlbWVudH0gQSBDYW52YXMgZWxlbWVudCB3aXRoIHRoZSB0ZXh0dXJlIHJlbmRlcmVkIG9uLlxuICAgICAqL1xuICAgIHB1YmxpYyBjYW52YXModGFyZ2V0OiBEaXNwbGF5T2JqZWN0fFJlbmRlclRleHR1cmUpOiBIVE1MQ2FudmFzRWxlbWVudFxuICAgIHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuICAgICAgICBsZXQgcmVzb2x1dGlvbjtcbiAgICAgICAgbGV0IGZyYW1lO1xuICAgICAgICBsZXQgZmxpcFkgPSBmYWxzZTtcbiAgICAgICAgbGV0IHJlbmRlclRleHR1cmU7XG4gICAgICAgIGxldCBnZW5lcmF0ZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGFyZ2V0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgUmVuZGVyVGV4dHVyZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZW5kZXJUZXh0dXJlID0gdGFyZ2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlbmRlclRleHR1cmUgPSB0aGlzLnJlbmRlcmVyLmdlbmVyYXRlVGV4dHVyZSh0YXJnZXQpO1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmVzb2x1dGlvbiA9IHJlbmRlclRleHR1cmUuYmFzZVRleHR1cmUucmVzb2x1dGlvbjtcbiAgICAgICAgICAgIGZyYW1lID0gcmVuZGVyVGV4dHVyZS5mcmFtZTtcbiAgICAgICAgICAgIGZsaXBZID0gZmFsc2U7XG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJUZXh0dXJlLmJpbmQocmVuZGVyVGV4dHVyZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXNvbHV0aW9uID0gdGhpcy5yZW5kZXJlci5yZXNvbHV0aW9uO1xuXG4gICAgICAgICAgICBmbGlwWSA9IHRydWU7XG5cbiAgICAgICAgICAgIGZyYW1lID0gVEVNUF9SRUNUO1xuICAgICAgICAgICAgZnJhbWUud2lkdGggPSB0aGlzLnJlbmRlcmVyLndpZHRoO1xuICAgICAgICAgICAgZnJhbWUuaGVpZ2h0ID0gdGhpcy5yZW5kZXJlci5oZWlnaHQ7XG5cbiAgICAgICAgICAgIHJlbmRlcmVyLnJlbmRlclRleHR1cmUuYmluZChudWxsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHdpZHRoID0gTWF0aC5mbG9vcigoZnJhbWUud2lkdGggKiByZXNvbHV0aW9uKSArIDFlLTQpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLmZsb29yKChmcmFtZS5oZWlnaHQgKiByZXNvbHV0aW9uKSArIDFlLTQpO1xuXG4gICAgICAgIGxldCBjYW52YXNCdWZmZXIgPSBuZXcgQ2FudmFzUmVuZGVyVGFyZ2V0KHdpZHRoLCBoZWlnaHQsIDEpO1xuXG4gICAgICAgIGNvbnN0IHdlYmdsUGl4ZWxzID0gbmV3IFVpbnQ4QXJyYXkoQllURVNfUEVSX1BJWEVMICogd2lkdGggKiBoZWlnaHQpO1xuXG4gICAgICAgIC8vIHJlYWQgcGl4ZWxzIHRvIHRoZSBhcnJheVxuICAgICAgICBjb25zdCBnbCA9IHJlbmRlcmVyLmdsO1xuXG4gICAgICAgIGdsLnJlYWRQaXhlbHMoXG4gICAgICAgICAgICBmcmFtZS54ICogcmVzb2x1dGlvbixcbiAgICAgICAgICAgIGZyYW1lLnkgKiByZXNvbHV0aW9uLFxuICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQsXG4gICAgICAgICAgICBnbC5SR0JBLFxuICAgICAgICAgICAgZ2wuVU5TSUdORURfQllURSxcbiAgICAgICAgICAgIHdlYmdsUGl4ZWxzXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gYWRkIHRoZSBwaXhlbHMgdG8gdGhlIGNhbnZhc1xuICAgICAgICBjb25zdCBjYW52YXNEYXRhID0gY2FudmFzQnVmZmVyLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgIEV4dHJhY3QuYXJyYXlQb3N0RGl2aWRlKHdlYmdsUGl4ZWxzLCBjYW52YXNEYXRhLmRhdGEpO1xuXG4gICAgICAgIGNhbnZhc0J1ZmZlci5jb250ZXh0LnB1dEltYWdlRGF0YShjYW52YXNEYXRhLCAwLCAwKTtcblxuICAgICAgICAvLyBwdWxsaW5nIHBpeGVsc1xuICAgICAgICBpZiAoZmxpcFkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IG5ldyBDYW52YXNSZW5kZXJUYXJnZXQoY2FudmFzQnVmZmVyLndpZHRoLCBjYW52YXNCdWZmZXIuaGVpZ2h0LCAxKTtcblxuICAgICAgICAgICAgdGFyZ2V0LmNvbnRleHQuc2NhbGUoMSwgLTEpO1xuXG4gICAgICAgICAgICAvLyB3ZSBjYW4ndCByZW5kZXIgdG8gaXRzZWxmIGJlY2F1c2Ugd2Ugc2hvdWxkIGJlIGVtcHR5IGJlZm9yZSByZW5kZXIuXG4gICAgICAgICAgICB0YXJnZXQuY29udGV4dC5kcmF3SW1hZ2UoY2FudmFzQnVmZmVyLmNhbnZhcywgMCwgLWhlaWdodCk7XG5cbiAgICAgICAgICAgIGNhbnZhc0J1ZmZlci5kZXN0cm95KCk7XG4gICAgICAgICAgICBjYW52YXNCdWZmZXIgPSB0YXJnZXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2VuZXJhdGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICByZW5kZXJUZXh0dXJlLmRlc3Ryb3kodHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZW5kIHRoZSBjYW52YXMgYmFjay4uXG4gICAgICAgIHJldHVybiBjYW52YXNCdWZmZXIuY2FudmFzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdpbGwgcmV0dXJuIGEgb25lLWRpbWVuc2lvbmFsIGFycmF5IGNvbnRhaW5pbmcgdGhlIHBpeGVsIGRhdGEgb2YgdGhlIGVudGlyZSB0ZXh0dXJlIGluIFJHQkFcbiAgICAgKiBvcmRlciwgd2l0aCBpbnRlZ2VyIHZhbHVlcyBiZXR3ZWVuIDAgYW5kIDI1NSAoaW5jbHVkZWQpLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R8UElYSS5SZW5kZXJUZXh0dXJlfSB0YXJnZXQgLSBBIGRpc3BsYXlPYmplY3Qgb3IgcmVuZGVyVGV4dHVyZVxuICAgICAqICB0byBjb252ZXJ0LiBJZiBsZWZ0IGVtcHR5IHdpbGwgdXNlIHRoZSBtYWluIHJlbmRlcmVyXG4gICAgICogQHJldHVybiB7VWludDhBcnJheX0gT25lLWRpbWVuc2lvbmFsIGFycmF5IGNvbnRhaW5pbmcgdGhlIHBpeGVsIGRhdGEgb2YgdGhlIGVudGlyZSB0ZXh0dXJlXG4gICAgICovXG4gICAgcHVibGljIHBpeGVscyh0YXJnZXQ6IERpc3BsYXlPYmplY3R8UmVuZGVyVGV4dHVyZSk6IFVpbnQ4QXJyYXlcbiAgICB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlcjtcbiAgICAgICAgbGV0IHJlc29sdXRpb247XG4gICAgICAgIGxldCBmcmFtZTtcbiAgICAgICAgbGV0IHJlbmRlclRleHR1cmU7XG4gICAgICAgIGxldCBnZW5lcmF0ZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGFyZ2V0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgUmVuZGVyVGV4dHVyZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZW5kZXJUZXh0dXJlID0gdGFyZ2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlbmRlclRleHR1cmUgPSB0aGlzLnJlbmRlcmVyLmdlbmVyYXRlVGV4dHVyZSh0YXJnZXQpO1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVuZGVyVGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmVzb2x1dGlvbiA9IHJlbmRlclRleHR1cmUuYmFzZVRleHR1cmUucmVzb2x1dGlvbjtcbiAgICAgICAgICAgIGZyYW1lID0gcmVuZGVyVGV4dHVyZS5mcmFtZTtcblxuICAgICAgICAgICAgLy8gYmluZCB0aGUgYnVmZmVyXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJUZXh0dXJlLmJpbmQocmVuZGVyVGV4dHVyZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXNvbHV0aW9uID0gcmVuZGVyZXIucmVzb2x1dGlvbjtcblxuICAgICAgICAgICAgZnJhbWUgPSBURU1QX1JFQ1Q7XG4gICAgICAgICAgICBmcmFtZS53aWR0aCA9IHJlbmRlcmVyLndpZHRoO1xuICAgICAgICAgICAgZnJhbWUuaGVpZ2h0ID0gcmVuZGVyZXIuaGVpZ2h0O1xuXG4gICAgICAgICAgICByZW5kZXJlci5yZW5kZXJUZXh0dXJlLmJpbmQobnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB3aWR0aCA9IGZyYW1lLndpZHRoICogcmVzb2x1dGlvbjtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gZnJhbWUuaGVpZ2h0ICogcmVzb2x1dGlvbjtcblxuICAgICAgICBjb25zdCB3ZWJnbFBpeGVscyA9IG5ldyBVaW50OEFycmF5KEJZVEVTX1BFUl9QSVhFTCAqIHdpZHRoICogaGVpZ2h0KTtcblxuICAgICAgICAvLyByZWFkIHBpeGVscyB0byB0aGUgYXJyYXlcbiAgICAgICAgY29uc3QgZ2wgPSByZW5kZXJlci5nbDtcblxuICAgICAgICBnbC5yZWFkUGl4ZWxzKFxuICAgICAgICAgICAgZnJhbWUueCAqIHJlc29sdXRpb24sXG4gICAgICAgICAgICBmcmFtZS55ICogcmVzb2x1dGlvbixcbiAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgZ2wuUkdCQSxcbiAgICAgICAgICAgIGdsLlVOU0lHTkVEX0JZVEUsXG4gICAgICAgICAgICB3ZWJnbFBpeGVsc1xuICAgICAgICApO1xuXG4gICAgICAgIGlmIChnZW5lcmF0ZWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlbmRlclRleHR1cmUuZGVzdHJveSh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEV4dHJhY3QuYXJyYXlQb3N0RGl2aWRlKHdlYmdsUGl4ZWxzLCB3ZWJnbFBpeGVscyk7XG5cbiAgICAgICAgcmV0dXJuIHdlYmdsUGl4ZWxzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBleHRyYWN0XG4gICAgICpcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmV4dHJhY3QgPSBudWxsO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBwcmVtdWx0aXBsaWVkIHBpeGVsIGRhdGEgYW5kIHByb2R1Y2VzIHJlZ3VsYXIgcGl4ZWwgZGF0YVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gcGl4ZWxzIHtudW1iZXJbXSB8IFVpbnQ4QXJyYXkgfCBVaW50OENsYW1wZWRBcnJheX0gYXJyYXkgb2YgcGl4ZWwgZGF0YVxuICAgICAqIEBwYXJhbSBvdXQge251bWJlcltdIHwgVWludDhBcnJheSB8IFVpbnQ4Q2xhbXBlZEFycmF5fSBvdXRwdXQgYXJyYXlcbiAgICAgKi9cbiAgICBzdGF0aWMgYXJyYXlQb3N0RGl2aWRlKFxuICAgICAgICBwaXhlbHM6IG51bWJlcltdIHwgVWludDhBcnJheSB8IFVpbnQ4Q2xhbXBlZEFycmF5LCBvdXQ6IG51bWJlcltdIHwgVWludDhBcnJheSB8IFVpbnQ4Q2xhbXBlZEFycmF5XG4gICAgKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwaXhlbHMubGVuZ3RoOyBpICs9IDQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGFscGhhID0gb3V0W2kgKyAzXSA9IHBpeGVsc1tpICsgM107XG5cbiAgICAgICAgICAgIGlmIChhbHBoYSAhPT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBvdXRbaV0gPSBNYXRoLnJvdW5kKE1hdGgubWluKHBpeGVsc1tpXSAqIDI1NS4wIC8gYWxwaGEsIDI1NS4wKSk7XG4gICAgICAgICAgICAgICAgb3V0W2kgKyAxXSA9IE1hdGgucm91bmQoTWF0aC5taW4ocGl4ZWxzW2kgKyAxXSAqIDI1NS4wIC8gYWxwaGEsIDI1NS4wKSk7XG4gICAgICAgICAgICAgICAgb3V0W2kgKyAyXSA9IE1hdGgucm91bmQoTWF0aC5taW4ocGl4ZWxzW2kgKyAyXSAqIDI1NS4wIC8gYWxwaGEsIDI1NS4wKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb3V0W2ldID0gcGl4ZWxzW2ldO1xuICAgICAgICAgICAgICAgIG91dFtpICsgMV0gPSBwaXhlbHNbaSArIDFdO1xuICAgICAgICAgICAgICAgIG91dFtpICsgMl0gPSBwaXhlbHNbaSArIDJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwgIi8qKlxuICogU21hbGxlciB2ZXJzaW9uIG9mIHRoZSBhc3luYyBsaWJyYXJ5IGNvbnN0cnVjdHMuXG4gKlxuICogQG5hbWVzcGFjZSBhc3luY1xuICovXG5cbi8qKlxuICogTm9vcCBmdW5jdGlvblxuICpcbiAqIEBpZ25vcmVcbiAqIEBmdW5jdGlvblxuICogQG1lbWJlcm9mIGFzeW5jXG4gKi9cbmZ1bmN0aW9uIF9ub29wKCkgeyAvKiBlbXB0eSAqLyB9XG5cbi8qKlxuICogSXRlcmF0ZXMgYW4gYXJyYXkgaW4gc2VyaWVzLlxuICpcbiAqIEBtZW1iZXJvZiBhc3luY1xuICogQGZ1bmN0aW9uIGVhY2hTZXJpZXNcbiAqIEBwYXJhbSB7QXJyYXkuPCo+fSBhcnJheSAtIEFycmF5IHRvIGl0ZXJhdGUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBpdGVyYXRvciAtIEZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2ggZWxlbWVudC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIGRvbmUsIG9yIG9uIGVycm9yLlxuICogQHBhcmFtIHtib29sZWFufSBbZGVmZXJOZXh0PWZhbHNlXSAtIEJyZWFrIHN5bmNocm9ub3VzIGVhY2ggbG9vcCBieSBjYWxsaW5nIG5leHQgd2l0aCBhIHNldFRpbWVvdXQgb2YgMS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVhY2hTZXJpZXMoYXJyYXksIGl0ZXJhdG9yLCBjYWxsYmFjaywgZGVmZXJOZXh0KSB7XG4gICAgbGV0IGkgPSAwO1xuICAgIGNvbnN0IGxlbiA9IGFycmF5Lmxlbmd0aDtcblxuICAgIChmdW5jdGlvbiBuZXh0KGVycikge1xuICAgICAgICBpZiAoZXJyIHx8IGkgPT09IGxlbikge1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRlZmVyTmV4dCkge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3IoYXJyYXlbaSsrXSwgbmV4dCk7XG4gICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGl0ZXJhdG9yKGFycmF5W2krK10sIG5leHQpO1xuICAgICAgICB9XG4gICAgfSkoKTtcbn1cblxuLyoqXG4gKiBFbnN1cmVzIGEgZnVuY3Rpb24gaXMgb25seSBjYWxsZWQgb25jZS5cbiAqXG4gKiBAaWdub3JlXG4gKiBAbWVtYmVyb2YgYXN5bmNcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGZuIC0gVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gKiBAcmV0dXJuIHtmdW5jdGlvbn0gVGhlIHdyYXBwaW5nIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBvbmx5T25jZShmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiBvbmNlV3JhcHBlcigpIHtcbiAgICAgICAgaWYgKGZuID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxiYWNrIHdhcyBhbHJlYWR5IGNhbGxlZC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNhbGxGbiA9IGZuO1xuXG4gICAgICAgIGZuID0gbnVsbDtcbiAgICAgICAgY2FsbEZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBBc3luYyBxdWV1ZSBpbXBsZW1lbnRhdGlvbixcbiAqXG4gKiBAbWVtYmVyb2YgYXN5bmNcbiAqIEBmdW5jdGlvbiBxdWV1ZVxuICogQHBhcmFtIHtmdW5jdGlvbn0gd29ya2VyIC0gVGhlIHdvcmtlciBmdW5jdGlvbiB0byBjYWxsIGZvciBlYWNoIHRhc2suXG4gKiBAcGFyYW0ge251bWJlcn0gY29uY3VycmVuY3kgLSBIb3cgbWFueSB3b3JrZXJzIHRvIHJ1biBpbiBwYXJyYWxsZWwuXG4gKiBAcmV0dXJuIHsqfSBUaGUgYXN5bmMgcXVldWUgb2JqZWN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gcXVldWUod29ya2VyLCBjb25jdXJyZW5jeSkge1xuICAgIGlmIChjb25jdXJyZW5jeSA9PSBudWxsKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXEtbnVsbCxlcWVxZXFcbiAgICAgICAgY29uY3VycmVuY3kgPSAxO1xuICAgIH1cbiAgICBlbHNlIGlmIChjb25jdXJyZW5jeSA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbmN1cnJlbmN5IG11c3Qgbm90IGJlIHplcm8nKTtcbiAgICB9XG5cbiAgICBsZXQgd29ya2VycyA9IDA7XG4gICAgY29uc3QgcSA9IHtcbiAgICAgICAgX3Rhc2tzOiBbXSxcbiAgICAgICAgY29uY3VycmVuY3ksXG4gICAgICAgIHNhdHVyYXRlZDogX25vb3AsXG4gICAgICAgIHVuc2F0dXJhdGVkOiBfbm9vcCxcbiAgICAgICAgYnVmZmVyOiBjb25jdXJyZW5jeSAvIDQsXG4gICAgICAgIGVtcHR5OiBfbm9vcCxcbiAgICAgICAgZHJhaW46IF9ub29wLFxuICAgICAgICBlcnJvcjogX25vb3AsXG4gICAgICAgIHN0YXJ0ZWQ6IGZhbHNlLFxuICAgICAgICBwYXVzZWQ6IGZhbHNlLFxuICAgICAgICBwdXNoKGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBfaW5zZXJ0KGRhdGEsIGZhbHNlLCBjYWxsYmFjayk7XG4gICAgICAgIH0sXG4gICAgICAgIGtpbGwoKSB7XG4gICAgICAgICAgICB3b3JrZXJzID0gMDtcbiAgICAgICAgICAgIHEuZHJhaW4gPSBfbm9vcDtcbiAgICAgICAgICAgIHEuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgcS5fdGFza3MgPSBbXTtcbiAgICAgICAgfSxcbiAgICAgICAgdW5zaGlmdChkYXRhLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgX2luc2VydChkYXRhLCB0cnVlLCBjYWxsYmFjayk7XG4gICAgICAgIH0sXG4gICAgICAgIHByb2Nlc3MoKSB7XG4gICAgICAgICAgICB3aGlsZSAoIXEucGF1c2VkICYmIHdvcmtlcnMgPCBxLmNvbmN1cnJlbmN5ICYmIHEuX3Rhc2tzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhc2sgPSBxLl90YXNrcy5zaGlmdCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHEuX3Rhc2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBxLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VycyArPSAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKHdvcmtlcnMgPT09IHEuY29uY3VycmVuY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgcS5zYXR1cmF0ZWQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXIodGFzay5kYXRhLCBvbmx5T25jZShfbmV4dCh0YXNrKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBsZW5ndGgoKSB7XG4gICAgICAgICAgICByZXR1cm4gcS5fdGFza3MubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBydW5uaW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdvcmtlcnM7XG4gICAgICAgIH0sXG4gICAgICAgIGlkbGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gcS5fdGFza3MubGVuZ3RoICsgd29ya2VycyA9PT0gMDtcbiAgICAgICAgfSxcbiAgICAgICAgcGF1c2UoKSB7XG4gICAgICAgICAgICBpZiAocS5wYXVzZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVzdW1lKCkge1xuICAgICAgICAgICAgaWYgKHEucGF1c2VkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcS5wYXVzZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8gTmVlZCB0byBjYWxsIHEucHJvY2VzcyBvbmNlIHBlciBjb25jdXJyZW50XG4gICAgICAgICAgICAvLyB3b3JrZXIgdG8gcHJlc2VydmUgZnVsbCBjb25jdXJyZW5jeSBhZnRlciBwYXVzZVxuICAgICAgICAgICAgZm9yIChsZXQgdyA9IDE7IHcgPD0gcS5jb25jdXJyZW5jeTsgdysrKSB7XG4gICAgICAgICAgICAgICAgcS5wcm9jZXNzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIF9pbnNlcnQoZGF0YSwgaW5zZXJ0QXRGcm9udCwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXEtbnVsbCxlcWVxZXFcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndGFzayBjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHEuc3RhcnRlZCA9IHRydWU7XG5cbiAgICAgICAgaWYgKGRhdGEgPT0gbnVsbCAmJiBxLmlkbGUoKSkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWVxLW51bGwsZXFlcWVxXG4gICAgICAgICAgICAvLyBjYWxsIGRyYWluIGltbWVkaWF0ZWx5IGlmIHRoZXJlIGFyZSBubyB0YXNrc1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBxLmRyYWluKCksIDEpO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIGNhbGxiYWNrOiB0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicgPyBjYWxsYmFjayA6IF9ub29wLFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChpbnNlcnRBdEZyb250KSB7XG4gICAgICAgICAgICBxLl90YXNrcy51bnNoaWZ0KGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcS5fdGFza3MucHVzaChpdGVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcS5wcm9jZXNzKCksIDEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9uZXh0KHRhc2spIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICB3b3JrZXJzIC09IDE7XG5cbiAgICAgICAgICAgIHRhc2suY2FsbGJhY2suYXBwbHkodGFzaywgYXJndW1lbnRzKTtcblxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50c1swXSAhPSBudWxsKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXEtbnVsbCxlcWVxZXFcbiAgICAgICAgICAgICAgICBxLmVycm9yKGFyZ3VtZW50c1swXSwgdGFzay5kYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHdvcmtlcnMgPD0gKHEuY29uY3VycmVuY3kgLSBxLmJ1ZmZlcikpIHtcbiAgICAgICAgICAgICAgICBxLnVuc2F0dXJhdGVkKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChxLmlkbGUoKSkge1xuICAgICAgICAgICAgICAgIHEuZHJhaW4oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcS5wcm9jZXNzKCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHE7XG59XG4iLCAiLy8gYSBzaW1wbGUgaW4tbWVtb3J5IGNhY2hlIGZvciByZXNvdXJjZXNcbmNvbnN0IGNhY2hlID0ge307XG5cbi8qKlxuICogQSBzaW1wbGUgaW4tbWVtb3J5IGNhY2hlIGZvciByZXNvdXJjZS5cbiAqXG4gKiBAbWVtYmVyb2YgbWlkZGxld2FyZVxuICogQGZ1bmN0aW9uIGNhY2hpbmdcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBMb2FkZXIsIG1pZGRsZXdhcmUgfSBmcm9tICdyZXNvdXJjZS1sb2FkZXInO1xuICogY29uc3QgbG9hZGVyID0gbmV3IExvYWRlcigpO1xuICogbG9hZGVyLnVzZShtaWRkbGV3YXJlLmNhY2hpbmcpO1xuICogQHBhcmFtIHtSZXNvdXJjZX0gcmVzb3VyY2UgLSBDdXJyZW50IFJlc291cmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXh0IC0gQ2FsbGJhY2sgd2hlbiBjb21wbGV0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FjaGluZyhyZXNvdXJjZSwgbmV4dCkge1xuICAgIC8vIGlmIGNhY2hlZCwgdGhlbiBzZXQgZGF0YSBhbmQgY29tcGxldGUgdGhlIHJlc291cmNlXG4gICAgaWYgKGNhY2hlW3Jlc291cmNlLnVybF0pIHtcbiAgICAgICAgcmVzb3VyY2UuZGF0YSA9IGNhY2hlW3Jlc291cmNlLnVybF07XG4gICAgICAgIHJlc291cmNlLmNvbXBsZXRlKCk7IC8vIG1hcmtzIHJlc291cmNlIGxvYWQgY29tcGxldGUgYW5kIHN0b3BzIHByb2Nlc3NpbmcgYmVmb3JlIG1pZGRsZXdhcmVzXG4gICAgfVxuICAgIC8vIGlmIG5vdCBjYWNoZWQsIHdhaXQgZm9yIGNvbXBsZXRlIGFuZCBzdG9yZSBpdCBpbiB0aGUgY2FjaGUuXG4gICAgZWxzZSB7XG4gICAgICAgIHJlc291cmNlLm9uQ29tcGxldGUub25jZSgoKSA9PiAoY2FjaGVbdGhpcy51cmxdID0gdGhpcy5kYXRhKSk7XG4gICAgfVxuXG4gICAgbmV4dCgpO1xufVxuIiwgImltcG9ydCBwYXJzZVVyaSBmcm9tICdwYXJzZS11cmknO1xuaW1wb3J0IFNpZ25hbCBmcm9tICdtaW5pLXNpZ25hbHMnO1xuXG4vLyB0ZXN0cyBpZiBDT1JTIGlzIHN1cHBvcnRlZCBpbiBYSFIsIGlmIG5vdCB3ZSBuZWVkIHRvIHVzZSBYRFJcbmNvbnN0IHVzZVhkciA9ICEhKHdpbmRvdy5YRG9tYWluUmVxdWVzdCAmJiAhKCd3aXRoQ3JlZGVudGlhbHMnIGluIChuZXcgWE1MSHR0cFJlcXVlc3QoKSkpKTtcbmxldCB0ZW1wQW5jaG9yID0gbnVsbDtcblxuLy8gc29tZSBzdGF0dXMgY29uc3RhbnRzXG5jb25zdCBTVEFUVVNfTk9ORSA9IDA7XG5jb25zdCBTVEFUVVNfT0sgPSAyMDA7XG5jb25zdCBTVEFUVVNfRU1QVFkgPSAyMDQ7XG5jb25zdCBTVEFUVVNfSUVfQlVHX0VNUFRZID0gMTIyMztcbmNvbnN0IFNUQVRVU19UWVBFX09LID0gMjtcblxuLy8gbm9vcFxuZnVuY3Rpb24gX25vb3AoKSB7IC8qIGVtcHR5ICovIH1cblxuLyoqXG4gKiBNYW5hZ2VzIHRoZSBzdGF0ZSBhbmQgbG9hZGluZyBvZiBhIHJlc291cmNlIGFuZCBhbGwgY2hpbGQgcmVzb3VyY2VzLlxuICpcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBSZXNvdXJjZSB7XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbG9hZCB0eXBlIHRvIGJlIHVzZWQgZm9yIGEgc3BlY2lmaWMgZXh0ZW5zaW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHRuYW1lIC0gVGhlIGV4dGVuc2lvbiB0byBzZXQgdGhlIHR5cGUgZm9yLCBlLmcuIFwicG5nXCIgb3IgXCJmbnRcIlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2UuTE9BRF9UWVBFfSBsb2FkVHlwZSAtIFRoZSBsb2FkIHR5cGUgdG8gc2V0IGl0IHRvLlxuICAgICAqL1xuICAgIHN0YXRpYyBzZXRFeHRlbnNpb25Mb2FkVHlwZShleHRuYW1lLCBsb2FkVHlwZSkge1xuICAgICAgICBzZXRFeHRNYXAoUmVzb3VyY2UuX2xvYWRUeXBlTWFwLCBleHRuYW1lLCBsb2FkVHlwZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbG9hZCB0eXBlIHRvIGJlIHVzZWQgZm9yIGEgc3BlY2lmaWMgZXh0ZW5zaW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBleHRuYW1lIC0gVGhlIGV4dGVuc2lvbiB0byBzZXQgdGhlIHR5cGUgZm9yLCBlLmcuIFwicG5nXCIgb3IgXCJmbnRcIlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEV9IHhoclR5cGUgLSBUaGUgeGhyIHR5cGUgdG8gc2V0IGl0IHRvLlxuICAgICAqL1xuICAgIHN0YXRpYyBzZXRFeHRlbnNpb25YaHJUeXBlKGV4dG5hbWUsIHhoclR5cGUpIHtcbiAgICAgICAgc2V0RXh0TWFwKFJlc291cmNlLl94aHJUeXBlTWFwLCBleHRuYW1lLCB4aHJUeXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSByZXNvdXJjZSB0byBsb2FkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfSB1cmwgLSBUaGUgdXJsIGZvciB0aGlzIHJlc291cmNlLCBmb3IgYXVkaW8vdmlkZW8gbG9hZHMgeW91IGNhbiBwYXNzXG4gICAgICogICAgICBhbiBhcnJheSBvZiBzb3VyY2VzLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBUaGUgb3B0aW9ucyBmb3IgdGhlIGxvYWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd8Ym9vbGVhbn0gW29wdGlvbnMuY3Jvc3NPcmlnaW5dIC0gSXMgdGhpcyByZXF1ZXN0IGNyb3NzLW9yaWdpbj8gRGVmYXVsdCBpcyB0b1xuICAgICAqICAgICAgZGV0ZXJtaW5lIGF1dG9tYXRpY2FsbHkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnRpbWVvdXQ9MF0gLSBBIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzIGZvciB0aGUgbG9hZC4gSWYgdGhlIGxvYWQgdGFrZXNcbiAgICAgKiAgICAgIGxvbmdlciB0aGFuIHRoaXMgdGltZSBpdCBpcyBjYW5jZWxsZWQgYW5kIHRoZSBsb2FkIGlzIGNvbnNpZGVyZWQgYSBmYWlsdXJlLiBJZiB0aGlzIHZhbHVlIGlzXG4gICAgICogICAgICBzZXQgdG8gYDBgIHRoZW4gdGhlcmUgaXMgbm8gZXhwbGljaXQgdGltZW91dC5cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLkxPQURfVFlQRX0gW29wdGlvbnMubG9hZFR5cGU9UmVzb3VyY2UuTE9BRF9UWVBFLlhIUl0gLSBIb3cgc2hvdWxkIHRoaXMgcmVzb3VyY2VcbiAgICAgKiAgICAgIGJlIGxvYWRlZD9cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFfSBbb3B0aW9ucy54aHJUeXBlPVJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkRFRkFVTFRdIC0gSG93XG4gICAgICogICAgICBzaG91bGQgdGhlIGRhdGEgYmVpbmcgbG9hZGVkIGJlIGludGVycHJldGVkIHdoZW4gdXNpbmcgWEhSP1xuICAgICAqIEBwYXJhbSB7UmVzb3VyY2UuSU1ldGFkYXRhfSBbb3B0aW9ucy5tZXRhZGF0YV0gLSBFeHRyYSBjb25maWd1cmF0aW9uIGZvciBtaWRkbGV3YXJlIGFuZCB0aGUgUmVzb3VyY2Ugb2JqZWN0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG5hbWUsIHVybCwgb3B0aW9ucykge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnIHx8IHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JvdGggbmFtZSBhbmQgdXJsIGFyZSByZXF1aXJlZCBmb3IgY29uc3RydWN0aW5nIGEgcmVzb3VyY2UuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHN0YXRlIGZsYWdzIG9mIHRoaXMgcmVzb3VyY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2ZsYWdzID0gMDtcblxuICAgICAgICAvLyBzZXQgZGF0YSB1cmwgZmxhZywgbmVlZHMgdG8gYmUgc2V0IGVhcmx5IGZvciBzb21lIF9kZXRlcm1pbmVYIGNoZWNrcyB0byB3b3JrLlxuICAgICAgICB0aGlzLl9zZXRGbGFnKFJlc291cmNlLlNUQVRVU19GTEFHUy5EQVRBX1VSTCwgdXJsLmluZGV4T2YoJ2RhdGE6JykgPT09IDApO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbmFtZSBvZiB0aGlzIHJlc291cmNlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHVybCB1c2VkIHRvIGxvYWQgdGhpcyByZXNvdXJjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXJsID0gdXJsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZXh0ZW5zaW9uIHVzZWQgdG8gbG9hZCB0aGlzIHJlc291cmNlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5leHRlbnNpb24gPSB0aGlzLl9nZXRFeHRlbnNpb24oKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRhdGEgdGhhdCB3YXMgbG9hZGVkIGJ5IHRoZSByZXNvdXJjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7YW55fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRhID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSXMgdGhpcyByZXF1ZXN0IGNyb3NzLW9yaWdpbj8gSWYgdW5zZXQsIGRldGVybWluZWQgYXV0b21hdGljYWxseS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jcm9zc09yaWdpbiA9IG9wdGlvbnMuY3Jvc3NPcmlnaW4gPT09IHRydWUgPyAnYW5vbnltb3VzJyA6IG9wdGlvbnMuY3Jvc3NPcmlnaW47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSBsb2FkLiBJZiB0aGUgbG9hZCB0YWtlcyBsb25nZXIgdGhhbiB0aGlzIHRpbWVcbiAgICAgICAgICogaXQgaXMgY2FuY2VsbGVkIGFuZCB0aGUgbG9hZCBpcyBjb25zaWRlcmVkIGEgZmFpbHVyZS4gSWYgdGhpcyB2YWx1ZSBpcyBzZXQgdG8gYDBgXG4gICAgICAgICAqIHRoZW4gdGhlcmUgaXMgbm8gZXhwbGljaXQgdGltZW91dC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0IHx8IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtZXRob2Qgb2YgbG9hZGluZyB0byB1c2UgZm9yIHRoaXMgcmVzb3VyY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1Jlc291cmNlLkxPQURfVFlQRX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9hZFR5cGUgPSBvcHRpb25zLmxvYWRUeXBlIHx8IHRoaXMuX2RldGVybWluZUxvYWRUeXBlKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0eXBlIHVzZWQgdG8gbG9hZCB0aGUgcmVzb3VyY2UgdmlhIFhIUi4gSWYgdW5zZXQsIGRldGVybWluZWQgYXV0b21hdGljYWxseS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy54aHJUeXBlID0gb3B0aW9ucy54aHJUeXBlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFeHRyYSBpbmZvIGZvciBtaWRkbGV3YXJlLCBhbmQgY29udHJvbGxpbmcgc3BlY2lmaWNzIGFib3V0IGhvdyB0aGUgcmVzb3VyY2UgbG9hZHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIE5vdGUgdGhhdCBpZiB5b3UgcGFzcyBpbiBhIGBsb2FkRWxlbWVudGAsIHRoZSBSZXNvdXJjZSBjbGFzcyB0YWtlcyBvd25lcnNoaXAgb2YgaXQuXG4gICAgICAgICAqIE1lYW5pbmcgaXQgd2lsbCBtb2RpZnkgaXQgYXMgaXQgc2VlcyBmaXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1Jlc291cmNlLklNZXRhZGF0YX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWV0YWRhdGEgPSBvcHRpb25zLm1ldGFkYXRhIHx8IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZXJyb3IgdGhhdCBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIChpZiBhbnkpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7RXJyb3J9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIFhIUiBvYmplY3QgdGhhdCB3YXMgdXNlZCB0byBsb2FkIHRoaXMgcmVzb3VyY2UuIFRoaXMgaXMgb25seSBzZXRcbiAgICAgICAgICogd2hlbiBgbG9hZFR5cGVgIGlzIGBSZXNvdXJjZS5MT0FEX1RZUEUuWEhSYC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge1hNTEh0dHBSZXF1ZXN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy54aHIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgY2hpbGQgcmVzb3VyY2VzIHRoaXMgcmVzb3VyY2Ugb3ducy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge1Jlc291cmNlW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoaWxkcmVuID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByZXNvdXJjZSB0eXBlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7UmVzb3VyY2UuVFlQRX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuVU5LTk9XTjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHByb2dyZXNzIGNodW5rIG93bmVkIGJ5IHRoaXMgcmVzb3VyY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnByb2dyZXNzQ2h1bmsgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYGRlcXVldWVgIG1ldGhvZCB0aGF0IHdpbGwgYmUgdXNlZCBhIHN0b3JhZ2UgcGxhY2UgZm9yIHRoZSBhc3luYyBxdWV1ZSBkZXF1ZXVlIG1ldGhvZFxuICAgICAgICAgKiB1c2VkIHByaXZhdGVseSBieSB0aGUgbG9hZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtmdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2RlcXVldWUgPSBfbm9vcDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlZCBhIHN0b3JhZ2UgcGxhY2UgZm9yIHRoZSBvbiBsb2FkIGJpbmRpbmcgdXNlZCBwcml2YXRlbHkgYnkgdGhlIGxvYWRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7ZnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9vbkxvYWRCaW5kaW5nID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRpbWVyIGZvciBlbGVtZW50IGxvYWRzIHRvIGNoZWNrIGlmIHRoZXkgdGltZW91dC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZWxlbWVudFRpbWVyID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGBjb21wbGV0ZWAgZnVuY3Rpb24gYm91bmQgdG8gdGhpcyByZXNvdXJjZSdzIGNvbnRleHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRDb21wbGV0ZSA9IHRoaXMuY29tcGxldGUuYmluZCh0aGlzKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGBfb25FcnJvcmAgZnVuY3Rpb24gYm91bmQgdG8gdGhpcyByZXNvdXJjZSdzIGNvbnRleHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRPbkVycm9yID0gdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYF9vblByb2dyZXNzYCBmdW5jdGlvbiBib3VuZCB0byB0aGlzIHJlc291cmNlJ3MgY29udGV4dC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7ZnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9ib3VuZE9uUHJvZ3Jlc3MgPSB0aGlzLl9vblByb2dyZXNzLmJpbmQodGhpcyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBgX29uVGltZW91dGAgZnVuY3Rpb24gYm91bmQgdG8gdGhpcyByZXNvdXJjZSdzIGNvbnRleHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRPblRpbWVvdXQgPSB0aGlzLl9vblRpbWVvdXQuYmluZCh0aGlzKTtcblxuICAgICAgICAvLyB4aHIgY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuX2JvdW5kWGhyT25FcnJvciA9IHRoaXMuX3hock9uRXJyb3IuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fYm91bmRYaHJPblRpbWVvdXQgPSB0aGlzLl94aHJPblRpbWVvdXQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fYm91bmRYaHJPbkFib3J0ID0gdGhpcy5feGhyT25BYm9ydC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9ib3VuZFhock9uTG9hZCA9IHRoaXMuX3hock9uTG9hZC5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwYXRjaGVkIHdoZW4gdGhlIHJlc291cmNlIGJlaW5ncyB0byBsb2FkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgbG9va3MgbGlrZSB7QGxpbmsgUmVzb3VyY2UuT25TdGFydFNpZ25hbH0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1NpZ25hbDxSZXNvdXJjZS5PblN0YXJ0U2lnbmFsPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25TdGFydCA9IG5ldyBTaWduYWwoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGF0Y2hlZCBlYWNoIHRpbWUgcHJvZ3Jlc3Mgb2YgdGhpcyByZXNvdXJjZSBsb2FkIHVwZGF0ZXMuXG4gICAgICAgICAqIE5vdCBhbGwgcmVzb3VyY2VzIHR5cGVzIGFuZCBsb2FkZXIgc3lzdGVtcyBjYW4gc3VwcG9ydCB0aGlzIGV2ZW50XG4gICAgICAgICAqIHNvIHNvbWV0aW1lcyBpdCBtYXkgbm90IGJlIGF2YWlsYWJsZS4gSWYgdGhlIHJlc291cmNlXG4gICAgICAgICAqIGlzIGJlaW5nIGxvYWRlZCBvbiBhIG1vZGVybiBicm93c2VyLCB1c2luZyBYSFIsIGFuZCB0aGUgcmVtb3RlIHNlcnZlclxuICAgICAgICAgKiBwcm9wZXJseSBzZXRzIENvbnRlbnQtTGVuZ3RoIGhlYWRlcnMsIHRoZW4gdGhpcyB3aWxsIGJlIGF2YWlsYWJsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGNhbGxiYWNrIGxvb2tzIGxpa2Uge0BsaW5rIFJlc291cmNlLk9uUHJvZ3Jlc3NTaWduYWx9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtTaWduYWw8UmVzb3VyY2UuT25Qcm9ncmVzc1NpZ25hbD59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uUHJvZ3Jlc3MgPSBuZXcgU2lnbmFsKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BhdGNoZWQgb25jZSB0aGlzIHJlc291cmNlIGhhcyBsb2FkZWQsIGlmIHRoZXJlIHdhcyBhbiBlcnJvciBpdCB3aWxsXG4gICAgICAgICAqIGJlIGluIHRoZSBgZXJyb3JgIHByb3BlcnR5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgbG9va3MgbGlrZSB7QGxpbmsgUmVzb3VyY2UuT25Db21wbGV0ZVNpZ25hbH0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1NpZ25hbDxSZXNvdXJjZS5PbkNvbXBsZXRlU2lnbmFsPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Db21wbGV0ZSA9IG5ldyBTaWduYWwoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGF0Y2hlZCBhZnRlciB0aGlzIHJlc291cmNlIGhhcyBoYWQgYWxsIHRoZSAqYWZ0ZXIqIG1pZGRsZXdhcmUgcnVuIG9uIGl0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgbG9va3MgbGlrZSB7QGxpbmsgUmVzb3VyY2UuT25Db21wbGV0ZVNpZ25hbH0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1NpZ25hbDxSZXNvdXJjZS5PbkNvbXBsZXRlU2lnbmFsPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25BZnRlck1pZGRsZXdhcmUgPSBuZXcgU2lnbmFsKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgcmVzb3VyY2Ugc3RhcnRzIHRvIGxvYWQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgUmVzb3VyY2VcbiAgICAgKiBAY2FsbGJhY2sgT25TdGFydFNpZ25hbFxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2V9IHJlc291cmNlIC0gVGhlIHJlc291cmNlIHRoYXQgdGhlIGV2ZW50IGhhcHBlbmVkIG9uLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgcmVzb3VyY2UgcmVwb3J0cyBsb2FkaW5nIHByb2dyZXNzLlxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFJlc291cmNlXG4gICAgICogQGNhbGxiYWNrIE9uUHJvZ3Jlc3NTaWduYWxcbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSB0aGF0IHRoZSBldmVudCBoYXBwZW5lZCBvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcGVyY2VudGFnZSAtIFRoZSBwcm9ncmVzcyBvZiB0aGUgbG9hZCBpbiB0aGUgcmFuZ2UgWzAsIDFdLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgcmVzb3VyY2UgZmluaXNoZXMgbG9hZGluZy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBSZXNvdXJjZVxuICAgICAqIEBjYWxsYmFjayBPbkNvbXBsZXRlU2lnbmFsXG4gICAgICogQHBhcmFtIHtSZXNvdXJjZX0gcmVzb3VyY2UgLSBUaGUgcmVzb3VyY2UgdGhhdCB0aGUgZXZlbnQgaGFwcGVuZWQgb24uXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgUmVzb3VyY2VcbiAgICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBJTWV0YWRhdGFcbiAgICAgKiBAcHJvcGVydHkge0hUTUxJbWFnZUVsZW1lbnR8SFRNTEF1ZGlvRWxlbWVudHxIVE1MVmlkZW9FbGVtZW50fSBbbG9hZEVsZW1lbnQ9bnVsbF0gLSBUaGVcbiAgICAgKiAgICAgIGVsZW1lbnQgdG8gdXNlIGZvciBsb2FkaW5nLCBpbnN0ZWFkIG9mIGNyZWF0aW5nIG9uZS5cbiAgICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IFtza2lwU291cmNlPWZhbHNlXSAtIFNraXBzIGFkZGluZyBzb3VyY2UocykgdG8gdGhlIGxvYWQgZWxlbWVudC4gVGhpc1xuICAgICAqICAgICAgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIHBhc3MgaW4gYSBgbG9hZEVsZW1lbnRgIHRoYXQgeW91IGFscmVhZHkgYWRkZWQgbG9hZCBzb3VyY2VzIHRvLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfHN0cmluZ1tdfSBbbWltZVR5cGVdIC0gVGhlIG1pbWUgdHlwZSB0byB1c2UgZm9yIHRoZSBzb3VyY2UgZWxlbWVudFxuICAgICAqICAgICAgb2YgYSB2aWRlby9hdWRpbyBlbG1lbnQuIElmIHRoZSB1cmxzIGFyZSBhbiBhcnJheSwgeW91IGNhbiBwYXNzIHRoaXMgYXMgYW4gYXJyYXkgYXMgd2VsbFxuICAgICAqICAgICAgd2hlcmUgZWFjaCBpbmRleCBpcyB0aGUgbWltZSB0eXBlIHRvIHVzZSBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgdXJsIGluZGV4LlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogU3RvcmVzIHdoZXRoZXIgb3Igbm90IHRoaXMgdXJsIGlzIGEgZGF0YSB1cmwuXG4gICAgICpcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBpc0RhdGFVcmwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oYXNGbGFnKFJlc291cmNlLlNUQVRVU19GTEFHUy5EQVRBX1VSTCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzY3JpYmVzIGlmIHRoaXMgcmVzb3VyY2UgaGFzIGZpbmlzaGVkIGxvYWRpbmcuIElzIHRydWUgd2hlbiB0aGUgcmVzb3VyY2UgaGFzIGNvbXBsZXRlbHlcbiAgICAgKiBsb2FkZWQuXG4gICAgICpcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBpc0NvbXBsZXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGFzRmxhZyhSZXNvdXJjZS5TVEFUVVNfRkxBR1MuQ09NUExFVEUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc2NyaWJlcyBpZiB0aGlzIHJlc291cmNlIGlzIGN1cnJlbnRseSBsb2FkaW5nLiBJcyB0cnVlIHdoZW4gdGhlIHJlc291cmNlIHN0YXJ0cyBsb2FkaW5nLFxuICAgICAqIGFuZCBpcyBmYWxzZSBhZ2FpbiB3aGVuIGNvbXBsZXRlLlxuICAgICAqXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgaXNMb2FkaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGFzRmxhZyhSZXNvdXJjZS5TVEFUVVNfRkxBR1MuTE9BRElORyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFya3MgdGhlIHJlc291cmNlIGFzIGNvbXBsZXRlLlxuICAgICAqXG4gICAgICovXG4gICAgY29tcGxldGUoKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX2ZpbmlzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFib3J0cyB0aGUgbG9hZGluZyBvZiB0aGlzIHJlc291cmNlLCB3aXRoIGFuIG9wdGlvbmFsIG1lc3NhZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIFRoZSBtZXNzYWdlIHRvIHVzZSBmb3IgdGhlIGVycm9yXG4gICAgICovXG4gICAgYWJvcnQobWVzc2FnZSkge1xuICAgICAgICAvLyBhYm9ydCBjYW4gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLCBpZ25vcmUgc3Vic2VxdWVudCBjYWxscy5cbiAgICAgICAgaWYgKHRoaXMuZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHN0b3JlIGVycm9yXG4gICAgICAgIHRoaXMuZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG5cbiAgICAgICAgLy8gY2xlYXIgZXZlbnRzIGJlZm9yZSBjYWxsaW5nIGFib3J0c1xuICAgICAgICB0aGlzLl9jbGVhckV2ZW50cygpO1xuXG4gICAgICAgIC8vIGFib3J0IHRoZSBhY3R1YWwgbG9hZGluZ1xuICAgICAgICBpZiAodGhpcy54aHIpIHtcbiAgICAgICAgICAgIHRoaXMueGhyLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy54ZHIpIHtcbiAgICAgICAgICAgIHRoaXMueGRyLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5kYXRhKSB7XG4gICAgICAgICAgICAvLyBzaW5nbGUgc291cmNlXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhLnNyYykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5zcmMgPSBSZXNvdXJjZS5FTVBUWV9HSUY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtdWx0aS1zb3VyY2VcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmRhdGEuZmlyc3RDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEucmVtb3ZlQ2hpbGQodGhpcy5kYXRhLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRvbmUgbm93LlxuICAgICAgICB0aGlzLl9maW5pc2goKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLaWNrcyBvZmYgbG9hZGluZyBvZiB0aGlzIHJlc291cmNlLiBUaGlzIG1ldGhvZCBpcyBhc3luY2hyb25vdXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLk9uQ29tcGxldGVTaWduYWx9IFtjYl0gLSBPcHRpb25hbCBjYWxsYmFjayB0byBjYWxsIG9uY2UgdGhlIHJlc291cmNlIGlzIGxvYWRlZC5cbiAgICAgKi9cbiAgICBsb2FkKGNiKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaXNDb21wbGV0ZSkge1xuICAgICAgICAgICAgaWYgKGNiKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBjYih0aGlzKSwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYikge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlLm9uY2UoY2IpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2V0RmxhZyhSZXNvdXJjZS5TVEFUVVNfRkxBR1MuTE9BRElORywgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5vblN0YXJ0LmRpc3BhdGNoKHRoaXMpO1xuXG4gICAgICAgIC8vIGlmIHVuc2V0LCBkZXRlcm1pbmUgdGhlIHZhbHVlXG4gICAgICAgIGlmICh0aGlzLmNyb3NzT3JpZ2luID09PSBmYWxzZSB8fCB0eXBlb2YgdGhpcy5jcm9zc09yaWdpbiAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHRoaXMuY3Jvc3NPcmlnaW4gPSB0aGlzLl9kZXRlcm1pbmVDcm9zc09yaWdpbih0aGlzLnVybCk7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKHRoaXMubG9hZFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuTE9BRF9UWVBFLklNQUdFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuSU1BR0U7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZEVsZW1lbnQoJ2ltYWdlJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuTE9BRF9UWVBFLkFVRElPOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuQVVESU87XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZFNvdXJjZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuTE9BRF9UWVBFLlZJREVPOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuVklERU87XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZFNvdXJjZUVsZW1lbnQoJ3ZpZGVvJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuTE9BRF9UWVBFLlhIUjpcbiAgICAgICAgICAgICAgICAvKiBmYWxscyB0aHJvdWdoICovXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlmICh1c2VYZHIgJiYgdGhpcy5jcm9zc09yaWdpbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkWGRyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkWGhyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIHRoZSBmbGFnIGlzIHNldC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGZsYWcgLSBUaGUgZmxhZyB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBmbGFnIGlzIHNldC5cbiAgICAgKi9cbiAgICBfaGFzRmxhZyhmbGFnKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fZmxhZ3MgJiBmbGFnKSAhPT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAoVW4pU2V0cyB0aGUgZmxhZy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGZsYWcgLSBUaGUgZmxhZyB0byAodW4pc2V0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsdWUgLSBXaGV0aGVyIHRvIHNldCBvciAodW4pc2V0IHRoZSBmbGFnLlxuICAgICAqL1xuICAgIF9zZXRGbGFnKGZsYWcsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2ZsYWdzID0gdmFsdWUgPyAodGhpcy5fZmxhZ3MgfCBmbGFnKSA6ICh0aGlzLl9mbGFncyAmIH5mbGFnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHRoZSBldmVudHMgZnJvbSB0aGUgdW5kZXJseWluZyBsb2FkaW5nIHNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NsZWFyRXZlbnRzKCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fZWxlbWVudFRpbWVyKTtcblxuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9ib3VuZE9uRXJyb3IsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgdGhpcy5fYm91bmRDb21wbGV0ZSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5kYXRhLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5fYm91bmRPblByb2dyZXNzLCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmRhdGEucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCB0aGlzLl9ib3VuZENvbXBsZXRlLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy54aHIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnhoci5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy54aHIucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9ib3VuZFhock9uRXJyb3IsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnhoci5yZW1vdmVFdmVudExpc3RlbmVyKCd0aW1lb3V0JywgdGhpcy5fYm91bmRYaHJPblRpbWVvdXQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnhoci5yZW1vdmVFdmVudExpc3RlbmVyKCdhYm9ydCcsIHRoaXMuX2JvdW5kWGhyT25BYm9ydCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMueGhyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5fYm91bmRPblByb2dyZXNzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy54aHIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZCcsIHRoaXMuX2JvdW5kWGhyT25Mb2FkLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnhoci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnhoci5vbnRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMueGhyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMueGhyLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5hbGl6ZXMgdGhlIGxvYWQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9maW5pc2goKSB7XG4gICAgICAgIGlmICh0aGlzLmlzQ29tcGxldGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ29tcGxldGUgY2FsbGVkIGFnYWluIGZvciBhbiBhbHJlYWR5IGNvbXBsZXRlZCByZXNvdXJjZS4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3NldEZsYWcoUmVzb3VyY2UuU1RBVFVTX0ZMQUdTLkNPTVBMRVRFLCB0cnVlKTtcbiAgICAgICAgdGhpcy5fc2V0RmxhZyhSZXNvdXJjZS5TVEFUVVNfRkxBR1MuTE9BRElORywgZmFsc2UpO1xuXG4gICAgICAgIHRoaXMub25Db21wbGV0ZS5kaXNwYXRjaCh0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyB0aGlzIHJlc291cmNlcyB1c2luZyBhbiBlbGVtZW50IHRoYXQgaGFzIGEgc2luZ2xlIHNvdXJjZSxcbiAgICAgKiBsaWtlIGFuIEhUTUxJbWFnZUVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gVGhlIHR5cGUgb2YgZWxlbWVudCB0byB1c2UuXG4gICAgICovXG4gICAgX2xvYWRFbGVtZW50KHR5cGUpIHtcbiAgICAgICAgaWYgKHRoaXMubWV0YWRhdGEubG9hZEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMubWV0YWRhdGEubG9hZEVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gJ2ltYWdlJyAmJiB0eXBlb2Ygd2luZG93LkltYWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhpcy5kYXRhID0gbmV3IEltYWdlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuY3Jvc3NPcmlnaW4pIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5jcm9zc09yaWdpbiA9IHRoaXMuY3Jvc3NPcmlnaW47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMubWV0YWRhdGEuc2tpcFNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhLnNyYyA9IHRoaXMudXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fYm91bmRPbkVycm9yLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuZGF0YS5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgdGhpcy5fYm91bmRDb21wbGV0ZSwgZmFsc2UpO1xuICAgICAgICB0aGlzLmRhdGEuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCB0aGlzLl9ib3VuZE9uUHJvZ3Jlc3MsIGZhbHNlKTtcblxuICAgICAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50VGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuX2JvdW5kT25UaW1lb3V0LCB0aGlzLnRpbWVvdXQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhpcyByZXNvdXJjZXMgdXNpbmcgYW4gZWxlbWVudCB0aGF0IGhhcyBtdWx0aXBsZSBzb3VyY2VzLFxuICAgICAqIGxpa2UgYW4gSFRNTEF1ZGlvRWxlbWVudCBvciBIVE1MVmlkZW9FbGVtZW50LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSB0eXBlIG9mIGVsZW1lbnQgdG8gdXNlLlxuICAgICAqL1xuICAgIF9sb2FkU291cmNlRWxlbWVudCh0eXBlKSB7XG4gICAgICAgIGlmICh0aGlzLm1ldGFkYXRhLmxvYWRFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLm1ldGFkYXRhLmxvYWRFbGVtZW50O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGUgPT09ICdhdWRpbycgJiYgdHlwZW9mIHdpbmRvdy5BdWRpbyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IG5ldyBBdWRpbygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kYXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYWJvcnQoYFVuc3VwcG9ydGVkIGVsZW1lbnQ6ICR7dHlwZX1gKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuY3Jvc3NPcmlnaW4pIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5jcm9zc09yaWdpbiA9IHRoaXMuY3Jvc3NPcmlnaW47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMubWV0YWRhdGEuc2tpcFNvdXJjZSkge1xuICAgICAgICAgICAgLy8gc3VwcG9ydCBmb3IgQ29jb29uSlMgQ2FudmFzKyBydW50aW1lLCBsYWNrcyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKVxuICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5pc0NvY29vbkpTKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhLnNyYyA9IEFycmF5LmlzQXJyYXkodGhpcy51cmwpID8gdGhpcy51cmxbMF0gOiB0aGlzLnVybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodGhpcy51cmwpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWltZVR5cGVzID0gdGhpcy5tZXRhZGF0YS5taW1lVHlwZTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy51cmwubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmFwcGVuZENoaWxkKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlU291cmNlKHR5cGUsIHRoaXMudXJsW2ldLCBBcnJheS5pc0FycmF5KG1pbWVUeXBlcykgPyBtaW1lVHlwZXNbaV0gOiBtaW1lVHlwZXMpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWltZVR5cGVzID0gdGhpcy5tZXRhZGF0YS5taW1lVHlwZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlU291cmNlKHR5cGUsIHRoaXMudXJsLCBBcnJheS5pc0FycmF5KG1pbWVUeXBlcykgPyBtaW1lVHlwZXNbMF0gOiBtaW1lVHlwZXMpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGF0YS5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuX2JvdW5kT25FcnJvciwgZmFsc2UpO1xuICAgICAgICB0aGlzLmRhdGEuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHRoaXMuX2JvdW5kQ29tcGxldGUsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5kYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5fYm91bmRPblByb2dyZXNzLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuZGF0YS5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHRoaXMuX2JvdW5kQ29tcGxldGUsIGZhbHNlKTtcblxuICAgICAgICB0aGlzLmRhdGEubG9hZCgpO1xuXG4gICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRUaW1lciA9IHNldFRpbWVvdXQodGhpcy5fYm91bmRPblRpbWVvdXQsIHRoaXMudGltZW91dCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyB0aGlzIHJlc291cmNlcyB1c2luZyBhbiBYTUxIdHRwUmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2xvYWRYaHIoKSB7XG4gICAgICAgIC8vIGlmIHVuc2V0LCBkZXRlcm1pbmUgdGhlIHZhbHVlXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy54aHJUeXBlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy54aHJUeXBlID0gdGhpcy5fZGV0ZXJtaW5lWGhyVHlwZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeGhyID0gdGhpcy54aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICAvLyBzZXQgdGhlIHJlcXVlc3QgdHlwZSBhbmQgdXJsXG4gICAgICAgIHhoci5vcGVuKCdHRVQnLCB0aGlzLnVybCwgdHJ1ZSk7XG5cbiAgICAgICAgeGhyLnRpbWVvdXQgPSB0aGlzLnRpbWVvdXQ7XG5cbiAgICAgICAgLy8gbG9hZCBqc29uIGFzIHRleHQgYW5kIHBhcnNlIGl0IG91cnNlbHZlcy4gV2UgZG8gdGhpcyBiZWNhdXNlIHNvbWUgYnJvd3NlcnNcbiAgICAgICAgLy8gKmNvdWdoKiBzYWZhcmkgKmNvdWdoKiBjYW4ndCBkZWFsIHdpdGggaXQuXG4gICAgICAgIGlmICh0aGlzLnhoclR5cGUgPT09IFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkpTT04gfHwgdGhpcy54aHJUeXBlID09PSBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCkge1xuICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLlRFWFQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gdGhpcy54aHJUeXBlO1xuICAgICAgICB9XG5cbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fYm91bmRYaHJPbkVycm9yLCBmYWxzZSk7XG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCd0aW1lb3V0JywgdGhpcy5fYm91bmRYaHJPblRpbWVvdXQsIGZhbHNlKTtcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgdGhpcy5fYm91bmRYaHJPbkFib3J0LCBmYWxzZSk7XG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHRoaXMuX2JvdW5kT25Qcm9ncmVzcywgZmFsc2UpO1xuICAgICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHRoaXMuX2JvdW5kWGhyT25Mb2FkLCBmYWxzZSk7XG5cbiAgICAgICAgeGhyLnNlbmQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyB0aGlzIHJlc291cmNlcyB1c2luZyBhbiBYRG9tYWluUmVxdWVzdC4gVGhpcyBpcyBoZXJlIGJlY2F1c2Ugd2UgbmVlZCB0byBzdXBwb3J0IElFOSAoZ3Jvc3MpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfbG9hZFhkcigpIHtcbiAgICAgICAgLy8gaWYgdW5zZXQsIGRldGVybWluZSB0aGUgdmFsdWVcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnhoclR5cGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aGlzLnhoclR5cGUgPSB0aGlzLl9kZXRlcm1pbmVYaHJUeXBlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB4ZHIgPSB0aGlzLnhociA9IG5ldyBYRG9tYWluUmVxdWVzdCgpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG5cbiAgICAgICAgLy8gWERvbWFpblJlcXVlc3QgaGFzIGEgZmV3IHF1aXJrcy4gT2NjYXNpb25hbGx5IGl0IHdpbGwgYWJvcnQgcmVxdWVzdHNcbiAgICAgICAgLy8gQSB3YXkgdG8gYXZvaWQgdGhpcyBpcyB0byBtYWtlIHN1cmUgQUxMIGNhbGxiYWNrcyBhcmUgc2V0IGV2ZW4gaWYgbm90IHVzZWRcbiAgICAgICAgLy8gTW9yZSBpbmZvIGhlcmU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTU3ODY5NjYveGRvbWFpbnJlcXVlc3QtYWJvcnRzLXBvc3Qtb24taWUtOVxuICAgICAgICB4ZHIudGltZW91dCA9IHRoaXMudGltZW91dCB8fCA1MDAwOyAvLyBYRFIgbmVlZHMgYSB0aW1lb3V0IHZhbHVlIG9yIGl0IGJyZWFrcyBpbiBJRTlcblxuICAgICAgICB4ZHIub25lcnJvciA9IHRoaXMuX2JvdW5kWGhyT25FcnJvcjtcbiAgICAgICAgeGRyLm9udGltZW91dCA9IHRoaXMuX2JvdW5kWGhyT25UaW1lb3V0O1xuICAgICAgICB4ZHIub25wcm9ncmVzcyA9IHRoaXMuX2JvdW5kT25Qcm9ncmVzcztcbiAgICAgICAgeGRyLm9ubG9hZCA9IHRoaXMuX2JvdW5kWGhyT25Mb2FkO1xuXG4gICAgICAgIHhkci5vcGVuKCdHRVQnLCB0aGlzLnVybCwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gTm90ZTogVGhlIHhkci5zZW5kKCkgY2FsbCBpcyB3cmFwcGVkIGluIGEgdGltZW91dCB0byBwcmV2ZW50IGFuXG4gICAgICAgIC8vIGlzc3VlIHdpdGggdGhlIGludGVyZmFjZSB3aGVyZSBzb21lIHJlcXVlc3RzIGFyZSBsb3N0IGlmIG11bHRpcGxlXG4gICAgICAgIC8vIFhEb21haW5SZXF1ZXN0cyBhcmUgYmVpbmcgc2VudCBhdCB0aGUgc2FtZSB0aW1lLlxuICAgICAgICAvLyBTb21lIGluZm8gaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL3Bob3RvbnN0b3JtL3BoYXNlci9pc3N1ZXMvMTI0OFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHhkci5zZW5kKCksIDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzb3VyY2UgdXNlZCBpbiBsb2FkaW5nIHZpYSBhbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSBlbGVtZW50IHR5cGUgKHZpZGVvIG9yIGF1ZGlvKS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVGhlIHNvdXJjZSBVUkwgdG8gbG9hZCBmcm9tLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbWltZV0gLSBUaGUgbWltZSB0eXBlIG9mIHRoZSB2aWRlb1xuICAgICAqIEByZXR1cm4ge0hUTUxTb3VyY2VFbGVtZW50fSBUaGUgc291cmNlIGVsZW1lbnQuXG4gICAgICovXG4gICAgX2NyZWF0ZVNvdXJjZSh0eXBlLCB1cmwsIG1pbWUpIHtcbiAgICAgICAgaWYgKCFtaW1lKSB7XG4gICAgICAgICAgICBtaW1lID0gYCR7dHlwZX0vJHt0aGlzLl9nZXRFeHRlbnNpb24odXJsKX1gO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG5cbiAgICAgICAgc291cmNlLnNyYyA9IHVybDtcbiAgICAgICAgc291cmNlLnR5cGUgPSBtaW1lO1xuXG4gICAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGlmIGEgbG9hZCBlcnJvcnMgb3V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBUaGUgZXJyb3IgZXZlbnQgZnJvbSB0aGUgZWxlbWVudCB0aGF0IGVtaXRzIGl0LlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uRXJyb3IoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5hYm9ydChgRmFpbGVkIHRvIGxvYWQgZWxlbWVudCB1c2luZzogJHtldmVudC50YXJnZXQubm9kZU5hbWV9YCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGlmIGEgbG9hZCBwcm9ncmVzcyBldmVudCBmaXJlcyBmb3IgYW4gZWxlbWVudCBvciB4aHIveGRyLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1hNTEh0dHBSZXF1ZXN0UHJvZ3Jlc3NFdmVudHxFdmVudH0gZXZlbnQgLSBQcm9ncmVzcyBldmVudC5cbiAgICAgKi9cbiAgICBfb25Qcm9ncmVzcyhldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQgJiYgZXZlbnQubGVuZ3RoQ29tcHV0YWJsZSkge1xuICAgICAgICAgICAgdGhpcy5vblByb2dyZXNzLmRpc3BhdGNoKHRoaXMsIGV2ZW50LmxvYWRlZCAvIGV2ZW50LnRvdGFsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCBpZiBhIHRpbWVvdXQgZXZlbnQgZmlyZXMgZm9yIGFuIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9vblRpbWVvdXQoKSB7XG4gICAgICAgIHRoaXMuYWJvcnQoYExvYWQgdGltZWQgb3V0LmApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCBpZiBhbiBlcnJvciBldmVudCBmaXJlcyBmb3IgeGhyL3hkci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3hock9uRXJyb3IoKSB7XG4gICAgICAgIGNvbnN0IHhociA9IHRoaXMueGhyO1xuXG4gICAgICAgIHRoaXMuYWJvcnQoYCR7cmVxVHlwZSh4aHIpfSBSZXF1ZXN0IGZhaWxlZC4gU3RhdHVzOiAke3hoci5zdGF0dXN9LCB0ZXh0OiBcIiR7eGhyLnN0YXR1c1RleHR9XCJgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaWYgYW4gZXJyb3IgZXZlbnQgZmlyZXMgZm9yIHhoci94ZHIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF94aHJPblRpbWVvdXQoKSB7XG4gICAgICAgIGNvbnN0IHhociA9IHRoaXMueGhyO1xuXG4gICAgICAgIHRoaXMuYWJvcnQoYCR7cmVxVHlwZSh4aHIpfSBSZXF1ZXN0IHRpbWVkIG91dC5gKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaWYgYW4gYWJvcnQgZXZlbnQgZmlyZXMgZm9yIHhoci94ZHIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF94aHJPbkFib3J0KCkge1xuICAgICAgICBjb25zdCB4aHIgPSB0aGlzLnhocjtcblxuICAgICAgICB0aGlzLmFib3J0KGAke3JlcVR5cGUoeGhyKX0gUmVxdWVzdCB3YXMgYWJvcnRlZCBieSB0aGUgdXNlci5gKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiBkYXRhIHN1Y2Nlc3NmdWxseSBsb2FkcyBmcm9tIGFuIHhoci94ZHIgcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtYTUxIdHRwUmVxdWVzdExvYWRFdmVudHxFdmVudH0gZXZlbnQgLSBMb2FkIGV2ZW50XG4gICAgICovXG4gICAgX3hock9uTG9hZCgpIHtcbiAgICAgICAgY29uc3QgeGhyID0gdGhpcy54aHI7XG4gICAgICAgIGxldCB0ZXh0ID0gJyc7XG4gICAgICAgIGxldCBzdGF0dXMgPSB0eXBlb2YgeGhyLnN0YXR1cyA9PT0gJ3VuZGVmaW5lZCcgPyBTVEFUVVNfT0sgOiB4aHIuc3RhdHVzOyAvLyBYRFIgaGFzIG5vIGAuc3RhdHVzYCwgYXNzdW1lIDIwMC5cblxuICAgICAgICAvLyByZXNwb25zZVRleHQgaXMgYWNjZXNzaWJsZSBvbmx5IGlmIHJlc3BvbnNlVHlwZSBpcyAnJyBvciAndGV4dCcgYW5kIG9uIG9sZGVyIGJyb3dzZXJzXG4gICAgICAgIGlmICh4aHIucmVzcG9uc2VUeXBlID09PSAnJyB8fCB4aHIucmVzcG9uc2VUeXBlID09PSAndGV4dCcgfHwgdHlwZW9mIHhoci5yZXNwb25zZVR5cGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0ZXh0ID0geGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHN0YXR1cyBjYW4gYmUgMCB3aGVuIHVzaW5nIHRoZSBgZmlsZTovL2AgcHJvdG9jb2wgc28gd2UgYWxzbyBjaGVjayBpZiBhIHJlc3BvbnNlIGlzIHNldC5cbiAgICAgICAgLy8gSWYgaXQgaGFzIGEgcmVzcG9uc2UsIHdlIGFzc3VtZSAyMDA7IG90aGVyd2lzZSBhIDAgc3RhdHVzIGNvZGUgd2l0aCBubyBjb250ZW50cyBpcyBhbiBhYm9ydGVkIHJlcXVlc3QuXG4gICAgICAgIGlmIChzdGF0dXMgPT09IFNUQVRVU19OT05FICYmICh0ZXh0Lmxlbmd0aCA+IDAgfHwgeGhyLnJlc3BvbnNlVHlwZSA9PT0gUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQlVGRkVSKSkge1xuICAgICAgICAgICAgc3RhdHVzID0gU1RBVFVTX09LO1xuICAgICAgICB9XG4gICAgICAgIC8vIGhhbmRsZSBJRTkgYnVnOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwMDQ2OTcyL21zaWUtcmV0dXJucy1zdGF0dXMtY29kZS1vZi0xMjIzLWZvci1hamF4LXJlcXVlc3RcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSBTVEFUVVNfSUVfQlVHX0VNUFRZKSB7XG4gICAgICAgICAgICBzdGF0dXMgPSBTVEFUVVNfRU1QVFk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGF0dXNUeXBlID0gKHN0YXR1cyAvIDEwMCkgfCAwO1xuXG4gICAgICAgIGlmIChzdGF0dXNUeXBlID09PSBTVEFUVVNfVFlQRV9PSykge1xuICAgICAgICAgICAgLy8gaWYgdGV4dCwganVzdCByZXR1cm4gaXRcbiAgICAgICAgICAgIGlmICh0aGlzLnhoclR5cGUgPT09IFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLlRFWFQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB0ZXh0O1xuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuVEVYVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIGpzb24sIHBhcnNlIGludG8ganNvbiBvYmplY3RcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMueGhyVHlwZSA9PT0gUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuSlNPTikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IEpTT04ucGFyc2UodGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJlc291cmNlLlRZUEUuSlNPTjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hYm9ydChgRXJyb3IgdHJ5aW5nIHRvIHBhcnNlIGxvYWRlZCBqc29uOiAke2V9YCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIHhtbCwgcGFyc2UgaW50byBhbiB4bWwgZG9jdW1lbnQgb3IgZGl2IGVsZW1lbnRcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMueGhyVHlwZSA9PT0gUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuRE9DVU1FTlQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LkRPTVBhcnNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkb21wYXJzZXIucGFyc2VGcm9tU3RyaW5nKHRleHQsICd0ZXh0L3htbCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkaXY7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBSZXNvdXJjZS5UWVBFLlhNTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hYm9ydChgRXJyb3IgdHJ5aW5nIHRvIHBhcnNlIGxvYWRlZCB4bWw6ICR7ZX1gKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gb3RoZXIgdHlwZXMganVzdCByZXR1cm4gdGhlIHJlc3BvbnNlXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB4aHIucmVzcG9uc2UgfHwgdGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWJvcnQoYFske3hoci5zdGF0dXN9XSAke3hoci5zdGF0dXNUZXh0fTogJHt4aHIucmVzcG9uc2VVUkx9YCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBgY3Jvc3NPcmlnaW5gIHByb3BlcnR5IGZvciB0aGlzIHJlc291cmNlIGJhc2VkIG9uIGlmIHRoZSB1cmxcbiAgICAgKiBmb3IgdGhpcyByZXNvdXJjZSBpcyBjcm9zcy1vcmlnaW4uIElmIGNyb3NzT3JpZ2luIHdhcyBtYW51YWxseSBzZXQsIHRoaXNcbiAgICAgKiBmdW5jdGlvbiBkb2VzIG5vdGhpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgdXJsIHRvIHRlc3QuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtsb2M9d2luZG93LmxvY2F0aW9uXSAtIFRoZSBsb2NhdGlvbiBvYmplY3QgdG8gdGVzdCBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGNyb3NzT3JpZ2luIHZhbHVlIHRvIHVzZSAob3IgZW1wdHkgc3RyaW5nIGZvciBub25lKS5cbiAgICAgKi9cbiAgICBfZGV0ZXJtaW5lQ3Jvc3NPcmlnaW4odXJsLCBsb2MpIHtcbiAgICAgICAgLy8gZGF0YTogYW5kIGphdmFzY3JpcHQ6IHVybHMgYXJlIGNvbnNpZGVyZWQgc2FtZS1vcmlnaW5cbiAgICAgICAgaWYgKHVybC5pbmRleE9mKCdkYXRhOicpID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBIHNhbmRib3hlZCBpZnJhbWUgd2l0aG91dCB0aGUgJ2FsbG93LXNhbWUtb3JpZ2luJyBhdHRyaWJ1dGUgd2lsbCBoYXZlIGEgc3BlY2lhbFxuICAgICAgICAvLyBvcmlnaW4gZGVzaWduZWQgbm90IHRvIG1hdGNoIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sIGFuZCB3aWxsIGFsd2F5cyByZXF1aXJlXG4gICAgICAgIC8vIGNyb3NzT3JpZ2luIHJlcXVlc3RzIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB0aGUgbG9jYXRpb24gbWF0Y2hlcy5cbiAgICAgICAgaWYgKHdpbmRvdy5vcmlnaW4gIT09IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pIHtcbiAgICAgICAgICAgIHJldHVybiAnYW5vbnltb3VzJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlZmF1bHQgaXMgd2luZG93LmxvY2F0aW9uXG4gICAgICAgIGxvYyA9IGxvYyB8fCB3aW5kb3cubG9jYXRpb247XG5cbiAgICAgICAgaWYgKCF0ZW1wQW5jaG9yKSB7XG4gICAgICAgICAgICB0ZW1wQW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0IHRoZSBicm93c2VyIGRldGVybWluZSB0aGUgZnVsbCBocmVmIGZvciB0aGUgdXJsIG9mIHRoaXMgcmVzb3VyY2UgYW5kIHRoZW5cbiAgICAgICAgLy8gcGFyc2Ugd2l0aCB0aGUgbm9kZSB1cmwgbGliLCB3ZSBjYW4ndCB1c2UgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGFuY2hvciBlbGVtZW50XG4gICAgICAgIC8vIGJlY2F1c2UgdGhleSBkb24ndCB3b3JrIGluIElFOSA6KFxuICAgICAgICB0ZW1wQW5jaG9yLmhyZWYgPSB1cmw7XG4gICAgICAgIHVybCA9IHBhcnNlVXJpKHRlbXBBbmNob3IuaHJlZiwgeyBzdHJpY3RNb2RlOiB0cnVlIH0pO1xuXG4gICAgICAgIGNvbnN0IHNhbWVQb3J0ID0gKCF1cmwucG9ydCAmJiBsb2MucG9ydCA9PT0gJycpIHx8ICh1cmwucG9ydCA9PT0gbG9jLnBvcnQpO1xuICAgICAgICBjb25zdCBwcm90b2NvbCA9IHVybC5wcm90b2NvbCA/IGAke3VybC5wcm90b2NvbH06YCA6ICcnO1xuXG4gICAgICAgIC8vIGlmIGNyb3NzIG9yaWdpblxuICAgICAgICBpZiAodXJsLmhvc3QgIT09IGxvYy5ob3N0bmFtZSB8fCAhc2FtZVBvcnQgfHwgcHJvdG9jb2wgIT09IGxvYy5wcm90b2NvbCkge1xuICAgICAgICAgICAgcmV0dXJuICdhbm9ueW1vdXMnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgdGhlIHJlc3BvbnNlVHlwZSBvZiBhbiBYSFIgcmVxdWVzdCBiYXNlZCBvbiB0aGUgZXh0ZW5zaW9uIG9mIHRoZVxuICAgICAqIHJlc291cmNlIGJlaW5nIGxvYWRlZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7UmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEV9IFRoZSByZXNwb25zZVR5cGUgdG8gdXNlLlxuICAgICAqL1xuICAgIF9kZXRlcm1pbmVYaHJUeXBlKCkge1xuICAgICAgICByZXR1cm4gUmVzb3VyY2UuX3hoclR5cGVNYXBbdGhpcy5leHRlbnNpb25dIHx8IFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLlRFWFQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyB0aGUgbG9hZFR5cGUgb2YgYSByZXNvdXJjZSBiYXNlZCBvbiB0aGUgZXh0ZW5zaW9uIG9mIHRoZVxuICAgICAqIHJlc291cmNlIGJlaW5nIGxvYWRlZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7UmVzb3VyY2UuTE9BRF9UWVBFfSBUaGUgbG9hZFR5cGUgdG8gdXNlLlxuICAgICAqL1xuICAgIF9kZXRlcm1pbmVMb2FkVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFJlc291cmNlLl9sb2FkVHlwZU1hcFt0aGlzLmV4dGVuc2lvbl0gfHwgUmVzb3VyY2UuTE9BRF9UWVBFLlhIUjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0cyB0aGUgZXh0ZW5zaW9uIChzYW5zICcuJykgb2YgdGhlIGZpbGUgYmVpbmcgbG9hZGVkIGJ5IHRoZSByZXNvdXJjZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgZXh0ZW5zaW9uLlxuICAgICAqL1xuICAgIF9nZXRFeHRlbnNpb24oKSB7XG4gICAgICAgIGxldCB1cmwgPSB0aGlzLnVybDtcbiAgICAgICAgbGV0IGV4dCA9ICcnO1xuXG4gICAgICAgIGlmICh0aGlzLmlzRGF0YVVybCkge1xuICAgICAgICAgICAgY29uc3Qgc2xhc2hJbmRleCA9IHVybC5pbmRleE9mKCcvJyk7XG5cbiAgICAgICAgICAgIGV4dCA9IHVybC5zdWJzdHJpbmcoc2xhc2hJbmRleCArIDEsIHVybC5pbmRleE9mKCc7Jywgc2xhc2hJbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XG4gICAgICAgICAgICBjb25zdCBoYXNoU3RhcnQgPSB1cmwuaW5kZXhPZignIycpO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICBxdWVyeVN0YXJ0ID4gLTEgPyBxdWVyeVN0YXJ0IDogdXJsLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBoYXNoU3RhcnQgPiAtMSA/IGhhc2hTdGFydCA6IHVybC5sZW5ndGhcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHVybCA9IHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgICAgICAgICAgZXh0ID0gdXJsLnN1YnN0cmluZyh1cmwubGFzdEluZGV4T2YoJy4nKSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgdGhlIG1pbWUgdHlwZSBvZiBhbiBYSFIgcmVxdWVzdCBiYXNlZCBvbiB0aGUgcmVzcG9uc2VUeXBlIG9mXG4gICAgICogcmVzb3VyY2UgYmVpbmcgbG9hZGVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFfSB0eXBlIC0gVGhlIHR5cGUgdG8gZ2V0IGEgbWltZSB0eXBlIGZvci5cbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBtaW1lIHR5cGUgdG8gdXNlLlxuICAgICAqL1xuICAgIF9nZXRNaW1lRnJvbVhoclR5cGUodHlwZSkge1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQlVGRkVSOlxuICAgICAgICAgICAgICAgIHJldHVybiAnYXBwbGljYXRpb24vb2N0ZXQtYmluYXJ5JztcblxuICAgICAgICAgICAgY2FzZSBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5CTE9COlxuICAgICAgICAgICAgICAgIHJldHVybiAnYXBwbGljYXRpb24vYmxvYic7XG5cbiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuRE9DVU1FTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdhcHBsaWNhdGlvbi94bWwnO1xuXG4gICAgICAgICAgICBjYXNlIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkpTT046XG4gICAgICAgICAgICAgICAgcmV0dXJuICdhcHBsaWNhdGlvbi9qc29uJztcblxuICAgICAgICAgICAgY2FzZSBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ERUZBVUxUOlxuICAgICAgICAgICAgY2FzZSBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5URVhUOlxuICAgICAgICAgICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi9cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0ZXh0L3BsYWluJztcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBUaGUgdHlwZXMgb2YgcmVzb3VyY2VzIGEgcmVzb3VyY2UgY291bGQgcmVwcmVzZW50LlxuICpcbiAqIEBzdGF0aWNcbiAqIEByZWFkb25seVxuICogQGVudW0ge251bWJlcn1cbiAqL1xuUmVzb3VyY2UuU1RBVFVTX0ZMQUdTID0ge1xuICAgIE5PTkU6ICAgICAgIDAsXG4gICAgREFUQV9VUkw6ICAgKDEgPDwgMCksXG4gICAgQ09NUExFVEU6ICAgKDEgPDwgMSksXG4gICAgTE9BRElORzogICAgKDEgPDwgMiksXG59O1xuXG4vKipcbiAqIFRoZSB0eXBlcyBvZiByZXNvdXJjZXMgYSByZXNvdXJjZSBjb3VsZCByZXByZXNlbnQuXG4gKlxuICogQHN0YXRpY1xuICogQHJlYWRvbmx5XG4gKiBAZW51bSB7bnVtYmVyfVxuICovXG5SZXNvdXJjZS5UWVBFID0ge1xuICAgIFVOS05PV046ICAgIDAsXG4gICAgSlNPTjogICAgICAgMSxcbiAgICBYTUw6ICAgICAgICAyLFxuICAgIElNQUdFOiAgICAgIDMsXG4gICAgQVVESU86ICAgICAgNCxcbiAgICBWSURFTzogICAgICA1LFxuICAgIFRFWFQ6ICAgICAgIDYsXG59O1xuXG4vKipcbiAqIFRoZSB0eXBlcyBvZiBsb2FkaW5nIGEgcmVzb3VyY2UgY2FuIHVzZS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAcmVhZG9ubHlcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKi9cblJlc291cmNlLkxPQURfVFlQRSA9IHtcbiAgICAvKiogVXNlcyBYTUxIdHRwUmVxdWVzdCB0byBsb2FkIHRoZSByZXNvdXJjZS4gKi9cbiAgICBYSFI6ICAgIDEsXG4gICAgLyoqIFVzZXMgYW4gYEltYWdlYCBvYmplY3QgdG8gbG9hZCB0aGUgcmVzb3VyY2UuICovXG4gICAgSU1BR0U6ICAyLFxuICAgIC8qKiBVc2VzIGFuIGBBdWRpb2Agb2JqZWN0IHRvIGxvYWQgdGhlIHJlc291cmNlLiAqL1xuICAgIEFVRElPOiAgMyxcbiAgICAvKiogVXNlcyBhIGBWaWRlb2Agb2JqZWN0IHRvIGxvYWQgdGhlIHJlc291cmNlLiAqL1xuICAgIFZJREVPOiAgNCxcbn07XG5cbi8qKlxuICogVGhlIFhIUiByZWFkeSBzdGF0ZXMsIHVzZWQgaW50ZXJuYWxseS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAcmVhZG9ubHlcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cblJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFID0ge1xuICAgIC8qKiBzdHJpbmcgKi9cbiAgICBERUZBVUxUOiAgICAndGV4dCcsXG4gICAgLyoqIEFycmF5QnVmZmVyICovXG4gICAgQlVGRkVSOiAgICAgJ2FycmF5YnVmZmVyJyxcbiAgICAvKiogQmxvYiAqL1xuICAgIEJMT0I6ICAgICAgICdibG9iJyxcbiAgICAvKiogRG9jdW1lbnQgKi9cbiAgICBET0NVTUVOVDogICAnZG9jdW1lbnQnLFxuICAgIC8qKiBPYmplY3QgKi9cbiAgICBKU09OOiAgICAgICAnanNvbicsXG4gICAgLyoqIFN0cmluZyAqL1xuICAgIFRFWFQ6ICAgICAgICd0ZXh0Jyxcbn07XG5cblJlc291cmNlLl9sb2FkVHlwZU1hcCA9IHtcbiAgICAvLyBpbWFnZXNcbiAgICBnaWY6ICAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuSU1BR0UsXG4gICAgcG5nOiAgICAgICAgUmVzb3VyY2UuTE9BRF9UWVBFLklNQUdFLFxuICAgIGJtcDogICAgICAgIFJlc291cmNlLkxPQURfVFlQRS5JTUFHRSxcbiAgICBqcGc6ICAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuSU1BR0UsXG4gICAganBlZzogICAgICAgUmVzb3VyY2UuTE9BRF9UWVBFLklNQUdFLFxuICAgIHRpZjogICAgICAgIFJlc291cmNlLkxPQURfVFlQRS5JTUFHRSxcbiAgICB0aWZmOiAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuSU1BR0UsXG4gICAgd2VicDogICAgICAgUmVzb3VyY2UuTE9BRF9UWVBFLklNQUdFLFxuICAgIHRnYTogICAgICAgIFJlc291cmNlLkxPQURfVFlQRS5JTUFHRSxcbiAgICBzdmc6ICAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuSU1BR0UsXG4gICAgJ3N2Zyt4bWwnOiAgUmVzb3VyY2UuTE9BRF9UWVBFLklNQUdFLCAvLyBmb3IgU1ZHIGRhdGEgdXJsc1xuXG4gICAgLy8gYXVkaW9cbiAgICBtcDM6ICAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuQVVESU8sXG4gICAgb2dnOiAgICAgICAgUmVzb3VyY2UuTE9BRF9UWVBFLkFVRElPLFxuICAgIHdhdjogICAgICAgIFJlc291cmNlLkxPQURfVFlQRS5BVURJTyxcblxuICAgIC8vIHZpZGVvc1xuICAgIG1wNDogICAgICAgIFJlc291cmNlLkxPQURfVFlQRS5WSURFTyxcbiAgICB3ZWJtOiAgICAgICBSZXNvdXJjZS5MT0FEX1RZUEUuVklERU8sXG59O1xuXG5SZXNvdXJjZS5feGhyVHlwZU1hcCA9IHtcbiAgICAvLyB4bWxcbiAgICB4aHRtbDogICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcbiAgICBodG1sOiAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcbiAgICBodG06ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcbiAgICB4bWw6ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcbiAgICB0bXg6ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcbiAgICBzdmc6ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ET0NVTUVOVCxcblxuICAgIC8vIFRoaXMgd2FzIGFkZGVkIHRvIGhhbmRsZSBUaWxlZCBUaWxlc2V0IFhNTCwgYnV0IC50c3ggaXMgYWxzbyBhIFR5cGVTY3JpcHQgUmVhY3QgQ29tcG9uZW50LlxuICAgIC8vIFNpbmNlIGl0IGlzIHdheSBsZXNzIGxpa2VseSBmb3IgcGVvcGxlIHRvIGJlIGxvYWRpbmcgVHlwZVNjcmlwdCBmaWxlcyBpbnN0ZWFkIG9mIFRpbGVkIGZpbGVzLFxuICAgIC8vIHRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGZpbmUuXG4gICAgdHN4OiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuRE9DVU1FTlQsXG5cbiAgICAvLyBpbWFnZXNcbiAgICBnaWY6ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5CTE9CLFxuICAgIHBuZzogICAgICAgIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkJMT0IsXG4gICAgYm1wOiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQkxPQixcbiAgICBqcGc6ICAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5CTE9CLFxuICAgIGpwZWc6ICAgICAgIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkJMT0IsXG4gICAgdGlmOiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQkxPQixcbiAgICB0aWZmOiAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5CTE9CLFxuICAgIHdlYnA6ICAgICAgIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkJMT0IsXG4gICAgdGdhOiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQkxPQixcblxuICAgIC8vIGpzb25cbiAgICBqc29uOiAgICAgICBSZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5KU09OLFxuXG4gICAgLy8gdGV4dFxuICAgIHRleHQ6ICAgICAgIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLlRFWFQsXG4gICAgdHh0OiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuVEVYVCxcblxuICAgIC8vIGZvbnRzXG4gICAgdHRmOiAgICAgICAgUmVzb3VyY2UuWEhSX1JFU1BPTlNFX1RZUEUuQlVGRkVSLFxuICAgIG90ZjogICAgICAgIFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkJVRkZFUixcbn07XG5cbi8vIFdlIGNhbid0IHNldCB0aGUgYHNyY2AgYXR0cmlidXRlIHRvIGVtcHR5IHN0cmluZywgc28gb24gYWJvcnQgd2Ugc2V0IGl0IHRvIHRoaXMgMXB4IHRyYW5zcGFyZW50IGdpZlxuUmVzb3VyY2UuRU1QVFlfR0lGID0gJ2RhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQVAvLy93QUFBQ0g1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlDUkFFQU93PT0nO1xuXG4vKipcbiAqIFF1aWNrIGhlbHBlciB0byBzZXQgYSB2YWx1ZSBvbiBvbmUgb2YgdGhlIGV4dGVuc2lvbiBtYXBzLiBFbnN1cmVzIHRoZXJlIGlzIG5vXG4gKiBkb3QgYXQgdGhlIHN0YXJ0IG9mIHRoZSBleHRlbnNpb24uXG4gKlxuICogQGlnbm9yZVxuICogQHBhcmFtIHtvYmplY3R9IG1hcCAtIFRoZSBtYXAgdG8gc2V0IG9uLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dG5hbWUgLSBUaGUgZXh0ZW5zaW9uIChvciBrZXkpIHRvIHNldC5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWwgLSBUaGUgdmFsdWUgdG8gc2V0LlxuICovXG5mdW5jdGlvbiBzZXRFeHRNYXAobWFwLCBleHRuYW1lLCB2YWwpIHtcbiAgICBpZiAoZXh0bmFtZSAmJiBleHRuYW1lLmluZGV4T2YoJy4nKSA9PT0gMCkge1xuICAgICAgICBleHRuYW1lID0gZXh0bmFtZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuXG4gICAgaWYgKCFleHRuYW1lKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBtYXBbZXh0bmFtZV0gPSB2YWw7XG59XG5cbi8qKlxuICogUXVpY2sgaGVscGVyIHRvIGdldCBzdHJpbmcgeGhyIHR5cGUuXG4gKlxuICogQGlnbm9yZVxuICogQHBhcmFtIHtYTUxIdHRwUmVxdWVzdHxYRG9tYWluUmVxdWVzdH0geGhyIC0gVGhlIHJlcXVlc3QgdG8gY2hlY2suXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSB0eXBlLlxuICovXG5mdW5jdGlvbiByZXFUeXBlKHhocikge1xuICAgIHJldHVybiB4aHIudG9TdHJpbmcoKS5yZXBsYWNlKCdvYmplY3QgJywgJycpO1xufVxuXG5leHBvcnQgeyBSZXNvdXJjZSB9O1xuIiwgImNvbnN0IF9rZXlTdHIgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xuXG4vKipcbiAqIEVuY29kZXMgYmluYXJ5IGludG8gYmFzZTY0LlxuICpcbiAqIEBmdW5jdGlvbiBlbmNvZGVCaW5hcnlcbiAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dCBUaGUgaW5wdXQgZGF0YSB0byBlbmNvZGUuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgZW5jb2RlZCBiYXNlNjQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGVCaW5hcnkoaW5wdXQpIHtcbiAgICBsZXQgb3V0cHV0ID0gJyc7XG4gICAgbGV0IGlueCA9IDA7XG5cbiAgICB3aGlsZSAoaW54IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgIC8vIEZpbGwgYnl0ZSBidWZmZXIgYXJyYXlcbiAgICAgICAgY29uc3QgYnl0ZWJ1ZmZlciA9IFswLCAwLCAwXTtcbiAgICAgICAgY29uc3QgZW5jb2RlZENoYXJJbmRleGVzID0gWzAsIDAsIDAsIDBdO1xuXG4gICAgICAgIGZvciAobGV0IGpueCA9IDA7IGpueCA8IGJ5dGVidWZmZXIubGVuZ3RoOyArK2pueCkge1xuICAgICAgICAgICAgaWYgKGlueCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIHRocm93IGF3YXkgaGlnaC1vcmRlciBieXRlLCBhcyBkb2N1bWVudGVkIGF0OlxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL0VuL1VzaW5nX1hNTEh0dHBSZXF1ZXN0I0hhbmRsaW5nX2JpbmFyeV9kYXRhXG4gICAgICAgICAgICAgICAgYnl0ZWJ1ZmZlcltqbnhdID0gaW5wdXQuY2hhckNvZGVBdChpbngrKykgJiAweGZmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnl0ZWJ1ZmZlcltqbnhdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBlYWNoIGVuY29kZWQgY2hhcmFjdGVyLCA2IGJpdHMgYXQgYSB0aW1lXG4gICAgICAgIC8vIGluZGV4IDE6IGZpcnN0IDYgYml0c1xuICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbMF0gPSBieXRlYnVmZmVyWzBdID4+IDI7XG5cbiAgICAgICAgLy8gaW5kZXggMjogc2Vjb25kIDYgYml0cyAoMiBsZWFzdCBzaWduaWZpY2FudCBiaXRzIGZyb20gaW5wdXQgYnl0ZSAxICsgNCBtb3N0IHNpZ25pZmljYW50IGJpdHMgZnJvbSBieXRlIDIpXG4gICAgICAgIGVuY29kZWRDaGFySW5kZXhlc1sxXSA9ICgoYnl0ZWJ1ZmZlclswXSAmIDB4MykgPDwgNCkgfCAoYnl0ZWJ1ZmZlclsxXSA+PiA0KTtcblxuICAgICAgICAvLyBpbmRleCAzOiB0aGlyZCA2IGJpdHMgKDQgbGVhc3Qgc2lnbmlmaWNhbnQgYml0cyBmcm9tIGlucHV0IGJ5dGUgMiArIDIgbW9zdCBzaWduaWZpY2FudCBiaXRzIGZyb20gYnl0ZSAzKVxuICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbMl0gPSAoKGJ5dGVidWZmZXJbMV0gJiAweDBmKSA8PCAyKSB8IChieXRlYnVmZmVyWzJdID4+IDYpO1xuXG4gICAgICAgIC8vIGluZGV4IDM6IGZvcnRoIDYgYml0cyAoNiBsZWFzdCBzaWduaWZpY2FudCBiaXRzIGZyb20gaW5wdXQgYnl0ZSAzKVxuICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbM10gPSBieXRlYnVmZmVyWzJdICYgMHgzZjtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgd2hldGhlciBwYWRkaW5nIGhhcHBlbmVkLCBhbmQgYWRqdXN0IGFjY29yZGluZ2x5XG4gICAgICAgIGNvbnN0IHBhZGRpbmdCeXRlcyA9IGlueCAtIChpbnB1dC5sZW5ndGggLSAxKTtcblxuICAgICAgICBzd2l0Y2ggKHBhZGRpbmdCeXRlcykge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIC8vIFNldCBsYXN0IDIgY2hhcmFjdGVycyB0byBwYWRkaW5nIGNoYXJcbiAgICAgICAgICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbM10gPSA2NDtcbiAgICAgICAgICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbMl0gPSA2NDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIC8vIFNldCBsYXN0IGNoYXJhY3RlciB0byBwYWRkaW5nIGNoYXJcbiAgICAgICAgICAgICAgICBlbmNvZGVkQ2hhckluZGV4ZXNbM10gPSA2NDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhazsgLy8gTm8gcGFkZGluZyAtIHByb2NlZWRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vdyB3ZSB3aWxsIGdyYWIgZWFjaCBhcHByb3ByaWF0ZSBjaGFyYWN0ZXIgb3V0IG9mIG91ciBrZXlzdHJpbmdcbiAgICAgICAgLy8gYmFzZWQgb24gb3VyIGluZGV4IGFycmF5IGFuZCBhcHBlbmQgaXQgdG8gdGhlIG91dHB1dCBzdHJpbmdcbiAgICAgICAgZm9yIChsZXQgam54ID0gMDsgam54IDwgZW5jb2RlZENoYXJJbmRleGVzLmxlbmd0aDsgKytqbngpIHtcbiAgICAgICAgICAgIG91dHB1dCArPSBfa2V5U3RyLmNoYXJBdChlbmNvZGVkQ2hhckluZGV4ZXNbam54XSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb3V0cHV0O1xufVxuIiwgImltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnLi4vUmVzb3VyY2UnO1xuaW1wb3J0IHsgZW5jb2RlQmluYXJ5IH0gZnJvbSAnLi4vZW5jb2RlQmluYXJ5JztcblxuY29uc3QgVXJsID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMO1xuXG4vKipcbiAqIEEgbWlkZGxld2FyZSBmb3IgdHJhbnNmb3JtaW5nIFhIUiBsb2FkZWQgQmxvYnMgaW50byBtb3JlIHVzZWZ1bCBvYmplY3RzXG4gKlxuICogQG1lbWJlcm9mIG1pZGRsZXdhcmVcbiAqIEBmdW5jdGlvbiBwYXJzaW5nXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgTG9hZGVyLCBtaWRkbGV3YXJlIH0gZnJvbSAncmVzb3VyY2UtbG9hZGVyJztcbiAqIGNvbnN0IGxvYWRlciA9IG5ldyBMb2FkZXIoKTtcbiAqIGxvYWRlci51c2UobWlkZGxld2FyZS5wYXJzaW5nKTtcbiAqIEBwYXJhbSB7UmVzb3VyY2V9IHJlc291cmNlIC0gQ3VycmVudCBSZXNvdXJjZVxuICogQHBhcmFtIHtmdW5jdGlvbn0gbmV4dCAtIENhbGxiYWNrIHdoZW4gY29tcGxldGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNpbmcocmVzb3VyY2UsIG5leHQpIHtcbiAgICBpZiAoIXJlc291cmNlLmRhdGEpIHtcbiAgICAgICAgbmV4dCgpO1xuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBpZiB0aGlzIHdhcyBhbiBYSFIgbG9hZCBvZiBhIGJsb2JcbiAgICBpZiAocmVzb3VyY2UueGhyICYmIHJlc291cmNlLnhoclR5cGUgPT09IFJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLkJMT0IpIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gYmxvYiBzdXBwb3J0IHdlIHByb2JhYmx5IGdvdCBhIGJpbmFyeSBzdHJpbmcgYmFja1xuICAgICAgICBpZiAoIXdpbmRvdy5CbG9iIHx8IHR5cGVvZiByZXNvdXJjZS5kYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHJlc291cmNlLnhoci5nZXRSZXNwb25zZUhlYWRlcignY29udGVudC10eXBlJyk7XG5cbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYW4gaW1hZ2UsIGNvbnZlcnQgdGhlIGJpbmFyeSBzdHJpbmcgaW50byBhIGRhdGEgdXJsXG4gICAgICAgICAgICBpZiAodHlwZSAmJiB0eXBlLmluZGV4T2YoJ2ltYWdlJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5kYXRhID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuZGF0YS5zcmMgPSBgZGF0YToke3R5cGV9O2Jhc2U2NCwke2VuY29kZUJpbmFyeShyZXNvdXJjZS54aHIucmVzcG9uc2VUZXh0KX1gO1xuXG4gICAgICAgICAgICAgICAgcmVzb3VyY2UudHlwZSA9IFJlc291cmNlLlRZUEUuSU1BR0U7XG5cbiAgICAgICAgICAgICAgICAvLyB3YWl0IHVudGlsIHRoZSBpbWFnZSBsb2FkcyBhbmQgdGhlbiBjYWxsYmFja1xuICAgICAgICAgICAgICAgIHJlc291cmNlLmRhdGEub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZS5kYXRhLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBuZXh0IHdpbGwgYmUgY2FsbGVkIG9uIGxvYWRcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgY29udGVudCB0eXBlIHNheXMgdGhpcyBpcyBhbiBpbWFnZSwgdGhlbiB3ZSBzaG91bGQgdHJhbnNmb3JtIHRoZSBibG9iIGludG8gYW4gSW1hZ2Ugb2JqZWN0XG4gICAgICAgIGVsc2UgaWYgKHJlc291cmNlLmRhdGEudHlwZS5pbmRleE9mKCdpbWFnZScpID09PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBzcmMgPSBVcmwuY3JlYXRlT2JqZWN0VVJMKHJlc291cmNlLmRhdGEpO1xuXG4gICAgICAgICAgICByZXNvdXJjZS5ibG9iID0gcmVzb3VyY2UuZGF0YTtcbiAgICAgICAgICAgIHJlc291cmNlLmRhdGEgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIHJlc291cmNlLmRhdGEuc3JjID0gc3JjO1xuXG4gICAgICAgICAgICByZXNvdXJjZS50eXBlID0gUmVzb3VyY2UuVFlQRS5JTUFHRTtcblxuICAgICAgICAgICAgLy8gY2xlYW51cCB0aGUgbm8gbG9uZ2VyIHVzZWQgYmxvYiBhZnRlciB0aGUgaW1hZ2UgbG9hZHNcbiAgICAgICAgICAgIC8vIFRPRE86IElzIHRoaXMgY29ycmVjdD8gV2lsbCB0aGUgaW1hZ2UgYmUgaW52YWxpZCBhZnRlciByZXZva2luZz9cbiAgICAgICAgICAgIHJlc291cmNlLmRhdGEub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIFVybC5yZXZva2VPYmplY3RVUkwoc3JjKTtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5kYXRhLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBuZXh0IHdpbGwgYmUgY2FsbGVkIG9uIGxvYWQuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZXh0KCk7XG59XG4iLCAiLyoqXG4gKiBAbmFtZXNwYWNlIG1pZGRsZXdhcmVcbiAqL1xuZXhwb3J0ICogZnJvbSAnLi9jYWNoaW5nJztcbmV4cG9ydCAqIGZyb20gJy4vcGFyc2luZyc7XG4iLCAiaW1wb3J0IFNpZ25hbCBmcm9tICdtaW5pLXNpZ25hbHMnO1xuaW1wb3J0IHBhcnNlVXJpIGZyb20gJ3BhcnNlLXVyaSc7XG5pbXBvcnQgKiBhcyBhc3luYyBmcm9tICcuL2FzeW5jJztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnLi9SZXNvdXJjZSc7XG5cbi8vIHNvbWUgY29uc3RhbnRzXG5jb25zdCBNQVhfUFJPR1JFU1MgPSAxMDA7XG5jb25zdCByZ3hFeHRyYWN0VXJsSGFzaCA9IC8oI1tcXHctXSspPyQvO1xuXG4vKipcbiAqIE1hbmFnZXMgdGhlIHN0YXRlIGFuZCBsb2FkaW5nIG9mIG11bHRpcGxlIHJlc291cmNlcyB0byBsb2FkLlxuICpcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBMb2FkZXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbYmFzZVVybD0nJ10gLSBUaGUgYmFzZSB1cmwgZm9yIGFsbCByZXNvdXJjZXMgbG9hZGVkIGJ5IHRoaXMgbG9hZGVyLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbY29uY3VycmVuY3k9MTBdIC0gVGhlIG51bWJlciBvZiByZXNvdXJjZXMgdG8gbG9hZCBjb25jdXJyZW50bHkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYmFzZVVybCA9ICcnLCBjb25jdXJyZW5jeSA9IDEwKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYmFzZSB1cmwgZm9yIGFsbCByZXNvdXJjZXMgbG9hZGVkIGJ5IHRoaXMgbG9hZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcHJvZ3Jlc3MgcGVyY2VudCBvZiB0aGUgbG9hZGVyIGdvaW5nIHRocm91Z2ggdGhlIHF1ZXVlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJvZ3Jlc3MgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkaW5nIHN0YXRlIG9mIHRoZSBsb2FkZXIsIHRydWUgaWYgaXQgaXMgY3VycmVudGx5IGxvYWRpbmcgcmVzb3VyY2VzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgcXVlcnlzdHJpbmcgdG8gYXBwZW5kIHRvIGV2ZXJ5IFVSTCBhZGRlZCB0byB0aGUgbG9hZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGlzIHNob3VsZCBiZSBhIHZhbGlkIHF1ZXJ5IHN0cmluZyAqd2l0aG91dCogdGhlIHF1ZXN0aW9uLW1hcmsgKGA/YCkuIFRoZSBsb2FkZXIgd2lsbFxuICAgICAgICAgKiBhbHNvICpub3QqIGVzY2FwZSB2YWx1ZXMgZm9yIHlvdS4gTWFrZSBzdXJlIHRvIGVzY2FwZSB5b3VyIHBhcmFtZXRlcnMgd2l0aFxuICAgICAgICAgKiBbYGVuY29kZVVSSUNvbXBvbmVudGBdKGh0dHBzOi8vbWRuLmlvL2VuY29kZVVSSUNvbXBvbmVudCkgYmVmb3JlIGFzc2lnbmluZyB0aGlzIHByb3BlcnR5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBjb25zdCBsb2FkZXIgPSBuZXcgTG9hZGVyKCk7XG4gICAgICAgICAqXG4gICAgICAgICAqIGxvYWRlci5kZWZhdWx0UXVlcnlTdHJpbmcgPSAndXNlcj1tZSZwYXNzd29yZD1zZWNyZXQnO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBUaGlzIHdpbGwgcmVxdWVzdCAnaW1hZ2UucG5nP3VzZXI9bWUmcGFzc3dvcmQ9c2VjcmV0J1xuICAgICAgICAgKiBsb2FkZXIuYWRkKCdpbWFnZS5wbmcnKS5sb2FkKCk7XG4gICAgICAgICAqXG4gICAgICAgICAqIGxvYWRlci5yZXNldCgpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBUaGlzIHdpbGwgcmVxdWVzdCAnaW1hZ2UucG5nP3Y9MSZ1c2VyPW1lJnBhc3N3b3JkPXNlY3JldCdcbiAgICAgICAgICogbG9hZGVyLmFkZCgnaWFtZ2UucG5nP3Y9MScpLmxvYWQoKTtcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKiBAZGVmYXVsdCAnJ1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnlTdHJpbmcgPSAnJztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG1pZGRsZXdhcmUgdG8gcnVuIGJlZm9yZSBsb2FkaW5nIGVhY2ggcmVzb3VyY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9uW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9iZWZvcmVNaWRkbGV3YXJlID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtaWRkbGV3YXJlIHRvIHJ1biBhZnRlciBsb2FkaW5nIGVhY2ggcmVzb3VyY2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9uW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9hZnRlck1pZGRsZXdhcmUgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRyYWNrcyB0aGUgcmVzb3VyY2VzIHdlIGFyZSBjdXJyZW50bHkgY29tcGxldGluZyBwYXJzaW5nIGZvci5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7UmVzb3VyY2VbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Jlc291cmNlc1BhcnNpbmcgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGBfbG9hZFJlc291cmNlYCBmdW5jdGlvbiBib3VuZCB3aXRoIHRoaXMgb2JqZWN0IGNvbnRleHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge2Z1bmN0aW9ufVxuICAgICAgICAgKiBAcGFyYW0ge1Jlc291cmNlfSByIC0gVGhlIHJlc291cmNlIHRvIGxvYWRcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZCAtIFRoZSBkZXF1ZXVlIGZ1bmN0aW9uXG4gICAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2JvdW5kTG9hZFJlc291cmNlID0gKHIsIGQpID0+IHRoaXMuX2xvYWRSZXNvdXJjZShyLCBkKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlc291cmNlcyB3YWl0aW5nIHRvIGJlIGxvYWRlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7UmVzb3VyY2VbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3F1ZXVlID0gYXN5bmMucXVldWUodGhpcy5fYm91bmRMb2FkUmVzb3VyY2UsIGNvbmN1cnJlbmN5KTtcblxuICAgICAgICB0aGlzLl9xdWV1ZS5wYXVzZSgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbGwgdGhlIHJlc291cmNlcyBmb3IgdGhpcyBsb2FkZXIga2V5ZWQgYnkgbmFtZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0PHN0cmluZywgUmVzb3VyY2U+fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNvdXJjZXMgPSB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGF0Y2hlZCBvbmNlIHBlciBsb2FkZWQgb3IgZXJyb3JlZCByZXNvdXJjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGNhbGxiYWNrIGxvb2tzIGxpa2Uge0BsaW5rIExvYWRlci5PblByb2dyZXNzU2lnbmFsfS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7U2lnbmFsPExvYWRlci5PblByb2dyZXNzU2lnbmFsPn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Qcm9ncmVzcyA9IG5ldyBTaWduYWwoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGF0Y2hlZCBvbmNlIHBlciBlcnJvcmVkIHJlc291cmNlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgbG9va3MgbGlrZSB7QGxpbmsgTG9hZGVyLk9uRXJyb3JTaWduYWx9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtTaWduYWw8TG9hZGVyLk9uRXJyb3JTaWduYWw+fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkVycm9yID0gbmV3IFNpZ25hbCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwYXRjaGVkIG9uY2UgcGVyIGxvYWRlZCByZXNvdXJjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGNhbGxiYWNrIGxvb2tzIGxpa2Uge0BsaW5rIExvYWRlci5PbkxvYWRTaWduYWx9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtTaWduYWw8TG9hZGVyLk9uTG9hZFNpZ25hbD59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uTG9hZCA9IG5ldyBTaWduYWwoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGlzcGF0Y2hlZCB3aGVuIHRoZSBsb2FkZXIgYmVnaW5zIHRvIHByb2Nlc3MgdGhlIHF1ZXVlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgY2FsbGJhY2sgbG9va3MgbGlrZSB7QGxpbmsgTG9hZGVyLk9uU3RhcnRTaWduYWx9LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtTaWduYWw8TG9hZGVyLk9uU3RhcnRTaWduYWw+fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vblN0YXJ0ID0gbmV3IFNpZ25hbCgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwYXRjaGVkIHdoZW4gdGhlIHF1ZXVlZCByZXNvdXJjZXMgYWxsIGxvYWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBjYWxsYmFjayBsb29rcyBsaWtlIHtAbGluayBMb2FkZXIuT25Db21wbGV0ZVNpZ25hbH0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1NpZ25hbDxMb2FkZXIuT25Db21wbGV0ZVNpZ25hbD59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uQ29tcGxldGUgPSBuZXcgU2lnbmFsKCk7XG5cbiAgICAgICAgLy8gQWRkIGRlZmF1bHQgYmVmb3JlIG1pZGRsZXdhcmVcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBMb2FkZXIuX2RlZmF1bHRCZWZvcmVNaWRkbGV3YXJlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLnByZShMb2FkZXIuX2RlZmF1bHRCZWZvcmVNaWRkbGV3YXJlW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBkZWZhdWx0IGFmdGVyIG1pZGRsZXdhcmVcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBMb2FkZXIuX2RlZmF1bHRBZnRlck1pZGRsZXdhcmUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMudXNlKExvYWRlci5fZGVmYXVsdEFmdGVyTWlkZGxld2FyZVtpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXaGVuIHRoZSBwcm9ncmVzcyBjaGFuZ2VzIHRoZSBsb2FkZXIgYW5kIHJlc291cmNlIGFyZSBkaXNhcHRjaGVkLlxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIExvYWRlclxuICAgICAqIEBjYWxsYmFjayBPblByb2dyZXNzU2lnbmFsXG4gICAgICogQHBhcmFtIHtMb2FkZXJ9IGxvYWRlciAtIFRoZSBsb2FkZXIgdGhlIHByb2dyZXNzIGlzIGFkdmFuY2luZyBvbi5cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSB0aGF0IGhhcyBjb21wbGV0ZWQgb3IgZmFpbGVkIHRvIGNhdXNlIHRoZSBwcm9ncmVzcyB0byBhZHZhbmNlLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogV2hlbiBhbiBlcnJvciBvY2N1cnJzIHRoZSBsb2FkZXIgYW5kIHJlc291cmNlIGFyZSBkaXNhcHRjaGVkLlxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIExvYWRlclxuICAgICAqIEBjYWxsYmFjayBPbkVycm9yU2lnbmFsXG4gICAgICogQHBhcmFtIHtMb2FkZXJ9IGxvYWRlciAtIFRoZSBsb2FkZXIgdGhlIGVycm9yIGhhcHBlbmVkIGluLlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2V9IHJlc291cmNlIC0gVGhlIHJlc291cmNlIHRoYXQgY2F1c2VkIHRoZSBlcnJvci5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIFdoZW4gYSBsb2FkIGNvbXBsZXRlcyB0aGUgbG9hZGVyIGFuZCByZXNvdXJjZSBhcmUgZGlzYXB0Y2hlZC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBMb2FkZXJcbiAgICAgKiBAY2FsbGJhY2sgT25Mb2FkU2lnbmFsXG4gICAgICogQHBhcmFtIHtMb2FkZXJ9IGxvYWRlciAtIFRoZSBsb2FkZXIgdGhhdCBsYW9kZWQgdGhlIHJlc291cmNlLlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2V9IHJlc291cmNlIC0gVGhlIHJlc291cmNlIHRoYXQgaGFzIGNvbXBsZXRlZCBsb2FkaW5nLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgbG9hZGVyIHN0YXJ0cyBsb2FkaW5nIHJlc291cmNlcyBpdCBkaXNwYXRjaGVzIHRoaXMgY2FsbGJhY2suXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgTG9hZGVyXG4gICAgICogQGNhbGxiYWNrIE9uU3RhcnRTaWduYWxcbiAgICAgKiBAcGFyYW0ge0xvYWRlcn0gbG9hZGVyIC0gVGhlIGxvYWRlciB0aGF0IGhhcyBzdGFydGVkIGxvYWRpbmcgcmVzb3VyY2VzLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgbG9hZGVyIGNvbXBsZXRlcyBsb2FkaW5nIHJlc291cmNlcyBpdCBkaXNwYXRjaGVzIHRoaXMgY2FsbGJhY2suXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgTG9hZGVyXG4gICAgICogQGNhbGxiYWNrIE9uQ29tcGxldGVTaWduYWxcbiAgICAgKiBAcGFyYW0ge0xvYWRlcn0gbG9hZGVyIC0gVGhlIGxvYWRlciB0aGF0IGhhcyBmaW5pc2hlZCBsb2FkaW5nIHJlc291cmNlcy5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIE9wdGlvbnMgZm9yIGEgY2FsbCB0byBgLmFkZCgpYC5cbiAgICAgKlxuICAgICAqIEBzZWUgTG9hZGVyI2FkZFxuICAgICAqXG4gICAgICogQHR5cGVkZWYge29iamVjdH0gSUFkZE9wdGlvbnNcbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gW25hbWVdIC0gVGhlIG5hbWUgb2YgdGhlIHJlc291cmNlIHRvIGxvYWQsIGlmIG5vdCBwYXNzZWQgdGhlIHVybCBpcyB1c2VkLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBba2V5XSAtIEFsaWFzIGZvciBgbmFtZWAuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IFt1cmxdIC0gVGhlIHVybCBmb3IgdGhpcyByZXNvdXJjZSwgcmVsYXRpdmUgdG8gdGhlIGJhc2VVcmwgb2YgdGhpcyBsb2FkZXIuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd8Ym9vbGVhbn0gW2Nyb3NzT3JpZ2luXSAtIElzIHRoaXMgcmVxdWVzdCBjcm9zcy1vcmlnaW4/IERlZmF1bHQgaXMgdG9cbiAgICAgKiAgICAgIGRldGVybWluZSBhdXRvbWF0aWNhbGx5LlxuICAgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbdGltZW91dD0wXSAtIEEgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSBsb2FkLiBJZiB0aGUgbG9hZCB0YWtlc1xuICAgICAqICAgICAgbG9uZ2VyIHRoYW4gdGhpcyB0aW1lIGl0IGlzIGNhbmNlbGxlZCBhbmQgdGhlIGxvYWQgaXMgY29uc2lkZXJlZCBhIGZhaWx1cmUuIElmIHRoaXMgdmFsdWUgaXNcbiAgICAgKiAgICAgIHNldCB0byBgMGAgdGhlbiB0aGVyZSBpcyBubyBleHBsaWNpdCB0aW1lb3V0LlxuICAgICAqIEBwcm9wZXJ0eSB7UmVzb3VyY2UuTE9BRF9UWVBFfSBbbG9hZFR5cGU9UmVzb3VyY2UuTE9BRF9UWVBFLlhIUl0gLSBIb3cgc2hvdWxkIHRoaXMgcmVzb3VyY2VcbiAgICAgKiAgICAgIGJlIGxvYWRlZD9cbiAgICAgKiBAcHJvcGVydHkge1Jlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFfSBbeGhyVHlwZT1SZXNvdXJjZS5YSFJfUkVTUE9OU0VfVFlQRS5ERUZBVUxUXSAtIEhvd1xuICAgICAqICAgICAgc2hvdWxkIHRoZSBkYXRhIGJlaW5nIGxvYWRlZCBiZSBpbnRlcnByZXRlZCB3aGVuIHVzaW5nIFhIUj9cbiAgICAgKiBAcHJvcGVydHkge1Jlc291cmNlLk9uQ29tcGxldGVTaWduYWx9IFtvbkNvbXBsZXRlXSAtIENhbGxiYWNrIHRvIGFkZCBhbiBhbiBvbkNvbXBsZXRlIHNpZ25hbCBpc3RlbmVyLlxuICAgICAqIEBwcm9wZXJ0eSB7UmVzb3VyY2UuT25Db21wbGV0ZVNpZ25hbH0gW2NhbGxiYWNrXSAtIEFsaWFzIGZvciBgb25Db21wbGV0ZWAuXG4gICAgICogQHByb3BlcnR5IHtSZXNvdXJjZS5JTWV0YWRhdGF9IFttZXRhZGF0YV0gLSBFeHRyYSBjb25maWd1cmF0aW9uIGZvciBtaWRkbGV3YXJlIGFuZCB0aGUgUmVzb3VyY2Ugb2JqZWN0LlxuICAgICAqL1xuXG4gICAgLyogZXNsaW50LWRpc2FibGUgcmVxdWlyZS1qc2RvYyx2YWxpZC1qc2RvYyAqL1xuICAgIC8qKlxuICAgICAqIEFkZHMgYSByZXNvdXJjZSAob3IgbXVsdGlwbGUgcmVzb3VyY2VzKSB0byB0aGUgbG9hZGVyIHF1ZXVlLlxuICAgICAqXG4gICAgICogVGhpcyBmdW5jdGlvbiBjYW4gdGFrZSBhIHdpZGUgdmFyaWV0eSBvZiBkaWZmZXJlbnQgcGFyYW1ldGVycy4gVGhlIG9ubHkgdGhpbmcgdGhhdCBpcyBhbHdheXNcbiAgICAgKiByZXF1aXJlZCB0aGUgdXJsIHRvIGxvYWQuIEFsbCB0aGUgZm9sbG93aW5nIHdpbGwgd29yazpcbiAgICAgKlxuICAgICAqIGBgYGpzXG4gICAgICogbG9hZGVyXG4gICAgICogICAgIC8vIG5vcm1hbCBwYXJhbSBzeW50YXhcbiAgICAgKiAgICAgLmFkZCgna2V5JywgJ2h0dHA6Ly8uLi4nLCBmdW5jdGlvbiAoKSB7fSlcbiAgICAgKiAgICAgLmFkZCgnaHR0cDovLy4uLicsIGZ1bmN0aW9uICgpIHt9KVxuICAgICAqICAgICAuYWRkKCdodHRwOi8vLi4uJylcbiAgICAgKlxuICAgICAqICAgICAvLyBvYmplY3Qgc3ludGF4XG4gICAgICogICAgIC5hZGQoe1xuICAgICAqICAgICAgICAgbmFtZTogJ2tleTInLFxuICAgICAqICAgICAgICAgdXJsOiAnaHR0cDovLy4uLidcbiAgICAgKiAgICAgfSwgZnVuY3Rpb24gKCkge30pXG4gICAgICogICAgIC5hZGQoe1xuICAgICAqICAgICAgICAgdXJsOiAnaHR0cDovLy4uLidcbiAgICAgKiAgICAgfSwgZnVuY3Rpb24gKCkge30pXG4gICAgICogICAgIC5hZGQoe1xuICAgICAqICAgICAgICAgbmFtZTogJ2tleTMnLFxuICAgICAqICAgICAgICAgdXJsOiAnaHR0cDovLy4uLidcbiAgICAgKiAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uICgpIHt9XG4gICAgICogICAgIH0pXG4gICAgICogICAgIC5hZGQoe1xuICAgICAqICAgICAgICAgdXJsOiAnaHR0cHM6Ly8uLi4nLFxuICAgICAqICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gKCkge30sXG4gICAgICogICAgICAgICBjcm9zc09yaWdpbjogdHJ1ZVxuICAgICAqICAgICB9KVxuICAgICAqXG4gICAgICogICAgIC8vIHlvdSBjYW4gYWxzbyBwYXNzIGFuIGFycmF5IG9mIG9iamVjdHMgb3IgdXJscyBvciBib3RoXG4gICAgICogICAgIC5hZGQoW1xuICAgICAqICAgICAgICAgeyBuYW1lOiAna2V5NCcsIHVybDogJ2h0dHA6Ly8uLi4nLCBvbkNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7fSB9LFxuICAgICAqICAgICAgICAgeyB1cmw6ICdodHRwOi8vLi4uJywgb25Db21wbGV0ZTogZnVuY3Rpb24gKCkge30gfSxcbiAgICAgKiAgICAgICAgICdodHRwOi8vLi4uJ1xuICAgICAqICAgICBdKVxuICAgICAqXG4gICAgICogICAgIC8vIGFuZCB5b3UgY2FuIHVzZSBib3RoIHBhcmFtcyBhbmQgb3B0aW9uc1xuICAgICAqICAgICAuYWRkKCdrZXknLCAnaHR0cDovLy4uLicsIHsgY3Jvc3NPcmlnaW46IHRydWUgfSwgZnVuY3Rpb24gKCkge30pXG4gICAgICogICAgIC5hZGQoJ2h0dHA6Ly8uLi4nLCB7IGNyb3NzT3JpZ2luOiB0cnVlIH0sIGZ1bmN0aW9uICgpIHt9KTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEB2YXJpYXRpb24gMVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHJlc291cmNlIHRvIGxvYWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSB1cmwgZm9yIHRoaXMgcmVzb3VyY2UsIHJlbGF0aXZlIHRvIHRoZSBiYXNlVXJsIG9mIHRoaXMgbG9hZGVyLlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2UuT25Db21wbGV0ZVNpZ25hbH0gW2NhbGxiYWNrXSAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGlzIHNwZWNpZmljIHJlc291cmNlIGNvbXBsZXRlcyBsb2FkaW5nLlxuICAgICAqIEByZXR1cm4ge3RoaXN9IFJldHVybnMgaXRzZWxmLlxuICAgICAqLy8qKlxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEB2YXJpYXRpb24gMlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHJlc291cmNlIHRvIGxvYWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSB1cmwgZm9yIHRoaXMgcmVzb3VyY2UsIHJlbGF0aXZlIHRvIHRoZSBiYXNlVXJsIG9mIHRoaXMgbG9hZGVyLlxuICAgICAqIEBwYXJhbSB7SUFkZE9wdGlvbnN9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25zIGZvciB0aGUgbG9hZC5cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLk9uQ29tcGxldGVTaWduYWx9IFtjYWxsYmFja10gLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhpcyBzcGVjaWZpYyByZXNvdXJjZSBjb21wbGV0ZXMgbG9hZGluZy5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi8vKipcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAdmFyaWF0aW9uIDNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVGhlIHVybCBmb3IgdGhpcyByZXNvdXJjZSwgcmVsYXRpdmUgdG8gdGhlIGJhc2VVcmwgb2YgdGhpcyBsb2FkZXIuXG4gICAgICogQHBhcmFtIHtSZXNvdXJjZS5PbkNvbXBsZXRlU2lnbmFsfSBbY2FsbGJhY2tdIC0gRnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoaXMgc3BlY2lmaWMgcmVzb3VyY2UgY29tcGxldGVzIGxvYWRpbmcuXG4gICAgICogQHJldHVybiB7dGhpc30gUmV0dXJucyBpdHNlbGYuXG4gICAgICovLyoqXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHZhcmlhdGlvbiA0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSB1cmwgZm9yIHRoaXMgcmVzb3VyY2UsIHJlbGF0aXZlIHRvIHRoZSBiYXNlVXJsIG9mIHRoaXMgbG9hZGVyLlxuICAgICAqIEBwYXJhbSB7SUFkZE9wdGlvbnN9IFtvcHRpb25zXSAtIFRoZSBvcHRpb25zIGZvciB0aGUgbG9hZC5cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLk9uQ29tcGxldGVTaWduYWx9IFtjYWxsYmFja10gLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhpcyBzcGVjaWZpYyByZXNvdXJjZSBjb21wbGV0ZXMgbG9hZGluZy5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi8vKipcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAdmFyaWF0aW9uIDVcbiAgICAgKiBAcGFyYW0ge0lBZGRPcHRpb25zfSBvcHRpb25zIC0gVGhlIG9wdGlvbnMgZm9yIHRoZSBsb2FkLiBUaGlzIG9iamVjdCBtdXN0IGNvbnRhaW4gYSBgdXJsYCBwcm9wZXJ0eS5cbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlLk9uQ29tcGxldGVTaWduYWx9IFtjYWxsYmFja10gLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhpcyBzcGVjaWZpYyByZXNvdXJjZSBjb21wbGV0ZXMgbG9hZGluZy5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi8vKipcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAdmFyaWF0aW9uIDZcbiAgICAgKiBAcGFyYW0ge0FycmF5PElBZGRPcHRpb25zfHN0cmluZz59IHJlc291cmNlcyAtIEFuIGFycmF5IG9mIHJlc291cmNlcyB0byBsb2FkLCB3aGVyZSBlYWNoIGlzXG4gICAgICogICAgICBlaXRoZXIgYW4gb2JqZWN0IHdpdGggdGhlIG9wdGlvbnMgb3IgYSBzdHJpbmcgdXJsLiBJZiB5b3UgcGFzcyBhbiBvYmplY3QsIGl0IG11c3QgY29udGFpbiBhIGB1cmxgIHByb3BlcnR5LlxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2UuT25Db21wbGV0ZVNpZ25hbH0gW2NhbGxiYWNrXSAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGlzIHNwZWNpZmljIHJlc291cmNlIGNvbXBsZXRlcyBsb2FkaW5nLlxuICAgICAqIEByZXR1cm4ge3RoaXN9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIGFkZChuYW1lLCB1cmwsIG9wdGlvbnMsIGNiKSB7XG4gICAgICAgIC8vIHNwZWNpYWwgY2FzZSBvZiBhbiBhcnJheSBvZiBvYmplY3RzIG9yIHVybHNcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZSkpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmFtZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkKG5hbWVbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIGFuIG9iamVjdCBpcyBwYXNzZWQgaW5zdGVhZCBvZiBwYXJhbXNcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgY2IgPSB1cmwgfHwgbmFtZS5jYWxsYmFjayB8fCBuYW1lLm9uQ29tcGxldGU7XG4gICAgICAgICAgICBvcHRpb25zID0gbmFtZTtcbiAgICAgICAgICAgIHVybCA9IG5hbWUudXJsO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUubmFtZSB8fCBuYW1lLmtleSB8fCBuYW1lLnVybDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhc2Ugd2hlcmUgbm8gbmFtZSBpcyBwYXNzZWQgc2hpZnQgYWxsIGFyZ3Mgb3ZlciBieSBvbmUuXG4gICAgICAgIGlmICh0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY2IgPSBvcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucyA9IHVybDtcbiAgICAgICAgICAgIHVybCA9IG5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBub3cgdGhhdCB3ZSBzaGlmdGVkIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgcHJvcGVyIHVybC5cbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVybCBwYXNzZWQgdG8gYWRkIHJlc291cmNlIHRvIGxvYWRlci4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG9wdGlvbnMgYXJlIG9wdGlvbmFsIHNvIHBlb3BsZSBtaWdodCBwYXNzIGEgZnVuY3Rpb24gYW5kIG5vIG9wdGlvbnNcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYiA9IG9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIGxvYWRpbmcgYWxyZWFkeSB5b3UgY2FuIG9ubHkgYWRkIHJlc291cmNlcyB0aGF0IGhhdmUgYSBwYXJlbnQuXG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmcgJiYgKCFvcHRpb25zIHx8ICFvcHRpb25zLnBhcmVudFJlc291cmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgYWRkIHJlc291cmNlcyB3aGlsZSB0aGUgbG9hZGVyIGlzIHJ1bm5pbmcuJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjaGVjayBpZiByZXNvdXJjZSBhbHJlYWR5IGV4aXN0cy5cbiAgICAgICAgaWYgKHRoaXMucmVzb3VyY2VzW25hbWVdKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlc291cmNlIG5hbWVkIFwiJHtuYW1lfVwiIGFscmVhZHkgZXhpc3RzLmApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIGJhc2UgdXJsIGlmIHRoaXMgaXNuJ3QgYW4gYWJzb2x1dGUgdXJsXG4gICAgICAgIHVybCA9IHRoaXMuX3ByZXBhcmVVcmwodXJsKTtcblxuICAgICAgICAvLyBjcmVhdGUgdGhlIHN0b3JlIHRoZSByZXNvdXJjZVxuICAgICAgICB0aGlzLnJlc291cmNlc1tuYW1lXSA9IG5ldyBSZXNvdXJjZShuYW1lLCB1cmwsIG9wdGlvbnMpO1xuXG4gICAgICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMucmVzb3VyY2VzW25hbWVdLm9uQWZ0ZXJNaWRkbGV3YXJlLm9uY2UoY2IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgYWN0aXZlbHkgbG9hZGluZywgbWFrZSBzdXJlIHRvIGFkanVzdCBwcm9ncmVzcyBjaHVua3MgZm9yIHRoYXQgcGFyZW50IGFuZCBpdHMgY2hpbGRyZW5cbiAgICAgICAgaWYgKHRoaXMubG9hZGluZykge1xuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gb3B0aW9ucy5wYXJlbnRSZXNvdXJjZTtcbiAgICAgICAgICAgIGNvbnN0IGluY29tcGxldGVDaGlsZHJlbiA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmVudC5jaGlsZHJlbi5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIGlmICghcGFyZW50LmNoaWxkcmVuW2ldLmlzQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5jb21wbGV0ZUNoaWxkcmVuLnB1c2gocGFyZW50LmNoaWxkcmVuW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGZ1bGxDaHVuayA9IHBhcmVudC5wcm9ncmVzc0NodW5rICogKGluY29tcGxldGVDaGlsZHJlbi5sZW5ndGggKyAxKTsgLy8gKzEgZm9yIHBhcmVudFxuICAgICAgICAgICAgY29uc3QgZWFjaENodW5rID0gZnVsbENodW5rIC8gKGluY29tcGxldGVDaGlsZHJlbi5sZW5ndGggKyAyKTsgLy8gKzIgZm9yIHBhcmVudCAmIG5ldyBjaGlsZFxuXG4gICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaCh0aGlzLnJlc291cmNlc1tuYW1lXSk7XG4gICAgICAgICAgICBwYXJlbnQucHJvZ3Jlc3NDaHVuayA9IGVhY2hDaHVuaztcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmNvbXBsZXRlQ2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpbmNvbXBsZXRlQ2hpbGRyZW5baV0ucHJvZ3Jlc3NDaHVuayA9IGVhY2hDaHVuaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZXNbbmFtZV0ucHJvZ3Jlc3NDaHVuayA9IGVhY2hDaHVuaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFkZCB0aGUgcmVzb3VyY2UgdG8gdGhlIHF1ZXVlXG4gICAgICAgIHRoaXMuX3F1ZXVlLnB1c2godGhpcy5yZXNvdXJjZXNbbmFtZV0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIHJlcXVpcmUtanNkb2MsdmFsaWQtanNkb2MgKi9cblxuICAgIC8qKlxuICAgICAqIFNldHMgdXAgYSBtaWRkbGV3YXJlIGZ1bmN0aW9uIHRoYXQgd2lsbCBydW4gKmJlZm9yZSogdGhlXG4gICAgICogcmVzb3VyY2UgaXMgbG9hZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSBUaGUgbWlkZGxld2FyZSBmdW5jdGlvbiB0byByZWdpc3Rlci5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICBwcmUoZm4pIHtcbiAgICAgICAgdGhpcy5fYmVmb3JlTWlkZGxld2FyZS5wdXNoKGZuKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIGEgbWlkZGxld2FyZSBmdW5jdGlvbiB0aGF0IHdpbGwgcnVuICphZnRlciogdGhlXG4gICAgICogcmVzb3VyY2UgaXMgbG9hZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSBUaGUgbWlkZGxld2FyZSBmdW5jdGlvbiB0byByZWdpc3Rlci5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICB1c2UoZm4pIHtcbiAgICAgICAgdGhpcy5fYWZ0ZXJNaWRkbGV3YXJlLnB1c2goZm4pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgcXVldWUgb2YgdGhlIGxvYWRlciB0byBwcmVwYXJlIGZvciBhIG5ldyBsb2FkLlxuICAgICAqXG4gICAgICogQHJldHVybiB7dGhpc30gUmV0dXJucyBpdHNlbGYuXG4gICAgICovXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3MgPSAwO1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9xdWV1ZS5raWxsKCk7XG4gICAgICAgIHRoaXMuX3F1ZXVlLnBhdXNlKCk7XG5cbiAgICAgICAgLy8gYWJvcnQgYWxsIHJlc291cmNlIGxvYWRzXG4gICAgICAgIGZvciAoY29uc3QgayBpbiB0aGlzLnJlc291cmNlcykge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gdGhpcy5yZXNvdXJjZXNba107XG5cbiAgICAgICAgICAgIGlmIChyZXMuX29uTG9hZEJpbmRpbmcpIHtcbiAgICAgICAgICAgICAgICByZXMuX29uTG9hZEJpbmRpbmcuZGV0YWNoKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyZXMuaXNMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgcmVzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc291cmNlcyA9IHt9O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBsb2FkaW5nIHRoZSBxdWV1ZWQgcmVzb3VyY2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gW2NiXSAtIE9wdGlvbmFsIGNhbGxiYWNrIHRoYXQgd2lsbCBiZSBib3VuZCB0byB0aGUgYGNvbXBsZXRlYCBldmVudC5cbiAgICAgKiBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICBsb2FkKGNiKSB7XG4gICAgICAgIC8vIHJlZ2lzdGVyIGNvbXBsZXRlIGNhbGxiYWNrIGlmIHRoZXkgcGFzcyBvbmVcbiAgICAgICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlLm9uY2UoY2IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIHF1ZXVlIGhhcyBhbHJlYWR5IHN0YXJ0ZWQgd2UgYXJlIGRvbmUgaGVyZVxuICAgICAgICBpZiAodGhpcy5sb2FkaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9xdWV1ZS5pZGxlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX29uU3RhcnQoKTtcbiAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRpc3RyaWJ1dGUgcHJvZ3Jlc3MgY2h1bmtzXG4gICAgICAgICAgICBjb25zdCBudW1UYXNrcyA9IHRoaXMuX3F1ZXVlLl90YXNrcy5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBjaHVuayA9IE1BWF9QUk9HUkVTUyAvIG51bVRhc2tzO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX3F1ZXVlLl90YXNrcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1ZXVlLl90YXNrc1tpXS5kYXRhLnByb2dyZXNzQ2h1bmsgPSBjaHVuaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbm90aWZ5IHdlIGFyZSBzdGFydGluZ1xuICAgICAgICAgICAgdGhpcy5fb25TdGFydCgpO1xuXG4gICAgICAgICAgICAvLyBzdGFydCBsb2FkaW5nXG4gICAgICAgICAgICB0aGlzLl9xdWV1ZS5yZXN1bWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2YgcmVzb3VyY2VzIHRvIGxvYWQgY29uY3VycmVudGx5LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDEwXG4gICAgICovXG4gICAgZ2V0IGNvbmN1cnJlbmN5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVldWUuY29uY3VycmVuY3k7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWpzZG9jXG4gICAgc2V0IGNvbmN1cnJlbmN5KGNvbmN1cnJlbmN5KSB7XG4gICAgICAgIHRoaXMuX3F1ZXVlLmNvbmN1cnJlbmN5ID0gY29uY3VycmVuY3k7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJlcGFyZXMgYSB1cmwgZm9yIHVzYWdlIGJhc2VkIG9uIHRoZSBjb25maWd1cmF0aW9uIG9mIHRoaXMgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgdXJsIHRvIHByZXBhcmUuXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgcHJlcGFyZWQgdXJsLlxuICAgICAqL1xuICAgIF9wcmVwYXJlVXJsKHVybCkge1xuICAgICAgICBjb25zdCBwYXJzZWRVcmwgPSBwYXJzZVVyaSh1cmwsIHsgc3RyaWN0TW9kZTogdHJ1ZSB9KTtcbiAgICAgICAgbGV0IHJlc3VsdDtcblxuICAgICAgICAvLyBhYnNvbHV0ZSB1cmwsIGp1c3QgdXNlIGl0IGFzIGlzLlxuICAgICAgICBpZiAocGFyc2VkVXJsLnByb3RvY29sIHx8ICFwYXJzZWRVcmwucGF0aCB8fCB1cmwuaW5kZXhPZignLy8nKSA9PT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdXJsO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIGJhc2VVcmwgZG9lc24ndCBlbmQgaW4gc2xhc2ggYW5kIHVybCBkb2Vzbid0IHN0YXJ0IHdpdGggc2xhc2gsIHRoZW4gYWRkIGEgc2xhc2ggaW5iZXR3ZWVuXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYmFzZVVybC5sZW5ndGhcbiAgICAgICAgICAgICYmIHRoaXMuYmFzZVVybC5sYXN0SW5kZXhPZignLycpICE9PSB0aGlzLmJhc2VVcmwubGVuZ3RoIC0gMVxuICAgICAgICAgICAgJiYgdXJsLmNoYXJBdCgwKSAhPT0gJy8nXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmVzdWx0ID0gYCR7dGhpcy5iYXNlVXJsfS8ke3VybH1gO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5iYXNlVXJsICsgdXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgd2UgbmVlZCB0byBhZGQgYSBkZWZhdWx0IHF1ZXJ5c3RyaW5nLCB0aGVyZSBpcyBhIGJpdCBtb3JlIHdvcmtcbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBoYXNoID0gcmd4RXh0cmFjdFVybEhhc2guZXhlYyhyZXN1bHQpWzBdO1xuXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc3Vic3RyKDAsIHJlc3VsdC5sZW5ndGggLSBoYXNoLmxlbmd0aCk7XG5cbiAgICAgICAgICAgIGlmIChyZXN1bHQuaW5kZXhPZignPycpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBgJiR7dGhpcy5kZWZhdWx0UXVlcnlTdHJpbmd9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBgPyR7dGhpcy5kZWZhdWx0UXVlcnlTdHJpbmd9YDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzdWx0ICs9IGhhc2g7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWRzIGEgc2luZ2xlIHJlc291cmNlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1Jlc291cmNlfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSB0byBsb2FkLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGRlcXVldWUgLSBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHdlIG5lZWQgdG8gZGVxdWV1ZSB0aGlzIGl0ZW0uXG4gICAgICovXG4gICAgX2xvYWRSZXNvdXJjZShyZXNvdXJjZSwgZGVxdWV1ZSkge1xuICAgICAgICByZXNvdXJjZS5fZGVxdWV1ZSA9IGRlcXVldWU7XG5cbiAgICAgICAgLy8gcnVuIGJlZm9yZSBtaWRkbGV3YXJlXG4gICAgICAgIGFzeW5jLmVhY2hTZXJpZXMoXG4gICAgICAgICAgICB0aGlzLl9iZWZvcmVNaWRkbGV3YXJlLFxuICAgICAgICAgICAgKGZuLCBuZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCByZXNvdXJjZSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgYmVmb3JlIG1pZGRsZXdhcmUgbWFya3MgdGhlIHJlc291cmNlIGFzIGNvbXBsZXRlLFxuICAgICAgICAgICAgICAgICAgICAvLyBicmVhayBhbmQgZG9uJ3QgcHJvY2VzcyBhbnkgbW9yZSBiZWZvcmUgbWlkZGxld2FyZVxuICAgICAgICAgICAgICAgICAgICBuZXh0KHJlc291cmNlLmlzQ29tcGxldGUgPyB7fSA6IG51bGwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UuaXNDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkxvYWQocmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UuX29uTG9hZEJpbmRpbmcgPSByZXNvdXJjZS5vbkNvbXBsZXRlLm9uY2UodGhpcy5fb25Mb2FkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UubG9hZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIG9uY2UgbG9hZGluZyBoYXMgc3RhcnRlZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uU3RhcnQoKSB7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3MgPSAwO1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLm9uU3RhcnQuZGlzcGF0Y2godGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIG9uY2UgZWFjaCByZXNvdXJjZSBoYXMgbG9hZGVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25Db21wbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IE1BWF9QUk9HUkVTUztcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMub25Db21wbGV0ZS5kaXNwYXRjaCh0aGlzLCB0aGlzLnJlc291cmNlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGVhY2ggdGltZSBhIHJlc291cmNlcyBpcyBsb2FkZWQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UmVzb3VyY2V9IHJlc291cmNlIC0gVGhlIHJlc291cmNlIHRoYXQgd2FzIGxvYWRlZFxuICAgICAqL1xuICAgIF9vbkxvYWQocmVzb3VyY2UpIHtcbiAgICAgICAgcmVzb3VyY2UuX29uTG9hZEJpbmRpbmcgPSBudWxsO1xuXG4gICAgICAgIC8vIHJlbW92ZSB0aGlzIHJlc291cmNlIGZyb20gdGhlIGFzeW5jIHF1ZXVlLCBhbmQgYWRkIGl0IHRvIG91ciBsaXN0IG9mIHJlc291cmNlcyB0aGF0IGFyZSBiZWluZyBwYXJzZWRcbiAgICAgICAgdGhpcy5fcmVzb3VyY2VzUGFyc2luZy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgcmVzb3VyY2UuX2RlcXVldWUoKTtcblxuICAgICAgICAvLyBydW4gYWxsIHRoZSBhZnRlciBtaWRkbGV3YXJlIGZvciB0aGlzIHJlc291cmNlXG4gICAgICAgIGFzeW5jLmVhY2hTZXJpZXMoXG4gICAgICAgICAgICB0aGlzLl9hZnRlck1pZGRsZXdhcmUsXG4gICAgICAgICAgICAoZm4sIG5leHQpID0+IHtcbiAgICAgICAgICAgICAgICBmbi5jYWxsKHRoaXMsIHJlc291cmNlLCBuZXh0KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2Uub25BZnRlck1pZGRsZXdhcmUuZGlzcGF0Y2gocmVzb3VyY2UpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IE1hdGgubWluKE1BWF9QUk9HUkVTUywgdGhpcy5wcm9ncmVzcyArIHJlc291cmNlLnByb2dyZXNzQ2h1bmspO1xuICAgICAgICAgICAgICAgIHRoaXMub25Qcm9ncmVzcy5kaXNwYXRjaCh0aGlzLCByZXNvdXJjZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yLmRpc3BhdGNoKHJlc291cmNlLmVycm9yLCB0aGlzLCByZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uTG9hZC5kaXNwYXRjaCh0aGlzLCByZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzb3VyY2VzUGFyc2luZy5zcGxpY2UodGhpcy5fcmVzb3VyY2VzUGFyc2luZy5pbmRleE9mKHJlc291cmNlKSwgMSk7XG5cbiAgICAgICAgICAgICAgICAvLyBkbyBjb21wbGV0aW9uIGNoZWNrXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3F1ZXVlLmlkbGUoKSAmJiB0aGlzLl9yZXNvdXJjZXNQYXJzaW5nLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBkZWZhdWx0IGFycmF5IG9mIG1pZGRsZXdhcmUgdG8gcnVuIGJlZm9yZSBsb2FkaW5nIGVhY2ggcmVzb3VyY2UuXG4gKiBFYWNoIG9mIHRoZXNlIG1pZGRsZXdhcmVzIGFyZSBhZGRlZCB0byBhbnkgbmV3IExvYWRlciBpbnN0YW5jZXMgd2hlbiB0aGV5IGFyZSBjcmVhdGVkLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAbWVtYmVyIHtmdW5jdGlvbltdfVxuICovXG5Mb2FkZXIuX2RlZmF1bHRCZWZvcmVNaWRkbGV3YXJlID0gW107XG5cbi8qKlxuICogQSBkZWZhdWx0IGFycmF5IG9mIG1pZGRsZXdhcmUgdG8gcnVuIGFmdGVyIGxvYWRpbmcgZWFjaCByZXNvdXJjZS5cbiAqIEVhY2ggb2YgdGhlc2UgbWlkZGxld2FyZXMgYXJlIGFkZGVkIHRvIGFueSBuZXcgTG9hZGVyIGluc3RhbmNlcyB3aGVuIHRoZXkgYXJlIGNyZWF0ZWQuXG4gKlxuICogQHByaXZhdGVcbiAqIEBtZW1iZXIge2Z1bmN0aW9uW119XG4gKi9cbkxvYWRlci5fZGVmYXVsdEFmdGVyTWlkZGxld2FyZSA9IFtdO1xuXG4vKipcbiAqIFNldHMgdXAgYSBtaWRkbGV3YXJlIGZ1bmN0aW9uIHRoYXQgd2lsbCBydW4gKmJlZm9yZSogdGhlXG4gKiByZXNvdXJjZSBpcyBsb2FkZWQuXG4gKlxuICogQHN0YXRpY1xuICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSBUaGUgbWlkZGxld2FyZSBmdW5jdGlvbiB0byByZWdpc3Rlci5cbiAqIEByZXR1cm4ge0xvYWRlcn0gUmV0dXJucyBpdHNlbGYuXG4gKi9cbkxvYWRlci5wcmUgPSBmdW5jdGlvbiBMb2FkZXJQcmVTdGF0aWMoZm4pIHtcbiAgICBMb2FkZXIuX2RlZmF1bHRCZWZvcmVNaWRkbGV3YXJlLnB1c2goZm4pO1xuXG4gICAgcmV0dXJuIExvYWRlcjtcbn07XG5cbi8qKlxuICogU2V0cyB1cCBhIG1pZGRsZXdhcmUgZnVuY3Rpb24gdGhhdCB3aWxsIHJ1biAqYWZ0ZXIqIHRoZVxuICogcmVzb3VyY2UgaXMgbG9hZGVkLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGZuIC0gVGhlIG1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gcmVnaXN0ZXIuXG4gKiBAcmV0dXJuIHtMb2FkZXJ9IFJldHVybnMgaXRzZWxmLlxuICovXG5Mb2FkZXIudXNlID0gZnVuY3Rpb24gTG9hZGVyVXNlU3RhdGljKGZuKSB7XG4gICAgTG9hZGVyLl9kZWZhdWx0QWZ0ZXJNaWRkbGV3YXJlLnB1c2goZm4pO1xuXG4gICAgcmV0dXJuIExvYWRlcjtcbn07XG5cbmV4cG9ydCB7IExvYWRlciB9O1xuXG4iLCAiaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tICdyZXNvdXJjZS1sb2FkZXInO1xuXG5pbXBvcnQgdHlwZSB7IFNwcml0ZXNoZWV0IH0gZnJvbSAnQHBpeGkvc3ByaXRlc2hlZXQnO1xuaW1wb3J0IHR5cGUgeyBUZXh0dXJlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlc291cmNlTWV0YWRhdGEgZXh0ZW5kcyBHbG9iYWxNaXhpbnMuSVJlc291cmNlTWV0YWRhdGEsIFJlc291cmNlLklNZXRhZGF0YSB7XG4gICAgaW1hZ2VNZXRhZGF0YT86IGFueTtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgSUxvYWRlclJlc291cmNlIGV4dGVuZHMgR2xvYmFsTWl4aW5zLklMb2FkZXJSZXNvdXJjZSwgUmVzb3VyY2VcbntcbiAgICB0ZXh0dXJlPzogVGV4dHVyZTtcbiAgICBzcHJpdGVzaGVldD86IFNwcml0ZXNoZWV0O1xuXG4gICAgLy8gcmVxdWlyZWQgZm9yIFNwcml0ZXNoZWV0XG4gICAgdGV4dHVyZXM/OiBEaWN0PFRleHR1cmU+O1xuXG4gICAgLy8gcmVxdWlyZWQgc3BlY2lmaWMgdHlwZSBmb3IgU3ByaXRlc2hlZXRcbiAgICBtZXRhZGF0YTogSVJlc291cmNlTWV0YWRhdGE7XG59XG5cbi8vIE1peCBjb25zdHJ1Y3RvciBhbmQgdHlwZW9mIFJlc291cmNlICwgb3RoZXJ3aXNlIHdlIGNhbid0IGFjY2VzcyB0byBzdGF0aWNzIGZpZWxkXG50eXBlIFRMb2FkZXJSZXNvdXJjZSA9IHsgbmV3KC4uLmFyZ3M6IGFueVtdKTogSUxvYWRlclJlc291cmNlIH0gJiB0eXBlb2YgUmVzb3VyY2U7XG5cbi8qKlxuKiBSZWZlcmVuY2UgdG8gKip7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2VuZ2xlcmNqL3Jlc291cmNlLWxvYWRlclxuKiByZXNvdXJjZS1sb2FkZXJ9KioncyBSZXNvdXJjZSBjbGFzcy5cbiogQHNlZSBodHRwOi8vZW5nbGVyY2ouZ2l0aHViLmlvL3Jlc291cmNlLWxvYWRlci9SZXNvdXJjZS5odG1sXG4qIEBjbGFzcyBMb2FkZXJSZXNvdXJjZVxuKiBAbWVtYmVyb2YgUElYSVxuKi9cbmV4cG9ydCBjb25zdCBMb2FkZXJSZXNvdXJjZTogVExvYWRlclJlc291cmNlID0gUmVzb3VyY2U7XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tICdyZXNvdXJjZS1sb2FkZXInO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5pbXBvcnQgdHlwZSB7IElMb2FkZXJSZXNvdXJjZSB9IGZyb20gJy4vTG9hZGVyUmVzb3VyY2UnO1xuXG4vKipcbiAqIExvYWRlciBwbHVnaW4gZm9yIGhhbmRsaW5nIFRleHR1cmUgcmVzb3VyY2VzLlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGltcGxlbWVudHMgUElYSS5JTG9hZGVyUGx1Z2luXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0dXJlTG9hZGVyXG57XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGFmdGVyIGEgcmVzb3VyY2UgaXMgbG9hZGVkLlxuICAgICAqIEBzZWUgUElYSS5Mb2FkZXIubG9hZGVyTWlkZGxld2FyZVxuICAgICAqIEBwYXJhbSB7UElYSS5Mb2FkZXJSZXNvdXJjZX0gcmVzb3VyY2VcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXh0XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyB1c2UocmVzb3VyY2U6IElMb2FkZXJSZXNvdXJjZSwgbmV4dDogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkKTogdm9pZFxuICAgIHtcbiAgICAgICAgLy8gY3JlYXRlIGEgbmV3IHRleHR1cmUgaWYgdGhlIGRhdGEgaXMgYW4gSW1hZ2Ugb2JqZWN0XG4gICAgICAgIGlmIChyZXNvdXJjZS5kYXRhICYmIHJlc291cmNlLnR5cGUgPT09IFJlc291cmNlLlRZUEUuSU1BR0UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlc291cmNlLnRleHR1cmUgPSBUZXh0dXJlLmZyb21Mb2FkZXIoXG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuZGF0YSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZS51cmwsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2UubmFtZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBuZXh0KCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IExvYWRlciBhcyBSZXNvdXJjZUxvYWRlciwgbWlkZGxld2FyZSB9IGZyb20gJ3Jlc291cmNlLWxvYWRlcic7XG5pbXBvcnQgeyBUZXh0dXJlTG9hZGVyIH0gZnJvbSAnLi9UZXh0dXJlTG9hZGVyJztcblxuaW1wb3J0IHR5cGUgeyBSZXNvdXJjZSB9IGZyb20gJ3Jlc291cmNlLWxvYWRlcic7XG5cbi8qKlxuICogVGhlIG5ldyBsb2FkZXIsIGV4dGVuZHMgUmVzb3VyY2UgTG9hZGVyIGJ5IENoYWQgRW5nbGVyOiBodHRwczovL2dpdGh1Yi5jb20vZW5nbGVyY2ovcmVzb3VyY2UtbG9hZGVyXG4gKlxuICogYGBganNcbiAqIGNvbnN0IGxvYWRlciA9IFBJWEkuTG9hZGVyLnNoYXJlZDsgLy8gUGl4aUpTIGV4cG9zZXMgYSBwcmVtYWRlIGluc3RhbmNlIGZvciB5b3UgdG8gdXNlLlxuICogLy9vclxuICogY29uc3QgbG9hZGVyID0gbmV3IFBJWEkuTG9hZGVyKCk7IC8vIHlvdSBjYW4gYWxzbyBjcmVhdGUgeW91ciBvd24gaWYgeW91IHdhbnRcbiAqXG4gKiBjb25zdCBzcHJpdGVzID0ge307XG4gKlxuICogLy8gQ2hhaW5hYmxlIGBhZGRgIHRvIGVucXVldWUgYSByZXNvdXJjZVxuICogbG9hZGVyLmFkZCgnYnVubnknLCAnZGF0YS9idW5ueS5wbmcnKVxuICogICAgICAgLmFkZCgnc3BhY2VzaGlwJywgJ2Fzc2V0cy9zcHJpdGVzaGVldC5qc29uJyk7XG4gKiBsb2FkZXIuYWRkKCdzY29yZUZvbnQnLCAnYXNzZXRzL3Njb3JlLmZudCcpO1xuICpcbiAqIC8vIENoYWluYWJsZSBgcHJlYCB0byBhZGQgYSBtaWRkbGV3YXJlIHRoYXQgcnVucyBmb3IgZWFjaCByZXNvdXJjZSwgKmJlZm9yZSogbG9hZGluZyB0aGF0IHJlc291cmNlLlxuICogLy8gVGhpcyBpcyB1c2VmdWwgdG8gaW1wbGVtZW50IGN1c3RvbSBjYWNoaW5nIG1vZHVsZXMgKHVzaW5nIGZpbGVzeXN0ZW0sIGluZGV4ZWRkYiwgbWVtb3J5LCBldGMpLlxuICogbG9hZGVyLnByZShjYWNoaW5nTWlkZGxld2FyZSk7XG4gKlxuICogLy8gQ2hhaW5hYmxlIGB1c2VgIHRvIGFkZCBhIG1pZGRsZXdhcmUgdGhhdCBydW5zIGZvciBlYWNoIHJlc291cmNlLCAqYWZ0ZXIqIGxvYWRpbmcgdGhhdCByZXNvdXJjZS5cbiAqIC8vIFRoaXMgaXMgdXNlZnVsIHRvIGltcGxlbWVudCBjdXN0b20gcGFyc2luZyBtb2R1bGVzIChsaWtlIHNwcml0ZXNoZWV0IHBhcnNlcnMsIHNwaW5lIHBhcnNlciwgZXRjKS5cbiAqIGxvYWRlci51c2UocGFyc2luZ01pZGRsZXdhcmUpO1xuICpcbiAqIC8vIFRoZSBgbG9hZGAgbWV0aG9kIGxvYWRzIHRoZSBxdWV1ZSBvZiByZXNvdXJjZXMsIGFuZCBjYWxscyB0aGUgcGFzc2VkIGluIGNhbGxiYWNrIGNhbGxlZCBvbmNlIGFsbFxuICogLy8gcmVzb3VyY2VzIGhhdmUgbG9hZGVkLlxuICogbG9hZGVyLmxvYWQoKGxvYWRlciwgcmVzb3VyY2VzKSA9PiB7XG4gKiAgICAgLy8gcmVzb3VyY2VzIGlzIGFuIG9iamVjdCB3aGVyZSB0aGUga2V5IGlzIHRoZSBuYW1lIG9mIHRoZSByZXNvdXJjZSBsb2FkZWQgYW5kIHRoZSB2YWx1ZSBpcyB0aGUgcmVzb3VyY2Ugb2JqZWN0LlxuICogICAgIC8vIFRoZXkgaGF2ZSBhIGNvdXBsZSBkZWZhdWx0IHByb3BlcnRpZXM6XG4gKiAgICAgLy8gLSBgdXJsYDogVGhlIFVSTCB0aGF0IHRoZSByZXNvdXJjZSB3YXMgbG9hZGVkIGZyb21cbiAqICAgICAvLyAtIGBlcnJvcmA6IFRoZSBlcnJvciB0aGF0IGhhcHBlbmVkIHdoZW4gdHJ5aW5nIHRvIGxvYWQgKGlmIGFueSlcbiAqICAgICAvLyAtIGBkYXRhYDogVGhlIHJhdyBkYXRhIHRoYXQgd2FzIGxvYWRlZFxuICogICAgIC8vIGFsc28gbWF5IGNvbnRhaW4gb3RoZXIgcHJvcGVydGllcyBiYXNlZCBvbiB0aGUgbWlkZGxld2FyZSB0aGF0IHJ1bnMuXG4gKiAgICAgc3ByaXRlcy5idW5ueSA9IG5ldyBQSVhJLlRpbGluZ1Nwcml0ZShyZXNvdXJjZXMuYnVubnkudGV4dHVyZSk7XG4gKiAgICAgc3ByaXRlcy5zcGFjZXNoaXAgPSBuZXcgUElYSS5UaWxpbmdTcHJpdGUocmVzb3VyY2VzLnNwYWNlc2hpcC50ZXh0dXJlKTtcbiAqICAgICBzcHJpdGVzLnNjb3JlRm9udCA9IG5ldyBQSVhJLlRpbGluZ1Nwcml0ZShyZXNvdXJjZXMuc2NvcmVGb250LnRleHR1cmUpO1xuICogfSk7XG4gKlxuICogLy8gdGhyb3VnaG91dCB0aGUgcHJvY2VzcyBtdWx0aXBsZSBzaWduYWxzIGNhbiBiZSBkaXNwYXRjaGVkLlxuICogbG9hZGVyLm9uUHJvZ3Jlc3MuYWRkKCgpID0+IHt9KTsgLy8gY2FsbGVkIG9uY2UgcGVyIGxvYWRlZC9lcnJvcmVkIGZpbGVcbiAqIGxvYWRlci5vbkVycm9yLmFkZCgoKSA9PiB7fSk7IC8vIGNhbGxlZCBvbmNlIHBlciBlcnJvcmVkIGZpbGVcbiAqIGxvYWRlci5vbkxvYWQuYWRkKCgpID0+IHt9KTsgLy8gY2FsbGVkIG9uY2UgcGVyIGxvYWRlZCBmaWxlXG4gKiBsb2FkZXIub25Db21wbGV0ZS5hZGQoKCkgPT4ge30pOyAvLyBjYWxsZWQgb25jZSB3aGVuIHRoZSBxdWV1ZWQgcmVzb3VyY2VzIGFsbCBsb2FkLlxuICogYGBgXG4gKlxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vZW5nbGVyY2ovcmVzb3VyY2UtbG9hZGVyXG4gKlxuICogQGNsYXNzIExvYWRlclxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBwYXJhbSB7c3RyaW5nfSBbYmFzZVVybD0nJ10gLSBUaGUgYmFzZSB1cmwgZm9yIGFsbCByZXNvdXJjZXMgbG9hZGVkIGJ5IHRoaXMgbG9hZGVyLlxuICogQHBhcmFtIHtudW1iZXJ9IFtjb25jdXJyZW5jeT0xMF0gLSBUaGUgbnVtYmVyIG9mIHJlc291cmNlcyB0byBsb2FkIGNvbmN1cnJlbnRseS5cbiAqL1xuZXhwb3J0IGNsYXNzIExvYWRlciBleHRlbmRzIFJlc291cmNlTG9hZGVyXG57XG4gICAgLyoqXG4gICAgICogQ29sbGVjdGlvbiBvZiBhbGwgaW5zdGFsbGVkIGB1c2VgIG1pZGRsZXdhcmUgZm9yIExvYWRlci5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyIHtBcnJheTxQSVhJLklMb2FkZXJQbHVnaW4+fSBfcGx1Z2luc1xuICAgICAqIEBtZW1iZXJvZiBQSVhJLkxvYWRlclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgX3BsdWdpbnM6IEFycmF5PElMb2FkZXJQbHVnaW4+ID0gW107XG4gICAgcHJpdmF0ZSBzdGF0aWMgX3NoYXJlZDogTG9hZGVyO1xuICAgIHByaXZhdGUgX3Byb3RlY3RlZDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmw/OiBzdHJpbmcsIGNvbmN1cnJlbmN5PzogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgc3VwZXIoYmFzZVVybCwgY29uY3VycmVuY3kpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTG9hZGVyLl9wbHVnaW5zLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSBMb2FkZXIuX3BsdWdpbnNbaV07XG4gICAgICAgICAgICBjb25zdCB7IHByZSwgdXNlIH0gPSBwbHVnaW47XG5cbiAgICAgICAgICAgIGlmIChwcmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmUocHJlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHVzZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZSh1c2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRoaXMgbG9hZGVyIGNhbm5vdCBiZSBkZXN0cm95ZWQuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9wcm90ZWN0ZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95IHRoZSBsb2FkZXIsIHJlbW92ZXMgcmVmZXJlbmNlcy5cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5Mb2FkZXIjXG4gICAgICogQG1ldGhvZCBkZXN0cm95XG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5fcHJvdGVjdGVkKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHByZW1hZGUgaW5zdGFuY2Ugb2YgdGhlIGxvYWRlciB0aGF0IGNhbiBiZSB1c2VkIHRvIGxvYWQgcmVzb3VyY2VzLlxuICAgICAqIEBuYW1lIHNoYXJlZFxuICAgICAqIEB0eXBlIHtQSVhJLkxvYWRlcn1cbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlcm9mIFBJWEkuTG9hZGVyXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXQgc2hhcmVkKCk6IExvYWRlclxuICAgIHtcbiAgICAgICAgbGV0IHNoYXJlZCA9IExvYWRlci5fc2hhcmVkO1xuXG4gICAgICAgIGlmICghc2hhcmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBzaGFyZWQgPSBuZXcgTG9hZGVyKCk7XG4gICAgICAgICAgICBzaGFyZWQuX3Byb3RlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICBMb2FkZXIuX3NoYXJlZCA9IHNoYXJlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzaGFyZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIExvYWRlciBwbHVnaW4gZm9yIHRoZSBnbG9iYWwgc2hhcmVkIGxvYWRlciBhbmQgYWxsXG4gICAgICogbmV3IExvYWRlciBpbnN0YW5jZXMgY3JlYXRlZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWV0aG9kIHJlZ2lzdGVyUGx1Z2luXG4gICAgICogQG1lbWJlcm9mIFBJWEkuTG9hZGVyXG4gICAgICogQHBhcmFtIHtQSVhJLklMb2FkZXJQbHVnaW59IHBsdWdpbiAtIFRoZSBwbHVnaW4gdG8gYWRkXG4gICAgICogQHJldHVybiB7UElYSS5Mb2FkZXJ9IFJlZmVyZW5jZSB0byBQSVhJLkxvYWRlciBmb3IgY2hhaW5pbmdcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHJlZ2lzdGVyUGx1Z2luKHBsdWdpbjogSUxvYWRlclBsdWdpbik6IHR5cGVvZiBMb2FkZXJcbiAgICB7XG4gICAgICAgIExvYWRlci5fcGx1Z2lucy5wdXNoKHBsdWdpbik7XG5cbiAgICAgICAgaWYgKHBsdWdpbi5hZGQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHBsdWdpbi5hZGQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBMb2FkZXI7XG4gICAgfVxufVxuXG4vLyBwYXJzZSBhbnkgYmxvYiBpbnRvIG1vcmUgdXNhYmxlIG9iamVjdHMgKGUuZy4gSW1hZ2UpXG5Mb2FkZXIucmVnaXN0ZXJQbHVnaW4oeyB1c2U6IG1pZGRsZXdhcmUucGFyc2luZyB9KTtcblxuLy8gcGFyc2UgYW55IEltYWdlIG9iamVjdHMgaW50byB0ZXh0dXJlc1xuTG9hZGVyLnJlZ2lzdGVyUGx1Z2luKFRleHR1cmVMb2FkZXIpO1xuXG5leHBvcnQgaW50ZXJmYWNlIElMb2FkZXJQbHVnaW4ge1xuICAgIGFkZD8oKTogdm9pZDtcbiAgICBwcmU/KHJlc291cmNlOiBSZXNvdXJjZSwgbmV4dD86ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHZvaWQ7XG4gICAgdXNlPyhyZXNvdXJjZTogUmVzb3VyY2UsIG5leHQ/OiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpOiB2b2lkO1xufVxuXG4vKipcbiAqIFBsdWdpbiB0byBiZSBpbnN0YWxsZWQgZm9yIGhhbmRsaW5nIHNwZWNpZmljIExvYWRlciByZXNvdXJjZXMuXG4gKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEB0eXBlZGVmIHtvYmplY3R9IElMb2FkZXJQbHVnaW5cbiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb259IFthZGRdIC0gRnVuY3Rpb24gdG8gY2FsbCBpbW1lZGlhdGUgYWZ0ZXIgcmVnaXN0ZXJpbmcgcGx1Z2luLlxuICogQHByb3BlcnR5IHtQSVhJLkxvYWRlci5sb2FkZXJNaWRkbGV3YXJlfSBbcHJlXSAtIE1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gcnVuIGJlZm9yZSBsb2FkLCB0aGVcbiAqICAgICAgICAgICBhcmd1bWVudHMgZm9yIHRoaXMgYXJlIGAocmVzb3VyY2UsIG5leHQpYFxuICogQHByb3BlcnR5IHtQSVhJLkxvYWRlci5sb2FkZXJNaWRkbGV3YXJlfSBbdXNlXSAtIE1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gcnVuIGFmdGVyIGxvYWQsIHRoZVxuICogICAgICAgICAgIGFyZ3VtZW50cyBmb3IgdGhpcyBhcmUgYChyZXNvdXJjZSwgbmV4dClgXG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS5Mb2FkZXJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IElDYWxsYmFja0lEXG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS5Mb2FkZXJcbiAqIEB0eXBlZGVmIHtmdW5jdGlvbn0gSVNpZ25hbENhbGxiYWNrXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uXG4gKiBAcGFyYW0ge29iamVjdH0gW2NvbnRleHRdIC0gQ29udGV4dFxuICogQHJldHVybnMge0lDYWxsYmFja0lEfSAtIENhbGxiYWNrSURcbiAqL1xuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJLkxvYWRlclxuICogQHR5cGVkZWYge2Z1bmN0aW9ufSBJU2lnbmFsRGV0YWNoXG4gKiBAcGFyYW0ge0lDYWxsYmFja0lEfSBpZCAtIENhbGxiYWNrSUQgcmV0dXJuZWQgYnkgYGFkZGAvYG9uY2VgIG1ldGhvZHNcbiAqL1xuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJLkxvYWRlclxuICogQHR5cGVkZWYgSUxvYWRlclNpZ25hbFxuICogQHByb3BlcnR5IHtJU2lnbmFsQ2FsbGJhY2t9IGFkZCAtIFJlZ2lzdGVyIGNhbGxiYWNrXG4gKiBAcHJvcGVydHkge0lTaWduYWxDYWxsYmFja30gb25jZSAtIFJlZ2lzdGVyIG9uZXNob3QgY2FsbGJhY2tcbiAqIEBwcm9wZXJ0eSB7SVNpZ25hbERldGFjaH0gZGV0YWNoIC0gRGV0YWNoIHNwZWNpZmljIGNhbGxiYWNrIGJ5IElEXG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS5Mb2FkZXJcbiAqIEBjYWxsYmFjayBsb2FkZXJNaWRkbGV3YXJlXG4gKiBAcGFyYW0ge1BJWEkuTG9hZGVyUmVzb3VyY2V9IHJlc291cmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXh0XG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSS5Mb2FkZXIjXG4gKiBAZGVzY3JpcHRpb24gRGlzcGF0Y2hlZCB3aGVuIHRoZSBsb2FkZXIgYmVnaW5zIHRvIGxvYWRpbmcgcHJvY2Vzcy5cbiAqIEBtZW1iZXIge1BJWEkuTG9hZGVyLklMb2FkZXJTaWduYWx9IG9uU3RhcnRcbiAqL1xuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJLkxvYWRlciNcbiAqIEBkZXNjcmlwdGlvbiBEaXNwYXRjaGVkIG9uY2UgcGVyIGxvYWRlZCBvciBlcnJvcmVkIHJlc291cmNlLlxuICogQG1lbWJlciB7UElYSS5Mb2FkZXIuSUxvYWRlclNpZ25hbH0gb25Qcm9ncmVzc1xuICovXG5cbi8qKlxuICogQG1lbWJlcm9mIFBJWEkuTG9hZGVyI1xuICogQGRlc2NyaXB0aW9uIERpc3BhdGNoZWQgb25jZSBwZXIgZXJyb3JlZCByZXNvdXJjZS5cbiAqIEBtZW1iZXIge1BJWEkuTG9hZGVyLklMb2FkZXJTaWduYWx9IG9uRXJyb3JcbiAqL1xuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJLkxvYWRlciNcbiAqIEBkZXNjcmlwdGlvbiBEaXNwYXRjaGVkIG9uY2UgcGVyIGxvYWRlZCByZXNvdXJjZS5cbiAqIEBtZW1iZXIge1BJWEkuTG9hZGVyLklMb2FkZXJTaWduYWx9IG9uTG9hZFxuICovXG5cbi8qKlxuICogQG1lbWJlcm9mIFBJWEkuTG9hZGVyI1xuICogQGRlc2NyaXB0aW9uIERpc3BhdGNoZWQgd2hlbiBjb21wbGV0ZWx5IGxvYWRlZCBhbGwgcmVzb3VyY2VzLlxuICogQG1lbWJlciB7UElYSS5Mb2FkZXIuSUxvYWRlclNpZ25hbH0gb25Db21wbGV0ZVxuICovXG4iLCAiaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSAnLi9Mb2FkZXInO1xuXG5pbXBvcnQgdHlwZSB7IElBcHBsaWNhdGlvbk9wdGlvbnMgfSBmcm9tICdAcGl4aS9hcHAnO1xuLyoqXG4gKiBBcHBsaWNhdGlvbiBwbHVnaW4gZm9yIHN1cHBvcnRpbmcgbG9hZGVyIG9wdGlvbi4gSW5zdGFsbGluZyB0aGUgTG9hZGVyUGx1Z2luXG4gKiBpcyBub3QgbmVjZXNzYXJ5IGlmIHVzaW5nICoqcGl4aS5qcyoqIG9yICoqcGl4aS5qcy1sZWdhY3kqKi5cbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQge0FwcExvYWRlclBsdWdpbn0gZnJvbSAnQHBpeGkvbG9hZGVycyc7XG4gKiBpbXBvcnQge0FwcGxpY2F0aW9ufSBmcm9tICdAcGl4aS9hcHAnO1xuICogQXBwbGljYXRpb24ucmVnaXN0ZXJQbHVnaW4oQXBwTG9hZGVyUGx1Z2luKTtcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEFwcExvYWRlclBsdWdpblxue1xuICAgIHB1YmxpYyBzdGF0aWMgbG9hZGVyOiBMb2FkZXI7XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIG9uIGFwcGxpY2F0aW9uIGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN0YXRpYyBpbml0KG9wdGlvbnM/OiBJQXBwbGljYXRpb25PcHRpb25zKTogdm9pZFxuICAgIHtcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgc2hhcmVkTG9hZGVyOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWRlciBpbnN0YW5jZSB0byBoZWxwIHdpdGggYXNzZXQgbG9hZGluZy5cbiAgICAgICAgICogQG5hbWUgUElYSS5BcHBsaWNhdGlvbiNsb2FkZXJcbiAgICAgICAgICogQHR5cGUge1BJWEkuTG9hZGVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubG9hZGVyID0gb3B0aW9ucy5zaGFyZWRMb2FkZXIgPyBMb2FkZXIuc2hhcmVkIDogbmV3IExvYWRlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIGFwcGxpY2F0aW9uIGRlc3Ryb3llZFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgc3RhdGljIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMubG9hZGVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmxvYWRlci5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmxvYWRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgQkxFTkRfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBoZXgycmdiIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5pbXBvcnQgdHlwZSB7IEJhc2VUZXh0dXJlLCBSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBQYXJ0aWNsZUJ1ZmZlciB9IGZyb20gJy4vUGFydGljbGVCdWZmZXInO1xuaW1wb3J0IHR5cGUgeyBJRGVzdHJveU9wdGlvbnMgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcblxuZXhwb3J0IGludGVyZmFjZSBJUGFydGljbGVQcm9wZXJ0aWVzIHtcbiAgICB2ZXJ0aWNlcz86IGJvb2xlYW47XG4gICAgcG9zaXRpb24/OiBib29sZWFuO1xuICAgIHJvdGF0aW9uPzogYm9vbGVhbjtcbiAgICB1dnM/OiBib29sZWFuO1xuICAgIHRpbnQ/OiBib29sZWFuO1xuICAgIGFscGhhPzogYm9vbGVhbjtcbiAgICBzY2FsZT86IGJvb2xlYW47XG59XG5cbi8qKlxuICogVGhlIFBhcnRpY2xlQ29udGFpbmVyIGNsYXNzIGlzIGEgcmVhbGx5IGZhc3QgdmVyc2lvbiBvZiB0aGUgQ29udGFpbmVyIGJ1aWx0IHNvbGVseSBmb3Igc3BlZWQsXG4gKiBzbyB1c2Ugd2hlbiB5b3UgbmVlZCBhIGxvdCBvZiBzcHJpdGVzIG9yIHBhcnRpY2xlcy5cbiAqXG4gKiBUaGUgdHJhZGVvZmYgb2YgdGhlIFBhcnRpY2xlQ29udGFpbmVyIGlzIHRoYXQgbW9zdCBhZHZhbmNlZCBmdW5jdGlvbmFsaXR5IHdpbGwgbm90IHdvcmsuXG4gKiBQYXJ0aWNsZUNvbnRhaW5lciBpbXBsZW1lbnRzIHRoZSBiYXNpYyBvYmplY3QgdHJhbnNmb3JtIChwb3NpdGlvbiwgc2NhbGUsIHJvdGF0aW9uKVxuICogYW5kIHNvbWUgYWR2YW5jZWQgZnVuY3Rpb25hbGl0eSBsaWtlIHRpbnQgKGFzIG9mIHY0LjUuNikuXG4gKlxuICogT3RoZXIgbW9yZSBhZHZhbmNlZCBmdW5jdGlvbmFsaXR5IGxpa2UgbWFza2luZywgY2hpbGRyZW4sIGZpbHRlcnMsIGV0YyB3aWxsIG5vdCB3b3JrIG9uIHNwcml0ZXMgaW4gdGhpcyBiYXRjaC5cbiAqXG4gKiBJdCdzIGV4dHJlbWVseSBlYXN5IHRvIHVzZTpcbiAqIGBgYGpzXG4gKiBsZXQgY29udGFpbmVyID0gbmV3IFBhcnRpY2xlQ29udGFpbmVyKCk7XG4gKlxuICogZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7ICsraSlcbiAqIHtcbiAqICAgICBsZXQgc3ByaXRlID0gUElYSS5TcHJpdGUuZnJvbShcIm15SW1hZ2UucG5nXCIpO1xuICogICAgIGNvbnRhaW5lci5hZGRDaGlsZChzcHJpdGUpO1xuICogfVxuICogYGBgXG4gKlxuICogQW5kIGhlcmUgeW91IGhhdmUgYSBodW5kcmVkIHNwcml0ZXMgdGhhdCB3aWxsIGJlIHJlbmRlcmVkIGF0IHRoZSBzcGVlZCBvZiBsaWdodC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQ29udGFpbmVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgUGFydGljbGVDb250YWluZXIgZXh0ZW5kcyBDb250YWluZXJcbntcbiAgICBwdWJsaWMgcmVhZG9ubHkgYmxlbmRNb2RlOiBCTEVORF9NT0RFUztcbiAgICBwdWJsaWMgYXV0b1Jlc2l6ZTogYm9vbGVhbjtcbiAgICBwdWJsaWMgcm91bmRQaXhlbHM6IGJvb2xlYW47XG4gICAgcHVibGljIGJhc2VUZXh0dXJlOiBCYXNlVGV4dHVyZTtcbiAgICBwdWJsaWMgdGludFJnYjogRmxvYXQzMkFycmF5O1xuXG4gICAgX21heFNpemU6IG51bWJlcjtcbiAgICBfYnVmZmVyczogUGFydGljbGVCdWZmZXJbXTtcbiAgICBfYmF0Y2hTaXplOiBudW1iZXI7XG4gICAgX3Byb3BlcnRpZXM6IGJvb2xlYW5bXTtcbiAgICBfYnVmZmVyVXBkYXRlSURzOiBudW1iZXJbXTtcbiAgICBfdXBkYXRlSUQ6IG51bWJlcjtcbiAgICBwcml2YXRlIF90aW50OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW21heFNpemU9MTUwMF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgcGFydGljbGVzIHRoYXQgY2FuIGJlIHJlbmRlcmVkIGJ5IHRoZSBjb250YWluZXIuXG4gICAgICogIEFmZmVjdHMgc2l6ZSBvZiBhbGxvY2F0ZWQgYnVmZmVycy5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3Byb3BlcnRpZXNdIC0gVGhlIHByb3BlcnRpZXMgb2YgY2hpbGRyZW4gdGhhdCBzaG91bGQgYmUgdXBsb2FkZWQgdG8gdGhlIGdwdSBhbmQgYXBwbGllZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtwcm9wZXJ0aWVzLnZlcnRpY2VzPWZhbHNlXSAtIFdoZW4gdHJ1ZSwgdmVydGljZXMgYmUgdXBsb2FkZWQgYW5kIGFwcGxpZWQuXG4gICAgICogICAgICAgICAgICAgICAgICBpZiBzcHJpdGUncyBgIHNjYWxlL2FuY2hvci90cmltL2ZyYW1lL29yaWdgIGlzIGR5bmFtaWMsIHBsZWFzZSBzZXQgYHRydWVgLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BlcnRpZXMucG9zaXRpb249dHJ1ZV0gLSBXaGVuIHRydWUsIHBvc2l0aW9uIGJlIHVwbG9hZGVkIGFuZCBhcHBsaWVkLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Byb3BlcnRpZXMucm90YXRpb249ZmFsc2VdIC0gV2hlbiB0cnVlLCByb3RhdGlvbiBiZSB1cGxvYWRlZCBhbmQgYXBwbGllZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtwcm9wZXJ0aWVzLnV2cz1mYWxzZV0gLSBXaGVuIHRydWUsIHV2cyBiZSB1cGxvYWRlZCBhbmQgYXBwbGllZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtwcm9wZXJ0aWVzLnRpbnQ9ZmFsc2VdIC0gV2hlbiB0cnVlLCBhbHBoYSBhbmQgdGludCBiZSB1cGxvYWRlZCBhbmQgYXBwbGllZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2JhdGNoU2l6ZT0xNjM4NF0gLSBOdW1iZXIgb2YgcGFydGljbGVzIHBlciBiYXRjaC4gSWYgbGVzcyB0aGFuIG1heFNpemUsIGl0IHVzZXMgbWF4U2l6ZSBpbnN0ZWFkLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2F1dG9SZXNpemU9ZmFsc2VdIC0gSWYgdHJ1ZSwgY29udGFpbmVyIGFsbG9jYXRlcyBtb3JlIGJhdGNoZXMgaW4gY2FzZVxuICAgICAqICB0aGVyZSBhcmUgbW9yZSB0aGFuIGBtYXhTaXplYCBwYXJ0aWNsZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IobWF4U2l6ZSA9IDE1MDAsIHByb3BlcnRpZXM6IElQYXJ0aWNsZVByb3BlcnRpZXMsIGJhdGNoU2l6ZSA9IDE2Mzg0LCBhdXRvUmVzaXplID0gZmFsc2UpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8vIE1ha2luZyBzdXJlIHRoZSBiYXRjaCBzaXplIGlzIHZhbGlkXG4gICAgICAgIC8vIDY1NTM1IGlzIG1heCB2ZXJ0ZXggaW5kZXggaW4gdGhlIGluZGV4IGJ1ZmZlciAoc2VlIFBhcnRpY2xlUmVuZGVyZXIpXG4gICAgICAgIC8vIHNvIG1heCBudW1iZXIgb2YgcGFydGljbGVzIGlzIDY1NTM2IC8gNCA9IDE2Mzg0XG4gICAgICAgIGNvbnN0IG1heEJhdGNoU2l6ZSA9IDE2Mzg0O1xuXG4gICAgICAgIGlmIChiYXRjaFNpemUgPiBtYXhCYXRjaFNpemUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJhdGNoU2l6ZSA9IG1heEJhdGNoU2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgcHJvcGVydGllcyB0byBiZSBkeW5hbWljICh0cnVlKSAvIHN0YXRpYyAoZmFsc2UpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW5bXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Byb3BlcnRpZXMgPSBbZmFsc2UsIHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9tYXhTaXplID0gbWF4U2l6ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmF0Y2hTaXplID0gYmF0Y2hTaXplO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtBcnJheTxQSVhJLkJ1ZmZlcj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9idWZmZXJzID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogZm9yIGV2ZXJ5IGJhdGNoIHN0b3JlcyBfdXBkYXRlSUQgY29ycmVzcG9uZGluZyB0byB0aGUgbGFzdCBjaGFuZ2UgaW4gdGhhdCBiYXRjaFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2J1ZmZlclVwZGF0ZUlEcyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB3aGVuIGNoaWxkIGluc2VydGVkLCByZW1vdmVkIG9yIGNoYW5nZXMgcG9zaXRpb24gdGhpcyBudW1iZXIgZ29lcyB1cFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3VwZGF0ZUlEID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW50ZXJhY3RpdmVDaGlsZHJlbiA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYmxlbmQgbW9kZSB0byBiZSBhcHBsaWVkIHRvIHRoZSBzcHJpdGUuIEFwcGx5IGEgdmFsdWUgb2YgYFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMYFxuICAgICAgICAgKiB0byByZXNldCB0aGUgYmxlbmQgbW9kZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLkJMRU5EX01PREVTLk5PUk1BTFxuICAgICAgICAgKiBAc2VlIFBJWEkuQkxFTkRfTU9ERVNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYmxlbmRNb2RlID0gQkxFTkRfTU9ERVMuTk9STUFMO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0cnVlLCBjb250YWluZXIgYWxsb2NhdGVzIG1vcmUgYmF0Y2hlcyBpbiBjYXNlIHRoZXJlIGFyZSBtb3JlIHRoYW4gYG1heFNpemVgIHBhcnRpY2xlcy5cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYXV0b1Jlc2l6ZSA9IGF1dG9SZXNpemU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRydWUgUGl4aUpTIHdpbGwgTWF0aC5mbG9vcigpIHgveSB2YWx1ZXMgd2hlbiByZW5kZXJpbmcsIHN0b3BwaW5nIHBpeGVsIGludGVycG9sYXRpb24uXG4gICAgICAgICAqIEFkdmFudGFnZXMgY2FuIGluY2x1ZGUgc2hhcnBlciBpbWFnZSBxdWFsaXR5IChsaWtlIHRleHQpIGFuZCBmYXN0ZXIgcmVuZGVyaW5nIG9uIGNhbnZhcy5cbiAgICAgICAgICogVGhlIG1haW4gZGlzYWR2YW50YWdlIGlzIG1vdmVtZW50IG9mIG9iamVjdHMgbWF5IGFwcGVhciBsZXNzIHNtb290aC5cbiAgICAgICAgICogRGVmYXVsdCB0byB0cnVlIGhlcmUgYXMgcGVyZm9ybWFuY2UgaXMgdXN1YWxseSB0aGUgcHJpb3JpdHkgZm9yIHBhcnRpY2xlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yb3VuZFBpeGVscyA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0ZXh0dXJlIHVzZWQgdG8gcmVuZGVyIHRoZSBjaGlsZHJlbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQmFzZVRleHR1cmV9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhc2VUZXh0dXJlID0gbnVsbDtcblxuICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMocHJvcGVydGllcyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW50IGFwcGxpZWQgdG8gdGhlIGNvbnRhaW5lci5cbiAgICAgICAgICogVGhpcyBpcyBhIGhleCB2YWx1ZS4gQSB2YWx1ZSBvZiAweEZGRkZGRiB3aWxsIHJlbW92ZSBhbnkgdGludCBlZmZlY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMHhGRkZGRkZcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3RpbnQgPSAwO1xuICAgICAgICB0aGlzLnRpbnRSZ2IgPSBuZXcgRmxvYXQzMkFycmF5KDQpO1xuICAgICAgICB0aGlzLnRpbnQgPSAweEZGRkZGRjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwcml2YXRlIHByb3BlcnRpZXMgYXJyYXkgdG8gZHluYW1pYyAvIHN0YXRpYyBiYXNlZCBvbiB0aGUgcGFzc2VkIHByb3BlcnRpZXMgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gcHJvcGVydGllcyAtIFRoZSBwcm9wZXJ0aWVzIHRvIGJlIHVwbG9hZGVkXG4gICAgICovXG4gICAgcHVibGljIHNldFByb3BlcnRpZXMocHJvcGVydGllczogSVBhcnRpY2xlUHJvcGVydGllcyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChwcm9wZXJ0aWVzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9wcm9wZXJ0aWVzWzBdID0gJ3ZlcnRpY2VzJyBpbiBwcm9wZXJ0aWVzIHx8ICdzY2FsZScgaW4gcHJvcGVydGllc1xuICAgICAgICAgICAgICAgID8gISFwcm9wZXJ0aWVzLnZlcnRpY2VzIHx8ICEhcHJvcGVydGllcy5zY2FsZSA6IHRoaXMuX3Byb3BlcnRpZXNbMF07XG4gICAgICAgICAgICB0aGlzLl9wcm9wZXJ0aWVzWzFdID0gJ3Bvc2l0aW9uJyBpbiBwcm9wZXJ0aWVzID8gISFwcm9wZXJ0aWVzLnBvc2l0aW9uIDogdGhpcy5fcHJvcGVydGllc1sxXTtcbiAgICAgICAgICAgIHRoaXMuX3Byb3BlcnRpZXNbMl0gPSAncm90YXRpb24nIGluIHByb3BlcnRpZXMgPyAhIXByb3BlcnRpZXMucm90YXRpb24gOiB0aGlzLl9wcm9wZXJ0aWVzWzJdO1xuICAgICAgICAgICAgdGhpcy5fcHJvcGVydGllc1szXSA9ICd1dnMnIGluIHByb3BlcnRpZXMgPyAhIXByb3BlcnRpZXMudXZzIDogdGhpcy5fcHJvcGVydGllc1szXTtcbiAgICAgICAgICAgIHRoaXMuX3Byb3BlcnRpZXNbNF0gPSAndGludCcgaW4gcHJvcGVydGllcyB8fCAnYWxwaGEnIGluIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICA/ICEhcHJvcGVydGllcy50aW50IHx8ICEhcHJvcGVydGllcy5hbHBoYSA6IHRoaXMuX3Byb3BlcnRpZXNbNF07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBvYmplY3QgdHJhbnNmb3JtIGZvciByZW5kZXJpbmdcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdXBkYXRlVHJhbnNmb3JtKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIFRPRE8gZG9uJ3QgbmVlZCB0byFcbiAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHRpbnQgYXBwbGllZCB0byB0aGUgY29udGFpbmVyLiBUaGlzIGlzIGEgaGV4IHZhbHVlLlxuICAgICAqIEEgdmFsdWUgb2YgMHhGRkZGRkYgd2lsbCByZW1vdmUgYW55IHRpbnQgZWZmZWN0LlxuICAgICAqKiBJTVBPUlRBTlQ6IFRoaXMgaXMgYSBXZWJHTCBvbmx5IGZlYXR1cmUgYW5kIHdpbGwgYmUgaWdub3JlZCBieSB0aGUgY2FudmFzIHJlbmRlcmVyLlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAweEZGRkZGRlxuICAgICAqL1xuICAgIGdldCB0aW50KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbnQ7XG4gICAgfVxuXG4gICAgc2V0IHRpbnQodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX3RpbnQgPSB2YWx1ZTtcbiAgICAgICAgaGV4MnJnYih2YWx1ZSwgdGhpcy50aW50UmdiKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIHRoZSBjb250YWluZXIgdXNpbmcgdGhlIFdlYkdMIHJlbmRlcmVyXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgd2ViZ2wgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBwdWJsaWMgcmVuZGVyKHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy52aXNpYmxlIHx8IHRoaXMud29ybGRBbHBoYSA8PSAwIHx8ICF0aGlzLmNoaWxkcmVuLmxlbmd0aCB8fCAhdGhpcy5yZW5kZXJhYmxlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuYmFzZVRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZVRleHR1cmUgPSAodGhpcy5jaGlsZHJlblswXSBhcyBhbnkpLl90ZXh0dXJlLmJhc2VUZXh0dXJlO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmJhc2VUZXh0dXJlLnZhbGlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFzZVRleHR1cmUub25jZSgndXBkYXRlJywgKCkgPT4gdGhpcy5vbkNoaWxkcmVuQ2hhbmdlKDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlbmRlcmVyLmJhdGNoLnNldE9iamVjdFJlbmRlcmVyKHJlbmRlcmVyLnBsdWdpbnMucGFydGljbGUpO1xuICAgICAgICByZW5kZXJlci5wbHVnaW5zLnBhcnRpY2xlLnJlbmRlcih0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGZsYWcgdGhhdCBzdGF0aWMgZGF0YSBzaG91bGQgYmUgdXBkYXRlZCB0byB0cnVlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzbWFsbGVzdENoaWxkSW5kZXggLSBUaGUgc21hbGxlc3QgY2hpbGQgaW5kZXhcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgb25DaGlsZHJlbkNoYW5nZShzbWFsbGVzdENoaWxkSW5kZXg6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGJ1ZmZlckluZGV4ID0gTWF0aC5mbG9vcihzbWFsbGVzdENoaWxkSW5kZXggLyB0aGlzLl9iYXRjaFNpemUpO1xuXG4gICAgICAgIHdoaWxlICh0aGlzLl9idWZmZXJVcGRhdGVJRHMubGVuZ3RoIDwgYnVmZmVySW5kZXgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2J1ZmZlclVwZGF0ZUlEcy5wdXNoKDApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2J1ZmZlclVwZGF0ZUlEc1tidWZmZXJJbmRleF0gPSArK3RoaXMuX3VwZGF0ZUlEO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwb3NlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9idWZmZXJzKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2J1ZmZlcnMubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYnVmZmVyc1tpXS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2J1ZmZlcnMgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveXMgdGhlIGNvbnRhaW5lclxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R8Ym9vbGVhbn0gW29wdGlvbnNdIC0gT3B0aW9ucyBwYXJhbWV0ZXIuIEEgYm9vbGVhbiB3aWxsIGFjdCBhcyBpZiBhbGwgb3B0aW9uc1xuICAgICAqICBoYXZlIGJlZW4gc2V0IHRvIHRoYXQgdmFsdWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmNoaWxkcmVuPWZhbHNlXSAtIGlmIHNldCB0byB0cnVlLCBhbGwgdGhlIGNoaWxkcmVuIHdpbGwgaGF2ZSB0aGVpclxuICAgICAqICBkZXN0cm95IG1ldGhvZCBjYWxsZWQgYXMgd2VsbC4gJ29wdGlvbnMnIHdpbGwgYmUgcGFzc2VkIG9uIHRvIHRob3NlIGNhbGxzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudGV4dHVyZT1mYWxzZV0gLSBPbmx5IHVzZWQgZm9yIGNoaWxkIFNwcml0ZXMgaWYgb3B0aW9ucy5jaGlsZHJlbiBpcyBzZXQgdG8gdHJ1ZVxuICAgICAqICBTaG91bGQgaXQgZGVzdHJveSB0aGUgdGV4dHVyZSBvZiB0aGUgY2hpbGQgc3ByaXRlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5iYXNlVGV4dHVyZT1mYWxzZV0gLSBPbmx5IHVzZWQgZm9yIGNoaWxkIFNwcml0ZXMgaWYgb3B0aW9ucy5jaGlsZHJlbiBpcyBzZXQgdG8gdHJ1ZVxuICAgICAqICBTaG91bGQgaXQgZGVzdHJveSB0aGUgYmFzZSB0ZXh0dXJlIG9mIHRoZSBjaGlsZCBzcHJpdGVcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveShvcHRpb25zOiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3kob3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5kaXNwb3NlKCk7XG5cbiAgICAgICAgdGhpcy5fcHJvcGVydGllcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2J1ZmZlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9idWZmZXJVcGRhdGVJRHMgPSBudWxsO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBjcmVhdGVJbmRpY2VzRm9yUXVhZHMgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgeyBHZW9tZXRyeSwgQnVmZmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBUWVBFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbmltcG9ydCB0eXBlIHsgRGlzcGxheU9iamVjdCB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBJUGFydGljbGVSZW5kZXJlclByb3BlcnR5IH0gZnJvbSAnLi9QYXJ0aWNsZVJlbmRlcmVyJztcblxuLyoqXG4gKiBAYXV0aG9yIE1hdCBHcm92ZXNcbiAqXG4gKiBCaWcgdGhhbmtzIHRvIHRoZSB2ZXJ5IGNsZXZlciBNYXR0IERlc0xhdXJpZXJzIDxtYXR0ZGVzbD4gaHR0cHM6Ly9naXRodWIuY29tL21hdHRkZXNsL1xuICogZm9yIGNyZWF0aW5nIHRoZSBvcmlnaW5hbCBQaXhpSlMgdmVyc2lvbiFcbiAqIEFsc28gYSB0aGFua3MgdG8gaHR0cHM6Ly9naXRodWIuY29tL2JjaGV2YWxpZXIgZm9yIHR3ZWFraW5nIHRoZSB0aW50IGFuZCBhbHBoYSBzbyB0aGF0XG4gKiB0aGV5IG5vdyBzaGFyZSA0IGJ5dGVzIG9uIHRoZSB2ZXJ0ZXggYnVmZmVyXG4gKlxuICogSGVhdmlseSBpbnNwaXJlZCBieSBMaWJHRFgncyBQYXJ0aWNsZUJ1ZmZlcjpcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9saWJnZHgvbGliZ2R4L2Jsb2IvbWFzdGVyL2dkeC9zcmMvY29tL2JhZGxvZ2ljL2dkeC9ncmFwaGljcy9nMmQvUGFydGljbGVCdWZmZXIuamF2YVxuICovXG5cbi8qKlxuICogVGhlIHBhcnRpY2xlIGJ1ZmZlciBtYW5hZ2VzIHRoZSBzdGF0aWMgYW5kIGR5bmFtaWMgYnVmZmVycyBmb3IgYSBwYXJ0aWNsZSBjb250YWluZXIuXG4gKlxuICogQGNsYXNzXG4gKiBAcHJpdmF0ZVxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcnRpY2xlQnVmZmVyXG57XG4gICAgcHVibGljIGdlb21ldHJ5OiBHZW9tZXRyeTtcbiAgICBwdWJsaWMgc3RhdGljU3RyaWRlOiBudW1iZXI7XG4gICAgcHVibGljIHN0YXRpY0J1ZmZlcjogQnVmZmVyO1xuICAgIHB1YmxpYyBzdGF0aWNEYXRhOiBGbG9hdDMyQXJyYXk7XG4gICAgcHVibGljIHN0YXRpY0RhdGFVaW50MzI6IFVpbnQzMkFycmF5O1xuICAgIHB1YmxpYyBkeW5hbWljU3RyaWRlOiBudW1iZXI7XG4gICAgcHVibGljIGR5bmFtaWNCdWZmZXI6IEJ1ZmZlcjtcbiAgICBwdWJsaWMgZHluYW1pY0RhdGE6IEZsb2F0MzJBcnJheTtcbiAgICBwdWJsaWMgZHluYW1pY0RhdGFVaW50MzI6IFVpbnQzMkFycmF5O1xuICAgIHB1YmxpYyBfdXBkYXRlSUQ6IG51bWJlcjtcblxuICAgIGluZGV4QnVmZmVyOiBCdWZmZXI7XG4gICAgcHJpdmF0ZSBzaXplOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBkeW5hbWljUHJvcGVydGllczogSVBhcnRpY2xlUmVuZGVyZXJQcm9wZXJ0eVtdO1xuICAgIHByaXZhdGUgc3RhdGljUHJvcGVydGllczogSVBhcnRpY2xlUmVuZGVyZXJQcm9wZXJ0eVtdO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gcHJvcGVydGllcyAtIFRoZSBwcm9wZXJ0aWVzIHRvIHVwbG9hZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW5bXX0gZHluYW1pY1Byb3BlcnR5RmxhZ3MgLSBGbGFncyBmb3Igd2hpY2ggcHJvcGVydGllcyBhcmUgZHluYW1pYy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2l6ZSAtIFRoZSBzaXplIG9mIHRoZSBiYXRjaC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihwcm9wZXJ0aWVzOiBJUGFydGljbGVSZW5kZXJlclByb3BlcnR5W10sIGR5bmFtaWNQcm9wZXJ0eUZsYWdzOiBib29sZWFuW10sIHNpemU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgR2VvbWV0cnkoKTtcblxuICAgICAgICB0aGlzLmluZGV4QnVmZmVyID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBwYXJ0aWNsZXMgdGhlIGJ1ZmZlciBjYW4gaG9sZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGhlIHByb3BlcnRpZXMgdGhhdCBhcmUgZHluYW1pYy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0W119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbGlzdCBvZiB0aGUgcHJvcGVydGllcyB0aGF0IGFyZSBzdGF0aWMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdFtdfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGF0aWNQcm9wZXJ0aWVzID0gW107XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgcHJvcGVydHkgPSBwcm9wZXJ0aWVzW2ldO1xuXG4gICAgICAgICAgICAvLyBNYWtlIGNvcHkgb2YgcHJvcGVydGllcyBvYmplY3Qgc28gdGhhdCB3aGVuIHdlIGVkaXQgdGhlIG9mZnNldCBpdCBkb2Vzbid0XG4gICAgICAgICAgICAvLyBjaGFuZ2UgYWxsIG90aGVyIGluc3RhbmNlcyBvZiB0aGUgb2JqZWN0IGxpdGVyYWxcbiAgICAgICAgICAgIHByb3BlcnR5ID0ge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6IHByb3BlcnR5LmF0dHJpYnV0ZU5hbWUsXG4gICAgICAgICAgICAgICAgc2l6ZTogcHJvcGVydHkuc2l6ZSxcbiAgICAgICAgICAgICAgICB1cGxvYWRGdW5jdGlvbjogcHJvcGVydHkudXBsb2FkRnVuY3Rpb24sXG4gICAgICAgICAgICAgICAgdHlwZTogcHJvcGVydHkudHlwZSB8fCBUWVBFUy5GTE9BVCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IHByb3BlcnR5Lm9mZnNldCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChkeW5hbWljUHJvcGVydHlGbGFnc1tpXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzLnB1c2gocHJvcGVydHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGljUHJvcGVydGllcy5wdXNoKHByb3BlcnR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhdGljU3RyaWRlID0gMDtcbiAgICAgICAgdGhpcy5zdGF0aWNCdWZmZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnN0YXRpY0RhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLnN0YXRpY0RhdGFVaW50MzIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuZHluYW1pY1N0cmlkZSA9IDA7XG4gICAgICAgIHRoaXMuZHluYW1pY0J1ZmZlciA9IG51bGw7XG4gICAgICAgIHRoaXMuZHluYW1pY0RhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLmR5bmFtaWNEYXRhVWludDMyID0gbnVsbDtcblxuICAgICAgICB0aGlzLl91cGRhdGVJRCA9IDA7XG5cbiAgICAgICAgdGhpcy5pbml0QnVmZmVycygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdXAgdGhlIHJlbmRlcmVyIGNvbnRleHQgYW5kIG5lY2Vzc2FyeSBidWZmZXJzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGluaXRCdWZmZXJzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTtcblxuICAgICAgICBsZXQgZHluYW1pY09mZnNldCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhvbGRzIHRoZSBpbmRpY2VzIG9mIHRoZSBnZW9tZXRyeSAocXVhZHMpIHRvIGRyYXdcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7VWludDE2QXJyYXl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmluZGV4QnVmZmVyID0gbmV3IEJ1ZmZlcihjcmVhdGVJbmRpY2VzRm9yUXVhZHModGhpcy5zaXplKSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIGdlb21ldHJ5LmFkZEluZGV4KHRoaXMuaW5kZXhCdWZmZXIpO1xuXG4gICAgICAgIHRoaXMuZHluYW1pY1N0cmlkZSA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHRoaXMuZHluYW1pY1Byb3BlcnRpZXNbaV07XG5cbiAgICAgICAgICAgIHByb3BlcnR5Lm9mZnNldCA9IGR5bmFtaWNPZmZzZXQ7XG4gICAgICAgICAgICBkeW5hbWljT2Zmc2V0ICs9IHByb3BlcnR5LnNpemU7XG4gICAgICAgICAgICB0aGlzLmR5bmFtaWNTdHJpZGUgKz0gcHJvcGVydHkuc2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGR5bkJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLnNpemUgKiB0aGlzLmR5bmFtaWNTdHJpZGUgKiA0ICogNCk7XG5cbiAgICAgICAgdGhpcy5keW5hbWljRGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoZHluQnVmZmVyKTtcbiAgICAgICAgdGhpcy5keW5hbWljRGF0YVVpbnQzMiA9IG5ldyBVaW50MzJBcnJheShkeW5CdWZmZXIpO1xuICAgICAgICB0aGlzLmR5bmFtaWNCdWZmZXIgPSBuZXcgQnVmZmVyKHRoaXMuZHluYW1pY0RhdGEsIGZhbHNlLCBmYWxzZSk7XG5cbiAgICAgICAgLy8gc3RhdGljIC8vXG4gICAgICAgIGxldCBzdGF0aWNPZmZzZXQgPSAwO1xuXG4gICAgICAgIHRoaXMuc3RhdGljU3RyaWRlID0gMDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhdGljUHJvcGVydGllcy5sZW5ndGg7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSB0aGlzLnN0YXRpY1Byb3BlcnRpZXNbaV07XG5cbiAgICAgICAgICAgIHByb3BlcnR5Lm9mZnNldCA9IHN0YXRpY09mZnNldDtcbiAgICAgICAgICAgIHN0YXRpY09mZnNldCArPSBwcm9wZXJ0eS5zaXplO1xuICAgICAgICAgICAgdGhpcy5zdGF0aWNTdHJpZGUgKz0gcHJvcGVydHkuc2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN0YXRCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodGhpcy5zaXplICogdGhpcy5zdGF0aWNTdHJpZGUgKiA0ICogNCk7XG5cbiAgICAgICAgdGhpcy5zdGF0aWNEYXRhID0gbmV3IEZsb2F0MzJBcnJheShzdGF0QnVmZmVyKTtcbiAgICAgICAgdGhpcy5zdGF0aWNEYXRhVWludDMyID0gbmV3IFVpbnQzMkFycmF5KHN0YXRCdWZmZXIpO1xuICAgICAgICB0aGlzLnN0YXRpY0J1ZmZlciA9IG5ldyBCdWZmZXIodGhpcy5zdGF0aWNEYXRhLCB0cnVlLCBmYWxzZSk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHRoaXMuZHluYW1pY1Byb3BlcnRpZXNbaV07XG5cbiAgICAgICAgICAgIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS5hdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0J1ZmZlcixcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIHByb3BlcnR5LnR5cGUgPT09IFRZUEVTLlVOU0lHTkVEX0JZVEUsXG4gICAgICAgICAgICAgICAgcHJvcGVydHkudHlwZSxcbiAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNTdHJpZGUgKiA0LFxuICAgICAgICAgICAgICAgIHByb3BlcnR5Lm9mZnNldCAqIDRcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhdGljUHJvcGVydGllcy5sZW5ndGg7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSB0aGlzLnN0YXRpY1Byb3BlcnRpZXNbaV07XG5cbiAgICAgICAgICAgIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS5hdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGljQnVmZmVyLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgcHJvcGVydHkudHlwZSA9PT0gVFlQRVMuVU5TSUdORURfQllURSxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS50eXBlLFxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGljU3RyaWRlICogNCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eS5vZmZzZXQgKiA0XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBsb2FkcyB0aGUgZHluYW1pYyBwcm9wZXJ0aWVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdFtdfSBjaGlsZHJlbiAtIFRoZSBjaGlsZHJlbiB0byB1cGxvYWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0SW5kZXggLSBUaGUgaW5kZXggdG8gc3RhcnQgYXQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIFRoZSBudW1iZXIgdG8gdXBsb2FkLlxuICAgICAqL1xuICAgIHVwbG9hZER5bmFtaWMoY2hpbGRyZW46IERpc3BsYXlPYmplY3RbXSwgc3RhcnRJbmRleDogbnVtYmVyLCBhbW91bnQ6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5keW5hbWljUHJvcGVydGllcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzW2ldO1xuXG4gICAgICAgICAgICBwcm9wZXJ0eS51cGxvYWRGdW5jdGlvbihjaGlsZHJlbiwgc3RhcnRJbmRleCwgYW1vdW50LFxuICAgICAgICAgICAgICAgIHByb3BlcnR5LnR5cGUgPT09IFRZUEVTLlVOU0lHTkVEX0JZVEUgPyB0aGlzLmR5bmFtaWNEYXRhVWludDMyIDogdGhpcy5keW5hbWljRGF0YSxcbiAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNTdHJpZGUsIHByb3BlcnR5Lm9mZnNldCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmR5bmFtaWNCdWZmZXIuX3VwZGF0ZUlEKys7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBsb2FkcyB0aGUgc3RhdGljIHByb3BlcnRpZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0W119IGNoaWxkcmVuIC0gVGhlIGNoaWxkcmVuIHRvIHVwbG9hZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRJbmRleCAtIFRoZSBpbmRleCB0byBzdGFydCBhdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IC0gVGhlIG51bWJlciB0byB1cGxvYWQuXG4gICAgICovXG4gICAgdXBsb2FkU3RhdGljKGNoaWxkcmVuOiBEaXNwbGF5T2JqZWN0W10sIHN0YXJ0SW5kZXg6IG51bWJlciwgYW1vdW50OiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RhdGljUHJvcGVydGllcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSB0aGlzLnN0YXRpY1Byb3BlcnRpZXNbaV07XG5cbiAgICAgICAgICAgIHByb3BlcnR5LnVwbG9hZEZ1bmN0aW9uKGNoaWxkcmVuLCBzdGFydEluZGV4LCBhbW91bnQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHkudHlwZSA9PT0gVFlQRVMuVU5TSUdORURfQllURSA/IHRoaXMuc3RhdGljRGF0YVVpbnQzMiA6IHRoaXMuc3RhdGljRGF0YSxcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRpY1N0cmlkZSwgcHJvcGVydHkub2Zmc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3RhdGljQnVmZmVyLl91cGRhdGVJRCsrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBQYXJ0aWNsZUJ1ZmZlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmluZGV4QnVmZmVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLmR5bmFtaWNQcm9wZXJ0aWVzID0gbnVsbDtcbiAgICAgICAgdGhpcy5keW5hbWljQnVmZmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5keW5hbWljRGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuZHluYW1pY0RhdGFVaW50MzIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuc3RhdGljUHJvcGVydGllcyA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RhdGljQnVmZmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdGF0aWNEYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdGF0aWNEYXRhVWludDMyID0gbnVsbDtcbiAgICAgICAgLy8gYWxsIGJ1ZmZlcnMgYXJlIGRlc3Ryb3llZCBpbnNpZGUgZ2VvbWV0cnlcbiAgICAgICAgdGhpcy5nZW9tZXRyeS5kZXN0cm95KCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRZUEVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IE9iamVjdFJlbmRlcmVyLCBTaGFkZXIsIFN0YXRlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IGNvcnJlY3RCbGVuZE1vZGUsIHByZW11bHRpcGx5UmdiYSwgcHJlbXVsdGlwbHlUaW50IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgUGFydGljbGVCdWZmZXIgfSBmcm9tICcuL1BhcnRpY2xlQnVmZmVyJztcbmltcG9ydCBmcmFnbWVudCBmcm9tICcuL3BhcnRpY2xlcy5mcmFnJztcbmltcG9ydCB2ZXJ0ZXggZnJvbSAnLi9wYXJ0aWNsZXMudmVydCc7XG5cbmltcG9ydCB0eXBlIHsgRGlzcGxheU9iamVjdCB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBQYXJ0aWNsZUNvbnRhaW5lciB9IGZyb20gJy4vUGFydGljbGVDb250YWluZXInO1xuaW1wb3J0IHR5cGUgeyBSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElQYXJ0aWNsZVJlbmRlcmVyUHJvcGVydHkge1xuICAgIGF0dHJpYnV0ZU5hbWU6IHN0cmluZztcbiAgICBzaXplOiBudW1iZXI7XG4gICAgdHlwZT86IFRZUEVTO1xuICAgIHVwbG9hZEZ1bmN0aW9uOiAoLi4ucGFyYW1zOiBhbnlbXSkgPT4gYW55O1xuICAgIG9mZnNldDogbnVtYmVyO1xufVxuXG4vKipcbiAqIEBhdXRob3IgTWF0IEdyb3Zlc1xuICpcbiAqIEJpZyB0aGFua3MgdG8gdGhlIHZlcnkgY2xldmVyIE1hdHQgRGVzTGF1cmllcnMgPG1hdHRkZXNsPiBodHRwczovL2dpdGh1Yi5jb20vbWF0dGRlc2wvXG4gKiBmb3IgY3JlYXRpbmcgdGhlIG9yaWdpbmFsIFBpeGlKUyB2ZXJzaW9uIVxuICogQWxzbyBhIHRoYW5rcyB0byBodHRwczovL2dpdGh1Yi5jb20vYmNoZXZhbGllciBmb3IgdHdlYWtpbmcgdGhlIHRpbnQgYW5kIGFscGhhIHNvIHRoYXQgdGhleSBub3dcbiAqIHNoYXJlIDQgYnl0ZXMgb24gdGhlIHZlcnRleCBidWZmZXJcbiAqXG4gKiBIZWF2aWx5IGluc3BpcmVkIGJ5IExpYkdEWCdzIFBhcnRpY2xlUmVuZGVyZXI6XG4gKiBodHRwczovL2dpdGh1Yi5jb20vbGliZ2R4L2xpYmdkeC9ibG9iL21hc3Rlci9nZHgvc3JjL2NvbS9iYWRsb2dpYy9nZHgvZ3JhcGhpY3MvZzJkL1BhcnRpY2xlUmVuZGVyZXIuamF2YVxuICovXG5cbi8qKlxuICogUmVuZGVyZXIgZm9yIFBhcnRpY2xlcyB0aGF0IGlzIGRlc2lnbmVyIGZvciBzcGVlZCBvdmVyIGZlYXR1cmUgc2V0LlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcnRpY2xlUmVuZGVyZXIgZXh0ZW5kcyBPYmplY3RSZW5kZXJlclxue1xuICAgIHB1YmxpYyByZWFkb25seSBzdGF0ZTogU3RhdGU7XG4gICAgcHVibGljIHNoYWRlcjogU2hhZGVyO1xuICAgIHB1YmxpYyB0ZW1wTWF0cml4OiBNYXRyaXg7XG4gICAgcHVibGljIHByb3BlcnRpZXM6IElQYXJ0aWNsZVJlbmRlcmVyUHJvcGVydHlbXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXIgdGhpcyBzcHJpdGUgYmF0Y2ggd29ya3MgZm9yLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyOiBSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIHN1cGVyKHJlbmRlcmVyKTtcblxuICAgICAgICAvLyA2NTUzNSBpcyBtYXggdmVydGV4IGluZGV4IGluIHRoZSBpbmRleCBidWZmZXIgKHNlZSBQYXJ0aWNsZVJlbmRlcmVyKVxuICAgICAgICAvLyBzbyBtYXggbnVtYmVyIG9mIHBhcnRpY2xlcyBpcyA2NTUzNiAvIDQgPSAxNjM4NFxuICAgICAgICAvLyBhbmQgbWF4IG51bWJlciBvZiBlbGVtZW50IGluIHRoZSBpbmRleCBidWZmZXIgaXMgMTYzODQgKiA2ID0gOTgzMDRcbiAgICAgICAgLy8gQ3JlYXRpbmcgYSBmdWxsIGluZGV4IGJ1ZmZlciwgb3ZlcmhlYWQgaXMgOTgzMDQgKiAyID0gMTk2S29cbiAgICAgICAgLy8gbGV0IG51bUluZGljZXMgPSA5ODMwNDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRlZmF1bHQgc2hhZGVyIHRoYXQgaXMgdXNlZCBpZiBhIHNwcml0ZSBkb2Vzbid0IGhhdmUgYSBtb3JlIHNwZWNpZmljIG9uZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TaGFkZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNoYWRlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gbnVsbDtcblxuICAgICAgICB0aGlzLnRlbXBNYXRyaXggPSBuZXcgTWF0cml4KCk7XG5cbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgLy8gdmVydGljZXNEYXRhXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2FWZXJ0ZXhQb3NpdGlvbicsXG4gICAgICAgICAgICAgICAgc2l6ZTogMixcbiAgICAgICAgICAgICAgICB1cGxvYWRGdW5jdGlvbjogdGhpcy51cGxvYWRWZXJ0aWNlcyxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gcG9zaXRpb25EYXRhXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2FQb3NpdGlvbkNvb3JkJyxcbiAgICAgICAgICAgICAgICBzaXplOiAyLFxuICAgICAgICAgICAgICAgIHVwbG9hZEZ1bmN0aW9uOiB0aGlzLnVwbG9hZFBvc2l0aW9uLFxuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyByb3RhdGlvbkRhdGFcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYVJvdGF0aW9uJyxcbiAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgIHVwbG9hZEZ1bmN0aW9uOiB0aGlzLnVwbG9hZFJvdGF0aW9uLFxuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyB1dnNEYXRhXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2FUZXh0dXJlQ29vcmQnLFxuICAgICAgICAgICAgICAgIHNpemU6IDIsXG4gICAgICAgICAgICAgICAgdXBsb2FkRnVuY3Rpb246IHRoaXMudXBsb2FkVXZzLFxuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyB0aW50RGF0YVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhQ29sb3InLFxuICAgICAgICAgICAgICAgIHNpemU6IDEsXG4gICAgICAgICAgICAgICAgdHlwZTogVFlQRVMuVU5TSUdORURfQllURSxcbiAgICAgICAgICAgICAgICB1cGxvYWRGdW5jdGlvbjogdGhpcy51cGxvYWRUaW50LFxuICAgICAgICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5zaGFkZXIgPSBTaGFkZXIuZnJvbSh2ZXJ0ZXgsIGZyYWdtZW50LCB7fSk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBXZWJHTCBzdGF0ZSBpbiB3aGljaCB0aGlzIHJlbmRlcmVyIHdpbGwgd29yay5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TdGF0ZX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuZm9yMmQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIHRoZSBwYXJ0aWNsZSBjb250YWluZXIgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlBhcnRpY2xlQ29udGFpbmVyfSBjb250YWluZXIgLSBUaGUgY29udGFpbmVyIHRvIHJlbmRlciB1c2luZyB0aGlzIFBhcnRpY2xlUmVuZGVyZXJcbiAgICAgKi9cbiAgICBwdWJsaWMgcmVuZGVyKGNvbnRhaW5lcjogUGFydGljbGVDb250YWluZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGNvbnRhaW5lci5jaGlsZHJlbjtcbiAgICAgICAgY29uc3QgbWF4U2l6ZSA9IGNvbnRhaW5lci5fbWF4U2l6ZTtcbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gY29udGFpbmVyLl9iYXRjaFNpemU7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlcjtcbiAgICAgICAgbGV0IHRvdGFsQ2hpbGRyZW4gPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICAgICAgaWYgKHRvdGFsQ2hpbGRyZW4gPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0b3RhbENoaWxkcmVuID4gbWF4U2l6ZSAmJiAhY29udGFpbmVyLmF1dG9SZXNpemUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvdGFsQ2hpbGRyZW4gPSBtYXhTaXplO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGJ1ZmZlcnMgPSBjb250YWluZXIuX2J1ZmZlcnM7XG5cbiAgICAgICAgaWYgKCFidWZmZXJzKVxuICAgICAgICB7XG4gICAgICAgICAgICBidWZmZXJzID0gY29udGFpbmVyLl9idWZmZXJzID0gdGhpcy5nZW5lcmF0ZUJ1ZmZlcnMoY29udGFpbmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJhc2VUZXh0dXJlID0gKGNoaWxkcmVuWzBdIGFzIGFueSkuX3RleHR1cmUuYmFzZVRleHR1cmU7XG5cbiAgICAgICAgLy8gaWYgdGhlIHV2cyBoYXZlIG5vdCB1cGRhdGVkIHRoZW4gbm8gcG9pbnQgcmVuZGVyaW5nIGp1c3QgeWV0IVxuICAgICAgICB0aGlzLnN0YXRlLmJsZW5kTW9kZSA9IGNvcnJlY3RCbGVuZE1vZGUoY29udGFpbmVyLmJsZW5kTW9kZSwgYmFzZVRleHR1cmUuYWxwaGFNb2RlKTtcbiAgICAgICAgcmVuZGVyZXIuc3RhdGUuc2V0KHRoaXMuc3RhdGUpO1xuXG4gICAgICAgIGNvbnN0IGdsID0gcmVuZGVyZXIuZ2w7XG5cbiAgICAgICAgY29uc3QgbSA9IGNvbnRhaW5lci53b3JsZFRyYW5zZm9ybS5jb3B5VG8odGhpcy50ZW1wTWF0cml4KTtcblxuICAgICAgICBtLnByZXBlbmQocmVuZGVyZXIuZ2xvYmFsVW5pZm9ybXMudW5pZm9ybXMucHJvamVjdGlvbk1hdHJpeCk7XG5cbiAgICAgICAgdGhpcy5zaGFkZXIudW5pZm9ybXMudHJhbnNsYXRpb25NYXRyaXggPSBtLnRvQXJyYXkodHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5zaGFkZXIudW5pZm9ybXMudUNvbG9yID0gcHJlbXVsdGlwbHlSZ2JhKGNvbnRhaW5lci50aW50UmdiLFxuICAgICAgICAgICAgY29udGFpbmVyLndvcmxkQWxwaGEsIHRoaXMuc2hhZGVyLnVuaWZvcm1zLnVDb2xvciwgYmFzZVRleHR1cmUuYWxwaGFNb2RlKTtcblxuICAgICAgICB0aGlzLnNoYWRlci51bmlmb3Jtcy51U2FtcGxlciA9IGJhc2VUZXh0dXJlO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2hhZGVyLmJpbmQodGhpcy5zaGFkZXIpO1xuXG4gICAgICAgIGxldCB1cGRhdGVTdGF0aWMgPSBmYWxzZTtcblxuICAgICAgICAvLyBub3cgbGV0cyB1cGxvYWQgYW5kIHJlbmRlciB0aGUgYnVmZmVycy4uXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHRvdGFsQ2hpbGRyZW47IGkgKz0gYmF0Y2hTaXplLCBqICs9IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBhbW91bnQgPSAodG90YWxDaGlsZHJlbiAtIGkpO1xuXG4gICAgICAgICAgICBpZiAoYW1vdW50ID4gYmF0Y2hTaXplKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFtb3VudCA9IGJhdGNoU2l6ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGogPj0gYnVmZmVycy5sZW5ndGgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYnVmZmVycy5wdXNoKHRoaXMuX2dlbmVyYXRlT25lTW9yZUJ1ZmZlcihjb250YWluZXIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gYnVmZmVyc1tqXTtcblxuICAgICAgICAgICAgLy8gd2UgYWx3YXlzIHVwbG9hZCB0aGUgZHluYW1pY1xuICAgICAgICAgICAgYnVmZmVyLnVwbG9hZER5bmFtaWMoY2hpbGRyZW4sIGksIGFtb3VudCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGJpZCA9IGNvbnRhaW5lci5fYnVmZmVyVXBkYXRlSURzW2pdIHx8IDA7XG5cbiAgICAgICAgICAgIHVwZGF0ZVN0YXRpYyA9IHVwZGF0ZVN0YXRpYyB8fCAoYnVmZmVyLl91cGRhdGVJRCA8IGJpZCk7XG4gICAgICAgICAgICAvLyB3ZSBvbmx5IHVwbG9hZCB0aGUgc3RhdGljIGNvbnRlbnQgd2hlbiB3ZSBoYXZlIHRvIVxuICAgICAgICAgICAgaWYgKHVwZGF0ZVN0YXRpYylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBidWZmZXIuX3VwZGF0ZUlEID0gY29udGFpbmVyLl91cGRhdGVJRDtcbiAgICAgICAgICAgICAgICBidWZmZXIudXBsb2FkU3RhdGljKGNoaWxkcmVuLCBpLCBhbW91bnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBiaW5kIHRoZSBidWZmZXJcbiAgICAgICAgICAgIHJlbmRlcmVyLmdlb21ldHJ5LmJpbmQoYnVmZmVyLmdlb21ldHJ5KTtcbiAgICAgICAgICAgIGdsLmRyYXdFbGVtZW50cyhnbC5UUklBTkdMRVMsIGFtb3VudCAqIDYsIGdsLlVOU0lHTkVEX1NIT1JULCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgb25lIHBhcnRpY2xlIGJ1ZmZlciBmb3IgZWFjaCBjaGlsZCBpbiB0aGUgY29udGFpbmVyIHdlIHdhbnQgdG8gcmVuZGVyIGFuZCB1cGRhdGVzIGludGVybmFsIHByb3BlcnRpZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5QYXJ0aWNsZUNvbnRhaW5lcn0gY29udGFpbmVyIC0gVGhlIGNvbnRhaW5lciB0byByZW5kZXIgdXNpbmcgdGhpcyBQYXJ0aWNsZVJlbmRlcmVyXG4gICAgICogQHJldHVybiB7UElYSS5QYXJ0aWNsZUJ1ZmZlcltdfSBUaGUgYnVmZmVyc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZUJ1ZmZlcnMoY29udGFpbmVyOiBQYXJ0aWNsZUNvbnRhaW5lcik6IFBhcnRpY2xlQnVmZmVyW11cbiAgICB7XG4gICAgICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTtcbiAgICAgICAgY29uc3Qgc2l6ZSA9IGNvbnRhaW5lci5fbWF4U2l6ZTtcbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gY29udGFpbmVyLl9iYXRjaFNpemU7XG4gICAgICAgIGNvbnN0IGR5bmFtaWNQcm9wZXJ0eUZsYWdzID0gY29udGFpbmVyLl9wcm9wZXJ0aWVzO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSArPSBiYXRjaFNpemUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGJ1ZmZlcnMucHVzaChuZXcgUGFydGljbGVCdWZmZXIodGhpcy5wcm9wZXJ0aWVzLCBkeW5hbWljUHJvcGVydHlGbGFncywgYmF0Y2hTaXplKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYnVmZmVycztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIG9uZSBtb3JlIHBhcnRpY2xlIGJ1ZmZlciwgYmVjYXVzZSBjb250YWluZXIgaGFzIGF1dG9SZXNpemUgZmVhdHVyZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLlBhcnRpY2xlQ29udGFpbmVyfSBjb250YWluZXIgLSBUaGUgY29udGFpbmVyIHRvIHJlbmRlciB1c2luZyB0aGlzIFBhcnRpY2xlUmVuZGVyZXJcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlBhcnRpY2xlQnVmZmVyfSBnZW5lcmF0ZWQgYnVmZmVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9nZW5lcmF0ZU9uZU1vcmVCdWZmZXIoY29udGFpbmVyOiBQYXJ0aWNsZUNvbnRhaW5lcik6IFBhcnRpY2xlQnVmZmVyXG4gICAge1xuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSBjb250YWluZXIuX2JhdGNoU2l6ZTtcbiAgICAgICAgY29uc3QgZHluYW1pY1Byb3BlcnR5RmxhZ3MgPSBjb250YWluZXIuX3Byb3BlcnRpZXM7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNsZUJ1ZmZlcih0aGlzLnByb3BlcnRpZXMsIGR5bmFtaWNQcm9wZXJ0eUZsYWdzLCBiYXRjaFNpemUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgdGhlIHZlcnRpY2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3RbXX0gY2hpbGRyZW4gLSB0aGUgYXJyYXkgb2YgZGlzcGxheSBvYmplY3RzIHRvIHJlbmRlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEluZGV4IC0gdGhlIGluZGV4IHRvIHN0YXJ0IGZyb20gaW4gdGhlIGNoaWxkcmVuIGFycmF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgY2hpbGRyZW4gdGhhdCB3aWxsIGhhdmUgdGhlaXIgdmVydGljZXMgdXBsb2FkZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcltdfSBhcnJheSAtIFRoZSB2ZXJ0aWNlcyB0byB1cGxvYWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0cmlkZSAtIFN0cmlkZSB0byB1c2UgZm9yIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gT2Zmc2V0IHRvIHN0YXJ0IGF0LlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGxvYWRWZXJ0aWNlcyhcbiAgICAgICAgY2hpbGRyZW46IERpc3BsYXlPYmplY3RbXSwgc3RhcnRJbmRleDogbnVtYmVyLCBhbW91bnQ6IG51bWJlcixcbiAgICAgICAgYXJyYXk6IG51bWJlcltdLCBzdHJpZGU6IG51bWJlciwgb2Zmc2V0OiBudW1iZXJcbiAgICApOiB2b2lkXG4gICAge1xuICAgICAgICBsZXQgdzAgPSAwO1xuICAgICAgICBsZXQgdzEgPSAwO1xuICAgICAgICBsZXQgaDAgPSAwO1xuICAgICAgICBsZXQgaDEgPSAwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYW1vdW50OyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHNwcml0ZTogYW55ID0gY2hpbGRyZW5bc3RhcnRJbmRleCArIGldO1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IHNwcml0ZS5fdGV4dHVyZTtcbiAgICAgICAgICAgIGNvbnN0IHN4ID0gc3ByaXRlLnNjYWxlLng7XG4gICAgICAgICAgICBjb25zdCBzeSA9IHNwcml0ZS5zY2FsZS55O1xuICAgICAgICAgICAgY29uc3QgdHJpbSA9IHRleHR1cmUudHJpbTtcbiAgICAgICAgICAgIGNvbnN0IG9yaWcgPSB0ZXh0dXJlLm9yaWc7XG5cbiAgICAgICAgICAgIGlmICh0cmltKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBzcHJpdGUgaXMgdHJpbW1lZCBhbmQgaXMgbm90IGEgdGlsaW5nc3ByaXRlIHRoZW4gd2UgbmVlZCB0byBhZGQgdGhlXG4gICAgICAgICAgICAgICAgLy8gZXh0cmEgc3BhY2UgYmVmb3JlIHRyYW5zZm9ybWluZyB0aGUgc3ByaXRlIGNvb3Jkcy4uXG4gICAgICAgICAgICAgICAgdzEgPSB0cmltLnggLSAoc3ByaXRlLmFuY2hvci54ICogb3JpZy53aWR0aCk7XG4gICAgICAgICAgICAgICAgdzAgPSB3MSArIHRyaW0ud2lkdGg7XG5cbiAgICAgICAgICAgICAgICBoMSA9IHRyaW0ueSAtIChzcHJpdGUuYW5jaG9yLnkgKiBvcmlnLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgaDAgPSBoMSArIHRyaW0uaGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHcwID0gKG9yaWcud2lkdGgpICogKDEgLSBzcHJpdGUuYW5jaG9yLngpO1xuICAgICAgICAgICAgICAgIHcxID0gKG9yaWcud2lkdGgpICogLXNwcml0ZS5hbmNob3IueDtcblxuICAgICAgICAgICAgICAgIGgwID0gb3JpZy5oZWlnaHQgKiAoMSAtIHNwcml0ZS5hbmNob3IueSk7XG4gICAgICAgICAgICAgICAgaDEgPSBvcmlnLmhlaWdodCAqIC1zcHJpdGUuYW5jaG9yLnk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFycmF5W29mZnNldF0gPSB3MSAqIHN4O1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSBoMSAqIHN5O1xuXG4gICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGVdID0gdzAgKiBzeDtcbiAgICAgICAgICAgIGFycmF5W29mZnNldCArIHN0cmlkZSArIDFdID0gaDEgKiBzeTtcblxuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDIpXSA9IHcwICogc3g7XG4gICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMikgKyAxXSA9IGgwICogc3k7XG5cbiAgICAgICAgICAgIGFycmF5W29mZnNldCArIChzdHJpZGUgKiAzKV0gPSB3MSAqIHN4O1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDMpICsgMV0gPSBoMCAqIHN5O1xuXG4gICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgdGhlIHBvc2l0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3RbXX0gY2hpbGRyZW4gLSB0aGUgYXJyYXkgb2YgZGlzcGxheSBvYmplY3RzIHRvIHJlbmRlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEluZGV4IC0gdGhlIGluZGV4IHRvIHN0YXJ0IGZyb20gaW4gdGhlIGNoaWxkcmVuIGFycmF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgY2hpbGRyZW4gdGhhdCB3aWxsIGhhdmUgdGhlaXIgcG9zaXRpb25zIHVwbG9hZGVkXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gYXJyYXkgLSBUaGUgdmVydGljZXMgdG8gdXBsb2FkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdHJpZGUgLSBTdHJpZGUgdG8gdXNlIGZvciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIE9mZnNldCB0byBzdGFydCBhdC5cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBsb2FkUG9zaXRpb24oXG4gICAgICAgIGNoaWxkcmVuOiBEaXNwbGF5T2JqZWN0W10sIHN0YXJ0SW5kZXg6IG51bWJlciwgYW1vdW50OiBudW1iZXIsXG4gICAgICAgIGFycmF5OiBudW1iZXJbXSwgc3RyaWRlOiBudW1iZXIsIG9mZnNldDogbnVtYmVyXG4gICAgKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbW91bnQ7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3Qgc3ByaXRlUG9zaXRpb24gPSBjaGlsZHJlbltzdGFydEluZGV4ICsgaV0ucG9zaXRpb247XG5cbiAgICAgICAgICAgIGFycmF5W29mZnNldF0gPSBzcHJpdGVQb3NpdGlvbi54O1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSBzcHJpdGVQb3NpdGlvbi55O1xuXG4gICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGVdID0gc3ByaXRlUG9zaXRpb24ueDtcbiAgICAgICAgICAgIGFycmF5W29mZnNldCArIHN0cmlkZSArIDFdID0gc3ByaXRlUG9zaXRpb24ueTtcblxuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDIpXSA9IHNwcml0ZVBvc2l0aW9uLng7XG4gICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMikgKyAxXSA9IHNwcml0ZVBvc2l0aW9uLnk7XG5cbiAgICAgICAgICAgIGFycmF5W29mZnNldCArIChzdHJpZGUgKiAzKV0gPSBzcHJpdGVQb3NpdGlvbi54O1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDMpICsgMV0gPSBzcHJpdGVQb3NpdGlvbi55O1xuXG4gICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgdGhlIHJvdGF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3RbXX0gY2hpbGRyZW4gLSB0aGUgYXJyYXkgb2YgZGlzcGxheSBvYmplY3RzIHRvIHJlbmRlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEluZGV4IC0gdGhlIGluZGV4IHRvIHN0YXJ0IGZyb20gaW4gdGhlIGNoaWxkcmVuIGFycmF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgY2hpbGRyZW4gdGhhdCB3aWxsIGhhdmUgdGhlaXIgcm90YXRpb24gdXBsb2FkZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcltdfSBhcnJheSAtIFRoZSB2ZXJ0aWNlcyB0byB1cGxvYWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0cmlkZSAtIFN0cmlkZSB0byB1c2UgZm9yIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gT2Zmc2V0IHRvIHN0YXJ0IGF0LlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGxvYWRSb3RhdGlvbihcbiAgICAgICAgY2hpbGRyZW46IERpc3BsYXlPYmplY3RbXSwgc3RhcnRJbmRleDogbnVtYmVyLCBhbW91bnQ6IG51bWJlcixcbiAgICAgICAgYXJyYXk6IG51bWJlcltdLCBzdHJpZGU6IG51bWJlciwgb2Zmc2V0OiBudW1iZXJcbiAgICApOiB2b2lkXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFtb3VudDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBzcHJpdGVSb3RhdGlvbiA9IGNoaWxkcmVuW3N0YXJ0SW5kZXggKyBpXS5yb3RhdGlvbjtcblxuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0XSA9IHNwcml0ZVJvdGF0aW9uO1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgc3RyaWRlXSA9IHNwcml0ZVJvdGF0aW9uO1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDIpXSA9IHNwcml0ZVJvdGF0aW9uO1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgKHN0cmlkZSAqIDMpXSA9IHNwcml0ZVJvdGF0aW9uO1xuXG4gICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgdGhlIFV2c1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3RbXX0gY2hpbGRyZW4gLSB0aGUgYXJyYXkgb2YgZGlzcGxheSBvYmplY3RzIHRvIHJlbmRlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEluZGV4IC0gdGhlIGluZGV4IHRvIHN0YXJ0IGZyb20gaW4gdGhlIGNoaWxkcmVuIGFycmF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgY2hpbGRyZW4gdGhhdCB3aWxsIGhhdmUgdGhlaXIgcm90YXRpb24gdXBsb2FkZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcltdfSBhcnJheSAtIFRoZSB2ZXJ0aWNlcyB0byB1cGxvYWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0cmlkZSAtIFN0cmlkZSB0byB1c2UgZm9yIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gT2Zmc2V0IHRvIHN0YXJ0IGF0LlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGxvYWRVdnMoXG4gICAgICAgIGNoaWxkcmVuOiBEaXNwbGF5T2JqZWN0W10sIHN0YXJ0SW5kZXg6IG51bWJlciwgYW1vdW50OiBudW1iZXIsXG4gICAgICAgIGFycmF5OiBudW1iZXJbXSwgc3RyaWRlOiBudW1iZXIsIG9mZnNldDogbnVtYmVyXG4gICAgKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbW91bnQ7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZVV2cyA9IChjaGlsZHJlbltzdGFydEluZGV4ICsgaV0gYXMgYW55KS5fdGV4dHVyZS5fdXZzO1xuXG4gICAgICAgICAgICBpZiAodGV4dHVyZVV2cylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXRdID0gdGV4dHVyZVV2cy54MDtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAxXSA9IHRleHR1cmVVdnMueTA7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGVdID0gdGV4dHVyZVV2cy54MTtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGUgKyAxXSA9IHRleHR1cmVVdnMueTE7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMildID0gdGV4dHVyZVV2cy54MjtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMikgKyAxXSA9IHRleHR1cmVVdnMueTI7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMyldID0gdGV4dHVyZVV2cy54MztcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMykgKyAxXSA9IHRleHR1cmVVdnMueTM7XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPIHlvdSBrbm93IHRoaXMgY2FuIGJlIGVhc2llciFcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXRdID0gMDtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAxXSA9IDA7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGVdID0gMDtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBzdHJpZGUgKyAxXSA9IDA7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMildID0gMDtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMikgKyAxXSA9IDA7XG5cbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMyldID0gMDtcbiAgICAgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMykgKyAxXSA9IDA7XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwbG9hZHMgdGhlIHRpbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdFtdfSBjaGlsZHJlbiAtIHRoZSBhcnJheSBvZiBkaXNwbGF5IG9iamVjdHMgdG8gcmVuZGVyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0SW5kZXggLSB0aGUgaW5kZXggdG8gc3RhcnQgZnJvbSBpbiB0aGUgY2hpbGRyZW4gYXJyYXlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IC0gdGhlIGFtb3VudCBvZiBjaGlsZHJlbiB0aGF0IHdpbGwgaGF2ZSB0aGVpciByb3RhdGlvbiB1cGxvYWRlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IGFycmF5IC0gVGhlIHZlcnRpY2VzIHRvIHVwbG9hZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RyaWRlIC0gU3RyaWRlIHRvIHVzZSBmb3IgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBPZmZzZXQgdG8gc3RhcnQgYXQuXG4gICAgICovXG4gICAgcHVibGljIHVwbG9hZFRpbnQoXG4gICAgICAgIGNoaWxkcmVuOiBEaXNwbGF5T2JqZWN0W10sIHN0YXJ0SW5kZXg6IG51bWJlciwgYW1vdW50OiBudW1iZXIsXG4gICAgICAgIGFycmF5OiBudW1iZXJbXSwgc3RyaWRlOiBudW1iZXIsIG9mZnNldDogbnVtYmVyXG4gICAgKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbW91bnQ7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3Qgc3ByaXRlOiBhbnkgPSBjaGlsZHJlbltzdGFydEluZGV4ICsgaV07XG4gICAgICAgICAgICBjb25zdCBwcmVtdWx0aXBsaWVkID0gc3ByaXRlLl90ZXh0dXJlLmJhc2VUZXh0dXJlLmFscGhhTW9kZSA+IDA7XG4gICAgICAgICAgICBjb25zdCBhbHBoYSA9IHNwcml0ZS5hbHBoYTtcblxuICAgICAgICAgICAgLy8gd2UgZG9udCBjYWxsIGV4dHJhIGZ1bmN0aW9uIGlmIGFscGhhIGlzIDEuMCwgdGhhdCdzIGZhc3RlclxuICAgICAgICAgICAgY29uc3QgYXJnYiA9IGFscGhhIDwgMS4wICYmIHByZW11bHRpcGxpZWRcbiAgICAgICAgICAgICAgICA/IHByZW11bHRpcGx5VGludChzcHJpdGUuX3RpbnRSR0IsIGFscGhhKSA6IHNwcml0ZS5fdGludFJHQiArIChhbHBoYSAqIDI1NSA8PCAyNCk7XG5cbiAgICAgICAgICAgIGFycmF5W29mZnNldF0gPSBhcmdiO1xuICAgICAgICAgICAgYXJyYXlbb2Zmc2V0ICsgc3RyaWRlXSA9IGFyZ2I7XG4gICAgICAgICAgICBhcnJheVtvZmZzZXQgKyAoc3RyaWRlICogMildID0gYXJnYjtcbiAgICAgICAgICAgIGFycmF5W29mZnNldCArIChzdHJpZGUgKiAzKV0gPSBhcmdiO1xuXG4gICAgICAgICAgICBvZmZzZXQgKz0gc3RyaWRlICogNDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBQYXJ0aWNsZVJlbmRlcmVyLlxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgICAgICBpZiAodGhpcy5zaGFkZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc2hhZGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuc2hhZGVyID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGVtcE1hdHJpeCA9IG51bGw7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU3VwcG9ydGVkIGxpbmUgam9pbnRzIGluIGBQSVhJLkxpbmVTdHlsZWAgZm9yIGdyYXBoaWNzLlxuICpcbiAqIEBzZWUgUElYSS5HcmFwaGljcyNsaW5lU3R5bGVcbiAqIEBzZWUgaHR0cHM6Ly9ncmFwaGljZGVzaWduLnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy81OTAxOC93aGF0LWlzLWEtYmV2ZWwtam9pbi1vZi10d28tbGluZXMtZXhhY3RseS1pbGx1c3RyYXRvclxuICpcbiAqIEBuYW1lIExJTkVfSk9JTlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKiBAcHJvcGVydHkge3N0cmluZ30gTUlURVIgLSAnbWl0ZXInOiBtYWtlIGEgc2hhcnAgY29ybmVyIHdoZXJlIG91dGVyIHBhcnQgb2YgbGluZXMgbWVldFxuICogQHByb3BlcnR5IHtzdHJpbmd9IEJFVkVMIC0gJ2JldmVsJzogYWRkIGEgc3F1YXJlIGJ1dHQgYXQgZWFjaCBlbmQgb2YgbGluZSBzZWdtZW50IGFuZCBmaWxsIHRoZSB0cmlhbmdsZSBhdCB0dXJuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gUk9VTkQgLSAncm91bmQnOiBhZGQgYW4gYXJjIGF0IHRoZSBqb2ludFxuICovXG5leHBvcnQgZW51bSBMSU5FX0pPSU4ge1xuICAgIE1JVEVSID0gJ21pdGVyJyxcbiAgICBCRVZFTCA9ICdiZXZlbCcsXG4gICAgUk9VTkQgPSAncm91bmQnXG59XG5cbi8qKlxuICogU3VwcG9ydCBsaW5lIGNhcHMgaW4gYFBJWEkuTGluZVN0eWxlYCBmb3IgZ3JhcGhpY3MuXG4gKlxuICogQHNlZSBQSVhJLkdyYXBoaWNzI2xpbmVTdHlsZVxuICpcbiAqIEBuYW1lIExJTkVfQ0FQXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQGVudW0ge3N0cmluZ31cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBCVVRUIC0gJ2J1dHQnOiBkb24ndCBhZGQgYW55IGNhcCBhdCBsaW5lIGVuZHMgKGxlYXZlcyBvcnRob2dvbmFsIGVkZ2VzKVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFJPVU5EIC0gJ3JvdW5kJzogYWRkIHNlbWljaXJjbGUgYXQgZW5kc1xuICogQHByb3BlcnR5IHtzdHJpbmd9IFNRVUFSRSAtICdzcXVhcmUnOiBhZGQgc3F1YXJlIGF0IGVuZCAobGlrZSBgQlVUVGAgZXhjZXB0IG1vcmUgbGVuZ3RoIGF0IGVuZClcbiAqL1xuZXhwb3J0IGVudW0gTElORV9DQVAge1xuICAgIEJVVFQgPSAnYnV0dCcsXG4gICAgUk9VTkQgPSAncm91bmQnLFxuICAgIFNRVUFSRSA9ICdzcXVhcmUnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUdyYXBoaWNzQ3VydmVzU2V0dGluZ3Mge1xuICAgIGFkYXB0aXZlOiBib29sZWFuO1xuICAgIG1heExlbmd0aDogbnVtYmVyO1xuICAgIG1pblNlZ21lbnRzOiBudW1iZXI7XG4gICAgbWF4U2VnbWVudHM6IG51bWJlcjtcblxuICAgIGVwc2lsb246IG51bWJlcjtcblxuICAgIF9zZWdtZW50c0NvdW50KGxlbmd0aDogbnVtYmVyLCBkZWZhdWx0U2VnbWVudHM/OiBudW1iZXIpOiBudW1iZXI7XG59XG5cbi8qKlxuICogR3JhcGhpY3MgY3VydmVzIHJlc29sdXRpb24gc2V0dGluZ3MuIElmIGBhZGFwdGl2ZWAgZmxhZyBpcyBzZXQgdG8gYHRydWVgLFxuICogdGhlIHJlc29sdXRpb24gaXMgY2FsY3VsYXRlZCBiYXNlZCBvbiB0aGUgY3VydmUncyBsZW5ndGggdG8gZW5zdXJlIGJldHRlciB2aXN1YWwgcXVhbGl0eS5cbiAqIEFkYXB0aXZlIGRyYXcgd29ya3Mgd2l0aCBgYmV6aWVyQ3VydmVUb2AgYW5kIGBxdWFkcmF0aWNDdXJ2ZVRvYC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAY29uc3RhbnRcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAbmFtZSBHUkFQSElDU19DVVJWRVNcbiAqIEB0eXBlIHtvYmplY3R9XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFkYXB0aXZlPWZhbHNlIC0gZmxhZyBpbmRpY2F0aW5nIGlmIHRoZSByZXNvbHV0aW9uIHNob3VsZCBiZSBhZGFwdGl2ZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IG1heExlbmd0aD0xMCAtIG1heGltYWwgbGVuZ3RoIG9mIGEgc2luZ2xlIHNlZ21lbnQgb2YgdGhlIGN1cnZlIChpZiBhZGFwdGl2ZSA9IGZhbHNlLCBpZ25vcmVkKVxuICogQHByb3BlcnR5IHtudW1iZXJ9IG1pblNlZ21lbnRzPTggLSBtaW5pbWFsIG51bWJlciBvZiBzZWdtZW50cyBpbiB0aGUgY3VydmUgKGlmIGFkYXB0aXZlID0gZmFsc2UsIGlnbm9yZWQpXG4gKiBAcHJvcGVydHkge251bWJlcn0gbWF4U2VnbWVudHM9MjA0OCAtIG1heGltYWwgbnVtYmVyIG9mIHNlZ21lbnRzIGluIHRoZSBjdXJ2ZSAoaWYgYWRhcHRpdmUgPSBmYWxzZSwgaWdub3JlZClcbiAqL1xuZXhwb3J0IGNvbnN0IEdSQVBISUNTX0NVUlZFUzogSUdyYXBoaWNzQ3VydmVzU2V0dGluZ3MgPSB7XG4gICAgYWRhcHRpdmU6IHRydWUsXG4gICAgbWF4TGVuZ3RoOiAxMCxcbiAgICBtaW5TZWdtZW50czogOCxcbiAgICBtYXhTZWdtZW50czogIDIwNDgsXG5cbiAgICBlcHNpbG9uOiAwLjAwMDEsXG5cbiAgICBfc2VnbWVudHNDb3VudChsZW5ndGg6IG51bWJlciwgZGVmYXVsdFNlZ21lbnRzID0gMjApXG4gICAge1xuICAgICAgICBpZiAoIXRoaXMuYWRhcHRpdmUgfHwgIWxlbmd0aCB8fCBpc05hTihsZW5ndGgpKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdFNlZ21lbnRzO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlc3VsdCA9IE1hdGguY2VpbChsZW5ndGggLyB0aGlzLm1heExlbmd0aCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCA8IHRoaXMubWluU2VnbWVudHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMubWluU2VnbWVudHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzdWx0ID4gdGhpcy5tYXhTZWdtZW50cylcbiAgICAgICAge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5tYXhTZWdtZW50cztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbn07XG4iLCAiaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBNYXRyaXggfSBmcm9tICdAcGl4aS9tYXRoJztcblxuLyoqXG4gKiBGaWxsIHN0eWxlIG9iamVjdCBmb3IgR3JhcGhpY3MuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgRmlsbFN0eWxlXG57XG4gICAgLyoqXG4gICAgICogVGhlIGhleCBjb2xvciB2YWx1ZSB1c2VkIHdoZW4gY29sb3JpbmcgdGhlIEdyYXBoaWNzIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAweEZGRkZGRlxuICAgICAqL1xuICAgIHB1YmxpYyBjb2xvciA9IDB4RkZGRkZGO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGFscGhhIHZhbHVlIHVzZWQgd2hlbiBmaWxsaW5nIHRoZSBHcmFwaGljcyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMVxuICAgICAqL1xuICAgIHB1YmxpYyBhbHBoYSA9IDEuMDtcblxuICAgIC8qKlxuICAgICAqIFRoZSB0ZXh0dXJlIHRvIGJlIHVzZWQgZm9yIHRoZSBmaWxsLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlfVxuICAgICAqIEBkZWZhdWx0IDBcbiAgICAgKi9cbiAgICBwdWJsaWMgdGV4dHVyZTogVGV4dHVyZSA9IFRleHR1cmUuV0hJVEU7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdHJhbnNmb3JtIGFwbHBpZWQgdG8gdGhlIHRleHR1cmUuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgKiBAZGVmYXVsdCBudWxsXG4gICAgICovXG4gICAgcHVibGljIG1hdHJpeDogTWF0cml4ID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIElmIHRoZSBjdXJyZW50IGZpbGwgaXMgdmlzaWJsZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgKi9cbiAgICBwdWJsaWMgdmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb25lcyB0aGUgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkZpbGxTdHlsZX1cbiAgICAgKi9cbiAgICBwdWJsaWMgY2xvbmUoKTogRmlsbFN0eWxlXG4gICAge1xuICAgICAgICBjb25zdCBvYmogPSBuZXcgRmlsbFN0eWxlKCk7XG5cbiAgICAgICAgb2JqLmNvbG9yID0gdGhpcy5jb2xvcjtcbiAgICAgICAgb2JqLmFscGhhID0gdGhpcy5hbHBoYTtcbiAgICAgICAgb2JqLnRleHR1cmUgPSB0aGlzLnRleHR1cmU7XG4gICAgICAgIG9iai5tYXRyaXggPSB0aGlzLm1hdHJpeDtcbiAgICAgICAgb2JqLnZpc2libGUgPSB0aGlzLnZpc2libGU7XG5cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldFxuICAgICAqL1xuICAgIHB1YmxpYyByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmNvbG9yID0gMHhGRkZGRkY7XG4gICAgICAgIHRoaXMuYWxwaGEgPSAxO1xuICAgICAgICB0aGlzLnRleHR1cmUgPSBUZXh0dXJlLldISVRFO1xuICAgICAgICB0aGlzLm1hdHJpeCA9IG51bGw7XG4gICAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgYW5kIGRvbid0IHVzZSBhZnRlciB0aGlzXG4gICAgICovXG4gICAgcHVibGljIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy50ZXh0dXJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5tYXRyaXggPSBudWxsO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBlYXJjdXQgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmltcG9ydCB0eXBlIHsgSVNoYXBlQnVpbGRDb21tYW5kIH0gZnJvbSAnLi9JU2hhcGVCdWlsZENvbW1hbmQnO1xuaW1wb3J0IHR5cGUgeyBQb2x5Z29uIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogQnVpbGRzIGEgcG9seWdvbiB0byBkcmF3XG4gKlxuICogSWdub3JlZCBmcm9tIGRvY3Mgc2luY2UgaXQgaXMgbm90IGRpcmVjdGx5IGV4cG9zZWQuXG4gKlxuICogQGlnbm9yZVxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7UElYSS5XZWJHTEdyYXBoaWNzRGF0YX0gZ3JhcGhpY3NEYXRhIC0gVGhlIGdyYXBoaWNzIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgbmVjZXNzYXJ5IHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7b2JqZWN0fSB3ZWJHTERhdGEgLSBhbiBvYmplY3QgY29udGFpbmluZyBhbGwgdGhlIFdlYkdMLXNwZWNpZmljIGluZm9ybWF0aW9uIHRvIGNyZWF0ZSB0aGlzIHNoYXBlXG4gKiBAcGFyYW0ge29iamVjdH0gd2ViR0xEYXRhTmF0aXZlTGluZXMgLSBhbiBvYmplY3QgY29udGFpbmluZyBhbGwgdGhlIFdlYkdMLXNwZWNpZmljIGluZm9ybWF0aW9uIHRvIGNyZWF0ZSBuYXRpdmVMaW5lc1xuICovXG5leHBvcnQgY29uc3QgYnVpbGRQb2x5OiBJU2hhcGVCdWlsZENvbW1hbmQgPSB7XG5cbiAgICBidWlsZChncmFwaGljc0RhdGEpXG4gICAge1xuICAgICAgICBncmFwaGljc0RhdGEucG9pbnRzID0gKGdyYXBoaWNzRGF0YS5zaGFwZSBhcyBQb2x5Z29uKS5wb2ludHMuc2xpY2UoKTtcbiAgICB9LFxuXG4gICAgdHJpYW5ndWxhdGUoZ3JhcGhpY3NEYXRhLCBncmFwaGljc0dlb21ldHJ5KVxuICAgIHtcbiAgICAgICAgbGV0IHBvaW50cyA9IGdyYXBoaWNzRGF0YS5wb2ludHM7XG4gICAgICAgIGNvbnN0IGhvbGVzID0gZ3JhcGhpY3NEYXRhLmhvbGVzO1xuICAgICAgICBjb25zdCB2ZXJ0cyA9IGdyYXBoaWNzR2VvbWV0cnkucG9pbnRzO1xuICAgICAgICBjb25zdCBpbmRpY2VzID0gZ3JhcGhpY3NHZW9tZXRyeS5pbmRpY2VzO1xuXG4gICAgICAgIGlmIChwb2ludHMubGVuZ3RoID49IDYpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGhvbGVBcnJheSA9IFtdO1xuICAgICAgICAgICAgLy8gUHJvY2VzcyBob2xlcy4uXG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9sZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgaG9sZSA9IGhvbGVzW2ldO1xuXG4gICAgICAgICAgICAgICAgaG9sZUFycmF5LnB1c2gocG9pbnRzLmxlbmd0aCAvIDIpO1xuICAgICAgICAgICAgICAgIHBvaW50cyA9IHBvaW50cy5jb25jYXQoaG9sZS5wb2ludHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzb3J0IGNvbG9yXG4gICAgICAgICAgICBjb25zdCB0cmlhbmdsZXMgPSBlYXJjdXQocG9pbnRzLCBob2xlQXJyYXksIDIpO1xuXG4gICAgICAgICAgICBpZiAoIXRyaWFuZ2xlcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHZlcnRQb3MgPSB2ZXJ0cy5sZW5ndGggLyAyO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyaWFuZ2xlcy5sZW5ndGg7IGkgKz0gMylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2godHJpYW5nbGVzW2ldICsgdmVydFBvcyk7XG4gICAgICAgICAgICAgICAgaW5kaWNlcy5wdXNoKHRyaWFuZ2xlc1tpICsgMV0gKyB2ZXJ0UG9zKTtcbiAgICAgICAgICAgICAgICBpbmRpY2VzLnB1c2godHJpYW5nbGVzW2kgKyAyXSArIHZlcnRQb3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2ZXJ0cy5wdXNoKHBvaW50c1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxufTtcbiIsICIvLyBmb3IgdHlwZSBvbmx5XG5pbXBvcnQgeyBTSEFQRVMgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuaW1wb3J0IHR5cGUgeyBDaXJjbGUsIEVsbGlwc2UgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgSVNoYXBlQnVpbGRDb21tYW5kIH0gZnJvbSAnLi9JU2hhcGVCdWlsZENvbW1hbmQnO1xuXG4vKipcbiAqIEJ1aWxkcyBhIGNpcmNsZSB0byBkcmF3XG4gKlxuICogSWdub3JlZCBmcm9tIGRvY3Mgc2luY2UgaXQgaXMgbm90IGRpcmVjdGx5IGV4cG9zZWQuXG4gKlxuICogQGlnbm9yZVxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7UElYSS5XZWJHTEdyYXBoaWNzRGF0YX0gZ3JhcGhpY3NEYXRhIC0gVGhlIGdyYXBoaWNzIG9iamVjdCB0byBkcmF3XG4gKiBAcGFyYW0ge29iamVjdH0gd2ViR0xEYXRhIC0gYW4gb2JqZWN0IGNvbnRhaW5pbmcgYWxsIHRoZSBXZWJHTC1zcGVjaWZpYyBpbmZvcm1hdGlvbiB0byBjcmVhdGUgdGhpcyBzaGFwZVxuICogQHBhcmFtIHtvYmplY3R9IHdlYkdMRGF0YU5hdGl2ZUxpbmVzIC0gYW4gb2JqZWN0IGNvbnRhaW5pbmcgYWxsIHRoZSBXZWJHTC1zcGVjaWZpYyBpbmZvcm1hdGlvbiB0byBjcmVhdGUgbmF0aXZlTGluZXNcbiAqL1xuZXhwb3J0IGNvbnN0IGJ1aWxkQ2lyY2xlOiBJU2hhcGVCdWlsZENvbW1hbmQgPSB7XG5cbiAgICBidWlsZChncmFwaGljc0RhdGEpXG4gICAge1xuICAgICAgICAvLyBuZWVkIHRvIGNvbnZlcnQgcG9pbnRzIHRvIGEgbmljZSByZWd1bGFyIGRhdGFcbiAgICAgICAgY29uc3QgY2lyY2xlRGF0YSA9IGdyYXBoaWNzRGF0YS5zaGFwZSBhcyBDaXJjbGU7XG4gICAgICAgIGNvbnN0IHBvaW50cyA9IGdyYXBoaWNzRGF0YS5wb2ludHM7XG4gICAgICAgIGNvbnN0IHggPSBjaXJjbGVEYXRhLng7XG4gICAgICAgIGNvbnN0IHkgPSBjaXJjbGVEYXRhLnk7XG4gICAgICAgIGxldCB3aWR0aDtcbiAgICAgICAgbGV0IGhlaWdodDtcblxuICAgICAgICBwb2ludHMubGVuZ3RoID0gMDtcblxuICAgICAgICAvLyBUT0RPIC0gYml0IGhhY2t5Pz9cbiAgICAgICAgaWYgKGdyYXBoaWNzRGF0YS50eXBlID09PSBTSEFQRVMuQ0lSQylcbiAgICAgICAge1xuICAgICAgICAgICAgd2lkdGggPSBjaXJjbGVEYXRhLnJhZGl1cztcbiAgICAgICAgICAgIGhlaWdodCA9IGNpcmNsZURhdGEucmFkaXVzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZWxsaXBzZURhdGEgPSBncmFwaGljc0RhdGEuc2hhcGUgYXMgRWxsaXBzZTtcblxuICAgICAgICAgICAgd2lkdGggPSBlbGxpcHNlRGF0YS53aWR0aDtcbiAgICAgICAgICAgIGhlaWdodCA9IGVsbGlwc2VEYXRhLmhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3aWR0aCA9PT0gMCB8fCBoZWlnaHQgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0b3RhbFNlZ3MgPSBNYXRoLmZsb29yKDMwICogTWF0aC5zcXJ0KGNpcmNsZURhdGEucmFkaXVzKSlcbiAgICAgICAgICAgIHx8IE1hdGguZmxvb3IoMTUgKiBNYXRoLnNxcnQod2lkdGggKyBoZWlnaHQpKTtcblxuICAgICAgICB0b3RhbFNlZ3MgLz0gMi4zO1xuXG4gICAgICAgIGNvbnN0IHNlZyA9IChNYXRoLlBJICogMikgLyB0b3RhbFNlZ3M7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbFNlZ3MgLSAwLjU7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgcG9pbnRzLnB1c2goXG4gICAgICAgICAgICAgICAgeCArIChNYXRoLnNpbigtc2VnICogaSkgKiB3aWR0aCksXG4gICAgICAgICAgICAgICAgeSArIChNYXRoLmNvcygtc2VnICogaSkgKiBoZWlnaHQpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcG9pbnRzLnB1c2gocG9pbnRzWzBdLCBwb2ludHNbMV0pO1xuICAgIH0sXG5cbiAgICB0cmlhbmd1bGF0ZShncmFwaGljc0RhdGEsIGdyYXBoaWNzR2VvbWV0cnkpXG4gICAge1xuICAgICAgICBjb25zdCBwb2ludHMgPSBncmFwaGljc0RhdGEucG9pbnRzO1xuICAgICAgICBjb25zdCB2ZXJ0cyA9IGdyYXBoaWNzR2VvbWV0cnkucG9pbnRzO1xuICAgICAgICBjb25zdCBpbmRpY2VzID0gZ3JhcGhpY3NHZW9tZXRyeS5pbmRpY2VzO1xuXG4gICAgICAgIGxldCB2ZXJ0UG9zID0gdmVydHMubGVuZ3RoIC8gMjtcbiAgICAgICAgY29uc3QgY2VudGVyID0gdmVydFBvcztcblxuICAgICAgICBjb25zdCBjaXJjbGUgPSAoZ3JhcGhpY3NEYXRhLnNoYXBlKSBhcyBDaXJjbGU7XG4gICAgICAgIGNvbnN0IG1hdHJpeCA9IGdyYXBoaWNzRGF0YS5tYXRyaXg7XG4gICAgICAgIGNvbnN0IHggPSBjaXJjbGUueDtcbiAgICAgICAgY29uc3QgeSA9IGNpcmNsZS55O1xuXG4gICAgICAgIC8vIFB1c2ggY2VudGVyIChzcGVjaWFsIHBvaW50KVxuICAgICAgICB2ZXJ0cy5wdXNoKFxuICAgICAgICAgICAgZ3JhcGhpY3NEYXRhLm1hdHJpeCA/IChtYXRyaXguYSAqIHgpICsgKG1hdHJpeC5jICogeSkgKyBtYXRyaXgudHggOiB4LFxuICAgICAgICAgICAgZ3JhcGhpY3NEYXRhLm1hdHJpeCA/IChtYXRyaXguYiAqIHgpICsgKG1hdHJpeC5kICogeSkgKyBtYXRyaXgudHkgOiB5KTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkgKz0gMilcbiAgICAgICAge1xuICAgICAgICAgICAgdmVydHMucHVzaChwb2ludHNbaV0sIHBvaW50c1tpICsgMV0pO1xuXG4gICAgICAgICAgICAvLyBhZGQgc29tZSB1dnNcbiAgICAgICAgICAgIGluZGljZXMucHVzaCh2ZXJ0UG9zKyssIGNlbnRlciwgdmVydFBvcyk7XG4gICAgICAgIH1cbiAgICB9LFxufTtcbiIsICJpbXBvcnQgdHlwZSB7IElTaGFwZUJ1aWxkQ29tbWFuZCB9IGZyb20gJy4vSVNoYXBlQnVpbGRDb21tYW5kJztcbmltcG9ydCB0eXBlIHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogQnVpbGRzIGEgcmVjdGFuZ2xlIHRvIGRyYXdcbiAqXG4gKiBJZ25vcmVkIGZyb20gZG9jcyBzaW5jZSBpdCBpcyBub3QgZGlyZWN0bHkgZXhwb3NlZC5cbiAqXG4gKiBAaWdub3JlXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLldlYkdMR3JhcGhpY3NEYXRhfSBncmFwaGljc0RhdGEgLSBUaGUgZ3JhcGhpY3Mgb2JqZWN0IGNvbnRhaW5pbmcgYWxsIHRoZSBuZWNlc3NhcnkgcHJvcGVydGllc1xuICogQHBhcmFtIHtvYmplY3R9IHdlYkdMRGF0YSAtIGFuIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgV2ViR0wtc3BlY2lmaWMgaW5mb3JtYXRpb24gdG8gY3JlYXRlIHRoaXMgc2hhcGVcbiAqIEBwYXJhbSB7b2JqZWN0fSB3ZWJHTERhdGFOYXRpdmVMaW5lcyAtIGFuIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgV2ViR0wtc3BlY2lmaWMgaW5mb3JtYXRpb24gdG8gY3JlYXRlIG5hdGl2ZUxpbmVzXG4gKi9cbmV4cG9ydCBjb25zdCBidWlsZFJlY3RhbmdsZTogSVNoYXBlQnVpbGRDb21tYW5kID0ge1xuXG4gICAgYnVpbGQoZ3JhcGhpY3NEYXRhKVxuICAgIHtcbiAgICAgICAgLy8gLS0tIC8vXG4gICAgICAgIC8vIG5lZWQgdG8gY29udmVydCBwb2ludHMgdG8gYSBuaWNlIHJlZ3VsYXIgZGF0YVxuICAgICAgICAvL1xuICAgICAgICBjb25zdCByZWN0RGF0YSA9IGdyYXBoaWNzRGF0YS5zaGFwZSBhcyBSZWN0YW5nbGU7XG4gICAgICAgIGNvbnN0IHggPSByZWN0RGF0YS54O1xuICAgICAgICBjb25zdCB5ID0gcmVjdERhdGEueTtcbiAgICAgICAgY29uc3Qgd2lkdGggPSByZWN0RGF0YS53aWR0aDtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gcmVjdERhdGEuaGVpZ2h0O1xuXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IGdyYXBoaWNzRGF0YS5wb2ludHM7XG5cbiAgICAgICAgcG9pbnRzLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgcG9pbnRzLnB1c2goeCwgeSxcbiAgICAgICAgICAgIHggKyB3aWR0aCwgeSxcbiAgICAgICAgICAgIHggKyB3aWR0aCwgeSArIGhlaWdodCxcbiAgICAgICAgICAgIHgsIHkgKyBoZWlnaHQpO1xuICAgIH0sXG5cbiAgICB0cmlhbmd1bGF0ZShncmFwaGljc0RhdGEsIGdyYXBoaWNzR2VvbWV0cnkpXG4gICAge1xuICAgICAgICBjb25zdCBwb2ludHMgPSBncmFwaGljc0RhdGEucG9pbnRzO1xuICAgICAgICBjb25zdCB2ZXJ0cyA9IGdyYXBoaWNzR2VvbWV0cnkucG9pbnRzO1xuXG4gICAgICAgIGNvbnN0IHZlcnRQb3MgPSB2ZXJ0cy5sZW5ndGggLyAyO1xuXG4gICAgICAgIHZlcnRzLnB1c2gocG9pbnRzWzBdLCBwb2ludHNbMV0sXG4gICAgICAgICAgICBwb2ludHNbMl0sIHBvaW50c1szXSxcbiAgICAgICAgICAgIHBvaW50c1s2XSwgcG9pbnRzWzddLFxuICAgICAgICAgICAgcG9pbnRzWzRdLCBwb2ludHNbNV0pO1xuXG4gICAgICAgIGdyYXBoaWNzR2VvbWV0cnkuaW5kaWNlcy5wdXNoKHZlcnRQb3MsIHZlcnRQb3MgKyAxLCB2ZXJ0UG9zICsgMixcbiAgICAgICAgICAgIHZlcnRQb3MgKyAxLCB2ZXJ0UG9zICsgMiwgdmVydFBvcyArIDMpO1xuICAgIH0sXG59O1xuIiwgImltcG9ydCB7IGVhcmN1dCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuLy8gZm9yIHR5cGUgb25seVxuaW1wb3J0IHR5cGUgeyBJU2hhcGVCdWlsZENvbW1hbmQgfSBmcm9tICcuL0lTaGFwZUJ1aWxkQ29tbWFuZCc7XG5pbXBvcnQgdHlwZSB7IFJvdW5kZWRSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuLyoqXG4gKiBDYWxjdWxhdGUgYSBzaW5nbGUgcG9pbnQgZm9yIGEgcXVhZHJhdGljIGJlemllciBjdXJ2ZS5cbiAqIFV0aWxpdHkgZnVuY3Rpb24gdXNlZCBieSBxdWFkcmF0aWNCZXppZXJDdXJ2ZS5cbiAqIElnbm9yZWQgZnJvbSBkb2NzIHNpbmNlIGl0IGlzIG5vdCBkaXJlY3RseSBleHBvc2VkLlxuICpcbiAqIEBpZ25vcmVcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge251bWJlcn0gbjEgLSBmaXJzdCBudW1iZXJcbiAqIEBwYXJhbSB7bnVtYmVyfSBuMiAtIHNlY29uZCBudW1iZXJcbiAqIEBwYXJhbSB7bnVtYmVyfSBwZXJjIC0gcGVyY2VudGFnZVxuICogQHJldHVybiB7bnVtYmVyfSB0aGUgcmVzdWx0XG4gKlxuICovXG5mdW5jdGlvbiBnZXRQdChuMTogbnVtYmVyLCBuMjogbnVtYmVyLCBwZXJjOiBudW1iZXIpOiBudW1iZXJcbntcbiAgICBjb25zdCBkaWZmID0gbjIgLSBuMTtcblxuICAgIHJldHVybiBuMSArIChkaWZmICogcGVyYyk7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBwb2ludHMgZm9yIGEgcXVhZHJhdGljIGJlemllciBjdXJ2ZS4gKGhlbHBlciBmdW5jdGlvbi4uKVxuICogQmFzZWQgb246IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzc4NTA5Ny9ob3ctZG8taS1pbXBsZW1lbnQtYS1iZXppZXItY3VydmUtaW4tY1xuICpcbiAqIElnbm9yZWQgZnJvbSBkb2NzIHNpbmNlIGl0IGlzIG5vdCBkaXJlY3RseSBleHBvc2VkLlxuICpcbiAqIEBpZ25vcmVcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge251bWJlcn0gZnJvbVggLSBPcmlnaW4gcG9pbnQgeFxuICogQHBhcmFtIHtudW1iZXJ9IGZyb21ZIC0gT3JpZ2luIHBvaW50IHhcbiAqIEBwYXJhbSB7bnVtYmVyfSBjcFggLSBDb250cm9sIHBvaW50IHhcbiAqIEBwYXJhbSB7bnVtYmVyfSBjcFkgLSBDb250cm9sIHBvaW50IHlcbiAqIEBwYXJhbSB7bnVtYmVyfSB0b1ggLSBEZXN0aW5hdGlvbiBwb2ludCB4XG4gKiBAcGFyYW0ge251bWJlcn0gdG9ZIC0gRGVzdGluYXRpb24gcG9pbnQgeVxuICogQHBhcmFtIHtudW1iZXJbXX0gW291dD1bXV0gLSBUaGUgb3V0cHV0IGFycmF5IHRvIGFkZCBwb2ludHMgaW50by4gSWYgbm90IHBhc3NlZCwgYSBuZXcgYXJyYXkgaXMgY3JlYXRlZC5cbiAqIEByZXR1cm4ge251bWJlcltdfSBhbiBhcnJheSBvZiBwb2ludHNcbiAqL1xuZnVuY3Rpb24gcXVhZHJhdGljQmV6aWVyQ3VydmUoXG4gICAgZnJvbVg6IG51bWJlciwgZnJvbVk6IG51bWJlcixcbiAgICBjcFg6IG51bWJlciwgY3BZOiBudW1iZXIsXG4gICAgdG9YOiBudW1iZXIsIHRvWTogbnVtYmVyLFxuICAgIG91dDogQXJyYXk8bnVtYmVyPiA9IFtdKTogQXJyYXk8bnVtYmVyPlxue1xuICAgIGNvbnN0IG4gPSAyMDtcbiAgICBjb25zdCBwb2ludHMgPSBvdXQ7XG5cbiAgICBsZXQgeGEgPSAwO1xuICAgIGxldCB5YSA9IDA7XG4gICAgbGV0IHhiID0gMDtcbiAgICBsZXQgeWIgPSAwO1xuICAgIGxldCB4ID0gMDtcbiAgICBsZXQgeSA9IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPD0gbjsgKytpKVxuICAgIHtcbiAgICAgICAgaiA9IGkgLyBuO1xuXG4gICAgICAgIC8vIFRoZSBHcmVlbiBMaW5lXG4gICAgICAgIHhhID0gZ2V0UHQoZnJvbVgsIGNwWCwgaik7XG4gICAgICAgIHlhID0gZ2V0UHQoZnJvbVksIGNwWSwgaik7XG4gICAgICAgIHhiID0gZ2V0UHQoY3BYLCB0b1gsIGopO1xuICAgICAgICB5YiA9IGdldFB0KGNwWSwgdG9ZLCBqKTtcblxuICAgICAgICAvLyBUaGUgQmxhY2sgRG90XG4gICAgICAgIHggPSBnZXRQdCh4YSwgeGIsIGopO1xuICAgICAgICB5ID0gZ2V0UHQoeWEsIHliLCBqKTtcblxuICAgICAgICBwb2ludHMucHVzaCh4LCB5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcG9pbnRzO1xufVxuXG4vKipcbiAqIEJ1aWxkcyBhIHJvdW5kZWQgcmVjdGFuZ2xlIHRvIGRyYXdcbiAqXG4gKiBJZ25vcmVkIGZyb20gZG9jcyBzaW5jZSBpdCBpcyBub3QgZGlyZWN0bHkgZXhwb3NlZC5cbiAqXG4gKiBAaWdub3JlXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLldlYkdMR3JhcGhpY3NEYXRhfSBncmFwaGljc0RhdGEgLSBUaGUgZ3JhcGhpY3Mgb2JqZWN0IGNvbnRhaW5pbmcgYWxsIHRoZSBuZWNlc3NhcnkgcHJvcGVydGllc1xuICogQHBhcmFtIHtvYmplY3R9IHdlYkdMRGF0YSAtIGFuIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgV2ViR0wtc3BlY2lmaWMgaW5mb3JtYXRpb24gdG8gY3JlYXRlIHRoaXMgc2hhcGVcbiAqIEBwYXJhbSB7b2JqZWN0fSB3ZWJHTERhdGFOYXRpdmVMaW5lcyAtIGFuIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgV2ViR0wtc3BlY2lmaWMgaW5mb3JtYXRpb24gdG8gY3JlYXRlIG5hdGl2ZUxpbmVzXG4gKi9cbmV4cG9ydCBjb25zdCBidWlsZFJvdW5kZWRSZWN0YW5nbGU6IElTaGFwZUJ1aWxkQ29tbWFuZCA9IHtcblxuICAgIGJ1aWxkKGdyYXBoaWNzRGF0YSlcbiAgICB7XG4gICAgICAgIGNvbnN0IHJyZWN0RGF0YSA9IGdyYXBoaWNzRGF0YS5zaGFwZSBhcyBSb3VuZGVkUmVjdGFuZ2xlO1xuICAgICAgICBjb25zdCBwb2ludHMgPSBncmFwaGljc0RhdGEucG9pbnRzO1xuICAgICAgICBjb25zdCB4ID0gcnJlY3REYXRhLng7XG4gICAgICAgIGNvbnN0IHkgPSBycmVjdERhdGEueTtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBycmVjdERhdGEud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHJyZWN0RGF0YS5oZWlnaHQ7XG5cbiAgICAgICAgLy8gRG9uJ3QgYWxsb3cgbmVnYXRpdmUgcmFkaXVzIG9yIGdyZWF0ZXIgdGhhbiBoYWxmIHRoZSBzbWFsbGVzdCB3aWR0aFxuICAgICAgICBjb25zdCByYWRpdXMgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihycmVjdERhdGEucmFkaXVzLCBNYXRoLm1pbih3aWR0aCwgaGVpZ2h0KSAvIDIpKTtcblxuICAgICAgICBwb2ludHMubGVuZ3RoID0gMDtcblxuICAgICAgICAvLyBObyByYWRpdXMsIGRvIGEgc2ltcGxlIHJlY3RhbmdsZVxuICAgICAgICBpZiAoIXJhZGl1cylcbiAgICAgICAge1xuICAgICAgICAgICAgcG9pbnRzLnB1c2goeCwgeSxcbiAgICAgICAgICAgICAgICB4ICsgd2lkdGgsIHksXG4gICAgICAgICAgICAgICAgeCArIHdpZHRoLCB5ICsgaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHgsIHkgKyBoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgcXVhZHJhdGljQmV6aWVyQ3VydmUoeCwgeSArIHJhZGl1cyxcbiAgICAgICAgICAgICAgICB4LCB5LFxuICAgICAgICAgICAgICAgIHggKyByYWRpdXMsIHksXG4gICAgICAgICAgICAgICAgcG9pbnRzKTtcbiAgICAgICAgICAgIHF1YWRyYXRpY0JlemllckN1cnZlKHggKyB3aWR0aCAtIHJhZGl1cyxcbiAgICAgICAgICAgICAgICB5LCB4ICsgd2lkdGgsIHksXG4gICAgICAgICAgICAgICAgeCArIHdpZHRoLCB5ICsgcmFkaXVzLFxuICAgICAgICAgICAgICAgIHBvaW50cyk7XG4gICAgICAgICAgICBxdWFkcmF0aWNCZXppZXJDdXJ2ZSh4ICsgd2lkdGgsIHkgKyBoZWlnaHQgLSByYWRpdXMsXG4gICAgICAgICAgICAgICAgeCArIHdpZHRoLCB5ICsgaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHggKyB3aWR0aCAtIHJhZGl1cywgeSArIGhlaWdodCxcbiAgICAgICAgICAgICAgICBwb2ludHMpO1xuICAgICAgICAgICAgcXVhZHJhdGljQmV6aWVyQ3VydmUoeCArIHJhZGl1cywgeSArIGhlaWdodCxcbiAgICAgICAgICAgICAgICB4LCB5ICsgaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHgsIHkgKyBoZWlnaHQgLSByYWRpdXMsXG4gICAgICAgICAgICAgICAgcG9pbnRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoaXMgdGlueSBudW1iZXIgZGVhbHMgd2l0aCB0aGUgaXNzdWUgdGhhdCBvY2N1cnMgd2hlbiBwb2ludHMgb3ZlcmxhcCBhbmQgZWFyY3V0IGZhaWxzIHRvIHRyaWFuZ3VsYXRlIHRoZSBpdGVtLlxuICAgICAgICAvLyBUT0RPIC0gZml4IHRoaXMgcHJvcGVybHksIHRoaXMgaXMgbm90IHZlcnkgZWxlZ2FudC4uIGJ1dCBpdCB3b3JrcyBmb3Igbm93LlxuICAgIH0sXG5cbiAgICB0cmlhbmd1bGF0ZShncmFwaGljc0RhdGEsIGdyYXBoaWNzR2VvbWV0cnkpXG4gICAge1xuICAgICAgICBjb25zdCBwb2ludHMgPSBncmFwaGljc0RhdGEucG9pbnRzO1xuXG4gICAgICAgIGNvbnN0IHZlcnRzID0gZ3JhcGhpY3NHZW9tZXRyeS5wb2ludHM7XG4gICAgICAgIGNvbnN0IGluZGljZXMgPSBncmFwaGljc0dlb21ldHJ5LmluZGljZXM7XG5cbiAgICAgICAgY29uc3QgdmVjUG9zID0gdmVydHMubGVuZ3RoIC8gMjtcblxuICAgICAgICBjb25zdCB0cmlhbmdsZXMgPSBlYXJjdXQocG9pbnRzLCBudWxsLCAyKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgPCBqOyBpICs9IDMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluZGljZXMucHVzaCh0cmlhbmdsZXNbaV0gKyB2ZWNQb3MpO1xuICAgICAgICAgICAgLy8gICAgIGluZGljZXMucHVzaCh0cmlhbmdsZXNbaV0gKyB2ZWNQb3MpO1xuICAgICAgICAgICAgaW5kaWNlcy5wdXNoKHRyaWFuZ2xlc1tpICsgMV0gKyB2ZWNQb3MpO1xuICAgICAgICAgICAgLy8gICBpbmRpY2VzLnB1c2godHJpYW5nbGVzW2kgKyAyXSArIHZlY1Bvcyk7XG4gICAgICAgICAgICBpbmRpY2VzLnB1c2godHJpYW5nbGVzW2kgKyAyXSArIHZlY1Bvcyk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaiA9IHBvaW50cy5sZW5ndGg7IGkgPCBqOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZlcnRzLnB1c2gocG9pbnRzW2ldLCBwb2ludHNbKytpXSk7XG4gICAgICAgIH1cbiAgICB9LFxufTtcbiIsICJpbXBvcnQgeyBQb2ludCwgU0hBUEVTIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmltcG9ydCB0eXBlIHsgUG9seWdvbiB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHR5cGUgeyBHcmFwaGljc0RhdGEgfSBmcm9tICcuLi9HcmFwaGljc0RhdGEnO1xuaW1wb3J0IHR5cGUgeyBHcmFwaGljc0dlb21ldHJ5IH0gZnJvbSAnLi4vR3JhcGhpY3NHZW9tZXRyeSc7XG5pbXBvcnQgeyBMSU5FX0pPSU4sIExJTkVfQ0FQIH0gZnJvbSAnLi4vY29uc3QnO1xuaW1wb3J0IHsgR1JBUEhJQ1NfQ1VSVkVTIH0gZnJvbSAnLi4vY29uc3QnO1xuXG4vKipcbiAqIEJ1ZmZlcnMgdmVydGljZXMgdG8gZHJhdyBhIHNxdWFyZSBjYXAuXG4gKlxuICogSWdub3JlZCBmcm9tIGRvY3Mgc2luY2UgaXQgaXMgbm90IGRpcmVjdGx5IGV4cG9zZWQuXG4gKlxuICogQGlnbm9yZVxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gWC1jb29yZCBvZiBlbmQgcG9pbnRcbiAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gWS1jb29yZCBvZiBlbmQgcG9pbnRcbiAqIEBwYXJhbSB7bnVtYmVyfSBueCAtIFgtY29vcmQgb2YgbGluZSBub3JtYWwgcG9pbnRpbmcgaW5zaWRlXG4gKiBAcGFyYW0ge251bWJlcn0gbnkgLSBZLWNvb3JkIG9mIGxpbmUgbm9ybWFsIHBvaW50aW5nIGluc2lkZVxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSB2ZXJ0cyAtIHZlcnRleCBidWZmZXJcbiAqIEByZXR1cm5zIHt9XG4gKi9cbmZ1bmN0aW9uIHNxdWFyZShcbiAgICB4OiBudW1iZXIsXG4gICAgeTogbnVtYmVyLFxuICAgIG54OiBudW1iZXIsXG4gICAgbnk6IG51bWJlcixcbiAgICBpbm5lcldlaWdodDogbnVtYmVyLFxuICAgIG91dGVyV2VpZ2h0OiBudW1iZXIsXG4gICAgY2xvY2t3aXNlOiBib29sZWFuLCAvKiByb3RhdGlvbiBmb3Igc3F1YXJlICh0cnVlIGF0IGxlZnQgZW5kLCBmYWxzZSBhdCByaWdodCBlbmQpICovXG4gICAgdmVydHM6IEFycmF5PG51bWJlcj5cbik6IG51bWJlclxue1xuICAgIGNvbnN0IGl4ID0geCAtIChueCAqIGlubmVyV2VpZ2h0KTtcbiAgICBjb25zdCBpeSA9IHkgLSAobnkgKiBpbm5lcldlaWdodCk7XG4gICAgY29uc3Qgb3ggPSB4ICsgKG54ICogb3V0ZXJXZWlnaHQpO1xuICAgIGNvbnN0IG95ID0geSArIChueSAqIG91dGVyV2VpZ2h0KTtcblxuICAgIC8qIFJvdGF0ZSBueCxueSBmb3IgZXh0ZW5zaW9uIHZlY3RvciAqL1xuICAgIGxldCBleHg7IGxldFxuICAgICAgICBleXk7XG5cbiAgICBpZiAoY2xvY2t3aXNlKVxuICAgIHtcbiAgICAgICAgZXh4ID0gbnk7XG4gICAgICAgIGV5eSA9IC1ueDtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgZXh4ID0gLW55O1xuICAgICAgICBleXkgPSBueDtcbiAgICB9XG5cbiAgICAvKiBbaXwwXXgseSBleHRlbmRlZCBhdCBjYXAgKi9cbiAgICBjb25zdCBlaXggPSBpeCArIGV4eDtcbiAgICBjb25zdCBlaXkgPSBpeSArIGV5eTtcbiAgICBjb25zdCBlb3ggPSBveCArIGV4eDtcbiAgICBjb25zdCBlb3kgPSBveSArIGV5eTtcblxuICAgIC8qIFNxdWFyZSBpdHNlbGYgbXVzdCBiZSBpbnNlcnRlZCBjbG9ja3dpc2UqL1xuICAgIHZlcnRzLnB1c2goZWl4LCBlaXkpO1xuICAgIHZlcnRzLnB1c2goZW94LCBlb3kpO1xuXG4gICAgcmV0dXJuIDI7XG59XG5cbi8qKlxuICogQnVmZmVycyB2ZXJ0aWNlcyB0byBkcmF3IGFuIGFyYyBhdCB0aGUgbGluZSBqb2ludCBvciBjYXAuXG4gKlxuICogSWdub3JlZCBmcm9tIGRvY3Mgc2luY2UgaXQgaXMgbm90IGRpcmVjdGx5IGV4cG9zZWQuXG4gKlxuICogQGlnbm9yZVxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7bnVtYmVyfSBjeCAtIFgtY29vcmQgb2YgY2VudGVyXG4gKiBAcGFyYW0ge251bWJlcn0gY3kgLSBZLWNvb3JkIG9mIGNlbnRlclxuICogQHBhcmFtIHtudW1iZXJ9IHN4IC0gWC1jb29yZCBvZiBhcmMgc3RhcnRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzeSAtIFktY29vcmQgb2YgYXJjIHN0YXJ0XG4gKiBAcGFyYW0ge251bWJlcn0gZXggLSBYLWNvb3JkIG9mIGFyYyBlbmRcbiAqIEBwYXJhbSB7bnVtYmVyfSBleSAtIFktY29vcmQgb2YgYXJjIGVuZFxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSB2ZXJ0cyAtIGJ1ZmZlciBvZiB2ZXJ0aWNlc1xuICogQHBhcmFtIHtib29sZWFufSBjbG9ja3dpc2UgLSBvcmllbnRhdGlvbiBvZiB2ZXJ0aWNlc1xuICogQHJldHVybnMge251bWJlcn0gLSBuby4gb2YgdmVydGljZXMgcHVzaGVkXG4gKi9cbmZ1bmN0aW9uIHJvdW5kKFxuICAgIGN4OiBudW1iZXIsXG4gICAgY3k6IG51bWJlcixcbiAgICBzeDogbnVtYmVyLFxuICAgIHN5OiBudW1iZXIsXG4gICAgZXg6IG51bWJlcixcbiAgICBleTogbnVtYmVyLFxuICAgIHZlcnRzOiBBcnJheTxudW1iZXI+LFxuICAgIGNsb2Nrd2lzZTogYm9vbGVhbiwgLyogaWYgbm90IGNhcCwgdGhlbiBjbG9ja3dpc2UgaXMgdHVybiBvZiBqb2ludCwgb3RoZXJ3aXNlIHJvdGF0aW9uIGZyb20gYW5nbGUwIHRvIGFuZ2xlMSAqL1xuKTogbnVtYmVyXG57XG4gICAgY29uc3QgY3gycDB4ID0gc3ggLSBjeDtcbiAgICBjb25zdCBjeTJwMHkgPSBzeSAtIGN5O1xuXG4gICAgbGV0IGFuZ2xlMCA9IE1hdGguYXRhbjIoY3gycDB4LCBjeTJwMHkpO1xuICAgIGxldCBhbmdsZTEgPSBNYXRoLmF0YW4yKGV4IC0gY3gsIGV5IC0gY3kpO1xuXG4gICAgaWYgKGNsb2Nrd2lzZSAmJiBhbmdsZTAgPCBhbmdsZTEpXG4gICAge1xuICAgICAgICBhbmdsZTAgKz0gTWF0aC5QSSAqIDI7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFjbG9ja3dpc2UgJiYgYW5nbGUwID4gYW5nbGUxKVxuICAgIHtcbiAgICAgICAgYW5nbGUxICs9IE1hdGguUEkgKiAyO1xuICAgIH1cblxuICAgIGxldCBzdGFydEFuZ2xlID0gYW5nbGUwO1xuICAgIGNvbnN0IGFuZ2xlRGlmZiA9IGFuZ2xlMSAtIGFuZ2xlMDtcbiAgICBjb25zdCBhYnNBbmdsZURpZmYgPSBNYXRoLmFicyhhbmdsZURpZmYpO1xuXG4gICAgLyogaWYgKGFic0FuZ2xlRGlmZiA+PSBQSV9MQk9VTkQgJiYgYWJzQW5nbGVEaWZmIDw9IFBJX1VCT1VORClcbiAgICB7XG4gICAgICAgIGNvbnN0IHIxeCA9IGN4IC0gbnh0UHg7XG4gICAgICAgIGNvbnN0IHIxeSA9IGN5IC0gbnh0UHk7XG5cbiAgICAgICAgaWYgKHIxeCA9PT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHIxeSA+IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYW5nbGVEaWZmID0gLWFuZ2xlRGlmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyMXggPj0gLUdSQVBISUNTX0NVUlZFUy5lcHNpbG9uKVxuICAgICAgICB7XG4gICAgICAgICAgICBhbmdsZURpZmYgPSAtYW5nbGVEaWZmO1xuICAgICAgICB9XG4gICAgfSovXG5cbiAgICBjb25zdCByYWRpdXMgPSBNYXRoLnNxcnQoKGN4MnAweCAqIGN4MnAweCkgKyAoY3kycDB5ICogY3kycDB5KSk7XG4gICAgY29uc3Qgc2VnQ291bnQgPSAoKDE1ICogYWJzQW5nbGVEaWZmICogTWF0aC5zcXJ0KHJhZGl1cykgLyBNYXRoLlBJKSA+PiAwKSArIDE7XG4gICAgY29uc3QgYW5nbGVJbmMgPSBhbmdsZURpZmYgLyBzZWdDb3VudDtcblxuICAgIHN0YXJ0QW5nbGUgKz0gYW5nbGVJbmM7XG5cbiAgICBpZiAoY2xvY2t3aXNlKVxuICAgIHtcbiAgICAgICAgdmVydHMucHVzaChjeCwgY3kpO1xuICAgICAgICB2ZXJ0cy5wdXNoKHN4LCBzeSk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDEsIGFuZ2xlID0gc3RhcnRBbmdsZTsgaSA8IHNlZ0NvdW50OyBpKyssIGFuZ2xlICs9IGFuZ2xlSW5jKVxuICAgICAgICB7XG4gICAgICAgICAgICB2ZXJ0cy5wdXNoKGN4LCBjeSk7XG4gICAgICAgICAgICB2ZXJ0cy5wdXNoKGN4ICsgKChNYXRoLnNpbihhbmdsZSkgKiByYWRpdXMpKSxcbiAgICAgICAgICAgICAgICBjeSArICgoTWF0aC5jb3MoYW5nbGUpICogcmFkaXVzKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmVydHMucHVzaChjeCwgY3kpO1xuICAgICAgICB2ZXJ0cy5wdXNoKGV4LCBleSk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIHZlcnRzLnB1c2goc3gsIHN5KTtcbiAgICAgICAgdmVydHMucHVzaChjeCwgY3kpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAxLCBhbmdsZSA9IHN0YXJ0QW5nbGU7IGkgPCBzZWdDb3VudDsgaSsrLCBhbmdsZSArPSBhbmdsZUluYylcbiAgICAgICAge1xuICAgICAgICAgICAgdmVydHMucHVzaChjeCArICgoTWF0aC5zaW4oYW5nbGUpICogcmFkaXVzKSksXG4gICAgICAgICAgICAgICAgY3kgKyAoKE1hdGguY29zKGFuZ2xlKSAqIHJhZGl1cykpKTtcbiAgICAgICAgICAgIHZlcnRzLnB1c2goY3gsIGN5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZlcnRzLnB1c2goZXgsIGV5KTtcbiAgICAgICAgdmVydHMucHVzaChjeCwgY3kpO1xuICAgIH1cblxuICAgIHJldHVybiBzZWdDb3VudCAqIDI7XG59XG5cbi8qKlxuICogQnVpbGRzIGEgbGluZSB0byBkcmF3IHVzaW5nIHRoZSBwb2x5Z29uIG1ldGhvZC5cbiAqXG4gKiBJZ25vcmVkIGZyb20gZG9jcyBzaW5jZSBpdCBpcyBub3QgZGlyZWN0bHkgZXhwb3NlZC5cbiAqXG4gKiBAaWdub3JlXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkdyYXBoaWNzRGF0YX0gZ3JhcGhpY3NEYXRhIC0gVGhlIGdyYXBoaWNzIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgbmVjZXNzYXJ5IHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7UElYSS5HcmFwaGljc0dlb21ldHJ5fSBncmFwaGljc0dlb21ldHJ5IC0gR2VvbWV0cnkgd2hlcmUgdG8gYXBwZW5kIG91dHB1dFxuICovXG5mdW5jdGlvbiBidWlsZE5vbk5hdGl2ZUxpbmUoZ3JhcGhpY3NEYXRhOiBHcmFwaGljc0RhdGEsIGdyYXBoaWNzR2VvbWV0cnk6IEdyYXBoaWNzR2VvbWV0cnkpOiB2b2lkXG57XG4gICAgY29uc3Qgc2hhcGUgPSBncmFwaGljc0RhdGEuc2hhcGUgYXMgUG9seWdvbjtcbiAgICBsZXQgcG9pbnRzID0gZ3JhcGhpY3NEYXRhLnBvaW50cyB8fCBzaGFwZS5wb2ludHMuc2xpY2UoKTtcbiAgICBjb25zdCBlcHMgPSBncmFwaGljc0dlb21ldHJ5LmNsb3NlUG9pbnRFcHM7XG5cbiAgICBpZiAocG9pbnRzLmxlbmd0aCA9PT0gMClcbiAgICB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gaWYgdGhlIGxpbmUgd2lkdGggaXMgYW4gb2RkIG51bWJlciBhZGQgMC41IHRvIGFsaWduIHRvIGEgd2hvbGUgcGl4ZWxcbiAgICAvLyBjb21tZW50aW5nIHRoaXMgb3V0IGZpeGVzICM3MTEgYW5kICMxNjIwXG4gICAgLy8gaWYgKGdyYXBoaWNzRGF0YS5saW5lV2lkdGglMilcbiAgICAvLyB7XG4gICAgLy8gICAgIGZvciAoaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspXG4gICAgLy8gICAgIHtcbiAgICAvLyAgICAgICAgIHBvaW50c1tpXSArPSAwLjU7XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG5cbiAgICBjb25zdCBzdHlsZSA9IGdyYXBoaWNzRGF0YS5saW5lU3R5bGU7XG5cbiAgICAvLyBnZXQgZmlyc3QgYW5kIGxhc3QgcG9pbnQuLiBmaWd1cmUgb3V0IHRoZSBtaWRkbGUhXG4gICAgY29uc3QgZmlyc3RQb2ludCA9IG5ldyBQb2ludChwb2ludHNbMF0sIHBvaW50c1sxXSk7XG4gICAgY29uc3QgbGFzdFBvaW50ID0gbmV3IFBvaW50KHBvaW50c1twb2ludHMubGVuZ3RoIC0gMl0sIHBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0pO1xuICAgIGNvbnN0IGNsb3NlZFNoYXBlID0gc2hhcGUudHlwZSAhPT0gU0hBUEVTLlBPTFkgfHwgc2hhcGUuY2xvc2VTdHJva2U7XG4gICAgY29uc3QgY2xvc2VkUGF0aCA9IE1hdGguYWJzKGZpcnN0UG9pbnQueCAtIGxhc3RQb2ludC54KSA8IGVwc1xuICAgICAgICAmJiBNYXRoLmFicyhmaXJzdFBvaW50LnkgLSBsYXN0UG9pbnQueSkgPCBlcHM7XG5cbiAgICAvLyBpZiB0aGUgZmlyc3QgcG9pbnQgaXMgdGhlIGxhc3QgcG9pbnQgLSBnb25uYSBoYXZlIGlzc3VlcyA6KVxuICAgIGlmIChjbG9zZWRTaGFwZSlcbiAgICB7XG4gICAgICAgIC8vIG5lZWQgdG8gY2xvbmUgYXMgd2UgYXJlIGdvaW5nIHRvIHNsaWdodGx5IG1vZGlmeSB0aGUgc2hhcGUuLlxuICAgICAgICBwb2ludHMgPSBwb2ludHMuc2xpY2UoKTtcblxuICAgICAgICBpZiAoY2xvc2VkUGF0aClcbiAgICAgICAge1xuICAgICAgICAgICAgcG9pbnRzLnBvcCgpO1xuICAgICAgICAgICAgcG9pbnRzLnBvcCgpO1xuICAgICAgICAgICAgbGFzdFBvaW50LnNldChwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDJdLCBwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG1pZFBvaW50WCA9IChmaXJzdFBvaW50LnggKyBsYXN0UG9pbnQueCkgKiAwLjU7XG4gICAgICAgIGNvbnN0IG1pZFBvaW50WSA9IChsYXN0UG9pbnQueSArIGZpcnN0UG9pbnQueSkgKiAwLjU7XG5cbiAgICAgICAgcG9pbnRzLnVuc2hpZnQobWlkUG9pbnRYLCBtaWRQb2ludFkpO1xuICAgICAgICBwb2ludHMucHVzaChtaWRQb2ludFgsIG1pZFBvaW50WSk7XG4gICAgfVxuXG4gICAgY29uc3QgdmVydHMgPSBncmFwaGljc0dlb21ldHJ5LnBvaW50cztcbiAgICBjb25zdCBsZW5ndGggPSBwb2ludHMubGVuZ3RoIC8gMjtcbiAgICBsZXQgaW5kZXhDb3VudCA9IHBvaW50cy5sZW5ndGg7XG4gICAgY29uc3QgaW5kZXhTdGFydCA9IHZlcnRzLmxlbmd0aCAvIDI7XG5cbiAgICAvLyBNYXguIGlubmVyIGFuZCBvdXRlciB3aWR0aFxuICAgIGNvbnN0IHdpZHRoID0gc3R5bGUud2lkdGggLyAyO1xuICAgIGNvbnN0IHdpZHRoU3F1YXJlZCA9IHdpZHRoICogd2lkdGg7XG4gICAgY29uc3QgbWl0ZXJMaW1pdFNxdWFyZWQgPSBzdHlsZS5taXRlckxpbWl0ICogc3R5bGUubWl0ZXJMaW1pdDtcblxuICAgIC8qIExpbmUgc2VnbWVudHMgb2YgaW50ZXJlc3Qgd2hlcmUgKHgxLHkxKSBmb3JtcyB0aGUgY29ybmVyLiAqL1xuICAgIGxldCB4MCA9IHBvaW50c1swXTtcbiAgICBsZXQgeTAgPSBwb2ludHNbMV07XG4gICAgbGV0IHgxID0gcG9pbnRzWzJdO1xuICAgIGxldCB5MSA9IHBvaW50c1szXTtcbiAgICBsZXQgeDIgPSAwO1xuICAgIGxldCB5MiA9IDA7XG5cbiAgICAvKiBwZXJwWz9dKHh8eSkgPSB0aGUgbGluZSBub3JtYWwgd2l0aCBtYWduaXR1ZGUgbGluZVdpZHRoLiAqL1xuICAgIGxldCBwZXJweCA9IC0oeTAgLSB5MSk7XG4gICAgbGV0IHBlcnB5ID0geDAgLSB4MTtcbiAgICBsZXQgcGVycDF4ID0gMDtcbiAgICBsZXQgcGVycDF5ID0gMDtcblxuICAgIGxldCBkaXN0ID0gTWF0aC5zcXJ0KChwZXJweCAqIHBlcnB4KSArIChwZXJweSAqIHBlcnB5KSk7XG5cbiAgICBwZXJweCAvPSBkaXN0O1xuICAgIHBlcnB5IC89IGRpc3Q7XG4gICAgcGVycHggKj0gd2lkdGg7XG4gICAgcGVycHkgKj0gd2lkdGg7XG5cbiAgICBjb25zdCByYXRpbyA9IHN0eWxlLmFsaWdubWVudDsvLyAwLjU7XG4gICAgY29uc3QgaW5uZXJXZWlnaHQgPSAoMSAtIHJhdGlvKSAqIDI7XG4gICAgY29uc3Qgb3V0ZXJXZWlnaHQgPSByYXRpbyAqIDI7XG5cbiAgICBpZiAoIWNsb3NlZFNoYXBlKVxuICAgIHtcbiAgICAgICAgaWYgKHN0eWxlLmNhcCA9PT0gTElORV9DQVAuUk9VTkQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluZGV4Q291bnQgKz0gcm91bmQoXG4gICAgICAgICAgICAgICAgeDAgLSAocGVycHggKiAoaW5uZXJXZWlnaHQgLSBvdXRlcldlaWdodCkgKiAwLjUpLFxuICAgICAgICAgICAgICAgIHkwIC0gKHBlcnB5ICogKGlubmVyV2VpZ2h0IC0gb3V0ZXJXZWlnaHQpICogMC41KSxcbiAgICAgICAgICAgICAgICB4MCAtIChwZXJweCAqIGlubmVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICB5MCAtIChwZXJweSAqIGlubmVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICB4MCArIChwZXJweCAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICB5MCArIChwZXJweSAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICB2ZXJ0cyxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgKSArIDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3R5bGUuY2FwID09PSBMSU5FX0NBUC5TUVVBUkUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluZGV4Q291bnQgKz0gc3F1YXJlKHgwLCB5MCwgcGVycHgsIHBlcnB5LCBpbm5lcldlaWdodCwgb3V0ZXJXZWlnaHQsIHRydWUsIHZlcnRzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFB1c2ggZmlyc3QgcG9pbnQgKGJlbG93ICYgYWJvdmUgdmVydGljZXMpXG4gICAgdmVydHMucHVzaChcbiAgICAgICAgeDAgLSAocGVycHggKiBpbm5lcldlaWdodCksXG4gICAgICAgIHkwIC0gKHBlcnB5ICogaW5uZXJXZWlnaHQpKTtcbiAgICB2ZXJ0cy5wdXNoKFxuICAgICAgICB4MCArIChwZXJweCAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgeTAgKyAocGVycHkgKiBvdXRlcldlaWdodCkpO1xuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsZW5ndGggLSAxOyArK2kpXG4gICAge1xuICAgICAgICB4MCA9IHBvaW50c1soaSAtIDEpICogMl07XG4gICAgICAgIHkwID0gcG9pbnRzWygoaSAtIDEpICogMikgKyAxXTtcblxuICAgICAgICB4MSA9IHBvaW50c1tpICogMl07XG4gICAgICAgIHkxID0gcG9pbnRzWyhpICogMikgKyAxXTtcblxuICAgICAgICB4MiA9IHBvaW50c1soaSArIDEpICogMl07XG4gICAgICAgIHkyID0gcG9pbnRzWygoaSArIDEpICogMikgKyAxXTtcblxuICAgICAgICBwZXJweCA9IC0oeTAgLSB5MSk7XG4gICAgICAgIHBlcnB5ID0geDAgLSB4MTtcblxuICAgICAgICBkaXN0ID0gTWF0aC5zcXJ0KChwZXJweCAqIHBlcnB4KSArIChwZXJweSAqIHBlcnB5KSk7XG4gICAgICAgIHBlcnB4IC89IGRpc3Q7XG4gICAgICAgIHBlcnB5IC89IGRpc3Q7XG4gICAgICAgIHBlcnB4ICo9IHdpZHRoO1xuICAgICAgICBwZXJweSAqPSB3aWR0aDtcblxuICAgICAgICBwZXJwMXggPSAtKHkxIC0geTIpO1xuICAgICAgICBwZXJwMXkgPSB4MSAtIHgyO1xuXG4gICAgICAgIGRpc3QgPSBNYXRoLnNxcnQoKHBlcnAxeCAqIHBlcnAxeCkgKyAocGVycDF5ICogcGVycDF5KSk7XG4gICAgICAgIHBlcnAxeCAvPSBkaXN0O1xuICAgICAgICBwZXJwMXkgLz0gZGlzdDtcbiAgICAgICAgcGVycDF4ICo9IHdpZHRoO1xuICAgICAgICBwZXJwMXkgKj0gd2lkdGg7XG5cbiAgICAgICAgLyogZFt4fHldKDB8MSkgPSB0aGUgY29tcG9uZW50IGRpc3BsYWNtZW50IGJldHdlZW4gcG9pbnRzIHAoMCwxfDEsMikgKi9cbiAgICAgICAgY29uc3QgZHgwID0geDEgLSB4MDtcbiAgICAgICAgY29uc3QgZHkwID0geTAgLSB5MTtcbiAgICAgICAgY29uc3QgZHgxID0geDEgLSB4MjtcbiAgICAgICAgY29uc3QgZHkxID0geTIgLSB5MTtcblxuICAgICAgICAvKiArdmUgaWYgaW50ZXJuYWwgYW5nbGUgY291bnRlcmNsb2Nrd2lzZSwgLXZlIGlmIGludGVybmFsIGFuZ2xlIGNsb2Nrd2lzZS4gKi9cbiAgICAgICAgY29uc3QgY3Jvc3MgPSAoZHkwICogZHgxKSAtIChkeTEgKiBkeDApO1xuICAgICAgICBjb25zdCBjbG9ja3dpc2UgPSAoY3Jvc3MgPCAwKTtcblxuICAgICAgICAvKiBHb2luZyBuZWFybHkgc3RyYWlnaHQ/ICovXG4gICAgICAgIGlmIChNYXRoLmFicyhjcm9zcykgPCAwLjEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZlcnRzLnB1c2goXG4gICAgICAgICAgICAgICAgeDEgLSAocGVycHggKiBpbm5lcldlaWdodCksXG4gICAgICAgICAgICAgICAgeTEgLSAocGVycHkgKiBpbm5lcldlaWdodCkpO1xuICAgICAgICAgICAgdmVydHMucHVzaChcbiAgICAgICAgICAgICAgICB4MSArIChwZXJweCAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICB5MSArIChwZXJweSAqIG91dGVyV2VpZ2h0KSk7XG5cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcFt4fHldIGlzIHRoZSBtaXRlciBwb2ludC4gcGRpc3QgaXMgdGhlIGRpc3RhbmNlIGJldHdlZW4gbWl0ZXIgcG9pbnQgYW5kIHAxLiAqL1xuICAgICAgICBjb25zdCBjMSA9ICgoLXBlcnB4ICsgeDApICogKC1wZXJweSArIHkxKSkgLSAoKC1wZXJweCArIHgxKSAqICgtcGVycHkgKyB5MCkpO1xuICAgICAgICBjb25zdCBjMiA9ICgoLXBlcnAxeCArIHgyKSAqICgtcGVycDF5ICsgeTEpKSAtICgoLXBlcnAxeCArIHgxKSAqICgtcGVycDF5ICsgeTIpKTtcbiAgICAgICAgY29uc3QgcHggPSAoKGR4MCAqIGMyKSAtIChkeDEgKiBjMSkpIC8gY3Jvc3M7XG4gICAgICAgIGNvbnN0IHB5ID0gKChkeTEgKiBjMSkgLSAoZHkwICogYzIpKSAvIGNyb3NzO1xuICAgICAgICBjb25zdCBwZGlzdCA9ICgocHggLSB4MSkgKiAocHggLSB4MSkpICsgKChweSAtIHkxKSAqIChweSAtIHkxKSk7XG5cbiAgICAgICAgLyogSW5uZXIgbWl0ZXIgcG9pbnQgKi9cbiAgICAgICAgY29uc3QgaW14ID0geDEgKyAoKHB4IC0geDEpICogaW5uZXJXZWlnaHQpO1xuICAgICAgICBjb25zdCBpbXkgPSB5MSArICgocHkgLSB5MSkgKiBpbm5lcldlaWdodCk7XG4gICAgICAgIC8qIE91dGVyIG1pdGVyIHBvaW50ICovXG4gICAgICAgIGNvbnN0IG9teCA9IHgxIC0gKChweCAtIHgxKSAqIG91dGVyV2VpZ2h0KTtcbiAgICAgICAgY29uc3Qgb215ID0geTEgLSAoKHB5IC0geTEpICogb3V0ZXJXZWlnaHQpO1xuXG4gICAgICAgIC8qIElzIHRoZSBpbnNpZGUgbWl0ZXIgcG9pbnQgdG9vIGZhciBhd2F5LCBjcmVhdGluZyBhIHNwaWtlPyAqL1xuICAgICAgICBjb25zdCBzbWFsbGVySW5zaWRlU2VnbWVudFNxID0gTWF0aC5taW4oKGR4MCAqIGR4MCkgKyAoZHkwICogZHkwKSwgKGR4MSAqIGR4MSkgKyAoZHkxICogZHkxKSk7XG4gICAgICAgIGNvbnN0IGluc2lkZVdlaWdodCA9IGNsb2Nrd2lzZSA/IGlubmVyV2VpZ2h0IDogb3V0ZXJXZWlnaHQ7XG4gICAgICAgIGNvbnN0IHNtYWxsZXJJbnNpZGVEaWFnb25hbFNxID0gc21hbGxlckluc2lkZVNlZ21lbnRTcSArIChpbnNpZGVXZWlnaHQgKiBpbnNpZGVXZWlnaHQgKiB3aWR0aFNxdWFyZWQpO1xuICAgICAgICBjb25zdCBpbnNpZGVNaXRlck9rID0gcGRpc3QgPD0gc21hbGxlckluc2lkZURpYWdvbmFsU3E7XG5cbiAgICAgICAgaWYgKGluc2lkZU1pdGVyT2spXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChzdHlsZS5qb2luID09PSBMSU5FX0pPSU4uQkVWRUwgfHwgcGRpc3QgLyB3aWR0aFNxdWFyZWQgPiBtaXRlckxpbWl0U3F1YXJlZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoY2xvY2t3aXNlKSAvKiByb3RhdGluZyBhdCBpbm5lciBhbmdsZSAqL1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChpbXgsIGlteSk7Ly8gaW5uZXIgbWl0ZXIgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaCh4MSArIChwZXJweCAqIG91dGVyV2VpZ2h0KSwgeTEgKyAocGVycHkgKiBvdXRlcldlaWdodCkpOy8vIGZpcnN0IHNlZ21lbnQncyBvdXRlciB2ZXJ0ZXhcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChpbXgsIGlteSk7Ly8gaW5uZXIgbWl0ZXIgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaCh4MSArIChwZXJwMXggKiBvdXRlcldlaWdodCksIHkxICsgKHBlcnAxeSAqIG91dGVyV2VpZ2h0KSk7Ly8gc2Vjb25kIHNlZ21lbnQncyBvdXRlciB2ZXJ0ZXhcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSAvKiByb3RhdGluZyBhdCBvdXRlciBhbmdsZSAqL1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaCh4MSAtIChwZXJweCAqIGlubmVyV2VpZ2h0KSwgeTEgLSAocGVycHkgKiBpbm5lcldlaWdodCkpOy8vIGZpcnN0IHNlZ21lbnQncyBpbm5lciB2ZXJ0ZXhcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChvbXgsIG9teSk7Ly8gb3V0ZXIgbWl0ZXIgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaCh4MSAtIChwZXJwMXggKiBpbm5lcldlaWdodCksIHkxIC0gKHBlcnAxeSAqIGlubmVyV2VpZ2h0KSk7Ly8gc2Vjb25kIHNlZ21lbnQncyBvdXRlciB2ZXJ0ZXhcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChvbXgsIG9teSk7Ly8gb3V0ZXIgbWl0ZXIgcG9pbnRcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpbmRleENvdW50ICs9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdHlsZS5qb2luID09PSBMSU5FX0pPSU4uUk9VTkQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGNsb2Nrd2lzZSkgLyogYXJjIGlzIG91dHNpZGUgKi9cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRzLnB1c2goaW14LCBpbXkpO1xuICAgICAgICAgICAgICAgICAgICB2ZXJ0cy5wdXNoKHgxICsgKHBlcnB4ICogb3V0ZXJXZWlnaHQpLCB5MSArIChwZXJweSAqIG91dGVyV2VpZ2h0KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW5kZXhDb3VudCArPSByb3VuZChcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxLCB5MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxICsgKHBlcnB4ICogb3V0ZXJXZWlnaHQpLCB5MSArIChwZXJweSAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxICsgKHBlcnAxeCAqIG91dGVyV2VpZ2h0KSwgeTEgKyAocGVycDF5ICogb3V0ZXJXZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydHMsIHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSArIDQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChpbXgsIGlteSk7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRzLnB1c2goeDEgKyAocGVycDF4ICogb3V0ZXJXZWlnaHQpLCB5MSArIChwZXJwMXkgKiBvdXRlcldlaWdodCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIC8qIGFyYyBpcyBpbnNpZGUgKi9cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRzLnB1c2goeDEgLSAocGVycHggKiBpbm5lcldlaWdodCksIHkxIC0gKHBlcnB5ICogaW5uZXJXZWlnaHQpKTtcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChvbXgsIG9teSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW5kZXhDb3VudCArPSByb3VuZChcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxLCB5MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxIC0gKHBlcnB4ICogaW5uZXJXZWlnaHQpLCB5MSAtIChwZXJweSAqIGlubmVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxIC0gKHBlcnAxeCAqIGlubmVyV2VpZ2h0KSwgeTEgLSAocGVycDF5ICogaW5uZXJXZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydHMsIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICkgKyA0O1xuXG4gICAgICAgICAgICAgICAgICAgIHZlcnRzLnB1c2goeDEgLSAocGVycDF4ICogaW5uZXJXZWlnaHQpLCB5MSAtIChwZXJwMXkgKiBpbm5lcldlaWdodCkpO1xuICAgICAgICAgICAgICAgICAgICB2ZXJ0cy5wdXNoKG9teCwgb215KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmVydHMucHVzaChpbXgsIGlteSk7XG4gICAgICAgICAgICAgICAgdmVydHMucHVzaChvbXgsIG9teSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSAvLyBpbnNpZGUgbWl0ZXIgaXMgTk9UIG9rXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZlcnRzLnB1c2goeDEgLSAocGVycHggKiBpbm5lcldlaWdodCksIHkxIC0gKHBlcnB5ICogaW5uZXJXZWlnaHQpKTsgLy8gZmlyc3Qgc2VnbWVudCdzIGlubmVyIHZlcnRleFxuICAgICAgICAgICAgdmVydHMucHVzaCh4MSArIChwZXJweCAqIG91dGVyV2VpZ2h0KSwgeTEgKyAocGVycHkgKiBvdXRlcldlaWdodCkpOyAvLyBmaXJzdCBzZWdtZW50J3Mgb3V0ZXIgdmVydGV4XG4gICAgICAgICAgICBpZiAoc3R5bGUuam9pbiA9PT0gTElORV9KT0lOLkJFVkVMIHx8IHBkaXN0IC8gd2lkdGhTcXVhcmVkID4gbWl0ZXJMaW1pdFNxdWFyZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gTm90aGluZyBuZWVkZWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHN0eWxlLmpvaW4gPT09IExJTkVfSk9JTi5ST1VORClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoY2xvY2t3aXNlKSAvKiBhcmMgaXMgb3V0c2lkZSAqL1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhDb3VudCArPSByb3VuZChcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxLCB5MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxICsgKHBlcnB4ICogb3V0ZXJXZWlnaHQpLCB5MSArIChwZXJweSAqIG91dGVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxICsgKHBlcnAxeCAqIG91dGVyV2VpZ2h0KSwgeTEgKyAocGVycDF5ICogb3V0ZXJXZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydHMsIHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSArIDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgLyogYXJjIGlzIGluc2lkZSAqL1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhDb3VudCArPSByb3VuZChcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxLCB5MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxIC0gKHBlcnB4ICogaW5uZXJXZWlnaHQpLCB5MSAtIChwZXJweSAqIGlubmVyV2VpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHgxIC0gKHBlcnAxeCAqIGlubmVyV2VpZ2h0KSwgeTEgLSAocGVycDF5ICogaW5uZXJXZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmVydHMsIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICkgKyAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoY2xvY2t3aXNlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChvbXgsIG9teSk7IC8vIGlubmVyIG1pdGVyIHBvaW50XG4gICAgICAgICAgICAgICAgICAgIHZlcnRzLnB1c2gob214LCBvbXkpOyAvLyBpbm5lciBtaXRlciBwb2ludFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2ZXJ0cy5wdXNoKGlteCwgaW15KTsgLy8gb3V0ZXIgbWl0ZXIgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgdmVydHMucHVzaChpbXgsIGlteSk7IC8vIG91dGVyIG1pdGVyIHBvaW50XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluZGV4Q291bnQgKz0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZlcnRzLnB1c2goeDEgLSAocGVycDF4ICogaW5uZXJXZWlnaHQpLCB5MSAtIChwZXJwMXkgKiBpbm5lcldlaWdodCkpOyAvLyBzZWNvbmQgc2VnbWVudCdzIGlubmVyIHZlcnRleFxuICAgICAgICAgICAgdmVydHMucHVzaCh4MSArIChwZXJwMXggKiBvdXRlcldlaWdodCksIHkxICsgKHBlcnAxeSAqIG91dGVyV2VpZ2h0KSk7IC8vIHNlY29uZCBzZWdtZW50J3Mgb3V0ZXIgdmVydGV4XG4gICAgICAgICAgICBpbmRleENvdW50ICs9IDI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB4MCA9IHBvaW50c1sobGVuZ3RoIC0gMikgKiAyXTtcbiAgICB5MCA9IHBvaW50c1soKGxlbmd0aCAtIDIpICogMikgKyAxXTtcblxuICAgIHgxID0gcG9pbnRzWyhsZW5ndGggLSAxKSAqIDJdO1xuICAgIHkxID0gcG9pbnRzWygobGVuZ3RoIC0gMSkgKiAyKSArIDFdO1xuXG4gICAgcGVycHggPSAtKHkwIC0geTEpO1xuICAgIHBlcnB5ID0geDAgLSB4MTtcblxuICAgIGRpc3QgPSBNYXRoLnNxcnQoKHBlcnB4ICogcGVycHgpICsgKHBlcnB5ICogcGVycHkpKTtcbiAgICBwZXJweCAvPSBkaXN0O1xuICAgIHBlcnB5IC89IGRpc3Q7XG4gICAgcGVycHggKj0gd2lkdGg7XG4gICAgcGVycHkgKj0gd2lkdGg7XG5cbiAgICB2ZXJ0cy5wdXNoKHgxIC0gKHBlcnB4ICogaW5uZXJXZWlnaHQpLCB5MSAtIChwZXJweSAqIGlubmVyV2VpZ2h0KSk7XG4gICAgdmVydHMucHVzaCh4MSArIChwZXJweCAqIG91dGVyV2VpZ2h0KSwgeTEgKyAocGVycHkgKiBvdXRlcldlaWdodCkpO1xuXG4gICAgaWYgKCFjbG9zZWRTaGFwZSlcbiAgICB7XG4gICAgICAgIGlmIChzdHlsZS5jYXAgPT09IExJTkVfQ0FQLlJPVU5EKVxuICAgICAgICB7XG4gICAgICAgICAgICBpbmRleENvdW50ICs9IHJvdW5kKFxuICAgICAgICAgICAgICAgIHgxIC0gKHBlcnB4ICogKGlubmVyV2VpZ2h0IC0gb3V0ZXJXZWlnaHQpICogMC41KSxcbiAgICAgICAgICAgICAgICB5MSAtIChwZXJweSAqIChpbm5lcldlaWdodCAtIG91dGVyV2VpZ2h0KSAqIDAuNSksXG4gICAgICAgICAgICAgICAgeDEgLSAocGVycHggKiBpbm5lcldlaWdodCksXG4gICAgICAgICAgICAgICAgeTEgLSAocGVycHkgKiBpbm5lcldlaWdodCksXG4gICAgICAgICAgICAgICAgeDEgKyAocGVycHggKiBvdXRlcldlaWdodCksXG4gICAgICAgICAgICAgICAgeTEgKyAocGVycHkgKiBvdXRlcldlaWdodCksXG4gICAgICAgICAgICAgICAgdmVydHMsXG4gICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICkgKyAyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN0eWxlLmNhcCA9PT0gTElORV9DQVAuU1FVQVJFKVxuICAgICAgICB7XG4gICAgICAgICAgICBpbmRleENvdW50ICs9IHNxdWFyZSh4MSwgeTEsIHBlcnB4LCBwZXJweSwgaW5uZXJXZWlnaHQsIG91dGVyV2VpZ2h0LCBmYWxzZSwgdmVydHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaW5kaWNlcyA9IGdyYXBoaWNzR2VvbWV0cnkuaW5kaWNlcztcbiAgICBjb25zdCBlcHMyID0gR1JBUEhJQ1NfQ1VSVkVTLmVwc2lsb24gKiBHUkFQSElDU19DVVJWRVMuZXBzaWxvbjtcblxuICAgIC8vIGluZGljZXMucHVzaChpbmRleFN0YXJ0KTtcbiAgICBmb3IgKGxldCBpID0gaW5kZXhTdGFydDsgaSA8IGluZGV4Q291bnQgKyBpbmRleFN0YXJ0IC0gMjsgKytpKVxuICAgIHtcbiAgICAgICAgeDAgPSB2ZXJ0c1soaSAqIDIpXTtcbiAgICAgICAgeTAgPSB2ZXJ0c1soaSAqIDIpICsgMV07XG5cbiAgICAgICAgeDEgPSB2ZXJ0c1soaSArIDEpICogMl07XG4gICAgICAgIHkxID0gdmVydHNbKChpICsgMSkgKiAyKSArIDFdO1xuXG4gICAgICAgIHgyID0gdmVydHNbKGkgKyAyKSAqIDJdO1xuICAgICAgICB5MiA9IHZlcnRzWygoaSArIDIpICogMikgKyAxXTtcblxuICAgICAgICAvKiBTa2lwIHplcm8gYXJlYSB0cmlhbmdsZXMgKi9cbiAgICAgICAgaWYgKE1hdGguYWJzKCh4MCAqICh5MSAtIHkyKSkgKyAoeDEgKiAoeTIgLSB5MCkpICsgKHgyICogKHkwIC0geTEpKSkgPCBlcHMyKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluZGljZXMucHVzaChpLCBpICsgMSwgaSArIDIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBCdWlsZHMgYSBsaW5lIHRvIGRyYXcgdXNpbmcgdGhlIGdsLmRyYXdBcnJheXMoZ2wuTElORVMpIG1ldGhvZFxuICpcbiAqIElnbm9yZWQgZnJvbSBkb2NzIHNpbmNlIGl0IGlzIG5vdCBkaXJlY3RseSBleHBvc2VkLlxuICpcbiAqIEBpZ25vcmVcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge1BJWEkuR3JhcGhpY3NEYXRhfSBncmFwaGljc0RhdGEgLSBUaGUgZ3JhcGhpY3Mgb2JqZWN0IGNvbnRhaW5pbmcgYWxsIHRoZSBuZWNlc3NhcnkgcHJvcGVydGllc1xuICogQHBhcmFtIHtQSVhJLkdyYXBoaWNzR2VvbWV0cnl9IGdyYXBoaWNzR2VvbWV0cnkgLSBHZW9tZXRyeSB3aGVyZSB0byBhcHBlbmQgb3V0cHV0XG4gKi9cbmZ1bmN0aW9uIGJ1aWxkTmF0aXZlTGluZShncmFwaGljc0RhdGE6IEdyYXBoaWNzRGF0YSwgZ3JhcGhpY3NHZW9tZXRyeTogR3JhcGhpY3NHZW9tZXRyeSk6IHZvaWRcbntcbiAgICBsZXQgaSA9IDA7XG5cbiAgICBjb25zdCBzaGFwZSA9IGdyYXBoaWNzRGF0YS5zaGFwZSBhcyBQb2x5Z29uO1xuICAgIGNvbnN0IHBvaW50cyA9IGdyYXBoaWNzRGF0YS5wb2ludHMgfHwgc2hhcGUucG9pbnRzO1xuICAgIGNvbnN0IGNsb3NlZFNoYXBlID0gc2hhcGUudHlwZSAhPT0gU0hBUEVTLlBPTFkgfHwgc2hhcGUuY2xvc2VTdHJva2U7XG5cbiAgICBpZiAocG9pbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgdmVydHMgPSBncmFwaGljc0dlb21ldHJ5LnBvaW50cztcbiAgICBjb25zdCBpbmRpY2VzID0gZ3JhcGhpY3NHZW9tZXRyeS5pbmRpY2VzO1xuICAgIGNvbnN0IGxlbmd0aCA9IHBvaW50cy5sZW5ndGggLyAyO1xuXG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IHZlcnRzLmxlbmd0aCAvIDI7XG4gICAgbGV0IGN1cnJlbnRJbmRleCA9IHN0YXJ0SW5kZXg7XG5cbiAgICB2ZXJ0cy5wdXNoKHBvaW50c1swXSwgcG9pbnRzWzFdKTtcblxuICAgIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7IGkrKylcbiAgICB7XG4gICAgICAgIHZlcnRzLnB1c2gocG9pbnRzW2kgKiAyXSwgcG9pbnRzWyhpICogMikgKyAxXSk7XG4gICAgICAgIGluZGljZXMucHVzaChjdXJyZW50SW5kZXgsIGN1cnJlbnRJbmRleCArIDEpO1xuXG4gICAgICAgIGN1cnJlbnRJbmRleCsrO1xuICAgIH1cblxuICAgIGlmIChjbG9zZWRTaGFwZSlcbiAgICB7XG4gICAgICAgIGluZGljZXMucHVzaChjdXJyZW50SW5kZXgsIHN0YXJ0SW5kZXgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBCdWlsZHMgYSBsaW5lIHRvIGRyYXdcbiAqXG4gKiBJZ25vcmVkIGZyb20gZG9jcyBzaW5jZSBpdCBpcyBub3QgZGlyZWN0bHkgZXhwb3NlZC5cbiAqXG4gKiBAaWdub3JlXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkdyYXBoaWNzRGF0YX0gZ3JhcGhpY3NEYXRhIC0gVGhlIGdyYXBoaWNzIG9iamVjdCBjb250YWluaW5nIGFsbCB0aGUgbmVjZXNzYXJ5IHByb3BlcnRpZXNcbiAqIEBwYXJhbSB7UElYSS5HcmFwaGljc0dlb21ldHJ5fSBncmFwaGljc0dlb21ldHJ5IC0gR2VvbWV0cnkgd2hlcmUgdG8gYXBwZW5kIG91dHB1dFxuICovXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRMaW5lKGdyYXBoaWNzRGF0YTogR3JhcGhpY3NEYXRhLCBncmFwaGljc0dlb21ldHJ5OiBHcmFwaGljc0dlb21ldHJ5KTogdm9pZFxue1xuICAgIGlmIChncmFwaGljc0RhdGEubGluZVN0eWxlLm5hdGl2ZSlcbiAgICB7XG4gICAgICAgIGJ1aWxkTmF0aXZlTGluZShncmFwaGljc0RhdGEsIGdyYXBoaWNzR2VvbWV0cnkpO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBidWlsZE5vbk5hdGl2ZUxpbmUoZ3JhcGhpY3NEYXRhLCBncmFwaGljc0dlb21ldHJ5KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgUG9seWdvbiwgUElfMiB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG4vKipcbiAqIERyYXcgYSBzdGFyIHNoYXBlIHdpdGggYW4gYXJiaXRyYXJ5IG51bWJlciBvZiBwb2ludHMuXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLlBvbHlnb25cbiAqIEBtZW1iZXJvZiBQSVhJLmdyYXBoaWNzVXRpbHNcbiAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gQ2VudGVyIFggcG9zaXRpb24gb2YgdGhlIHN0YXJcbiAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gQ2VudGVyIFkgcG9zaXRpb24gb2YgdGhlIHN0YXJcbiAqIEBwYXJhbSB7bnVtYmVyfSBwb2ludHMgLSBUaGUgbnVtYmVyIG9mIHBvaW50cyBvZiB0aGUgc3RhciwgbXVzdCBiZSA+IDFcbiAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXMgLSBUaGUgb3V0ZXIgcmFkaXVzIG9mIHRoZSBzdGFyXG4gKiBAcGFyYW0ge251bWJlcn0gW2lubmVyUmFkaXVzXSAtIFRoZSBpbm5lciByYWRpdXMgYmV0d2VlbiBwb2ludHMsIGRlZmF1bHQgaGFsZiBgcmFkaXVzYFxuICogQHBhcmFtIHtudW1iZXJ9IFtyb3RhdGlvbj0wXSAtIFRoZSByb3RhdGlvbiBvZiB0aGUgc3RhciBpbiByYWRpYW5zLCB3aGVyZSAwIGlzIHZlcnRpY2FsXG4gKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gKi9cbmV4cG9ydCBjbGFzcyBTdGFyIGV4dGVuZHMgUG9seWdvblxue1xuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyLCBwb2ludHM6IG51bWJlciwgcmFkaXVzOiBudW1iZXIsIGlubmVyUmFkaXVzOiBudW1iZXIsIHJvdGF0aW9uID0gMClcbiAgICB7XG4gICAgICAgIGlubmVyUmFkaXVzID0gaW5uZXJSYWRpdXMgfHwgcmFkaXVzIC8gMjtcblxuICAgICAgICBjb25zdCBzdGFydEFuZ2xlID0gKC0xICogTWF0aC5QSSAvIDIpICsgcm90YXRpb247XG4gICAgICAgIGNvbnN0IGxlbiA9IHBvaW50cyAqIDI7XG4gICAgICAgIGNvbnN0IGRlbHRhID0gUElfMiAvIGxlbjtcbiAgICAgICAgY29uc3QgcG9seWdvbiA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBpICUgMiA/IGlubmVyUmFkaXVzIDogcmFkaXVzO1xuICAgICAgICAgICAgY29uc3QgYW5nbGUgPSAoaSAqIGRlbHRhKSArIHN0YXJ0QW5nbGU7XG5cbiAgICAgICAgICAgIHBvbHlnb24ucHVzaChcbiAgICAgICAgICAgICAgICB4ICsgKHIgKiBNYXRoLmNvcyhhbmdsZSkpLFxuICAgICAgICAgICAgICAgIHkgKyAociAqIE1hdGguc2luKGFuZ2xlKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlcihwb2x5Z29uKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgR1JBUEhJQ1NfQ1VSVkVTIH0gZnJvbSAnLi4vY29uc3QnO1xuaW1wb3J0IHsgUElfMiB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG5pbnRlcmZhY2UgSUFyY0xpa2VTaGFwZSB7XG4gICAgY3g6IG51bWJlcjtcbiAgICBjeTogbnVtYmVyO1xuICAgIHJhZGl1czogbnVtYmVyO1xuICAgIHN0YXJ0QW5nbGU6IG51bWJlcjtcbiAgICBlbmRBbmdsZTogbnVtYmVyO1xuICAgIGFudGljbG9ja3dpc2U6IGJvb2xlYW47XG59XG5cbi8qKlxuICogVXRpbGl0aWVzIGZvciBhcmMgY3VydmVzXG4gKiBAY2xhc3NcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBjbGFzcyBBcmNVdGlsc1xue1xuICAgIC8qKlxuICAgICAqIFRoZSBhcmNUbygpIG1ldGhvZCBjcmVhdGVzIGFuIGFyYy9jdXJ2ZSBiZXR3ZWVuIHR3byB0YW5nZW50cyBvbiB0aGUgY2FudmFzLlxuICAgICAqXG4gICAgICogXCJib3Jyb3dlZFwiIGZyb20gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9meGNhbnZhcy8gLSB0aGFua3MgZ29vZ2xlIVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geDEgLSBUaGUgeC1jb29yZGluYXRlIG9mIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFyY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MSAtIFRoZSB5LWNvb3JkaW5hdGUgb2YgdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJjXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHgyIC0gVGhlIHgtY29vcmRpbmF0ZSBvZiB0aGUgZW5kIG9mIHRoZSBhcmNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geTIgLSBUaGUgeS1jb29yZGluYXRlIG9mIHRoZSBlbmQgb2YgdGhlIGFyY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXMgLSBUaGUgcmFkaXVzIG9mIHRoZSBhcmNcbiAgICAgKiBAcmV0dXJuIHtvYmplY3R9IElmIHRoZSBhcmMgbGVuZ3RoIGlzIHZhbGlkLCByZXR1cm4gY2VudGVyIG9mIGNpcmNsZSwgcmFkaXVzIGFuZCBvdGhlciBpbmZvIG90aGVyd2lzZSBgbnVsbGAuXG4gICAgICovXG4gICAgc3RhdGljIGN1cnZlVG8oeDE6IG51bWJlciwgeTE6IG51bWJlciwgeDI6IG51bWJlciwgeTI6IG51bWJlciwgcmFkaXVzOiBudW1iZXIsIHBvaW50czogQXJyYXk8bnVtYmVyPik6IElBcmNMaWtlU2hhcGVcbiAgICB7XG4gICAgICAgIGNvbnN0IGZyb21YID0gcG9pbnRzW3BvaW50cy5sZW5ndGggLSAyXTtcbiAgICAgICAgY29uc3QgZnJvbVkgPSBwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGNvbnN0IGExID0gZnJvbVkgLSB5MTtcbiAgICAgICAgY29uc3QgYjEgPSBmcm9tWCAtIHgxO1xuICAgICAgICBjb25zdCBhMiA9IHkyIC0geTE7XG4gICAgICAgIGNvbnN0IGIyID0geDIgLSB4MTtcbiAgICAgICAgY29uc3QgbW0gPSBNYXRoLmFicygoYTEgKiBiMikgLSAoYjEgKiBhMikpO1xuXG4gICAgICAgIGlmIChtbSA8IDEuMGUtOCB8fCByYWRpdXMgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDJdICE9PSB4MSB8fCBwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdICE9PSB5MSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwb2ludHMucHVzaCh4MSwgeTEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRkID0gKGExICogYTEpICsgKGIxICogYjEpO1xuICAgICAgICBjb25zdCBjYyA9IChhMiAqIGEyKSArIChiMiAqIGIyKTtcbiAgICAgICAgY29uc3QgdHQgPSAoYTEgKiBhMikgKyAoYjEgKiBiMik7XG4gICAgICAgIGNvbnN0IGsxID0gcmFkaXVzICogTWF0aC5zcXJ0KGRkKSAvIG1tO1xuICAgICAgICBjb25zdCBrMiA9IHJhZGl1cyAqIE1hdGguc3FydChjYykgLyBtbTtcbiAgICAgICAgY29uc3QgajEgPSBrMSAqIHR0IC8gZGQ7XG4gICAgICAgIGNvbnN0IGoyID0gazIgKiB0dCAvIGNjO1xuICAgICAgICBjb25zdCBjeCA9IChrMSAqIGIyKSArIChrMiAqIGIxKTtcbiAgICAgICAgY29uc3QgY3kgPSAoazEgKiBhMikgKyAoazIgKiBhMSk7XG4gICAgICAgIGNvbnN0IHB4ID0gYjEgKiAoazIgKyBqMSk7XG4gICAgICAgIGNvbnN0IHB5ID0gYTEgKiAoazIgKyBqMSk7XG4gICAgICAgIGNvbnN0IHF4ID0gYjIgKiAoazEgKyBqMik7XG4gICAgICAgIGNvbnN0IHF5ID0gYTIgKiAoazEgKyBqMik7XG4gICAgICAgIGNvbnN0IHN0YXJ0QW5nbGUgPSBNYXRoLmF0YW4yKHB5IC0gY3ksIHB4IC0gY3gpO1xuICAgICAgICBjb25zdCBlbmRBbmdsZSA9IE1hdGguYXRhbjIocXkgLSBjeSwgcXggLSBjeCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGN4OiAoY3ggKyB4MSksXG4gICAgICAgICAgICBjeTogKGN5ICsgeTEpLFxuICAgICAgICAgICAgcmFkaXVzLFxuICAgICAgICAgICAgc3RhcnRBbmdsZSxcbiAgICAgICAgICAgIGVuZEFuZ2xlLFxuICAgICAgICAgICAgYW50aWNsb2Nrd2lzZTogKGIxICogYTIgPiBiMiAqIGExKSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG4gICAgLyoqXG4gICAgICogVGhlIGFyYyBtZXRob2QgY3JlYXRlcyBhbiBhcmMvY3VydmUgKHVzZWQgdG8gY3JlYXRlIGNpcmNsZXMsIG9yIHBhcnRzIG9mIGNpcmNsZXMpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRYIC0gU3RhcnQgeCBsb2NhdGlvbiBvZiBhcmNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRZIC0gU3RhcnQgeSBsb2NhdGlvbiBvZiBhcmNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3ggLSBUaGUgeC1jb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmNsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjeSAtIFRoZSB5LWNvb3JkaW5hdGUgb2YgdGhlIGNlbnRlciBvZiB0aGUgY2lyY2xlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1cyAtIFRoZSByYWRpdXMgb2YgdGhlIGNpcmNsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydEFuZ2xlIC0gVGhlIHN0YXJ0aW5nIGFuZ2xlLCBpbiByYWRpYW5zICgwIGlzIGF0IHRoZSAzIG8nY2xvY2sgcG9zaXRpb25cbiAgICAgKiAgb2YgdGhlIGFyYydzIGNpcmNsZSlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kQW5nbGUgLSBUaGUgZW5kaW5nIGFuZ2xlLCBpbiByYWRpYW5zXG4gICAgICogQHBhcmFtIHtib29sZWFufSBhbnRpY2xvY2t3aXNlIC0gU3BlY2lmaWVzIHdoZXRoZXIgdGhlIGRyYXdpbmcgc2hvdWxkIGJlXG4gICAgICogIGNvdW50ZXItY2xvY2t3aXNlIG9yIGNsb2Nrd2lzZS4gRmFsc2UgaXMgZGVmYXVsdCwgYW5kIGluZGljYXRlcyBjbG9ja3dpc2UsIHdoaWxlIHRydWVcbiAgICAgKiAgaW5kaWNhdGVzIGNvdW50ZXItY2xvY2t3aXNlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHBvaW50cyAtIENvbGxlY3Rpb24gb2YgcG9pbnRzIHRvIGFkZCB0b1xuICAgICAqL1xuICAgIHN0YXRpYyBhcmMoX3N0YXJ0WDogbnVtYmVyLCBfc3RhcnRZOiBudW1iZXIsIGN4OiBudW1iZXIsIGN5OiBudW1iZXIsIHJhZGl1czogbnVtYmVyLFxuICAgICAgICBzdGFydEFuZ2xlOiBudW1iZXIsIGVuZEFuZ2xlOiBudW1iZXIsIF9hbnRpY2xvY2t3aXNlOiBib29sZWFuLCBwb2ludHM6IEFycmF5PG51bWJlcj4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBzd2VlcCA9IGVuZEFuZ2xlIC0gc3RhcnRBbmdsZTtcbiAgICAgICAgY29uc3QgbiA9IEdSQVBISUNTX0NVUlZFUy5fc2VnbWVudHNDb3VudChcbiAgICAgICAgICAgIE1hdGguYWJzKHN3ZWVwKSAqIHJhZGl1cyxcbiAgICAgICAgICAgIE1hdGguY2VpbChNYXRoLmFicyhzd2VlcCkgLyBQSV8yKSAqIDQwXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdGhldGEgPSAoc3dlZXApIC8gKG4gKiAyKTtcbiAgICAgICAgY29uc3QgdGhldGEyID0gdGhldGEgKiAyO1xuICAgICAgICBjb25zdCBjVGhldGEgPSBNYXRoLmNvcyh0aGV0YSk7XG4gICAgICAgIGNvbnN0IHNUaGV0YSA9IE1hdGguc2luKHRoZXRhKTtcbiAgICAgICAgY29uc3Qgc2VnTWludXMgPSBuIC0gMTtcbiAgICAgICAgY29uc3QgcmVtYWluZGVyID0gKHNlZ01pbnVzICUgMSkgLyBzZWdNaW51cztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzZWdNaW51czsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCByZWFsID0gaSArIChyZW1haW5kZXIgKiBpKTtcbiAgICAgICAgICAgIGNvbnN0IGFuZ2xlID0gKCh0aGV0YSkgKyBzdGFydEFuZ2xlICsgKHRoZXRhMiAqIHJlYWwpKTtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBNYXRoLmNvcyhhbmdsZSk7XG4gICAgICAgICAgICBjb25zdCBzID0gLU1hdGguc2luKGFuZ2xlKTtcblxuICAgICAgICAgICAgcG9pbnRzLnB1c2goXG4gICAgICAgICAgICAgICAgKCgoY1RoZXRhICogYykgKyAoc1RoZXRhICogcykpICogcmFkaXVzKSArIGN4LFxuICAgICAgICAgICAgICAgICgoKGNUaGV0YSAqIC1zKSArIChzVGhldGEgKiBjKSkgKiByYWRpdXMpICsgY3lcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyogZXNsaW50LWVuYWJsZSBtYXgtbGVuICovXG59XG4iLCAiaW1wb3J0IHsgR1JBUEhJQ1NfQ1VSVkVTIH0gZnJvbSAnLi4vY29uc3QnO1xuXG4vKipcbiAqIFV0aWxpdGllcyBmb3IgYmV6aWVyIGN1cnZlc1xuICogQGNsYXNzXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgY2xhc3MgQmV6aWVyVXRpbHNcbntcbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgbGVuZ3RoIG9mIGJlemllciBjdXJ2ZS5cbiAgICAgKiBBbmFseXRpY2FsIHNvbHV0aW9uIGlzIGltcG9zc2libGUsIHNpbmNlIGl0IGludm9sdmVzIGFuIGludGVncmFsIHRoYXQgZG9lcyBub3QgaW50ZWdyYXRlIGluIGdlbmVyYWwuXG4gICAgICogVGhlcmVmb3JlIG51bWVyaWNhbCBzb2x1dGlvbiBpcyB1c2VkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZnJvbVggLSBTdGFydGluZyBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGZyb21ZIC0gU3RhcnRpbmcgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFggLSBDb250cm9sIHBvaW50IHhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BZIC0gQ29udHJvbCBwb2ludCB5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNwWDIgLSBTZWNvbmQgQ29udHJvbCBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNwWTIgLSBTZWNvbmQgQ29udHJvbCBwb2ludCB5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvWCAtIERlc3RpbmF0aW9uIHBvaW50IHhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdG9ZIC0gRGVzdGluYXRpb24gcG9pbnQgeVxuICAgICAqIEByZXR1cm4ge251bWJlcn0gTGVuZ3RoIG9mIGJlemllciBjdXJ2ZVxuICAgICAqL1xuICAgIHN0YXRpYyBjdXJ2ZUxlbmd0aChcbiAgICAgICAgZnJvbVg6IG51bWJlciwgZnJvbVk6IG51bWJlcixcbiAgICAgICAgY3BYOiBudW1iZXIsIGNwWTogbnVtYmVyLFxuICAgICAgICBjcFgyOiBudW1iZXIsIGNwWTI6IG51bWJlcixcbiAgICAgICAgdG9YOiBudW1iZXIsIHRvWTogbnVtYmVyKTogbnVtYmVyXG4gICAge1xuICAgICAgICBjb25zdCBuID0gMTA7XG4gICAgICAgIGxldCByZXN1bHQgPSAwLjA7XG4gICAgICAgIGxldCB0ID0gMC4wO1xuICAgICAgICBsZXQgdDIgPSAwLjA7XG4gICAgICAgIGxldCB0MyA9IDAuMDtcbiAgICAgICAgbGV0IG50ID0gMC4wO1xuICAgICAgICBsZXQgbnQyID0gMC4wO1xuICAgICAgICBsZXQgbnQzID0gMC4wO1xuICAgICAgICBsZXQgeCA9IDAuMDtcbiAgICAgICAgbGV0IHkgPSAwLjA7XG4gICAgICAgIGxldCBkeCA9IDAuMDtcbiAgICAgICAgbGV0IGR5ID0gMC4wO1xuICAgICAgICBsZXQgcHJldlggPSBmcm9tWDtcbiAgICAgICAgbGV0IHByZXZZID0gZnJvbVk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbjsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICB0ID0gaSAvIG47XG4gICAgICAgICAgICB0MiA9IHQgKiB0O1xuICAgICAgICAgICAgdDMgPSB0MiAqIHQ7XG4gICAgICAgICAgICBudCA9ICgxLjAgLSB0KTtcbiAgICAgICAgICAgIG50MiA9IG50ICogbnQ7XG4gICAgICAgICAgICBudDMgPSBudDIgKiBudDtcblxuICAgICAgICAgICAgeCA9IChudDMgKiBmcm9tWCkgKyAoMy4wICogbnQyICogdCAqIGNwWCkgKyAoMy4wICogbnQgKiB0MiAqIGNwWDIpICsgKHQzICogdG9YKTtcbiAgICAgICAgICAgIHkgPSAobnQzICogZnJvbVkpICsgKDMuMCAqIG50MiAqIHQgKiBjcFkpICsgKDMgKiBudCAqIHQyICogY3BZMikgKyAodDMgKiB0b1kpO1xuICAgICAgICAgICAgZHggPSBwcmV2WCAtIHg7XG4gICAgICAgICAgICBkeSA9IHByZXZZIC0geTtcbiAgICAgICAgICAgIHByZXZYID0geDtcbiAgICAgICAgICAgIHByZXZZID0geTtcblxuICAgICAgICAgICAgcmVzdWx0ICs9IE1hdGguc3FydCgoZHggKiBkeCkgKyAoZHkgKiBkeSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIHBvaW50cyBmb3IgYSBiZXppZXIgY3VydmUgYW5kIHRoZW4gZHJhd3MgaXQuXG4gICAgICpcbiAgICAgKiBJZ25vcmVkIGZyb20gZG9jcyBzaW5jZSBpdCBpcyBub3QgZGlyZWN0bHkgZXhwb3NlZC5cbiAgICAgKlxuICAgICAqIEBpZ25vcmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BYIC0gQ29udHJvbCBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNwWSAtIENvbnRyb2wgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFgyIC0gU2Vjb25kIENvbnRyb2wgcG9pbnQgeFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFkyIC0gU2Vjb25kIENvbnRyb2wgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0b1ggLSBEZXN0aW5hdGlvbiBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvWSAtIERlc3RpbmF0aW9uIHBvaW50IHlcbiAgICAgKiBAcGFyYW0ge251bWJlcltdfSBwb2ludHMgLSBQYXRoIGFycmF5IHRvIHB1c2ggcG9pbnRzIGludG9cbiAgICAgKi9cbiAgICBzdGF0aWMgY3VydmVUbyhcbiAgICAgICAgY3BYOiBudW1iZXIsIGNwWTogbnVtYmVyLFxuICAgICAgICBjcFgyOiBudW1iZXIsIGNwWTI6IG51bWJlcixcbiAgICAgICAgdG9YOiBudW1iZXIsIHRvWTogbnVtYmVyLFxuICAgICAgICBwb2ludHM6IEFycmF5PG51bWJlcj4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBmcm9tWCA9IHBvaW50c1twb2ludHMubGVuZ3RoIC0gMl07XG4gICAgICAgIGNvbnN0IGZyb21ZID0gcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXTtcblxuICAgICAgICBwb2ludHMubGVuZ3RoIC09IDI7XG5cbiAgICAgICAgY29uc3QgbiA9IEdSQVBISUNTX0NVUlZFUy5fc2VnbWVudHNDb3VudChcbiAgICAgICAgICAgIEJlemllclV0aWxzLmN1cnZlTGVuZ3RoKGZyb21YLCBmcm9tWSwgY3BYLCBjcFksIGNwWDIsIGNwWTIsIHRvWCwgdG9ZKVxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBkdCA9IDA7XG4gICAgICAgIGxldCBkdDIgPSAwO1xuICAgICAgICBsZXQgZHQzID0gMDtcbiAgICAgICAgbGV0IHQyID0gMDtcbiAgICAgICAgbGV0IHQzID0gMDtcblxuICAgICAgICBwb2ludHMucHVzaChmcm9tWCwgZnJvbVkpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAxLCBqID0gMDsgaSA8PSBuOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGogPSBpIC8gbjtcblxuICAgICAgICAgICAgZHQgPSAoMSAtIGopO1xuICAgICAgICAgICAgZHQyID0gZHQgKiBkdDtcbiAgICAgICAgICAgIGR0MyA9IGR0MiAqIGR0O1xuXG4gICAgICAgICAgICB0MiA9IGogKiBqO1xuICAgICAgICAgICAgdDMgPSB0MiAqIGo7XG5cbiAgICAgICAgICAgIHBvaW50cy5wdXNoKFxuICAgICAgICAgICAgICAgIChkdDMgKiBmcm9tWCkgKyAoMyAqIGR0MiAqIGogKiBjcFgpICsgKDMgKiBkdCAqIHQyICogY3BYMikgKyAodDMgKiB0b1gpLFxuICAgICAgICAgICAgICAgIChkdDMgKiBmcm9tWSkgKyAoMyAqIGR0MiAqIGogKiBjcFkpICsgKDMgKiBkdCAqIHQyICogY3BZMikgKyAodDMgKiB0b1kpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEdSQVBISUNTX0NVUlZFUyB9IGZyb20gJy4uL2NvbnN0JztcblxuLyoqXG4gKiBVdGlsaXRpZXMgZm9yIHF1YWRyYXRpYyBjdXJ2ZXNcbiAqIEBjbGFzc1xuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNsYXNzIFF1YWRyYXRpY1V0aWxzXG57XG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIGxlbmd0aCBvZiBxdWFkcmF0aWMgY3VydmVcbiAgICAgKiBAc2VlIHtAbGluayBodHRwOi8vd3d3Lm1hbGN6YWsubGludXhwbC5jb20vYmxvZy9xdWFkcmF0aWMtYmV6aWVyLWN1cnZlLWxlbmd0aC99XG4gICAgICogZm9yIHRoZSBkZXRhaWxlZCBleHBsYW5hdGlvbiBvZiBtYXRoIGJlaGluZCB0aGlzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZnJvbVggLSB4LWNvb3JkaW5hdGUgb2YgY3VydmUgc3RhcnQgcG9pbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZnJvbVkgLSB5LWNvb3JkaW5hdGUgb2YgY3VydmUgc3RhcnQgcG9pbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BYIC0geC1jb29yZGluYXRlIG9mIGN1cnZlIGNvbnRyb2wgcG9pbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BZIC0geS1jb29yZGluYXRlIG9mIGN1cnZlIGNvbnRyb2wgcG9pbnRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdG9YIC0geC1jb29yZGluYXRlIG9mIGN1cnZlIGVuZCBwb2ludFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0b1kgLSB5LWNvb3JkaW5hdGUgb2YgY3VydmUgZW5kIHBvaW50XG4gICAgICogQHJldHVybiB7bnVtYmVyfSBMZW5ndGggb2YgcXVhZHJhdGljIGN1cnZlXG4gICAgICovXG4gICAgc3RhdGljIGN1cnZlTGVuZ3RoKFxuICAgICAgICBmcm9tWDogbnVtYmVyLCBmcm9tWTogbnVtYmVyLFxuICAgICAgICBjcFg6IG51bWJlciwgY3BZOiBudW1iZXIsXG4gICAgICAgIHRvWDogbnVtYmVyLCB0b1k6IG51bWJlcik6IG51bWJlclxuICAgIHtcbiAgICAgICAgY29uc3QgYXggPSBmcm9tWCAtICgyLjAgKiBjcFgpICsgdG9YO1xuICAgICAgICBjb25zdCBheSA9IGZyb21ZIC0gKDIuMCAqIGNwWSkgKyB0b1k7XG4gICAgICAgIGNvbnN0IGJ4ID0gKDIuMCAqIGNwWCkgLSAoMi4wICogZnJvbVgpO1xuICAgICAgICBjb25zdCBieSA9ICgyLjAgKiBjcFkpIC0gKDIuMCAqIGZyb21ZKTtcbiAgICAgICAgY29uc3QgYSA9IDQuMCAqICgoYXggKiBheCkgKyAoYXkgKiBheSkpO1xuICAgICAgICBjb25zdCBiID0gNC4wICogKChheCAqIGJ4KSArIChheSAqIGJ5KSk7XG4gICAgICAgIGNvbnN0IGMgPSAoYnggKiBieCkgKyAoYnkgKiBieSk7XG5cbiAgICAgICAgY29uc3QgcyA9IDIuMCAqIE1hdGguc3FydChhICsgYiArIGMpO1xuICAgICAgICBjb25zdCBhMiA9IE1hdGguc3FydChhKTtcbiAgICAgICAgY29uc3QgYTMyID0gMi4wICogYSAqIGEyO1xuICAgICAgICBjb25zdCBjMiA9IDIuMCAqIE1hdGguc3FydChjKTtcbiAgICAgICAgY29uc3QgYmEgPSBiIC8gYTI7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIChhMzIgKiBzKVxuICAgICAgICAgICAgICAgICsgKGEyICogYiAqIChzIC0gYzIpKVxuICAgICAgICAgICAgICAgICsgKFxuICAgICAgICAgICAgICAgICAgICAoKDQuMCAqIGMgKiBhKSAtIChiICogYikpXG4gICAgICAgICAgICAgICAgICAgKiBNYXRoLmxvZygoKDIuMCAqIGEyKSArIGJhICsgcykgLyAoYmEgKyBjMikpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICApIC8gKDQuMCAqIGEzMik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHRoZSBwb2ludHMgZm9yIGEgcXVhZHJhdGljIGJlemllciBjdXJ2ZSBhbmQgdGhlbiBkcmF3cyBpdC5cbiAgICAgKiBCYXNlZCBvbjogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzg1MDk3L2hvdy1kby1pLWltcGxlbWVudC1hLWJlemllci1jdXJ2ZS1pbi1jXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFggLSBDb250cm9sIHBvaW50IHhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BZIC0gQ29udHJvbCBwb2ludCB5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvWCAtIERlc3RpbmF0aW9uIHBvaW50IHhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdG9ZIC0gRGVzdGluYXRpb24gcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHBvaW50cyAtIFBvaW50cyB0byBhZGQgc2VnbWVudHMgdG8uXG4gICAgICovXG4gICAgc3RhdGljIGN1cnZlVG8oY3BYOiBudW1iZXIsIGNwWTogbnVtYmVyLCB0b1g6IG51bWJlciwgdG9ZOiBudW1iZXIsIHBvaW50czogQXJyYXk8bnVtYmVyPik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGZyb21YID0gcG9pbnRzW3BvaW50cy5sZW5ndGggLSAyXTtcbiAgICAgICAgY29uc3QgZnJvbVkgPSBwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGNvbnN0IG4gPSBHUkFQSElDU19DVVJWRVMuX3NlZ21lbnRzQ291bnQoXG4gICAgICAgICAgICBRdWFkcmF0aWNVdGlscy5jdXJ2ZUxlbmd0aChmcm9tWCwgZnJvbVksIGNwWCwgY3BZLCB0b1gsIHRvWSlcbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgeGEgPSAwO1xuICAgICAgICBsZXQgeWEgPSAwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IG47ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgaiA9IGkgLyBuO1xuXG4gICAgICAgICAgICB4YSA9IGZyb21YICsgKChjcFggLSBmcm9tWCkgKiBqKTtcbiAgICAgICAgICAgIHlhID0gZnJvbVkgKyAoKGNwWSAtIGZyb21ZKSAqIGopO1xuXG4gICAgICAgICAgICBwb2ludHMucHVzaCh4YSArICgoKGNwWCArICgodG9YIC0gY3BYKSAqIGopKSAtIHhhKSAqIGopLFxuICAgICAgICAgICAgICAgIHlhICsgKCgoY3BZICsgKCh0b1kgLSBjcFkpICogaikpIC0geWEpICogaikpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgTGluZVN0eWxlIH0gZnJvbSAnLi4vc3R5bGVzL0xpbmVTdHlsZSc7XG5pbXBvcnQgdHlwZSB7IEZpbGxTdHlsZSB9IGZyb20gJy4uL3N0eWxlcy9GaWxsU3R5bGUnO1xuXG4vKipcbiAqIEEgc3RydWN0dXJlIHRvIGhvbGQgaW50ZXJpbSBiYXRjaCBvYmplY3RzIGZvciBHcmFwaGljcy5cbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWEkuZ3JhcGhpY3NVdGlsc1xuICovXG5leHBvcnQgY2xhc3MgQmF0Y2hQYXJ0XG57XG4gICAgcHVibGljIHN0eWxlOiBMaW5lU3R5bGUgfCBGaWxsU3R5bGU7XG4gICAgcHVibGljIHN0YXJ0OiBudW1iZXI7XG4gICAgcHVibGljIHNpemU6IG51bWJlcjtcbiAgICBwdWJsaWMgYXR0cmliU3RhcnQ6IG51bWJlcjtcbiAgICBwdWJsaWMgYXR0cmliU2l6ZTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJlZ2luIGJhdGNoIHBhcnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5GaWxsU3R5bGUgfCBQSVhJLkxpbmVTdHlsZX0gc3R5bGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRJbmRleFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdHRyaWJTdGFydFxuICAgICAqL1xuICAgIHB1YmxpYyBiZWdpbihzdHlsZTogTGluZVN0eWxlIHwgRmlsbFN0eWxlLCBzdGFydEluZGV4OiBudW1iZXIsIGF0dHJpYlN0YXJ0OiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMuc3R5bGUgPSBzdHlsZTtcbiAgICAgICAgdGhpcy5zdGFydCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHRoaXMuYXR0cmliU3RhcnQgPSBhdHRyaWJTdGFydDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmQgYmF0Y2ggcGFydFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZEluZGV4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZEF0dHJpYlxuICAgICAqL1xuICAgIHB1YmxpYyBlbmQoZW5kSW5kZXg6IG51bWJlciwgZW5kQXR0cmliOiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmF0dHJpYlNpemUgPSBlbmRBdHRyaWIgLSB0aGlzLmF0dHJpYlN0YXJ0O1xuICAgICAgICB0aGlzLnNpemUgPSBlbmRJbmRleCAtIHRoaXMuc3RhcnQ7XG4gICAgfVxuXG4gICAgcHVibGljIHJlc2V0KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuc3R5bGUgPSBudWxsO1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gMDtcbiAgICAgICAgdGhpcy5hdHRyaWJTdGFydCA9IDA7XG4gICAgICAgIHRoaXMuYXR0cmliU2l6ZSA9IDA7XG4gICAgfVxufVxuIiwgIi8qKlxuICogR2VuZXJhbGl6ZWQgY29udmVuaWVuY2UgdXRpbGl0aWVzIGZvciBHcmFwaGljcy5cbiAqXG4gKiBAbmFtZXNwYWNlIGdyYXBoaWNzVXRpbHNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cblxuaW1wb3J0IHsgYnVpbGRQb2x5IH0gZnJvbSAnLi9idWlsZFBvbHknO1xuZXhwb3J0IHsgYnVpbGRQb2x5IH07XG5cbmltcG9ydCB7IGJ1aWxkQ2lyY2xlIH0gZnJvbSAnLi9idWlsZENpcmNsZSc7XG5leHBvcnQgeyBidWlsZENpcmNsZSB9O1xuXG5pbXBvcnQgeyBidWlsZFJlY3RhbmdsZSB9IGZyb20gJy4vYnVpbGRSZWN0YW5nbGUnO1xuZXhwb3J0IHsgYnVpbGRSZWN0YW5nbGUgfTtcblxuaW1wb3J0IHsgYnVpbGRSb3VuZGVkUmVjdGFuZ2xlIH0gZnJvbSAnLi9idWlsZFJvdW5kZWRSZWN0YW5nbGUnO1xuZXhwb3J0IHsgYnVpbGRSb3VuZGVkUmVjdGFuZ2xlIH07XG5cbmV4cG9ydCAqIGZyb20gJy4vYnVpbGRMaW5lJztcbmV4cG9ydCAqIGZyb20gJy4vU3Rhcic7XG5leHBvcnQgKiBmcm9tICcuL0FyY1V0aWxzJztcbmV4cG9ydCAqIGZyb20gJy4vQmV6aWVyVXRpbHMnO1xuZXhwb3J0ICogZnJvbSAnLi9RdWFkcmF0aWNVdGlscyc7XG5leHBvcnQgKiBmcm9tICcuL0JhdGNoUGFydCc7XG5cbi8vIGZvciB0eXBlIG9ubHlcbmltcG9ydCB7IEJhdGNoUGFydCB9IGZyb20gJy4vQmF0Y2hQYXJ0JztcbmltcG9ydCB7IFNIQVBFUyB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgQmF0Y2hEcmF3Q2FsbCB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHsgSVNoYXBlQnVpbGRDb21tYW5kIH0gZnJvbSAnLi9JU2hhcGVCdWlsZENvbW1hbmQnO1xuXG4vKipcbiAqIE1hcCBvZiBmaWxsIGNvbW1hbmRzIGZvciBlYWNoIHNoYXBlIHR5cGUuXG4gKlxuICogQG1lbWJlcm9mIFBJWEkuZ3JhcGhpY3NVdGlsc1xuICogQG1lbWJlciB7T2JqZWN0fSBGSUxMX0NPTU1BTkRTXG4gKi9cbmV4cG9ydCBjb25zdCBGSUxMX0NPTU1BTkRTOiBSZWNvcmQ8U0hBUEVTLCBJU2hhcGVCdWlsZENvbW1hbmQ+ID0ge1xuICAgIFtTSEFQRVMuUE9MWV06IGJ1aWxkUG9seSxcbiAgICBbU0hBUEVTLkNJUkNdOiBidWlsZENpcmNsZSxcbiAgICBbU0hBUEVTLkVMSVBdOiBidWlsZENpcmNsZSxcbiAgICBbU0hBUEVTLlJFQ1RdOiBidWlsZFJlY3RhbmdsZSxcbiAgICBbU0hBUEVTLlJSRUNdOiBidWlsZFJvdW5kZWRSZWN0YW5nbGUsXG59O1xuXG4vKipcbiAqIEJhdGNoIHBvb2wsIHN0b3JlcyB1bnVzZWQgYmF0Y2hlcyBmb3IgcHJldmVudGluZyBhbGxvY2F0aW9ucy5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS5ncmFwaGljc1V0aWxzXG4gKiBAbWVtYmVyIHtBcnJheTxQSVhJLmdyYXBoaWNzVXRpbHMuQmF0Y2hQYXJ0Pn0gQkFUQ0hfUE9PTFxuICovXG5leHBvcnQgY29uc3QgQkFUQ0hfUE9PTDogQXJyYXk8QmF0Y2hQYXJ0PiA9IFtdO1xuXG4vKipcbiAqIERyYXcgY2FsbCBwb29sLCBzdG9yZXMgdW51c2VkIGRyYXcgY2FsbHMgZm9yIHByZXZlbnRpbmcgYWxsb2NhdGlvbnMuXG4gKlxuICogQG1lbWJlcm9mIFBJWEkuZ3JhcGhpY3NVdGlsc1xuICogQG1lbWJlciB7QXJyYXk8UElYSS5CYXRjaERyYXdDYWxsPn0gRFJBV19DQUxMX1BPT0xcbiAqL1xuZXhwb3J0IGNvbnN0IERSQVdfQ0FMTF9QT09MOiBBcnJheTxCYXRjaERyYXdDYWxsPiA9IFtdO1xuIiwgImltcG9ydCB0eXBlIHsgTWF0cml4LCBTSEFQRVMsIElTaGFwZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHR5cGUgeyBGaWxsU3R5bGUgfSBmcm9tICcuL3N0eWxlcy9GaWxsU3R5bGUnO1xuaW1wb3J0IHR5cGUgeyBMaW5lU3R5bGUgfSBmcm9tICcuL3N0eWxlcy9MaW5lU3R5bGUnO1xuXG4vKipcbiAqIEEgY2xhc3MgdG8gY29udGFpbiBkYXRhIHVzZWZ1bCBmb3IgR3JhcGhpY3Mgb2JqZWN0c1xuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdyYXBoaWNzRGF0YVxue1xuICAgIHNoYXBlOiBJU2hhcGU7XG4gICAgbGluZVN0eWxlOiBMaW5lU3R5bGU7XG4gICAgZmlsbFN0eWxlOiBGaWxsU3R5bGU7XG4gICAgbWF0cml4OiBNYXRyaXg7XG4gICAgdHlwZTogU0hBUEVTO1xuICAgIHBvaW50czogbnVtYmVyW107XG4gICAgaG9sZXM6IEFycmF5PEdyYXBoaWNzRGF0YT47XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ2lyY2xlfFBJWEkuRWxsaXBzZXxQSVhJLlBvbHlnb258UElYSS5SZWN0YW5nbGV8UElYSS5Sb3VuZGVkUmVjdGFuZ2xlfSBzaGFwZSAtIFRoZSBzaGFwZSBvYmplY3QgdG8gZHJhdy5cbiAgICAgKiBAcGFyYW0ge1BJWEkuRmlsbFN0eWxlfSBbZmlsbFN0eWxlXSAtIHRoZSB3aWR0aCBvZiB0aGUgbGluZSB0byBkcmF3XG4gICAgICogQHBhcmFtIHtQSVhJLkxpbmVTdHlsZX0gW2xpbmVTdHlsZV0gLSB0aGUgY29sb3Igb2YgdGhlIGxpbmUgdG8gZHJhd1xuICAgICAqIEBwYXJhbSB7UElYSS5NYXRyaXh9IFttYXRyaXhdIC0gVHJhbnNmb3JtIG1hdHJpeFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNoYXBlOiBJU2hhcGUsIGZpbGxTdHlsZTogRmlsbFN0eWxlID0gbnVsbCwgbGluZVN0eWxlOiBMaW5lU3R5bGUgPSBudWxsLCBtYXRyaXg6IE1hdHJpeCA9IG51bGwpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNoYXBlIG9iamVjdCB0byBkcmF3LlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkNpcmNsZXxQSVhJLkVsbGlwc2V8UElYSS5Qb2x5Z29ufFBJWEkuUmVjdGFuZ2xlfFBJWEkuUm91bmRlZFJlY3RhbmdsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHN0eWxlIG9mIHRoZSBsaW5lLlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkxpbmVTdHlsZX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGluZVN0eWxlID0gbGluZVN0eWxlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc3R5bGUgb2YgdGhlIGZpbGwuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuRmlsbFN0eWxlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5maWxsU3R5bGUgPSBmaWxsU3R5bGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0cmFuc2Zvcm0gbWF0cml4LlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWF0cml4ID0gbWF0cml4O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdHlwZSBvZiB0aGUgc2hhcGUsIHNlZSB0aGUgQ29uc3QuU2hhcGVzIGZpbGUgZm9yIGFsbCB0aGUgZXhpc3RpbmcgdHlwZXMsXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IHNoYXBlLnR5cGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHBvaW50cy5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBvaW50cyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBob2xlcy5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5HcmFwaGljc0RhdGFbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaG9sZXMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IEdyYXBoaWNzRGF0YSBvYmplY3Qgd2l0aCB0aGUgc2FtZSB2YWx1ZXMgYXMgdGhpcyBvbmUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzRGF0YX0gQ2xvbmVkIEdyYXBoaWNzRGF0YSBvYmplY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgY2xvbmUoKTogR3JhcGhpY3NEYXRhXG4gICAge1xuICAgICAgICByZXR1cm4gbmV3IEdyYXBoaWNzRGF0YShcbiAgICAgICAgICAgIHRoaXMuc2hhcGUsXG4gICAgICAgICAgICB0aGlzLmZpbGxTdHlsZSxcbiAgICAgICAgICAgIHRoaXMubGluZVN0eWxlLFxuICAgICAgICAgICAgdGhpcy5tYXRyaXhcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgR3JhcGhpY3MgZGF0YS5cbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuc2hhcGUgPSBudWxsO1xuICAgICAgICB0aGlzLmhvbGVzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaG9sZXMgPSBudWxsO1xuICAgICAgICB0aGlzLnBvaW50cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnBvaW50cyA9IG51bGw7XG4gICAgICAgIHRoaXMubGluZVN0eWxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5maWxsU3R5bGUgPSBudWxsO1xuICAgIH1cbn1cbiIsICJpbXBvcnQge1xuICAgIGJ1aWxkTGluZSxcbiAgICBidWlsZFBvbHksXG4gICAgQmF0Y2hQYXJ0LFxuICAgIEZJTExfQ09NTUFORFMsXG4gICAgQkFUQ0hfUE9PTCxcbiAgICBEUkFXX0NBTExfUE9PTCxcbn0gZnJvbSAnLi91dGlscyc7XG5cbmltcG9ydCB7XG4gICAgQmF0Y2hHZW9tZXRyeSxcbiAgICBCYXRjaERyYXdDYWxsLFxuICAgIEJhdGNoVGV4dHVyZUFycmF5LFxuICAgIEJhc2VUZXh0dXJlLFxuICAgIFRleHR1cmUsXG59IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5pbXBvcnQgeyBEUkFXX01PREVTLCBXUkFQX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcbmltcG9ydCB7IFNIQVBFUywgUG9pbnQsIE1hdHJpeCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgR3JhcGhpY3NEYXRhIH0gZnJvbSAnLi9HcmFwaGljc0RhdGEnO1xuaW1wb3J0IHsgcHJlbXVsdGlwbHlUaW50IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgQm91bmRzIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5cbmltcG9ydCB0eXBlIHsgQ2lyY2xlLCBFbGxpcHNlLCBQb2x5Z29uLCBSZWN0YW5nbGUsIFJvdW5kZWRSZWN0YW5nbGUsIElQb2ludERhdGEgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgRmlsbFN0eWxlIH0gZnJvbSAnLi9zdHlsZXMvRmlsbFN0eWxlJztcbmltcG9ydCB0eXBlIHsgTGluZVN0eWxlIH0gZnJvbSAnLi9zdHlsZXMvTGluZVN0eWxlJztcblxuLyoqXG4gKiBAZGVzY3JpcHRpb24gQ29tcGxleCBzaGFwZSB0eXBlXG4gKiBAdG9kbyBNb3ZlIHRvIE1hdGggc2hhcGVzXG4gKi9cbnR5cGUgSVNoYXBlID0gQ2lyY2xlIHwgRWxsaXBzZSB8IFBvbHlnb24gfCBSZWN0YW5nbGUgfCBSb3VuZGVkUmVjdGFuZ2xlO1xuXG5jb25zdCB0bXBQb2ludCA9IG5ldyBQb2ludCgpO1xuY29uc3QgdG1wQm91bmRzID0gbmV3IEJvdW5kcygpO1xuXG4vKipcbiAqIFRoZSBHcmFwaGljcyBjbGFzcyBjb250YWlucyBtZXRob2RzIHVzZWQgdG8gZHJhdyBwcmltaXRpdmUgc2hhcGVzIHN1Y2ggYXMgbGluZXMsIGNpcmNsZXMgYW5kXG4gKiByZWN0YW5nbGVzIHRvIHRoZSBkaXNwbGF5LCBhbmQgdG8gY29sb3IgYW5kIGZpbGwgdGhlbS5cbiAqXG4gKiBHcmFwaGljc0dlb21ldHJ5IGlzIGRlc2lnbmVkIHRvIG5vdCBiZSBjb250aW51YWxseSB1cGRhdGluZyB0aGUgZ2VvbWV0cnkgc2luY2UgaXQncyBleHBlbnNpdmVcbiAqIHRvIHJlLXRlc3NlbGF0ZSB1c2luZyAqKmVhcmN1dCoqLiBDb25zaWRlciB1c2luZyB7QGxpbmsgUElYSS5NZXNofSBmb3IgdGhpcyB1c2UtY2FzZSwgaXQncyBtdWNoIGZhc3Rlci5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQmF0Y2hHZW9tZXRyeVxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIEdyYXBoaWNzR2VvbWV0cnkgZXh0ZW5kcyBCYXRjaEdlb21ldHJ5XG57XG4gICAgLyoqXG4gICAgICogVGhlIG1heGltdW0gbnVtYmVyIG9mIHBvaW50cyB0byBjb25zaWRlciBhbiBvYmplY3QgXCJiYXRjaGFibGVcIixcbiAgICAgKiBhYmxlIHRvIGJlIGJhdGNoZWQgYnkgdGhlIHJlbmRlcmVyJ3MgYmF0Y2ggc3lzdGVtLlxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIFBJWEkuR3JhcGhpY3NHZW9tZXRyeVxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9IEJBVENIQUJMRV9TSVpFXG4gICAgICogQGRlZmF1bHQgMTAwXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBCQVRDSEFCTEVfU0laRSA9IDEwMDtcblxuICAgIHB1YmxpYyBjbG9zZVBvaW50RXBzOiBudW1iZXI7XG4gICAgcHVibGljIGJvdW5kc1BhZGRpbmc6IG51bWJlcjtcblxuICAgIHV2c0Zsb2F0MzI6IEZsb2F0MzJBcnJheSA9IG51bGw7XG4gICAgaW5kaWNlc1VpbnQxNjogVWludDE2QXJyYXkgfCBVaW50MzJBcnJheSA9IG51bGw7XG4gICAgYmF0Y2hhYmxlOiBib29sZWFuO1xuICAgIHBvaW50czogQXJyYXk8bnVtYmVyPjtcbiAgICBjb2xvcnM6IEFycmF5PG51bWJlcj47XG4gICAgdXZzOiBBcnJheTxudW1iZXI+O1xuICAgIGluZGljZXM6IEFycmF5PG51bWJlcj47XG4gICAgdGV4dHVyZUlkczogQXJyYXk8bnVtYmVyPjtcbiAgICBncmFwaGljc0RhdGE6IEFycmF5PEdyYXBoaWNzRGF0YT47XG4gICAgZHJhd0NhbGxzOiBBcnJheTxCYXRjaERyYXdDYWxsPjtcbiAgICBiYXRjaERpcnR5OiBudW1iZXI7XG4gICAgYmF0Y2hlczogQXJyYXk8QmF0Y2hQYXJ0PjtcblxuICAgIHByb3RlY3RlZCBkaXJ0eTogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBjYWNoZURpcnR5OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIGNsZWFyRGlydHk6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgc2hhcGVJbmRleDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfYm91bmRzOiBCb3VuZHM7XG4gICAgcHJvdGVjdGVkIGJvdW5kc0RpcnR5OiBudW1iZXI7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBhcnJheSBvZiBwb2ludHMgdG8gZHJhdywgMiBudW1iZXJzIHBlciBwb2ludFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wb2ludHMgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNvbGxlY3Rpb24gb2YgY29sb3JzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcltdfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNvbG9ycyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgVVZzIGNvbGxlY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyW119XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbmRpY2VzIG9mIHRoZSB2ZXJ0aWNlc1xuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pbmRpY2VzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZmVyZW5jZSB0byB0aGUgdGV4dHVyZSBJRHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcltdfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRleHR1cmVJZHMgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNvbGxlY3Rpb24gb2YgZHJhd24gc2hhcGVzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkdyYXBoaWNzRGF0YVtdfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdyYXBoaWNzRGF0YSA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VkIHRvIGRldGVjdCBpZiB0aGUgZ3JhcGhpY3Mgb2JqZWN0IGhhcyBjaGFuZ2VkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZGlydHkgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYXRjaGVzIG5lZWQgdG8gcmVnZW5lcmF0ZWQgaWYgdGhlIGdlb21ldHJ5IGlzIHVwZGF0ZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5iYXRjaERpcnR5ID0gLTE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZWQgdG8gY2hlY2sgaWYgdGhlIGNhY2hlIGlzIGRpcnR5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2FjaGVEaXJ0eSA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VkIHRvIGRldGVjdCBpZiB3ZSBjbGVhcmVkIHRoZSBncmFwaGljc0RhdGEuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMFxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNsZWFyRGlydHkgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMaXN0IG9mIGN1cnJlbnQgZHJhdyBjYWxscyBkcml2ZWQgZnJvbSB0aGUgYmF0Y2hlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0W119XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZHJhd0NhbGxzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybWVkaWF0ZSBhYnN0cmFjdCBmb3JtYXQgc2VudCB0byBiYXRjaCBzeXN0ZW0uXG4gICAgICAgICAqIENhbiBiZSBjb252ZXJ0ZWQgdG8gZHJhd0NhbGxzIG9yIHRvIGJhdGNoYWJsZSBvYmplY3RzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLmdyYXBoaWNzVXRpbHMuQmF0Y2hQYXJ0W119XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYmF0Y2hlcyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbmRleCBvZiB0aGUgbGFzdCBiYXRjaGVkIHNoYXBlIGluIHRoZSBzdGFjayBvZiBjYWxscy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNoYXBlSW5kZXggPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWNoZWQgYm91bmRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJvdW5kc31cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYm91bmRzID0gbmV3IEJvdW5kcygpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgYm91bmRzIGRpcnR5IGZsYWcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ib3VuZHNEaXJ0eSA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQYWRkaW5nIHRvIGFkZCB0byB0aGUgYm91bmRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYm91bmRzUGFkZGluZyA9IDA7XG5cbiAgICAgICAgdGhpcy5iYXRjaGFibGUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLmluZGljZXNVaW50MTYgPSBudWxsO1xuXG4gICAgICAgIHRoaXMudXZzRmxvYXQzMiA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1pbmltYWwgZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgdGhhdCBhcmUgY29uc2lkZXJlZCBkaWZmZXJlbnQuXG4gICAgICAgICAqIEFmZmVjdHMgbGluZSB0ZXNzZWxhdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jbG9zZVBvaW50RXBzID0gMWUtNDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgYm91bmRzIG9mIHRoZSBncmFwaGljIGdlb21ldHJ5LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5Cb3VuZHN9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgcHVibGljIGdldCBib3VuZHMoKTogQm91bmRzXG4gICAge1xuICAgICAgICBpZiAodGhpcy5ib3VuZHNEaXJ0eSAhPT0gdGhpcy5kaXJ0eSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5ib3VuZHNEaXJ0eSA9IHRoaXMuZGlydHk7XG4gICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZUJvdW5kcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsIGlmIHlvdSBjaGFuZ2VkIGdyYXBoaWNzRGF0YSBtYW51YWxseS5cbiAgICAgKiBFbXB0aWVzIGFsbCBiYXRjaCBidWZmZXJzLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBpbnZhbGlkYXRlKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuYm91bmRzRGlydHkgPSAtMTtcbiAgICAgICAgdGhpcy5kaXJ0eSsrO1xuICAgICAgICB0aGlzLmJhdGNoRGlydHkrKztcbiAgICAgICAgdGhpcy5zaGFwZUluZGV4ID0gMDtcblxuICAgICAgICB0aGlzLnBvaW50cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmNvbG9ycy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnV2cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmluZGljZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy50ZXh0dXJlSWRzLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRyYXdDYWxscy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5kcmF3Q2FsbHNbaV0udGV4QXJyYXkuY2xlYXIoKTtcbiAgICAgICAgICAgIERSQVdfQ0FMTF9QT09MLnB1c2godGhpcy5kcmF3Q2FsbHNbaV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kcmF3Q2FsbHMubGVuZ3RoID0gMDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmF0Y2hlcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYmF0Y2hQYXJ0ID0gdGhpcy5iYXRjaGVzW2ldO1xuXG4gICAgICAgICAgICBiYXRjaFBhcnQucmVzZXQoKTtcbiAgICAgICAgICAgIEJBVENIX1BPT0wucHVzaChiYXRjaFBhcnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5iYXRjaGVzLmxlbmd0aCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBncmFwaGljcyB0aGF0IHdlcmUgZHJhd24gdG8gdGhpcyBHcmFwaGljcyBvYmplY3QsIGFuZCByZXNldHMgZmlsbCBhbmQgbGluZSBzdHlsZSBzZXR0aW5ncy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3NHZW9tZXRyeX0gVGhpcyBHcmFwaGljc0dlb21ldHJ5IG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGNsZWFyKCk6IEdyYXBoaWNzR2VvbWV0cnlcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmdyYXBoaWNzRGF0YS5sZW5ndGggPiAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJEaXJ0eSsrO1xuICAgICAgICAgICAgdGhpcy5ncmFwaGljc0RhdGEubGVuZ3RoID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERyYXdzIHRoZSBnaXZlbiBzaGFwZSB0byB0aGlzIEdyYXBoaWNzIG9iamVjdC4gQ2FuIGJlIGFueSBvZiBDaXJjbGUsIFJlY3RhbmdsZSwgRWxsaXBzZSwgTGluZSBvciBQb2x5Z29uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkNpcmNsZXxQSVhJLkVsbGlwc2V8UElYSS5Qb2x5Z29ufFBJWEkuUmVjdGFuZ2xlfFBJWEkuUm91bmRlZFJlY3RhbmdsZX0gc2hhcGUgLSBUaGUgc2hhcGUgb2JqZWN0IHRvIGRyYXcuXG4gICAgICogQHBhcmFtIHtQSVhJLkZpbGxTdHlsZX0gZmlsbFN0eWxlIC0gRGVmaW5lcyBzdHlsZSBvZiB0aGUgZmlsbC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuTGluZVN0eWxlfSBsaW5lU3R5bGUgLSBEZWZpbmVzIHN0eWxlIG9mIHRoZSBsaW5lcy5cbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBUcmFuc2Zvcm0gYXBwbGllZCB0byB0aGUgcG9pbnRzIG9mIHRoZSBzaGFwZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzR2VvbWV0cnl9IFJldHVybnMgZ2VvbWV0cnkgZm9yIGNoYWluaW5nLlxuICAgICAqL1xuICAgIHB1YmxpYyBkcmF3U2hhcGUoXG4gICAgICAgIHNoYXBlOiBJU2hhcGUsXG4gICAgICAgIGZpbGxTdHlsZTogRmlsbFN0eWxlID0gbnVsbCxcbiAgICAgICAgbGluZVN0eWxlOiBMaW5lU3R5bGUgPSBudWxsLFxuICAgICAgICBtYXRyaXg6IE1hdHJpeCA9IG51bGwpOiBHcmFwaGljc0dlb21ldHJ5XG4gICAge1xuICAgICAgICBjb25zdCBkYXRhID0gbmV3IEdyYXBoaWNzRGF0YShzaGFwZSwgZmlsbFN0eWxlLCBsaW5lU3R5bGUsIG1hdHJpeCk7XG5cbiAgICAgICAgdGhpcy5ncmFwaGljc0RhdGEucHVzaChkYXRhKTtcbiAgICAgICAgdGhpcy5kaXJ0eSsrO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERyYXdzIHRoZSBnaXZlbiBzaGFwZSB0byB0aGlzIEdyYXBoaWNzIG9iamVjdC4gQ2FuIGJlIGFueSBvZiBDaXJjbGUsIFJlY3RhbmdsZSwgRWxsaXBzZSwgTGluZSBvciBQb2x5Z29uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkNpcmNsZXxQSVhJLkVsbGlwc2V8UElYSS5Qb2x5Z29ufFBJWEkuUmVjdGFuZ2xlfFBJWEkuUm91bmRlZFJlY3RhbmdsZX0gc2hhcGUgLSBUaGUgc2hhcGUgb2JqZWN0IHRvIGRyYXcuXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gbWF0cml4IC0gVHJhbnNmb3JtIGFwcGxpZWQgdG8gdGhlIHBvaW50cyBvZiB0aGUgc2hhcGUuXG4gICAgICogQHJldHVybiB7UElYSS5HcmFwaGljc0dlb21ldHJ5fSBSZXR1cm5zIGdlb21ldHJ5IGZvciBjaGFpbmluZy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZHJhd0hvbGUoc2hhcGU6IElTaGFwZSwgbWF0cml4OiBNYXRyaXggPSBudWxsKTogR3JhcGhpY3NHZW9tZXRyeVxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmdyYXBoaWNzRGF0YS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBHcmFwaGljc0RhdGEoc2hhcGUsIG51bGwsIG51bGwsIG1hdHJpeCk7XG5cbiAgICAgICAgY29uc3QgbGFzdFNoYXBlID0gdGhpcy5ncmFwaGljc0RhdGFbdGhpcy5ncmFwaGljc0RhdGEubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgZGF0YS5saW5lU3R5bGUgPSBsYXN0U2hhcGUubGluZVN0eWxlO1xuXG4gICAgICAgIGxhc3RTaGFwZS5ob2xlcy5wdXNoKGRhdGEpO1xuXG4gICAgICAgIHRoaXMuZGlydHkrKztcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgR3JhcGhpY3NHZW9tZXRyeSBvYmplY3QuXG4gICAgICpcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG5cbiAgICAgICAgLy8gZGVzdHJveSBlYWNoIG9mIHRoZSBHcmFwaGljc0RhdGEgb2JqZWN0c1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZ3JhcGhpY3NEYXRhLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmdyYXBoaWNzRGF0YVtpXS5kZXN0cm95KCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnBvaW50cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnBvaW50cyA9IG51bGw7XG4gICAgICAgIHRoaXMuY29sb3JzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuY29sb3JzID0gbnVsbDtcbiAgICAgICAgdGhpcy51dnMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy51dnMgPSBudWxsO1xuICAgICAgICB0aGlzLmluZGljZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5pbmRpY2VzID0gbnVsbDtcbiAgICAgICAgdGhpcy5pbmRleEJ1ZmZlci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuaW5kZXhCdWZmZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmdyYXBoaWNzRGF0YS5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmdyYXBoaWNzRGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuZHJhd0NhbGxzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuZHJhd0NhbGxzID0gbnVsbDtcbiAgICAgICAgdGhpcy5iYXRjaGVzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuYmF0Y2hlcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2JvdW5kcyA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgdG8gc2VlIGlmIGEgcG9pbnQgaXMgY29udGFpbmVkIHdpdGhpbiB0aGlzIGdlb21ldHJ5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLklQb2ludERhdGF9IHBvaW50IC0gUG9pbnQgdG8gY2hlY2sgaWYgaXQncyBjb250YWluZWQuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwb2ludCBpcyBjb250YWluZWQgd2l0aGluIGdlb21ldHJ5LlxuICAgICAqL1xuICAgIHB1YmxpYyBjb250YWluc1BvaW50KHBvaW50OiBJUG9pbnREYXRhKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgY29uc3QgZ3JhcGhpY3NEYXRhID0gdGhpcy5ncmFwaGljc0RhdGE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncmFwaGljc0RhdGEubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBncmFwaGljc0RhdGFbaV07XG5cbiAgICAgICAgICAgIGlmICghZGF0YS5maWxsU3R5bGUudmlzaWJsZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gb25seSBkZWFsIHdpdGggZmlsbHMuLlxuICAgICAgICAgICAgaWYgKGRhdGEuc2hhcGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEubWF0cml4KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tYXRyaXguYXBwbHlJbnZlcnNlKHBvaW50LCB0bXBQb2ludCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRtcFBvaW50LmNvcHlGcm9tKHBvaW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zaGFwZS5jb250YWlucyh0bXBQb2ludC54LCB0bXBQb2ludC55KSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBoaXRIb2xlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaG9sZXMpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5ob2xlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBob2xlID0gZGF0YS5ob2xlc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChob2xlLnNoYXBlLmNvbnRhaW5zKHRtcFBvaW50LngsIHRtcFBvaW50LnkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGl0SG9sZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaGl0SG9sZSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGludGVybWVkaWF0ZSBiYXRjaCBkYXRhLiBFaXRoZXIgZ2V0cyBjb252ZXJ0ZWQgdG8gZHJhd0NhbGxzXG4gICAgICogb3IgdXNlZCB0byBjb252ZXJ0IHRvIGJhdGNoIG9iamVjdHMgZGlyZWN0bHkgYnkgdGhlIEdyYXBoaWNzIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2Fsb293MzJJbmRpY2VzXSAtIEFsbG93IHVzaW5nIDMyLWJpdCBpbmRpY2VzIGZvciBwcmV2ZW50aW5ncyBhcnRlZmFjdHMgd2hlbiBtb3JlIHRoYXQgNjU1MzUgdmVydGljZXNcbiAgICAgKi9cbiAgICB1cGRhdGVCYXRjaGVzKGFsbG93MzJJbmRpY2VzPzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5ncmFwaGljc0RhdGEubGVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJhdGNoYWJsZSA9IHRydWU7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0ZUJhdGNoaW5nKCkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2FjaGVEaXJ0eSA9IHRoaXMuZGlydHk7XG5cbiAgICAgICAgY29uc3QgdXZzID0gdGhpcy51dnM7XG4gICAgICAgIGNvbnN0IGdyYXBoaWNzRGF0YSA9IHRoaXMuZ3JhcGhpY3NEYXRhO1xuXG4gICAgICAgIGxldCBiYXRjaFBhcnQ6IEJhdGNoUGFydCA9IG51bGw7XG5cbiAgICAgICAgbGV0IGN1cnJlbnRTdHlsZSA9IG51bGw7XG5cbiAgICAgICAgaWYgKHRoaXMuYmF0Y2hlcy5sZW5ndGggPiAwKVxuICAgICAgICB7XG4gICAgICAgICAgICBiYXRjaFBhcnQgPSB0aGlzLmJhdGNoZXNbdGhpcy5iYXRjaGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgY3VycmVudFN0eWxlID0gYmF0Y2hQYXJ0LnN0eWxlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMuc2hhcGVJbmRleDsgaSA8IGdyYXBoaWNzRGF0YS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zaGFwZUluZGV4Kys7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBncmFwaGljc0RhdGFbaV07XG4gICAgICAgICAgICBjb25zdCBmaWxsU3R5bGUgPSBkYXRhLmZpbGxTdHlsZTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVTdHlsZSA9IGRhdGEubGluZVN0eWxlO1xuICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IEZJTExfQ09NTUFORFNbZGF0YS50eXBlXTtcblxuICAgICAgICAgICAgLy8gYnVpbGQgb3V0IHRoZSBzaGFwZXMgcG9pbnRzLi5cbiAgICAgICAgICAgIGNvbW1hbmQuYnVpbGQoZGF0YSk7XG5cbiAgICAgICAgICAgIGlmIChkYXRhLm1hdHJpeClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybVBvaW50cyhkYXRhLnBvaW50cywgZGF0YS5tYXRyaXgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDI7IGorKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdHlsZSA9IChqID09PSAwKSA/IGZpbGxTdHlsZSA6IGxpbmVTdHlsZTtcblxuICAgICAgICAgICAgICAgIGlmICghc3R5bGUudmlzaWJsZSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0VGV4dHVyZSA9IHN0eWxlLnRleHR1cmUuYmFzZVRleHR1cmU7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmluZGljZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYkluZGV4ID0gdGhpcy5wb2ludHMubGVuZ3RoIC8gMjtcblxuICAgICAgICAgICAgICAgIG5leHRUZXh0dXJlLndyYXBNb2RlID0gV1JBUF9NT0RFUy5SRVBFQVQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoaiA9PT0gMClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0ZpbGwoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0xpbmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9ICh0aGlzLnBvaW50cy5sZW5ndGggLyAyKSAtIGF0dHJpYkluZGV4O1xuXG4gICAgICAgICAgICAgICAgaWYgKHNpemUgPT09IDApIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIC8vIGNsb3NlIGJhdGNoIGlmIHN0eWxlIGlzIGRpZmZlcmVudFxuICAgICAgICAgICAgICAgIGlmIChiYXRjaFBhcnQgJiYgIXRoaXMuX2NvbXBhcmVTdHlsZXMoY3VycmVudFN0eWxlLCBzdHlsZSkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBiYXRjaFBhcnQuZW5kKGluZGV4LCBhdHRyaWJJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGJhdGNoUGFydCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNwYXduIG5ldyBiYXRjaCBpZiBpdHMgZmlyc3QgYmF0Y2ggb3IgcHJldmlvdXMgd2FzIGNsb3NlZFxuICAgICAgICAgICAgICAgIGlmICghYmF0Y2hQYXJ0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2hQYXJ0ID0gQkFUQ0hfUE9PTC5wb3AoKSB8fCBuZXcgQmF0Y2hQYXJ0KCk7XG4gICAgICAgICAgICAgICAgICAgIGJhdGNoUGFydC5iZWdpbihzdHlsZSwgaW5kZXgsIGF0dHJpYkluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYXRjaGVzLnB1c2goYmF0Y2hQYXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0eWxlID0gc3R5bGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRVdnModGhpcy5wb2ludHMsIHV2cywgc3R5bGUudGV4dHVyZSwgYXR0cmliSW5kZXgsIHNpemUsIHN0eWxlLm1hdHJpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5kaWNlcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGF0dHJpYiA9IHRoaXMucG9pbnRzLmxlbmd0aCAvIDI7XG5cbiAgICAgICAgaWYgKGJhdGNoUGFydClcbiAgICAgICAge1xuICAgICAgICAgICAgYmF0Y2hQYXJ0LmVuZChpbmRleCwgYXR0cmliKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmJhdGNoZXMubGVuZ3RoID09PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB0aGVyZSBhcmUgbm8gdmlzaWJsZSBzdHlsZXMgaW4gR3JhcGhpY3NEYXRhXG4gICAgICAgICAgICAvLyBpdHMgcG9zc2libGUgdGhhdCBzb21lb25lIHdhbnRzIEdyYXBoaWNzIGp1c3QgZm9yIHRoZSBib3VuZHNcbiAgICAgICAgICAgIHRoaXMuYmF0Y2hhYmxlID0gdHJ1ZTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJldmVudCBhbGxvY2F0aW9uIHdoZW4gbGVuZ3RoIGlzIHNhbWUgYXMgYnVmZmVyXG4gICAgICAgIGlmICh0aGlzLmluZGljZXNVaW50MTYgJiYgdGhpcy5pbmRpY2VzLmxlbmd0aCA9PT0gdGhpcy5pbmRpY2VzVWludDE2Lmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5pbmRpY2VzVWludDE2LnNldCh0aGlzLmluZGljZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbmVlZDMyXG4gICAgICAgICAgICAgICAgPSBhdHRyaWIgPiAweGZmZmYgJiYgYWxsb3czMkluZGljZXM7XG5cbiAgICAgICAgICAgIHRoaXMuaW5kaWNlc1VpbnQxNiA9IG5lZWQzMiA/IG5ldyBVaW50MzJBcnJheSh0aGlzLmluZGljZXMpIDogbmV3IFVpbnQxNkFycmF5KHRoaXMuaW5kaWNlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPIG1ha2UgdGhpcyBhIGNvbnN0Li5cbiAgICAgICAgdGhpcy5iYXRjaGFibGUgPSB0aGlzLmlzQmF0Y2hhYmxlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuYmF0Y2hhYmxlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnBhY2tCYXRjaGVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRHJhd0NhbGxzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZmZpbml0eSBjaGVja1xuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkZpbGxTdHlsZSB8IFBJWEkuTGluZVN0eWxlfSBzdHlsZUFcbiAgICAgKiBAcGFyYW0ge1BJWEkuRmlsbFN0eWxlIHwgUElYSS5MaW5lU3R5bGV9IHN0eWxlQlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY29tcGFyZVN0eWxlcyhzdHlsZUE6IEZpbGxTdHlsZSB8IExpbmVTdHlsZSwgc3R5bGVCOiBGaWxsU3R5bGUgfCBMaW5lU3R5bGUpOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAoIXN0eWxlQSB8fCAhc3R5bGVCKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3R5bGVBLnRleHR1cmUuYmFzZVRleHR1cmUgIT09IHN0eWxlQi50ZXh0dXJlLmJhc2VUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3R5bGVBLmNvbG9yICsgc3R5bGVBLmFscGhhICE9PSBzdHlsZUIuY29sb3IgKyBzdHlsZUIuYWxwaGEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghIShzdHlsZUEgYXMgTGluZVN0eWxlKS5uYXRpdmUgIT09ICEhKHN0eWxlQiBhcyBMaW5lU3R5bGUpLm5hdGl2ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdCBnZW9tZXRyeSBmb3IgYmF0Y2hpbmcgcHJvY2Vzcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgdmFsaWRhdGVCYXRjaGluZygpOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAodGhpcy5kaXJ0eSA9PT0gdGhpcy5jYWNoZURpcnR5IHx8ICF0aGlzLmdyYXBoaWNzRGF0YS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5ncmFwaGljc0RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5ncmFwaGljc0RhdGFbaV07XG4gICAgICAgICAgICBjb25zdCBmaWxsID0gZGF0YS5maWxsU3R5bGU7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gZGF0YS5saW5lU3R5bGU7XG5cbiAgICAgICAgICAgIGlmIChmaWxsICYmICFmaWxsLnRleHR1cmUuYmFzZVRleHR1cmUudmFsaWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChsaW5lICYmICFsaW5lLnRleHR1cmUuYmFzZVRleHR1cmUudmFsaWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9mZnNldCB0aGUgaW5kaWNlcyBzbyB0aGF0IGl0IHdvcmtzIHdpdGggdGhlIGJhdGNoZXIuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHBhY2tCYXRjaGVzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuYmF0Y2hEaXJ0eSsrO1xuICAgICAgICB0aGlzLnV2c0Zsb2F0MzIgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMudXZzKTtcblxuICAgICAgICBjb25zdCBiYXRjaGVzID0gdGhpcy5iYXRjaGVzO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gYmF0Y2hlcy5sZW5ndGg7IGkgPCBsOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGJhdGNoID0gYmF0Y2hlc1tpXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBiYXRjaC5zaXplOyBqKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBiYXRjaC5zdGFydCArIGo7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmluZGljZXNVaW50MTZbaW5kZXhdID0gdGhpcy5pbmRpY2VzVWludDE2W2luZGV4XSAtIGJhdGNoLmF0dHJpYlN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRvIHNlZSBpZiB0aGlzIGdyYXBoaWNzIGdlb21ldHJ5IGNhbiBiZSBiYXRjaGVkLlxuICAgICAqIEN1cnJlbnRseSBpdCBuZWVkcyB0byBiZSBzbWFsbCBlbm91Z2ggYW5kIG5vdCBjb250YWluIGFueSBuYXRpdmUgbGluZXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGlzQmF0Y2hhYmxlKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIC8vIHByZXZlbnQgaGVhdnkgbWVzaCBiYXRjaGluZ1xuICAgICAgICBpZiAodGhpcy5wb2ludHMubGVuZ3RoID4gMHhmZmZmICogMilcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmF0Y2hlcyA9IHRoaXMuYmF0Y2hlcztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhdGNoZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICgoYmF0Y2hlc1tpXS5zdHlsZSBhcyBMaW5lU3R5bGUpLm5hdGl2ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKHRoaXMucG9pbnRzLmxlbmd0aCA8IEdyYXBoaWNzR2VvbWV0cnkuQkFUQ0hBQkxFX1NJWkUgKiAyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBpbnRlcm1lZGlhdGUgYmF0Y2hlcyBkYXRhIHRvIGRyYXdDYWxscy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYnVpbGREcmF3Q2FsbHMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgbGV0IFRJQ0sgPSArK0Jhc2VUZXh0dXJlLl9nbG9iYWxCYXRjaDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZHJhd0NhbGxzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRyYXdDYWxsc1tpXS50ZXhBcnJheS5jbGVhcigpO1xuICAgICAgICAgICAgRFJBV19DQUxMX1BPT0wucHVzaCh0aGlzLmRyYXdDYWxsc1tpXSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRyYXdDYWxscy5sZW5ndGggPSAwO1xuXG4gICAgICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzO1xuICAgICAgICBjb25zdCB0ZXh0dXJlSWRzID0gdGhpcy50ZXh0dXJlSWRzO1xuXG4gICAgICAgIGxldCBjdXJyZW50R3JvdXA6IEJhdGNoRHJhd0NhbGwgPSAgRFJBV19DQUxMX1BPT0wucG9wKCk7XG5cbiAgICAgICAgaWYgKCFjdXJyZW50R3JvdXApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGN1cnJlbnRHcm91cCA9IG5ldyBCYXRjaERyYXdDYWxsKCk7XG4gICAgICAgICAgICBjdXJyZW50R3JvdXAudGV4QXJyYXkgPSBuZXcgQmF0Y2hUZXh0dXJlQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50R3JvdXAudGV4QXJyYXkuY291bnQgPSAwO1xuICAgICAgICBjdXJyZW50R3JvdXAuc3RhcnQgPSAwO1xuICAgICAgICBjdXJyZW50R3JvdXAuc2l6ZSA9IDA7XG4gICAgICAgIGN1cnJlbnRHcm91cC50eXBlID0gRFJBV19NT0RFUy5UUklBTkdMRVM7XG5cbiAgICAgICAgbGV0IHRleHR1cmVDb3VudCA9IDA7XG4gICAgICAgIGxldCBjdXJyZW50VGV4dHVyZSA9IG51bGw7XG4gICAgICAgIGxldCB0ZXh0dXJlSWQgPSAwO1xuICAgICAgICBsZXQgbmF0aXZlID0gZmFsc2U7XG4gICAgICAgIGxldCBkcmF3TW9kZSA9IERSQVdfTU9ERVMuVFJJQU5HTEVTO1xuXG4gICAgICAgIGxldCBpbmRleCA9IDA7XG5cbiAgICAgICAgdGhpcy5kcmF3Q2FsbHMucHVzaChjdXJyZW50R3JvdXApO1xuXG4gICAgICAgIC8vIFRPRE8gLSB0aGlzIGNhbiBiZSBzaW1wbGlmaWVkXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5iYXRjaGVzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5iYXRjaGVzW2ldO1xuXG4gICAgICAgICAgICAvLyBUT0RPIGFkZCBzb21lIGZ1bGwgb24gTUFYX1RFWFRVUkUgQ09ERS4uXG4gICAgICAgICAgICBjb25zdCBNQVhfVEVYVFVSRVMgPSA4O1xuXG4gICAgICAgICAgICAvLyBGb3JjZWQgY2FzdCBmb3IgY2hlY2tpbmcgYG5hdGl2ZWAgd2l0aG91dCBlcnJvcnNcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gZGF0YS5zdHlsZSBhcyBMaW5lU3R5bGU7XG5cbiAgICAgICAgICAgIGNvbnN0IG5leHRUZXh0dXJlID0gc3R5bGUudGV4dHVyZS5iYXNlVGV4dHVyZTtcblxuICAgICAgICAgICAgaWYgKG5hdGl2ZSAhPT0gISFzdHlsZS5uYXRpdmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmF0aXZlID0gISFzdHlsZS5uYXRpdmU7XG4gICAgICAgICAgICAgICAgZHJhd01vZGUgPSBuYXRpdmUgPyBEUkFXX01PREVTLkxJTkVTIDogRFJBV19NT0RFUy5UUklBTkdMRVM7XG5cbiAgICAgICAgICAgICAgICAvLyBmb3JjZSB0aGUgYmF0Y2ggdG8gYnJlYWshXG4gICAgICAgICAgICAgICAgY3VycmVudFRleHR1cmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRleHR1cmVDb3VudCA9IE1BWF9URVhUVVJFUztcbiAgICAgICAgICAgICAgICBUSUNLKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXJyZW50VGV4dHVyZSAhPT0gbmV4dFRleHR1cmUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY3VycmVudFRleHR1cmUgPSBuZXh0VGV4dHVyZTtcblxuICAgICAgICAgICAgICAgIGlmIChuZXh0VGV4dHVyZS5fYmF0Y2hFbmFibGVkICE9PSBUSUNLKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHR1cmVDb3VudCA9PT0gTUFYX1RFWFRVUkVTKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBUSUNLKys7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmVDb3VudCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50R3JvdXAuc2l6ZSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEdyb3VwID0gRFJBV19DQUxMX1BPT0wucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50R3JvdXApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAgPSBuZXcgQmF0Y2hEcmF3Q2FsbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAudGV4QXJyYXkgPSBuZXcgQmF0Y2hUZXh0dXJlQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3Q2FsbHMucHVzaChjdXJyZW50R3JvdXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAuc3RhcnQgPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cC5zaXplID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cC50ZXhBcnJheS5jb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAudHlwZSA9IGRyYXdNb2RlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyBhZGQgdGhpcyB0byB0aGUgcmVuZGVyIHBhcnQuLlxuICAgICAgICAgICAgICAgICAgICAvLyBIYWNrISBCZWNhdXNlIHRleHR1cmUgaGFzIHByb3RlY3RlZCBgdG91Y2hlZGBcbiAgICAgICAgICAgICAgICAgICAgbmV4dFRleHR1cmUudG91Y2hlZCA9IDE7Ly8gdG91Y2g7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV4dFRleHR1cmUuX2JhdGNoRW5hYmxlZCA9IFRJQ0s7XG4gICAgICAgICAgICAgICAgICAgIG5leHRUZXh0dXJlLl9iYXRjaExvY2F0aW9uID0gdGV4dHVyZUNvdW50O1xuICAgICAgICAgICAgICAgICAgICBuZXh0VGV4dHVyZS53cmFwTW9kZSA9IDEwNDk3O1xuXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cC50ZXhBcnJheS5lbGVtZW50c1tjdXJyZW50R3JvdXAudGV4QXJyYXkuY291bnQrK10gPSBuZXh0VGV4dHVyZTtcbiAgICAgICAgICAgICAgICAgICAgdGV4dHVyZUNvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjdXJyZW50R3JvdXAuc2l6ZSArPSBkYXRhLnNpemU7XG4gICAgICAgICAgICBpbmRleCArPSBkYXRhLnNpemU7XG5cbiAgICAgICAgICAgIHRleHR1cmVJZCA9IG5leHRUZXh0dXJlLl9iYXRjaExvY2F0aW9uO1xuXG4gICAgICAgICAgICB0aGlzLmFkZENvbG9ycyhjb2xvcnMsIHN0eWxlLmNvbG9yLCBzdHlsZS5hbHBoYSwgZGF0YS5hdHRyaWJTaXplKTtcbiAgICAgICAgICAgIHRoaXMuYWRkVGV4dHVyZUlkcyh0ZXh0dXJlSWRzLCB0ZXh0dXJlSWQsIGRhdGEuYXR0cmliU2l6ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBCYXNlVGV4dHVyZS5fZ2xvYmFsQmF0Y2ggPSBUSUNLO1xuXG4gICAgICAgIC8vIHVwbG9hZC4uXG4gICAgICAgIC8vIG1lcmdlIGZvciBub3chXG4gICAgICAgIHRoaXMucGFja0F0dHJpYnV0ZXMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYWNrcyBhdHRyaWJ1dGVzIHRvIHNpbmdsZSBidWZmZXIuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHBhY2tBdHRyaWJ1dGVzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy5wb2ludHM7XG4gICAgICAgIGNvbnN0IHV2cyA9IHRoaXMudXZzO1xuICAgICAgICBjb25zdCBjb2xvcnMgPSB0aGlzLmNvbG9ycztcbiAgICAgICAgY29uc3QgdGV4dHVyZUlkcyA9IHRoaXMudGV4dHVyZUlkcztcblxuICAgICAgICAvLyB2ZXJ0cyBhcmUgMiBwb3NpdGlvbnMuLiBzbyB3ZSAqIGJ5IDMgYXMgdGhlcmUgYXJlIDYgcHJvcGVydGllcy4uIHRoZW4gNCBjb3MgaXRzIGJ5dGVzXG4gICAgICAgIGNvbnN0IGdsUG9pbnRzID0gbmV3IEFycmF5QnVmZmVyKHZlcnRzLmxlbmd0aCAqIDMgKiA0KTtcbiAgICAgICAgY29uc3QgZjMyID0gbmV3IEZsb2F0MzJBcnJheShnbFBvaW50cyk7XG4gICAgICAgIGNvbnN0IHUzMiA9IG5ldyBVaW50MzJBcnJheShnbFBvaW50cyk7XG5cbiAgICAgICAgbGV0IHAgPSAwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoIC8gMjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBmMzJbcCsrXSA9IHZlcnRzW2kgKiAyXTtcbiAgICAgICAgICAgIGYzMltwKytdID0gdmVydHNbKGkgKiAyKSArIDFdO1xuXG4gICAgICAgICAgICBmMzJbcCsrXSA9IHV2c1tpICogMl07XG4gICAgICAgICAgICBmMzJbcCsrXSA9IHV2c1soaSAqIDIpICsgMV07XG5cbiAgICAgICAgICAgIHUzMltwKytdID0gY29sb3JzW2ldO1xuXG4gICAgICAgICAgICBmMzJbcCsrXSA9IHRleHR1cmVJZHNbaV07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9idWZmZXIudXBkYXRlKGdsUG9pbnRzKTtcbiAgICAgICAgdGhpcy5faW5kZXhCdWZmZXIudXBkYXRlKHRoaXMuaW5kaWNlc1VpbnQxNik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBmaWxsIHBhcnQgb2YgR3JhcGhpY3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuR3JhcGhpY3NEYXRhfSBkYXRhXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBwcm9jZXNzRmlsbChkYXRhOiBHcmFwaGljc0RhdGEpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoZGF0YS5ob2xlcy5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0hvbGVzKGRhdGEuaG9sZXMpO1xuXG4gICAgICAgICAgICBidWlsZFBvbHkudHJpYW5ndWxhdGUoZGF0YSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBjb21tYW5kID0gRklMTF9DT01NQU5EU1tkYXRhLnR5cGVdO1xuXG4gICAgICAgICAgICBjb21tYW5kLnRyaWFuZ3VsYXRlKGRhdGEsIHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBsaW5lIHBhcnQgb2YgR3JhcGhpY3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuR3JhcGhpY3NEYXRhfSBkYXRhXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBwcm9jZXNzTGluZShkYXRhOiBHcmFwaGljc0RhdGEpOiB2b2lkXG4gICAge1xuICAgICAgICBidWlsZExpbmUoZGF0YSwgdGhpcyk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmhvbGVzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBidWlsZExpbmUoZGF0YS5ob2xlc1tpXSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHRoZSBob2xlcyBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQSVhJLkdyYXBoaWNzRGF0YVtdfSBob2xlcyAtIEhvbGVzIHRvIHJlbmRlclxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgcHJvY2Vzc0hvbGVzKGhvbGVzOiBBcnJheTxHcmFwaGljc0RhdGE+KTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBob2xlcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgaG9sZSA9IGhvbGVzW2ldO1xuICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IEZJTExfQ09NTUFORFNbaG9sZS50eXBlXTtcblxuICAgICAgICAgICAgY29tbWFuZC5idWlsZChob2xlKTtcblxuICAgICAgICAgICAgaWYgKGhvbGUubWF0cml4KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtUG9pbnRzKGhvbGUucG9pbnRzLCBob2xlLm1hdHJpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGxvY2FsIGJvdW5kcyBvZiB0aGUgb2JqZWN0LiBFeHBlbnNpdmUgdG8gdXNlIHBlcmZvcm1hbmNlLXdpc2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNhbGN1bGF0ZUJvdW5kcygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBib3VuZHMgPSB0aGlzLl9ib3VuZHM7XG4gICAgICAgIGNvbnN0IHNlcXVlbmNlQm91bmRzID0gdG1wQm91bmRzO1xuICAgICAgICBsZXQgY3VyTWF0cml4ID0gTWF0cml4LklERU5USVRZO1xuXG4gICAgICAgIHRoaXMuX2JvdW5kcy5jbGVhcigpO1xuICAgICAgICBzZXF1ZW5jZUJvdW5kcy5jbGVhcigpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ncmFwaGljc0RhdGEubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdyYXBoaWNzRGF0YVtpXTtcbiAgICAgICAgICAgIGNvbnN0IHNoYXBlID0gZGF0YS5zaGFwZTtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBkYXRhLnR5cGU7XG4gICAgICAgICAgICBjb25zdCBsaW5lU3R5bGUgPSBkYXRhLmxpbmVTdHlsZTtcbiAgICAgICAgICAgIGNvbnN0IG5leHRNYXRyaXggPSBkYXRhLm1hdHJpeCB8fCBNYXRyaXguSURFTlRJVFk7XG4gICAgICAgICAgICBsZXQgbGluZVdpZHRoID0gMC4wO1xuXG4gICAgICAgICAgICBpZiAobGluZVN0eWxlICYmIGxpbmVTdHlsZS52aXNpYmxlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsaWdubWVudCA9IGxpbmVTdHlsZS5hbGlnbm1lbnQ7XG5cbiAgICAgICAgICAgICAgICBsaW5lV2lkdGggPSBsaW5lU3R5bGUud2lkdGg7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gU0hBUEVTLlBPTFkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGggPSBsaW5lV2lkdGggKiAoMC41ICsgTWF0aC5hYnMoMC41IC0gYWxpZ25tZW50KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aCA9IGxpbmVXaWR0aCAqIE1hdGgubWF4KDAsIGFsaWdubWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3VyTWF0cml4ICE9PSBuZXh0TWF0cml4KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghc2VxdWVuY2VCb3VuZHMuaXNFbXB0eSgpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYm91bmRzLmFkZEJvdW5kc01hdHJpeChzZXF1ZW5jZUJvdW5kcywgY3VyTWF0cml4KTtcbiAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2VCb3VuZHMuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VyTWF0cml4ID0gbmV4dE1hdHJpeDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFNIQVBFUy5SRUNUIHx8IHR5cGUgPT09IFNIQVBFUy5SUkVDKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBzaGFwZSBhcyBSZWN0YW5nbGUgfCBSb3VuZGVkUmVjdGFuZ2xlO1xuXG4gICAgICAgICAgICAgICAgc2VxdWVuY2VCb3VuZHMuYWRkRnJhbWVQYWQocmVjdC54LCByZWN0LnksIHJlY3QueCArIHJlY3Qud2lkdGgsIHJlY3QueSArIHJlY3QuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGgsIGxpbmVXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSBTSEFQRVMuQ0lSQylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaXJjbGUgPSBzaGFwZSBhcyBDaXJjbGU7XG5cbiAgICAgICAgICAgICAgICBzZXF1ZW5jZUJvdW5kcy5hZGRGcmFtZVBhZChjaXJjbGUueCwgY2lyY2xlLnksIGNpcmNsZS54LCBjaXJjbGUueSxcbiAgICAgICAgICAgICAgICAgICAgY2lyY2xlLnJhZGl1cyArIGxpbmVXaWR0aCwgY2lyY2xlLnJhZGl1cyArIGxpbmVXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSBTSEFQRVMuRUxJUClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGxpcHNlID0gc2hhcGUgYXMgRWxsaXBzZTtcblxuICAgICAgICAgICAgICAgIHNlcXVlbmNlQm91bmRzLmFkZEZyYW1lUGFkKGVsbGlwc2UueCwgZWxsaXBzZS55LCBlbGxpcHNlLngsIGVsbGlwc2UueSxcbiAgICAgICAgICAgICAgICAgICAgZWxsaXBzZS53aWR0aCArIGxpbmVXaWR0aCwgZWxsaXBzZS5oZWlnaHQgKyBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBvbHkgPSBzaGFwZSBhcyBQb2x5Z29uO1xuICAgICAgICAgICAgICAgIC8vIGFkZGluZyBkaXJlY3RseSB0byB0aGUgYm91bmRzXG5cbiAgICAgICAgICAgICAgICBib3VuZHMuYWRkVmVydGljZXNNYXRyaXgoY3VyTWF0cml4LCAocG9seS5wb2ludHMgYXMgYW55KSwgMCwgcG9seS5wb2ludHMubGVuZ3RoLCBsaW5lV2lkdGgsIGxpbmVXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNlcXVlbmNlQm91bmRzLmlzRW1wdHkoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgYm91bmRzLmFkZEJvdW5kc01hdHJpeChzZXF1ZW5jZUJvdW5kcywgY3VyTWF0cml4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJvdW5kcy5wYWQodGhpcy5ib3VuZHNQYWRkaW5nLCB0aGlzLmJvdW5kc1BhZGRpbmcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyYW5zZm9ybSBwb2ludHMgdXNpbmcgbWF0cml4LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHBvaW50cyAtIFBvaW50cyB0byB0cmFuc2Zvcm1cbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBUcmFuc2Zvcm0gbWF0cml4XG4gICAgICovXG4gICAgcHJvdGVjdGVkIHRyYW5zZm9ybVBvaW50cyhwb2ludHM6IEFycmF5PG51bWJlcj4sIG1hdHJpeDogTWF0cml4KTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB4ID0gcG9pbnRzWyhpICogMildO1xuICAgICAgICAgICAgY29uc3QgeSA9IHBvaW50c1soaSAqIDIpICsgMV07XG5cbiAgICAgICAgICAgIHBvaW50c1soaSAqIDIpXSA9IChtYXRyaXguYSAqIHgpICsgKG1hdHJpeC5jICogeSkgKyBtYXRyaXgudHg7XG4gICAgICAgICAgICBwb2ludHNbKGkgKiAyKSArIDFdID0gKG1hdHJpeC5iICogeCkgKyAobWF0cml4LmQgKiB5KSArIG1hdHJpeC50eTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBjb2xvcnMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gY29sb3JzIC0gTGlzdCBvZiBjb2xvcnMgdG8gYWRkIHRvXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbG9yIC0gQ29sb3IgdG8gYWRkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFscGhhIC0gQWxwaGEgdG8gdXNlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBOdW1iZXIgb2YgY29sb3JzIHRvIGFkZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhZGRDb2xvcnMoY29sb3JzOiBBcnJheTxudW1iZXI+LCBjb2xvcjogbnVtYmVyLCBhbHBoYTogbnVtYmVyLCBzaXplOiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBUT0RPIHVzZSB0aGUgcHJlbXVsdGlwbHkgYml0cyBJdmFuIGFkZGVkXG4gICAgICAgIGNvbnN0IHJnYiA9IChjb2xvciA+PiAxNikgKyAoY29sb3IgJiAweGZmMDApICsgKChjb2xvciAmIDB4ZmYpIDw8IDE2KTtcblxuICAgICAgICBjb25zdCByZ2JhID0gIHByZW11bHRpcGx5VGludChyZ2IsIGFscGhhKTtcblxuICAgICAgICB3aGlsZSAoc2l6ZS0tID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgY29sb3JzLnB1c2gocmdiYSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgdGV4dHVyZSBpZCB0aGF0IHRoZSBzaGFkZXIvZnJhZ21lbnQgd2FudHMgdG8gdXNlLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHRleHR1cmVJZHNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2l6ZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhZGRUZXh0dXJlSWRzKHRleHR1cmVJZHM6IEFycmF5PG51bWJlcj4sIGlkOiBudW1iZXIsIHNpemU6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIHdoaWxlIChzaXplLS0gPiAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0dXJlSWRzLnB1c2goaWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIHRoZSBVVnMgZm9yIGEgc2hhcGUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gdmVydHMgLSBWZXJ0aWNlc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHV2cyAtIFVWc1xuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0dXJlfSB0ZXh0dXJlIC0gUmVmZXJlbmNlIHRvIFRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnQgLSBJbmRleCBidWZmZXIgc3RhcnQgaW5kZXguXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBUaGUgc2l6ZS9sZW5ndGggZm9yIGluZGV4IGJ1ZmZlci5cbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBbbWF0cml4XSAtIE9wdGlvbmFsIHRyYW5zZm9ybSBmb3IgYWxsIHBvaW50cy5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWRkVXZzKFxuICAgICAgICB2ZXJ0czogQXJyYXk8bnVtYmVyPixcbiAgICAgICAgdXZzOiBBcnJheTxudW1iZXI+LFxuICAgICAgICB0ZXh0dXJlOiBUZXh0dXJlLFxuICAgICAgICBzdGFydDogbnVtYmVyLCBzaXplOlxuICAgICAgICBudW1iZXIsIG1hdHJpeDpcbiAgICAgICAgTWF0cml4ID0gbnVsbCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCBpbmRleCA9IDA7XG4gICAgICAgIGNvbnN0IHV2c1N0YXJ0ID0gdXZzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgZnJhbWUgPSB0ZXh0dXJlLmZyYW1lO1xuXG4gICAgICAgIHdoaWxlIChpbmRleCA8IHNpemUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCB4ID0gdmVydHNbKHN0YXJ0ICsgaW5kZXgpICogMl07XG4gICAgICAgICAgICBsZXQgeSA9IHZlcnRzWygoc3RhcnQgKyBpbmRleCkgKiAyKSArIDFdO1xuXG4gICAgICAgICAgICBpZiAobWF0cml4KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IG54ID0gKG1hdHJpeC5hICogeCkgKyAobWF0cml4LmMgKiB5KSArIG1hdHJpeC50eDtcblxuICAgICAgICAgICAgICAgIHkgPSAobWF0cml4LmIgKiB4KSArIChtYXRyaXguZCAqIHkpICsgbWF0cml4LnR5O1xuICAgICAgICAgICAgICAgIHggPSBueDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW5kZXgrKztcblxuICAgICAgICAgICAgdXZzLnB1c2goeCAvIGZyYW1lLndpZHRoLCB5IC8gZnJhbWUuaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJhc2VUZXh0dXJlID0gdGV4dHVyZS5iYXNlVGV4dHVyZTtcblxuICAgICAgICBpZiAoZnJhbWUud2lkdGggPCBiYXNlVGV4dHVyZS53aWR0aFxuICAgICAgICAgICAgfHwgZnJhbWUuaGVpZ2h0IDwgYmFzZVRleHR1cmUuaGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFkanVzdFV2cyh1dnMsIHRleHR1cmUsIHV2c1N0YXJ0LCBzaXplKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1vZGlmeSB1dnMgYXJyYXkgYWNjb3JkaW5nIHRvIHBvc2l0aW9uIG9mIHRleHR1cmUgcmVnaW9uXG4gICAgICogRG9lcyBub3Qgd29yayB3aXRoIHJvdGF0ZWQgb3IgdHJpbW1lZCB0ZXh0dXJlc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gdXZzIC0gYXJyYXlcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gdGV4dHVyZSAtIHJlZ2lvblxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCAtIHN0YXJ0aW5nIGluZGV4IGZvciB1dnNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2l6ZSAtIGhvdyBtYW55IHBvaW50cyB0byBhZGp1c3RcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWRqdXN0VXZzKHV2czogQXJyYXk8bnVtYmVyPiwgdGV4dHVyZTogVGV4dHVyZSwgc3RhcnQ6IG51bWJlciwgc2l6ZTogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgYmFzZVRleHR1cmUgPSB0ZXh0dXJlLmJhc2VUZXh0dXJlO1xuICAgICAgICBjb25zdCBlcHMgPSAxZS02O1xuICAgICAgICBjb25zdCBmaW5pc2ggPSBzdGFydCArIChzaXplICogMik7XG4gICAgICAgIGNvbnN0IGZyYW1lID0gdGV4dHVyZS5mcmFtZTtcbiAgICAgICAgY29uc3Qgc2NhbGVYID0gZnJhbWUud2lkdGggLyBiYXNlVGV4dHVyZS53aWR0aDtcbiAgICAgICAgY29uc3Qgc2NhbGVZID0gZnJhbWUuaGVpZ2h0IC8gYmFzZVRleHR1cmUuaGVpZ2h0O1xuICAgICAgICBsZXQgb2Zmc2V0WCA9IGZyYW1lLnggLyBmcmFtZS53aWR0aDtcbiAgICAgICAgbGV0IG9mZnNldFkgPSBmcmFtZS55IC8gZnJhbWUuaGVpZ2h0O1xuICAgICAgICBsZXQgbWluWCA9IE1hdGguZmxvb3IodXZzW3N0YXJ0XSArIGVwcyk7XG4gICAgICAgIGxldCBtaW5ZID0gTWF0aC5mbG9vcih1dnNbc3RhcnQgKyAxXSArIGVwcyk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0ICsgMjsgaSA8IGZpbmlzaDsgaSArPSAyKVxuICAgICAgICB7XG4gICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgTWF0aC5mbG9vcih1dnNbaV0gKyBlcHMpKTtcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBNYXRoLmZsb29yKHV2c1tpICsgMV0gKyBlcHMpKTtcbiAgICAgICAgfVxuICAgICAgICBvZmZzZXRYIC09IG1pblg7XG4gICAgICAgIG9mZnNldFkgLT0gbWluWTtcbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgZmluaXNoOyBpICs9IDIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHV2c1tpXSA9ICh1dnNbaV0gKyBvZmZzZXRYKSAqIHNjYWxlWDtcbiAgICAgICAgICAgIHV2c1tpICsgMV0gPSAodXZzW2kgKyAxXSArIG9mZnNldFkpICogc2NhbGVZO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEZpbGxTdHlsZSB9IGZyb20gJy4vRmlsbFN0eWxlJztcbmltcG9ydCB7IExJTkVfSk9JTiwgTElORV9DQVAgfSBmcm9tICcuLi9jb25zdCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgbGluZSBzdHlsZSBmb3IgR3JhcGhpY3MuXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkZpbGxTdHlsZVxuICovXG5leHBvcnQgY2xhc3MgTGluZVN0eWxlIGV4dGVuZHMgRmlsbFN0eWxlXG57XG4gICAgLyoqXG4gICAgICogVGhlIHdpZHRoICh0aGlja25lc3MpIG9mIGFueSBsaW5lcyBkcmF3bi5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAwXG4gICAgICovXG4gICAgcHVibGljIHdpZHRoID0gMDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBhbGlnbm1lbnQgb2YgYW55IGxpbmVzIGRyYXduICgwLjUgPSBtaWRkbGUsIDEgPSBvdXRlciwgMCA9IGlubmVyKS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAwLjVcbiAgICAgKi9cbiAgICBwdWJsaWMgYWxpZ25tZW50ID0gMC41O1xuXG4gICAgLyoqXG4gICAgICogSWYgdHJ1ZSB0aGUgbGluZXMgd2lsbCBiZSBkcmF3IHVzaW5nIExJTkVTIGluc3RlYWQgb2YgVFJJQU5HTEVfU1RSSVBcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgKi9cbiAgICBwdWJsaWMgbmF0aXZlID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBMaW5lIGNhcCBzdHlsZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuTElORV9DQVB9XG4gICAgICogQGRlZmF1bHQgUElYSS5MSU5FX0NBUC5CVVRUXG4gICAgICovXG4gICAgcHVibGljIGNhcCA9IExJTkVfQ0FQLkJVVFQ7XG5cbiAgICAvKipcbiAgICAgKiBMaW5lIGpvaW4gc3R5bGUuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLkxJTkVfSk9JTn1cbiAgICAgKiBAZGVmYXVsdCBQSVhJLkxJTkVfSk9JTi5NSVRFUlxuICAgICAqL1xuICAgIHB1YmxpYyBqb2luID0gTElORV9KT0lOLk1JVEVSO1xuXG4gICAgLyoqXG4gICAgICogTWl0ZXIgbGltaXQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMTBcbiAgICAgKi9cbiAgICBwdWJsaWMgbWl0ZXJMaW1pdCA9IDEwO1xuXG4gICAgLyoqXG4gICAgICogQ2xvbmVzIHRoZSBvYmplY3RcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuTGluZVN0eWxlfVxuICAgICAqL1xuICAgIHB1YmxpYyBjbG9uZSgpOiBMaW5lU3R5bGVcbiAgICB7XG4gICAgICAgIGNvbnN0IG9iaiA9IG5ldyBMaW5lU3R5bGUoKTtcblxuICAgICAgICBvYmouY29sb3IgPSB0aGlzLmNvbG9yO1xuICAgICAgICBvYmouYWxwaGEgPSB0aGlzLmFscGhhO1xuICAgICAgICBvYmoudGV4dHVyZSA9IHRoaXMudGV4dHVyZTtcbiAgICAgICAgb2JqLm1hdHJpeCA9IHRoaXMubWF0cml4O1xuICAgICAgICBvYmoudmlzaWJsZSA9IHRoaXMudmlzaWJsZTtcbiAgICAgICAgb2JqLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICAgICAgb2JqLmFsaWdubWVudCA9IHRoaXMuYWxpZ25tZW50O1xuICAgICAgICBvYmoubmF0aXZlID0gdGhpcy5uYXRpdmU7XG4gICAgICAgIG9iai5jYXAgPSB0aGlzLmNhcDtcbiAgICAgICAgb2JqLmpvaW4gPSB0aGlzLmpvaW47XG4gICAgICAgIG9iai5taXRlckxpbWl0ID0gdGhpcy5taXRlckxpbWl0O1xuXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXQgdGhlIGxpbmUgc3R5bGUgdG8gZGVmYXVsdC5cbiAgICAgKi9cbiAgICBwdWJsaWMgcmVzZXQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIucmVzZXQoKTtcblxuICAgICAgICAvLyBPdmVycmlkZSBkZWZhdWx0IGxpbmUgc3R5bGUgY29sb3JcbiAgICAgICAgdGhpcy5jb2xvciA9IDB4MDtcblxuICAgICAgICB0aGlzLmFsaWdubWVudCA9IDAuNTtcbiAgICAgICAgdGhpcy53aWR0aCA9IDA7XG4gICAgICAgIHRoaXMubmF0aXZlID0gZmFsc2U7XG4gICAgfVxufVxuIiwgImltcG9ydCB7XG4gICAgQ2lyY2xlLFxuICAgIEVsbGlwc2UsXG4gICAgUElfMixcbiAgICBQb2ludCxcbiAgICBQb2x5Z29uLFxuICAgIFJlY3RhbmdsZSxcbiAgICBSb3VuZGVkUmVjdGFuZ2xlLFxuICAgIE1hdHJpeCxcbiAgICBTSEFQRVMsXG59IGZyb20gJ0BwaXhpL21hdGgnO1xuXG5pbXBvcnQgeyBUZXh0dXJlLCBVbmlmb3JtR3JvdXAsIFN0YXRlLCBSZW5kZXJlciwgQmF0Y2hEcmF3Q2FsbCB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHsgQmV6aWVyVXRpbHMsIFF1YWRyYXRpY1V0aWxzLCBBcmNVdGlscywgU3RhciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgaGV4MnJnYiwgZGVwcmVjYXRpb24gfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgeyBHcmFwaGljc0dlb21ldHJ5IH0gZnJvbSAnLi9HcmFwaGljc0dlb21ldHJ5JztcbmltcG9ydCB7IEZpbGxTdHlsZSB9IGZyb20gJy4vc3R5bGVzL0ZpbGxTdHlsZSc7XG5pbXBvcnQgeyBMaW5lU3R5bGUgfSBmcm9tICcuL3N0eWxlcy9MaW5lU3R5bGUnO1xuaW1wb3J0IHsgQkxFTkRfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBTaGFkZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuaW1wb3J0IHR5cGUgeyBJU2hhcGUsIElQb2ludERhdGEgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB0eXBlIHsgSURlc3Ryb3lPcHRpb25zIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBMSU5FX0pPSU4sIExJTkVfQ0FQIH0gZnJvbSAnLi9jb25zdCc7XG5cbi8qKlxuICogQmF0Y2ggZWxlbWVudCBjb21wdXRlZCBmcm9tIEdyYXBoaWNzIGdlb21ldHJ5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUdyYXBoaWNzQmF0Y2hFbGVtZW50IHtcbiAgICB2ZXJ0ZXhEYXRhOiBGbG9hdDMyQXJyYXk7XG4gICAgYmxlbmRNb2RlOiBCTEVORF9NT0RFUztcbiAgICBpbmRpY2VzOiBVaW50MTZBcnJheSB8IFVpbnQzMkFycmF5O1xuICAgIHV2czogRmxvYXQzMkFycmF5O1xuICAgIGFscGhhOiBudW1iZXI7XG4gICAgd29ybGRBbHBoYTogbnVtYmVyO1xuICAgIF9iYXRjaFJHQjogbnVtYmVyW107XG4gICAgX3RpbnRSR0I6IG51bWJlcjtcbiAgICBfdGV4dHVyZTogVGV4dHVyZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJRmlsbFN0eWxlT3B0aW9ucyB7XG4gICAgY29sb3I/OiBudW1iZXI7XG4gICAgYWxwaGE/OiBudW1iZXI7XG4gICAgdGV4dHVyZT86IFRleHR1cmU7XG4gICAgbWF0cml4PzogTWF0cml4O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElMaW5lU3R5bGVPcHRpb25zIGV4dGVuZHMgSUZpbGxTdHlsZU9wdGlvbnMge1xuICAgIHdpZHRoPzogbnVtYmVyO1xuICAgIGFsaWdubWVudD86IG51bWJlcjtcbiAgICBuYXRpdmU/OiBib29sZWFuO1xuICAgIGNhcD86IExJTkVfQ0FQO1xuICAgIGpvaW4/OiBMSU5FX0pPSU47XG4gICAgbWl0ZXJMaW1pdD86IG51bWJlcjtcbn1cblxuY29uc3QgdGVtcCA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7XG5cbi8vIGEgZGVmYXVsdCBzaGFkZXJzIG1hcCB1c2VkIGJ5IGdyYXBoaWNzLi5cbmNvbnN0IERFRkFVTFRfU0hBREVSUzoge1trZXk6IHN0cmluZ106IFNoYWRlcn0gPSB7fTtcblxuZXhwb3J0IGludGVyZmFjZSBHcmFwaGljcyBleHRlbmRzIEdsb2JhbE1peGlucy5HcmFwaGljcywgQ29udGFpbmVyIHt9XG5cbi8qKlxuICogVGhlIEdyYXBoaWNzIGNsYXNzIGNvbnRhaW5zIG1ldGhvZHMgdXNlZCB0byBkcmF3IHByaW1pdGl2ZSBzaGFwZXMgc3VjaCBhcyBsaW5lcywgY2lyY2xlcyBhbmRcbiAqIHJlY3RhbmdsZXMgdG8gdGhlIGRpc3BsYXksIGFuZCB0byBjb2xvciBhbmQgZmlsbCB0aGVtLlxuICpcbiAqIE5vdGUgdGhhdCBiZWNhdXNlIEdyYXBoaWNzIGNhbiBzaGFyZSBhIEdyYXBoaWNzR2VvbWV0cnkgd2l0aCBvdGhlciBpbnN0YW5jZXMsXG4gKiBpdCBpcyBuZWNlc3NhcnkgdG8gY2FsbCBgZGVzdHJveSgpYCB0byBwcm9wZXJseSBkZXJlZmVyZW5jZSB0aGUgdW5kZXJseWluZ1xuICogR3JhcGhpY3NHZW9tZXRyeSBhbmQgYXZvaWQgYSBtZW1vcnkgbGVhay4gQWx0ZXJuYXRpdmVseSwga2VlcCB1c2luZyB0aGUgc2FtZVxuICogR3JhcGhpY3MgaW5zdGFuY2UgYW5kIGNhbGwgYGNsZWFyKClgIGJldHdlZW4gcmVkcmF3cy5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQ29udGFpbmVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgR3JhcGhpY3MgZXh0ZW5kcyBDb250YWluZXJcbntcbiAgICAvKipcbiAgICAgKiBUZW1wb3JhcnkgcG9pbnQgdG8gdXNlIGZvciBjb250YWluc1BvaW50XG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbWVtYmVyIHtQSVhJLlBvaW50fVxuICAgICAqL1xuXG4gICAgc3RhdGljIF9URU1QX1BPSU5UID0gbmV3IFBvaW50KCk7XG5cbiAgICBwdWJsaWMgc2hhZGVyOiBTaGFkZXI7XG4gICAgcHVibGljIHBsdWdpbk5hbWU6IHN0cmluZztcblxuICAgIHByb3RlY3RlZCBjdXJyZW50UGF0aDogUG9seWdvbjtcbiAgICBwcm90ZWN0ZWQgYmF0Y2hlczogQXJyYXk8SUdyYXBoaWNzQmF0Y2hFbGVtZW50PjtcbiAgICBwcm90ZWN0ZWQgYmF0Y2hUaW50OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIGJhdGNoRGlydHk6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgdmVydGV4RGF0YTogRmxvYXQzMkFycmF5O1xuXG4gICAgcHJvdGVjdGVkIF9maWxsU3R5bGU6IEZpbGxTdHlsZTtcbiAgICBwcm90ZWN0ZWQgX2xpbmVTdHlsZTogTGluZVN0eWxlO1xuICAgIHByb3RlY3RlZCBfbWF0cml4OiBNYXRyaXg7XG4gICAgcHJvdGVjdGVkIF9ob2xlTW9kZTogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgX3RyYW5zZm9ybUlEOiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF90aW50OiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHN0YXRlOiBTdGF0ZTtcbiAgICBwcml2YXRlIF9nZW9tZXRyeTogR3JhcGhpY3NHZW9tZXRyeTtcblxuICAgIC8qKlxuICAgICAqIEluY2x1ZGVzIHZlcnRleCBwb3NpdGlvbnMsIGZhY2UgaW5kaWNlcywgbm9ybWFscywgY29sb3JzLCBVVnMsIGFuZFxuICAgICAqIGN1c3RvbSBhdHRyaWJ1dGVzIHdpdGhpbiBidWZmZXJzLCByZWR1Y2luZyB0aGUgY29zdCBvZiBwYXNzaW5nIGFsbFxuICAgICAqIHRoaXMgZGF0YSB0byB0aGUgR1BVLiBDYW4gYmUgc2hhcmVkIGJldHdlZW4gbXVsdGlwbGUgTWVzaCBvciBHcmFwaGljcyBvYmplY3RzLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5HcmFwaGljc0dlb21ldHJ5fVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZ2VvbWV0cnkoKTogR3JhcGhpY3NHZW9tZXRyeVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dlb21ldHJ5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5HcmFwaGljc0dlb21ldHJ5fSBbZ2VvbWV0cnk9bnVsbF0gLSBHZW9tZXRyeSB0byB1c2UsIGlmIG9taXR0ZWRcbiAgICAgKiAgICAgICAgd2lsbCBjcmVhdGUgYSBuZXcgR3JhcGhpY3NHZW9tZXRyeSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihnZW9tZXRyeTogR3JhcGhpY3NHZW9tZXRyeSA9IG51bGwpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuX2dlb21ldHJ5ID0gZ2VvbWV0cnkgfHwgbmV3IEdyYXBoaWNzR2VvbWV0cnkoKTtcbiAgICAgICAgdGhpcy5fZ2VvbWV0cnkucmVmQ291bnQrKztcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVwcmVzZW50cyB0aGUgdmVydGV4IGFuZCBmcmFnbWVudCBzaGFkZXJzIHRoYXQgcHJvY2Vzc2VzIHRoZSBnZW9tZXRyeSBhbmQgcnVucyBvbiB0aGUgR1BVLlxuICAgICAgICAgKiBDYW4gYmUgc2hhcmVkIGJldHdlZW4gbXVsdGlwbGUgR3JhcGhpY3Mgb2JqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TaGFkZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNoYWRlciA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlcHJlc2VudHMgdGhlIFdlYkdMIHN0YXRlIHRoZSBHcmFwaGljcyByZXF1aXJlZCB0byByZW5kZXIsIGV4Y2x1ZGVzIHNoYWRlciBhbmQgZ2VvbWV0cnkuIEUuZy4sXG4gICAgICAgICAqIGJsZW5kIG1vZGUsIGN1bGxpbmcsIGRlcHRoIHRlc3RpbmcsIGRpcmVjdGlvbiBvZiByZW5kZXJpbmcgdHJpYW5nbGVzLCBiYWNrZmFjZSwgZXRjLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlN0YXRlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlLmZvcjJkKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEN1cnJlbnQgZmlsbCBzdHlsZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkZpbGxTdHlsZX1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZmlsbFN0eWxlID0gbmV3IEZpbGxTdHlsZSgpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDdXJyZW50IGxpbmUgc3R5bGVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5MaW5lU3R5bGV9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xpbmVTdHlsZSA9IG5ldyBMaW5lU3R5bGUoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VycmVudCBzaGFwZSB0cmFuc2Zvcm0gbWF0cml4LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLk1hdHJpeH1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbWF0cml4ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VycmVudCBob2xlIG1vZGUgaXMgZW5hYmxlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faG9sZU1vZGUgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VycmVudCBwYXRoXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUG9seWdvbn1cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZW4gY2FjaGVBc0JpdG1hcCBpcyBzZXQgdG8gdHJ1ZSB0aGUgZ3JhcGhpY3Mgb2JqZWN0IHdpbGwgYmUgcmVuZGVyZWQgYXMgaWYgaXQgd2FzIGEgc3ByaXRlLlxuICAgICAgICAgKiBUaGlzIGlzIHVzZWZ1bCBpZiB5b3VyIGdyYXBoaWNzIGVsZW1lbnQgZG9lcyBub3QgY2hhbmdlIG9mdGVuLCBhcyBpdCB3aWxsIHNwZWVkIHVwIHRoZSByZW5kZXJpbmdcbiAgICAgICAgICogb2YgdGhlIG9iamVjdCBpbiBleGNoYW5nZSBmb3IgdGFraW5nIHVwIHRleHR1cmUgbWVtb3J5LiBJdCBpcyBhbHNvIHVzZWZ1bCBpZiB5b3UgbmVlZCB0aGUgZ3JhcGhpY3NcbiAgICAgICAgICogb2JqZWN0IHRvIGJlIGFudGktYWxpYXNlZCwgYmVjYXVzZSBpdCB3aWxsIGJlIHJlbmRlcmVkIHVzaW5nIGNhbnZhcy4gVGhpcyBpcyBub3QgcmVjb21tZW5kZWQgaWZcbiAgICAgICAgICogeW91IGFyZSBjb25zdGFudGx5IHJlZHJhd2luZyB0aGUgZ3JhcGhpY3MgZWxlbWVudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG5hbWUgY2FjaGVBc0JpdG1hcFxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS5HcmFwaGljcyNcbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgY29sbGVjdGlvbnMgb2YgYmF0Y2hlcyEgVGhlc2UgY2FuIGJlIGRyYXduIGJ5IHRoZSByZW5kZXJlciBiYXRjaCBzeXN0ZW0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0W119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhdGNoZXMgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIGRpcnR5IGZvciBsaW1pdGluZyBjYWxjdWxhdGluZyB0aW50cyBmb3IgYmF0Y2hlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IC0xXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhdGNoVGludCA9IC0xO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGUgZGlydHkgZm9yIGxpbWl0aW5nIGNhbGN1bGF0aW5nIGJhdGNoZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAtMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5iYXRjaERpcnR5ID0gLTE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvcHkgb2YgdGhlIG9iamVjdCB2ZXJ0ZXggZGF0YS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZlcnRleERhdGEgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW5kZXJlciBwbHVnaW4gZm9yIGJhdGNoaW5nXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQGRlZmF1bHQgJ2JhdGNoJ1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wbHVnaW5OYW1lID0gJ2JhdGNoJztcblxuICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IC0xO1xuXG4gICAgICAgIC8vIFNldCBkZWZhdWx0XG4gICAgICAgIHRoaXMudGludCA9IDB4RkZGRkZGO1xuICAgICAgICB0aGlzLmJsZW5kTW9kZSA9IEJMRU5EX01PREVTLk5PUk1BTDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IEdyYXBoaWNzIG9iamVjdCB3aXRoIHRoZSBzYW1lIHZhbHVlcyBhcyB0aGlzIG9uZS5cbiAgICAgKiBOb3RlIHRoYXQgb25seSB0aGUgZ2VvbWV0cnkgb2YgdGhlIG9iamVjdCBpcyBjbG9uZWQsIG5vdCBpdHMgdHJhbnNmb3JtIChwb3NpdGlvbixzY2FsZSxldGMpXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBBIGNsb25lIG9mIHRoZSBncmFwaGljcyBvYmplY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgY2xvbmUoKTogR3JhcGhpY3NcbiAgICB7XG4gICAgICAgIHRoaXMuZmluaXNoUG9seSgpO1xuXG4gICAgICAgIHJldHVybiBuZXcgR3JhcGhpY3ModGhpcy5fZ2VvbWV0cnkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBibGVuZCBtb2RlIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGdyYXBoaWMgc2hhcGUuIEFwcGx5IGEgdmFsdWUgb2ZcbiAgICAgKiBgUElYSS5CTEVORF9NT0RFUy5OT1JNQUxgIHRvIHJlc2V0IHRoZSBibGVuZCBtb2RlLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMO1xuICAgICAqIEBzZWUgUElYSS5CTEVORF9NT0RFU1xuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgYmxlbmRNb2RlKHZhbHVlOiBCTEVORF9NT0RFUylcbiAgICB7XG4gICAgICAgIHRoaXMuc3RhdGUuYmxlbmRNb2RlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBibGVuZE1vZGUoKTogQkxFTkRfTU9ERVNcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlLmJsZW5kTW9kZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdGludCBhcHBsaWVkIHRvIHRoZSBncmFwaGljIHNoYXBlLiBUaGlzIGlzIGEgaGV4IHZhbHVlLiBBIHZhbHVlIG9mXG4gICAgICogMHhGRkZGRkYgd2lsbCByZW1vdmUgYW55IHRpbnQgZWZmZWN0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDB4RkZGRkZGXG4gICAgICovXG4gICAgcHVibGljIGdldCB0aW50KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbnQ7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCB0aW50KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl90aW50ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnQgZmlsbCBzdHlsZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuRmlsbFN0eWxlfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZmlsbCgpOiBGaWxsU3R5bGVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWxsU3R5bGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnQgbGluZSBzdHlsZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuTGluZVN0eWxlfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgbGluZSgpOiBMaW5lU3R5bGVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9saW5lU3R5bGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBsaW5lIHN0eWxlIHVzZWQgZm9yIHN1YnNlcXVlbnQgY2FsbHMgdG8gR3JhcGhpY3MgbWV0aG9kcyBzdWNoIGFzIHRoZSBsaW5lVG8oKVxuICAgICAqIG1ldGhvZCBvciB0aGUgZHJhd0NpcmNsZSgpIG1ldGhvZC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgUElYSS5HcmFwaGljcyNsaW5lU3R5bGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3dpZHRoPTBdIC0gd2lkdGggb2YgdGhlIGxpbmUgdG8gZHJhdywgd2lsbCB1cGRhdGUgdGhlIG9iamVjdHMgc3RvcmVkIHN0eWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjb2xvcj0weDBdIC0gY29sb3Igb2YgdGhlIGxpbmUgdG8gZHJhdywgd2lsbCB1cGRhdGUgdGhlIG9iamVjdHMgc3RvcmVkIHN0eWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthbHBoYT0xXSAtIGFscGhhIG9mIHRoZSBsaW5lIHRvIGRyYXcsIHdpbGwgdXBkYXRlIHRoZSBvYmplY3RzIHN0b3JlZCBzdHlsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYWxpZ25tZW50PTAuNV0gLSBhbGlnbm1lbnQgb2YgdGhlIGxpbmUgdG8gZHJhdywgKDAgPSBpbm5lciwgMC41ID0gbWlkZGxlLCAxID0gb3V0dGVyKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW25hdGl2ZT1mYWxzZV0gLSBJZiB0cnVlIHRoZSBsaW5lcyB3aWxsIGJlIGRyYXcgdXNpbmcgTElORVMgaW5zdGVhZCBvZiBUUklBTkdMRV9TVFJJUFxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGxpbmUgc3R5bGUgdXNlZCBmb3Igc3Vic2VxdWVudCBjYWxscyB0byBHcmFwaGljcyBtZXRob2RzIHN1Y2ggYXMgdGhlIGxpbmVUbygpXG4gICAgICogbWV0aG9kIG9yIHRoZSBkcmF3Q2lyY2xlKCkgbWV0aG9kLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIExpbmUgc3R5bGUgb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy53aWR0aD0wXSAtIHdpZHRoIG9mIHRoZSBsaW5lIHRvIGRyYXcsIHdpbGwgdXBkYXRlIHRoZSBvYmplY3RzIHN0b3JlZCBzdHlsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5jb2xvcj0weDBdIC0gY29sb3Igb2YgdGhlIGxpbmUgdG8gZHJhdywgd2lsbCB1cGRhdGUgdGhlIG9iamVjdHMgc3RvcmVkIHN0eWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmFscGhhPTFdIC0gYWxwaGEgb2YgdGhlIGxpbmUgdG8gZHJhdywgd2lsbCB1cGRhdGUgdGhlIG9iamVjdHMgc3RvcmVkIHN0eWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmFsaWdubWVudD0wLjVdIC0gYWxpZ25tZW50IG9mIHRoZSBsaW5lIHRvIGRyYXcsICgwID0gaW5uZXIsIDAuNSA9IG1pZGRsZSwgMSA9IG91dHRlcilcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLm5hdGl2ZT1mYWxzZV0gLSBJZiB0cnVlIHRoZSBsaW5lcyB3aWxsIGJlIGRyYXcgdXNpbmcgTElORVMgaW5zdGVhZCBvZiBUUklBTkdMRV9TVFJJUFxuICAgICAqIEBwYXJhbSB7UElYSS5MSU5FX0NBUH1bb3B0aW9ucy5jYXA9UElYSS5MSU5FX0NBUC5CVVRUXSAtIGxpbmUgY2FwIHN0eWxlXG4gICAgICogQHBhcmFtIHtQSVhJLkxJTkVfSk9JTn1bb3B0aW9ucy5qb2luPVBJWEkuTElORV9KT0lOLk1JVEVSXSAtIGxpbmUgam9pbiBzdHlsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfVtvcHRpb25zLm1pdGVyTGltaXQ9MTBdIC0gbWl0ZXIgbGltaXQgcmF0aW9cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGxpbmVTdHlsZShvcHRpb25zOiBJTGluZVN0eWxlT3B0aW9ucyA9IG51bGwpOiB0aGlzXG4gICAge1xuICAgICAgICAvLyBTdXBwb3J0IG5vbi1vYmplY3QgcGFyYW1zOiAod2lkdGgsIGNvbG9yLCBhbHBoYSwgYWxpZ25tZW50LCBuYXRpdmUpXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ251bWJlcicpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgY29uc3QgYXJncyA9IGFyZ3VtZW50cztcblxuICAgICAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB3aWR0aDogYXJnc1swXSB8fCAwLFxuICAgICAgICAgICAgICAgIGNvbG9yOiBhcmdzWzFdIHx8IDB4MCxcbiAgICAgICAgICAgICAgICBhbHBoYTogYXJnc1syXSAhPT0gdW5kZWZpbmVkID8gYXJnc1syXSA6IDEsXG4gICAgICAgICAgICAgICAgYWxpZ25tZW50OiBhcmdzWzNdICE9PSB1bmRlZmluZWQgPyBhcmdzWzNdIDogMC41LFxuICAgICAgICAgICAgICAgIG5hdGl2ZTogISFhcmdzWzRdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmxpbmVUZXh0dXJlU3R5bGUob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlrZSBsaW5lIHN0eWxlIGJ1dCBzdXBwb3J0IHRleHR1cmUgZm9yIGxpbmUgZmlsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBDb2xsZWN0aW9uIG9mIG9wdGlvbnMgZm9yIHNldHRpbmcgbGluZSBzdHlsZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMud2lkdGg9MF0gLSB3aWR0aCBvZiB0aGUgbGluZSB0byBkcmF3LCB3aWxsIHVwZGF0ZSB0aGUgb2JqZWN0cyBzdG9yZWQgc3R5bGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gW29wdGlvbnMudGV4dHVyZT1QSVhJLlRleHR1cmUuV0hJVEVdIC0gVGV4dHVyZSB0byB1c2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuY29sb3I9MHgwXSAtIGNvbG9yIG9mIHRoZSBsaW5lIHRvIGRyYXcsIHdpbGwgdXBkYXRlIHRoZSBvYmplY3RzIHN0b3JlZCBzdHlsZS5cbiAgICAgKiAgRGVmYXVsdCAweEZGRkZGRiBpZiB0ZXh0dXJlIHByZXNlbnQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmFscGhhPTFdIC0gYWxwaGEgb2YgdGhlIGxpbmUgdG8gZHJhdywgd2lsbCB1cGRhdGUgdGhlIG9iamVjdHMgc3RvcmVkIHN0eWxlXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gW29wdGlvbnMubWF0cml4PW51bGxdIC0gVGV4dHVyZSBtYXRyaXggdG8gdHJhbnNmb3JtIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuYWxpZ25tZW50PTAuNV0gLSBhbGlnbm1lbnQgb2YgdGhlIGxpbmUgdG8gZHJhdywgKDAgPSBpbm5lciwgMC41ID0gbWlkZGxlLCAxID0gb3V0dGVyKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMubmF0aXZlPWZhbHNlXSAtIElmIHRydWUgdGhlIGxpbmVzIHdpbGwgYmUgZHJhdyB1c2luZyBMSU5FUyBpbnN0ZWFkIG9mIFRSSUFOR0xFX1NUUklQXG4gICAgICogQHBhcmFtIHtQSVhJLkxJTkVfQ0FQfVtvcHRpb25zLmNhcD1QSVhJLkxJTkVfQ0FQLkJVVFRdIC0gbGluZSBjYXAgc3R5bGVcbiAgICAgKiBAcGFyYW0ge1BJWEkuTElORV9KT0lOfVtvcHRpb25zLmpvaW49UElYSS5MSU5FX0pPSU4uTUlURVJdIC0gbGluZSBqb2luIHN0eWxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9W29wdGlvbnMubWl0ZXJMaW1pdD0xMF0gLSBtaXRlciBsaW1pdCByYXRpb1xuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBwdWJsaWMgbGluZVRleHR1cmVTdHlsZShvcHRpb25zOiBJTGluZVN0eWxlT3B0aW9ucyk6IHRoaXNcbiAgICB7XG4gICAgICAgIC8vIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBwYXJhbXM6ICh3aWR0aCwgdGV4dHVyZSxcbiAgICAgICAgLy8gY29sb3IsIGFscGhhLCBtYXRyaXgsIGFsaWdubWVudCwgbmF0aXZlKVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdudW1iZXInKVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbigndjUuMi4wJywgJ1BsZWFzZSB1c2Ugb2JqZWN0LWJhc2VkIG9wdGlvbnMgZm9yIEdyYXBoaWNzI2xpbmVUZXh0dXJlU3R5bGUnKTtcblxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgICAgICBjb25zdCBbd2lkdGgsIHRleHR1cmUsIGNvbG9yLCBhbHBoYSwgbWF0cml4LCBhbGlnbm1lbnQsIG5hdGl2ZV0gPSBhcmd1bWVudHMgYXMgYW55O1xuXG4gICAgICAgICAgICBvcHRpb25zID0geyB3aWR0aCwgdGV4dHVyZSwgY29sb3IsIGFscGhhLCBtYXRyaXgsIGFsaWdubWVudCwgbmF0aXZlIH07XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSB1bmRlZmluZWQga2V5c1xuICAgICAgICAgICAgT2JqZWN0LmtleXMob3B0aW9ucykuZm9yRWFjaCgoa2V5KSA9PiAob3B0aW9ucyBhcyBhbnkpW2tleV0gPT09IHVuZGVmaW5lZCAmJiBkZWxldGUgKG9wdGlvbnMgYXMgYW55KVtrZXldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFwcGx5IGRlZmF1bHRzXG4gICAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgIHdpZHRoOiAwLFxuICAgICAgICAgICAgdGV4dHVyZTogVGV4dHVyZS5XSElURSxcbiAgICAgICAgICAgIGNvbG9yOiAob3B0aW9ucyAmJiBvcHRpb25zLnRleHR1cmUpID8gMHhGRkZGRkYgOiAweDAsXG4gICAgICAgICAgICBhbHBoYTogMSxcbiAgICAgICAgICAgIG1hdHJpeDogbnVsbCxcbiAgICAgICAgICAgIGFsaWdubWVudDogMC41LFxuICAgICAgICAgICAgbmF0aXZlOiBmYWxzZSxcbiAgICAgICAgICAgIGNhcDogTElORV9DQVAuQlVUVCxcbiAgICAgICAgICAgIGpvaW46IExJTkVfSk9JTi5NSVRFUixcbiAgICAgICAgICAgIG1pdGVyTGltaXQ6IDEwLFxuICAgICAgICB9LCBvcHRpb25zKTtcblxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGF0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zdGFydFBvbHkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZpc2libGUgPSBvcHRpb25zLndpZHRoID4gMCAmJiBvcHRpb25zLmFscGhhID4gMDtcblxuICAgICAgICBpZiAoIXZpc2libGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2xpbmVTdHlsZS5yZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMubWF0cml4KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMubWF0cml4ID0gb3B0aW9ucy5tYXRyaXguY2xvbmUoKTtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm1hdHJpeC5pbnZlcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLl9saW5lU3R5bGUsIHsgdmlzaWJsZSB9LCBvcHRpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGEgcG9seWdvbiBvYmplY3QgaW50ZXJuYWxseVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc3RhcnRQb2x5KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYXRoKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwb2ludHMgPSB0aGlzLmN1cnJlbnRQYXRoLnBvaW50cztcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IHRoaXMuY3VycmVudFBhdGgucG9pbnRzLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKGxlbiA+IDIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3U2hhcGUodGhpcy5jdXJyZW50UGF0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IG5ldyBQb2x5Z29uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGF0aC5jbG9zZVN0cm9rZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhdGgucG9pbnRzLnB1c2gocG9pbnRzW2xlbiAtIDJdLCBwb2ludHNbbGVuIC0gMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IG5ldyBQb2x5Z29uKCk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXRoLmNsb3NlU3Ryb2tlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5pc2ggdGhlIHBvbHlnb24gb2JqZWN0LlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBmaW5pc2hQb2x5KCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYXRoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGF0aC5wb2ludHMubGVuZ3RoID4gMilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdTaGFwZSh0aGlzLmN1cnJlbnRQYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXRoID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXRoLnBvaW50cy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTW92ZXMgdGhlIGN1cnJlbnQgZHJhd2luZyBwb3NpdGlvbiB0byB4LCB5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSB0aGUgWCBjb29yZGluYXRlIHRvIG1vdmUgdG9cbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIHRoZSBZIGNvb3JkaW5hdGUgdG8gbW92ZSB0b1xuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBwdWJsaWMgbW92ZVRvKHg6IG51bWJlciwgeTogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5zdGFydFBvbHkoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50UGF0aC5wb2ludHNbMF0gPSB4O1xuICAgICAgICB0aGlzLmN1cnJlbnRQYXRoLnBvaW50c1sxXSA9IHk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhd3MgYSBsaW5lIHVzaW5nIHRoZSBjdXJyZW50IGxpbmUgc3R5bGUgZnJvbSB0aGUgY3VycmVudCBkcmF3aW5nIHBvc2l0aW9uIHRvICh4LCB5KTtcbiAgICAgKiBUaGUgY3VycmVudCBkcmF3aW5nIHBvc2l0aW9uIGlzIHRoZW4gc2V0IHRvICh4LCB5KS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdGhlIFggY29vcmRpbmF0ZSB0byBkcmF3IHRvXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0aGUgWSBjb29yZGluYXRlIHRvIGRyYXcgdG9cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGxpbmVUbyh4OiBudW1iZXIsIHk6IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50UGF0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oMCwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZW1vdmUgZHVwbGljYXRlcy4uXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IHRoaXMuY3VycmVudFBhdGgucG9pbnRzO1xuICAgICAgICBjb25zdCBmcm9tWCA9IHBvaW50c1twb2ludHMubGVuZ3RoIC0gMl07XG4gICAgICAgIGNvbnN0IGZyb21ZID0gcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAoZnJvbVggIT09IHggfHwgZnJvbVkgIT09IHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKHgsIHkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGUgY3VydmVcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3g9MF1cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3k9MF1cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX2luaXRDdXJ2ZSh4ID0gMCwgeSA9IDApOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGF0aClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhdGgucG9pbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXRoLnBvaW50cyA9IFt4LCB5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubW92ZVRvKHgsIHkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHRoZSBwb2ludHMgZm9yIGEgcXVhZHJhdGljIGJlemllciBjdXJ2ZSBhbmQgdGhlbiBkcmF3cyBpdC5cbiAgICAgKiBCYXNlZCBvbjogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzg1MDk3L2hvdy1kby1pLWltcGxlbWVudC1hLWJlemllci1jdXJ2ZS1pbi1jXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BYIC0gQ29udHJvbCBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNwWSAtIENvbnRyb2wgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0b1ggLSBEZXN0aW5hdGlvbiBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvWSAtIERlc3RpbmF0aW9uIHBvaW50IHlcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIHF1YWRyYXRpY0N1cnZlVG8oY3BYOiBudW1iZXIsIGNwWTogbnVtYmVyLCB0b1g6IG51bWJlciwgdG9ZOiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLl9pbml0Q3VydmUoKTtcblxuICAgICAgICBjb25zdCBwb2ludHMgPSB0aGlzLmN1cnJlbnRQYXRoLnBvaW50cztcblxuICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oMCwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBRdWFkcmF0aWNVdGlscy5jdXJ2ZVRvKGNwWCwgY3BZLCB0b1gsIHRvWSwgcG9pbnRzKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIHBvaW50cyBmb3IgYSBiZXppZXIgY3VydmUgYW5kIHRoZW4gZHJhd3MgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3BYIC0gQ29udHJvbCBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNwWSAtIENvbnRyb2wgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFgyIC0gU2Vjb25kIENvbnRyb2wgcG9pbnQgeFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjcFkyIC0gU2Vjb25kIENvbnRyb2wgcG9pbnQgeVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0b1ggLSBEZXN0aW5hdGlvbiBwb2ludCB4XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRvWSAtIERlc3RpbmF0aW9uIHBvaW50IHlcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGJlemllckN1cnZlVG8oY3BYOiBudW1iZXIsIGNwWTogbnVtYmVyLCBjcFgyOiBudW1iZXIsIGNwWTI6IG51bWJlciwgdG9YOiBudW1iZXIsIHRvWTogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5faW5pdEN1cnZlKCk7XG5cbiAgICAgICAgQmV6aWVyVXRpbHMuY3VydmVUbyhjcFgsIGNwWSwgY3BYMiwgY3BZMiwgdG9YLCB0b1ksIHRoaXMuY3VycmVudFBhdGgucG9pbnRzKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYXJjVG8oKSBtZXRob2QgY3JlYXRlcyBhbiBhcmMvY3VydmUgYmV0d2VlbiB0d28gdGFuZ2VudHMgb24gdGhlIGNhbnZhcy5cbiAgICAgKlxuICAgICAqIFwiYm9ycm93ZWRcIiBmcm9tIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZnhjYW52YXMvIC0gdGhhbmtzIGdvb2dsZSFcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MSAtIFRoZSB4LWNvb3JkaW5hdGUgb2YgdGhlIGZpcnN0IHRhbmdlbnQgcG9pbnQgb2YgdGhlIGFyY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MSAtIFRoZSB5LWNvb3JkaW5hdGUgb2YgdGhlIGZpcnN0IHRhbmdlbnQgcG9pbnQgb2YgdGhlIGFyY1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MiAtIFRoZSB4LWNvb3JkaW5hdGUgb2YgdGhlIGVuZCBvZiB0aGUgYXJjXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkyIC0gVGhlIHktY29vcmRpbmF0ZSBvZiB0aGUgZW5kIG9mIHRoZSBhcmNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzIC0gVGhlIHJhZGl1cyBvZiB0aGUgYXJjXG4gICAgICogQHJldHVybiB7UElYSS5HcmFwaGljc30gVGhpcyBHcmFwaGljcyBvYmplY3QuIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxsc1xuICAgICAqL1xuICAgIHB1YmxpYyBhcmNUbyh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCB4MjogbnVtYmVyLCB5MjogbnVtYmVyLCByYWRpdXM6IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMuX2luaXRDdXJ2ZSh4MSwgeTEpO1xuXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IHRoaXMuY3VycmVudFBhdGgucG9pbnRzO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IEFyY1V0aWxzLmN1cnZlVG8oeDEsIHkxLCB4MiwgeTIsIHJhZGl1cywgcG9pbnRzKTtcblxuICAgICAgICBpZiAocmVzdWx0KVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB7IGN4LCBjeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSB9ID0gcmVzdWx0O1xuXG4gICAgICAgICAgICB0aGlzLmFyYyhjeCwgY3ksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGFyYyBtZXRob2QgY3JlYXRlcyBhbiBhcmMvY3VydmUgKHVzZWQgdG8gY3JlYXRlIGNpcmNsZXMsIG9yIHBhcnRzIG9mIGNpcmNsZXMpLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGN4IC0gVGhlIHgtY29vcmRpbmF0ZSBvZiB0aGUgY2VudGVyIG9mIHRoZSBjaXJjbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY3kgLSBUaGUgeS1jb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmNsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXMgLSBUaGUgcmFkaXVzIG9mIHRoZSBjaXJjbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRBbmdsZSAtIFRoZSBzdGFydGluZyBhbmdsZSwgaW4gcmFkaWFucyAoMCBpcyBhdCB0aGUgMyBvJ2Nsb2NrIHBvc2l0aW9uXG4gICAgICogIG9mIHRoZSBhcmMncyBjaXJjbGUpXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZEFuZ2xlIC0gVGhlIGVuZGluZyBhbmdsZSwgaW4gcmFkaWFuc1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2FudGljbG9ja3dpc2U9ZmFsc2VdIC0gU3BlY2lmaWVzIHdoZXRoZXIgdGhlIGRyYXdpbmcgc2hvdWxkIGJlXG4gICAgICogIGNvdW50ZXItY2xvY2t3aXNlIG9yIGNsb2Nrd2lzZS4gRmFsc2UgaXMgZGVmYXVsdCwgYW5kIGluZGljYXRlcyBjbG9ja3dpc2UsIHdoaWxlIHRydWVcbiAgICAgKiAgaW5kaWNhdGVzIGNvdW50ZXItY2xvY2t3aXNlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBwdWJsaWMgYXJjKGN4OiBudW1iZXIsIGN5OiBudW1iZXIsIHJhZGl1czogbnVtYmVyLCBzdGFydEFuZ2xlOiBudW1iZXIsIGVuZEFuZ2xlOiBudW1iZXIsIGFudGljbG9ja3dpc2UgPSBmYWxzZSk6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmIChzdGFydEFuZ2xlID09PSBlbmRBbmdsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWFudGljbG9ja3dpc2UgJiYgZW5kQW5nbGUgPD0gc3RhcnRBbmdsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgZW5kQW5nbGUgKz0gUElfMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhbnRpY2xvY2t3aXNlICYmIHN0YXJ0QW5nbGUgPD0gZW5kQW5nbGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN0YXJ0QW5nbGUgKz0gUElfMjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN3ZWVwID0gZW5kQW5nbGUgLSBzdGFydEFuZ2xlO1xuXG4gICAgICAgIGlmIChzd2VlcCA9PT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGFydFggPSBjeCArIChNYXRoLmNvcyhzdGFydEFuZ2xlKSAqIHJhZGl1cyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0WSA9IGN5ICsgKE1hdGguc2luKHN0YXJ0QW5nbGUpICogcmFkaXVzKTtcbiAgICAgICAgY29uc3QgZXBzID0gdGhpcy5fZ2VvbWV0cnkuY2xvc2VQb2ludEVwcztcblxuICAgICAgICAvLyBJZiB0aGUgY3VycmVudFBhdGggZXhpc3RzLCB0YWtlIGl0cyBwb2ludHMuIE90aGVyd2lzZSBjYWxsIGBtb3ZlVG9gIHRvIHN0YXJ0IGEgcGF0aC5cbiAgICAgICAgbGV0IHBvaW50cyA9IHRoaXMuY3VycmVudFBhdGggPyB0aGlzLmN1cnJlbnRQYXRoLnBvaW50cyA6IG51bGw7XG5cbiAgICAgICAgaWYgKHBvaW50cylcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETzogbWFrZSBhIGJldHRlciBmaXguXG5cbiAgICAgICAgICAgIC8vIFdlIGNoZWNrIGhvdyBmYXIgb3VyIHN0YXJ0IGlzIGZyb20gdGhlIGxhc3QgZXhpc3RpbmcgcG9pbnRcbiAgICAgICAgICAgIGNvbnN0IHhEaWZmID0gTWF0aC5hYnMocG9pbnRzW3BvaW50cy5sZW5ndGggLSAyXSAtIHN0YXJ0WCk7XG4gICAgICAgICAgICBjb25zdCB5RGlmZiA9IE1hdGguYWJzKHBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0gLSBzdGFydFkpO1xuXG4gICAgICAgICAgICBpZiAoeERpZmYgPCBlcHMgJiYgeURpZmYgPCBlcHMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHBvaW50IGlzIHZlcnkgY2xvc2UsIHdlIGRvbid0IGFkZCBpdCwgc2luY2UgdGhpcyB3b3VsZCBsZWFkIHRvIGFydGlmYWN0c1xuICAgICAgICAgICAgICAgIC8vIGR1cmluZyB0ZXNzZWxsYXRpb24gZHVlIHRvIGZsb2F0aW5nIHBvaW50IGltcHJlY2lzaW9uLlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKHN0YXJ0WCwgc3RhcnRZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubW92ZVRvKHN0YXJ0WCwgc3RhcnRZKTtcbiAgICAgICAgICAgIHBvaW50cyA9IHRoaXMuY3VycmVudFBhdGgucG9pbnRzO1xuICAgICAgICB9XG5cbiAgICAgICAgQXJjVXRpbHMuYXJjKHN0YXJ0WCwgc3RhcnRZLCBjeCwgY3ksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UsIHBvaW50cyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIGEgc2ltcGxlIG9uZS1jb2xvciBmaWxsIHRoYXQgc3Vic2VxdWVudCBjYWxscyB0byBvdGhlciBHcmFwaGljcyBtZXRob2RzXG4gICAgICogKHN1Y2ggYXMgbGluZVRvKCkgb3IgZHJhd0NpcmNsZSgpKSB1c2Ugd2hlbiBkcmF3aW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjb2xvcj0wXSAtIHRoZSBjb2xvciBvZiB0aGUgZmlsbFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYWxwaGE9MV0gLSB0aGUgYWxwaGEgb2YgdGhlIGZpbGxcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGJlZ2luRmlsbChjb2xvciA9IDAsIGFscGhhID0gMSk6IHRoaXNcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmJlZ2luVGV4dHVyZUZpbGwoeyB0ZXh0dXJlOiBUZXh0dXJlLldISVRFLCBjb2xvciwgYWxwaGEgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQmVnaW4gdGhlIHRleHR1cmUgZmlsbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIE9iamVjdCBvYmplY3QuXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmV9IFtvcHRpb25zLnRleHR1cmU9UElYSS5UZXh0dXJlLldISVRFXSAtIFRleHR1cmUgdG8gZmlsbFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5jb2xvcj0weGZmZmZmZl0gLSBCYWNrZ3JvdW5kIHRvIGZpbGwgYmVoaW5kIHRleHR1cmVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuYWxwaGE9MV0gLSBBbHBoYSBvZiBmaWxsXG4gICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gW29wdGlvbnMubWF0cml4PW51bGxdIC0gVHJhbnNmb3JtIG1hdHJpeFxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBiZWdpblRleHR1cmVGaWxsKG9wdGlvbnM6IElGaWxsU3R5bGVPcHRpb25zKTogdGhpc1xuICAgIHtcbiAgICAgICAgLy8gYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHBhcmFtczogKHRleHR1cmUsIGNvbG9yLCBhbHBoYSwgbWF0cml4KVxuICAgICAgICBpZiAob3B0aW9ucyBpbnN0YW5jZW9mIFRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKCd2NS4yLjAnLCAnUGxlYXNlIHVzZSBvYmplY3QtYmFzZWQgb3B0aW9ucyBmb3IgR3JhcGhpY3MjYmVnaW5UZXh0dXJlRmlsbCcpO1xuXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgIGNvbnN0IFt0ZXh0dXJlLCBjb2xvciwgYWxwaGEsIG1hdHJpeF0gPSBhcmd1bWVudHMgYXMgYW55O1xuXG4gICAgICAgICAgICBvcHRpb25zID0geyB0ZXh0dXJlLCBjb2xvciwgYWxwaGEsIG1hdHJpeCB9O1xuXG4gICAgICAgICAgICAvLyBSZW1vdmUgdW5kZWZpbmVkIGtleXNcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKG9wdGlvbnMpLmZvckVhY2goKGtleSkgPT4gKG9wdGlvbnMgYXMgYW55KVtrZXldID09PSB1bmRlZmluZWQgJiYgZGVsZXRlIChvcHRpb25zIGFzIGFueSlba2V5XSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBcHBseSBkZWZhdWx0c1xuICAgICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB0ZXh0dXJlOiBUZXh0dXJlLldISVRFLFxuICAgICAgICAgICAgY29sb3I6IDB4RkZGRkZGLFxuICAgICAgICAgICAgYWxwaGE6IDEsXG4gICAgICAgICAgICBtYXRyaXg6IG51bGwsXG4gICAgICAgIH0sIG9wdGlvbnMpIGFzIElGaWxsU3R5bGVPcHRpb25zO1xuXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYXRoKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9seSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmlzaWJsZSA9IG9wdGlvbnMuYWxwaGEgPiAwO1xuXG4gICAgICAgIGlmICghdmlzaWJsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZmlsbFN0eWxlLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5tYXRyaXgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5tYXRyaXggPSBvcHRpb25zLm1hdHJpeC5jbG9uZSgpO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMubWF0cml4LmludmVydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuX2ZpbGxTdHlsZSwgeyB2aXNpYmxlIH0sIG9wdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhIGZpbGwgdG8gdGhlIGxpbmVzIGFuZCBzaGFwZXMgdGhhdCB3ZXJlIGFkZGVkIHNpbmNlIHRoZSBsYXN0IGNhbGwgdG8gdGhlIGJlZ2luRmlsbCgpIG1ldGhvZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBwdWJsaWMgZW5kRmlsbCgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLmZpbmlzaFBvbHkoKTtcblxuICAgICAgICB0aGlzLl9maWxsU3R5bGUucmVzZXQoKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEcmF3cyBhIHJlY3RhbmdsZSBzaGFwZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIFggY29vcmQgb2YgdGhlIHRvcC1sZWZ0IG9mIHRoZSByZWN0YW5nbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIFRoZSBZIGNvb3JkIG9mIHRoZSB0b3AtbGVmdCBvZiB0aGUgcmVjdGFuZ2xlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIC0gVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IC0gVGhlIGhlaWdodCBvZiB0aGUgcmVjdGFuZ2xlXG4gICAgICogQHJldHVybiB7UElYSS5HcmFwaGljc30gVGhpcyBHcmFwaGljcyBvYmplY3QuIEdvb2QgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxsc1xuICAgICAqL1xuICAgIHB1YmxpYyBkcmF3UmVjdCh4OiBudW1iZXIsIHk6IG51bWJlciwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5kcmF3U2hhcGUobmV3IFJlY3RhbmdsZSh4LCB5LCB3aWR0aCwgaGVpZ2h0KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhdyBhIHJlY3RhbmdsZSBzaGFwZSB3aXRoIHJvdW5kZWQvYmV2ZWxlZCBjb3JuZXJzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSBUaGUgWCBjb29yZCBvZiB0aGUgdG9wLWxlZnQgb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gVGhlIFkgY29vcmQgb2YgdGhlIHRvcC1sZWZ0IG9mIHRoZSByZWN0YW5nbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGggLSBUaGUgd2lkdGggb2YgdGhlIHJlY3RhbmdsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmFkaXVzIC0gUmFkaXVzIG9mIHRoZSByZWN0YW5nbGUgY29ybmVyc1xuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFRoaXMgR3JhcGhpY3Mgb2JqZWN0LiBHb29kIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHNcbiAgICAgKi9cbiAgICBwdWJsaWMgZHJhd1JvdW5kZWRSZWN0KHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgcmFkaXVzOiBudW1iZXIpOiB0aGlzXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5kcmF3U2hhcGUobmV3IFJvdW5kZWRSZWN0YW5nbGUoeCwgeSwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhd3MgYSBjaXJjbGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIFRoZSBYIGNvb3JkaW5hdGUgb2YgdGhlIGNlbnRlciBvZiB0aGUgY2lyY2xlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBUaGUgWSBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmNsZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXMgLSBUaGUgcmFkaXVzIG9mIHRoZSBjaXJjbGVcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGRyYXdDaXJjbGUoeDogbnVtYmVyLCB5OiBudW1iZXIsIHJhZGl1czogbnVtYmVyKTogdGhpc1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJhd1NoYXBlKG5ldyBDaXJjbGUoeCwgeSwgcmFkaXVzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhd3MgYW4gZWxsaXBzZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgY2VudGVyIG9mIHRoZSBlbGxpcHNlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBUaGUgWSBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGVsbGlwc2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGggLSBUaGUgaGFsZiB3aWR0aCBvZiB0aGUgZWxsaXBzZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSBUaGUgaGFsZiBoZWlnaHQgb2YgdGhlIGVsbGlwc2VcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGRyYXdFbGxpcHNlKHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IHRoaXNcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmRyYXdTaGFwZShuZXcgRWxsaXBzZSh4LCB5LCB3aWR0aCwgaGVpZ2h0KSk7XG4gICAgfVxuXG4gICAgcHVibGljIGRyYXdQb2x5Z29uKC4uLnBhdGg6IEFycmF5PG51bWJlcj4gfCBBcnJheTxQb2ludD4pOiB0aGlzXG4gICAgcHVibGljIGRyYXdQb2x5Z29uKHBhdGg6IEFycmF5PG51bWJlcj4gfCBBcnJheTxQb2ludD4gfCBQb2x5Z29uKTogdGhpc1xuXG4gICAgLyoqXG4gICAgICogRHJhd3MgYSBwb2x5Z29uIHVzaW5nIHRoZSBnaXZlbiBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJbXXxQSVhJLlBvaW50W118UElYSS5Qb2x5Z29ufSBwYXRoIC0gVGhlIHBhdGggZGF0YSB1c2VkIHRvIGNvbnN0cnVjdCB0aGUgcG9seWdvbi5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGRyYXdQb2x5Z29uKC4uLnBhdGg6IGFueVtdKTogdGhpc1xuICAgIHtcbiAgICAgICAgbGV0IHBvaW50czogQXJyYXk8bnVtYmVyPiB8IEFycmF5PFBvaW50PjtcbiAgICAgICAgbGV0IGNsb3NlU3Ryb2tlID0gdHJ1ZTsvLyAhIXRoaXMuX2ZpbGxTdHlsZTtcblxuICAgICAgICBjb25zdCBwb2x5ID0gcGF0aFswXSBhcyBQb2x5Z29uO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIGRhdGEgaGFzIHBvaW50cy4uXG4gICAgICAgIGlmIChwb2x5LnBvaW50cylcbiAgICAgICAge1xuICAgICAgICAgICAgY2xvc2VTdHJva2UgPSBwb2x5LmNsb3NlU3Ryb2tlO1xuICAgICAgICAgICAgcG9pbnRzID0gcG9seS5wb2ludHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXRoWzBdKSlcbiAgICAgICAge1xuICAgICAgICAgICAgcG9pbnRzID0gcGF0aFswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHBvaW50cyA9IHBhdGg7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzaGFwZSA9IG5ldyBQb2x5Z29uKHBvaW50cyk7XG5cbiAgICAgICAgc2hhcGUuY2xvc2VTdHJva2UgPSBjbG9zZVN0cm9rZTtcblxuICAgICAgICB0aGlzLmRyYXdTaGFwZShzaGFwZSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhdyBhbnkgc2hhcGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuQ2lyY2xlfFBJWEkuRWxsaXBzZXxQSVhJLlBvbHlnb258UElYSS5SZWN0YW5nbGV8UElYSS5Sb3VuZGVkUmVjdGFuZ2xlfSBzaGFwZSAtIFNoYXBlIHRvIGRyYXdcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGRyYXdTaGFwZShzaGFwZTogSVNoYXBlKTogdGhpc1xuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLl9ob2xlTW9kZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZ2VvbWV0cnkuZHJhd1NoYXBlKFxuICAgICAgICAgICAgICAgIHNoYXBlLFxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbGxTdHlsZS5jbG9uZSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVTdHlsZS5jbG9uZSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuX21hdHJpeFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2dlb21ldHJ5LmRyYXdIb2xlKHNoYXBlLCB0aGlzLl9tYXRyaXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhdyBhIHN0YXIgc2hhcGUgd2l0aCBhbiBhcmJpdHJhcnkgbnVtYmVyIG9mIHBvaW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gQ2VudGVyIFggcG9zaXRpb24gb2YgdGhlIHN0YXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geSAtIENlbnRlciBZIHBvc2l0aW9uIG9mIHRoZSBzdGFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBvaW50cyAtIFRoZSBudW1iZXIgb2YgcG9pbnRzIG9mIHRoZSBzdGFyLCBtdXN0IGJlID4gMVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByYWRpdXMgLSBUaGUgb3V0ZXIgcmFkaXVzIG9mIHRoZSBzdGFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtpbm5lclJhZGl1c10gLSBUaGUgaW5uZXIgcmFkaXVzIGJldHdlZW4gcG9pbnRzLCBkZWZhdWx0IGhhbGYgYHJhZGl1c2BcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3JvdGF0aW9uPTBdIC0gVGhlIHJvdGF0aW9uIG9mIHRoZSBzdGFyIGluIHJhZGlhbnMsIHdoZXJlIDAgaXMgdmVydGljYWxcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGRyYXdTdGFyKHg6IG51bWJlciwgeTogbnVtYmVyLCBwb2ludHM6IG51bWJlciwgcmFkaXVzOiBudW1iZXIsIGlubmVyUmFkaXVzOiBudW1iZXIsIHJvdGF0aW9uID0gMCk6IHRoaXNcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmRyYXdQb2x5Z29uKG5ldyBTdGFyKHgsIHksIHBvaW50cywgcmFkaXVzLCBpbm5lclJhZGl1cywgcm90YXRpb24pIGFzIFBvbHlnb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgZ3JhcGhpY3MgdGhhdCB3ZXJlIGRyYXduIHRvIHRoaXMgR3JhcGhpY3Mgb2JqZWN0LCBhbmQgcmVzZXRzIGZpbGwgYW5kIGxpbmUgc3R5bGUgc2V0dGluZ3MuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBUaGlzIEdyYXBoaWNzIG9iamVjdC4gR29vZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzXG4gICAgICovXG4gICAgcHVibGljIGNsZWFyKCk6IHRoaXNcbiAgICB7XG4gICAgICAgIHRoaXMuX2dlb21ldHJ5LmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX2xpbmVTdHlsZS5yZXNldCgpO1xuICAgICAgICB0aGlzLl9maWxsU3R5bGUucmVzZXQoKTtcblxuICAgICAgICB0aGlzLl9ib3VuZHNJRCsrO1xuICAgICAgICB0aGlzLl9tYXRyaXggPSBudWxsO1xuICAgICAgICB0aGlzLl9ob2xlTW9kZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmN1cnJlbnRQYXRoID0gbnVsbDtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcnVlIGlmIGdyYXBoaWNzIGNvbnNpc3RzIG9mIG9uZSByZWN0YW5nbGUsIGFuZCB0aHVzLCBjYW4gYmUgZHJhd24gbGlrZSBhIFNwcml0ZSBhbmRcbiAgICAgKiBtYXNrZWQgd2l0aCBnbC5zY2lzc29yLlxuICAgICAqXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgb25seSAxIHJlY3QuXG4gICAgICovXG4gICAgcHVibGljIGlzRmFzdFJlY3QoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX2dlb21ldHJ5LmdyYXBoaWNzRGF0YTtcblxuICAgICAgICByZXR1cm4gZGF0YS5sZW5ndGggPT09IDFcbiAgICAgICAgICAgICYmIGRhdGFbMF0uc2hhcGUudHlwZSA9PT0gU0hBUEVTLlJFQ1RcbiAgICAgICAgICAgICYmICEoZGF0YVswXS5saW5lU3R5bGUudmlzaWJsZSAmJiBkYXRhWzBdLmxpbmVTdHlsZS53aWR0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVycyB0aGUgb2JqZWN0IHVzaW5nIHRoZSBXZWJHTCByZW5kZXJlclxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmZpbmlzaFBvbHkoKTtcblxuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IHRoaXMuX2dlb21ldHJ5O1xuICAgICAgICBjb25zdCBoYXN1aW50MzIgPSByZW5kZXJlci5jb250ZXh0LnN1cHBvcnRzLnVpbnQzMkluZGljZXM7XG4gICAgICAgIC8vIGJhdGNoIHBhcnQuLlxuICAgICAgICAvLyBiYXRjaCBpdCFcblxuICAgICAgICBnZW9tZXRyeS51cGRhdGVCYXRjaGVzKGhhc3VpbnQzMik7XG5cbiAgICAgICAgaWYgKGdlb21ldHJ5LmJhdGNoYWJsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuYmF0Y2hEaXJ0eSAhPT0gZ2VvbWV0cnkuYmF0Y2hEaXJ0eSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3B1bGF0ZUJhdGNoZXMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyQmF0Y2hlZChyZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBubyBiYXRjaGluZy4uLlxuICAgICAgICAgICAgcmVuZGVyZXIuYmF0Y2guZmx1c2goKTtcblxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyRGlyZWN0KHJlbmRlcmVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBvcHVsYXRpbmcgYmF0Y2hlcyBmb3IgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF9wb3B1bGF0ZUJhdGNoZXMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLl9nZW9tZXRyeTtcbiAgICAgICAgY29uc3QgYmxlbmRNb2RlID0gdGhpcy5ibGVuZE1vZGU7XG4gICAgICAgIGNvbnN0IGxlbiA9IGdlb21ldHJ5LmJhdGNoZXMubGVuZ3RoO1xuXG4gICAgICAgIHRoaXMuYmF0Y2hUaW50ID0gLTE7XG4gICAgICAgIHRoaXMuX3RyYW5zZm9ybUlEID0gLTE7XG4gICAgICAgIHRoaXMuYmF0Y2hEaXJ0eSA9IGdlb21ldHJ5LmJhdGNoRGlydHk7XG4gICAgICAgIHRoaXMuYmF0Y2hlcy5sZW5ndGggPSBsZW47XG5cbiAgICAgICAgdGhpcy52ZXJ0ZXhEYXRhID0gbmV3IEZsb2F0MzJBcnJheShnZW9tZXRyeS5wb2ludHMpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGdJID0gZ2VvbWV0cnkuYmF0Y2hlc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gZ0kuc3R5bGUuY29sb3I7XG4gICAgICAgICAgICBjb25zdCB2ZXJ0ZXhEYXRhID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLnZlcnRleERhdGEuYnVmZmVyLFxuICAgICAgICAgICAgICAgIGdJLmF0dHJpYlN0YXJ0ICogNCAqIDIsXG4gICAgICAgICAgICAgICAgZ0kuYXR0cmliU2l6ZSAqIDIpO1xuXG4gICAgICAgICAgICBjb25zdCB1dnMgPSBuZXcgRmxvYXQzMkFycmF5KGdlb21ldHJ5LnV2c0Zsb2F0MzIuYnVmZmVyLFxuICAgICAgICAgICAgICAgIGdJLmF0dHJpYlN0YXJ0ICogNCAqIDIsXG4gICAgICAgICAgICAgICAgZ0kuYXR0cmliU2l6ZSAqIDIpO1xuXG4gICAgICAgICAgICBjb25zdCBpbmRpY2VzID0gbmV3IFVpbnQxNkFycmF5KGdlb21ldHJ5LmluZGljZXNVaW50MTYuYnVmZmVyLFxuICAgICAgICAgICAgICAgIGdJLnN0YXJ0ICogMixcbiAgICAgICAgICAgICAgICBnSS5zaXplKTtcblxuICAgICAgICAgICAgY29uc3QgYmF0Y2ggPSB7XG4gICAgICAgICAgICAgICAgdmVydGV4RGF0YSxcbiAgICAgICAgICAgICAgICBibGVuZE1vZGUsXG4gICAgICAgICAgICAgICAgaW5kaWNlcyxcbiAgICAgICAgICAgICAgICB1dnMsXG4gICAgICAgICAgICAgICAgX2JhdGNoUkdCOiBoZXgycmdiKGNvbG9yKSBhcyBBcnJheTxudW1iZXI+LFxuICAgICAgICAgICAgICAgIF90aW50UkdCOiBjb2xvcixcbiAgICAgICAgICAgICAgICBfdGV4dHVyZTogZ0kuc3R5bGUudGV4dHVyZSxcbiAgICAgICAgICAgICAgICBhbHBoYTogZ0kuc3R5bGUuYWxwaGEsXG4gICAgICAgICAgICAgICAgd29ybGRBbHBoYTogMSB9O1xuXG4gICAgICAgICAgICB0aGlzLmJhdGNoZXNbaV0gPSBiYXRjaDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgdGhlIGJhdGNoZXMgdXNpbmcgdGhlIEJhdGhlZFJlbmRlcmVyIHBsdWdpblxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlckJhdGNoZWQocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmJhdGNoZXMubGVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZW5kZXJlci5iYXRjaC5zZXRPYmplY3RSZW5kZXJlcihyZW5kZXJlci5wbHVnaW5zW3RoaXMucGx1Z2luTmFtZV0pO1xuXG4gICAgICAgIHRoaXMuY2FsY3VsYXRlVmVydGljZXMoKTtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVUaW50cygpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5iYXRjaGVzLmxlbmd0aDsgaSA8IGw7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYmF0Y2ggPSB0aGlzLmJhdGNoZXNbaV07XG5cbiAgICAgICAgICAgIGJhdGNoLndvcmxkQWxwaGEgPSB0aGlzLndvcmxkQWxwaGEgKiBiYXRjaC5hbHBoYTtcblxuICAgICAgICAgICAgcmVuZGVyZXIucGx1Z2luc1t0aGlzLnBsdWdpbk5hbWVdLnJlbmRlcihiYXRjaCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIHRoZSBncmFwaGljcyBkaXJlY3RcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF9yZW5kZXJEaXJlY3QocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qgc2hhZGVyID0gdGhpcy5fcmVzb2x2ZURpcmVjdFNoYWRlcihyZW5kZXJlcik7XG5cbiAgICAgICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLl9nZW9tZXRyeTtcbiAgICAgICAgY29uc3QgdGludCA9IHRoaXMudGludDtcbiAgICAgICAgY29uc3Qgd29ybGRBbHBoYSA9IHRoaXMud29ybGRBbHBoYTtcbiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSBzaGFkZXIudW5pZm9ybXM7XG4gICAgICAgIGNvbnN0IGRyYXdDYWxscyA9IGdlb21ldHJ5LmRyYXdDYWxscztcblxuICAgICAgICAvLyBsZXRzIHNldCB0aGUgdHJhbnNmb21yXG4gICAgICAgIHVuaWZvcm1zLnRyYW5zbGF0aW9uTWF0cml4ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG5cbiAgICAgICAgLy8gYW5kIHRoZW4gbGV0cyBzZXQgdGhlIHRpbnQuLlxuICAgICAgICB1bmlmb3Jtcy50aW50WzBdID0gKCgodGludCA+PiAxNikgJiAweEZGKSAvIDI1NSkgKiB3b3JsZEFscGhhO1xuICAgICAgICB1bmlmb3Jtcy50aW50WzFdID0gKCgodGludCA+PiA4KSAmIDB4RkYpIC8gMjU1KSAqIHdvcmxkQWxwaGE7XG4gICAgICAgIHVuaWZvcm1zLnRpbnRbMl0gPSAoKHRpbnQgJiAweEZGKSAvIDI1NSkgKiB3b3JsZEFscGhhO1xuICAgICAgICB1bmlmb3Jtcy50aW50WzNdID0gd29ybGRBbHBoYTtcblxuICAgICAgICAvLyB0aGUgZmlyc3QgZHJhdyBjYWxsLCB3ZSBjYW4gc2V0IHRoZSB1bmlmb3JtcyBvZiB0aGUgc2hhZGVyIGRpcmVjdGx5IGhlcmUuXG5cbiAgICAgICAgLy8gdGhpcyBtZWFucyB0aGF0IHdlIGNhbiB0YWNrIGFkdmFudGFnZSBvZiB0aGUgc3luYyBmdW5jdGlvbiBvZiBwaXhpIVxuICAgICAgICAvLyBiaW5kIGFuZCBzeW5jIHVuaWZvcm1zLi5cbiAgICAgICAgLy8gdGhlcmUgaXMgYSB3YXkgdG8gb3B0aW1pc2UgdGhpcy4uXG4gICAgICAgIHJlbmRlcmVyLnNoYWRlci5iaW5kKHNoYWRlcik7XG4gICAgICAgIHJlbmRlcmVyLmdlb21ldHJ5LmJpbmQoZ2VvbWV0cnksIHNoYWRlcik7XG5cbiAgICAgICAgLy8gc2V0IHN0YXRlLi5cbiAgICAgICAgcmVuZGVyZXIuc3RhdGUuc2V0KHRoaXMuc3RhdGUpO1xuXG4gICAgICAgIC8vIHRoZW4gcmVuZGVyIHRoZSByZXN0IG9mIHRoZW0uLi5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBkcmF3Q2FsbHMubGVuZ3RoOyBpIDwgbDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEcmF3Q2FsbERpcmVjdChyZW5kZXJlciwgZ2VvbWV0cnkuZHJhd0NhbGxzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgc3BlY2lmaWMgRHJhd0NhbGxcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXJcbiAgICAgKiBAcGFyYW0ge1BJWEkuQmF0Y2hEcmF3Q2FsbH0gZHJhd0NhbGxcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlckRyYXdDYWxsRGlyZWN0KHJlbmRlcmVyOiBSZW5kZXJlciwgZHJhd0NhbGw6IEJhdGNoRHJhd0NhbGwpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB7IHRleEFycmF5LCB0eXBlLCBzaXplLCBzdGFydCB9ID0gZHJhd0NhbGw7XG4gICAgICAgIGNvbnN0IGdyb3VwVGV4dHVyZUNvdW50ID0gdGV4QXJyYXkuY291bnQ7XG5cbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBncm91cFRleHR1cmVDb3VudDsgaisrKVxuICAgICAgICB7XG4gICAgICAgICAgICByZW5kZXJlci50ZXh0dXJlLmJpbmQodGV4QXJyYXkuZWxlbWVudHNbal0sIGopO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVuZGVyZXIuZ2VvbWV0cnkuZHJhdyh0eXBlLCBzaXplLCBzdGFydCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzb2x2ZXMgc2hhZGVyIGZvciBkaXJlY3QgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSByZW5kZXJlclxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfcmVzb2x2ZURpcmVjdFNoYWRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiBTaGFkZXJcbiAgICB7XG4gICAgICAgIGxldCBzaGFkZXIgPSB0aGlzLnNoYWRlcjtcblxuICAgICAgICBjb25zdCBwbHVnaW5OYW1lID0gdGhpcy5wbHVnaW5OYW1lO1xuXG4gICAgICAgIGlmICghc2hhZGVyKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBzaGFkZXIgaGVyZSwgd2UgY2FuIHVzZSB0aGUgZGVmYXVsdCBzaGFkZXIuXG4gICAgICAgICAgICAvLyBhbmQgdGhhdCBvbmx5IGdldHMgY3JlYXRlZCBpZiB3ZSBhY3R1YWxseSBuZWVkIGl0Li5cbiAgICAgICAgICAgIC8vIGJ1dCBtYXkgYmUgbW9yZSB0aGFuIG9uZSBwbHVnaW5zIGZvciBncmFwaGljc1xuICAgICAgICAgICAgaWYgKCFERUZBVUxUX1NIQURFUlNbcGx1Z2luTmFtZV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgTUFYX1RFWFRVUkVTID0gcmVuZGVyZXIucGx1Z2lucy5iYXRjaC5NQVhfVEVYVFVSRVM7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2FtcGxlVmFsdWVzID0gbmV3IEludDMyQXJyYXkoTUFYX1RFWFRVUkVTKTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTUFYX1RFWFRVUkVTOyBpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzYW1wbGVWYWx1ZXNbaV0gPSBpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHVuaWZvcm1zID0ge1xuICAgICAgICAgICAgICAgICAgICB0aW50OiBuZXcgRmxvYXQzMkFycmF5KFsxLCAxLCAxLCAxXSksXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uTWF0cml4OiBuZXcgTWF0cml4KCksXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IFVuaWZvcm1Hcm91cC5mcm9tKHsgdVNhbXBsZXJzOiBzYW1wbGVWYWx1ZXMgfSwgdHJ1ZSksXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyYW0gPSByZW5kZXJlci5wbHVnaW5zW3BsdWdpbk5hbWVdLl9zaGFkZXIucHJvZ3JhbTtcblxuICAgICAgICAgICAgICAgIERFRkFVTFRfU0hBREVSU1twbHVnaW5OYW1lXSA9IG5ldyBTaGFkZXIocHJvZ3JhbSwgdW5pZm9ybXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzaGFkZXIgPSBERUZBVUxUX1NIQURFUlNbcGx1Z2luTmFtZV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2hhZGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgYm91bmRzIG9mIHRoZSBncmFwaGljIHNoYXBlIGFzIGEgcmVjdGFuZ2xlIG9iamVjdFxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY2FsY3VsYXRlQm91bmRzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZmluaXNoUG9seSgpO1xuXG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5fZ2VvbWV0cnk7XG5cbiAgICAgICAgLy8gc2tpcHBpbmcgd2hlbiBncmFwaGljcyBpcyBlbXB0eSwgbGlrZSBhIGNvbnRhaW5lclxuICAgICAgICBpZiAoIWdlb21ldHJ5LmdyYXBoaWNzRGF0YS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgbWluWCwgbWluWSwgbWF4WCwgbWF4WSB9ID0gZ2VvbWV0cnkuYm91bmRzO1xuXG4gICAgICAgIHRoaXMuX2JvdW5kcy5hZGRGcmFtZSh0aGlzLnRyYW5zZm9ybSwgbWluWCwgbWluWSwgbWF4WCwgbWF4WSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdHMgaWYgYSBwb2ludCBpcyBpbnNpZGUgdGhpcyBncmFwaGljcyBvYmplY3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb2ludCAtIHRoZSBwb2ludCB0byB0ZXN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gdGhlIHJlc3VsdCBvZiB0aGUgdGVzdFxuICAgICAqL1xuICAgIHB1YmxpYyBjb250YWluc1BvaW50KHBvaW50OiBJUG9pbnREYXRhKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybS5hcHBseUludmVyc2UocG9pbnQsIEdyYXBoaWNzLl9URU1QX1BPSU5UKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fZ2VvbWV0cnkuY29udGFpbnNQb2ludChHcmFwaGljcy5fVEVNUF9QT0lOVCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjYWxjdWF0ZSB0aGUgdGludCBieSBhcHBseWluZyB0aW4gdG8gYmF0Y2hlcyB1c2luZyBHcmFwaGljcyB0aW50LlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY2FsY3VsYXRlVGludHMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuYmF0Y2hUaW50ICE9PSB0aGlzLnRpbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmF0Y2hUaW50ID0gdGhpcy50aW50O1xuXG4gICAgICAgICAgICBjb25zdCB0aW50UkdCID0gaGV4MnJnYih0aGlzLnRpbnQsIHRlbXApO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmF0Y2hlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBiYXRjaCA9IHRoaXMuYmF0Y2hlc1tpXTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGJhdGNoVGludCA9IGJhdGNoLl9iYXRjaFJHQjtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSAodGludFJHQlswXSAqIGJhdGNoVGludFswXSkgKiAyNTU7XG4gICAgICAgICAgICAgICAgY29uc3QgZyA9ICh0aW50UkdCWzFdICogYmF0Y2hUaW50WzFdKSAqIDI1NTtcbiAgICAgICAgICAgICAgICBjb25zdCBiID0gKHRpbnRSR0JbMl0gKiBiYXRjaFRpbnRbMl0pICogMjU1O1xuXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBJdmFuLCBjYW4gdGhpcyBiZSBkb25lIGluIG9uZSBnbz9cbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IChyIDw8IDE2KSArIChnIDw8IDgpICsgKGIgfCAwKTtcblxuICAgICAgICAgICAgICAgIGJhdGNoLl90aW50UkdCID0gKGNvbG9yID4+IDE2KVxuICAgICAgICAgICAgICAgICAgICAgICAgKyAoY29sb3IgJiAweGZmMDApXG4gICAgICAgICAgICAgICAgICAgICAgICArICgoY29sb3IgJiAweGZmKSA8PCAxNik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiB0aGVyZSdzIGEgdHJhbnNmb3JtIHVwZGF0ZSBvciBhIGNoYW5nZSB0byB0aGUgc2hhcGUgb2YgdGhlXG4gICAgICogZ2VvbWV0cnksIHJlY2FjdWxhdGUgdGhlIHZlcnRpY2VzLlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY2FsY3VsYXRlVmVydGljZXMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3Qgd3RJRCA9IHRoaXMudHJhbnNmb3JtLl93b3JsZElEO1xuXG4gICAgICAgIGlmICh0aGlzLl90cmFuc2Zvcm1JRCA9PT0gd3RJRClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtSUQgPSB3dElEO1xuXG4gICAgICAgIGNvbnN0IHd0ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgICAgIGNvbnN0IGEgPSB3dC5hO1xuICAgICAgICBjb25zdCBiID0gd3QuYjtcbiAgICAgICAgY29uc3QgYyA9IHd0LmM7XG4gICAgICAgIGNvbnN0IGQgPSB3dC5kO1xuICAgICAgICBjb25zdCB0eCA9IHd0LnR4O1xuICAgICAgICBjb25zdCB0eSA9IHd0LnR5O1xuXG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9nZW9tZXRyeS5wb2ludHM7Ly8gYmF0Y2gudmVydGV4RGF0YU9yaWdpbmFsO1xuICAgICAgICBjb25zdCB2ZXJ0ZXhEYXRhID0gdGhpcy52ZXJ0ZXhEYXRhO1xuXG4gICAgICAgIGxldCBjb3VudCA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSAyKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB4ID0gZGF0YVtpXTtcbiAgICAgICAgICAgIGNvbnN0IHkgPSBkYXRhW2kgKyAxXTtcblxuICAgICAgICAgICAgdmVydGV4RGF0YVtjb3VudCsrXSA9IChhICogeCkgKyAoYyAqIHkpICsgdHg7XG4gICAgICAgICAgICB2ZXJ0ZXhEYXRhW2NvdW50KytdID0gKGQgKiB5KSArIChiICogeCkgKyB0eTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY3VycmVudCBwYXRoLlxuICAgICAqXG4gICAgICogQHJldHVybiB7UElYSS5HcmFwaGljc30gUmV0dXJucyBpdHNlbGYuXG4gICAgICovXG4gICAgcHVibGljIGNsb3NlUGF0aCgpOiB0aGlzXG4gICAge1xuICAgICAgICBjb25zdCBjdXJyZW50UGF0aCA9IHRoaXMuY3VycmVudFBhdGg7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRQYXRoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIGFkZCBleHRyYSBwb2ludCBpbiB0aGUgZW5kIGJlY2F1c2UgYnVpbGRMaW5lIHdpbGwgdGFrZSBjYXJlIG9mIHRoYXRcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoLmNsb3NlU3Ryb2tlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IGEgbWF0cml4IHRvIHRoZSBwb3NpdGlvbmFsIGRhdGEuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBtYXRyaXggLSBNYXRyaXggdG8gdXNlIGZvciB0cmFuc2Zvcm0gY3VycmVudCBzaGFwZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0TWF0cml4KG1hdHJpeDogTWF0cml4KTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5fbWF0cml4ID0gbWF0cml4O1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJlZ2luIGFkZGluZyBob2xlcyB0byB0aGUgbGFzdCBkcmF3IHNoYXBlXG4gICAgICogSU1QT1JUQU5UOiBob2xlcyBtdXN0IGJlIGZ1bGx5IGluc2lkZSBhIHNoYXBlIHRvIHdvcmtcbiAgICAgKiBBbHNvIHdlaXJkbmVzcyBlbnN1ZXMgaWYgaG9sZXMgb3ZlcmxhcCFcbiAgICAgKiBFbGxpcHNlcywgQ2lyY2xlcywgUmVjdGFuZ2xlcyBhbmQgUm91bmRlZCBSZWN0YW5nbGVzIGNhbm5vdCBiZSBob2xlcyBvciBob3N0IGZvciBob2xlcyBpbiBDYW52YXNSZW5kZXJlcixcbiAgICAgKiBwbGVhc2UgdXNlIGBtb3ZlVG9gIGBsaW5lVG9gLCBgcXVhZHJhdGljQ3VydmVUb2AgaWYgeW91IHJlbHkgb24gcGl4aS1sZWdhY3kgYnVuZGxlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuR3JhcGhpY3N9IFJldHVybnMgaXRzZWxmLlxuICAgICAqL1xuICAgIHB1YmxpYyBiZWdpbkhvbGUoKTogdGhpc1xuICAgIHtcbiAgICAgICAgdGhpcy5maW5pc2hQb2x5KCk7XG4gICAgICAgIHRoaXMuX2hvbGVNb2RlID0gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmQgYWRkaW5nIGhvbGVzIHRvIHRoZSBsYXN0IGRyYXcgc2hhcGVcbiAgICAgKiBAcmV0dXJuIHtQSVhJLkdyYXBoaWNzfSBSZXR1cm5zIGl0c2VsZi5cbiAgICAgKi9cbiAgICBwdWJsaWMgZW5kSG9sZSgpOiB0aGlzXG4gICAge1xuICAgICAgICB0aGlzLmZpbmlzaFBvbHkoKTtcbiAgICAgICAgdGhpcy5faG9sZU1vZGUgPSBmYWxzZTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgR3JhcGhpY3Mgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R8Ym9vbGVhbn0gW29wdGlvbnNdIC0gT3B0aW9ucyBwYXJhbWV0ZXIuIEEgYm9vbGVhbiB3aWxsIGFjdCBhcyBpZiBhbGxcbiAgICAgKiAgb3B0aW9ucyBoYXZlIGJlZW4gc2V0IHRvIHRoYXQgdmFsdWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmNoaWxkcmVuPWZhbHNlXSAtIGlmIHNldCB0byB0cnVlLCBhbGwgdGhlIGNoaWxkcmVuIHdpbGwgaGF2ZVxuICAgICAqICB0aGVpciBkZXN0cm95IG1ldGhvZCBjYWxsZWQgYXMgd2VsbC4gJ29wdGlvbnMnIHdpbGwgYmUgcGFzc2VkIG9uIHRvIHRob3NlIGNhbGxzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudGV4dHVyZT1mYWxzZV0gLSBPbmx5IHVzZWQgZm9yIGNoaWxkIFNwcml0ZXMgaWYgb3B0aW9ucy5jaGlsZHJlbiBpcyBzZXQgdG8gdHJ1ZVxuICAgICAqICBTaG91bGQgaXQgZGVzdHJveSB0aGUgdGV4dHVyZSBvZiB0aGUgY2hpbGQgc3ByaXRlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5iYXNlVGV4dHVyZT1mYWxzZV0gLSBPbmx5IHVzZWQgZm9yIGNoaWxkIFNwcml0ZXMgaWYgb3B0aW9ucy5jaGlsZHJlbiBpcyBzZXQgdG8gdHJ1ZVxuICAgICAqICBTaG91bGQgaXQgZGVzdHJveSB0aGUgYmFzZSB0ZXh0dXJlIG9mIHRoZSBjaGlsZCBzcHJpdGVcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveShvcHRpb25zOiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuX2dlb21ldHJ5LnJlZkNvdW50LS07XG4gICAgICAgIGlmICh0aGlzLl9nZW9tZXRyeS5yZWZDb3VudCA9PT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZ2VvbWV0cnkuZGlzcG9zZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbWF0cml4ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2xpbmVTdHlsZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuX2xpbmVTdHlsZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2ZpbGxTdHlsZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuX2ZpbGxTdHlsZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2dlb21ldHJ5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zaGFkZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnZlcnRleERhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLmJhdGNoZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5iYXRjaGVzID0gbnVsbDtcblxuICAgICAgICBzdXBlci5kZXN0cm95KG9wdGlvbnMpO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBCTEVORF9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBUZXh0dXJlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB7IE9ic2VydmFibGVQb2ludCwgUG9pbnQsIFJlY3RhbmdsZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5pbXBvcnQgeyBzaWduIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5pbXBvcnQgdHlwZSB7IElCYXNlVGV4dHVyZU9wdGlvbnMsIFJlbmRlcmVyLCBUZXh0dXJlU291cmNlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnREYXRhIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmNvbnN0IHRlbXBQb2ludCA9IG5ldyBQb2ludCgpO1xuY29uc3QgaW5kaWNlcyA9IG5ldyBVaW50MTZBcnJheShbMCwgMSwgMiwgMCwgMiwgM10pO1xuXG5leHBvcnQgdHlwZSBTcHJpdGVTb3VyY2UgPSBUZXh0dXJlU291cmNlfFRleHR1cmU7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3ByaXRlIGV4dGVuZHMgR2xvYmFsTWl4aW5zLlNwcml0ZSwgQ29udGFpbmVyIHt9XG5cbi8qKlxuICogVGhlIFNwcml0ZSBvYmplY3QgaXMgdGhlIGJhc2UgZm9yIGFsbCB0ZXh0dXJlZCBvYmplY3RzIHRoYXQgYXJlIHJlbmRlcmVkIHRvIHRoZSBzY3JlZW5cbipcbiAqIEEgc3ByaXRlIGNhbiBiZSBjcmVhdGVkIGRpcmVjdGx5IGZyb20gYW4gaW1hZ2UgbGlrZSB0aGlzOlxuICpcbiAqIGBgYGpzXG4gKiBsZXQgc3ByaXRlID0gUElYSS5TcHJpdGUuZnJvbSgnYXNzZXRzL2ltYWdlLnBuZycpO1xuICogYGBgXG4gKlxuICogVGhlIG1vcmUgZWZmaWNpZW50IHdheSB0byBjcmVhdGUgc3ByaXRlcyBpcyB1c2luZyBhIHtAbGluayBQSVhJLlNwcml0ZXNoZWV0fSxcbiAqIGFzIHN3YXBwaW5nIGJhc2UgdGV4dHVyZXMgd2hlbiByZW5kZXJpbmcgdG8gdGhlIHNjcmVlbiBpcyBpbmVmZmljaWVudC5cbiAqXG4gKiBgYGBqc1xuICogUElYSS5Mb2FkZXIuc2hhcmVkLmFkZChcImFzc2V0cy9zcHJpdGVzaGVldC5qc29uXCIpLmxvYWQoc2V0dXApO1xuICpcbiAqIGZ1bmN0aW9uIHNldHVwKCkge1xuICogICBsZXQgc2hlZXQgPSBQSVhJLkxvYWRlci5zaGFyZWQucmVzb3VyY2VzW1wiYXNzZXRzL3Nwcml0ZXNoZWV0Lmpzb25cIl0uc3ByaXRlc2hlZXQ7XG4gKiAgIGxldCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoc2hlZXQudGV4dHVyZXNbXCJpbWFnZS5wbmdcIl0pO1xuICogICAuLi5cbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5Db250YWluZXJcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJpdGUgZXh0ZW5kcyBDb250YWluZXJcbntcbiAgICBwdWJsaWMgYmxlbmRNb2RlOiBCTEVORF9NT0RFUztcbiAgICBwdWJsaWMgaW5kaWNlczogVWludDE2QXJyYXk7XG4gICAgcHVibGljIHBsdWdpbk5hbWU6IHN0cmluZztcblxuICAgIF93aWR0aDogbnVtYmVyO1xuICAgIF9oZWlnaHQ6IG51bWJlcjtcbiAgICBfdGV4dHVyZTogVGV4dHVyZTtcbiAgICBfdGV4dHVyZUlEOiBudW1iZXI7XG4gICAgX2NhY2hlZFRpbnQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3RleHR1cmVUcmltbWVkSUQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgdXZzOiBGbG9hdDMyQXJyYXk7XG4gICAgcHJvdGVjdGVkIF9hbmNob3I6IE9ic2VydmFibGVQb2ludDtcbiAgICBwcm90ZWN0ZWQgdmVydGV4RGF0YTogRmxvYXQzMkFycmF5O1xuXG4gICAgcHJpdmF0ZSB2ZXJ0ZXhUcmltbWVkRGF0YTogRmxvYXQzMkFycmF5O1xuICAgIHByaXZhdGUgX3JvdW5kUGl4ZWxzOiBib29sZWFuO1xuICAgIHByaXZhdGUgX3RyYW5zZm9ybUlEOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfdHJhbnNmb3JtVHJpbW1lZElEOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfdGludDogbnVtYmVyO1xuXG4gICAgLy8gSW50ZXJuYWwtb25seSBwcm9wZXJ0aWVzXG4gICAgX3RpbnRSR0I6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0dXJlfSBbdGV4dHVyZV0gLSBUaGUgdGV4dHVyZSBmb3IgdGhpcyBzcHJpdGUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodGV4dHVyZTogVGV4dHVyZSlcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhbmNob3IgcG9pbnQgZGVmaW5lcyB0aGUgbm9ybWFsaXplZCBjb29yZGluYXRlc1xuICAgICAgICAgKiBpbiB0aGUgdGV4dHVyZSB0aGF0IG1hcCB0byB0aGUgcG9zaXRpb24gb2YgdGhpc1xuICAgICAgICAgKiBzcHJpdGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEJ5IGRlZmF1bHQsIHRoaXMgaXMgYCgwLDApYCAob3IgYHRleHR1cmUuZGVmYXVsdEFuY2hvcmBcbiAgICAgICAgICogaWYgeW91IGhhdmUgbW9kaWZpZWQgdGhhdCksIHdoaWNoIG1lYW5zIHRoZSBwb3NpdGlvblxuICAgICAgICAgKiBgKHgseSlgIG9mIHRoaXMgYFNwcml0ZWAgd2lsbCBiZSB0aGUgdG9wLWxlZnQgY29ybmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBOb3RlOiBVcGRhdGluZyBgdGV4dHVyZS5kZWZhdWx0QW5jaG9yYCBhZnRlclxuICAgICAgICAgKiBjb25zdHJ1Y3RpbmcgYSBgU3ByaXRlYCBkb2VzIF9ub3RfIHVwZGF0ZSBpdHMgYW5jaG9yLlxuICAgICAgICAgKlxuICAgICAgICAgKiB7QGxpbmsgaHR0cHM6Ly9kb2NzLmNvY29zMmQteC5vcmcvY29jb3MyZC14L2VuL3Nwcml0ZXMvbWFuaXB1bGF0aW9uLmh0bWx9XG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IGB0ZXh0dXJlLmRlZmF1bHRBbmNob3JgXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYW5jaG9yID0gbmV3IE9ic2VydmFibGVQb2ludChcbiAgICAgICAgICAgIHRoaXMuX29uQW5jaG9yVXBkYXRlLFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICh0ZXh0dXJlID8gdGV4dHVyZS5kZWZhdWx0QW5jaG9yLnggOiAwKSxcbiAgICAgICAgICAgICh0ZXh0dXJlID8gdGV4dHVyZS5kZWZhdWx0QW5jaG9yLnkgOiAwKVxuICAgICAgICApO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdGV4dHVyZSB0aGF0IHRoZSBzcHJpdGUgaXMgdXNpbmdcbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgc3ByaXRlICh0aGlzIGlzIGluaXRpYWxseSBzZXQgYnkgdGhlIHRleHR1cmUpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fd2lkdGggPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBzcHJpdGUgKHRoaXMgaXMgaW5pdGlhbGx5IHNldCBieSB0aGUgdGV4dHVyZSlcbiAgICAgICAgICpcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9oZWlnaHQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdGludCBhcHBsaWVkIHRvIHRoZSBzcHJpdGUuIFRoaXMgaXMgYSBoZXggdmFsdWUuIEEgdmFsdWUgb2YgMHhGRkZGRkYgd2lsbCByZW1vdmUgYW55IHRpbnQgZWZmZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDB4RkZGRkZGXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90aW50ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRpbnQgYXBwbGllZCB0byB0aGUgc3ByaXRlLiBUaGlzIGlzIGEgUkdCIHZhbHVlLiBBIHZhbHVlIG9mIDB4RkZGRkZGIHdpbGwgcmVtb3ZlIGFueSB0aW50IGVmZmVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxNjc3NzIxNVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGludFJHQiA9IG51bGw7XG5cbiAgICAgICAgdGhpcy50aW50ID0gMHhGRkZGRkY7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBibGVuZCBtb2RlIHRvIGJlIGFwcGxpZWQgdG8gdGhlIHNwcml0ZS4gQXBwbHkgYSB2YWx1ZSBvZiBgUElYSS5CTEVORF9NT0RFUy5OT1JNQUxgIHRvIHJlc2V0IHRoZSBibGVuZCBtb2RlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMXG4gICAgICAgICAqIEBzZWUgUElYSS5CTEVORF9NT0RFU1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ibGVuZE1vZGUgPSBCTEVORF9NT0RFUy5OT1JNQUw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhY2hlZCB0aW50IHZhbHVlIHNvIHdlIGNhbiB0ZWxsIHdoZW4gdGhlIHRpbnQgaXMgY2hhbmdlZC5cbiAgICAgICAgICogVmFsdWUgaXMgdXNlZCBmb3IgMmQgQ2FudmFzUmVuZGVyZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAweEZGRkZGRlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fY2FjaGVkVGludCA9IDB4RkZGRkZGO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0aGlzIGlzIHVzZWQgdG8gc3RvcmUgdGhlIHV2cyBkYXRhIG9mIHRoZSBzcHJpdGUsIGFzc2lnbmVkIGF0IHRoZSBzYW1lIHRpbWVcbiAgICAgICAgICogYXMgdGhlIHZlcnRleERhdGEgaW4gY2FsY3VsYXRlVmVydGljZXMoKVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnV2cyA9IG51bGw7XG5cbiAgICAgICAgLy8gY2FsbCB0ZXh0dXJlIHNldHRlclxuICAgICAgICB0aGlzLnRleHR1cmUgPSB0ZXh0dXJlIHx8IFRleHR1cmUuRU1QVFk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHRoaXMgaXMgdXNlZCB0byBzdG9yZSB0aGUgdmVydGV4IGRhdGEgb2YgdGhlIHNwcml0ZSAoYmFzaWNhbGx5IGEgcXVhZClcbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQG1lbWJlciB7RmxvYXQzMkFycmF5fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52ZXJ0ZXhEYXRhID0gbmV3IEZsb2F0MzJBcnJheSg4KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBpcyB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgYm91bmRzIG9mIHRoZSBvYmplY3QgSUYgaXQgaXMgYSB0cmltbWVkIHNwcml0ZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZlcnRleFRyaW1tZWREYXRhID0gbnVsbDtcblxuICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IC0xO1xuICAgICAgICB0aGlzLl90ZXh0dXJlSUQgPSAtMTtcblxuICAgICAgICB0aGlzLl90cmFuc2Zvcm1UcmltbWVkSUQgPSAtMTtcbiAgICAgICAgdGhpcy5fdGV4dHVyZVRyaW1tZWRJRCA9IC0xO1xuXG4gICAgICAgIC8vIEJhdGNoYWJsZSBzdHVmZi4uXG4gICAgICAgIC8vIFRPRE8gY291bGQgbWFrZSB0aGlzIGEgbWl4aW4/XG4gICAgICAgIHRoaXMuaW5kaWNlcyA9IGluZGljZXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBsdWdpbiB0aGF0IGlzIHJlc3BvbnNpYmxlIGZvciByZW5kZXJpbmcgdGhpcyBlbGVtZW50LlxuICAgICAgICAgKiBBbGxvd3MgdG8gY3VzdG9taXplIHRoZSByZW5kZXJpbmcgcHJvY2VzcyB3aXRob3V0IG92ZXJyaWRpbmcgJ19yZW5kZXInICYgJ19yZW5kZXJDYW52YXMnIG1ldGhvZHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQGRlZmF1bHQgJ2JhdGNoJ1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wbHVnaW5OYW1lID0gJ2JhdGNoJztcblxuICAgICAgICAvKipcbiAgICAgICAgICogdXNlZCB0byBmYXN0IGNoZWNrIGlmIGEgc3ByaXRlIGlzLi4gYSBzcHJpdGUhXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlzU3ByaXRlID0gdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgcm91bmRQaXhlbHMgZmllbGRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3JvdW5kUGl4ZWxzID0gc2V0dGluZ3MuUk9VTkRfUElYRUxTO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZW4gdGhlIHRleHR1cmUgaXMgdXBkYXRlZCwgdGhpcyBldmVudCB3aWxsIGZpcmUgdG8gdXBkYXRlIHRoZSBzY2FsZSBhbmQgZnJhbWVcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX29uVGV4dHVyZVVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLl90ZXh0dXJlSUQgPSAtMTtcbiAgICAgICAgdGhpcy5fdGV4dHVyZVRyaW1tZWRJRCA9IC0xO1xuICAgICAgICB0aGlzLl9jYWNoZWRUaW50ID0gMHhGRkZGRkY7XG5cbiAgICAgICAgLy8gc28gaWYgX3dpZHRoIGlzIDAgdGhlbiB3aWR0aCB3YXMgbm90IHNldC4uXG4gICAgICAgIGlmICh0aGlzLl93aWR0aClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zY2FsZS54ID0gc2lnbih0aGlzLnNjYWxlLngpICogdGhpcy5fd2lkdGggLyB0aGlzLl90ZXh0dXJlLm9yaWcud2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5faGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnNjYWxlLnkgPSBzaWduKHRoaXMuc2NhbGUueSkgKiB0aGlzLl9oZWlnaHQgLyB0aGlzLl90ZXh0dXJlLm9yaWcuaGVpZ2h0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIGFuY2hvciBwb3NpdGlvbiB1cGRhdGVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9vbkFuY2hvclVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IC0xO1xuICAgICAgICB0aGlzLl90cmFuc2Zvcm1UcmltbWVkSUQgPSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjYWxjdWxhdGVzIHdvcmxkVHJhbnNmb3JtICogdmVydGljZXMsIHN0b3JlIGl0IGluIHZlcnRleERhdGFcbiAgICAgKi9cbiAgICBwdWJsaWMgY2FsY3VsYXRlVmVydGljZXMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IHRoaXMuX3RleHR1cmU7XG5cbiAgICAgICAgaWYgKHRoaXMuX3RyYW5zZm9ybUlEID09PSB0aGlzLnRyYW5zZm9ybS5fd29ybGRJRCAmJiB0aGlzLl90ZXh0dXJlSUQgPT09IHRleHR1cmUuX3VwZGF0ZUlEKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1cGRhdGUgdGV4dHVyZSBVViBoZXJlLCBiZWNhdXNlIGJhc2UgdGV4dHVyZSBjYW4gYmUgY2hhbmdlZCB3aXRob3V0IGNhbGxpbmcgYF9vblRleHR1cmVVcGRhdGVgXG4gICAgICAgIGlmICh0aGlzLl90ZXh0dXJlSUQgIT09IHRleHR1cmUuX3VwZGF0ZUlEKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnV2cyA9IHRoaXMuX3RleHR1cmUuX3V2cy51dnNGbG9hdDMyO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtSUQgPSB0aGlzLnRyYW5zZm9ybS5fd29ybGRJRDtcbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gdGV4dHVyZS5fdXBkYXRlSUQ7XG5cbiAgICAgICAgLy8gc2V0IHRoZSB2ZXJ0ZXggZGF0YVxuXG4gICAgICAgIGNvbnN0IHd0ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgICAgIGNvbnN0IGEgPSB3dC5hO1xuICAgICAgICBjb25zdCBiID0gd3QuYjtcbiAgICAgICAgY29uc3QgYyA9IHd0LmM7XG4gICAgICAgIGNvbnN0IGQgPSB3dC5kO1xuICAgICAgICBjb25zdCB0eCA9IHd0LnR4O1xuICAgICAgICBjb25zdCB0eSA9IHd0LnR5O1xuICAgICAgICBjb25zdCB2ZXJ0ZXhEYXRhID0gdGhpcy52ZXJ0ZXhEYXRhO1xuICAgICAgICBjb25zdCB0cmltID0gdGV4dHVyZS50cmltO1xuICAgICAgICBjb25zdCBvcmlnID0gdGV4dHVyZS5vcmlnO1xuICAgICAgICBjb25zdCBhbmNob3IgPSB0aGlzLl9hbmNob3I7XG5cbiAgICAgICAgbGV0IHcwID0gMDtcbiAgICAgICAgbGV0IHcxID0gMDtcbiAgICAgICAgbGV0IGgwID0gMDtcbiAgICAgICAgbGV0IGgxID0gMDtcblxuICAgICAgICBpZiAodHJpbSlcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gaWYgdGhlIHNwcml0ZSBpcyB0cmltbWVkIGFuZCBpcyBub3QgYSB0aWxpbmdzcHJpdGUgdGhlbiB3ZSBuZWVkIHRvIGFkZCB0aGUgZXh0cmFcbiAgICAgICAgICAgIC8vIHNwYWNlIGJlZm9yZSB0cmFuc2Zvcm1pbmcgdGhlIHNwcml0ZSBjb29yZHMuXG4gICAgICAgICAgICB3MSA9IHRyaW0ueCAtIChhbmNob3IuX3ggKiBvcmlnLndpZHRoKTtcbiAgICAgICAgICAgIHcwID0gdzEgKyB0cmltLndpZHRoO1xuXG4gICAgICAgICAgICBoMSA9IHRyaW0ueSAtIChhbmNob3IuX3kgKiBvcmlnLmhlaWdodCk7XG4gICAgICAgICAgICBoMCA9IGgxICsgdHJpbS5oZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB3MSA9IC1hbmNob3IuX3ggKiBvcmlnLndpZHRoO1xuICAgICAgICAgICAgdzAgPSB3MSArIG9yaWcud2lkdGg7XG5cbiAgICAgICAgICAgIGgxID0gLWFuY2hvci5feSAqIG9yaWcuaGVpZ2h0O1xuICAgICAgICAgICAgaDAgPSBoMSArIG9yaWcuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8geHlcbiAgICAgICAgdmVydGV4RGF0YVswXSA9IChhICogdzEpICsgKGMgKiBoMSkgKyB0eDtcbiAgICAgICAgdmVydGV4RGF0YVsxXSA9IChkICogaDEpICsgKGIgKiB3MSkgKyB0eTtcblxuICAgICAgICAvLyB4eVxuICAgICAgICB2ZXJ0ZXhEYXRhWzJdID0gKGEgKiB3MCkgKyAoYyAqIGgxKSArIHR4O1xuICAgICAgICB2ZXJ0ZXhEYXRhWzNdID0gKGQgKiBoMSkgKyAoYiAqIHcwKSArIHR5O1xuXG4gICAgICAgIC8vIHh5XG4gICAgICAgIHZlcnRleERhdGFbNF0gPSAoYSAqIHcwKSArIChjICogaDApICsgdHg7XG4gICAgICAgIHZlcnRleERhdGFbNV0gPSAoZCAqIGgwKSArIChiICogdzApICsgdHk7XG5cbiAgICAgICAgLy8geHlcbiAgICAgICAgdmVydGV4RGF0YVs2XSA9IChhICogdzEpICsgKGMgKiBoMCkgKyB0eDtcbiAgICAgICAgdmVydGV4RGF0YVs3XSA9IChkICogaDApICsgKGIgKiB3MSkgKyB0eTtcblxuICAgICAgICBpZiAodGhpcy5fcm91bmRQaXhlbHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSBzZXR0aW5ncy5SRVNPTFVUSU9OO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRleERhdGEubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmVydGV4RGF0YVtpXSA9IE1hdGgucm91bmQoKHZlcnRleERhdGFbaV0gKiByZXNvbHV0aW9uIHwgMCkgLyByZXNvbHV0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNhbGN1bGF0ZXMgd29ybGRUcmFuc2Zvcm0gKiB2ZXJ0aWNlcyBmb3IgYSBub24gdGV4dHVyZSB3aXRoIGEgdHJpbS4gc3RvcmUgaXQgaW4gdmVydGV4VHJpbW1lZERhdGFcbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gZW5zdXJlIHRoYXQgdGhlIHRydWUgd2lkdGggYW5kIGhlaWdodCBvZiBhIHRyaW1tZWQgdGV4dHVyZSBpcyByZXNwZWN0ZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgY2FsY3VsYXRlVHJpbW1lZFZlcnRpY2VzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy52ZXJ0ZXhUcmltbWVkRGF0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy52ZXJ0ZXhUcmltbWVkRGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoOCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fdHJhbnNmb3JtVHJpbW1lZElEID09PSB0aGlzLnRyYW5zZm9ybS5fd29ybGRJRCAmJiB0aGlzLl90ZXh0dXJlVHJpbW1lZElEID09PSB0aGlzLl90ZXh0dXJlLl91cGRhdGVJRClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtVHJpbW1lZElEID0gdGhpcy50cmFuc2Zvcm0uX3dvcmxkSUQ7XG4gICAgICAgIHRoaXMuX3RleHR1cmVUcmltbWVkSUQgPSB0aGlzLl90ZXh0dXJlLl91cGRhdGVJRDtcblxuICAgICAgICAvLyBsZXRzIGRvIHNvbWUgc3BlY2lhbCB0cmltIGNvZGUhXG4gICAgICAgIGNvbnN0IHRleHR1cmUgPSB0aGlzLl90ZXh0dXJlO1xuICAgICAgICBjb25zdCB2ZXJ0ZXhEYXRhID0gdGhpcy52ZXJ0ZXhUcmltbWVkRGF0YTtcbiAgICAgICAgY29uc3Qgb3JpZyA9IHRleHR1cmUub3JpZztcbiAgICAgICAgY29uc3QgYW5jaG9yID0gdGhpcy5fYW5jaG9yO1xuXG4gICAgICAgIC8vIGxldHMgY2FsY3VsYXRlIHRoZSBuZXcgdW50cmltbWVkIGJvdW5kcy4uXG4gICAgICAgIGNvbnN0IHd0ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgICAgIGNvbnN0IGEgPSB3dC5hO1xuICAgICAgICBjb25zdCBiID0gd3QuYjtcbiAgICAgICAgY29uc3QgYyA9IHd0LmM7XG4gICAgICAgIGNvbnN0IGQgPSB3dC5kO1xuICAgICAgICBjb25zdCB0eCA9IHd0LnR4O1xuICAgICAgICBjb25zdCB0eSA9IHd0LnR5O1xuXG4gICAgICAgIGNvbnN0IHcxID0gLWFuY2hvci5feCAqIG9yaWcud2lkdGg7XG4gICAgICAgIGNvbnN0IHcwID0gdzEgKyBvcmlnLndpZHRoO1xuXG4gICAgICAgIGNvbnN0IGgxID0gLWFuY2hvci5feSAqIG9yaWcuaGVpZ2h0O1xuICAgICAgICBjb25zdCBoMCA9IGgxICsgb3JpZy5oZWlnaHQ7XG5cbiAgICAgICAgLy8geHlcbiAgICAgICAgdmVydGV4RGF0YVswXSA9IChhICogdzEpICsgKGMgKiBoMSkgKyB0eDtcbiAgICAgICAgdmVydGV4RGF0YVsxXSA9IChkICogaDEpICsgKGIgKiB3MSkgKyB0eTtcblxuICAgICAgICAvLyB4eVxuICAgICAgICB2ZXJ0ZXhEYXRhWzJdID0gKGEgKiB3MCkgKyAoYyAqIGgxKSArIHR4O1xuICAgICAgICB2ZXJ0ZXhEYXRhWzNdID0gKGQgKiBoMSkgKyAoYiAqIHcwKSArIHR5O1xuXG4gICAgICAgIC8vIHh5XG4gICAgICAgIHZlcnRleERhdGFbNF0gPSAoYSAqIHcwKSArIChjICogaDApICsgdHg7XG4gICAgICAgIHZlcnRleERhdGFbNV0gPSAoZCAqIGgwKSArIChiICogdzApICsgdHk7XG5cbiAgICAgICAgLy8geHlcbiAgICAgICAgdmVydGV4RGF0YVs2XSA9IChhICogdzEpICsgKGMgKiBoMCkgKyB0eDtcbiAgICAgICAgdmVydGV4RGF0YVs3XSA9IChkICogaDApICsgKGIgKiB3MSkgKyB0eTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqXG4gICAgKiBSZW5kZXJzIHRoZSBvYmplY3QgdXNpbmcgdGhlIFdlYkdMIHJlbmRlcmVyXG4gICAgKlxuICAgICogQHByb3RlY3RlZFxuICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIFRoZSB3ZWJnbCByZW5kZXJlciB0byB1c2UuXG4gICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZVZlcnRpY2VzKCk7XG5cbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guc2V0T2JqZWN0UmVuZGVyZXIocmVuZGVyZXIucGx1Z2luc1t0aGlzLnBsdWdpbk5hbWVdKTtcbiAgICAgICAgcmVuZGVyZXIucGx1Z2luc1t0aGlzLnBsdWdpbk5hbWVdLnJlbmRlcih0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBib3VuZHMgb2YgdGhlIHNwcml0ZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX2NhbGN1bGF0ZUJvdW5kcygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB0cmltID0gdGhpcy5fdGV4dHVyZS50cmltO1xuICAgICAgICBjb25zdCBvcmlnID0gdGhpcy5fdGV4dHVyZS5vcmlnO1xuXG4gICAgICAgIC8vIEZpcnN0IGxldHMgY2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHRleHR1cmUgaGFzIGEgdHJpbS4uXG4gICAgICAgIGlmICghdHJpbSB8fCAodHJpbS53aWR0aCA9PT0gb3JpZy53aWR0aCAmJiB0cmltLmhlaWdodCA9PT0gb3JpZy5oZWlnaHQpKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBubyB0cmltISBsZXRzIHVzZSB0aGUgdXN1YWwgY2FsY3VsYXRpb25zLi5cbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVmVydGljZXMoKTtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5hZGRRdWFkKHRoaXMudmVydGV4RGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBsZXRzIGNhbGN1bGF0ZSBhIHNwZWNpYWwgdHJpbW1lZCBib3VuZHMuLi5cbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVHJpbW1lZFZlcnRpY2VzKCk7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZHMuYWRkUXVhZCh0aGlzLnZlcnRleFRyaW1tZWREYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGxvY2FsIGJvdW5kcyBvZiB0aGUgc3ByaXRlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IFtyZWN0XSAtIFRoZSBvdXRwdXQgcmVjdGFuZ2xlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuUmVjdGFuZ2xlfSBUaGUgYm91bmRzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRMb2NhbEJvdW5kcyhyZWN0OiBSZWN0YW5nbGUpOiBSZWN0YW5nbGVcbiAgICB7XG4gICAgICAgIC8vIHdlIGNhbiBkbyBhIGZhc3QgbG9jYWwgYm91bmRzIGlmIHRoZSBzcHJpdGUgaGFzIG5vIGNoaWxkcmVuIVxuICAgICAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5taW5YID0gdGhpcy5fdGV4dHVyZS5vcmlnLndpZHRoICogLXRoaXMuX2FuY2hvci5feDtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5taW5ZID0gdGhpcy5fdGV4dHVyZS5vcmlnLmhlaWdodCAqIC10aGlzLl9hbmNob3IuX3k7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZHMubWF4WCA9IHRoaXMuX3RleHR1cmUub3JpZy53aWR0aCAqICgxIC0gdGhpcy5fYW5jaG9yLl94KTtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5tYXhZID0gdGhpcy5fdGV4dHVyZS5vcmlnLmhlaWdodCAqICgxIC0gdGhpcy5fYW5jaG9yLl95KTtcblxuICAgICAgICAgICAgaWYgKCFyZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fbG9jYWxCb3VuZHNSZWN0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9jYWxCb3VuZHNSZWN0ID0gbmV3IFJlY3RhbmdsZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlY3QgPSB0aGlzLl9sb2NhbEJvdW5kc1JlY3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ib3VuZHMuZ2V0UmVjdGFuZ2xlKHJlY3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldExvY2FsQm91bmRzLmNhbGwodGhpcywgcmVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdHMgaWYgYSBwb2ludCBpcyBpbnNpZGUgdGhpcyBzcHJpdGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb2ludCAtIHRoZSBwb2ludCB0byB0ZXN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gdGhlIHJlc3VsdCBvZiB0aGUgdGVzdFxuICAgICAqL1xuICAgIHB1YmxpYyBjb250YWluc1BvaW50KHBvaW50OiBJUG9pbnREYXRhKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybS5hcHBseUludmVyc2UocG9pbnQsIHRlbXBQb2ludCk7XG5cbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLl90ZXh0dXJlLm9yaWcud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuX3RleHR1cmUub3JpZy5oZWlnaHQ7XG4gICAgICAgIGNvbnN0IHgxID0gLXdpZHRoICogdGhpcy5hbmNob3IueDtcbiAgICAgICAgbGV0IHkxID0gMDtcblxuICAgICAgICBpZiAodGVtcFBvaW50LnggPj0geDEgJiYgdGVtcFBvaW50LnggPCB4MSArIHdpZHRoKVxuICAgICAgICB7XG4gICAgICAgICAgICB5MSA9IC1oZWlnaHQgKiB0aGlzLmFuY2hvci55O1xuXG4gICAgICAgICAgICBpZiAodGVtcFBvaW50LnkgPj0geTEgJiYgdGVtcFBvaW50LnkgPCB5MSArIGhlaWdodClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGlzIHNwcml0ZSBhbmQgb3B0aW9uYWxseSBpdHMgdGV4dHVyZSBhbmQgY2hpbGRyZW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fGJvb2xlYW59IFtvcHRpb25zXSAtIE9wdGlvbnMgcGFyYW1ldGVyLiBBIGJvb2xlYW4gd2lsbCBhY3QgYXMgaWYgYWxsIG9wdGlvbnNcbiAgICAgKiAgaGF2ZSBiZWVuIHNldCB0byB0aGF0IHZhbHVlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jaGlsZHJlbj1mYWxzZV0gLSBpZiBzZXQgdG8gdHJ1ZSwgYWxsIHRoZSBjaGlsZHJlbiB3aWxsIGhhdmUgdGhlaXIgZGVzdHJveVxuICAgICAqICAgICAgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50ZXh0dXJlPWZhbHNlXSAtIFNob3VsZCBpdCBkZXN0cm95IHRoZSBjdXJyZW50IHRleHR1cmUgb2YgdGhlIHNwcml0ZSBhcyB3ZWxsXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5iYXNlVGV4dHVyZT1mYWxzZV0gLSBTaG91bGQgaXQgZGVzdHJveSB0aGUgYmFzZSB0ZXh0dXJlIG9mIHRoZSBzcHJpdGUgYXMgd2VsbFxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KG9wdGlvbnM6IElEZXN0cm95T3B0aW9uc3xib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveShvcHRpb25zKTtcblxuICAgICAgICB0aGlzLl90ZXh0dXJlLm9mZigndXBkYXRlJywgdGhpcy5fb25UZXh0dXJlVXBkYXRlLCB0aGlzKTtcblxuICAgICAgICB0aGlzLl9hbmNob3IgPSBudWxsO1xuXG4gICAgICAgIGNvbnN0IGRlc3Ryb3lUZXh0dXJlID0gdHlwZW9mIG9wdGlvbnMgPT09ICdib29sZWFuJyA/IG9wdGlvbnMgOiBvcHRpb25zICYmIG9wdGlvbnMudGV4dHVyZTtcblxuICAgICAgICBpZiAoZGVzdHJveVRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc3Ryb3lCYXNlVGV4dHVyZSA9IHR5cGVvZiBvcHRpb25zID09PSAnYm9vbGVhbicgPyBvcHRpb25zIDogb3B0aW9ucyAmJiBvcHRpb25zLmJhc2VUZXh0dXJlO1xuXG4gICAgICAgICAgICB0aGlzLl90ZXh0dXJlLmRlc3Ryb3koISFkZXN0cm95QmFzZVRleHR1cmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gc29tZSBoZWxwZXIgZnVuY3Rpb25zLi5cblxuICAgIC8qKlxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0aGF0IGNyZWF0ZXMgYSBuZXcgc3ByaXRlIGJhc2VkIG9uIHRoZSBzb3VyY2UgeW91IHByb3ZpZGUuXG4gICAgICogVGhlIHNvdXJjZSBjYW4gYmUgLSBmcmFtZSBpZCwgaW1hZ2UgdXJsLCB2aWRlbyB1cmwsIGNhbnZhcyBlbGVtZW50LCB2aWRlbyBlbGVtZW50LCBiYXNlIHRleHR1cmVcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xQSVhJLlRleHR1cmV8SFRNTENhbnZhc0VsZW1lbnR8SFRNTFZpZGVvRWxlbWVudH0gc291cmNlIC0gU291cmNlIHRvIGNyZWF0ZSB0ZXh0dXJlIGZyb21cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gU2VlIHtAbGluayBQSVhJLkJhc2VUZXh0dXJlfSdzIGNvbnN0cnVjdG9yIGZvciBvcHRpb25zLlxuICAgICAqIEByZXR1cm4ge1BJWEkuU3ByaXRlfSBUaGUgbmV3bHkgY3JlYXRlZCBzcHJpdGVcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbShzb3VyY2U6IFNwcml0ZVNvdXJjZSwgb3B0aW9uczogSUJhc2VUZXh0dXJlT3B0aW9ucyk6IFNwcml0ZVxuICAgIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IChzb3VyY2UgaW5zdGFuY2VvZiBUZXh0dXJlKVxuICAgICAgICAgICAgPyBzb3VyY2VcbiAgICAgICAgICAgIDogVGV4dHVyZS5mcm9tKHNvdXJjZSwgb3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBTcHJpdGUodGV4dHVyZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdHJ1ZSBQaXhpSlMgd2lsbCBNYXRoLmZsb29yKCkgeC95IHZhbHVlcyB3aGVuIHJlbmRlcmluZywgc3RvcHBpbmcgcGl4ZWwgaW50ZXJwb2xhdGlvbi5cbiAgICAgKiBBZHZhbnRhZ2VzIGNhbiBpbmNsdWRlIHNoYXJwZXIgaW1hZ2UgcXVhbGl0eSAobGlrZSB0ZXh0KSBhbmQgZmFzdGVyIHJlbmRlcmluZyBvbiBjYW52YXMuXG4gICAgICogVGhlIG1haW4gZGlzYWR2YW50YWdlIGlzIG1vdmVtZW50IG9mIG9iamVjdHMgbWF5IGFwcGVhciBsZXNzIHNtb290aC5cbiAgICAgKiBUbyBzZXQgdGhlIGdsb2JhbCBkZWZhdWx0LCBjaGFuZ2Uge0BsaW5rIFBJWEkuc2V0dGluZ3MuUk9VTkRfUElYRUxTfVxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAqL1xuICAgIHNldCByb3VuZFBpeGVscyh2YWx1ZTogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9yb3VuZFBpeGVscyAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zZm9ybUlEID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcm91bmRQaXhlbHMgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXQgcm91bmRQaXhlbHMoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kUGl4ZWxzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgc3ByaXRlLCBzZXR0aW5nIHRoaXMgd2lsbCBhY3R1YWxseSBtb2RpZnkgdGhlIHNjYWxlIHRvIGFjaGlldmUgdGhlIHZhbHVlIHNldFxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCB3aWR0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLnNjYWxlLngpICogdGhpcy5fdGV4dHVyZS5vcmlnLndpZHRoO1xuICAgIH1cblxuICAgIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgY29uc3QgcyA9IHNpZ24odGhpcy5zY2FsZS54KSB8fCAxO1xuXG4gICAgICAgIHRoaXMuc2NhbGUueCA9IHMgKiB2YWx1ZSAvIHRoaXMuX3RleHR1cmUub3JpZy53aWR0aDtcbiAgICAgICAgdGhpcy5fd2lkdGggPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBzcHJpdGUsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgc2NhbGUgdG8gYWNoaWV2ZSB0aGUgdmFsdWUgc2V0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGhlaWdodCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLnNjYWxlLnkpICogdGhpcy5fdGV4dHVyZS5vcmlnLmhlaWdodDtcbiAgICB9XG5cbiAgICBzZXQgaGVpZ2h0KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBjb25zdCBzID0gc2lnbih0aGlzLnNjYWxlLnkpIHx8IDE7XG5cbiAgICAgICAgdGhpcy5zY2FsZS55ID0gcyAqIHZhbHVlIC8gdGhpcy5fdGV4dHVyZS5vcmlnLmhlaWdodDtcbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGFuY2hvciBzZXRzIHRoZSBvcmlnaW4gcG9pbnQgb2YgdGhlIHNwcml0ZS4gVGhlIGRlZmF1bHQgdmFsdWUgaXMgdGFrZW4gZnJvbSB0aGUge0BsaW5rIFBJWEkuVGV4dHVyZXxUZXh0dXJlfVxuICAgICAqIGFuZCBwYXNzZWQgdG8gdGhlIGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogVGhlIGRlZmF1bHQgaXMgYCgwLDApYCwgdGhpcyBtZWFucyB0aGUgc3ByaXRlJ3Mgb3JpZ2luIGlzIHRoZSB0b3AgbGVmdC5cbiAgICAgKlxuICAgICAqIFNldHRpbmcgdGhlIGFuY2hvciB0byBgKDAuNSwwLjUpYCBtZWFucyB0aGUgc3ByaXRlJ3Mgb3JpZ2luIGlzIGNlbnRlcmVkLlxuICAgICAqXG4gICAgICogU2V0dGluZyB0aGUgYW5jaG9yIHRvIGAoMSwxKWAgd291bGQgbWVhbiB0aGUgc3ByaXRlJ3Mgb3JpZ2luIHBvaW50IHdpbGwgYmUgdGhlIGJvdHRvbSByaWdodCBjb3JuZXIuXG4gICAgICpcbiAgICAgKiBJZiB5b3UgcGFzcyBvbmx5IHNpbmdsZSBwYXJhbWV0ZXIsIGl0IHdpbGwgc2V0IGJvdGggeCBhbmQgeSB0byB0aGUgc2FtZSB2YWx1ZSBhcyBzaG93biBpbiB0aGUgZXhhbXBsZSBiZWxvdy5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xuICAgICAqIHNwcml0ZS5hbmNob3Iuc2V0KDAuNSk7IC8vIFRoaXMgd2lsbCBzZXQgdGhlIG9yaWdpbiB0byBjZW50ZXIuICgwLjUpIGlzIHNhbWUgYXMgKDAuNSwgMC41KS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAqL1xuICAgIGdldCBhbmNob3IoKTogT2JzZXJ2YWJsZVBvaW50XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYW5jaG9yO1xuICAgIH1cblxuICAgIHNldCBhbmNob3IodmFsdWU6IE9ic2VydmFibGVQb2ludClcbiAgICB7XG4gICAgICAgIHRoaXMuX2FuY2hvci5jb3B5RnJvbSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHRpbnQgYXBwbGllZCB0byB0aGUgc3ByaXRlLiBUaGlzIGlzIGEgaGV4IHZhbHVlLlxuICAgICAqIEEgdmFsdWUgb2YgMHhGRkZGRkYgd2lsbCByZW1vdmUgYW55IHRpbnQgZWZmZWN0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDB4RkZGRkZGXG4gICAgICovXG4gICAgZ2V0IHRpbnQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGludDtcbiAgICB9XG5cbiAgICBzZXQgdGludCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5fdGludCA9IHZhbHVlO1xuICAgICAgICB0aGlzLl90aW50UkdCID0gKHZhbHVlID4+IDE2KSArICh2YWx1ZSAmIDB4ZmYwMCkgKyAoKHZhbHVlICYgMHhmZikgPDwgMTYpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB0ZXh0dXJlIHRoYXQgdGhlIHNwcml0ZSBpcyB1c2luZ1xuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlfVxuICAgICAqL1xuICAgIGdldCB0ZXh0dXJlKCk6IFRleHR1cmVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0dXJlO1xuICAgIH1cblxuICAgIHNldCB0ZXh0dXJlKHZhbHVlOiBUZXh0dXJlKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3RleHR1cmUgPT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fdGV4dHVyZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fdGV4dHVyZS5vZmYoJ3VwZGF0ZScsIHRoaXMuX29uVGV4dHVyZVVwZGF0ZSwgdGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl90ZXh0dXJlID0gdmFsdWUgfHwgVGV4dHVyZS5FTVBUWTtcbiAgICAgICAgdGhpcy5fY2FjaGVkVGludCA9IDB4RkZGRkZGO1xuXG4gICAgICAgIHRoaXMuX3RleHR1cmVJRCA9IC0xO1xuICAgICAgICB0aGlzLl90ZXh0dXJlVHJpbW1lZElEID0gLTE7XG5cbiAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB3YWl0IGZvciB0aGUgdGV4dHVyZSB0byBsb2FkXG4gICAgICAgICAgICBpZiAodmFsdWUuYmFzZVRleHR1cmUudmFsaWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25UZXh0dXJlVXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWUub25jZSgndXBkYXRlJywgdGhpcy5fb25UZXh0dXJlVXBkYXRlLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICIvKipcbiAqIENvbnN0YW50cyB0aGF0IGRlZmluZSB0aGUgdHlwZSBvZiBncmFkaWVudCBvbiB0ZXh0LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBjb25zdGFudFxuICogQG5hbWUgVEVYVF9HUkFESUVOVFxuICogQG1lbWJlcm9mIFBJWElcbiAqIEB0eXBlIHtvYmplY3R9XG4gKiBAcHJvcGVydHkge251bWJlcn0gTElORUFSX1ZFUlRJQ0FMIFZlcnRpY2FsIGdyYWRpZW50XG4gKiBAcHJvcGVydHkge251bWJlcn0gTElORUFSX0hPUklaT05UQUwgTGluZWFyIGdyYWRpZW50XG4gKi9cbmV4cG9ydCBlbnVtIFRFWFRfR1JBRElFTlQge1xuICAgIExJTkVBUl9WRVJUSUNBTCA9IDAsXG4gICAgTElORUFSX0hPUklaT05UQUwgPSAxXG59XG4iLCAiLy8gZGlzYWJsaW5nIGVzbGludCBmb3Igbm93LCBnb2luZyB0byByZXdyaXRlIHRoaXMgaW4gdjVcbi8qIGVzbGludC1kaXNhYmxlICovXG5cbmltcG9ydCB7IFRFWFRfR1JBRElFTlQgfSBmcm9tICcuL2NvbnN0JztcbmltcG9ydCB7IGhleDJzdHJpbmcgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmV4cG9ydCB0eXBlIFRleHRTdHlsZUFsaWduID0gJ2xlZnQnfCdjZW50ZXInfCdyaWdodCc7XG5leHBvcnQgdHlwZSBUZXh0U3R5bGVGaWxsID0gc3RyaW5nfHN0cmluZ1tdfG51bWJlcnxudW1iZXJbXXxDYW52YXNHcmFkaWVudHxDYW52YXNQYXR0ZXJuO1xuZXhwb3J0IHR5cGUgVGV4dFN0eWxlRm9udFN0eWxlID0gJ25vcm1hbCd8J2l0YWxpYyd8J29ibGlxdWUnO1xuZXhwb3J0IHR5cGUgVGV4dFN0eWxlRm9udFZhcmlhbnQgPSAnbm9ybWFsJ3wnc21hbGwtY2Fwcyc7XG5leHBvcnQgdHlwZSBUZXh0U3R5bGVGb250V2VpZ2h0ID0gJ25vcm1hbCd8J2JvbGQnfCdib2xkZXInfCdsaWdodGVyJ3wnMTAwJ3wnMjAwJ3wnMzAwJ3wnNDAwJ3wnNTAwJ3wnNjAwJ3wnNzAwJ3wnODAwJ3wnOTAwJztcbmV4cG9ydCB0eXBlIFRleHRTdHlsZUxpbmVKb2luID0gJ21pdGVyJ3wncm91bmQnfCdiZXZlbCc7XG5leHBvcnQgdHlwZSBUZXh0U3R5bGVUZXh0QmFzZWxpbmUgPSAnYWxwaGFiZXRpYyd8J3RvcCd8J2hhbmdpbmcnfCdtaWRkbGUnfCdpZGVvZ3JhcGhpYyd8J2JvdHRvbSc7XG5leHBvcnQgdHlwZSBUZXh0U3R5bGVXaGl0ZVNwYWNlID0gJ25vcm1hbCd8J3ByZSd8J3ByZS1saW5lJztcblxuZXhwb3J0IGludGVyZmFjZSBJVGV4dFN0eWxlIHtcbiAgICBhbGlnbjogVGV4dFN0eWxlQWxpZ247XG4gICAgYnJlYWtXb3JkczogYm9vbGVhbjtcbiAgICBkcm9wU2hhZG93OiBib29sZWFuO1xuICAgIGRyb3BTaGFkb3dBbHBoYTogbnVtYmVyO1xuICAgIGRyb3BTaGFkb3dBbmdsZTogbnVtYmVyO1xuICAgIGRyb3BTaGFkb3dCbHVyOiBudW1iZXI7XG4gICAgZHJvcFNoYWRvd0NvbG9yOiBzdHJpbmd8bnVtYmVyO1xuICAgIGRyb3BTaGFkb3dEaXN0YW5jZTogbnVtYmVyO1xuICAgIGZpbGw6IFRleHRTdHlsZUZpbGw7XG4gICAgZmlsbEdyYWRpZW50VHlwZTogVEVYVF9HUkFESUVOVDtcbiAgICBmaWxsR3JhZGllbnRTdG9wczogbnVtYmVyW107XG4gICAgZm9udEZhbWlseTogc3RyaW5nIHwgc3RyaW5nW107XG4gICAgZm9udFNpemU6IG51bWJlciB8IHN0cmluZztcbiAgICBmb250U3R5bGU6IFRleHRTdHlsZUZvbnRTdHlsZTtcbiAgICBmb250VmFyaWFudDogVGV4dFN0eWxlRm9udFZhcmlhbnQ7XG4gICAgZm9udFdlaWdodDogVGV4dFN0eWxlRm9udFdlaWdodDtcbiAgICBsZXR0ZXJTcGFjaW5nOiBudW1iZXI7XG4gICAgbGluZUhlaWdodDogbnVtYmVyO1xuICAgIGxpbmVKb2luOiBUZXh0U3R5bGVMaW5lSm9pbjtcbiAgICBtaXRlckxpbWl0OiBudW1iZXI7XG4gICAgcGFkZGluZzogbnVtYmVyO1xuICAgIHN0cm9rZTogc3RyaW5nfG51bWJlcjtcbiAgICBzdHJva2VUaGlja25lc3M6IG51bWJlcjtcbiAgICB0ZXh0QmFzZWxpbmU6IFRleHRTdHlsZVRleHRCYXNlbGluZTtcbiAgICB0cmltOiBib29sZWFuO1xuICAgIHdoaXRlU3BhY2U6IFRleHRTdHlsZVdoaXRlU3BhY2U7XG4gICAgd29yZFdyYXA6IGJvb2xlYW47XG4gICAgd29yZFdyYXBXaWR0aDogbnVtYmVyO1xuICAgIGxlYWRpbmc6IG51bWJlcjtcbn1cblxuY29uc3QgZGVmYXVsdFN0eWxlOiBJVGV4dFN0eWxlID0ge1xuICAgIGFsaWduOiAnbGVmdCcsXG4gICAgYnJlYWtXb3JkczogZmFsc2UsXG4gICAgZHJvcFNoYWRvdzogZmFsc2UsXG4gICAgZHJvcFNoYWRvd0FscGhhOiAxLFxuICAgIGRyb3BTaGFkb3dBbmdsZTogTWF0aC5QSSAvIDYsXG4gICAgZHJvcFNoYWRvd0JsdXI6IDAsXG4gICAgZHJvcFNoYWRvd0NvbG9yOiAnYmxhY2snLFxuICAgIGRyb3BTaGFkb3dEaXN0YW5jZTogNSxcbiAgICBmaWxsOiAnYmxhY2snLFxuICAgIGZpbGxHcmFkaWVudFR5cGU6IFRFWFRfR1JBRElFTlQuTElORUFSX1ZFUlRJQ0FMLFxuICAgIGZpbGxHcmFkaWVudFN0b3BzOiBbXSxcbiAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICAgIGZvbnRTaXplOiAyNixcbiAgICBmb250U3R5bGU6ICdub3JtYWwnLFxuICAgIGZvbnRWYXJpYW50OiAnbm9ybWFsJyxcbiAgICBmb250V2VpZ2h0OiAnbm9ybWFsJyxcbiAgICBsZXR0ZXJTcGFjaW5nOiAwLFxuICAgIGxpbmVIZWlnaHQ6IDAsXG4gICAgbGluZUpvaW46ICdtaXRlcicsXG4gICAgbWl0ZXJMaW1pdDogMTAsXG4gICAgcGFkZGluZzogMCxcbiAgICBzdHJva2U6ICdibGFjaycsXG4gICAgc3Ryb2tlVGhpY2tuZXNzOiAwLFxuICAgIHRleHRCYXNlbGluZTogJ2FscGhhYmV0aWMnLFxuICAgIHRyaW06IGZhbHNlLFxuICAgIHdoaXRlU3BhY2U6ICdwcmUnLFxuICAgIHdvcmRXcmFwOiBmYWxzZSxcbiAgICB3b3JkV3JhcFdpZHRoOiAxMDAsXG4gICAgbGVhZGluZzogMCxcbn07XG5cbmNvbnN0IGdlbmVyaWNGb250RmFtaWxpZXMgPSBbXG4gICAgJ3NlcmlmJyxcbiAgICAnc2Fucy1zZXJpZicsXG4gICAgJ21vbm9zcGFjZScsXG4gICAgJ2N1cnNpdmUnLFxuICAgICdmYW50YXN5JyxcbiAgICAnc3lzdGVtLXVpJyxcbl07XG5cbi8qKlxuICogQSBUZXh0U3R5bGUgT2JqZWN0IGNvbnRhaW5zIGluZm9ybWF0aW9uIHRvIGRlY29yYXRlIGEgVGV4dCBvYmplY3RzLlxuICpcbiAqIEFuIGluc3RhbmNlIGNhbiBiZSBzaGFyZWQgYmV0d2VlbiBtdWx0aXBsZSBUZXh0IG9iamVjdHM7IHRoZW4gY2hhbmdpbmcgdGhlIHN0eWxlIHdpbGwgdXBkYXRlIGFsbCB0ZXh0IG9iamVjdHMgdXNpbmcgaXQuXG4gKlxuICogQSB0b29sIGNhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIGEgdGV4dCBzdHlsZSBbaGVyZV0oaHR0cHM6Ly9waXhpanMuaW8vcGl4aS10ZXh0LXN0eWxlKS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0U3R5bGUgaW1wbGVtZW50cyBJVGV4dFN0eWxlXG57XG4gICAgcHVibGljIHN0eWxlSUQ6IG51bWJlcjtcblxuICAgIHByb3RlY3RlZCBfYWxpZ246IFRleHRTdHlsZUFsaWduO1xuICAgIHByb3RlY3RlZCBfYnJlYWtXb3JkczogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgX2Ryb3BTaGFkb3c6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIF9kcm9wU2hhZG93QWxwaGE6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2Ryb3BTaGFkb3dBbmdsZTogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfZHJvcFNoYWRvd0JsdXI6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2Ryb3BTaGFkb3dDb2xvcjogc3RyaW5nfG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2Ryb3BTaGFkb3dEaXN0YW5jZTogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfZmlsbDogVGV4dFN0eWxlRmlsbDtcbiAgICBwcm90ZWN0ZWQgX2ZpbGxHcmFkaWVudFR5cGU6IFRFWFRfR1JBRElFTlQ7XG4gICAgcHJvdGVjdGVkIF9maWxsR3JhZGllbnRTdG9wczogbnVtYmVyW107XG4gICAgcHJvdGVjdGVkIF9mb250RmFtaWx5OiBzdHJpbmd8c3RyaW5nW107XG4gICAgcHJvdGVjdGVkIF9mb250U2l6ZTogbnVtYmVyfHN0cmluZztcbiAgICBwcm90ZWN0ZWQgX2ZvbnRTdHlsZTogVGV4dFN0eWxlRm9udFN0eWxlO1xuICAgIHByb3RlY3RlZCBfZm9udFZhcmlhbnQ6IFRleHRTdHlsZUZvbnRWYXJpYW50O1xuICAgIHByb3RlY3RlZCBfZm9udFdlaWdodDogVGV4dFN0eWxlRm9udFdlaWdodDtcbiAgICBwcm90ZWN0ZWQgX2xldHRlclNwYWNpbmc6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2xpbmVIZWlnaHQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2xpbmVKb2luOiBUZXh0U3R5bGVMaW5lSm9pbjtcbiAgICBwcm90ZWN0ZWQgX21pdGVyTGltaXQ6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3BhZGRpbmc6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3N0cm9rZTogc3RyaW5nfG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3N0cm9rZVRoaWNrbmVzczogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfdGV4dEJhc2VsaW5lOiBUZXh0U3R5bGVUZXh0QmFzZWxpbmU7XG4gICAgcHJvdGVjdGVkIF90cmltOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBfd2hpdGVTcGFjZTogVGV4dFN0eWxlV2hpdGVTcGFjZTtcbiAgICBwcm90ZWN0ZWQgX3dvcmRXcmFwOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBfd29yZFdyYXBXaWR0aDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfbGVhZGluZzogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtzdHlsZV0gLSBUaGUgc3R5bGUgcGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3R5bGUuYWxpZ249J2xlZnQnXSAtIEFsaWdubWVudCBmb3IgbXVsdGlsaW5lIHRleHQgKCdsZWZ0JywgJ2NlbnRlcicgb3IgJ3JpZ2h0JyksXG4gICAgICogIGRvZXMgbm90IGFmZmVjdCBzaW5nbGUgbGluZSB0ZXh0XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc3R5bGUuYnJlYWtXb3Jkcz1mYWxzZV0gLSBJbmRpY2F0ZXMgaWYgbGluZXMgY2FuIGJlIHdyYXBwZWQgd2l0aGluIHdvcmRzLCBpdFxuICAgICAqICBuZWVkcyB3b3JkV3JhcCB0byBiZSBzZXQgdG8gdHJ1ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3N0eWxlLmRyb3BTaGFkb3c9ZmFsc2VdIC0gU2V0IGEgZHJvcCBzaGFkb3cgZm9yIHRoZSB0ZXh0XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHlsZS5kcm9wU2hhZG93QWxwaGE9MV0gLSBTZXQgYWxwaGEgZm9yIHRoZSBkcm9wIHNoYWRvd1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3R5bGUuZHJvcFNoYWRvd0FuZ2xlPU1hdGguUEkvNl0gLSBTZXQgYSBhbmdsZSBvZiB0aGUgZHJvcCBzaGFkb3dcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLmRyb3BTaGFkb3dCbHVyPTBdIC0gU2V0IGEgc2hhZG93IGJsdXIgcmFkaXVzXG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBbc3R5bGUuZHJvcFNoYWRvd0NvbG9yPSdibGFjayddIC0gQSBmaWxsIHN0eWxlIHRvIGJlIHVzZWQgb24gdGhlIGRyb3BzaGFkb3cgZS5nICdyZWQnLCAnIzAwRkYwMCdcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLmRyb3BTaGFkb3dEaXN0YW5jZT01XSAtIFNldCBhIGRpc3RhbmNlIG9mIHRoZSBkcm9wIHNoYWRvd1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfG51bWJlcnxudW1iZXJbXXxDYW52YXNHcmFkaWVudHxDYW52YXNQYXR0ZXJufSBbc3R5bGUuZmlsbD0nYmxhY2snXSAtIEEgY2FudmFzXG4gICAgICogIGZpbGxzdHlsZSB0aGF0IHdpbGwgYmUgdXNlZCBvbiB0aGUgdGV4dCBlLmcgJ3JlZCcsICcjMDBGRjAwJy4gQ2FuIGJlIGFuIGFycmF5IHRvIGNyZWF0ZSBhIGdyYWRpZW50XG4gICAgICogIGVnIFsnIzAwMDAwMCcsJyNGRkZGRkYnXVxuICAgICAqIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEL2ZpbGxTdHlsZXxNRE59XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHlsZS5maWxsR3JhZGllbnRUeXBlPVBJWEkuVEVYVF9HUkFESUVOVC5MSU5FQVJfVkVSVElDQUxdIC0gSWYgZmlsbCBpcyBhbiBhcnJheSBvZiBjb2xvdXJzXG4gICAgICogIHRvIGNyZWF0ZSBhIGdyYWRpZW50LCB0aGlzIGNhbiBjaGFuZ2UgdGhlIHR5cGUvZGlyZWN0aW9uIG9mIHRoZSBncmFkaWVudC4gU2VlIHtAbGluayBQSVhJLlRFWFRfR1JBRElFTlR9XG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gW3N0eWxlLmZpbGxHcmFkaWVudFN0b3BzXSAtIElmIGZpbGwgaXMgYW4gYXJyYXkgb2YgY29sb3VycyB0byBjcmVhdGUgYSBncmFkaWVudCwgdGhpcyBhcnJheSBjYW4gc2V0XG4gICAgICogdGhlIHN0b3AgcG9pbnRzIChudW1iZXJzIGJldHdlZW4gMCBhbmQgMSkgZm9yIHRoZSBjb2xvciwgb3ZlcnJpZGluZyB0aGUgZGVmYXVsdCBiZWhhdmlvdXIgb2YgZXZlbmx5IHNwYWNpbmcgdGhlbS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xzdHJpbmdbXX0gW3N0eWxlLmZvbnRGYW1pbHk9J0FyaWFsJ10gLSBUaGUgZm9udCBmYW1pbHlcbiAgICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IFtzdHlsZS5mb250U2l6ZT0yNl0gLSBUaGUgZm9udCBzaXplIChhcyBhIG51bWJlciBpdCBjb252ZXJ0cyB0byBweCwgYnV0IGFzIGEgc3RyaW5nLFxuICAgICAqICBlcXVpdmFsZW50cyBhcmUgJzI2cHgnLCcyMHB0JywnMTYwJScgb3IgJzEuNmVtJylcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0eWxlLmZvbnRTdHlsZT0nbm9ybWFsJ10gLSBUaGUgZm9udCBzdHlsZSAoJ25vcm1hbCcsICdpdGFsaWMnIG9yICdvYmxpcXVlJylcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0eWxlLmZvbnRWYXJpYW50PSdub3JtYWwnXSAtIFRoZSBmb250IHZhcmlhbnQgKCdub3JtYWwnIG9yICdzbWFsbC1jYXBzJylcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0eWxlLmZvbnRXZWlnaHQ9J25vcm1hbCddIC0gVGhlIGZvbnQgd2VpZ2h0ICgnbm9ybWFsJywgJ2JvbGQnLCAnYm9sZGVyJywgJ2xpZ2h0ZXInIGFuZCAnMTAwJyxcbiAgICAgKiAgJzIwMCcsICczMDAnLCAnNDAwJywgJzUwMCcsICc2MDAnLCAnNzAwJywgJzgwMCcgb3IgJzkwMCcpXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHlsZS5sZWFkaW5nPTBdIC0gVGhlIHNwYWNlIGJldHdlZW4gbGluZXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLmxldHRlclNwYWNpbmc9MF0gLSBUaGUgYW1vdW50IG9mIHNwYWNpbmcgYmV0d2VlbiBsZXR0ZXJzLCBkZWZhdWx0IGlzIDBcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLmxpbmVIZWlnaHRdIC0gVGhlIGxpbmUgaGVpZ2h0LCBhIG51bWJlciB0aGF0IHJlcHJlc2VudHMgdGhlIHZlcnRpY2FsIHNwYWNlIHRoYXQgYSBsZXR0ZXIgdXNlc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3R5bGUubGluZUpvaW49J21pdGVyJ10gLSBUaGUgbGluZUpvaW4gcHJvcGVydHkgc2V0cyB0aGUgdHlwZSBvZiBjb3JuZXIgY3JlYXRlZCwgaXQgY2FuIHJlc29sdmVcbiAgICAgKiAgICAgIHNwaWtlZCB0ZXh0IGlzc3Vlcy4gUG9zc2libGUgdmFsdWVzIFwibWl0ZXJcIiAoY3JlYXRlcyBhIHNoYXJwIGNvcm5lciksIFwicm91bmRcIiAoY3JlYXRlcyBhIHJvdW5kIGNvcm5lcikgb3IgXCJiZXZlbFwiXG4gICAgICogICAgICAoY3JlYXRlcyBhIHNxdWFyZWQgY29ybmVyKS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLm1pdGVyTGltaXQ9MTBdIC0gVGhlIG1pdGVyIGxpbWl0IHRvIHVzZSB3aGVuIHVzaW5nIHRoZSAnbWl0ZXInIGxpbmVKb2luIG1vZGUuIFRoaXMgY2FuIHJlZHVjZVxuICAgICAqICAgICAgb3IgaW5jcmVhc2UgdGhlIHNwaWtpbmVzcyBvZiByZW5kZXJlZCB0ZXh0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3R5bGUucGFkZGluZz0wXSAtIE9jY2FzaW9uYWxseSBzb21lIGZvbnRzIGFyZSBjcm9wcGVkLiBBZGRpbmcgc29tZSBwYWRkaW5nIHdpbGwgcHJldmVudCB0aGlzIGZyb21cbiAgICAgKiAgICAgaGFwcGVuaW5nIGJ5IGFkZGluZyBwYWRkaW5nIHRvIGFsbCBzaWRlcyBvZiB0aGUgdGV4dC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IFtzdHlsZS5zdHJva2U9J2JsYWNrJ10gLSBBIGNhbnZhcyBmaWxsc3R5bGUgdGhhdCB3aWxsIGJlIHVzZWQgb24gdGhlIHRleHQgc3Ryb2tlXG4gICAgICogIGUuZyAnYmx1ZScsICcjRkNGRjAwJ1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3R5bGUuc3Ryb2tlVGhpY2tuZXNzPTBdIC0gQSBudW1iZXIgdGhhdCByZXByZXNlbnRzIHRoZSB0aGlja25lc3Mgb2YgdGhlIHN0cm9rZS5cbiAgICAgKiAgRGVmYXVsdCBpcyAwIChubyBzdHJva2UpXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbc3R5bGUudHJpbT1mYWxzZV0gLSBUcmltIHRyYW5zcGFyZW50IGJvcmRlcnNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0eWxlLnRleHRCYXNlbGluZT0nYWxwaGFiZXRpYyddIC0gVGhlIGJhc2VsaW5lIG9mIHRoZSB0ZXh0IHRoYXQgaXMgcmVuZGVyZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHlsZS53aGl0ZVNwYWNlPSdwcmUnXSAtIERldGVybWluZXMgd2hldGhlciBuZXdsaW5lcyAmIHNwYWNlcyBhcmUgY29sbGFwc2VkIG9yIHByZXNlcnZlZCBcIm5vcm1hbFwiXG4gICAgICogICAgICAoY29sbGFwc2UsIGNvbGxhcHNlKSwgXCJwcmVcIiAocHJlc2VydmUsIHByZXNlcnZlKSB8IFwicHJlLWxpbmVcIiAocHJlc2VydmUsIGNvbGxhcHNlKS4gSXQgbmVlZHMgd29yZFdyYXAgdG8gYmUgc2V0IHRvIHRydWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzdHlsZS53b3JkV3JhcD1mYWxzZV0gLSBJbmRpY2F0ZXMgaWYgd29yZCB3cmFwIHNob3VsZCBiZSB1c2VkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHlsZS53b3JkV3JhcFdpZHRoPTEwMF0gLSBUaGUgd2lkdGggYXQgd2hpY2ggdGV4dCB3aWxsIHdyYXAsIGl0IG5lZWRzIHdvcmRXcmFwIHRvIGJlIHNldCB0byB0cnVlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3R5bGU6IFBhcnRpYWw8SVRleHRTdHlsZT4pXG4gICAge1xuICAgICAgICB0aGlzLnN0eWxlSUQgPSAwO1xuXG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBkZWVwQ29weVByb3BlcnRpZXModGhpcywgc3R5bGUsIHN0eWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IFRleHRTdHlsZSBvYmplY3Qgd2l0aCB0aGUgc2FtZSB2YWx1ZXMgYXMgdGhpcyBvbmUuXG4gICAgICogTm90ZSB0aGF0IHRoZSBvbmx5IHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBvYmplY3QgYXJlIGNsb25lZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dFN0eWxlfSBOZXcgY2xvbmVkIFRleHRTdHlsZSBvYmplY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgY2xvbmUoKTogVGV4dFN0eWxlXG4gICAge1xuICAgICAgICBjb25zdCBjbG9uZWRQcm9wZXJ0aWVzOiBQYXJ0aWFsPElUZXh0U3R5bGU+ID0ge307XG5cbiAgICAgICAgZGVlcENvcHlQcm9wZXJ0aWVzKGNsb25lZFByb3BlcnRpZXMsIHRoaXMsIGRlZmF1bHRTdHlsZSk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0U3R5bGUoY2xvbmVkUHJvcGVydGllcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIGFsbCBwcm9wZXJ0aWVzIHRvIHRoZSBkZWZhdWx0cyBzcGVjaWZpZWQgaW4gVGV4dFN0eWxlLnByb3RvdHlwZS5fZGVmYXVsdFxuICAgICAqL1xuICAgIHB1YmxpYyByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICBkZWVwQ29weVByb3BlcnRpZXModGhpcywgZGVmYXVsdFN0eWxlLCBkZWZhdWx0U3R5bGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFsaWdubWVudCBmb3IgbXVsdGlsaW5lIHRleHQgKCdsZWZ0JywgJ2NlbnRlcicgb3IgJ3JpZ2h0JyksIGRvZXMgbm90IGFmZmVjdCBzaW5nbGUgbGluZSB0ZXh0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICovXG4gICAgZ2V0IGFsaWduKCk6IFRleHRTdHlsZUFsaWduXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYWxpZ247XG4gICAgfVxuICAgIHNldCBhbGlnbihhbGlnbjogVGV4dFN0eWxlQWxpZ24pXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fYWxpZ24gIT09IGFsaWduKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hbGlnbiA9IGFsaWduO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgaWYgbGluZXMgY2FuIGJlIHdyYXBwZWQgd2l0aGluIHdvcmRzLCBpdCBuZWVkcyB3b3JkV3JhcCB0byBiZSBzZXQgdG8gdHJ1ZVxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgYnJlYWtXb3JkcygpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnJlYWtXb3JkcztcbiAgICB9XG4gICAgc2V0IGJyZWFrV29yZHMoYnJlYWtXb3JkczogYm9vbGVhbilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9icmVha1dvcmRzICE9PSBicmVha1dvcmRzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9icmVha1dvcmRzID0gYnJlYWtXb3JkcztcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGEgZHJvcCBzaGFkb3cgZm9yIHRoZSB0ZXh0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBkcm9wU2hhZG93KCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kcm9wU2hhZG93O1xuICAgIH1cbiAgICBzZXQgZHJvcFNoYWRvdyhkcm9wU2hhZG93OiBib29sZWFuKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2Ryb3BTaGFkb3cgIT09IGRyb3BTaGFkb3cpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2Ryb3BTaGFkb3cgPSBkcm9wU2hhZG93O1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgYWxwaGEgZm9yIHRoZSBkcm9wIHNoYWRvd1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBkcm9wU2hhZG93QWxwaGEoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZHJvcFNoYWRvd0FscGhhO1xuICAgIH1cbiAgICBzZXQgZHJvcFNoYWRvd0FscGhhKGRyb3BTaGFkb3dBbHBoYTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2Ryb3BTaGFkb3dBbHBoYSAhPT0gZHJvcFNoYWRvd0FscGhhKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9kcm9wU2hhZG93QWxwaGEgPSBkcm9wU2hhZG93QWxwaGE7XG4gICAgICAgICAgICB0aGlzLnN0eWxlSUQrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBhIGFuZ2xlIG9mIHRoZSBkcm9wIHNoYWRvd1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBkcm9wU2hhZG93QW5nbGUoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZHJvcFNoYWRvd0FuZ2xlO1xuICAgIH1cbiAgICBzZXQgZHJvcFNoYWRvd0FuZ2xlKGRyb3BTaGFkb3dBbmdsZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2Ryb3BTaGFkb3dBbmdsZSAhPT0gZHJvcFNoYWRvd0FuZ2xlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9kcm9wU2hhZG93QW5nbGUgPSBkcm9wU2hhZG93QW5nbGU7XG4gICAgICAgICAgICB0aGlzLnN0eWxlSUQrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBhIHNoYWRvdyBibHVyIHJhZGl1c1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBkcm9wU2hhZG93Qmx1cigpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kcm9wU2hhZG93Qmx1cjtcbiAgICB9XG4gICAgc2V0IGRyb3BTaGFkb3dCbHVyKGRyb3BTaGFkb3dCbHVyOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fZHJvcFNoYWRvd0JsdXIgIT09IGRyb3BTaGFkb3dCbHVyKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9kcm9wU2hhZG93Qmx1ciA9IGRyb3BTaGFkb3dCbHVyO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGZpbGwgc3R5bGUgdG8gYmUgdXNlZCBvbiB0aGUgZHJvcHNoYWRvdyBlLmcgJ3JlZCcsICcjMDBGRjAwJ1xuICAgICAqXG4gICAgICogQG1lbWJlciB7c3RyaW5nfG51bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgZHJvcFNoYWRvd0NvbG9yKCk6IG51bWJlciB8IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Ryb3BTaGFkb3dDb2xvcjtcbiAgICB9XG4gICAgc2V0IGRyb3BTaGFkb3dDb2xvcihkcm9wU2hhZG93Q29sb3I6IG51bWJlciB8IHN0cmluZylcbiAgICB7XG4gICAgICAgIGNvbnN0IG91dHB1dENvbG9yID0gZ2V0Q29sb3IoZHJvcFNoYWRvd0NvbG9yKTtcbiAgICAgICAgaWYgKHRoaXMuX2Ryb3BTaGFkb3dDb2xvciAhPT0gb3V0cHV0Q29sb3IpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2Ryb3BTaGFkb3dDb2xvciA9IG91dHB1dENvbG9yO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgYSBkaXN0YW5jZSBvZiB0aGUgZHJvcCBzaGFkb3dcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgZHJvcFNoYWRvd0Rpc3RhbmNlKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Ryb3BTaGFkb3dEaXN0YW5jZTtcbiAgICB9XG4gICAgc2V0IGRyb3BTaGFkb3dEaXN0YW5jZShkcm9wU2hhZG93RGlzdGFuY2U6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9kcm9wU2hhZG93RGlzdGFuY2UgIT09IGRyb3BTaGFkb3dEaXN0YW5jZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZHJvcFNoYWRvd0Rpc3RhbmNlID0gZHJvcFNoYWRvd0Rpc3RhbmNlO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGNhbnZhcyBmaWxsc3R5bGUgdGhhdCB3aWxsIGJlIHVzZWQgb24gdGhlIHRleHQgZS5nICdyZWQnLCAnIzAwRkYwMCcuXG4gICAgICogQ2FuIGJlIGFuIGFycmF5IHRvIGNyZWF0ZSBhIGdyYWRpZW50IGVnIFsnIzAwMDAwMCcsJyNGRkZGRkYnXVxuICAgICAqIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEL2ZpbGxTdHlsZXxNRE59XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd8c3RyaW5nW118bnVtYmVyfG51bWJlcltdfENhbnZhc0dyYWRpZW50fENhbnZhc1BhdHRlcm59XG4gICAgICovXG4gICAgZ2V0IGZpbGwoKTogVGV4dFN0eWxlRmlsbFxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGw7XG4gICAgfVxuICAgIHNldCBmaWxsKGZpbGw6IFRleHRTdHlsZUZpbGwpXG4gICAge1xuICAgICAgICAvLyBUT0RPOiBDYW4ndCBoYXZlIGRpZmZlcmVudCB0eXBlcyBmb3IgZ2V0dGVyIGFuZCBzZXR0ZXIuIFRoZSBnZXR0ZXIgc2hvdWxkbid0IGhhdmUgdGhlIG51bWJlciB0eXBlIGFzXG4gICAgICAgIC8vICAgICAgIHRoZSBzZXR0ZXIgY29udmVydHMgdG8gc3RyaW5nLiBTZWUgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZGV0YWlsczpcbiAgICAgICAgLy8gICAgICAgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8yNTIxXG4gICAgICAgIC8vIFRPRE86IE5vdCBzdXJlIGlmIGdldENvbG9yIHdvcmtzIHByb3Blcmx5IHdpdGggQ2FudmFzR3JhZGllbnQgYW5kL29yIENhbnZhc1BhdHRlcm4sIGNhbid0IHBhc3MgaW5cbiAgICAgICAgLy8gICAgICAgd2l0aG91dCBjYXN0aW5nIGhlcmUuXG4gICAgICAgIGNvbnN0IG91dHB1dENvbG9yID0gZ2V0Q29sb3IoZmlsbCBhcyBhbnkpO1xuICAgICAgICBpZiAodGhpcy5fZmlsbCAhPT0gb3V0cHV0Q29sb3IpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbGwgPSBvdXRwdXRDb2xvcjtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgZmlsbCBpcyBhbiBhcnJheSBvZiBjb2xvdXJzIHRvIGNyZWF0ZSBhIGdyYWRpZW50LCB0aGlzIGNhbiBjaGFuZ2UgdGhlIHR5cGUvZGlyZWN0aW9uIG9mIHRoZSBncmFkaWVudC5cbiAgICAgKiBTZWUge0BsaW5rIFBJWEkuVEVYVF9HUkFESUVOVH1cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgZmlsbEdyYWRpZW50VHlwZSgpOiBURVhUX0dSQURJRU5UXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlsbEdyYWRpZW50VHlwZTtcbiAgICB9XG4gICAgc2V0IGZpbGxHcmFkaWVudFR5cGUoZmlsbEdyYWRpZW50VHlwZTogVEVYVF9HUkFESUVOVClcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9maWxsR3JhZGllbnRUeXBlICE9PSBmaWxsR3JhZGllbnRUeXBlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9maWxsR3JhZGllbnRUeXBlID0gZmlsbEdyYWRpZW50VHlwZTtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgZmlsbCBpcyBhbiBhcnJheSBvZiBjb2xvdXJzIHRvIGNyZWF0ZSBhIGdyYWRpZW50LCB0aGlzIGFycmF5IGNhbiBzZXQgdGhlIHN0b3AgcG9pbnRzXG4gICAgICogKG51bWJlcnMgYmV0d2VlbiAwIGFuZCAxKSBmb3IgdGhlIGNvbG9yLCBvdmVycmlkaW5nIHRoZSBkZWZhdWx0IGJlaGF2aW91ciBvZiBldmVubHkgc3BhY2luZyB0aGVtLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyW119XG4gICAgICovXG4gICAgZ2V0IGZpbGxHcmFkaWVudFN0b3BzKCk6IG51bWJlcltdXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlsbEdyYWRpZW50U3RvcHM7XG4gICAgfVxuICAgIHNldCBmaWxsR3JhZGllbnRTdG9wcyhmaWxsR3JhZGllbnRTdG9wczogbnVtYmVyW10pXG4gICAge1xuICAgICAgICBpZiAoIWFyZUFycmF5c0VxdWFsKHRoaXMuX2ZpbGxHcmFkaWVudFN0b3BzLGZpbGxHcmFkaWVudFN0b3BzKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZmlsbEdyYWRpZW50U3RvcHMgPSBmaWxsR3JhZGllbnRTdG9wcztcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGZvbnQgZmFtaWx5XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd8c3RyaW5nW119XG4gICAgICovXG4gICAgZ2V0IGZvbnRGYW1pbHkoKTogc3RyaW5nIHwgc3RyaW5nW11cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb250RmFtaWx5O1xuICAgIH1cbiAgICBzZXQgZm9udEZhbWlseShmb250RmFtaWx5OiBzdHJpbmcgfCBzdHJpbmdbXSlcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmZvbnRGYW1pbHkgIT09IGZvbnRGYW1pbHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ZvbnRGYW1pbHkgPSBmb250RmFtaWx5O1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZm9udCBzaXplXG4gICAgICogKGFzIGEgbnVtYmVyIGl0IGNvbnZlcnRzIHRvIHB4LCBidXQgYXMgYSBzdHJpbmcsIGVxdWl2YWxlbnRzIGFyZSAnMjZweCcsJzIwcHQnLCcxNjAlJyBvciAnMS42ZW0nKVxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfHN0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgZm9udFNpemUoKTogbnVtYmVyIHwgc3RyaW5nXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9udFNpemU7XG4gICAgfVxuICAgIHNldCBmb250U2l6ZShmb250U2l6ZTogbnVtYmVyIHwgc3RyaW5nKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2ZvbnRTaXplICE9PSBmb250U2l6ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZm9udFNpemUgPSBmb250U2l6ZTtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGZvbnQgc3R5bGVcbiAgICAgKiAoJ25vcm1hbCcsICdpdGFsaWMnIG9yICdvYmxpcXVlJylcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgZm9udFN0eWxlKCk6IFRleHRTdHlsZUZvbnRTdHlsZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvbnRTdHlsZTtcbiAgICB9XG4gICAgc2V0IGZvbnRTdHlsZShmb250U3R5bGU6IFRleHRTdHlsZUZvbnRTdHlsZSlcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9mb250U3R5bGUgIT09IGZvbnRTdHlsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fZm9udFN0eWxlID0gZm9udFN0eWxlO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZm9udCB2YXJpYW50XG4gICAgICogKCdub3JtYWwnIG9yICdzbWFsbC1jYXBzJylcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgZm9udFZhcmlhbnQoKTogVGV4dFN0eWxlRm9udFZhcmlhbnRcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb250VmFyaWFudDtcbiAgICB9XG4gICAgc2V0IGZvbnRWYXJpYW50KGZvbnRWYXJpYW50OiBUZXh0U3R5bGVGb250VmFyaWFudClcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9mb250VmFyaWFudCAhPT0gZm9udFZhcmlhbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ZvbnRWYXJpYW50ID0gZm9udFZhcmlhbnQ7XG4gICAgICAgICAgICB0aGlzLnN0eWxlSUQrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBmb250IHdlaWdodFxuICAgICAqICgnbm9ybWFsJywgJ2JvbGQnLCAnYm9sZGVyJywgJ2xpZ2h0ZXInIGFuZCAnMTAwJywgJzIwMCcsICczMDAnLCAnNDAwJywgJzUwMCcsICc2MDAnLCAnNzAwJywgODAwJyBvciAnOTAwJylcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgZm9udFdlaWdodCgpOiBUZXh0U3R5bGVGb250V2VpZ2h0XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9udFdlaWdodDtcbiAgICB9XG4gICAgc2V0IGZvbnRXZWlnaHQoZm9udFdlaWdodDogVGV4dFN0eWxlRm9udFdlaWdodClcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9mb250V2VpZ2h0ICE9PSBmb250V2VpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9mb250V2VpZ2h0ID0gZm9udFdlaWdodDtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGFtb3VudCBvZiBzcGFjaW5nIGJldHdlZW4gbGV0dGVycywgZGVmYXVsdCBpcyAwXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGxldHRlclNwYWNpbmcoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGV0dGVyU3BhY2luZztcbiAgICB9XG4gICAgc2V0IGxldHRlclNwYWNpbmcobGV0dGVyU3BhY2luZzogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2xldHRlclNwYWNpbmcgIT09IGxldHRlclNwYWNpbmcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2xldHRlclNwYWNpbmcgPSBsZXR0ZXJTcGFjaW5nO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbGluZSBoZWlnaHQsIGEgbnVtYmVyIHRoYXQgcmVwcmVzZW50cyB0aGUgdmVydGljYWwgc3BhY2UgdGhhdCBhIGxldHRlciB1c2VzXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGxpbmVIZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGluZUhlaWdodDtcbiAgICB9XG4gICAgc2V0IGxpbmVIZWlnaHQobGluZUhlaWdodDogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2xpbmVIZWlnaHQgIT09IGxpbmVIZWlnaHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2xpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc3BhY2UgYmV0d2VlbiBsaW5lc1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBsZWFkaW5nKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlYWRpbmc7XG4gICAgfVxuICAgIHNldCBsZWFkaW5nKGxlYWRpbmc6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9sZWFkaW5nICE9PSBsZWFkaW5nKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9sZWFkaW5nID0gbGVhZGluZztcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGxpbmVKb2luIHByb3BlcnR5IHNldHMgdGhlIHR5cGUgb2YgY29ybmVyIGNyZWF0ZWQsIGl0IGNhbiByZXNvbHZlIHNwaWtlZCB0ZXh0IGlzc3Vlcy5cbiAgICAgKiBEZWZhdWx0IGlzICdtaXRlcicgKGNyZWF0ZXMgYSBzaGFycCBjb3JuZXIpLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAqL1xuICAgIGdldCBsaW5lSm9pbigpOiBUZXh0U3R5bGVMaW5lSm9pblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpbmVKb2luO1xuICAgIH1cbiAgICBzZXQgbGluZUpvaW4obGluZUpvaW46IFRleHRTdHlsZUxpbmVKb2luKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2xpbmVKb2luICE9PSBsaW5lSm9pbilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fbGluZUpvaW4gPSBsaW5lSm9pbjtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIG1pdGVyIGxpbWl0IHRvIHVzZSB3aGVuIHVzaW5nIHRoZSAnbWl0ZXInIGxpbmVKb2luIG1vZGVcbiAgICAgKiBUaGlzIGNhbiByZWR1Y2Ugb3IgaW5jcmVhc2UgdGhlIHNwaWtpbmVzcyBvZiByZW5kZXJlZCB0ZXh0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBtaXRlckxpbWl0KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21pdGVyTGltaXQ7XG4gICAgfVxuICAgIHNldCBtaXRlckxpbWl0KG1pdGVyTGltaXQ6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9taXRlckxpbWl0ICE9PSBtaXRlckxpbWl0KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9taXRlckxpbWl0ID0gbWl0ZXJMaW1pdDtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT2NjYXNpb25hbGx5IHNvbWUgZm9udHMgYXJlIGNyb3BwZWQuIEFkZGluZyBzb21lIHBhZGRpbmcgd2lsbCBwcmV2ZW50IHRoaXMgZnJvbSBoYXBwZW5pbmdcbiAgICAgKiBieSBhZGRpbmcgcGFkZGluZyB0byBhbGwgc2lkZXMgb2YgdGhlIHRleHQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHBhZGRpbmcoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFkZGluZztcbiAgICB9XG4gICAgc2V0IHBhZGRpbmcocGFkZGluZzogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3BhZGRpbmcgIT09IHBhZGRpbmcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3BhZGRpbmcgPSBwYWRkaW5nO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGNhbnZhcyBmaWxsc3R5bGUgdGhhdCB3aWxsIGJlIHVzZWQgb24gdGhlIHRleHQgc3Ryb2tlXG4gICAgICogZS5nICdibHVlJywgJyNGQ0ZGMDAnXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd8bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBzdHJva2UoKTogc3RyaW5nIHwgbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3Ryb2tlO1xuICAgIH1cbiAgICBzZXQgc3Ryb2tlKHN0cm9rZTogc3RyaW5nIHwgbnVtYmVyKVxuICAgIHtcbiAgICAgICAgLy8gVE9ETzogQ2FuJ3QgaGF2ZSBkaWZmZXJlbnQgdHlwZXMgZm9yIGdldHRlciBhbmQgc2V0dGVyLiBUaGUgZ2V0dGVyIHNob3VsZG4ndCBoYXZlIHRoZSBudW1iZXIgdHlwZSBhc1xuICAgICAgICAvLyAgICAgICB0aGUgc2V0dGVyIGNvbnZlcnRzIHRvIHN0cmluZy4gU2VlIHRoaXMgdGhyZWFkIGZvciBtb3JlIGRldGFpbHM6XG4gICAgICAgIC8vICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMjUyMVxuICAgICAgICBjb25zdCBvdXRwdXRDb2xvciA9IGdldENvbG9yKHN0cm9rZSk7XG4gICAgICAgIGlmICh0aGlzLl9zdHJva2UgIT09IG91dHB1dENvbG9yKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9zdHJva2UgPSBvdXRwdXRDb2xvcjtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBudW1iZXIgdGhhdCByZXByZXNlbnRzIHRoZSB0aGlja25lc3Mgb2YgdGhlIHN0cm9rZS5cbiAgICAgKiBEZWZhdWx0IGlzIDAgKG5vIHN0cm9rZSlcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgc3Ryb2tlVGhpY2tuZXNzKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cm9rZVRoaWNrbmVzcztcbiAgICB9XG4gICAgc2V0IHN0cm9rZVRoaWNrbmVzcyhzdHJva2VUaGlja25lc3M6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9zdHJva2VUaGlja25lc3MgIT09IHN0cm9rZVRoaWNrbmVzcylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fc3Ryb2tlVGhpY2tuZXNzID0gc3Ryb2tlVGhpY2tuZXNzO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZWxpbmUgb2YgdGhlIHRleHQgdGhhdCBpcyByZW5kZXJlZC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgdGV4dEJhc2VsaW5lKCk6IFRleHRTdHlsZVRleHRCYXNlbGluZVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RleHRCYXNlbGluZTtcbiAgICB9XG4gICAgc2V0IHRleHRCYXNlbGluZSh0ZXh0QmFzZWxpbmU6IFRleHRTdHlsZVRleHRCYXNlbGluZSlcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl90ZXh0QmFzZWxpbmUgIT09IHRleHRCYXNlbGluZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fdGV4dEJhc2VsaW5lID0gdGV4dEJhc2VsaW5lO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmltIHRyYW5zcGFyZW50IGJvcmRlcnNcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICovXG4gICAgZ2V0IHRyaW0oKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyaW07XG4gICAgfVxuICAgIHNldCB0cmltKHRyaW06IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fdHJpbSAhPT0gdHJpbSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fdHJpbSA9IHRyaW07XG4gICAgICAgICAgICB0aGlzLnN0eWxlSUQrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhvdyBuZXdsaW5lcyBhbmQgc3BhY2VzIHNob3VsZCBiZSBoYW5kbGVkLlxuICAgICAqIERlZmF1bHQgaXMgJ3ByZScgKHByZXNlcnZlLCBwcmVzZXJ2ZSkuXG4gICAgICpcbiAgICAgKiAgdmFsdWUgICAgICAgfCBOZXcgbGluZXMgICAgIHwgICBTcGFjZXNcbiAgICAgKiAgLS0tICAgICAgICAgfCAtLS0gICAgICAgICAgIHwgICAtLS1cbiAgICAgKiAnbm9ybWFsJyAgICAgfCBDb2xsYXBzZSAgICAgIHwgICBDb2xsYXBzZVxuICAgICAqICdwcmUnICAgICAgICB8IFByZXNlcnZlICAgICAgfCAgIFByZXNlcnZlXG4gICAgICogJ3ByZS1saW5lJyAgIHwgUHJlc2VydmUgICAgICB8ICAgQ29sbGFwc2VcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgd2hpdGVTcGFjZSgpOiBUZXh0U3R5bGVXaGl0ZVNwYWNlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fd2hpdGVTcGFjZTtcbiAgICB9XG4gICAgc2V0IHdoaXRlU3BhY2Uod2hpdGVTcGFjZTogVGV4dFN0eWxlV2hpdGVTcGFjZSlcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl93aGl0ZVNwYWNlICE9PSB3aGl0ZVNwYWNlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl93aGl0ZVNwYWNlID0gd2hpdGVTcGFjZTtcbiAgICAgICAgICAgIHRoaXMuc3R5bGVJRCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGlmIHdvcmQgd3JhcCBzaG91bGQgYmUgdXNlZFxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgd29yZFdyYXAoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dvcmRXcmFwO1xuICAgIH1cbiAgICBzZXQgd29yZFdyYXAod29yZFdyYXA6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fd29yZFdyYXAgIT09IHdvcmRXcmFwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl93b3JkV3JhcCA9IHdvcmRXcmFwO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggYXQgd2hpY2ggdGV4dCB3aWxsIHdyYXAsIGl0IG5lZWRzIHdvcmRXcmFwIHRvIGJlIHNldCB0byB0cnVlXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHdvcmRXcmFwV2lkdGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fd29yZFdyYXBXaWR0aDtcbiAgICB9XG4gICAgc2V0IHdvcmRXcmFwV2lkdGgod29yZFdyYXBXaWR0aDogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX3dvcmRXcmFwV2lkdGggIT09IHdvcmRXcmFwV2lkdGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3dvcmRXcmFwV2lkdGggPSB3b3JkV3JhcFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5zdHlsZUlEKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgYSBmb250IHN0eWxlIHN0cmluZyB0byB1c2UgZm9yIGBUZXh0TWV0cmljcy5tZWFzdXJlRm9udCgpYC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge3N0cmluZ30gRm9udCBzdHlsZSBzdHJpbmcsIGZvciBwYXNzaW5nIHRvIGBUZXh0TWV0cmljcy5tZWFzdXJlRm9udCgpYFxuICAgICAqL1xuICAgIHB1YmxpYyB0b0ZvbnRTdHJpbmcoKTogc3RyaW5nXG4gICAge1xuICAgICAgICAvLyBidWlsZCBjYW52YXMgYXBpIGZvbnQgc2V0dGluZyBmcm9tIGluZGl2aWR1YWwgY29tcG9uZW50cy4gQ29udmVydCBhIG51bWVyaWMgdGhpcy5mb250U2l6ZSB0byBweFxuICAgICAgICBjb25zdCBmb250U2l6ZVN0cmluZyA9ICh0eXBlb2YgdGhpcy5mb250U2l6ZSA9PT0gJ251bWJlcicpID8gYCR7dGhpcy5mb250U2l6ZX1weGAgOiB0aGlzLmZvbnRTaXplO1xuXG4gICAgICAgIC8vIENsZWFuLXVwIGZvbnRGYW1pbHkgcHJvcGVydHkgYnkgcXVvdGluZyBlYWNoIGZvbnQgbmFtZVxuICAgICAgICAvLyB0aGlzIHdpbGwgc3VwcG9ydCBmb250IG5hbWVzIHdpdGggc3BhY2VzXG4gICAgICAgIGxldCBmb250RmFtaWxpZXM6IHN0cmluZ3xzdHJpbmdbXSA9IHRoaXMuZm9udEZhbWlseTtcblxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5mb250RmFtaWx5KSlcbiAgICAgICAge1xuICAgICAgICAgICAgZm9udEZhbWlsaWVzID0gdGhpcy5mb250RmFtaWx5LnNwbGl0KCcsJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gZm9udEZhbWlsaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBUcmltIGFueSBleHRyYSB3aGl0ZS1zcGFjZVxuICAgICAgICAgICAgbGV0IGZvbnRGYW1pbHkgPSBmb250RmFtaWxpZXNbaV0udHJpbSgpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBmb250IGFscmVhZHkgY29udGFpbnMgc3RyaW5nc1xuICAgICAgICAgICAgaWYgKCEoLyhbXFxcIlxcJ10pW15cXCdcXFwiXStcXDEvKS50ZXN0KGZvbnRGYW1pbHkpICYmIGdlbmVyaWNGb250RmFtaWxpZXMuaW5kZXhPZihmb250RmFtaWx5KSA8IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZm9udEZhbWlseSA9IGBcIiR7Zm9udEZhbWlseX1cImA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoZm9udEZhbWlsaWVzIGFzIHN0cmluZ1tdKVtpXSA9IGZvbnRGYW1pbHk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYCR7dGhpcy5mb250U3R5bGV9ICR7dGhpcy5mb250VmFyaWFudH0gJHt0aGlzLmZvbnRXZWlnaHR9ICR7Zm9udFNpemVTdHJpbmd9ICR7KGZvbnRGYW1pbGllcyBhcyBzdHJpbmdbXSkuam9pbignLCcpfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gY29udmVydCBoZXhhZGVjaW1hbCBjb2xvcnMgdG8gc3RyaW5ncywgYW5kIHNpbXBseSByZXR1cm4gdGhlIGNvbG9yIGlmIGl0J3MgYSBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBjb2xvclxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgY29sb3IgYXMgYSBzdHJpbmcuXG4gKi9cbmZ1bmN0aW9uIGdldFNpbmdsZUNvbG9yKGNvbG9yOiBzdHJpbmd8bnVtYmVyKTogc3RyaW5nXG57XG4gICAgaWYgKHR5cGVvZiBjb2xvciA9PT0gJ251bWJlcicpXG4gICAge1xuICAgICAgICByZXR1cm4gaGV4MnN0cmluZyhjb2xvcik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjb2xvciA9PT0gJ3N0cmluZycpXG4gICAge1xuICAgICAgICBpZiAoIGNvbG9yLmluZGV4T2YoJzB4JykgPT09IDAgKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb2xvciA9IGNvbG9yLnJlcGxhY2UoJzB4JywgJyMnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjb2xvcjtcbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNvbnZlcnQgaGV4YWRlY2ltYWwgY29sb3JzIHRvIHN0cmluZ3MsIGFuZCBzaW1wbHkgcmV0dXJuIHRoZSBjb2xvciBpZiBpdCdzIGEgc3RyaW5nLlxuICogVGhpcyB2ZXJzaW9uIGNhbiBhbHNvIGNvbnZlcnQgYXJyYXkgb2YgY29sb3JzXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfG51bWJlcltdfSBjb2xvclxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgY29sb3IgYXMgYSBzdHJpbmcuXG4gKi9cbmZ1bmN0aW9uIGdldENvbG9yKGNvbG9yOiAoc3RyaW5nfG51bWJlcilbXSk6IHN0cmluZ1tdO1xuZnVuY3Rpb24gZ2V0Q29sb3IoY29sb3I6IHN0cmluZ3xudW1iZXIpOiBzdHJpbmc7XG5mdW5jdGlvbiBnZXRDb2xvcihjb2xvcjogc3RyaW5nfG51bWJlcnwoc3RyaW5nfG51bWJlcilbXSk6IHN0cmluZ3xzdHJpbmdbXVxue1xuICAgIGlmICghQXJyYXkuaXNBcnJheShjb2xvcikpXG4gICAge1xuICAgICAgICByZXR1cm4gZ2V0U2luZ2xlQ29sb3IoY29sb3IpO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbG9yLmxlbmd0aDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb2xvcltpXSA9IGdldFNpbmdsZUNvbG9yKGNvbG9yW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb2xvciBhcyBzdHJpbmdbXTtcbiAgICB9XG59XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBjb252ZXJ0IGhleGFkZWNpbWFsIGNvbG9ycyB0byBzdHJpbmdzLCBhbmQgc2ltcGx5IHJldHVybiB0aGUgY29sb3IgaWYgaXQncyBhIHN0cmluZy5cbiAqIFRoaXMgdmVyc2lvbiBjYW4gYWxzbyBjb252ZXJ0IGFycmF5IG9mIGNvbG9yc1xuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7QXJyYXl9IGFycmF5MSAtIEZpcnN0IGFycmF5IHRvIGNvbXBhcmVcbiAqIEBwYXJhbSB7QXJyYXl9IGFycmF5MiAtIFNlY29uZCBhcnJheSB0byBjb21wYXJlXG4gKiBAcmV0dXJuIHtib29sZWFufSBEbyB0aGUgYXJyYXlzIGNvbnRhaW4gdGhlIHNhbWUgdmFsdWVzIGluIHRoZSBzYW1lIG9yZGVyXG4gKi9cbmZ1bmN0aW9uIGFyZUFycmF5c0VxdWFsPFQ+KGFycmF5MTogVFtdLCBhcnJheTI6IFRbXSk6IGJvb2xlYW5cbntcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkxKSB8fCAhQXJyYXkuaXNBcnJheShhcnJheTIpKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChhcnJheTEubGVuZ3RoICE9PSBhcnJheTIubGVuZ3RoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkxLmxlbmd0aDsgKytpKVxuICAgIHtcbiAgICAgICAgaWYgKGFycmF5MVtpXSAhPT0gYXJyYXkyW2ldKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGVuc3VyZSB0aGF0IG9iamVjdCBwcm9wZXJ0aWVzIGFyZSBjb3BpZWQgYnkgdmFsdWUsIGFuZCBub3QgYnkgcmVmZXJlbmNlXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IHRhcmdldCAtIFRhcmdldCBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVzIGludG9cbiAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgLSBTb3VyY2Ugb2JqZWN0IGZvciB0aGUgcHJvcGVydGllcyB0byBjb3B5XG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlPYmogLSBPYmplY3QgY29udGFpbmluZyBwcm9wZXJ0aWVzIG5hbWVzIHdlIHdhbnQgdG8gbG9vcCBvdmVyXG4gKi9cbmZ1bmN0aW9uIGRlZXBDb3B5UHJvcGVydGllcyh0YXJnZXQ6IFJlY29yZDxzdHJpbmcsIGFueT4sIHNvdXJjZTogUmVjb3JkPHN0cmluZywgYW55PiwgcHJvcGVydHlPYmo6IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHByb3AgaW4gcHJvcGVydHlPYmopIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlW3Byb3BdKSkge1xuICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdLnNsaWNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVGV4dFN0eWxlLCBUZXh0U3R5bGVXaGl0ZVNwYWNlIH0gZnJvbSAnLi9UZXh0U3R5bGUnO1xuXG5pbnRlcmZhY2UgSUZvbnRNZXRyaWNzIHtcbiAgICBhc2NlbnQ6IG51bWJlcjtcbiAgICBkZXNjZW50OiBudW1iZXI7XG4gICAgZm9udFNpemU6IG51bWJlcjtcbn1cblxudHlwZSBDaGFyYWN0ZXJXaWR0aENhY2hlID0geyBba2V5OiBzdHJpbmddOiBudW1iZXIgfTtcblxuLyoqXG4gKiBUaGUgVGV4dE1ldHJpY3Mgb2JqZWN0IHJlcHJlc2VudHMgdGhlIG1lYXN1cmVtZW50IG9mIGEgYmxvY2sgb2YgdGV4dCB3aXRoIGEgc3BlY2lmaWVkIHN0eWxlLlxuICpcbiAqIGBgYGpzXG4gKiBsZXQgc3R5bGUgPSBuZXcgUElYSS5UZXh0U3R5bGUoe2ZvbnRGYW1pbHkgOiAnQXJpYWwnLCBmb250U2l6ZTogMjQsIGZpbGwgOiAweGZmMTAxMCwgYWxpZ24gOiAnY2VudGVyJ30pXG4gKiBsZXQgdGV4dE1ldHJpY3MgPSBQSVhJLlRleHRNZXRyaWNzLm1lYXN1cmVUZXh0KCdZb3VyIHRleHQnLCBzdHlsZSlcbiAqIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFRleHRNZXRyaWNzXG57XG4gICAgcHVibGljIHRleHQ6IHN0cmluZztcbiAgICBwdWJsaWMgc3R5bGU6IFRleHRTdHlsZTtcbiAgICBwdWJsaWMgd2lkdGg6IG51bWJlcjtcbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIGxpbmVzOiBzdHJpbmdbXTtcbiAgICBwdWJsaWMgbGluZVdpZHRoczogbnVtYmVyW107XG4gICAgcHVibGljIGxpbmVIZWlnaHQ6IG51bWJlcjtcbiAgICBwdWJsaWMgbWF4TGluZVdpZHRoOiBudW1iZXI7XG4gICAgcHVibGljIGZvbnRQcm9wZXJ0aWVzOiBJRm9udE1ldHJpY3M7XG5cbiAgICBwdWJsaWMgc3RhdGljIE1FVFJJQ1NfU1RSSU5HOiBzdHJpbmc7XG4gICAgcHVibGljIHN0YXRpYyBCQVNFTElORV9TWU1CT0w6IHN0cmluZztcbiAgICBwdWJsaWMgc3RhdGljIEJBU0VMSU5FX01VTFRJUExJRVI6IG51bWJlcjtcblxuICAgIC8vIFRPRE86IFRoZXNlIHNob3VsZCBiZSBwcm90ZWN0ZWQgYnV0IHRoZXkncmUgaW5pdGlhbGl6ZWQgb3V0c2lkZSBvZiB0aGUgY2xhc3MuXG4gICAgcHVibGljIHN0YXRpYyBfY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudHxPZmZzY3JlZW5DYW52YXM7XG4gICAgcHVibGljIHN0YXRpYyBfY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfE9mZnNjcmVlbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgICBwdWJsaWMgc3RhdGljIF9mb250czogeyBbZm9udDogc3RyaW5nXTogSUZvbnRNZXRyaWNzIH07XG4gICAgcHVibGljIHN0YXRpYyBfbmV3bGluZXM6IG51bWJlcltdO1xuICAgIHB1YmxpYyBzdGF0aWMgX2JyZWFraW5nU3BhY2VzOiBudW1iZXJbXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gdGhlIHRleHQgdGhhdCB3YXMgbWVhc3VyZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dFN0eWxlfSBzdHlsZSAtIHRoZSBzdHlsZSB0aGF0IHdhcyBtZWFzdXJlZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCAtIHRoZSBtZWFzdXJlZCB3aWR0aCBvZiB0aGUgdGV4dFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgLSB0aGUgbWVhc3VyZWQgaGVpZ2h0IG9mIHRoZSB0ZXh0XG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gbGluZXMgLSBhbiBhcnJheSBvZiB0aGUgbGluZXMgb2YgdGV4dCBicm9rZW4gYnkgbmV3IGxpbmVzIGFuZCB3cmFwcGluZyBpZiBzcGVjaWZpZWQgaW4gc3R5bGVcbiAgICAgKiBAcGFyYW0ge251bWJlcltdfSBsaW5lV2lkdGhzIC0gYW4gYXJyYXkgb2YgdGhlIGxpbmUgd2lkdGhzIGZvciBlYWNoIGxpbmUgbWF0Y2hlZCB0byBgbGluZXNgXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxpbmVIZWlnaHQgLSB0aGUgbWVhc3VyZWQgbGluZSBoZWlnaHQgZm9yIHRoaXMgc3R5bGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbWF4TGluZVdpZHRoIC0gdGhlIG1heGltdW0gbGluZSB3aWR0aCBmb3IgYWxsIG1lYXN1cmVkIGxpbmVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGZvbnRQcm9wZXJ0aWVzIC0gdGhlIGZvbnQgcHJvcGVydGllcyBvYmplY3QgZnJvbSBUZXh0TWV0cmljcy5tZWFzdXJlRm9udFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRleHQ6IHN0cmluZywgc3R5bGU6IFRleHRTdHlsZSwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIGxpbmVzOiBzdHJpbmdbXSwgbGluZVdpZHRoczogbnVtYmVyW10sXG4gICAgICAgIGxpbmVIZWlnaHQ6IG51bWJlciwgbWF4TGluZVdpZHRoOiBudW1iZXIsIGZvbnRQcm9wZXJ0aWVzOiBJRm9udE1ldHJpY3MpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRleHQgdGhhdCB3YXMgbWVhc3VyZWRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHN0eWxlIHRoYXQgd2FzIG1lYXN1cmVkXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dFN0eWxlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdHlsZSA9IHN0eWxlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWVhc3VyZWQgd2lkdGggb2YgdGhlIHRleHRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWVhc3VyZWQgaGVpZ2h0IG9mIHRoZSB0ZXh0XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBhcnJheSBvZiBsaW5lcyBvZiB0aGUgdGV4dCBicm9rZW4gYnkgbmV3IGxpbmVzIGFuZCB3cmFwcGluZyBpcyBzcGVjaWZpZWQgaW4gc3R5bGVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nW119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxpbmVzID0gbGluZXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGFycmF5IG9mIHRoZSBsaW5lIHdpZHRocyBmb3IgZWFjaCBsaW5lIG1hdGNoZWQgdG8gYGxpbmVzYFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGluZVdpZHRocyA9IGxpbmVXaWR0aHM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtZWFzdXJlZCBsaW5lIGhlaWdodCBmb3IgdGhpcyBzdHlsZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWF4aW11bSBsaW5lIHdpZHRoIGZvciBhbGwgbWVhc3VyZWQgbGluZXNcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXhMaW5lV2lkdGggPSBtYXhMaW5lV2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBmb250IHByb3BlcnRpZXMgb2JqZWN0IGZyb20gVGV4dE1ldHJpY3MubWVhc3VyZUZvbnRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5JRm9udE1ldHJpY3N9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvbnRQcm9wZXJ0aWVzID0gZm9udFByb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWVhc3VyZXMgdGhlIHN1cHBsaWVkIHN0cmluZyBvZiB0ZXh0IGFuZCByZXR1cm5zIGEgUmVjdGFuZ2xlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSB0aGUgdGV4dCB0byBtZWFzdXJlLlxuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0U3R5bGV9IHN0eWxlIC0gdGhlIHRleHQgc3R5bGUgdG8gdXNlIGZvciBtZWFzdXJpbmdcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFt3b3JkV3JhcF0gLSBvcHRpb25hbCBvdmVycmlkZSBmb3IgaWYgd29yZC13cmFwIHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSB0ZXh0LlxuICAgICAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IFtjYW52YXNdIC0gb3B0aW9uYWwgc3BlY2lmaWNhdGlvbiBvZiB0aGUgY2FudmFzIHRvIHVzZSBmb3IgbWVhc3VyaW5nLlxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dE1ldHJpY3N9IG1lYXN1cmVkIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIHRleHQuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBtZWFzdXJlVGV4dCh0ZXh0OiBzdHJpbmcsIHN0eWxlOiBUZXh0U3R5bGUsIHdvcmRXcmFwOiBib29sZWFuLCBjYW52YXMgPSBUZXh0TWV0cmljcy5fY2FudmFzKTogVGV4dE1ldHJpY3NcbiAgICB7XG4gICAgICAgIHdvcmRXcmFwID0gKHdvcmRXcmFwID09PSB1bmRlZmluZWQgfHwgd29yZFdyYXAgPT09IG51bGwpID8gc3R5bGUud29yZFdyYXAgOiB3b3JkV3JhcDtcbiAgICAgICAgY29uc3QgZm9udCA9IHN0eWxlLnRvRm9udFN0cmluZygpO1xuICAgICAgICBjb25zdCBmb250UHJvcGVydGllcyA9IFRleHRNZXRyaWNzLm1lYXN1cmVGb250KGZvbnQpO1xuXG4gICAgICAgIC8vIGZhbGxiYWNrIGluIGNhc2UgVUEgZGlzYWxsb3cgY2FudmFzIGRhdGEgZXh0cmFjdGlvblxuICAgICAgICAvLyAodG9EYXRhVVJJLCBnZXRJbWFnZURhdGEgZnVuY3Rpb25zKVxuICAgICAgICBpZiAoZm9udFByb3BlcnRpZXMuZm9udFNpemUgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvbnRQcm9wZXJ0aWVzLmZvbnRTaXplID0gc3R5bGUuZm9udFNpemUgYXMgbnVtYmVyO1xuICAgICAgICAgICAgZm9udFByb3BlcnRpZXMuYXNjZW50ID0gc3R5bGUuZm9udFNpemUgYXMgbnVtYmVyO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgIGNvbnRleHQuZm9udCA9IGZvbnQ7XG5cbiAgICAgICAgY29uc3Qgb3V0cHV0VGV4dCA9IHdvcmRXcmFwID8gVGV4dE1ldHJpY3Mud29yZFdyYXAodGV4dCwgc3R5bGUsIGNhbnZhcykgOiB0ZXh0O1xuICAgICAgICBjb25zdCBsaW5lcyA9IG91dHB1dFRleHQuc3BsaXQoLyg/OlxcclxcbnxcXHJ8XFxuKS8pO1xuICAgICAgICBjb25zdCBsaW5lV2lkdGhzID0gbmV3IEFycmF5PG51bWJlcj4obGluZXMubGVuZ3RoKTtcbiAgICAgICAgbGV0IG1heExpbmVXaWR0aCA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbGluZVdpZHRoID0gY29udGV4dC5tZWFzdXJlVGV4dChsaW5lc1tpXSkud2lkdGggKyAoKGxpbmVzW2ldLmxlbmd0aCAtIDEpICogc3R5bGUubGV0dGVyU3BhY2luZyk7XG5cbiAgICAgICAgICAgIGxpbmVXaWR0aHNbaV0gPSBsaW5lV2lkdGg7XG4gICAgICAgICAgICBtYXhMaW5lV2lkdGggPSBNYXRoLm1heChtYXhMaW5lV2lkdGgsIGxpbmVXaWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHdpZHRoID0gbWF4TGluZVdpZHRoICsgc3R5bGUuc3Ryb2tlVGhpY2tuZXNzO1xuXG4gICAgICAgIGlmIChzdHlsZS5kcm9wU2hhZG93KVxuICAgICAgICB7XG4gICAgICAgICAgICB3aWR0aCArPSBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gc3R5bGUubGluZUhlaWdodCB8fCBmb250UHJvcGVydGllcy5mb250U2l6ZSArIHN0eWxlLnN0cm9rZVRoaWNrbmVzcztcbiAgICAgICAgbGV0IGhlaWdodCA9IE1hdGgubWF4KGxpbmVIZWlnaHQsIGZvbnRQcm9wZXJ0aWVzLmZvbnRTaXplICsgc3R5bGUuc3Ryb2tlVGhpY2tuZXNzKVxuICAgICAgICAgICAgKyAoKGxpbmVzLmxlbmd0aCAtIDEpICogKGxpbmVIZWlnaHQgKyBzdHlsZS5sZWFkaW5nKSk7XG5cbiAgICAgICAgaWYgKHN0eWxlLmRyb3BTaGFkb3cpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGhlaWdodCArPSBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFRleHRNZXRyaWNzKFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIHN0eWxlLFxuICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQsXG4gICAgICAgICAgICBsaW5lcyxcbiAgICAgICAgICAgIGxpbmVXaWR0aHMsXG4gICAgICAgICAgICBsaW5lSGVpZ2h0ICsgc3R5bGUubGVhZGluZyxcbiAgICAgICAgICAgIG1heExpbmVXaWR0aCxcbiAgICAgICAgICAgIGZvbnRQcm9wZXJ0aWVzXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBuZXdsaW5lcyB0byBhIHN0cmluZyB0byBoYXZlIGl0IG9wdGltYWxseSBmaXQgaW50byB0aGUgaG9yaXpvbnRhbFxuICAgICAqIGJvdW5kcyBzZXQgYnkgdGhlIFRleHQgb2JqZWN0J3Mgd29yZFdyYXBXaWR0aCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBTdHJpbmcgdG8gYXBwbHkgd29yZCB3cmFwcGluZyB0b1xuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0U3R5bGV9IHN0eWxlIC0gdGhlIHN0eWxlIHRvIHVzZSB3aGVuIHdyYXBwaW5nXG4gICAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gW2NhbnZhc10gLSBvcHRpb25hbCBzcGVjaWZpY2F0aW9uIG9mIHRoZSBjYW52YXMgdG8gdXNlIGZvciBtZWFzdXJpbmcuXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBOZXcgc3RyaW5nIHdpdGggbmV3IGxpbmVzIGFwcGxpZWQgd2hlcmUgcmVxdWlyZWRcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXRpYyB3b3JkV3JhcCh0ZXh0OiBzdHJpbmcsIHN0eWxlOiBUZXh0U3R5bGUsIGNhbnZhcyA9IFRleHRNZXRyaWNzLl9jYW52YXMpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICBsZXQgd2lkdGggPSAwO1xuICAgICAgICBsZXQgbGluZSA9ICcnO1xuICAgICAgICBsZXQgbGluZXMgPSAnJztcblxuICAgICAgICBjb25zdCBjYWNoZTogQ2hhcmFjdGVyV2lkdGhDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIGNvbnN0IHsgbGV0dGVyU3BhY2luZywgd2hpdGVTcGFjZSB9ID0gc3R5bGU7XG5cbiAgICAgICAgLy8gSG93IHRvIGhhbmRsZSB3aGl0ZXNwYWNlc1xuICAgICAgICBjb25zdCBjb2xsYXBzZVNwYWNlcyA9IFRleHRNZXRyaWNzLmNvbGxhcHNlU3BhY2VzKHdoaXRlU3BhY2UpO1xuICAgICAgICBjb25zdCBjb2xsYXBzZU5ld2xpbmVzID0gVGV4dE1ldHJpY3MuY29sbGFwc2VOZXdsaW5lcyh3aGl0ZVNwYWNlKTtcblxuICAgICAgICAvLyB3aGV0aGVyIG9yIG5vdCBzcGFjZXMgbWF5IGJlIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgbGluZXNcbiAgICAgICAgbGV0IGNhblByZXBlbmRTcGFjZXMgPSAhY29sbGFwc2VTcGFjZXM7XG5cbiAgICAgICAgLy8gVGhlcmUgaXMgbGV0dGVyU3BhY2luZyBhZnRlciBldmVyeSBjaGFyIGV4Y2VwdCB0aGUgbGFzdCBvbmVcbiAgICAgICAgLy8gdF9oX2lfc18nICdfaV9zXycgJ19hX25fJyAnX2VfeF9hX21fcF9sX2VfJyAnXyFcbiAgICAgICAgLy8gc28gZm9yIGNvbnZlbmllbmNlIHRoZSBhYm92ZSBuZWVkcyB0byBiZSBjb21wYXJlZCB0byB3aWR0aCArIDEgZXh0cmEgbGV0dGVyU3BhY2VcbiAgICAgICAgLy8gdF9oX2lfc18nICdfaV9zXycgJ19hX25fJyAnX2VfeF9hX21fcF9sX2VfJyAnXyFfXG4gICAgICAgIC8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1xuICAgICAgICAvLyBBbmQgdGhlbiB0aGUgZmluYWwgc3BhY2UgaXMgc2ltcGx5IG5vIGFwcGVuZGVkIHRvIGVhY2ggbGluZVxuICAgICAgICBjb25zdCB3b3JkV3JhcFdpZHRoID0gc3R5bGUud29yZFdyYXBXaWR0aCArIGxldHRlclNwYWNpbmc7XG5cbiAgICAgICAgLy8gYnJlYWsgdGV4dCBpbnRvIHdvcmRzLCBzcGFjZXMgYW5kIG5ld2xpbmUgY2hhcnNcbiAgICAgICAgY29uc3QgdG9rZW5zID0gVGV4dE1ldHJpY3MudG9rZW5pemUodGV4dCk7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgd29yZCwgc3BhY2Ugb3IgbmV3bGluZUNoYXJcbiAgICAgICAgICAgIGxldCB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgICAgICAgLy8gaWYgd29yZCBpcyBhIG5ldyBsaW5lXG4gICAgICAgICAgICBpZiAoVGV4dE1ldHJpY3MuaXNOZXdsaW5lKHRva2VuKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBrZWVwIHRoZSBuZXcgbGluZVxuICAgICAgICAgICAgICAgIGlmICghY29sbGFwc2VOZXdsaW5lcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzICs9IFRleHRNZXRyaWNzLmFkZExpbmUobGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGNhblByZXBlbmRTcGFjZXMgPSAhY29sbGFwc2VTcGFjZXM7XG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAwO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBzaG91bGQgY29sbGFwc2UgbmV3IGxpbmVzXG4gICAgICAgICAgICAgICAgLy8gd2Ugc2ltcGx5IGNvbnZlcnQgaXQgaW50byBhIHNwYWNlXG4gICAgICAgICAgICAgICAgdG9rZW4gPSAnICc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGlmIHdlIHNob3VsZCBjb2xsYXBzZSByZXBlYXRlZCB3aGl0ZXNwYWNlc1xuICAgICAgICAgICAgaWYgKGNvbGxhcHNlU3BhY2VzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJvdGggdGhpcyBhbmQgdGhlIGxhc3QgdG9rZW5zIGZvciBzcGFjZXNcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJySXNCcmVha2luZ1NwYWNlID0gVGV4dE1ldHJpY3MuaXNCcmVha2luZ1NwYWNlKHRva2VuKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0SXNCcmVha2luZ1NwYWNlID0gVGV4dE1ldHJpY3MuaXNCcmVha2luZ1NwYWNlKGxpbmVbbGluZS5sZW5ndGggLSAxXSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycklzQnJlYWtpbmdTcGFjZSAmJiBsYXN0SXNCcmVha2luZ1NwYWNlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBnZXQgd29yZCB3aWR0aCBmcm9tIGNhY2hlIGlmIHBvc3NpYmxlXG4gICAgICAgICAgICBjb25zdCB0b2tlbldpZHRoID0gVGV4dE1ldHJpY3MuZ2V0RnJvbUNhY2hlKHRva2VuLCBsZXR0ZXJTcGFjaW5nLCBjYWNoZSwgY29udGV4dCk7XG5cbiAgICAgICAgICAgIC8vIHdvcmQgaXMgbG9uZ2VyIHRoYW4gZGVzaXJlZCBib3VuZHNcbiAgICAgICAgICAgIGlmICh0b2tlbldpZHRoID4gd29yZFdyYXBXaWR0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBhcmUgbm90IGFscmVhZHkgYXQgdGhlIGJlZ2lubmluZyBvZiBhIGxpbmVcbiAgICAgICAgICAgICAgICBpZiAobGluZSAhPT0gJycpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBuZXdsaW5lcyBmb3Igb3ZlcmZsb3cgd29yZHNcbiAgICAgICAgICAgICAgICAgICAgbGluZXMgKz0gVGV4dE1ldHJpY3MuYWRkTGluZShsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgbGluZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gYnJlYWsgbGFyZ2Ugd29yZCBvdmVyIG11bHRpcGxlIGxpbmVzXG4gICAgICAgICAgICAgICAgaWYgKFRleHRNZXRyaWNzLmNhbkJyZWFrV29yZHModG9rZW4sIHN0eWxlLmJyZWFrV29yZHMpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJlYWsgd29yZCBpbnRvIGNoYXJhY3RlcnNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhcmFjdGVycyA9IFRleHRNZXRyaWNzLndvcmRXcmFwU3BsaXQodG9rZW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvb3AgdGhlIGNoYXJhY3RlcnNcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjaGFyYWN0ZXJzLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2hhciA9IGNoYXJhY3RlcnNbal07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIGFyZSBub3QgYXQgdGhlIGVuZCBvZiB0aGUgdG9rZW5cblxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNoYXJhY3RlcnNbaiArIGtdKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRDaGFyID0gY2hhcmFjdGVyc1tqICsga107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGFzdENoYXIgPSBjaGFyW2NoYXIubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IHNwbGl0IGNoYXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFUZXh0TWV0cmljcy5jYW5CcmVha0NoYXJzKGxhc3RDaGFyLCBuZXh0Q2hhciwgdG9rZW4sIGosIHN0eWxlLmJyZWFrV29yZHMpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tYmluZSBjaGFycyAmIG1vdmUgZm9yd2FyZCBvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhciArPSBuZXh0Q2hhcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBqICs9IGNoYXIubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhcmFjdGVyV2lkdGggPSBUZXh0TWV0cmljcy5nZXRGcm9tQ2FjaGUoY2hhciwgbGV0dGVyU3BhY2luZywgY2FjaGUsIGNvbnRleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcmFjdGVyV2lkdGggKyB3aWR0aCA+IHdvcmRXcmFwV2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMgKz0gVGV4dE1ldHJpY3MuYWRkTGluZShsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5QcmVwZW5kU3BhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZSArPSBjaGFyO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gY2hhcmFjdGVyV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBydW4gd29yZCBvdXQgb2YgdGhlIGJvdW5kc1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSB3b3JkcyBpbiB0aGlzIGxpbmUgYWxyZWFkeVxuICAgICAgICAgICAgICAgICAgICAvLyBmaW5pc2ggdGhhdCBsaW5lIGFuZCBzdGFydCBhIG5ldyBvbmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMgKz0gVGV4dE1ldHJpY3MuYWRkTGluZShsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTGFzdFRva2VuID0gaSA9PT0gdG9rZW5zLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZ2l2ZSBpdCBpdHMgb3duIGxpbmUgaWYgaXQncyBub3QgdGhlIGVuZFxuICAgICAgICAgICAgICAgICAgICBsaW5lcyArPSBUZXh0TWV0cmljcy5hZGRMaW5lKHRva2VuLCAhaXNMYXN0VG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICBjYW5QcmVwZW5kU3BhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gd29yZCBjb3VsZCBmaXRcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyB3b3JkIHdvbid0IGZpdCBiZWNhdXNlIG9mIGV4aXN0aW5nIHdvcmRzXG4gICAgICAgICAgICAgICAgLy8gc3RhcnQgYSBuZXcgbGluZVxuICAgICAgICAgICAgICAgIGlmICh0b2tlbldpZHRoICsgd2lkdGggPiB3b3JkV3JhcFdpZHRoKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXRzIGEgc3BhY2Ugd2UgZG9uJ3Qgd2FudCBpdFxuICAgICAgICAgICAgICAgICAgICBjYW5QcmVwZW5kU3BhY2VzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGEgbmV3IGxpbmVcbiAgICAgICAgICAgICAgICAgICAgbGluZXMgKz0gVGV4dE1ldHJpY3MuYWRkTGluZShsaW5lKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBhIG5ldyBsaW5lXG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGRvbid0IGFkZCBzcGFjZXMgdG8gdGhlIGJlZ2lubmluZyBvZiBsaW5lc1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLmxlbmd0aCA+IDAgfHwgIVRleHRNZXRyaWNzLmlzQnJlYWtpbmdTcGFjZSh0b2tlbikgfHwgY2FuUHJlcGVuZFNwYWNlcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCB0aGUgd29yZCB0byB0aGUgY3VycmVudCBsaW5lXG4gICAgICAgICAgICAgICAgICAgIGxpbmUgKz0gdG9rZW47XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdpZHRoIGNvdW50ZXJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gdG9rZW5XaWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsaW5lcyArPSBUZXh0TWV0cmljcy5hZGRMaW5lKGxpbmUsIGZhbHNlKTtcblxuICAgICAgICByZXR1cm4gbGluZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmllbmllbmNlIGZ1bmN0aW9uIGZvciBsb2dnaW5nIGVhY2ggbGluZSBhZGRlZCBkdXJpbmcgdGhlIHdvcmRXcmFwXG4gICAgICogbWV0aG9kXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gICBsaW5lICAgICAgICAtIFRoZSBsaW5lIG9mIHRleHQgdG8gYWRkXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gIG5ld0xpbmUgICAgIC0gQWRkIG5ldyBsaW5lIGNoYXJhY3RlciB0byBlbmRcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9ICBBIGZvcm1hdHRlZCBsaW5lXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgYWRkTGluZShsaW5lOiBzdHJpbmcsIG5ld0xpbmUgPSB0cnVlKTogc3RyaW5nXG4gICAge1xuICAgICAgICBsaW5lID0gVGV4dE1ldHJpY3MudHJpbVJpZ2h0KGxpbmUpO1xuXG4gICAgICAgIGxpbmUgPSAobmV3TGluZSkgPyBgJHtsaW5lfVxcbmAgOiBsaW5lO1xuXG4gICAgICAgIHJldHVybiBsaW5lO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgJiBzZXRzIHRoZSB3aWR0aHMgb2YgY2FsY3VsYXRlZCBjaGFyYWN0ZXJzIGluIGEgY2FjaGUgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gICAgICAgICAgICAgICAgICAgIGtleSAgICAgICAgICAgIC0gVGhlIGtleVxuICAgICAqIEBwYXJhbSAge251bWJlcn0gICAgICAgICAgICAgICAgICAgIGxldHRlclNwYWNpbmcgIC0gVGhlIGxldHRlciBzcGFjaW5nXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSAgICAgICAgICAgICAgICAgICAgY2FjaGUgICAgICAgICAgLSBUaGUgY2FjaGVcbiAgICAgKiBAcGFyYW0gIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICBjb250ZXh0ICAgICAgICAtIFRoZSBjYW52YXMgY29udGV4dFxuICAgICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgICAgICAgICAgICAgIFRoZSBmcm9tIGNhY2hlLlxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIGdldEZyb21DYWNoZShrZXk6IHN0cmluZywgbGV0dGVyU3BhY2luZzogbnVtYmVyLCBjYWNoZTogQ2hhcmFjdGVyV2lkdGhDYWNoZSxcbiAgICAgICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfE9mZnNjcmVlbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgbGV0IHdpZHRoID0gY2FjaGVba2V5XTtcblxuICAgICAgICBpZiAodHlwZW9mIHdpZHRoICE9PSAnbnVtYmVyJylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3Qgc3BhY2luZyA9ICgoa2V5Lmxlbmd0aCkgKiBsZXR0ZXJTcGFjaW5nKTtcblxuICAgICAgICAgICAgd2lkdGggPSBjb250ZXh0Lm1lYXN1cmVUZXh0KGtleSkud2lkdGggKyBzcGFjaW5nO1xuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHdpZHRoO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHdpZHRoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgd2hldGhlciB3ZSBzaG91bGQgY29sbGFwc2UgYnJlYWtpbmcgc3BhY2VzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gICB3aGl0ZVNwYWNlIC0gVGhlIFRleHRTdHlsZSBwcm9wZXJ0eSB3aGl0ZVNwYWNlXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gIHNob3VsZCBjb2xsYXBzZVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIGNvbGxhcHNlU3BhY2VzKHdoaXRlU3BhY2U6IFRleHRTdHlsZVdoaXRlU3BhY2UpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gKHdoaXRlU3BhY2UgPT09ICdub3JtYWwnIHx8IHdoaXRlU3BhY2UgPT09ICdwcmUtbGluZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgd2hldGhlciB3ZSBzaG91bGQgY29sbGFwc2UgbmV3TGluZSBjaGFyc1xuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgd2hpdGVTcGFjZSAtIFRoZSB3aGl0ZSBzcGFjZVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59ICBzaG91bGQgY29sbGFwc2VcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXRpYyBjb2xsYXBzZU5ld2xpbmVzKHdoaXRlU3BhY2U6IFRleHRTdHlsZVdoaXRlU3BhY2UpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gKHdoaXRlU3BhY2UgPT09ICdub3JtYWwnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0cmltcyBicmVha2luZyB3aGl0ZXNwYWNlcyBmcm9tIHN0cmluZ1xuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICB0ZXh0IC0gVGhlIHRleHRcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9ICB0cmltbWVkIHN0cmluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIHRyaW1SaWdodCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSB0ZXh0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBjaGFyID0gdGV4dFtpXTtcblxuICAgICAgICAgICAgaWYgKCFUZXh0TWV0cmljcy5pc0JyZWFraW5nU3BhY2UoY2hhcikpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRleHQgPSB0ZXh0LnNsaWNlKDAsIC0xKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgaWYgY2hhciBpcyBhIG5ld2xpbmUuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gIGNoYXIgLSBUaGUgY2hhcmFjdGVyXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gIFRydWUgaWYgbmV3bGluZSwgRmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIGlzTmV3bGluZShjaGFyOiBzdHJpbmcpOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIGNoYXIgIT09ICdzdHJpbmcnKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFRleHRNZXRyaWNzLl9uZXdsaW5lcy5pbmRleE9mKGNoYXIuY2hhckNvZGVBdCgwKSkgPj0gMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyBpZiBjaGFyIGlzIGEgYnJlYWtpbmcgd2hpdGVzcGFjZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSAgY2hhciAtIFRoZSBjaGFyYWN0ZXJcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSAgVHJ1ZSBpZiB3aGl0ZXNwYWNlLCBGYWxzZSBvdGhlcndpc2UuXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgaXNCcmVha2luZ1NwYWNlKGNoYXI6IHN0cmluZyk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2YgY2hhciAhPT0gJ3N0cmluZycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoVGV4dE1ldHJpY3MuX2JyZWFraW5nU3BhY2VzLmluZGV4T2YoY2hhci5jaGFyQ29kZUF0KDApKSA+PSAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTcGxpdHMgYSBzdHJpbmcgaW50byB3b3JkcywgYnJlYWtpbmctc3BhY2VzIGFuZCBuZXdMaW5lIGNoYXJhY3RlcnNcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSAgdGV4dCAtIFRoZSB0ZXh0XG4gICAgICogQHJldHVybiB7c3RyaW5nW119ICBBIHRva2VuaXplZCBhcnJheVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIHRva2VuaXplKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdXG4gICAge1xuICAgICAgICBjb25zdCB0b2tlbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCB0b2tlbiA9ICcnO1xuXG4gICAgICAgIGlmICh0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0b2tlbnM7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSB0ZXh0W2ldO1xuXG4gICAgICAgICAgICBpZiAoVGV4dE1ldHJpY3MuaXNCcmVha2luZ1NwYWNlKGNoYXIpIHx8IFRleHRNZXRyaWNzLmlzTmV3bGluZShjaGFyKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodG9rZW4gIT09ICcnKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICB0b2tlbiA9ICcnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKGNoYXIpO1xuXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRva2VuICs9IGNoYXI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodG9rZW4gIT09ICcnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0b2tlbnMucHVzaCh0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdG9rZW5zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRhYmxlIGhlbHBlciBtZXRob2QgdXNlZCBpbnRlcm5hbGx5IGJ5IFRleHRNZXRyaWNzLCBleHBvc2VkIHRvIGFsbG93IGN1c3RvbWl6aW5nIHRoZSBjbGFzcydzIGJlaGF2aW9yLlxuICAgICAqXG4gICAgICogSXQgYWxsb3dzIG9uZSB0byBjdXN0b21pc2Ugd2hpY2ggd29yZHMgc2hvdWxkIGJyZWFrXG4gICAgICogRXhhbXBsZXMgYXJlIGlmIHRoZSB0b2tlbiBpcyBDSksgb3IgbnVtYmVycy5cbiAgICAgKiBJdCBtdXN0IHJldHVybiBhIGJvb2xlYW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICB0b2tlbiAgICAgICAtIFRoZSB0b2tlblxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59ICBicmVha1dvcmRzIC0gVGhlIHN0eWxlIGF0dHIgYnJlYWsgd29yZHNcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIHRvIGJyZWFrIHdvcmQgb3Igbm90XG4gICAgICovXG4gICAgc3RhdGljIGNhbkJyZWFrV29yZHMoX3Rva2VuOiBzdHJpbmcsIGJyZWFrV29yZHM6IGJvb2xlYW4pOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gYnJlYWtXb3JkcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdmVycmlkYWJsZSBoZWxwZXIgbWV0aG9kIHVzZWQgaW50ZXJuYWxseSBieSBUZXh0TWV0cmljcywgZXhwb3NlZCB0byBhbGxvdyBjdXN0b21pemluZyB0aGUgY2xhc3MncyBiZWhhdmlvci5cbiAgICAgKlxuICAgICAqIEl0IGFsbG93cyBvbmUgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBwYWlyIG9mIGNoYXJhY3RlcnNcbiAgICAgKiBzaG91bGQgYmUgYnJva2VuIGJ5IG5ld2xpbmVzXG4gICAgICogRm9yIGV4YW1wbGUgY2VydGFpbiBjaGFyYWN0ZXJzIGluIENKSyBsYW5ncyBvciBudW1iZXJzLlxuICAgICAqIEl0IG11c3QgcmV0dXJuIGEgYm9vbGVhbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gIGNoYXIgICAgICAgIC0gVGhlIGNoYXJhY3RlclxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gIG5leHRDaGFyICAgIC0gVGhlIG5leHQgY2hhcmFjdGVyXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSAgdG9rZW4gICAgICAgLSBUaGUgdG9rZW4vd29yZCB0aGUgY2hhcmFjdGVycyBhcmUgZnJvbVxuICAgICAqIEBwYXJhbSAge251bWJlcn0gIGluZGV4ICAgICAgIC0gVGhlIGluZGV4IGluIHRoZSB0b2tlbiBvZiB0aGUgY2hhclxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59ICBicmVha1dvcmRzIC0gVGhlIHN0eWxlIGF0dHIgYnJlYWsgd29yZHNcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB3aGV0aGVyIHRvIGJyZWFrIHdvcmQgb3Igbm90XG4gICAgICovXG4gICAgc3RhdGljIGNhbkJyZWFrQ2hhcnMoX2NoYXI6IHN0cmluZywgX25leHRDaGFyOiBzdHJpbmcsIF90b2tlbjogc3RyaW5nLCBfaW5kZXg6IG51bWJlcixcbiAgICAgICAgX2JyZWFrV29yZHM6IGJvb2xlYW4pOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdmVycmlkYWJsZSBoZWxwZXIgbWV0aG9kIHVzZWQgaW50ZXJuYWxseSBieSBUZXh0TWV0cmljcywgZXhwb3NlZCB0byBhbGxvdyBjdXN0b21pemluZyB0aGUgY2xhc3MncyBiZWhhdmlvci5cbiAgICAgKlxuICAgICAqIEl0IGlzIGNhbGxlZCB3aGVuIGEgdG9rZW4gKHVzdWFsbHkgYSB3b3JkKSBoYXMgdG8gYmUgc3BsaXQgaW50byBzZXBhcmF0ZSBwaWVjZXNcbiAgICAgKiBpbiBvcmRlciB0byBkZXRlcm1pbmUgdGhlIHBvaW50IHRvIGJyZWFrIGEgd29yZC5cbiAgICAgKiBJdCBtdXN0IHJldHVybiBhbiBhcnJheSBvZiBjaGFyYWN0ZXJzLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBDb3JyZWN0bHkgc3BsaXRzIGVtb2ppcywgZWcgXCJcdUQ4M0VcdUREMkFcdUQ4M0VcdUREMkFcIiB3aWxsIHJlc3VsdCBpbiB0d28gZWxlbWVudCBhcnJheSwgZWFjaCB3aXRoIG9uZSBlbW9qaS5cbiAgICAgKiBUZXh0TWV0cmljcy53b3JkV3JhcFNwbGl0ID0gKHRva2VuKSA9PiBbLi4udG9rZW5dO1xuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSAgdG9rZW4gLSBUaGUgdG9rZW4gdG8gc3BsaXRcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmdbXX0gVGhlIGNoYXJhY3RlcnMgb2YgdGhlIHRva2VuXG4gICAgICovXG4gICAgc3RhdGljIHdvcmRXcmFwU3BsaXQodG9rZW46IHN0cmluZyk6IHN0cmluZ1tdXG4gICAge1xuICAgICAgICByZXR1cm4gdG9rZW4uc3BsaXQoJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZXMgdGhlIGFzY2VudCwgZGVzY2VudCBhbmQgZm9udFNpemUgb2YgYSBnaXZlbiBmb250LXN0eWxlXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZvbnQgLSBTdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBzdHlsZSBvZiB0aGUgZm9udFxuICAgICAqIEByZXR1cm4ge1BJWEkuSUZvbnRNZXRyaWNzfSBGb250IHByb3BlcnRpZXMgb2JqZWN0XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBtZWFzdXJlRm9udChmb250OiBzdHJpbmcpOiBJRm9udE1ldHJpY3NcbiAgICB7XG4gICAgICAgIC8vIGFzIHRoaXMgbWV0aG9kIGlzIHVzZWQgZm9yIHByZXBhcmluZyBhc3NldHMsIGRvbid0IHJlY2FsY3VsYXRlIHRoaW5ncyBpZiB3ZSBkb24ndCBuZWVkIHRvXG4gICAgICAgIGlmIChUZXh0TWV0cmljcy5fZm9udHNbZm9udF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBUZXh0TWV0cmljcy5fZm9udHNbZm9udF07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzOiBJRm9udE1ldHJpY3MgPSB7XG4gICAgICAgICAgICBhc2NlbnQ6IDAsXG4gICAgICAgICAgICBkZXNjZW50OiAwLFxuICAgICAgICAgICAgZm9udFNpemU6IDAsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY2FudmFzID0gVGV4dE1ldHJpY3MuX2NhbnZhcztcbiAgICAgICAgY29uc3QgY29udGV4dCA9IFRleHRNZXRyaWNzLl9jb250ZXh0O1xuXG4gICAgICAgIGNvbnRleHQuZm9udCA9IGZvbnQ7XG5cbiAgICAgICAgY29uc3QgbWV0cmljc1N0cmluZyA9IFRleHRNZXRyaWNzLk1FVFJJQ1NfU1RSSU5HICsgVGV4dE1ldHJpY3MuQkFTRUxJTkVfU1lNQk9MO1xuICAgICAgICBjb25zdCB3aWR0aCA9IE1hdGguY2VpbChjb250ZXh0Lm1lYXN1cmVUZXh0KG1ldHJpY3NTdHJpbmcpLndpZHRoKTtcbiAgICAgICAgbGV0IGJhc2VsaW5lID0gTWF0aC5jZWlsKGNvbnRleHQubWVhc3VyZVRleHQoVGV4dE1ldHJpY3MuQkFTRUxJTkVfU1lNQk9MKS53aWR0aCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IDIgKiBiYXNlbGluZTtcblxuICAgICAgICBiYXNlbGluZSA9IGJhc2VsaW5lICogVGV4dE1ldHJpY3MuQkFTRUxJTkVfTVVMVElQTElFUiB8IDA7XG5cbiAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAnI2YwMCc7XG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgY29udGV4dC5mb250ID0gZm9udDtcblxuICAgICAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9ICdhbHBoYWJldGljJztcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAnIzAwMCc7XG4gICAgICAgIGNvbnRleHQuZmlsbFRleHQobWV0cmljc1N0cmluZywgMCwgYmFzZWxpbmUpO1xuXG4gICAgICAgIGNvbnN0IGltYWdlZGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIHdpZHRoLCBoZWlnaHQpLmRhdGE7XG4gICAgICAgIGNvbnN0IHBpeGVscyA9IGltYWdlZGF0YS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGxpbmUgPSB3aWR0aCAqIDQ7XG5cbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBsZXQgaWR4ID0gMDtcbiAgICAgICAgbGV0IHN0b3AgPSBmYWxzZTtcblxuICAgICAgICAvLyBhc2NlbnQuIHNjYW4gZnJvbSB0b3AgdG8gYm90dG9tIHVudGlsIHdlIGZpbmQgYSBub24gcmVkIHBpeGVsXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBiYXNlbGluZTsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxpbmU7IGogKz0gNClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoaW1hZ2VkYXRhW2lkeCArIGpdICE9PSAyNTUpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzdG9wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFzdG9wKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkeCArPSBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcHJvcGVydGllcy5hc2NlbnQgPSBiYXNlbGluZSAtIGk7XG5cbiAgICAgICAgaWR4ID0gcGl4ZWxzIC0gbGluZTtcbiAgICAgICAgc3RvcCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIGRlc2NlbnQuIHNjYW4gZnJvbSBib3R0b20gdG8gdG9wIHVudGlsIHdlIGZpbmQgYSBub24gcmVkIHBpeGVsXG4gICAgICAgIGZvciAoaSA9IGhlaWdodDsgaSA+IGJhc2VsaW5lOyAtLWkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGluZTsgaiArPSA0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChpbWFnZWRhdGFbaWR4ICsgal0gIT09IDI1NSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3AgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghc3RvcClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZHggLT0gbGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHByb3BlcnRpZXMuZGVzY2VudCA9IGkgLSBiYXNlbGluZTtcbiAgICAgICAgcHJvcGVydGllcy5mb250U2l6ZSA9IHByb3BlcnRpZXMuYXNjZW50ICsgcHJvcGVydGllcy5kZXNjZW50O1xuXG4gICAgICAgIFRleHRNZXRyaWNzLl9mb250c1tmb250XSA9IHByb3BlcnRpZXM7XG5cbiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgZm9udCBtZXRyaWNzIGluIG1ldHJpY3MgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtmb250XSAtIGZvbnQgbmFtZS4gSWYgZm9udCBuYW1lIG5vdCBzZXQgdGhlbiBjbGVhciBjYWNoZSBmb3IgYWxsIGZvbnRzLlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgY2xlYXJNZXRyaWNzKGZvbnQgPSAnJyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChmb250KVxuICAgICAgICB7XG4gICAgICAgICAgICBkZWxldGUgVGV4dE1ldHJpY3MuX2ZvbnRzW2ZvbnRdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgVGV4dE1ldHJpY3MuX2ZvbnRzID0ge307XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogSW50ZXJuYWwgcmV0dXJuIG9iamVjdCBmb3Ige0BsaW5rIFBJWEkuVGV4dE1ldHJpY3MubWVhc3VyZUZvbnQgYFRleHRNZXRyaWNzLm1lYXN1cmVGb250YH0uXG4gKlxuICogQHR5cGVkZWYge29iamVjdH0gRm9udE1ldHJpY3NcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBhc2NlbnQgLSBUaGUgYXNjZW50IGRpc3RhbmNlXG4gKiBAcHJvcGVydHkge251bWJlcn0gZGVzY2VudCAtIFRoZSBkZXNjZW50IGRpc3RhbmNlXG4gKiBAcHJvcGVydHkge251bWJlcn0gZm9udFNpemUgLSBGb250IHNpemUgZnJvbSBhc2NlbnQgdG8gZGVzY2VudFxuICogQG1lbWJlcm9mIFBJWEkuVGV4dE1ldHJpY3NcbiAqIEBwcml2YXRlXG4gKi9cblxuY29uc3QgY2FudmFzID0gKCgpOiBIVE1MQ2FudmFzRWxlbWVudHxPZmZzY3JlZW5DYW52YXMgPT5cbntcbiAgICB0cnlcbiAgICB7XG4gICAgICAgIC8vIE9mZnNjcmVlbkNhbnZhczJEIG1lYXN1cmVUZXh0IGNhbiBiZSB1cCB0byA0MCUgZmFzdGVyLlxuICAgICAgICBjb25zdCBjID0gbmV3IE9mZnNjcmVlbkNhbnZhcygwLCAwKTtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICBpZiAoY29udGV4dCAmJiBjb250ZXh0Lm1lYXN1cmVUZXh0KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICB9XG4gICAgY2F0Y2ggKGV4KVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIH1cbn0pKCk7XG5cbmNhbnZhcy53aWR0aCA9IGNhbnZhcy5oZWlnaHQgPSAxMDtcblxuLyoqXG4gKiBDYWNoZWQgY2FudmFzIGVsZW1lbnQgZm9yIG1lYXN1cmluZyB0ZXh0XG4gKlxuICogQG1lbWJlcm9mIFBJWEkuVGV4dE1ldHJpY3NcbiAqIEB0eXBlIHtIVE1MQ2FudmFzRWxlbWVudH1cbiAqIEBwcml2YXRlXG4gKi9cblRleHRNZXRyaWNzLl9jYW52YXMgPSBjYW52YXM7XG5cbi8qKlxuICogQ2FjaGUgZm9yIGNvbnRleHQgdG8gdXNlLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLlRleHRNZXRyaWNzXG4gKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfVxuICogQHByaXZhdGVcbiAqL1xuVGV4dE1ldHJpY3MuX2NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuLyoqXG4gKiBDYWNoZSBvZiB7QHNlZSBQSVhJLlRleHRNZXRyaWNzLkZvbnRNZXRyaWNzfSBvYmplY3RzLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLlRleHRNZXRyaWNzXG4gKiBAdHlwZSB7T2JqZWN0fVxuICogQHByaXZhdGVcbiAqL1xuVGV4dE1ldHJpY3MuX2ZvbnRzID0ge307XG5cbi8qKlxuICogU3RyaW5nIHVzZWQgZm9yIGNhbGN1bGF0ZSBmb250IG1ldHJpY3MuXG4gKiBUaGVzZSBjaGFyYWN0ZXJzIGFyZSBhbGwgdGFsbCB0byBoZWxwIGNhbGN1bGF0ZSB0aGUgaGVpZ2h0IHJlcXVpcmVkIGZvciB0ZXh0LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJvZiBQSVhJLlRleHRNZXRyaWNzXG4gKiBAbmFtZSBNRVRSSUNTX1NUUklOR1xuICogQHR5cGUge3N0cmluZ31cbiAqIEBkZWZhdWx0IHxcdTAwQzlxXHUwMEM1XG4gKi9cblRleHRNZXRyaWNzLk1FVFJJQ1NfU1RSSU5HID0gJ3xcdTAwQzlxXHUwMEM1JztcblxuLyoqXG4gKiBCYXNlbGluZSBzeW1ib2wgZm9yIGNhbGN1bGF0ZSBmb250IG1ldHJpY3MuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWEkuVGV4dE1ldHJpY3NcbiAqIEBuYW1lIEJBU0VMSU5FX1NZTUJPTFxuICogQHR5cGUge3N0cmluZ31cbiAqIEBkZWZhdWx0IE1cbiAqL1xuVGV4dE1ldHJpY3MuQkFTRUxJTkVfU1lNQk9MID0gJ00nO1xuXG4vKipcbiAqIEJhc2VsaW5lIG11bHRpcGxpZXIgZm9yIGNhbGN1bGF0ZSBmb250IG1ldHJpY3MuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWEkuVGV4dE1ldHJpY3NcbiAqIEBuYW1lIEJBU0VMSU5FX01VTFRJUExJRVJcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAZGVmYXVsdCAxLjRcbiAqL1xuVGV4dE1ldHJpY3MuQkFTRUxJTkVfTVVMVElQTElFUiA9IDEuNDtcblxuLyoqXG4gKiBDYWNoZSBvZiBuZXcgbGluZSBjaGFycy5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSS5UZXh0TWV0cmljc1xuICogQHR5cGUge251bWJlcltdfVxuICogQHByaXZhdGVcbiAqL1xuVGV4dE1ldHJpY3MuX25ld2xpbmVzID0gW1xuICAgIDB4MDAwQSwgLy8gbGluZSBmZWVkXG4gICAgMHgwMDBELCAvLyBjYXJyaWFnZSByZXR1cm5cbl07XG5cbi8qKlxuICogQ2FjaGUgb2YgYnJlYWtpbmcgc3BhY2VzLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLlRleHRNZXRyaWNzXG4gKiBAdHlwZSB7bnVtYmVyW119XG4gKiBAcHJpdmF0ZVxuICovXG5UZXh0TWV0cmljcy5fYnJlYWtpbmdTcGFjZXMgPSBbXG4gICAgMHgwMDA5LCAvLyBjaGFyYWN0ZXIgdGFidWxhdGlvblxuICAgIDB4MDAyMCwgLy8gc3BhY2VcbiAgICAweDIwMDAsIC8vIGVuIHF1YWRcbiAgICAweDIwMDEsIC8vIGVtIHF1YWRcbiAgICAweDIwMDIsIC8vIGVuIHNwYWNlXG4gICAgMHgyMDAzLCAvLyBlbSBzcGFjZVxuICAgIDB4MjAwNCwgLy8gdGhyZWUtcGVyLWVtIHNwYWNlXG4gICAgMHgyMDA1LCAvLyBmb3VyLXBlci1lbSBzcGFjZVxuICAgIDB4MjAwNiwgLy8gc2l4LXBlci1lbSBzcGFjZVxuICAgIDB4MjAwOCwgLy8gcHVuY3R1YXRpb24gc3BhY2VcbiAgICAweDIwMDksIC8vIHRoaW4gc3BhY2VcbiAgICAweDIwMEEsIC8vIGhhaXIgc3BhY2VcbiAgICAweDIwNUYsIC8vIG1lZGl1bSBtYXRoZW1hdGljYWwgc3BhY2VcbiAgICAweDMwMDAsIC8vIGlkZW9ncmFwaGljIHNwYWNlXG5dO1xuXG4vKipcbiAqIEEgbnVtYmVyLCBvciBhIHN0cmluZyBjb250YWluaW5nIGEgbnVtYmVyLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZWRlZiBJRm9udE1ldHJpY3NcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBhc2NlbnQgLSBGb250IGFzY2VudFxuICogQHByb3BlcnR5IHtudW1iZXJ9IGRlc2NlbnQgLSBGb250IGRlc2NlbnRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmb250U2l6ZSAtIEZvbnQgc2l6ZVxuICovXG4iLCAiLyogZXNsaW50IG1heC1kZXB0aDogWzIsIDhdICovXG5pbXBvcnQgeyBTcHJpdGUgfSBmcm9tICdAcGl4aS9zcHJpdGUnO1xuaW1wb3J0IHsgVGV4dHVyZSAgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBzaWduLCB0cmltQ2FudmFzLCBoZXgycmdiLCBzdHJpbmcyaGV4IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgVEVYVF9HUkFESUVOVCB9IGZyb20gJy4vY29uc3QnO1xuaW1wb3J0IHsgVGV4dFN0eWxlIH0gZnJvbSAnLi9UZXh0U3R5bGUnO1xuaW1wb3J0IHsgVGV4dE1ldHJpY3MgfSBmcm9tICcuL1RleHRNZXRyaWNzJztcblxuaW1wb3J0IHR5cGUgeyBJRGVzdHJveU9wdGlvbnMgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB0eXBlIHsgUmVuZGVyZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB0eXBlIHsgSVRleHRTdHlsZSB9IGZyb20gJy4vVGV4dFN0eWxlJztcblxuY29uc3QgZGVmYXVsdERlc3Ryb3lPcHRpb25zOiBJRGVzdHJveU9wdGlvbnMgPSB7XG4gICAgdGV4dHVyZTogdHJ1ZSxcbiAgICBjaGlsZHJlbjogZmFsc2UsXG4gICAgYmFzZVRleHR1cmU6IHRydWUsXG59O1xuXG4vKipcbiAqIEEgVGV4dCBPYmplY3Qgd2lsbCBjcmVhdGUgYSBsaW5lIG9yIG11bHRpcGxlIGxpbmVzIG9mIHRleHQuXG4gKlxuICogVGhlIHRleHQgaXMgY3JlYXRlZCB1c2luZyB0aGUgW0NhbnZhcyBBUEldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DYW52YXNfQVBJKS5cbiAqXG4gKiBUaGUgcHJpbWFyeSBhZHZhbnRhZ2Ugb2YgdGhpcyBjbGFzcyBvdmVyIEJpdG1hcFRleHQgaXMgdGhhdCB5b3UgaGF2ZSBncmVhdCBjb250cm9sIG92ZXIgdGhlIHN0eWxlIG9mIHRoZSBuZXh0LFxuICogd2hpY2ggeW91IGNhbiBjaGFuZ2UgYXQgcnVudGltZS5cbiAqXG4gKiBUaGUgcHJpbWFyeSBkaXNhZHZhbnRhZ2VzIGlzIHRoYXQgZWFjaCBwaWVjZSBvZiB0ZXh0IGhhcyBpdCdzIG93biB0ZXh0dXJlLCB3aGljaCBjYW4gdXNlIG1vcmUgbWVtb3J5LlxuICogV2hlbiB0ZXh0IGNoYW5nZXMsIHRoaXMgdGV4dHVyZSBoYXMgdG8gYmUgcmUtZ2VuZXJhdGVkIGFuZCByZS11cGxvYWRlZCB0byB0aGUgR1BVLCB0YWtpbmcgdXAgdGltZS5cbiAqXG4gKiBUbyBzcGxpdCBhIGxpbmUgeW91IGNhbiB1c2UgJ1xcbicgaW4geW91ciB0ZXh0IHN0cmluZywgb3IsIG9uIHRoZSBgc3R5bGVgIG9iamVjdCxcbiAqIGNoYW5nZSBpdHMgYHdvcmRXcmFwYCBwcm9wZXJ0eSB0byB0cnVlIGFuZCBhbmQgZ2l2ZSB0aGUgYHdvcmRXcmFwV2lkdGhgIHByb3BlcnR5IGEgdmFsdWUuXG4gKlxuICogQSBUZXh0IGNhbiBiZSBjcmVhdGVkIGRpcmVjdGx5IGZyb20gYSBzdHJpbmcgYW5kIGEgc3R5bGUgb2JqZWN0LFxuICogd2hpY2ggY2FuIGJlIGdlbmVyYXRlZCBbaGVyZV0oaHR0cHM6Ly9waXhpanMuaW8vcGl4aS10ZXh0LXN0eWxlKS5cbiAqXG4gKiBgYGBqc1xuICogbGV0IHRleHQgPSBuZXcgUElYSS5UZXh0KCdUaGlzIGlzIGEgUGl4aUpTIHRleHQnLHtmb250RmFtaWx5IDogJ0FyaWFsJywgZm9udFNpemU6IDI0LCBmaWxsIDogMHhmZjEwMTAsIGFsaWduIDogJ2NlbnRlcid9KTtcbiAqIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TcHJpdGVcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0IGV4dGVuZHMgU3ByaXRlXG57XG4gICAgcHVibGljIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgcHVibGljIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgICBwdWJsaWMgbG9jYWxTdHlsZUlEOiBudW1iZXI7XG4gICAgcHVibGljIGRpcnR5OiBib29sZWFuO1xuXG4gICAgX3Jlc29sdXRpb246IG51bWJlcjtcbiAgICBfYXV0b1Jlc29sdXRpb246IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIF90ZXh0OiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIF9mb250OiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIF9zdHlsZTogVGV4dFN0eWxlO1xuICAgIHByb3RlY3RlZCBfc3R5bGVMaXN0ZW5lcjogKCkgPT4gdm9pZDtcbiAgICBwcml2YXRlIF9vd25DYW52YXM6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSBzdHJpbmcgdGhhdCB5b3Ugd291bGQgbGlrZSB0aGUgdGV4dCB0byBkaXNwbGF5XG4gICAgICogQHBhcmFtIHtvYmplY3R8UElYSS5UZXh0U3R5bGV9IFtzdHlsZV0gLSBUaGUgc3R5bGUgcGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IFtjYW52YXNdIC0gVGhlIGNhbnZhcyBlbGVtZW50IGZvciBkcmF3aW5nIHRleHRcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0ZXh0OiBzdHJpbmcsIHN0eWxlOiBQYXJ0aWFsPElUZXh0U3R5bGU+fFRleHRTdHlsZSwgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudClcbiAgICB7XG4gICAgICAgIGxldCBvd25DYW52YXMgPSBmYWxzZTtcblxuICAgICAgICBpZiAoIWNhbnZhcylcbiAgICAgICAge1xuICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICBvd25DYW52YXMgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FudmFzLndpZHRoID0gMztcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IDM7XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IFRleHR1cmUuZnJvbShjYW52YXMpO1xuXG4gICAgICAgIHRleHR1cmUub3JpZyA9IG5ldyBSZWN0YW5nbGUoKTtcbiAgICAgICAgdGV4dHVyZS50cmltID0gbmV3IFJlY3RhbmdsZSgpO1xuXG4gICAgICAgIHN1cGVyKHRleHR1cmUpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwIHRyYWNrIGlmIHRoaXMgVGV4dCBvYmplY3QgY3JlYXRlZCBpdCdzIG93biBjYW52YXNcbiAgICAgICAgICogZWxlbWVudCAoYHRydWVgKSBvciB1c2VzIHRoZSBjb25zdHJ1Y3RvciBhcmd1bWVudCAoYGZhbHNlYCkuXG4gICAgICAgICAqIFVzZWQgdG8gd29ya2Fyb3VuZCBhIEdDIGlzc3VlcyB3aXRoIFNhZmFyaSA8IDEzIHdoZW5cbiAgICAgICAgICogZGVzdHJveWluZyBUZXh0LiBTZWUgYGRlc3Ryb3lgIGZvciBtb3JlIGluZm8uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9vd25DYW52YXMgPSBvd25DYW52YXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjYW52YXMgZWxlbWVudCB0aGF0IGV2ZXJ5dGhpbmcgaXMgZHJhd24gdG9cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7SFRNTENhbnZhc0VsZW1lbnR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNhbnZhcyAyZCBjb250ZXh0IHRoYXQgZXZlcnl0aGluZyBpcyBkcmF3biB3aXRoXG4gICAgICAgICAqIEBtZW1iZXIge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIHRoZSBjYW52YXMuXG4gICAgICAgICAqIFRoaXMgaXMgc2V0IHRvIGF1dG9tYXRpY2FsbHkgbWF0Y2ggdGhlIHJlbmRlcmVyIHJlc29sdXRpb24gYnkgZGVmYXVsdCwgYnV0IGNhbiBiZSBvdmVycmlkZGVuIGJ5IHNldHRpbmcgbWFudWFsbHkuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcmVzb2x1dGlvbiA9IHNldHRpbmdzLlJFU09MVVRJT047XG4gICAgICAgIHRoaXMuX2F1dG9SZXNvbHV0aW9uID0gdHJ1ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSB0cmFja2VyIGZvciB0aGUgY3VycmVudCB0ZXh0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90ZXh0ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSB0cmFja2VyIGZvciB0aGUgY3VycmVudCBzdHlsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc3R5bGUgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSBsaXN0ZW5lciB0byB0cmFjayBzdHlsZSBjaGFuZ2VzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3N0eWxlTGlzdGVuZXIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcml2YXRlIHRyYWNrZXIgZm9yIHRoZSBjdXJyZW50IGZvbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2ZvbnQgPSAnJztcblxuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgICAgICB0aGlzLnN0eWxlID0gc3R5bGU7XG5cbiAgICAgICAgdGhpcy5sb2NhbFN0eWxlSUQgPSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIHRleHQgdG8gaXRzIGNhbnZhcywgYW5kIHVwZGF0ZXMgaXRzIHRleHR1cmUuXG4gICAgICogQnkgZGVmYXVsdCB0aGlzIGlzIHVzZWQgaW50ZXJuYWxseSB0byBlbnN1cmUgdGhlIHRleHR1cmUgaXMgY29ycmVjdCBiZWZvcmUgcmVuZGVyaW5nLFxuICAgICAqIGJ1dCBpdCBjYW4gYmUgdXNlZCBjYWxsZWQgZXh0ZXJuYWxseSwgZm9yIGV4YW1wbGUgZnJvbSB0aGlzIGNsYXNzIHRvICdwcmUtZ2VuZXJhdGUnIHRoZSB0ZXh0dXJlIGZyb20gYSBwaWVjZSBvZiB0ZXh0LFxuICAgICAqIGFuZCB0aGVuIHNoYXJlZCBhY3Jvc3MgbXVsdGlwbGUgU3ByaXRlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVzcGVjdERpcnR5IC0gV2hldGhlciB0byBhYm9ydCB1cGRhdGluZyB0aGUgdGV4dCBpZiB0aGUgVGV4dCBpc24ndCBkaXJ0eSBhbmQgdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZC5cbiAgICAgKi9cbiAgICBwdWJsaWMgdXBkYXRlVGV4dChyZXNwZWN0RGlydHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuX3N0eWxlO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHN0eWxlIGhhcyBjaGFuZ2VkLi5cbiAgICAgICAgaWYgKHRoaXMubG9jYWxTdHlsZUlEICE9PSBzdHlsZS5zdHlsZUlEKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubG9jYWxTdHlsZUlEID0gc3R5bGUuc3R5bGVJRDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5kaXJ0eSAmJiByZXNwZWN0RGlydHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZvbnQgPSB0aGlzLl9zdHlsZS50b0ZvbnRTdHJpbmcoKTtcblxuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0O1xuICAgICAgICBjb25zdCBtZWFzdXJlZCA9IFRleHRNZXRyaWNzLm1lYXN1cmVUZXh0KHRoaXMuX3RleHQgfHwgJyAnLCB0aGlzLl9zdHlsZSwgdGhpcy5fc3R5bGUud29yZFdyYXAsIHRoaXMuY2FudmFzKTtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBtZWFzdXJlZC53aWR0aDtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gbWVhc3VyZWQuaGVpZ2h0O1xuICAgICAgICBjb25zdCBsaW5lcyA9IG1lYXN1cmVkLmxpbmVzO1xuICAgICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gbWVhc3VyZWQubGluZUhlaWdodDtcbiAgICAgICAgY29uc3QgbGluZVdpZHRocyA9IG1lYXN1cmVkLmxpbmVXaWR0aHM7XG4gICAgICAgIGNvbnN0IG1heExpbmVXaWR0aCA9IG1lYXN1cmVkLm1heExpbmVXaWR0aDtcbiAgICAgICAgY29uc3QgZm9udFByb3BlcnRpZXMgPSBtZWFzdXJlZC5mb250UHJvcGVydGllcztcblxuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IE1hdGguY2VpbCgoTWF0aC5tYXgoMSwgd2lkdGgpICsgKHN0eWxlLnBhZGRpbmcgKiAyKSkgKiB0aGlzLl9yZXNvbHV0aW9uKTtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gTWF0aC5jZWlsKChNYXRoLm1heCgxLCBoZWlnaHQpICsgKHN0eWxlLnBhZGRpbmcgKiAyKSkgKiB0aGlzLl9yZXNvbHV0aW9uKTtcblxuICAgICAgICBjb250ZXh0LnNjYWxlKHRoaXMuX3Jlc29sdXRpb24sIHRoaXMuX3Jlc29sdXRpb24pO1xuXG4gICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgIGNvbnRleHQuZm9udCA9IHRoaXMuX2ZvbnQ7XG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gc3R5bGUuc3Ryb2tlVGhpY2tuZXNzO1xuICAgICAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZTtcbiAgICAgICAgY29udGV4dC5saW5lSm9pbiA9IHN0eWxlLmxpbmVKb2luO1xuICAgICAgICBjb250ZXh0Lm1pdGVyTGltaXQgPSBzdHlsZS5taXRlckxpbWl0O1xuXG4gICAgICAgIGxldCBsaW5lUG9zaXRpb25YOiBudW1iZXI7XG4gICAgICAgIGxldCBsaW5lUG9zaXRpb25ZOiBudW1iZXI7XG5cbiAgICAgICAgLy8gcmVxdWlyZSAyIHBhc3NlcyBpZiBhIHNoYWRvdzsgdGhlIGZpcnN0IHRvIGRyYXcgdGhlIGRyb3Agc2hhZG93LCB0aGUgc2Vjb25kIHRvIGRyYXcgdGhlIHRleHRcbiAgICAgICAgY29uc3QgcGFzc2VzQ291bnQgPSBzdHlsZS5kcm9wU2hhZG93ID8gMiA6IDE7XG5cbiAgICAgICAgLy8gRm9yIHY0LCB3ZSBkcmV3IHRleHQgYXQgdGhlIGNvbG91cnMgb2YgdGhlIGRyb3Agc2hhZG93IHVuZGVybmVhdGggdGhlIG5vcm1hbCB0ZXh0LiBUaGlzIGdhdmUgdGhlIGNvcnJlY3QgekluZGV4LFxuICAgICAgICAvLyBidXQgZmVhdHVyZXMgc3VjaCBhcyBhbHBoYSBhbmQgc2hhZG93Ymx1ciBkaWQgbm90IGxvb2sgcmlnaHQgYXQgYWxsLCBzaW5jZSB3ZSB3ZXJlIHVzaW5nIGFjdHVhbCB0ZXh0IGFzIGEgc2hhZG93LlxuICAgICAgICAvL1xuICAgICAgICAvLyBGb3IgdjUuMC4wLCB3ZSBtb3ZlZCBvdmVyIHRvIGp1c3QgdXNlIHRoZSBjYW52YXMgQVBJIGZvciBkcm9wIHNoYWRvd3MsIHdoaWNoIG1hZGUgdGhlbSBsb29rIG11Y2ggbmljZXIgYW5kIG1vcmVcbiAgICAgICAgLy8gdmlzdWFsbHkgcGxlYXNlLCBidXQgbm93IGJlY2F1c2UgdGhlIHN0cm9rZSBpcyBkcmF3biBhbmQgdGhlbiB0aGUgZmlsbCwgZHJvcCBzaGFkb3dzIHdvdWxkIGFwcGVhciBvbiBib3RoIHRoZSBmaWxsXG4gICAgICAgIC8vIGFuZCB0aGUgc3Ryb2tlOyBhbmQgZmlsbCBkcm9wIHNoYWRvd3Mgd291bGQgYXBwZWFyIG92ZXIgdGhlIHRvcCBvZiB0aGUgc3Ryb2tlLlxuICAgICAgICAvL1xuICAgICAgICAvLyBGb3IgdjUuMS4xLCB0aGUgbmV3IHJvdXRlIGlzIHRvIHJldmVydCB0byB2NCBzdHlsZSBvZiBkcmF3aW5nIHRleHQgZmlyc3QgdG8gZ2V0IHRoZSBkcm9wIHNoYWRvd3MgdW5kZXJuZWF0aCBub3JtYWxcbiAgICAgICAgLy8gdGV4dCwgYnV0IGluc3RlYWQgZHJhd2luZyB0ZXh0IGluIHRoZSBjb3JyZWN0IGxvY2F0aW9uLCB3ZSdsbCBkcmF3IGl0IG9mZiBzY3JlZW4gKC1wYWRkaW5nWSksIGFuZCB0aGVuIGFkanVzdCB0aGVcbiAgICAgICAgLy8gZHJvcCBzaGFkb3cgc28gb25seSB0aGF0IGFwcGVhcnMgb24gc2NyZWVuICgrcGFkZGluZ1kpLiBOb3cgd2UnbGwgaGF2ZSB0aGUgY29ycmVjdCBkcmF3IG9yZGVyIG9mIHRoZSBzaGFkb3dcbiAgICAgICAgLy8gYmVuZWF0aCB0aGUgdGV4dCwgd2hpbHN0IGFsc28gaGF2aW5nIHRoZSBwcm9wZXIgdGV4dCBzaGFkb3cgc3R5bGluZy5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXNzZXNDb3VudDsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBpc1NoYWRvd1Bhc3MgPSBzdHlsZS5kcm9wU2hhZG93ICYmIGkgPT09IDA7XG4gICAgICAgICAgICAvLyB3ZSBvbmx5IHdhbnQgdGhlIGRyb3Agc2hhZG93LCBzbyBwdXQgdGV4dCB3YXkgb2ZmLXNjcmVlblxuICAgICAgICAgICAgY29uc3QgZHNPZmZzZXRUZXh0ID0gaXNTaGFkb3dQYXNzID8gTWF0aC5jZWlsKE1hdGgubWF4KDEsIGhlaWdodCkgKyAoc3R5bGUucGFkZGluZyAqIDIpKSA6IDA7XG4gICAgICAgICAgICBjb25zdCBkc09mZnNldFNoYWRvdyA9IGRzT2Zmc2V0VGV4dCAqIHRoaXMuX3Jlc29sdXRpb247XG5cbiAgICAgICAgICAgIGlmIChpc1NoYWRvd1Bhc3MpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gT24gU2FmYXJpLCB0ZXh0IHdpdGggZ3JhZGllbnQgYW5kIGRyb3Agc2hhZG93cyB0b2dldGhlciBkbyBub3QgcG9zaXRpb24gY29ycmVjdGx5XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIHNjYWxlIG9mIHRoZSBjYW52YXMgaXMgbm90IDE6IGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xOTc2ODlcbiAgICAgICAgICAgICAgICAvLyBUaGVyZWZvcmUgd2UnbGwgc2V0IHRoZSBzdHlsZXMgdG8gYmUgYSBwbGFpbiBibGFjayB3aGlsc3QgZ2VuZXJhdGluZyB0aGlzIGRyb3Agc2hhZG93XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnYmxhY2snO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZHJvcFNoYWRvd0NvbG9yID0gc3R5bGUuZHJvcFNoYWRvd0NvbG9yO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJnYiA9IGhleDJyZ2IodHlwZW9mIGRyb3BTaGFkb3dDb2xvciA9PT0gJ251bWJlcicgPyBkcm9wU2hhZG93Q29sb3IgOiBzdHJpbmcyaGV4KGRyb3BTaGFkb3dDb2xvcikpO1xuXG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9IGByZ2JhKCR7cmdiWzBdICogMjU1fSwke3JnYlsxXSAqIDI1NX0sJHtyZ2JbMl0gKiAyNTV9LCR7c3R5bGUuZHJvcFNoYWRvd0FscGhhfSlgO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IHN0eWxlLmRyb3BTaGFkb3dCbHVyO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IE1hdGguY29zKHN0eWxlLmRyb3BTaGFkb3dBbmdsZSkgKiBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRZID0gKE1hdGguc2luKHN0eWxlLmRyb3BTaGFkb3dBbmdsZSkgKiBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2UpICsgZHNPZmZzZXRTaGFkb3c7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gc2V0IGNhbnZhcyB0ZXh0IHN0eWxlc1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gdGhpcy5fZ2VuZXJhdGVGaWxsU3R5bGUoc3R5bGUsIGxpbmVzLCBtZWFzdXJlZCk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogQ2FuJ3QgaGF2ZSBkaWZmZXJlbnQgdHlwZXMgZm9yIGdldHRlciBhbmQgc2V0dGVyLiBUaGUgZ2V0dGVyIHNob3VsZG4ndCBoYXZlIHRoZSBudW1iZXIgdHlwZSBhc1xuICAgICAgICAgICAgICAgIC8vICAgICAgIHRoZSBzZXR0ZXIgY29udmVydHMgdG8gc3RyaW5nLiBTZWUgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZGV0YWlsczpcbiAgICAgICAgICAgICAgICAvLyAgICAgICBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzI1MjFcbiAgICAgICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gc3R5bGUuc3Ryb2tlIGFzIHN0cmluZztcblxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSAnYmxhY2snO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDA7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRYID0gMDtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkcmF3IGxpbmVzIGxpbmUgYnkgbGluZVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsaW5lUG9zaXRpb25YID0gc3R5bGUuc3Ryb2tlVGhpY2tuZXNzIC8gMjtcbiAgICAgICAgICAgICAgICBsaW5lUG9zaXRpb25ZID0gKChzdHlsZS5zdHJva2VUaGlja25lc3MgLyAyKSArIChpICogbGluZUhlaWdodCkpICsgZm9udFByb3BlcnRpZXMuYXNjZW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlLmFsaWduID09PSAncmlnaHQnKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZVBvc2l0aW9uWCArPSBtYXhMaW5lV2lkdGggLSBsaW5lV2lkdGhzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHlsZS5hbGlnbiA9PT0gJ2NlbnRlcicpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsaW5lUG9zaXRpb25YICs9IChtYXhMaW5lV2lkdGggLSBsaW5lV2lkdGhzW2ldKSAvIDI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlLnN0cm9rZSAmJiBzdHlsZS5zdHJva2VUaGlja25lc3MpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXdMZXR0ZXJTcGFjaW5nKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lUG9zaXRpb25YICsgc3R5bGUucGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVQb3NpdGlvblkgKyBzdHlsZS5wYWRkaW5nIC0gZHNPZmZzZXRUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzdHlsZS5maWxsKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3TGV0dGVyU3BhY2luZyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZVBvc2l0aW9uWCArIHN0eWxlLnBhZGRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lUG9zaXRpb25ZICsgc3R5bGUucGFkZGluZyAtIGRzT2Zmc2V0VGV4dFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlVGV4dHVyZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgdGV4dCB3aXRoIGxldHRlci1zcGFjaW5nLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gVGhlIHRleHQgdG8gZHJhd1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gSG9yaXpvbnRhbCBwb3NpdGlvbiB0byBkcmF3IHRoZSB0ZXh0XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBWZXJ0aWNhbCBwb3NpdGlvbiB0byBkcmF3IHRoZSB0ZXh0XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNTdHJva2U9ZmFsc2VdIC0gSXMgdGhpcyBkcmF3aW5nIGZvciB0aGUgb3V0c2lkZSBzdHJva2Ugb2YgdGhlXG4gICAgICogIHRleHQ/IElmIG5vdCwgaXQncyBmb3IgdGhlIGluc2lkZSBmaWxsXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGRyYXdMZXR0ZXJTcGFjaW5nKHRleHQ6IHN0cmluZywgeDogbnVtYmVyLCB5OiBudW1iZXIsIGlzU3Ryb2tlID0gZmFsc2UpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuX3N0eWxlO1xuXG4gICAgICAgIC8vIGxldHRlclNwYWNpbmcgb2YgMCBtZWFucyBub3JtYWxcbiAgICAgICAgY29uc3QgbGV0dGVyU3BhY2luZyA9IHN0eWxlLmxldHRlclNwYWNpbmc7XG5cbiAgICAgICAgaWYgKGxldHRlclNwYWNpbmcgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChpc1N0cm9rZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlVGV4dCh0ZXh0LCB4LCB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQodGV4dCwgeCwgeSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50UG9zaXRpb24gPSB4O1xuXG4gICAgICAgIC8vIFVzaW5nIEFycmF5LmZyb20gY29ycmVjdGx5IHNwbGl0cyBjaGFyYWN0ZXJzIHdoaWxzdCBrZWVwaW5nIGVtb2ppIHRvZ2V0aGVyLlxuICAgICAgICAvLyBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQgb24gSUUgYXMgaXQgcmVxdWlyZXMgRVM2LCBzbyByZWd1bGFyIHRleHQgc3BsaXR0aW5nIG9jY3Vycy5cbiAgICAgICAgLy8gVGhpcyBhbHNvIGRvZXNuJ3QgYWNjb3VudCBmb3IgZW1vamkgdGhhdCBhcmUgbXVsdGlwbGUgZW1vamkgcHV0IHRvZ2V0aGVyIHRvIG1ha2Ugc29tZXRoaW5nIGVsc2UuXG4gICAgICAgIC8vIEhhbmRsaW5nIGFsbCBvZiB0aGlzIHdvdWxkIHJlcXVpcmUgYSBiaWcgbGlicmFyeSBpdHNlbGYuXG4gICAgICAgIC8vIGh0dHBzOi8vbWVkaXVtLmNvbS9AZ2lsdGF5YXIvaXRlcmF0aW5nLW92ZXItZW1vamktY2hhcmFjdGVycy10aGUtZXM2LXdheS1mMDZlNDU4OTUxNlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vb3JsaW5nL2dyYXBoZW1lLXNwbGl0dGVyXG4gICAgICAgIGNvbnN0IHN0cmluZ0FycmF5ID0gQXJyYXkuZnJvbSA/IEFycmF5LmZyb20odGV4dCkgOiB0ZXh0LnNwbGl0KCcnKTtcbiAgICAgICAgbGV0IHByZXZpb3VzV2lkdGggPSB0aGlzLmNvbnRleHQubWVhc3VyZVRleHQodGV4dCkud2lkdGg7XG4gICAgICAgIGxldCBjdXJyZW50V2lkdGggPSAwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyaW5nQXJyYXkubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDaGFyID0gc3RyaW5nQXJyYXlbaV07XG5cbiAgICAgICAgICAgIGlmIChpc1N0cm9rZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlVGV4dChjdXJyZW50Q2hhciwgY3VycmVudFBvc2l0aW9uLCB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQoY3VycmVudENoYXIsIGN1cnJlbnRQb3NpdGlvbiwgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50V2lkdGggPSB0aGlzLmNvbnRleHQubWVhc3VyZVRleHQodGV4dC5zdWJzdHJpbmcoaSArIDEpKS53aWR0aDtcbiAgICAgICAgICAgIGN1cnJlbnRQb3NpdGlvbiArPSBwcmV2aW91c1dpZHRoIC0gY3VycmVudFdpZHRoICsgbGV0dGVyU3BhY2luZztcbiAgICAgICAgICAgIHByZXZpb3VzV2lkdGggPSBjdXJyZW50V2lkdGg7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRleHR1cmUgc2l6ZSBiYXNlZCBvbiBjYW52YXMgc2l6ZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVRleHR1cmUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgY2FudmFzID0gdGhpcy5jYW52YXM7XG5cbiAgICAgICAgaWYgKHRoaXMuX3N0eWxlLnRyaW0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHRyaW1tZWQgPSB0cmltQ2FudmFzKGNhbnZhcyk7XG5cbiAgICAgICAgICAgIGlmICh0cmltbWVkLmRhdGEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gdHJpbW1lZC53aWR0aDtcbiAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gdHJpbW1lZC5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YSh0cmltbWVkLmRhdGEsIDAsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IHRoaXMuX3RleHR1cmU7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gdGhpcy5fc3R5bGU7XG4gICAgICAgIGNvbnN0IHBhZGRpbmcgPSBzdHlsZS50cmltID8gMCA6IHN0eWxlLnBhZGRpbmc7XG4gICAgICAgIGNvbnN0IGJhc2VUZXh0dXJlID0gdGV4dHVyZS5iYXNlVGV4dHVyZTtcblxuICAgICAgICB0ZXh0dXJlLnRyaW0ud2lkdGggPSB0ZXh0dXJlLl9mcmFtZS53aWR0aCA9IE1hdGguY2VpbChjYW52YXMud2lkdGggLyB0aGlzLl9yZXNvbHV0aW9uKTtcbiAgICAgICAgdGV4dHVyZS50cmltLmhlaWdodCA9IHRleHR1cmUuX2ZyYW1lLmhlaWdodCA9IE1hdGguY2VpbChjYW52YXMuaGVpZ2h0IC8gdGhpcy5fcmVzb2x1dGlvbik7XG4gICAgICAgIHRleHR1cmUudHJpbS54ID0gLXBhZGRpbmc7XG4gICAgICAgIHRleHR1cmUudHJpbS55ID0gLXBhZGRpbmc7XG5cbiAgICAgICAgdGV4dHVyZS5vcmlnLndpZHRoID0gdGV4dHVyZS5fZnJhbWUud2lkdGggLSAocGFkZGluZyAqIDIpO1xuICAgICAgICB0ZXh0dXJlLm9yaWcuaGVpZ2h0ID0gdGV4dHVyZS5fZnJhbWUuaGVpZ2h0IC0gKHBhZGRpbmcgKiAyKTtcblxuICAgICAgICAvLyBjYWxsIHNwcml0ZSBvblRleHR1cmVVcGRhdGUgdG8gdXBkYXRlIHNjYWxlIGlmIF93aWR0aCBvciBfaGVpZ2h0IHdlcmUgc2V0XG4gICAgICAgIHRoaXMuX29uVGV4dHVyZVVwZGF0ZSgpO1xuXG4gICAgICAgIGJhc2VUZXh0dXJlLnNldFJlYWxTaXplKGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCwgdGhpcy5fcmVzb2x1dGlvbik7XG5cbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgdXBkYXRlcyB0cmFuc2Zvcm0gb2YgYWxsIG9iamVjdHMgZnJvbSB0aGUgcm9vdCB0byB0aGlzIG9uZVxuICAgICAgICB0aGlzLl9yZWN1cnNpdmVQb3N0VXBkYXRlVHJhbnNmb3JtKCk7XG5cbiAgICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlcnMgdGhlIG9iamVjdCB1c2luZyB0aGUgV2ViR0wgcmVuZGVyZXJcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF9yZW5kZXIocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuX2F1dG9SZXNvbHV0aW9uICYmIHRoaXMuX3Jlc29sdXRpb24gIT09IHJlbmRlcmVyLnJlc29sdXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdXRpb24gPSByZW5kZXJlci5yZXNvbHV0aW9uO1xuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVwZGF0ZVRleHQodHJ1ZSk7XG5cbiAgICAgICAgc3VwZXIuX3JlbmRlcihyZW5kZXJlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbG9jYWwgYm91bmRzIG9mIHRoZSB0ZXh0IG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IHJlY3QgLSBUaGUgb3V0cHV0IHJlY3RhbmdsZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gVGhlIGJvdW5kcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0TG9jYWxCb3VuZHMocmVjdDogUmVjdGFuZ2xlKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQodHJ1ZSk7XG5cbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldExvY2FsQm91bmRzLmNhbGwodGhpcywgcmVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2FsY3VsYXRlcyB0aGUgYm91bmRzIG9mIHRoZSBUZXh0IGFzIGEgcmVjdGFuZ2xlLiBUaGUgYm91bmRzIGNhbGN1bGF0aW9uIHRha2VzIHRoZSB3b3JsZFRyYW5zZm9ybSBpbnRvIGFjY291bnQuXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY2FsY3VsYXRlQm91bmRzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dCh0cnVlKTtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVWZXJ0aWNlcygpO1xuICAgICAgICAvLyBpZiB3ZSBoYXZlIGFscmVhZHkgZG9uZSB0aGlzIG9uIFRISVMgZnJhbWUuXG4gICAgICAgIHRoaXMuX2JvdW5kcy5hZGRRdWFkKHRoaXMudmVydGV4RGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIHRoZSBmaWxsIHN0eWxlLiBDYW4gYXV0b21hdGljYWxseSBnZW5lcmF0ZSBhIGdyYWRpZW50IGJhc2VkIG9uIHRoZSBmaWxsIHN0eWxlIGJlaW5nIGFuIGFycmF5XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzdHlsZSAtIFRoZSBzdHlsZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBsaW5lcyAtIFRoZSBsaW5lcyBvZiB0ZXh0LlxuICAgICAqIEByZXR1cm4ge3N0cmluZ3xudW1iZXJ8Q2FudmFzR3JhZGllbnR9IFRoZSBmaWxsIHN0eWxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfZ2VuZXJhdGVGaWxsU3R5bGUoc3R5bGU6IFRleHRTdHlsZSwgbGluZXM6IHN0cmluZ1tdLCBtZXRyaWNzOiBUZXh0TWV0cmljcyk6IHN0cmluZ3xDYW52YXNHcmFkaWVudHxDYW52YXNQYXR0ZXJuXG4gICAge1xuICAgICAgICAvLyBUT0RPOiBDYW4ndCBoYXZlIGRpZmZlcmVudCB0eXBlcyBmb3IgZ2V0dGVyIGFuZCBzZXR0ZXIuIFRoZSBnZXR0ZXIgc2hvdWxkbid0IGhhdmUgdGhlIG51bWJlciB0eXBlIGFzXG4gICAgICAgIC8vICAgICAgIHRoZSBzZXR0ZXIgY29udmVydHMgdG8gc3RyaW5nLiBTZWUgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZGV0YWlsczpcbiAgICAgICAgLy8gICAgICAgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8yNTIxXG4gICAgICAgIGNvbnN0IGZpbGxTdHlsZTogc3RyaW5nfHN0cmluZ1tdfENhbnZhc0dyYWRpZW50fENhbnZhc1BhdHRlcm4gPSBzdHlsZS5maWxsIGFzIGFueTtcblxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZmlsbFN0eWxlKSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGxTdHlsZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChmaWxsU3R5bGUubGVuZ3RoID09PSAxKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmlsbFN0eWxlWzBdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGhlIGdyYWRpZW50IHdpbGwgYmUgZXZlbmx5IHNwYWNlZCBvdXQgYWNjb3JkaW5nIHRvIGhvdyBsYXJnZSB0aGUgYXJyYXkgaXMuXG4gICAgICAgIC8vIFsnI0ZGMDAwMCcsICcjMDBGRjAwJywgJyMwMDAwRkYnXSB3b3VsZCBjcmVhdGVkIHN0b3BzIGF0IDAuMjUsIDAuNSBhbmQgMC43NVxuICAgICAgICBsZXQgZ3JhZGllbnQ6IHN0cmluZ1tdfENhbnZhc0dyYWRpZW50O1xuXG4gICAgICAgIC8vIGEgZHJvcHNoYWRvdyB3aWxsIGVubGFyZ2UgdGhlIGNhbnZhcyBhbmQgcmVzdWx0IGluIHRoZSBncmFkaWVudCBiZWluZ1xuICAgICAgICAvLyBnZW5lcmF0ZWQgd2l0aCB0aGUgaW5jb3JyZWN0IGRpbWVuc2lvbnNcbiAgICAgICAgY29uc3QgZHJvcFNoYWRvd0NvcnJlY3Rpb24gPSAoc3R5bGUuZHJvcFNoYWRvdykgPyBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2UgOiAwO1xuXG4gICAgICAgIC8vIHNob3VsZCBhbHNvIHRha2UgcGFkZGluZyBpbnRvIGFjY291bnQsIHBhZGRpbmcgY2FuIG9mZnNldCB0aGUgZ3JhZGllbnRcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IHN0eWxlLnBhZGRpbmcgfHwgMDtcblxuICAgICAgICBjb25zdCB3aWR0aCA9IE1hdGguY2VpbCh0aGlzLmNhbnZhcy53aWR0aCAvIHRoaXMuX3Jlc29sdXRpb24pIC0gZHJvcFNoYWRvd0NvcnJlY3Rpb24gLSAocGFkZGluZyAqIDIpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLmNlaWwodGhpcy5jYW52YXMuaGVpZ2h0IC8gdGhpcy5fcmVzb2x1dGlvbikgLSBkcm9wU2hhZG93Q29ycmVjdGlvbiAtIChwYWRkaW5nICogMik7XG5cbiAgICAgICAgLy8gbWFrZSBhIGNvcHkgb2YgdGhlIHN0eWxlIHNldHRpbmdzLCBzbyB3ZSBjYW4gbWFuaXB1bGF0ZSB0aGVtIGxhdGVyXG4gICAgICAgIGNvbnN0IGZpbGwgPSBmaWxsU3R5bGUuc2xpY2UoKTtcbiAgICAgICAgY29uc3QgZmlsbEdyYWRpZW50U3RvcHMgPSBzdHlsZS5maWxsR3JhZGllbnRTdG9wcy5zbGljZSgpO1xuXG4gICAgICAgIC8vIHdhbnRpbmcgdG8gZXZlbmx5IGRpc3RyaWJ1dGUgdGhlIGZpbGxzLiBTbyBhbiBhcnJheSBvZiA0IGNvbG91cnMgc2hvdWxkIGdpdmUgZmlsbHMgb2YgMC4yNSwgMC41IGFuZCAwLjc1XG4gICAgICAgIGlmICghZmlsbEdyYWRpZW50U3RvcHMubGVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBsZW5ndGhQbHVzMSA9IGZpbGwubGVuZ3RoICsgMTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsZW5ndGhQbHVzMTsgKytpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpbGxHcmFkaWVudFN0b3BzLnB1c2goaSAvIGxlbmd0aFBsdXMxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHN0b3AgdGhlIGJsZWVkaW5nIG9mIHRoZSBsYXN0IGdyYWRpZW50IG9uIHRoZSBsaW5lIGFib3ZlIHRvIHRoZSB0b3AgZ3JhZGllbnQgb2YgdGhlIHRoaXMgbGluZVxuICAgICAgICAvLyBieSBoYXJkIGRlZmluaW5nIHRoZSBmaXJzdCBncmFkaWVudCBjb2xvdXIgYXQgcG9pbnQgMCwgYW5kIGxhc3QgZ3JhZGllbnQgY29sb3VyIGF0IHBvaW50IDFcbiAgICAgICAgZmlsbC51bnNoaWZ0KGZpbGxTdHlsZVswXSk7XG4gICAgICAgIGZpbGxHcmFkaWVudFN0b3BzLnVuc2hpZnQoMCk7XG5cbiAgICAgICAgZmlsbC5wdXNoKGZpbGxTdHlsZVtmaWxsU3R5bGUubGVuZ3RoIC0gMV0pO1xuICAgICAgICBmaWxsR3JhZGllbnRTdG9wcy5wdXNoKDEpO1xuXG4gICAgICAgIGlmIChzdHlsZS5maWxsR3JhZGllbnRUeXBlID09PSBURVhUX0dSQURJRU5ULkxJTkVBUl9WRVJUSUNBTClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gc3RhcnQgdGhlIGdyYWRpZW50IGF0IHRoZSB0b3AgY2VudGVyIG9mIHRoZSBjYW52YXMsIGFuZCBlbmQgYXQgdGhlIGJvdHRvbSBtaWRkbGUgb2YgdGhlIGNhbnZhc1xuICAgICAgICAgICAgZ3JhZGllbnQgPSB0aGlzLmNvbnRleHQuY3JlYXRlTGluZWFyR3JhZGllbnQod2lkdGggLyAyLCBwYWRkaW5nLCB3aWR0aCAvIDIsIGhlaWdodCArIHBhZGRpbmcpO1xuXG4gICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHJlcGVhdCB0aGUgZ3JhZGllbnQgc28gdGhhdCBlYWNoIGluZGl2aWR1YWwgbGluZSBvZiB0ZXh0IGhhcyB0aGUgc2FtZSB2ZXJ0aWNhbCBncmFkaWVudCBlZmZlY3RcbiAgICAgICAgICAgIC8vIFsnI0ZGMDAwMCcsICcjMDBGRjAwJywgJyMwMDAwRkYnXSBvdmVyIDIgbGluZXMgd291bGQgY3JlYXRlIHN0b3BzIGF0IDAuMTI1LCAwLjI1LCAwLjM3NSwgMC42MjUsIDAuNzUsIDAuODc1XG5cbiAgICAgICAgICAgIC8vIFRoZXJlJ3MgcG90ZW50aWFsIGZvciBmbG9hdGluZyBwb2ludCBwcmVjaXNpb24gaXNzdWVzIGF0IHRoZSBzZWFtcyBiZXR3ZWVuIGdyYWRpZW50IHJlcGVhdHMuXG4gICAgICAgICAgICAvLyBUaGUgbG9vcCBiZWxvdyBnZW5lcmF0ZXMgdGhlIHN0b3BzIGluIG9yZGVyLCBzbyB0cmFjayB0aGUgbGFzdCBnZW5lcmF0ZWQgb25lIHRvIHByZXZlbnRcbiAgICAgICAgICAgIC8vIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbiBmcm9tIG1ha2luZyB1cyBnbyB0aGUgdGVlbmllc3QgYml0IGJhY2t3YXJkcywgcmVzdWx0aW5nIGluXG4gICAgICAgICAgICAvLyB0aGUgZmlyc3QgYW5kIGxhc3QgY29sb3JzIGdldHRpbmcgc3dhcHBlZC5cbiAgICAgICAgICAgIGxldCBsYXN0SXRlcmF0aW9uU3RvcCA9IDA7XG5cbiAgICAgICAgICAgIC8vIEFjdHVhbCBoZWlnaHQgb2YgdGhlIHRleHQgaXRzZWxmLCBub3QgY291bnRpbmcgc3BhY2luZyBmb3IgbGluZUhlaWdodC9sZWFkaW5nL2Ryb3BTaGFkb3cgZXRjXG4gICAgICAgICAgICBjb25zdCB0ZXh0SGVpZ2h0ID0gbWV0cmljcy5mb250UHJvcGVydGllcy5mb250U2l6ZSArIHN0eWxlLnN0cm9rZVRoaWNrbmVzcztcblxuICAgICAgICAgICAgLy8gdGV4dEhlaWdodCwgYnV0IGFzIGEgMC0xIHNpemUgaW4gZ2xvYmFsIGdyYWRpZW50IHN0b3Agc3BhY2VcbiAgICAgICAgICAgIGNvbnN0IGdyYWRTdG9wTGluZUhlaWdodCA9IHRleHRIZWlnaHQgLyBoZWlnaHQ7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGhpc0xpbmVUb3AgPSBtZXRyaWNzLmxpbmVIZWlnaHQgKiBpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBmaWxsLmxlbmd0aDsgaisrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gMC0xIHN0b3AgcG9pbnQgZm9yIHRoZSBjdXJyZW50IGxpbmUsIG11bHRpcGxpZWQgdG8gZ2xvYmFsIHNwYWNlIGFmdGVyd2FyZHNcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmVTdG9wID0gMDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZpbGxHcmFkaWVudFN0b3BzW2pdID09PSAnbnVtYmVyJylcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZVN0b3AgPSBmaWxsR3JhZGllbnRTdG9wc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdG9wID0gaiAvIGZpbGwubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2xvYmFsU3RvcCA9ICh0aGlzTGluZVRvcCAvIGhlaWdodCkgKyAobGluZVN0b3AgKiBncmFkU3RvcExpbmVIZWlnaHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgY29sb3Igc3RvcCBnZW5lcmF0aW9uIGdvaW5nIGJhY2t3YXJkcyBmcm9tIGZsb2F0aW5nIHBvaW50IGltcHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgICAgIGxldCBjbGFtcGVkU3RvcCA9IE1hdGgubWF4KGxhc3RJdGVyYXRpb25TdG9wLCBnbG9iYWxTdG9wKTtcblxuICAgICAgICAgICAgICAgICAgICBjbGFtcGVkU3RvcCA9IE1hdGgubWluKGNsYW1wZWRTdG9wLCAxKTsgLy8gQ2FwIGF0IDEgYXMgd2VsbCBmb3Igc2FmZXR5J3Mgc2FrZSB0byBhdm9pZCBhIHBvc3NpYmxlIHRocm93LlxuICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoY2xhbXBlZFN0b3AsIGZpbGxbal0pO1xuICAgICAgICAgICAgICAgICAgICBsYXN0SXRlcmF0aW9uU3RvcCA9IGNsYW1wZWRTdG9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHN0YXJ0IHRoZSBncmFkaWVudCBhdCB0aGUgY2VudGVyIGxlZnQgb2YgdGhlIGNhbnZhcywgYW5kIGVuZCBhdCB0aGUgY2VudGVyIHJpZ2h0IG9mIHRoZSBjYW52YXNcbiAgICAgICAgICAgIGdyYWRpZW50ID0gdGhpcy5jb250ZXh0LmNyZWF0ZUxpbmVhckdyYWRpZW50KHBhZGRpbmcsIGhlaWdodCAvIDIsIHdpZHRoICsgcGFkZGluZywgaGVpZ2h0IC8gMik7XG5cbiAgICAgICAgICAgIC8vIGNhbiBqdXN0IGV2ZW5seSBzcGFjZSBvdXQgdGhlIGdyYWRpZW50cyBpbiB0aGlzIGNhc2UsIGFzIG11bHRpcGxlIGxpbmVzIG1ha2VzIG5vIGRpZmZlcmVuY2VcbiAgICAgICAgICAgIC8vIHRvIGFuIGV2ZW4gbGVmdCB0byByaWdodCBncmFkaWVudFxuICAgICAgICAgICAgY29uc3QgdG90YWxJdGVyYXRpb25zID0gZmlsbC5sZW5ndGggKyAxO1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRJdGVyYXRpb24gPSAxO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbGwubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IHN0b3A6IG51bWJlcjtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmlsbEdyYWRpZW50U3RvcHNbaV0gPT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcCA9IGZpbGxHcmFkaWVudFN0b3BzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzdG9wID0gY3VycmVudEl0ZXJhdGlvbiAvIHRvdGFsSXRlcmF0aW9ucztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKHN0b3AsIGZpbGxbaV0pO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVyYXRpb24rKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBncmFkaWVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGlzIHRleHQgb2JqZWN0LlxuICAgICAqIE5vdGUqIFVubGlrZSBhIFNwcml0ZSwgYSBUZXh0IG9iamVjdCB3aWxsIGF1dG9tYXRpY2FsbHkgZGVzdHJveSBpdHMgYmFzZVRleHR1cmUgYW5kIHRleHR1cmUgYXNcbiAgICAgKiB0aGUgbWFqb3JpdHkgb2YgdGhlIHRpbWUgdGhlIHRleHR1cmUgd2lsbCBub3QgYmUgc2hhcmVkIHdpdGggYW55IG90aGVyIFNwcml0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdHxib29sZWFufSBbb3B0aW9uc10gLSBPcHRpb25zIHBhcmFtZXRlci4gQSBib29sZWFuIHdpbGwgYWN0IGFzIGlmIGFsbCBvcHRpb25zXG4gICAgICogIGhhdmUgYmVlbiBzZXQgdG8gdGhhdCB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gaWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlIHRoZWlyXG4gICAgICogIGRlc3Ryb3kgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50ZXh0dXJlPXRydWVdIC0gU2hvdWxkIGl0IGRlc3Ryb3kgdGhlIGN1cnJlbnQgdGV4dHVyZSBvZiB0aGUgc3ByaXRlIGFzIHdlbGxcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmJhc2VUZXh0dXJlPXRydWVdIC0gU2hvdWxkIGl0IGRlc3Ryb3kgdGhlIGJhc2UgdGV4dHVyZSBvZiB0aGUgc3ByaXRlIGFzIHdlbGxcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveShvcHRpb25zOiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Jvb2xlYW4nKVxuICAgICAgICB7XG4gICAgICAgICAgICBvcHRpb25zID0geyBjaGlsZHJlbjogb3B0aW9ucyB9O1xuICAgICAgICB9XG5cbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHREZXN0cm95T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICAgc3VwZXIuZGVzdHJveShvcHRpb25zKTtcblxuICAgICAgICAvLyBzZXQgY2FudmFzIHdpZHRoIGFuZCBoZWlnaHQgdG8gMCB0byB3b3JrYXJvdW5kIG1lbW9yeSBsZWFrIGluIFNhZmFyaSA8IDEzXG4gICAgICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzUyNTMyNjE0L3RvdGFsLWNhbnZhcy1tZW1vcnktdXNlLWV4Y2VlZHMtdGhlLW1heGltdW0tbGltaXQtc2FmYXJpLTEyXG4gICAgICAgIGlmICh0aGlzLl9vd25DYW52YXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuY2FudmFzLndpZHRoID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG1ha2Ugc3VyZSB0byByZXNldCB0aGUgdGhlIGNvbnRleHQgYW5kIGNhbnZhcy4uIGRvbnQgd2FudCB0aGlzIGhhbmdpbmcgYXJvdW5kIGluIG1lbW9yeSFcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3N0eWxlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIFRleHQsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgc2NhbGUgdG8gYWNoaWV2ZSB0aGUgdmFsdWUgc2V0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KHRydWUpO1xuXG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLnNjYWxlLngpICogdGhpcy5fdGV4dHVyZS5vcmlnLndpZHRoO1xuICAgIH1cblxuICAgIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KHRydWUpO1xuXG4gICAgICAgIGNvbnN0IHMgPSBzaWduKHRoaXMuc2NhbGUueCkgfHwgMTtcblxuICAgICAgICB0aGlzLnNjYWxlLnggPSBzICogdmFsdWUgLyB0aGlzLl90ZXh0dXJlLm9yaWcud2lkdGg7XG4gICAgICAgIHRoaXMuX3dpZHRoID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgVGV4dCwgc2V0dGluZyB0aGlzIHdpbGwgYWN0dWFsbHkgbW9kaWZ5IHRoZSBzY2FsZSB0byBhY2hpZXZlIHRoZSB2YWx1ZSBzZXRcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgaGVpZ2h0KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0KHRydWUpO1xuXG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLnNjYWxlLnkpICogdGhpcy5fdGV4dHVyZS5vcmlnLmhlaWdodDtcbiAgICB9XG5cbiAgICBzZXQgaGVpZ2h0KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHQodHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgcyA9IHNpZ24odGhpcy5zY2FsZS55KSB8fCAxO1xuXG4gICAgICAgIHRoaXMuc2NhbGUueSA9IHMgKiB2YWx1ZSAvIHRoaXMuX3RleHR1cmUub3JpZy5oZWlnaHQ7XG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgc3R5bGUgb2YgdGhlIHRleHQuIFNldCB1cCBhbiBldmVudCBsaXN0ZW5lciB0byBsaXN0ZW4gZm9yIGNoYW5nZXMgb24gdGhlIHN0eWxlXG4gICAgICogb2JqZWN0IGFuZCBtYXJrIHRoZSB0ZXh0IGFzIGRpcnR5LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7b2JqZWN0fFBJWEkuVGV4dFN0eWxlfVxuICAgICAqL1xuICAgIGdldCBzdHlsZSgpOiBUZXh0U3R5bGV8UGFydGlhbDxJVGV4dFN0eWxlPlxuICAgIHtcbiAgICAgICAgLy8gVE9ETzogQ2FuJ3QgaGF2ZSBkaWZmZXJlbnQgdHlwZXMgZm9yIGdldHRlciBhbmQgc2V0dGVyLiBUaGUgZ2V0dGVyIHNob3VsZG4ndCBoYXZlIHRoZSBJVGV4dFN0eWxlXG4gICAgICAgIC8vICAgICAgIHNpbmNlIHRoZSBzZXR0ZXIgY3JlYXRlcyB0aGUgVGV4dFN0eWxlLiBTZWUgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZGV0YWlsczpcbiAgICAgICAgLy8gICAgICAgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy8yNTIxXG4gICAgICAgIHJldHVybiB0aGlzLl9zdHlsZTtcbiAgICB9XG5cbiAgICBzZXQgc3R5bGUoc3R5bGU6IFRleHRTdHlsZXxQYXJ0aWFsPElUZXh0U3R5bGU+KVxuICAgIHtcbiAgICAgICAgc3R5bGUgPSBzdHlsZSB8fCB7fTtcblxuICAgICAgICBpZiAoc3R5bGUgaW5zdGFuY2VvZiBUZXh0U3R5bGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlID0gc3R5bGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZSA9IG5ldyBUZXh0U3R5bGUoc3R5bGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sb2NhbFN0eWxlSUQgPSAtMTtcbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjb3B5IGZvciB0aGUgdGV4dCBvYmplY3QuIFRvIHNwbGl0IGEgbGluZSB5b3UgY2FuIHVzZSAnXFxuJy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBnZXQgdGV4dCgpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0O1xuICAgIH1cblxuICAgIHNldCB0ZXh0KHRleHQ6IHN0cmluZylcbiAgICB7XG4gICAgICAgIHRleHQgPSBTdHJpbmcodGV4dCA9PT0gbnVsbCB8fCB0ZXh0ID09PSB1bmRlZmluZWQgPyAnJyA6IHRleHQpO1xuXG4gICAgICAgIGlmICh0aGlzLl90ZXh0ID09PSB0ZXh0KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSByZXNvbHV0aW9uIC8gZGV2aWNlIHBpeGVsIHJhdGlvIG9mIHRoZSBjYW52YXMuXG4gICAgICogVGhpcyBpcyBzZXQgdG8gYXV0b21hdGljYWxseSBtYXRjaCB0aGUgcmVuZGVyZXIgcmVzb2x1dGlvbiBieSBkZWZhdWx0LCBidXQgY2FuIGJlIG92ZXJyaWRkZW4gYnkgc2V0dGluZyBtYW51YWxseS5cbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMVxuICAgICAqL1xuICAgIGdldCByZXNvbHV0aW9uKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc29sdXRpb247XG4gICAgfVxuXG4gICAgc2V0IHJlc29sdXRpb24odmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX2F1dG9SZXNvbHV0aW9uID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Jlc29sdXRpb24gPT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9yZXNvbHV0aW9uID0gdmFsdWU7XG4gICAgICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJ0BwaXhpL3NldHRpbmdzJztcblxuLyoqXG4gKiBEZWZhdWx0IG51bWJlciBvZiB1cGxvYWRzIHBlciBmcmFtZSB1c2luZyBwcmVwYXJlIHBsdWdpbi5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyb2YgUElYSS5zZXR0aW5nc1xuICogQG5hbWUgVVBMT0FEU19QRVJfRlJBTUVcbiAqIEB0eXBlIHtudW1iZXJ9XG4gKiBAZGVmYXVsdCA0XG4gKi9cbnNldHRpbmdzLlVQTE9BRFNfUEVSX0ZSQU1FID0gNDtcblxuZXhwb3J0IHsgc2V0dGluZ3MgfTtcbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICIvKipcbiAqIENvdW50TGltaXRlciBsaW1pdHMgdGhlIG51bWJlciBvZiBpdGVtcyBoYW5kbGVkIGJ5IGEge0BsaW5rIFBJWEkuQmFzZVByZXBhcmV9IHRvIGEgc3BlY2lmaWVkXG4gKiBudW1iZXIgb2YgaXRlbXMgcGVyIGZyYW1lLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIENvdW50TGltaXRlclxue1xuICAgIHB1YmxpYyBtYXhJdGVtc1BlckZyYW1lOiBudW1iZXI7XG4gICAgcHVibGljIGl0ZW1zTGVmdDogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtYXhJdGVtc1BlckZyYW1lIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRoYXQgY2FuIGJlIHByZXBhcmVkIGVhY2ggZnJhbWUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IobWF4SXRlbXNQZXJGcmFtZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0aGF0IGNhbiBiZSBwcmVwYXJlZCBlYWNoIGZyYW1lLlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXhJdGVtc1BlckZyYW1lID0gbWF4SXRlbXNQZXJGcmFtZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgaXRlbXMgdGhhdCBjYW4gYmUgcHJlcGFyZWQgaW4gdGhlIGN1cnJlbnQgZnJhbWUuXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLml0ZW1zTGVmdCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIGFueSBjb3VudGluZyBwcm9wZXJ0aWVzIHRvIHN0YXJ0IGZyZXNoIG9uIGEgbmV3IGZyYW1lLlxuICAgICAqL1xuICAgIGJlZ2luRnJhbWUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5pdGVtc0xlZnQgPSB0aGlzLm1heEl0ZW1zUGVyRnJhbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRvIHNlZSBpZiBhbm90aGVyIGl0ZW0gY2FuIGJlIHVwbG9hZGVkLiBUaGlzIHNob3VsZCBvbmx5IGJlIGNhbGxlZCBvbmNlIHBlciBpdGVtLlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IElmIHRoZSBpdGVtIGlzIGFsbG93ZWQgdG8gYmUgdXBsb2FkZWQuXG4gICAgICovXG4gICAgYWxsb3dlZFRvVXBsb2FkKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zTGVmdC0tID4gMDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVGV4dHVyZSwgQmFzZVRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFRpY2tlciwgVVBEQVRFX1BSSU9SSVRZIH0gZnJvbSAnQHBpeGkvdGlja2VyJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBEaXNwbGF5T2JqZWN0IH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBUZXh0LCBUZXh0U3R5bGUsIFRleHRNZXRyaWNzIH0gZnJvbSAnQHBpeGkvdGV4dCc7XG5pbXBvcnQgeyBDb3VudExpbWl0ZXIgfSBmcm9tICcuL0NvdW50TGltaXRlcic7XG5cbmltcG9ydCB0eXBlIHsgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5pbnRlcmZhY2UgSUFycm93RnVuY3Rpb24ge1xuICAgICgpOiB2b2lkO1xufVxuaW50ZXJmYWNlIElVcGxvYWRIb29rIHtcbiAgICAoaGVscGVyOiBBYnN0cmFjdFJlbmRlcmVyIHwgQmFzZVByZXBhcmUsIGl0ZW06IElEaXNwbGF5T2JqZWN0RXh0ZW5kZWQpOiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgSUZpbmRIb29rIHtcbiAgICAoaXRlbTogYW55LCBxdWV1ZTogQXJyYXk8YW55Pik6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSURpc3BsYXlPYmplY3RFeHRlbmRlZCBleHRlbmRzIERpc3BsYXlPYmplY3Qge1xuICAgIF90ZXh0dXJlcz86IEFycmF5PFRleHR1cmU+O1xuICAgIF90ZXh0dXJlPzogVGV4dHVyZTtcbiAgICBzdHlsZT86IFRleHRTdHlsZTtcbn1cblxuLyoqXG4gKiBCdWlsdC1pbiBob29rIHRvIGZpbmQgbXVsdGlwbGUgdGV4dHVyZXMgZnJvbSBvYmplY3RzIGxpa2UgQW5pbWF0ZWRTcHJpdGVzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge1BJWEkuRGlzcGxheU9iamVjdH0gaXRlbSAtIERpc3BsYXkgb2JqZWN0IHRvIGNoZWNrXG4gKiBAcGFyYW0ge0FycmF5PCo+fSBxdWV1ZSAtIENvbGxlY3Rpb24gb2YgaXRlbXMgdG8gdXBsb2FkXG4gKiBAcmV0dXJuIHtib29sZWFufSBpZiBhIFBJWEkuVGV4dHVyZSBvYmplY3Qgd2FzIGZvdW5kLlxuICovXG5cbmZ1bmN0aW9uIGZpbmRNdWx0aXBsZUJhc2VUZXh0dXJlcyhpdGVtOiBJRGlzcGxheU9iamVjdEV4dGVuZGVkLCBxdWV1ZTogQXJyYXk8YW55Pik6IGJvb2xlYW5cbntcbiAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XG5cbiAgICAvLyBPYmplY3RzIHdpdGggbXVsdGlwbGUgdGV4dHVyZXNcbiAgICBpZiAoaXRlbSAmJiBpdGVtLl90ZXh0dXJlcyAmJiBpdGVtLl90ZXh0dXJlcy5sZW5ndGgpXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW0uX3RleHR1cmVzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoaXRlbS5fdGV4dHVyZXNbaV0gaW5zdGFuY2VvZiBUZXh0dXJlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJhc2VUZXh0dXJlID0gaXRlbS5fdGV4dHVyZXNbaV0uYmFzZVRleHR1cmU7XG5cbiAgICAgICAgICAgICAgICBpZiAocXVldWUuaW5kZXhPZihiYXNlVGV4dHVyZSkgPT09IC0xKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaChiYXNlVGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBCdWlsdC1pbiBob29rIHRvIGZpbmQgQmFzZVRleHR1cmVzIGZyb20gVGV4dHVyZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLlRleHR1cmV9IGl0ZW0gLSBEaXNwbGF5IG9iamVjdCB0byBjaGVja1xuICogQHBhcmFtIHtBcnJheTwqPn0gcXVldWUgLSBDb2xsZWN0aW9uIG9mIGl0ZW1zIHRvIHVwbG9hZFxuICogQHJldHVybiB7Ym9vbGVhbn0gaWYgYSBQSVhJLlRleHR1cmUgb2JqZWN0IHdhcyBmb3VuZC5cbiAqL1xuZnVuY3Rpb24gZmluZEJhc2VUZXh0dXJlKGl0ZW06IFRleHR1cmUsIHF1ZXVlOiBBcnJheTxhbnk+KTogYm9vbGVhblxue1xuICAgIGlmIChpdGVtLmJhc2VUZXh0dXJlIGluc3RhbmNlb2YgQmFzZVRleHR1cmUpXG4gICAge1xuICAgICAgICBjb25zdCB0ZXh0dXJlID0gaXRlbS5iYXNlVGV4dHVyZTtcblxuICAgICAgICBpZiAocXVldWUuaW5kZXhPZih0ZXh0dXJlKSA9PT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHF1ZXVlLnB1c2godGV4dHVyZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQnVpbHQtaW4gaG9vayB0byBmaW5kIHRleHR1cmVzIGZyb20gb2JqZWN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGl0ZW0gLSBEaXNwbGF5IG9iamVjdCB0byBjaGVja1xuICogQHBhcmFtIHtBcnJheTwqPn0gcXVldWUgLSBDb2xsZWN0aW9uIG9mIGl0ZW1zIHRvIHVwbG9hZFxuICogQHJldHVybiB7Ym9vbGVhbn0gaWYgYSBQSVhJLlRleHR1cmUgb2JqZWN0IHdhcyBmb3VuZC5cbiAqL1xuZnVuY3Rpb24gZmluZFRleHR1cmUoaXRlbTogSURpc3BsYXlPYmplY3RFeHRlbmRlZCwgcXVldWU6IEFycmF5PGFueT4pOiBib29sZWFuXG57XG4gICAgaWYgKGl0ZW0uX3RleHR1cmUgJiYgaXRlbS5fdGV4dHVyZSBpbnN0YW5jZW9mIFRleHR1cmUpXG4gICAge1xuICAgICAgICBjb25zdCB0ZXh0dXJlID0gaXRlbS5fdGV4dHVyZS5iYXNlVGV4dHVyZTtcblxuICAgICAgICBpZiAocXVldWUuaW5kZXhPZih0ZXh0dXJlKSA9PT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHF1ZXVlLnB1c2godGV4dHVyZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQnVpbHQtaW4gaG9vayB0byBkcmF3IFBJWEkuVGV4dCB0byBpdHMgdGV4dHVyZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkFic3RyYWN0UmVuZGVyZXJ8UElYSS5CYXNlUHJlcGFyZX0gaGVscGVyIC0gTm90IHVzZWQgYnkgdGhpcyB1cGxvYWQgaGFuZGxlclxuICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGl0ZW0gLSBJdGVtIHRvIGNoZWNrXG4gKiBAcmV0dXJuIHtib29sZWFufSBJZiBpdGVtIHdhcyB1cGxvYWRlZC5cbiAqL1xuZnVuY3Rpb24gZHJhd1RleHQoX2hlbHBlcjogQWJzdHJhY3RSZW5kZXJlciB8IEJhc2VQcmVwYXJlLCBpdGVtOiBJRGlzcGxheU9iamVjdEV4dGVuZGVkKTogYm9vbGVhblxue1xuICAgIGlmIChpdGVtIGluc3RhbmNlb2YgVGV4dClcbiAgICB7XG4gICAgICAgIC8vIHVwZGF0aW5nIHRleHQgd2lsbCByZXR1cm4gZWFybHkgaWYgaXQgaXMgbm90IGRpcnR5XG4gICAgICAgIGl0ZW0udXBkYXRlVGV4dCh0cnVlKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQnVpbHQtaW4gaG9vayB0byBjYWxjdWxhdGUgYSB0ZXh0IHN0eWxlIGZvciBhIFBJWEkuVGV4dCBvYmplY3QuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7UElYSS5BYnN0cmFjdFJlbmRlcmVyfFBJWEkuQmFzZVByZXBhcmV9IGhlbHBlciAtIE5vdCB1c2VkIGJ5IHRoaXMgdXBsb2FkIGhhbmRsZXJcbiAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fSBpdGVtIC0gSXRlbSB0byBjaGVja1xuICogQHJldHVybiB7Ym9vbGVhbn0gSWYgaXRlbSB3YXMgdXBsb2FkZWQuXG4gKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZVRleHRTdHlsZShfaGVscGVyOiBBYnN0cmFjdFJlbmRlcmVyIHwgQmFzZVByZXBhcmUsIGl0ZW06IElEaXNwbGF5T2JqZWN0RXh0ZW5kZWQpOiBib29sZWFuXG57XG4gICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBUZXh0U3R5bGUpXG4gICAge1xuICAgICAgICBjb25zdCBmb250ID0gaXRlbS50b0ZvbnRTdHJpbmcoKTtcblxuICAgICAgICBUZXh0TWV0cmljcy5tZWFzdXJlRm9udChmb250KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQnVpbHQtaW4gaG9vayB0byBmaW5kIFRleHQgb2JqZWN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGl0ZW0gLSBEaXNwbGF5IG9iamVjdCB0byBjaGVja1xuICogQHBhcmFtIHtBcnJheTwqPn0gcXVldWUgLSBDb2xsZWN0aW9uIG9mIGl0ZW1zIHRvIHVwbG9hZFxuICogQHJldHVybiB7Ym9vbGVhbn0gaWYgYSBQSVhJLlRleHQgb2JqZWN0IHdhcyBmb3VuZC5cbiAqL1xuZnVuY3Rpb24gZmluZFRleHQoaXRlbTogSURpc3BsYXlPYmplY3RFeHRlbmRlZCwgcXVldWU6IEFycmF5PGFueT4pOiBib29sZWFuXG57XG4gICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBUZXh0KVxuICAgIHtcbiAgICAgICAgLy8gcHVzaCB0aGUgdGV4dCBzdHlsZSB0byBwcmVwYXJlIGl0IC0gdGhpcyBjYW4gYmUgcmVhbGx5IGV4cGVuc2l2ZVxuICAgICAgICBpZiAocXVldWUuaW5kZXhPZihpdGVtLnN0eWxlKSA9PT0gLTEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHF1ZXVlLnB1c2goaXRlbS5zdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWxzbyBwdXNoIHRoZSB0ZXh0IG9iamVjdCBzbyB0aGF0IHdlIGNhbiByZW5kZXIgaXQgKHRvIGNhbnZhcy90ZXh0dXJlKSBpZiBuZWVkZWRcbiAgICAgICAgaWYgKHF1ZXVlLmluZGV4T2YoaXRlbSkgPT09IC0xKVxuICAgICAgICB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFsc28gcHVzaCB0aGUgVGV4dCdzIHRleHR1cmUgZm9yIHVwbG9hZCB0byBHUFVcbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IGl0ZW0uX3RleHR1cmUuYmFzZVRleHR1cmU7XG5cbiAgICAgICAgaWYgKHF1ZXVlLmluZGV4T2YodGV4dHVyZSkgPT09IC0xKVxuICAgICAgICB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKHRleHR1cmUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEJ1aWx0LWluIGhvb2sgdG8gZmluZCBUZXh0U3R5bGUgb2JqZWN0cy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLlRleHRTdHlsZX0gaXRlbSAtIERpc3BsYXkgb2JqZWN0IHRvIGNoZWNrXG4gKiBAcGFyYW0ge0FycmF5PCo+fSBxdWV1ZSAtIENvbGxlY3Rpb24gb2YgaXRlbXMgdG8gdXBsb2FkXG4gKiBAcmV0dXJuIHtib29sZWFufSBpZiBhIFBJWEkuVGV4dFN0eWxlIG9iamVjdCB3YXMgZm91bmQuXG4gKi9cbmZ1bmN0aW9uIGZpbmRUZXh0U3R5bGUoaXRlbTogVGV4dFN0eWxlLCBxdWV1ZTogQXJyYXk8YW55Pik6IGJvb2xlYW5cbntcbiAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIFRleHRTdHlsZSlcbiAgICB7XG4gICAgICAgIGlmIChxdWV1ZS5pbmRleE9mKGl0ZW0pID09PSAtMSlcbiAgICAgICAge1xuICAgICAgICAgICAgcXVldWUucHVzaChpdGVtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBUaGUgcHJlcGFyZSBtYW5hZ2VyIHByb3ZpZGVzIGZ1bmN0aW9uYWxpdHkgdG8gdXBsb2FkIGNvbnRlbnQgdG8gdGhlIEdQVS5cbiAqXG4gKiBCYXNlUHJlcGFyZSBoYW5kbGVzIGJhc2ljIHF1ZXVpbmcgZnVuY3Rpb25hbGl0eSBhbmQgaXMgZXh0ZW5kZWQgYnlcbiAqIHtAbGluayBQSVhJLlByZXBhcmV9IGFuZCB7QGxpbmsgUElYSS5DYW52YXNQcmVwYXJlfVxuICogdG8gcHJvdmlkZSBwcmVwYXJhdGlvbiBjYXBhYmlsaXRpZXMgc3BlY2lmaWMgdG8gdGhlaXIgcmVzcGVjdGl2ZSByZW5kZXJlcnMuXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENyZWF0ZSBhIHNwcml0ZVxuICogY29uc3Qgc3ByaXRlID0gUElYSS5TcHJpdGUuZnJvbSgnc29tZXRoaW5nLnBuZycpO1xuICpcbiAqIC8vIExvYWQgb2JqZWN0IGludG8gR1BVXG4gKiBhcHAucmVuZGVyZXIucGx1Z2lucy5wcmVwYXJlLnVwbG9hZChzcHJpdGUsICgpID0+IHtcbiAqXG4gKiAgICAgLy9UZXh0dXJlKHMpIGhhcyBiZWVuIHVwbG9hZGVkIHRvIEdQVVxuICogICAgIGFwcC5zdGFnZS5hZGRDaGlsZChzcHJpdGUpO1xuICpcbiAqIH0pXG4gKlxuICogQGFic3RyYWN0XG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBCYXNlUHJlcGFyZVxue1xuICAgIHByaXZhdGUgbGltaXRlcjogQ291bnRMaW1pdGVyO1xuICAgIHByb3RlY3RlZCByZW5kZXJlcjogQWJzdHJhY3RSZW5kZXJlcjtcbiAgICBwcm90ZWN0ZWQgdXBsb2FkSG9va0hlbHBlcjogYW55O1xuICAgIHByb3RlY3RlZCBxdWV1ZTogQXJyYXk8YW55PjtcbiAgICBwdWJsaWMgYWRkSG9va3M6IEFycmF5PGFueT47XG4gICAgcHVibGljIHVwbG9hZEhvb2tzOiBBcnJheTxhbnk+O1xuICAgIHB1YmxpYyBjb21wbGV0ZXM6IEFycmF5PGFueT47XG4gICAgcHVibGljIHRpY2tpbmc6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBkZWxheWVkVGljazogSUFycm93RnVuY3Rpb247XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLkFic3RyYWN0UmVuZGVyZXJ9IHJlbmRlcmVyIC0gQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogQWJzdHJhY3RSZW5kZXJlcilcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbGltaXRlciB0byBiZSB1c2VkIHRvIGNvbnRyb2wgaG93IHF1aWNrbHkgaXRlbXMgYXJlIHByZXBhcmVkLlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5Db3VudExpbWl0ZXJ8UElYSS5UaW1lTGltaXRlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGltaXRlciA9IG5ldyBDb3VudExpbWl0ZXIoc2V0dGluZ3MuVVBMT0FEU19QRVJfRlJBTUUpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHJlbmRlcmVyLlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5BYnN0cmFjdFJlbmRlcmVyfVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBvbmx5IHJlYWwgZGlmZmVyZW5jZSBiZXR3ZWVuIENhbnZhc1ByZXBhcmUgYW5kIFByZXBhcmUgaXMgd2hhdCB0aGV5IHBhc3NcbiAgICAgICAgICogdG8gdXBsb2FkIGhvb2tzLiBUaGF0IGRpZmZlcmVudCBwYXJhbWV0ZXIgaXMgc3RvcmVkIGhlcmUuXG4gICAgICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXBsb2FkSG9va0hlbHBlciA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbGxlY3Rpb24gb2YgaXRlbXMgdG8gdXBsb2FkcyBhdCBvbmNlLlxuICAgICAgICAgKiBAdHlwZSB7QXJyYXk8Kj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnF1ZXVlID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbGxlY3Rpb24gb2YgYWRkaXRpb25hbCBob29rcyBmb3IgZmluZGluZyBhc3NldHMuXG4gICAgICAgICAqIEB0eXBlIHtBcnJheTxGdW5jdGlvbj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFkZEhvb2tzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbGxlY3Rpb24gb2YgYWRkaXRpb25hbCBob29rcyBmb3IgcHJvY2Vzc2luZyBhc3NldHMuXG4gICAgICAgICAqIEB0eXBlIHtBcnJheTxGdW5jdGlvbj59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVwbG9hZEhvb2tzID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhbGxiYWNrIHRvIGNhbGwgYWZ0ZXIgY29tcGxldGVkLlxuICAgICAgICAgKiBAdHlwZSB7QXJyYXk8RnVuY3Rpb24+fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb21wbGV0ZXMgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgcHJlcGFyZSBpcyB0aWNraW5nIChydW5uaW5nKS5cbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRpY2tpbmcgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogJ2JvdW5kJyBjYWxsIGZvciBwcmVwYXJlSXRlbXMoKS5cbiAgICAgICAgICogQHR5cGUge0Z1bmN0aW9ufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWxheWVkVGljayA9ICgpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHVubGlrZWx5LCBidXQgaW4gY2FzZSB3ZSB3ZXJlIGRlc3Ryb3llZCBiZXR3ZWVuIHRpY2soKSBhbmQgZGVsYXllZFRpY2soKVxuICAgICAgICAgICAgaWYgKCF0aGlzLnF1ZXVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJlcGFyZUl0ZW1zKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gaG9va3MgdG8gZmluZCB0aGUgY29ycmVjdCB0ZXh0dXJlXG4gICAgICAgIHRoaXMucmVnaXN0ZXJGaW5kSG9vayhmaW5kVGV4dCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJGaW5kSG9vayhmaW5kVGV4dFN0eWxlKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckZpbmRIb29rKGZpbmRNdWx0aXBsZUJhc2VUZXh0dXJlcyk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJGaW5kSG9vayhmaW5kQmFzZVRleHR1cmUpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRmluZEhvb2soZmluZFRleHR1cmUpO1xuXG4gICAgICAgIC8vIHVwbG9hZCBob29rc1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVXBsb2FkSG9vayhkcmF3VGV4dCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJVcGxvYWRIb29rKGNhbGN1bGF0ZVRleHRTdHlsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBsb2FkIGFsbCB0aGUgdGV4dHVyZXMgYW5kIGdyYXBoaWNzIHRvIHRoZSBHUFUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFBJWEkuRGlzcGxheU9iamVjdHxQSVhJLkNvbnRhaW5lcnxQSVhJLkJhc2VUZXh0dXJlfFBJWEkuVGV4dHVyZXxQSVhJLkdyYXBoaWNzfFBJWEkuVGV4dH0gaXRlbSAtXG4gICAgICogICAgICAgIEVpdGhlciB0aGUgY29udGFpbmVyIG9yIGRpc3BsYXkgb2JqZWN0IHRvIHNlYXJjaCBmb3IgaXRlbXMgdG8gdXBsb2FkLCB0aGUgaXRlbXMgdG8gdXBsb2FkIHRoZW1zZWx2ZXMsXG4gICAgICogICAgICAgIG9yIHRoZSBjYWxsYmFjayBmdW5jdGlvbiwgaWYgaXRlbXMgaGF2ZSBiZWVuIGFkZGVkIHVzaW5nIGBwcmVwYXJlLmFkZGAuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2RvbmVdIC0gT3B0aW9uYWwgY2FsbGJhY2sgd2hlbiBhbGwgcXVldWVkIHVwbG9hZHMgaGF2ZSBjb21wbGV0ZWRcbiAgICAgKi9cbiAgICB1cGxvYWQoaXRlbTogSURpc3BsYXlPYmplY3RFeHRlbmRlZCB8IElVcGxvYWRIb29rIHwgSUZpbmRIb29rIHwgKCgpID0+IHZvaWQpLCBkb25lOiAoKSA9PiB2b2lkKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnZnVuY3Rpb24nKVxuICAgICAgICB7XG4gICAgICAgICAgICBkb25lID0gaXRlbSBhcyAoKSA9PiB2b2lkO1xuICAgICAgICAgICAgaXRlbSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBhIGRpc3BsYXkgb2JqZWN0LCBzZWFyY2ggZm9yIGl0ZW1zXG4gICAgICAgIC8vIHRoYXQgd2UgY291bGQgdXBsb2FkXG4gICAgICAgIGlmIChpdGVtKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFkZChpdGVtIGFzIElEaXNwbGF5T2JqZWN0RXh0ZW5kZWQgfCBJVXBsb2FkSG9vayB8IElGaW5kSG9vayk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgdGhlIGl0ZW1zIGZvciB1cGxvYWQgZnJvbSB0aGUgZGlzcGxheVxuICAgICAgICBpZiAodGhpcy5xdWV1ZS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChkb25lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcGxldGVzLnB1c2goZG9uZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGhpcy50aWNraW5nKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMudGlja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgVGlja2VyLnN5c3RlbS5hZGRPbmNlKHRoaXMudGljaywgdGhpcywgVVBEQVRFX1BSSU9SSVRZLlVUSUxJVFkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRvbmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aWNrIHVwZGF0ZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aWNrKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHNldFRpbWVvdXQodGhpcy5kZWxheWVkVGljaywgMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWN0dWFsbHkgcHJlcGFyZSBpdGVtcy4gVGhpcyBpcyBoYW5kbGVkIG91dHNpZGUgb2YgdGhlIHRpY2sgYmVjYXVzZSBpdCB3aWxsIHRha2UgYSB3aGlsZVxuICAgICAqIGFuZCB3ZSBkbyBOT1Qgd2FudCB0byBibG9jayB0aGUgY3VycmVudCBhbmltYXRpb24gZnJhbWUgZnJvbSByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByZXBhcmVJdGVtcygpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmxpbWl0ZXIuYmVnaW5GcmFtZSgpO1xuICAgICAgICAvLyBVcGxvYWQgdGhlIGdyYXBoaWNzXG4gICAgICAgIHdoaWxlICh0aGlzLnF1ZXVlLmxlbmd0aCAmJiB0aGlzLmxpbWl0ZXIuYWxsb3dlZFRvVXBsb2FkKCkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnF1ZXVlWzBdO1xuICAgICAgICAgICAgbGV0IHVwbG9hZGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmIChpdGVtICYmICFpdGVtLl9kZXN0cm95ZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHRoaXMudXBsb2FkSG9va3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cGxvYWRIb29rc1tpXSh0aGlzLnVwbG9hZEhvb2tIZWxwZXIsIGl0ZW0pKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF1cGxvYWRlZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBXZSdyZSBmaW5pc2hlZFxuICAgICAgICBpZiAoIXRoaXMucXVldWUubGVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnRpY2tpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgY29uc3QgY29tcGxldGVzID0gdGhpcy5jb21wbGV0ZXMuc2xpY2UoMCk7XG5cbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVzLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBjb21wbGV0ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tcGxldGVzW2ldKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBhcmUgbm90IGZpbmlzaGVkLCBvbiB0aGUgbmV4dCByQUYgZG8gdGhpcyBhZ2FpblxuICAgICAgICAgICAgVGlja2VyLnN5c3RlbS5hZGRPbmNlKHRoaXMudGljaywgdGhpcywgVVBEQVRFX1BSSU9SSVRZLlVUSUxJVFkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBob29rcyBmb3IgZmluZGluZyBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFkZEhvb2sgLSBGdW5jdGlvbiBjYWxsIHRoYXQgdGFrZXMgdHdvIHBhcmFtZXRlcnM6IGBpdGVtOiosIHF1ZXVlOkFycmF5YFxuICAgICAqICAgICAgICAgIGZ1bmN0aW9uIG11c3QgcmV0dXJuIGB0cnVlYCBpZiBpdCB3YXMgYWJsZSB0byBhZGQgaXRlbSB0byB0aGUgcXVldWUuXG4gICAgICogQHJldHVybiB7dGhpc30gSW5zdGFuY2Ugb2YgcGx1Z2luIGZvciBjaGFpbmluZy5cbiAgICAgKi9cbiAgICByZWdpc3RlckZpbmRIb29rKGFkZEhvb2s6IElGaW5kSG9vayk6IHRoaXNcbiAgICB7XG4gICAgICAgIGlmIChhZGRIb29rKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmFkZEhvb2tzLnB1c2goYWRkSG9vayk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGhvb2tzIGZvciB1cGxvYWRpbmcgaXRlbXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB1cGxvYWRIb29rIC0gRnVuY3Rpb24gY2FsbCB0aGF0IHRha2VzIHR3byBwYXJhbWV0ZXJzOiBgcHJlcGFyZTpDYW52YXNQcmVwYXJlLCBpdGVtOipgIGFuZFxuICAgICAqICAgICAgICAgIGZ1bmN0aW9uIG11c3QgcmV0dXJuIGB0cnVlYCBpZiBpdCB3YXMgYWJsZSB0byBoYW5kbGUgdXBsb2FkIG9mIGl0ZW0uXG4gICAgICogQHJldHVybiB7dGhpc30gSW5zdGFuY2Ugb2YgcGx1Z2luIGZvciBjaGFpbmluZy5cbiAgICAgKi9cbiAgICByZWdpc3RlclVwbG9hZEhvb2sodXBsb2FkSG9vazogSVVwbG9hZEhvb2spOiB0aGlzXG4gICAge1xuICAgICAgICBpZiAodXBsb2FkSG9vaylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51cGxvYWRIb29rcy5wdXNoKHVwbG9hZEhvb2spO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFudWFsbHkgYWRkIGFuIGl0ZW0gdG8gdGhlIHVwbG9hZGluZyBxdWV1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5EaXNwbGF5T2JqZWN0fFBJWEkuQ29udGFpbmVyfFBJWEkuQmFzZVRleHR1cmV8UElYSS5UZXh0dXJlfFBJWEkuR3JhcGhpY3N8UElYSS5UZXh0fCp9IGl0ZW0gLSBPYmplY3QgdG9cbiAgICAgKiAgICAgICAgYWRkIHRvIHRoZSBxdWV1ZVxuICAgICAqIEByZXR1cm4ge3RoaXN9IEluc3RhbmNlIG9mIHBsdWdpbiBmb3IgY2hhaW5pbmcuXG4gICAgICovXG4gICAgYWRkKGl0ZW06IElEaXNwbGF5T2JqZWN0RXh0ZW5kZWQgfCBJVXBsb2FkSG9vayB8IElGaW5kSG9vayk6IHRoaXNcbiAgICB7XG4gICAgICAgIC8vIEFkZCBhZGRpdGlvbmFsIGhvb2tzIGZvciBmaW5kaW5nIGVsZW1lbnRzIG9uIHNwZWNpYWxcbiAgICAgICAgLy8gdHlwZXMgb2Ygb2JqZWN0cyB0aGF0XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmFkZEhvb2tzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRIb29rc1tpXShpdGVtLCB0aGlzLnF1ZXVlKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBjaGlsZHJlbiByZWN1cnNpdmVseVxuICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIENvbnRhaW5lcilcbiAgICAgICAge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGl0ZW0uY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGQoaXRlbS5jaGlsZHJlbltpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgcGx1Z2luLCBkb24ndCB1c2UgYWZ0ZXIgdGhpcy5cbiAgICAgKlxuICAgICAqL1xuICAgIGRlc3Ryb3koKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMudGlja2luZylcbiAgICAgICAge1xuICAgICAgICAgICAgVGlja2VyLnN5c3RlbS5yZW1vdmUodGhpcy50aWNrLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRpY2tpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hZGRIb29rcyA9IG51bGw7XG4gICAgICAgIHRoaXMudXBsb2FkSG9va3MgPSBudWxsO1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb21wbGV0ZXMgPSBudWxsO1xuICAgICAgICB0aGlzLnF1ZXVlID0gbnVsbDtcbiAgICAgICAgdGhpcy5saW1pdGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy51cGxvYWRIb29rSGVscGVyID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQmFzZVRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IEdyYXBoaWNzIH0gZnJvbSAnQHBpeGkvZ3JhcGhpY3MnO1xuaW1wb3J0IHsgQmFzZVByZXBhcmUsIElEaXNwbGF5T2JqZWN0RXh0ZW5kZWQgfSBmcm9tICcuL0Jhc2VQcmVwYXJlJztcblxuaW1wb3J0IHR5cGUgeyBBYnN0cmFjdFJlbmRlcmVyLCBSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG4vKipcbiAqIEJ1aWx0LWluIGhvb2sgdG8gdXBsb2FkIFBJWEkuVGV4dHVyZSBvYmplY3RzIHRvIHRoZSBHUFUuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBpbnN0YW5jZSBvZiB0aGUgd2ViZ2wgcmVuZGVyZXJcbiAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZX0gaXRlbSAtIEl0ZW0gdG8gY2hlY2tcbiAqIEByZXR1cm4ge2Jvb2xlYW59IElmIGl0ZW0gd2FzIHVwbG9hZGVkLlxuICovXG5mdW5jdGlvbiB1cGxvYWRCYXNlVGV4dHVyZXMocmVuZGVyZXI6IEFic3RyYWN0UmVuZGVyZXIgfCBCYXNlUHJlcGFyZSwgaXRlbTogSURpc3BsYXlPYmplY3RFeHRlbmRlZCB8IEJhc2VUZXh0dXJlKTogYm9vbGVhblxue1xuICAgIGlmIChpdGVtIGluc3RhbmNlb2YgQmFzZVRleHR1cmUpXG4gICAge1xuICAgICAgICAvLyBpZiB0aGUgdGV4dHVyZSBhbHJlYWR5IGhhcyBhIEdMIHRleHR1cmUsIHRoZW4gdGhlIHRleHR1cmUgaGFzIGJlZW4gcHJlcGFyZWQgb3IgcmVuZGVyZWRcbiAgICAgICAgLy8gYmVmb3JlIG5vdy4gSWYgdGhlIHRleHR1cmUgY2hhbmdlZCwgdGhlbiB0aGUgY2hhbmdlciBzaG91bGQgYmUgY2FsbGluZyB0ZXh0dXJlLnVwZGF0ZSgpIHdoaWNoXG4gICAgICAgIC8vIHJldXBsb2FkcyB0aGUgdGV4dHVyZSB3aXRob3V0IG5lZWQgZm9yIHByZXBhcmluZyBpdCBhZ2FpblxuICAgICAgICBpZiAoIWl0ZW0uX2dsVGV4dHVyZXNbKHJlbmRlcmVyIGFzIFJlbmRlcmVyKS5DT05URVhUX1VJRF0pXG4gICAgICAgIHtcbiAgICAgICAgICAgIChyZW5kZXJlciBhcyBSZW5kZXJlcikudGV4dHVyZS5iaW5kKGl0ZW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEJ1aWx0LWluIGhvb2sgdG8gdXBsb2FkIFBJWEkuR3JhcGhpY3MgdG8gdGhlIEdQVS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIGluc3RhbmNlIG9mIHRoZSB3ZWJnbCByZW5kZXJlclxuICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGl0ZW0gLSBJdGVtIHRvIGNoZWNrXG4gKiBAcmV0dXJuIHtib29sZWFufSBJZiBpdGVtIHdhcyB1cGxvYWRlZC5cbiAqL1xuZnVuY3Rpb24gdXBsb2FkR3JhcGhpY3MocmVuZGVyZXI6IEFic3RyYWN0UmVuZGVyZXIgfCBCYXNlUHJlcGFyZSwgaXRlbTogSURpc3BsYXlPYmplY3RFeHRlbmRlZCk6IGJvb2xlYW5cbntcbiAgICBpZiAoIShpdGVtIGluc3RhbmNlb2YgR3JhcGhpY3MpKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZ2VvbWV0cnkgfSA9IGl0ZW07XG5cbiAgICAvLyB1cGRhdGUgZGlydHkgZ3JhcGhpY3MgdG8gZ2V0IGJhdGNoZXNcbiAgICBpdGVtLmZpbmlzaFBvbHkoKTtcbiAgICBnZW9tZXRyeS51cGRhdGVCYXRjaGVzKCk7XG5cbiAgICBjb25zdCB7IGJhdGNoZXMgfSA9IGdlb21ldHJ5O1xuXG4gICAgLy8gdXBsb2FkIGFsbCB0ZXh0dXJlcyBmb3VuZCBpbiBzdHlsZXNcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhdGNoZXMubGVuZ3RoOyBpKyspXG4gICAge1xuICAgICAgICBjb25zdCB7IHRleHR1cmUgfSA9IGJhdGNoZXNbaV0uc3R5bGU7XG5cbiAgICAgICAgaWYgKHRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHVwbG9hZEJhc2VUZXh0dXJlcyhyZW5kZXJlciwgdGV4dHVyZS5iYXNlVGV4dHVyZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpZiBpdHMgbm90IGJhdGNoYWJsZSAtIHVwZGF0ZSB2YW8gZm9yIHBhcnRpY3VsYXIgc2hhZGVyXG4gICAgaWYgKCFnZW9tZXRyeS5iYXRjaGFibGUpXG4gICAge1xuICAgICAgICAocmVuZGVyZXIgYXMgUmVuZGVyZXIpLmdlb21ldHJ5LmJpbmQoZ2VvbWV0cnksIChpdGVtIGFzIGFueSkuX3Jlc29sdmVEaXJlY3RTaGFkZXIoKHJlbmRlcmVyIGFzIFJlbmRlcmVyKSkpO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEJ1aWx0LWluIGhvb2sgdG8gZmluZCBncmFwaGljcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtQSVhJLkRpc3BsYXlPYmplY3R9IGl0ZW0gLSBEaXNwbGF5IG9iamVjdCB0byBjaGVja1xuICogQHBhcmFtIHtBcnJheTwqPn0gcXVldWUgLSBDb2xsZWN0aW9uIG9mIGl0ZW1zIHRvIHVwbG9hZFxuICogQHJldHVybiB7Ym9vbGVhbn0gaWYgYSBQSVhJLkdyYXBoaWNzIG9iamVjdCB3YXMgZm91bmQuXG4gKi9cbmZ1bmN0aW9uIGZpbmRHcmFwaGljcyhpdGVtOiBJRGlzcGxheU9iamVjdEV4dGVuZGVkLCBxdWV1ZTogQXJyYXk8YW55Pik6IGJvb2xlYW5cbntcbiAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEdyYXBoaWNzKVxuICAgIHtcbiAgICAgICAgcXVldWUucHVzaChpdGVtKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogVGhlIHByZXBhcmUgcGx1Z2luIHByb3ZpZGVzIHJlbmRlcmVyLXNwZWNpZmljIHBsdWdpbnMgZm9yIHByZS1yZW5kZXJpbmcgRGlzcGxheU9iamVjdHMuIFRoZXNlIHBsdWdpbnMgYXJlIHVzZWZ1bCBmb3JcbiAqIGFzeW5jaHJvbm91c2x5IHByZXBhcmluZyBhbmQgdXBsb2FkaW5nIHRvIHRoZSBHUFUgYXNzZXRzLCB0ZXh0dXJlcywgZ3JhcGhpY3Mgd2FpdGluZyB0byBiZSBkaXNwbGF5ZWQuXG4gKlxuICogRG8gbm90IGluc3RhbnRpYXRlIHRoaXMgcGx1Z2luIGRpcmVjdGx5LiBJdCBpcyBhdmFpbGFibGUgZnJvbSB0aGUgYHJlbmRlcmVyLnBsdWdpbnNgIHByb3BlcnR5LlxuICogU2VlIHtAbGluayBQSVhJLkNhbnZhc1JlbmRlcmVyI3BsdWdpbnN9IG9yIHtAbGluayBQSVhJLlJlbmRlcmVyI3BsdWdpbnN9LlxuICogQGV4YW1wbGVcbiAqIC8vIENyZWF0ZSBhIG5ldyBhcHBsaWNhdGlvblxuICogY29uc3QgYXBwID0gbmV3IFBJWEkuQXBwbGljYXRpb24oKTtcbiAqIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYXBwLnZpZXcpO1xuICpcbiAqIC8vIERvbid0IHN0YXJ0IHJlbmRlcmluZyByaWdodCBhd2F5XG4gKiBhcHAuc3RvcCgpO1xuICpcbiAqIC8vIGNyZWF0ZSBhIGRpc3BsYXkgb2JqZWN0XG4gKiBjb25zdCByZWN0ID0gbmV3IFBJWEkuR3JhcGhpY3MoKVxuICogICAgIC5iZWdpbkZpbGwoMHgwMGZmMDApXG4gKiAgICAgLmRyYXdSZWN0KDQwLCA0MCwgMjAwLCAyMDApO1xuICpcbiAqIC8vIEFkZCB0byB0aGUgc3RhZ2VcbiAqIGFwcC5zdGFnZS5hZGRDaGlsZChyZWN0KTtcbiAqXG4gKiAvLyBEb24ndCBzdGFydCByZW5kZXJpbmcgdW50aWwgdGhlIGdyYXBoaWMgaXMgdXBsb2FkZWQgdG8gdGhlIEdQVVxuICogYXBwLnJlbmRlcmVyLnBsdWdpbnMucHJlcGFyZS51cGxvYWQoYXBwLnN0YWdlLCAoKSA9PiB7XG4gKiAgICAgYXBwLnN0YXJ0KCk7XG4gKiB9KTtcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQmFzZVByZXBhcmVcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBQcmVwYXJlIGV4dGVuZHMgQmFzZVByZXBhcmVcbntcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgdGhpcy51cGxvYWRIb29rSGVscGVyID0gdGhpcy5yZW5kZXJlcjtcblxuICAgICAgICAvLyBBZGQgdGV4dHVyZXMgYW5kIGdyYXBoaWNzIHRvIHVwbG9hZFxuICAgICAgICB0aGlzLnJlZ2lzdGVyRmluZEhvb2soZmluZEdyYXBoaWNzKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclVwbG9hZEhvb2sodXBsb2FkQmFzZVRleHR1cmVzKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclVwbG9hZEhvb2sodXBsb2FkR3JhcGhpY3MpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIFRpbWVMaW1pdGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGl0ZW1zIGhhbmRsZWQgYnkgYSB7QGxpbmsgUElYSS5CYXNlUHJlcGFyZX0gdG8gYSBzcGVjaWZpZWRcbiAqIG51bWJlciBvZiBtaWxsaXNlY29uZHMgcGVyIGZyYW1lLlxuICpcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFRpbWVMaW1pdGVyXG57XG4gICAgcHVibGljIG1heE1pbGxpc2Vjb25kczogbnVtYmVyO1xuICAgIHB1YmxpYyBmcmFtZVN0YXJ0OiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1heE1pbGxpc2Vjb25kcyAtIFRoZSBtYXhpbXVtIG1pbGxpc2Vjb25kcyB0aGF0IGNhbiBiZSBzcGVudCBwcmVwYXJpbmcgaXRlbXMgZWFjaCBmcmFtZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihtYXhNaWxsaXNlY29uZHM6IG51bWJlcilcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWF4aW11bSBtaWxsaXNlY29uZHMgdGhhdCBjYW4gYmUgc3BlbnQgcHJlcGFyaW5nIGl0ZW1zIGVhY2ggZnJhbWUuXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1heE1pbGxpc2Vjb25kcyA9IG1heE1pbGxpc2Vjb25kcztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzdGFydCB0aW1lIG9mIHRoZSBjdXJyZW50IGZyYW1lLlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mcmFtZVN0YXJ0ID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgYW55IGNvdW50aW5nIHByb3BlcnRpZXMgdG8gc3RhcnQgZnJlc2ggb24gYSBuZXcgZnJhbWUuXG4gICAgICovXG4gICAgYmVnaW5GcmFtZSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLmZyYW1lU3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0byBzZWUgaWYgYW5vdGhlciBpdGVtIGNhbiBiZSB1cGxvYWRlZC4gVGhpcyBzaG91bGQgb25seSBiZSBjYWxsZWQgb25jZSBwZXIgaXRlbS5cbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBJZiB0aGUgaXRlbSBpcyBhbGxvd2VkIHRvIGJlIHVwbG9hZGVkLlxuICAgICAqL1xuICAgIGFsbG93ZWRUb1VwbG9hZCgpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIHRoaXMuZnJhbWVTdGFydCA8IHRoaXMubWF4TWlsbGlzZWNvbmRzO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IFRleHR1cmUsIEJhc2VUZXh0dXJlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBnZXRSZXNvbHV0aW9uT2ZVcmwgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IHJlc291cmNlcyB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnREYXRhIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgSlNPTiBkYXRhIGZvciBhIHNwcml0ZXNoZWV0IGF0bGFzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElTcHJpdGVzaGVldEZyYW1lRGF0YSB7XG4gICAgZnJhbWU6IHtcbiAgICAgICAgeDogbnVtYmVyO1xuICAgICAgICB5OiBudW1iZXI7XG4gICAgICAgIHc6IG51bWJlcjtcbiAgICAgICAgaDogbnVtYmVyO1xuICAgIH07XG4gICAgdHJpbW1lZD86IGJvb2xlYW47XG4gICAgcm90YXRlZD86IGJvb2xlYW47XG4gICAgc291cmNlU2l6ZT86IHtcbiAgICAgICAgdzogbnVtYmVyO1xuICAgICAgICBoOiBudW1iZXI7XG4gICAgfTtcbiAgICBzcHJpdGVTb3VyY2VTaXplPzoge1xuICAgICAgICB4OiBudW1iZXI7XG4gICAgICAgIHk6IG51bWJlcjtcbiAgICB9O1xuICAgIGFuY2hvcj86IElQb2ludERhdGE7XG59XG5cbi8qKlxuICogQXRsYXMgZm9ybWF0LlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElTcHJpdGVzaGVldERhdGEge1xuICAgIGZyYW1lczogRGljdDxJU3ByaXRlc2hlZXRGcmFtZURhdGE+O1xuICAgIGFuaW1hdGlvbnM/OiBEaWN0PHN0cmluZ1tdPjtcbiAgICBtZXRhOiB7XG4gICAgICAgIHNjYWxlOiBzdHJpbmc7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBVdGlsaXR5IGNsYXNzIGZvciBtYWludGFpbmluZyByZWZlcmVuY2UgdG8gYSBjb2xsZWN0aW9uXG4gKiBvZiBUZXh0dXJlcyBvbiBhIHNpbmdsZSBTcHJpdGVzaGVldC5cbiAqXG4gKiBUbyBhY2Nlc3MgYSBzcHJpdGUgc2hlZXQgZnJvbSB5b3VyIGNvZGUgcGFzcyBpdHMgSlNPTiBkYXRhIGZpbGUgdG8gUGl4aSdzIGxvYWRlcjpcbiAqXG4gKiBgYGBqc1xuICogUElYSS5Mb2FkZXIuc2hhcmVkLmFkZChcImltYWdlcy9zcHJpdGVzaGVldC5qc29uXCIpLmxvYWQoc2V0dXApO1xuICpcbiAqIGZ1bmN0aW9uIHNldHVwKCkge1xuICogICBsZXQgc2hlZXQgPSBQSVhJLkxvYWRlci5zaGFyZWQucmVzb3VyY2VzW1wiaW1hZ2VzL3Nwcml0ZXNoZWV0Lmpzb25cIl0uc3ByaXRlc2hlZXQ7XG4gKiAgIC4uLlxuICogfVxuICogYGBgXG4gKiBXaXRoIHRoZSBgc2hlZXQudGV4dHVyZXNgIHlvdSBjYW4gY3JlYXRlIFNwcml0ZSBvYmplY3RzLGBzaGVldC5hbmltYXRpb25zYCBjYW4gYmUgdXNlZCB0byBjcmVhdGUgYW4gQW5pbWF0ZWRTcHJpdGUuXG4gKlxuICogU3ByaXRlIHNoZWV0cyBjYW4gYmUgcGFja2VkIHVzaW5nIHRvb2xzIGxpa2Uge0BsaW5rIGh0dHBzOi8vY29kZWFuZHdlYi5jb20vdGV4dHVyZXBhY2tlcnxUZXh0dXJlUGFja2VyfSxcbiAqIHtAbGluayBodHRwczovL3JlbmRlcmhqcy5uZXQvc2hvZWJveC98U2hvZWJveH0gb3Ige0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9rcnp5c3p0b2Ytby9zcHJpdGVzaGVldC5qc3xTcHJpdGVzaGVldC5qc30uXG4gKiBEZWZhdWx0IGFuY2hvciBwb2ludHMgKHNlZSB7QGxpbmsgUElYSS5UZXh0dXJlI2RlZmF1bHRBbmNob3J9KSBhbmQgZ3JvdXBpbmcgb2YgYW5pbWF0aW9uIHNwcml0ZXMgYXJlIGN1cnJlbnRseSBvbmx5XG4gKiBzdXBwb3J0ZWQgYnkgVGV4dHVyZVBhY2tlci5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJpdGVzaGVldFxue1xuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBUZXh0dXJlcyB0byBidWlsZCBwZXIgcHJvY2Vzcy5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMTAwMFxuICAgICAqL1xuICAgIHN0YXRpYyByZWFkb25seSBCQVRDSF9TSVpFID0gMTAwMDtcblxuICAgIHB1YmxpYyBiYXNlVGV4dHVyZTogQmFzZVRleHR1cmU7XG4gICAgcHVibGljIHRleHR1cmVzOiBEaWN0PFRleHR1cmU+O1xuICAgIHB1YmxpYyBhbmltYXRpb25zOiBEaWN0PFRleHR1cmVbXT47XG4gICAgcHVibGljIGRhdGE6IElTcHJpdGVzaGVldERhdGE7XG4gICAgcHVibGljIHJlc29sdXRpb246IG51bWJlcjtcblxuICAgIHByaXZhdGUgX3RleHR1cmU6IFRleHR1cmU7XG4gICAgcHJpdmF0ZSBfZnJhbWVzOiBEaWN0PElTcHJpdGVzaGVldEZyYW1lRGF0YT47XG4gICAgcHJpdmF0ZSBfZnJhbWVLZXlzOiBzdHJpbmdbXTtcbiAgICBwcml2YXRlIF9iYXRjaEluZGV4OiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfY2FsbGJhY2s6ICh0ZXh0dXJlczogRGljdDxUZXh0dXJlPikgPT4gdm9pZDtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5CYXNlVGV4dHVyZXxQSVhJLlRleHR1cmV9IGJhc2VUZXh0dXJlIC0gUmVmZXJlbmNlIHRvIHRoZSBzb3VyY2UgQmFzZVRleHR1cmUgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gU3ByaXRlc2hlZXQgaW1hZ2UgZGF0YS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Jlc29sdXRpb25GaWxlbmFtZV0gLSBUaGUgZmlsZW5hbWUgdG8gY29uc2lkZXIgd2hlbiBkZXRlcm1pbmluZ1xuICAgICAqICAgICAgICB0aGUgcmVzb2x1dGlvbiBvZiB0aGUgc3ByaXRlc2hlZXQuIElmIG5vdCBwcm92aWRlZCwgdGhlIGltYWdlVXJsIHdpbGxcbiAgICAgKiAgICAgICAgYmUgdXNlZCBvbiB0aGUgQmFzZVRleHR1cmUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodGV4dHVyZTogQmFzZVRleHR1cmUgfCBUZXh0dXJlLCBkYXRhOiBJU3ByaXRlc2hlZXREYXRhLCByZXNvbHV0aW9uRmlsZW5hbWU6IHN0cmluZyA9IG51bGwpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIG9yaWdpbmFsIHNvdXJjZSBpbWFnZSBmcm9tIHRoZSBMb2FkZXIuIFRoaXMgcmVmZXJlbmNlIGlzIHJldGFpbmVkIHNvIHdlXG4gICAgICAgICAqIGNhbiBkZXN0cm95IHRoZSBUZXh0dXJlIGxhdGVyIG9uLiBJdCBpcyBuZXZlciB1c2VkIGludGVybmFsbHkuXG4gICAgICAgICAqIEB0eXBlIHtQSVhJLlRleHR1cmV9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90ZXh0dXJlID0gdGV4dHVyZSBpbnN0YW5jZW9mIFRleHR1cmUgPyB0ZXh0dXJlIDogbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIHRocyBzb3VyY2UgdGV4dHVyZS5cbiAgICAgICAgICogQHR5cGUge1BJWEkuQmFzZVRleHR1cmV9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhc2VUZXh0dXJlID0gdGV4dHVyZSBpbnN0YW5jZW9mIEJhc2VUZXh0dXJlID8gdGV4dHVyZSA6IHRoaXMuX3RleHR1cmUuYmFzZVRleHR1cmU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbWFwIGNvbnRhaW5pbmcgYWxsIHRleHR1cmVzIG9mIHRoZSBzcHJpdGUgc2hlZXQuXG4gICAgICAgICAqIENhbiBiZSB1c2VkIHRvIGNyZWF0ZSBhIHtAbGluayBQSVhJLlNwcml0ZXxTcHJpdGV9OlxuICAgICAgICAgKiBgYGBqc1xuICAgICAgICAgKiBuZXcgUElYSS5TcHJpdGUoc2hlZXQudGV4dHVyZXNbXCJpbWFnZS5wbmdcIl0pO1xuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZXh0dXJlcyA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcCBjb250YWluaW5nIHRoZSB0ZXh0dXJlcyBmb3IgZWFjaCBhbmltYXRpb24uXG4gICAgICAgICAqIENhbiBiZSB1c2VkIHRvIGNyZWF0ZSBhbiB7QGxpbmsgUElYSS5BbmltYXRlZFNwcml0ZXxBbmltYXRlZFNwcml0ZX06XG4gICAgICAgICAqIGBgYGpzXG4gICAgICAgICAqIG5ldyBQSVhJLkFuaW1hdGVkU3ByaXRlKHNoZWV0LmFuaW1hdGlvbnNbXCJhbmltX25hbWVcIl0pXG4gICAgICAgICAqIGBgYFxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIHRoZSBvcmlnaW5hbCBKU09OIGRhdGEuXG4gICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuXG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gdGhpcy5iYXNlVGV4dHVyZS5yZXNvdXJjZSBhcyByZXNvdXJjZXMuSW1hZ2VSZXNvdXJjZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHJlc29sdXRpb24gb2YgdGhlIHNwcml0ZXNoZWV0LlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZXNvbHV0aW9uID0gdGhpcy5fdXBkYXRlUmVzb2x1dGlvbihyZXNvbHV0aW9uRmlsZW5hbWUgfHwgKHJlc291cmNlID8gcmVzb3VyY2UudXJsIDogbnVsbCkpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXAgb2Ygc3ByaXRlc2hlZXQgZnJhbWVzLlxuICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZnJhbWVzID0gdGhpcy5kYXRhLmZyYW1lcztcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29sbGVjdGlvbiBvZiBmcmFtZSBuYW1lcy5cbiAgICAgICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZnJhbWVLZXlzID0gT2JqZWN0LmtleXModGhpcy5fZnJhbWVzKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VycmVudCBiYXRjaCBpbmRleCBiZWluZyBwcm9jZXNzZWQuXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9iYXRjaEluZGV4ID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsbGJhY2sgd2hlbiBwYXJzZSBpcyBjb21wbGV0ZWQuXG4gICAgICAgICAqIEB0eXBlIHtGdW5jdGlvbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSB0aGUgcmVzb2x1dGlvbiBmcm9tIHRoZSBmaWxlbmFtZSBvciBmYWxsYmFja1xuICAgICAqIHRvIHRoZSBtZXRhLnNjYWxlIGZpZWxkIG9mIHRoZSBKU09OIGRhdGEuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXNvbHV0aW9uRmlsZW5hbWUgLSBUaGUgZmlsZW5hbWUgdG8gdXNlIGZvciByZXNvbHZpbmdcbiAgICAgKiAgICAgICAgdGhlIGRlZmF1bHQgcmVzb2x1dGlvbi5cbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IFJlc29sdXRpb24gdG8gdXNlIGZvciBzcHJpdGVzaGVldC5cbiAgICAgKi9cbiAgICBwcml2YXRlIF91cGRhdGVSZXNvbHV0aW9uKHJlc29sdXRpb25GaWxlbmFtZTogc3RyaW5nID0gbnVsbCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgY29uc3QgeyBzY2FsZSB9ID0gdGhpcy5kYXRhLm1ldGE7XG5cbiAgICAgICAgLy8gVXNlIGEgZGVmYXVsdFZhbHVlIG9mIGBudWxsYCB0byBjaGVjayBpZiBhIHVybC1iYXNlZCByZXNvbHV0aW9uIGlzIHNldFxuICAgICAgICBsZXQgcmVzb2x1dGlvbiA9IGdldFJlc29sdXRpb25PZlVybChyZXNvbHV0aW9uRmlsZW5hbWUsIG51bGwpO1xuXG4gICAgICAgIC8vIE5vIHJlc29sdXRpb24gZm91bmQgdmlhIFVSTFxuICAgICAgICBpZiAocmVzb2x1dGlvbiA9PT0gbnVsbClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVXNlIHRoZSBzY2FsZSB2YWx1ZSBvciBkZWZhdWx0IHRvIDFcbiAgICAgICAgICAgIHJlc29sdXRpb24gPSBzY2FsZSAhPT0gdW5kZWZpbmVkID8gcGFyc2VGbG9hdChzY2FsZSkgOiAxO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIG5vbi0xIHJlc29sdXRpb25zLCB1cGRhdGUgYmFzZVRleHR1cmVcbiAgICAgICAgaWYgKHJlc29sdXRpb24gIT09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZVRleHR1cmUuc2V0UmVzb2x1dGlvbihyZXNvbHV0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNvbHV0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlciBzcHJpdGVzaGVldCBmcm9tIGxvYWRlZCBkYXRhLiBUaGlzIGlzIGRvbmUgYXN5bmNocm9ub3VzbHlcbiAgICAgKiB0byBwcmV2ZW50IGNyZWF0aW5nIHRvbyBtYW55IFRleHR1cmUgd2l0aGluIGEgc2luZ2xlIHByb2Nlc3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIHdoZW4gY29tcGxldGUgcmV0dXJuc1xuICAgICAqICAgICAgICBhIG1hcCBvZiB0aGUgVGV4dHVyZXMgZm9yIHRoaXMgc3ByaXRlc2hlZXQuXG4gICAgICovXG4gICAgcHVibGljIHBhcnNlKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fYmF0Y2hJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG5cbiAgICAgICAgaWYgKHRoaXMuX2ZyYW1lS2V5cy5sZW5ndGggPD0gU3ByaXRlc2hlZXQuQkFUQ0hfU0laRSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fcHJvY2Vzc0ZyYW1lcygwKTtcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NBbmltYXRpb25zKCk7XG4gICAgICAgICAgICB0aGlzLl9wYXJzZUNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9uZXh0QmF0Y2goKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgYSBiYXRjaCBvZiBmcmFtZXNcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluaXRpYWxGcmFtZUluZGV4IC0gVGhlIGluZGV4IG9mIGZyYW1lIHRvIHN0YXJ0LlxuICAgICAqL1xuICAgIHByaXZhdGUgX3Byb2Nlc3NGcmFtZXMoaW5pdGlhbEZyYW1lSW5kZXg6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCBmcmFtZUluZGV4ID0gaW5pdGlhbEZyYW1lSW5kZXg7XG4gICAgICAgIGNvbnN0IG1heEZyYW1lcyA9IFNwcml0ZXNoZWV0LkJBVENIX1NJWkU7XG5cbiAgICAgICAgd2hpbGUgKGZyYW1lSW5kZXggLSBpbml0aWFsRnJhbWVJbmRleCA8IG1heEZyYW1lcyAmJiBmcmFtZUluZGV4IDwgdGhpcy5fZnJhbWVLZXlzLmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2ZyYW1lS2V5c1tmcmFtZUluZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9mcmFtZXNbaV07XG4gICAgICAgICAgICBjb25zdCByZWN0ID0gZGF0YS5mcmFtZTtcblxuICAgICAgICAgICAgaWYgKHJlY3QpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IGZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICBsZXQgdHJpbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgY29uc3Qgc291cmNlU2l6ZSA9IGRhdGEudHJpbW1lZCAhPT0gZmFsc2UgJiYgZGF0YS5zb3VyY2VTaXplXG4gICAgICAgICAgICAgICAgICAgID8gZGF0YS5zb3VyY2VTaXplIDogZGF0YS5mcmFtZTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG9yaWcgPSBuZXcgUmVjdGFuZ2xlKFxuICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKHNvdXJjZVNpemUudykgLyB0aGlzLnJlc29sdXRpb24sXG4gICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3Ioc291cmNlU2l6ZS5oKSAvIHRoaXMucmVzb2x1dGlvblxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yb3RhdGVkKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWUgPSBuZXcgUmVjdGFuZ2xlKFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LngpIC8gdGhpcy5yZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LnkpIC8gdGhpcy5yZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LmgpIC8gdGhpcy5yZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LncpIC8gdGhpcy5yZXNvbHV0aW9uXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lID0gbmV3IFJlY3RhbmdsZShcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocmVjdC54KSAvIHRoaXMucmVzb2x1dGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocmVjdC55KSAvIHRoaXMucmVzb2x1dGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocmVjdC53KSAvIHRoaXMucmVzb2x1dGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocmVjdC5oKSAvIHRoaXMucmVzb2x1dGlvblxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vICBDaGVjayB0byBzZWUgaWYgdGhlIHNwcml0ZSBpcyB0cmltbWVkXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJpbW1lZCAhPT0gZmFsc2UgJiYgZGF0YS5zcHJpdGVTb3VyY2VTaXplKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHJpbSA9IG5ldyBSZWN0YW5nbGUoXG4gICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKGRhdGEuc3ByaXRlU291cmNlU2l6ZS54KSAvIHRoaXMucmVzb2x1dGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoZGF0YS5zcHJpdGVTb3VyY2VTaXplLnkpIC8gdGhpcy5yZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LncpIC8gdGhpcy5yZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihyZWN0LmgpIC8gdGhpcy5yZXNvbHV0aW9uXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0dXJlc1tpXSA9IG5ldyBUZXh0dXJlKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhc2VUZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICBmcmFtZSxcbiAgICAgICAgICAgICAgICAgICAgb3JpZyxcbiAgICAgICAgICAgICAgICAgICAgdHJpbSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yb3RhdGVkID8gMiA6IDAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuYW5jaG9yXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIGxldHMgYWxzbyBhZGQgdGhlIGZyYW1lIHRvIHBpeGkncyBnbG9iYWwgY2FjaGUgZm9yICdmcm9tJyBhbmQgJ2Zyb21Mb2FkZXInIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICAgIFRleHR1cmUuYWRkVG9DYWNoZSh0aGlzLnRleHR1cmVzW2ldLCBpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnJhbWVJbmRleCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYW5pbWF0aW9ucyBjb25maWdcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfcHJvY2Vzc0FuaW1hdGlvbnMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgYW5pbWF0aW9ucyA9IHRoaXMuZGF0YS5hbmltYXRpb25zIHx8IHt9O1xuXG4gICAgICAgIGZvciAoY29uc3QgYW5pbU5hbWUgaW4gYW5pbWF0aW9ucylcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zW2FuaW1OYW1lXSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbmltYXRpb25zW2FuaW1OYW1lXS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcmFtZU5hbWUgPSBhbmltYXRpb25zW2FuaW1OYW1lXVtpXTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1thbmltTmFtZV0ucHVzaCh0aGlzLnRleHR1cmVzW2ZyYW1lTmFtZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHBhcnNlIGhhcyBjb21wbGV0ZWQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgX3BhcnNlQ29tcGxldGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcblxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XG4gICAgICAgIHRoaXMuX2JhdGNoSW5kZXggPSAwO1xuICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsIHRoaXMudGV4dHVyZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJlZ2luIHRoZSBuZXh0IGJhdGNoIG9mIHRleHR1cmVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIF9uZXh0QmF0Y2goKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc0ZyYW1lcyh0aGlzLl9iYXRjaEluZGV4ICogU3ByaXRlc2hlZXQuQkFUQ0hfU0laRSk7XG4gICAgICAgIHRoaXMuX2JhdGNoSW5kZXgrKztcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYmF0Y2hJbmRleCAqIFNwcml0ZXNoZWV0LkJBVENIX1NJWkUgPCB0aGlzLl9mcmFtZUtleXMubGVuZ3RoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX25leHRCYXRjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NBbmltYXRpb25zKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VDb21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95IFNwcml0ZXNoZWV0IGFuZCBkb24ndCB1c2UgYWZ0ZXIgdGhpcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2Rlc3Ryb3lCYXNlPWZhbHNlXSAtIFdoZXRoZXIgdG8gZGVzdHJveSB0aGUgYmFzZSB0ZXh0dXJlIGFzIHdlbGxcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveShkZXN0cm95QmFzZSA9IGZhbHNlKTogdm9pZFxuICAgIHtcbiAgICAgICAgZm9yIChjb25zdCBpIGluIHRoaXMudGV4dHVyZXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudGV4dHVyZXNbaV0uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZyYW1lcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2ZyYW1lS2V5cyA9IG51bGw7XG4gICAgICAgIHRoaXMuZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMudGV4dHVyZXMgPSBudWxsO1xuICAgICAgICBpZiAoZGVzdHJveUJhc2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3RleHR1cmU/LmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuYmFzZVRleHR1cmUuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RleHR1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLmJhc2VUZXh0dXJlID0gbnVsbDtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgdXJsIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHsgU3ByaXRlc2hlZXQgfSBmcm9tICcuL1Nwcml0ZXNoZWV0JztcbmltcG9ydCB7IExvYWRlclJlc291cmNlIH0gZnJvbSAnQHBpeGkvbG9hZGVycyc7XG5pbXBvcnQgdHlwZSB7IExvYWRlciwgSUxvYWRlclJlc291cmNlIH0gZnJvbSAnQHBpeGkvbG9hZGVycyc7XG5cbi8qKlxuICoge0BsaW5rIFBJWEkuTG9hZGVyIExvYWRlcn0gbWlkZGxld2FyZSBmb3IgbG9hZGluZyB0ZXh0dXJlIGF0bGFzZXMgdGhhdCBoYXZlIGJlZW4gY3JlYXRlZCB3aXRoXG4gKiBUZXh0dXJlUGFja2VyIG9yIHNpbWlsYXIgSlNPTi1iYXNlZCBzcHJpdGVzaGVldC5cbiAqXG4gKiBUaGlzIG1pZGRsZXdhcmUgYXV0b21hdGljYWxseSBnZW5lcmF0ZXMgVGV4dHVyZSByZXNvdXJjZXMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGltcGxlbWVudHMgUElYSS5JTG9hZGVyUGx1Z2luXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJpdGVzaGVldExvYWRlclxue1xuICAgIC8qKlxuICAgICAqIENhbGxlZCBhZnRlciBhIHJlc291cmNlIGlzIGxvYWRlZC5cbiAgICAgKiBAc2VlIFBJWEkuTG9hZGVyLmxvYWRlck1pZGRsZXdhcmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuTG9hZGVyUmVzb3VyY2V9IHJlc291cmNlXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbmV4dFxuICAgICAqL1xuICAgIHN0YXRpYyB1c2UocmVzb3VyY2U6IElMb2FkZXJSZXNvdXJjZSwgbmV4dDogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdm9pZCk6IHZvaWRcbiAgICB7XG4gICAgICAgIC8vIGJlY2F1c2UgdGhpcyBpcyBtaWRkbGV3YXJlLCBpdCBleGVjdXRlIGluIGxvYWRlciBjb250ZXh0LiBgdGhpc2AgPSBsb2FkZXJcbiAgICAgICAgY29uc3QgbG9hZGVyID0gKHRoaXMgYXMgYW55KSBhcyBMb2FkZXI7XG4gICAgICAgIGNvbnN0IGltYWdlUmVzb3VyY2VOYW1lID0gYCR7cmVzb3VyY2UubmFtZX1faW1hZ2VgO1xuXG4gICAgICAgIC8vIHNraXAgaWYgbm8gZGF0YSwgaXRzIG5vdCBqc29uLCBpdCBpc24ndCBzcHJpdGVzaGVldCBkYXRhLCBvciB0aGUgaW1hZ2UgcmVzb3VyY2UgYWxyZWFkeSBleGlzdHNcbiAgICAgICAgaWYgKCFyZXNvdXJjZS5kYXRhXG4gICAgICAgICAgICB8fCByZXNvdXJjZS50eXBlICE9PSBMb2FkZXJSZXNvdXJjZS5UWVBFLkpTT05cbiAgICAgICAgICAgIHx8ICFyZXNvdXJjZS5kYXRhLmZyYW1lc1xuICAgICAgICAgICAgfHwgbG9hZGVyLnJlc291cmNlc1tpbWFnZVJlc291cmNlTmFtZV1cbiAgICAgICAgKVxuICAgICAgICB7XG4gICAgICAgICAgICBuZXh0KCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxvYWRPcHRpb25zID0ge1xuICAgICAgICAgICAgY3Jvc3NPcmlnaW46IHJlc291cmNlLmNyb3NzT3JpZ2luLFxuICAgICAgICAgICAgbWV0YWRhdGE6IHJlc291cmNlLm1ldGFkYXRhLmltYWdlTWV0YWRhdGEsXG4gICAgICAgICAgICBwYXJlbnRSZXNvdXJjZTogcmVzb3VyY2UsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzb3VyY2VQYXRoID0gU3ByaXRlc2hlZXRMb2FkZXIuZ2V0UmVzb3VyY2VQYXRoKHJlc291cmNlLCBsb2FkZXIuYmFzZVVybCk7XG5cbiAgICAgICAgLy8gbG9hZCB0aGUgaW1hZ2UgZm9yIHRoaXMgc2hlZXRcbiAgICAgICAgbG9hZGVyLmFkZChpbWFnZVJlc291cmNlTmFtZSwgcmVzb3VyY2VQYXRoLCBsb2FkT3B0aW9ucywgZnVuY3Rpb24gb25JbWFnZUxvYWQocmVzOiBJTG9hZGVyUmVzb3VyY2UpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChyZXMuZXJyb3IpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV4dChyZXMuZXJyb3IpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzcHJpdGVzaGVldCA9IG5ldyBTcHJpdGVzaGVldChcbiAgICAgICAgICAgICAgICByZXMudGV4dHVyZSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5kYXRhLFxuICAgICAgICAgICAgICAgIHJlc291cmNlLnVybFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgc3ByaXRlc2hlZXQucGFyc2UoKCkgPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5zcHJpdGVzaGVldCA9IHNwcml0ZXNoZWV0O1xuICAgICAgICAgICAgICAgIHJlc291cmNlLnRleHR1cmVzID0gc3ByaXRlc2hlZXQudGV4dHVyZXM7XG4gICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgc3ByaXRlc2hlZXRzIHJvb3QgcGF0aFxuICAgICAqIEBwYXJhbSB7UElYSS5Mb2FkZXJSZXNvdXJjZX0gcmVzb3VyY2UgLSBSZXNvdXJjZSB0byBjaGVjayBwYXRoXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGJhc2VVcmwgLSBCYXNlIHJvb3QgdXJsXG4gICAgICovXG4gICAgc3RhdGljIGdldFJlc291cmNlUGF0aChyZXNvdXJjZTogSUxvYWRlclJlc291cmNlLCBiYXNlVXJsOiBzdHJpbmcpOiBzdHJpbmdcbiAgICB7XG4gICAgICAgIC8vIFByZXBlbmQgdXJsIHBhdGggdW5sZXNzIHRoZSByZXNvdXJjZSBpbWFnZSBpcyBhIGRhdGEgdXJsXG4gICAgICAgIGlmIChyZXNvdXJjZS5pc0RhdGFVcmwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZS5kYXRhLm1ldGEuaW1hZ2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdXJsLnJlc29sdmUocmVzb3VyY2UudXJsLnJlcGxhY2UoYmFzZVVybCwgJycpLCByZXNvdXJjZS5kYXRhLm1ldGEuaW1hZ2UpO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBUZXh0dXJlLCBUZXh0dXJlTWF0cml4IH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBQb2ludCwgUmVjdGFuZ2xlLCBUcmFuc2Zvcm0gIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBTcHJpdGUgfSBmcm9tICdAcGl4aS9zcHJpdGUnO1xuaW1wb3J0IHsgZGVwcmVjYXRpb24gfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyLCBJQmFzZVRleHR1cmVPcHRpb25zLCBUZXh0dXJlU291cmNlIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnQsIElQb2ludERhdGEsIElTaXplLCBPYnNlcnZhYmxlUG9pbnQgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuY29uc3QgdGVtcFBvaW50ID0gbmV3IFBvaW50KCk7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIFRpbGluZ1Nwcml0ZSBleHRlbmRzIEdsb2JhbE1peGlucy5UaWxpbmdTcHJpdGUge31cblxuLyoqXG4gKiBBIHRpbGluZyBzcHJpdGUgaXMgYSBmYXN0IHdheSBvZiByZW5kZXJpbmcgYSB0aWxpbmcgaW1hZ2VcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuU3ByaXRlXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgVGlsaW5nU3ByaXRlIGV4dGVuZHMgU3ByaXRlXG57XG4gICAgcHVibGljIHRpbGVUcmFuc2Zvcm06IFRyYW5zZm9ybTtcbiAgICBwdWJsaWMgdXZNYXRyaXg6IFRleHR1cmVNYXRyaXg7XG4gICAgcHVibGljIHV2UmVzcGVjdEFuY2hvcjogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0dXJlfSB0ZXh0dXJlIC0gdGhlIHRleHR1cmUgb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3dpZHRoPTEwMF0gLSB0aGUgd2lkdGggb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2hlaWdodD0xMDBdIC0gdGhlIGhlaWdodCBvZiB0aGUgdGlsaW5nIHNwcml0ZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRleHR1cmU6IFRleHR1cmUsIHdpZHRoID0gMTAwLCBoZWlnaHQgPSAxMDApXG4gICAge1xuICAgICAgICBzdXBlcih0ZXh0dXJlKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGlsZSB0cmFuc2Zvcm1cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRpbGVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aXRoIG9mIHRoZSB0aWxpbmcgc3ByaXRlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3dpZHRoID0gd2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBtYXRyaXggdGhhdCBpcyBhcHBsaWVkIHRvIFVWIHRvIGdldCB0aGUgY29vcmRzIGluIFRleHR1cmUgbm9ybWFsaXplZCBzcGFjZSB0byBjb29yZHMgaW4gQmFzZVRleHR1cmUgc3BhY2VcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlTWF0cml4fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51dk1hdHJpeCA9IHRoaXMudGV4dHVyZS51dk1hdHJpeCB8fCBuZXcgVGV4dHVyZU1hdHJpeCh0ZXh0dXJlKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUGx1Z2luIHRoYXQgaXMgcmVzcG9uc2libGUgZm9yIHJlbmRlcmluZyB0aGlzIGVsZW1lbnQuXG4gICAgICAgICAqIEFsbG93cyB0byBjdXN0b21pemUgdGhlIHJlbmRlcmluZyBwcm9jZXNzIHdpdGhvdXQgb3ZlcnJpZGluZyAnX3JlbmRlcicgbWV0aG9kLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICAgICAqIEBkZWZhdWx0ICd0aWxpbmdTcHJpdGUnXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBsdWdpbk5hbWUgPSAndGlsaW5nU3ByaXRlJztcblxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBvciBub3QgYW5jaG9yIGFmZmVjdHMgdXZzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnV2UmVzcGVjdEFuY2hvciA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIGZyYW1lIGNsYW1waW5nIGluIGNvcnJlc3BvbmRpbmcgdGV4dHVyZVRyYW5zZm9ybSwgc2hvcnRjdXRcbiAgICAgKiBDaGFuZ2UgdG8gLTAuNSB0byBhZGQgYSBwaXhlbCB0byB0aGUgZWRnZSwgcmVjb21tZW5kZWQgZm9yIHRyYW5zcGFyZW50IHRyaW1tZWQgdGV4dHVyZXMgaW4gYXRsYXNcbiAgICAgKlxuICAgICAqIEBkZWZhdWx0IDAuNVxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgY2xhbXBNYXJnaW4oKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy51dk1hdHJpeC5jbGFtcE1hcmdpbjtcbiAgICB9XG5cbiAgICBzZXQgY2xhbXBNYXJnaW4odmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudXZNYXRyaXguY2xhbXBNYXJnaW4gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy51dk1hdHJpeC51cGRhdGUodHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHNjYWxpbmcgb2YgdGhlIGltYWdlIHRoYXQgaXMgYmVpbmcgdGlsZWRcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAqL1xuICAgIGdldCB0aWxlU2NhbGUoKTogT2JzZXJ2YWJsZVBvaW50XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy50aWxlVHJhbnNmb3JtLnNjYWxlO1xuICAgIH1cblxuICAgIHNldCB0aWxlU2NhbGUodmFsdWU6IE9ic2VydmFibGVQb2ludClcbiAgICB7XG4gICAgICAgIHRoaXMudGlsZVRyYW5zZm9ybS5zY2FsZS5jb3B5RnJvbSh2YWx1ZSBhcyBJUG9pbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvZmZzZXQgb2YgdGhlIGltYWdlIHRoYXQgaXMgYmVpbmcgdGlsZWRcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge1BJWEkuT2JzZXJ2YWJsZVBvaW50fVxuICAgICAqL1xuICAgIGdldCB0aWxlUG9zaXRpb24oKTogT2JzZXJ2YWJsZVBvaW50XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy50aWxlVHJhbnNmb3JtLnBvc2l0aW9uO1xuICAgIH1cblxuICAgIHNldCB0aWxlUG9zaXRpb24odmFsdWU6IE9ic2VydmFibGVQb2ludClcbiAgICB7XG4gICAgICAgIHRoaXMudGlsZVRyYW5zZm9ybS5wb3NpdGlvbi5jb3B5RnJvbSh2YWx1ZSBhcyBJUG9pbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX29uVGV4dHVyZVVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy51dk1hdHJpeClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51dk1hdHJpeC50ZXh0dXJlID0gdGhpcy5fdGV4dHVyZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jYWNoZWRUaW50ID0gMHhGRkZGRkY7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVycyB0aGUgb2JqZWN0IHVzaW5nIHRoZSBXZWJHTCByZW5kZXJlclxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBUaGUgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyB0d2VhayBvdXIgdGV4dHVyZSB0ZW1wb3JhcmlseS4uXG4gICAgICAgIGNvbnN0IHRleHR1cmUgPSB0aGlzLl90ZXh0dXJlO1xuXG4gICAgICAgIGlmICghdGV4dHVyZSB8fCAhdGV4dHVyZS52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50aWxlVHJhbnNmb3JtLnVwZGF0ZUxvY2FsVHJhbnNmb3JtKCk7XG4gICAgICAgIHRoaXMudXZNYXRyaXgudXBkYXRlKCk7XG5cbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guc2V0T2JqZWN0UmVuZGVyZXIocmVuZGVyZXIucGx1Z2luc1t0aGlzLnBsdWdpbk5hbWVdKTtcbiAgICAgICAgcmVuZGVyZXIucGx1Z2luc1t0aGlzLnBsdWdpbk5hbWVdLnJlbmRlcih0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBib3VuZHMgb2YgdGhlIHRpbGluZyBzcHJpdGUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIF9jYWxjdWxhdGVCb3VuZHMoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWluWCA9IHRoaXMuX3dpZHRoICogLXRoaXMuX2FuY2hvci5feDtcbiAgICAgICAgY29uc3QgbWluWSA9IHRoaXMuX2hlaWdodCAqIC10aGlzLl9hbmNob3IuX3k7XG4gICAgICAgIGNvbnN0IG1heFggPSB0aGlzLl93aWR0aCAqICgxIC0gdGhpcy5fYW5jaG9yLl94KTtcbiAgICAgICAgY29uc3QgbWF4WSA9IHRoaXMuX2hlaWdodCAqICgxIC0gdGhpcy5fYW5jaG9yLl95KTtcblxuICAgICAgICB0aGlzLl9ib3VuZHMuYWRkRnJhbWUodGhpcy50cmFuc2Zvcm0sIG1pblgsIG1pblksIG1heFgsIG1heFkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGxvY2FsIGJvdW5kcyBvZiB0aGUgc3ByaXRlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5SZWN0YW5nbGV9IHJlY3QgLSBUaGUgb3V0cHV0IHJlY3RhbmdsZS5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gVGhlIGJvdW5kcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0TG9jYWxCb3VuZHMocmVjdDogUmVjdGFuZ2xlKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICAvLyB3ZSBjYW4gZG8gYSBmYXN0IGxvY2FsIGJvdW5kcyBpZiB0aGUgc3ByaXRlIGhhcyBubyBjaGlsZHJlbiFcbiAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoID09PSAwKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZHMubWluWCA9IHRoaXMuX3dpZHRoICogLXRoaXMuX2FuY2hvci5feDtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5taW5ZID0gdGhpcy5faGVpZ2h0ICogLXRoaXMuX2FuY2hvci5feTtcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kcy5tYXhYID0gdGhpcy5fd2lkdGggKiAoMSAtIHRoaXMuX2FuY2hvci5feCk7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZHMubWF4WSA9IHRoaXMuX2hlaWdodCAqICgxIC0gdGhpcy5fYW5jaG9yLl95KTtcblxuICAgICAgICAgICAgaWYgKCFyZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fbG9jYWxCb3VuZHNSZWN0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9jYWxCb3VuZHNSZWN0ID0gbmV3IFJlY3RhbmdsZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlY3QgPSB0aGlzLl9sb2NhbEJvdW5kc1JlY3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ib3VuZHMuZ2V0UmVjdGFuZ2xlKHJlY3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldExvY2FsQm91bmRzLmNhbGwodGhpcywgcmVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGEgcG9pbnQgaXMgaW5zaWRlIHRoaXMgdGlsaW5nIHNwcml0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb2ludCAtIHRoZSBwb2ludCB0byBjaGVja1xuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgb3Igbm90IHRoZSBzcHJpdGUgY29udGFpbnMgdGhlIHBvaW50LlxuICAgICAqL1xuICAgIHB1YmxpYyBjb250YWluc1BvaW50KHBvaW50OiBJUG9pbnREYXRhKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybS5hcHBseUludmVyc2UocG9pbnQsIHRlbXBQb2ludCk7XG5cbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLl93aWR0aDtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5faGVpZ2h0O1xuICAgICAgICBjb25zdCB4MSA9IC13aWR0aCAqIHRoaXMuYW5jaG9yLl94O1xuXG4gICAgICAgIGlmICh0ZW1wUG9pbnQueCA+PSB4MSAmJiB0ZW1wUG9pbnQueCA8IHgxICsgd2lkdGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHkxID0gLWhlaWdodCAqIHRoaXMuYW5jaG9yLl95O1xuXG4gICAgICAgICAgICBpZiAodGVtcFBvaW50LnkgPj0geTEgJiYgdGVtcFBvaW50LnkgPCB5MSArIGhlaWdodClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGlzIHNwcml0ZSBhbmQgb3B0aW9uYWxseSBpdHMgdGV4dHVyZSBhbmQgY2hpbGRyZW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fGJvb2xlYW59IFtvcHRpb25zXSAtIE9wdGlvbnMgcGFyYW1ldGVyLiBBIGJvb2xlYW4gd2lsbCBhY3QgYXMgaWYgYWxsIG9wdGlvbnNcbiAgICAgKiAgaGF2ZSBiZWVuIHNldCB0byB0aGF0IHZhbHVlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jaGlsZHJlbj1mYWxzZV0gLSBpZiBzZXQgdG8gdHJ1ZSwgYWxsIHRoZSBjaGlsZHJlbiB3aWxsIGhhdmUgdGhlaXIgZGVzdHJveVxuICAgICAqICAgICAgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50ZXh0dXJlPWZhbHNlXSAtIFNob3VsZCBpdCBkZXN0cm95IHRoZSBjdXJyZW50IHRleHR1cmUgb2YgdGhlIHNwcml0ZSBhcyB3ZWxsXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5iYXNlVGV4dHVyZT1mYWxzZV0gLSBTaG91bGQgaXQgZGVzdHJveSB0aGUgYmFzZSB0ZXh0dXJlIG9mIHRoZSBzcHJpdGUgYXMgd2VsbFxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KG9wdGlvbnM6IElEZXN0cm95T3B0aW9uc3xib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveShvcHRpb25zKTtcblxuICAgICAgICB0aGlzLnRpbGVUcmFuc2Zvcm0gPSBudWxsO1xuICAgICAgICB0aGlzLnV2TWF0cml4ID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGEgbmV3IHRpbGluZyBzcHJpdGUgYmFzZWQgb24gdGhlIHNvdXJjZSB5b3UgcHJvdmlkZS5cbiAgICAgKiBUaGUgc291cmNlIGNhbiBiZSAtIGZyYW1lIGlkLCBpbWFnZSB1cmwsIHZpZGVvIHVybCwgY2FudmFzIGVsZW1lbnQsIHZpZGVvIGVsZW1lbnQsIGJhc2UgdGV4dHVyZVxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfFBJWEkuVGV4dHVyZXxIVE1MQ2FudmFzRWxlbWVudHxIVE1MVmlkZW9FbGVtZW50fSBzb3VyY2UgLSBTb3VyY2UgdG8gY3JlYXRlIHRleHR1cmUgZnJvbVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gU2VlIHtAbGluayBQSVhJLkJhc2VUZXh0dXJlfSdzIGNvbnN0cnVjdG9yIGZvciBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcHRpb25zLndpZHRoIC0gcmVxdWlyZWQgd2lkdGggb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5oZWlnaHQgLSByZXF1aXJlZCBoZWlnaHQgb2YgdGhlIHRpbGluZyBzcHJpdGVcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlRpbGluZ1Nwcml0ZX0gVGhlIG5ld2x5IGNyZWF0ZWQgdGV4dHVyZVxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tKHNvdXJjZTogVGV4dHVyZVNvdXJjZSwgb3B0aW9uczogSVNpemUgJiBJQmFzZVRleHR1cmVPcHRpb25zKTogVGlsaW5nU3ByaXRlXG4gICAge1xuICAgICAgICAvLyBEZXByZWNhdGVkXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ251bWJlcicpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdUaWxpbmdTcHJpdGUuZnJvbSB1c2Ugb3B0aW9ucyBpbnN0ZWFkIG9mIHdpZHRoIGFuZCBoZWlnaHQgYXJncycpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1yZXN0LXBhcmFtc1xuICAgICAgICAgICAgb3B0aW9ucyA9IHsgd2lkdGg6IG9wdGlvbnMsIGhlaWdodDogYXJndW1lbnRzWzJdIH0gYXMgSVNpemU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFRpbGluZ1Nwcml0ZShcbiAgICAgICAgICAgIFRleHR1cmUuZnJvbShzb3VyY2UsIG9wdGlvbnMpLFxuICAgICAgICAgICAgb3B0aW9ucy53aWR0aCxcbiAgICAgICAgICAgIG9wdGlvbnMuaGVpZ2h0XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHdpZHRoIG9mIHRoZSBzcHJpdGUsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgc2NhbGUgdG8gYWNoaWV2ZSB0aGUgdmFsdWUgc2V0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xuICAgIH1cblxuICAgIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5fd2lkdGggPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBUaWxpbmdTcHJpdGUsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgc2NhbGUgdG8gYWNoaWV2ZSB0aGUgdmFsdWUgc2V0XG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IGhlaWdodCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XG4gICAgfVxuXG4gICAgc2V0IGhlaWdodCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gdmFsdWU7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IE9iamVjdFJlbmRlcmVyLCBTaGFkZXIsIFN0YXRlLCBRdWFkVXYgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFdSQVBfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgTWF0cml4IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBwcmVtdWx0aXBseVRpbnRUb1JnYmEsIGNvcnJlY3RCbGVuZE1vZGUgfSBmcm9tICdAcGl4aS91dGlscyc7XG5cbmltcG9ydCB2ZXJ0ZXggZnJvbSAnLi90aWxpbmdTcHJpdGUudmVydCc7XG5pbXBvcnQgZnJhZ21lbnQgZnJvbSAnLi90aWxpbmdTcHJpdGUuZnJhZyc7XG5pbXBvcnQgZnJhZ21lbnRTaW1wbGUgZnJvbSAnLi90aWxpbmdTcHJpdGVfc2ltcGxlLmZyYWcnO1xuXG5pbXBvcnQgdHlwZSB7IFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IFRpbGluZ1Nwcml0ZSB9IGZyb20gJy4vVGlsaW5nU3ByaXRlJztcblxuY29uc3QgdGVtcE1hdCA9IG5ldyBNYXRyaXgoKTtcblxuLyoqXG4gKiBXZWJHTCByZW5kZXJlciBwbHVnaW4gZm9yIHRpbGluZyBzcHJpdGVzXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGV4dGVuZHMgUElYSS5PYmplY3RSZW5kZXJlclxuICovXG5leHBvcnQgY2xhc3MgVGlsaW5nU3ByaXRlUmVuZGVyZXIgZXh0ZW5kcyBPYmplY3RSZW5kZXJlclxue1xuICAgIHB1YmxpYyBzaGFkZXI6IFNoYWRlcjtcbiAgICBwdWJsaWMgc2ltcGxlU2hhZGVyOiBTaGFkZXI7XG4gICAgcHVibGljIHF1YWQ6IFF1YWRVdjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgc3RhdGU6IFN0YXRlO1xuXG4gICAgLyoqXG4gICAgICogY29uc3RydWN0b3IgZm9yIHJlbmRlcmVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIHJlbmRlcmVyIHRoaXMgdGlsaW5nIGF3ZXNvbWVuZXNzIHdvcmtzIGZvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlcjogUmVuZGVyZXIpXG4gICAge1xuICAgICAgICBzdXBlcihyZW5kZXJlcik7XG5cbiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSB7IGdsb2JhbHM6IHRoaXMucmVuZGVyZXIuZ2xvYmFsVW5pZm9ybXMgfTtcblxuICAgICAgICB0aGlzLnNoYWRlciA9IFNoYWRlci5mcm9tKHZlcnRleCwgZnJhZ21lbnQsIHVuaWZvcm1zKTtcblxuICAgICAgICB0aGlzLnNpbXBsZVNoYWRlciA9IFNoYWRlci5mcm9tKHZlcnRleCwgZnJhZ21lbnRTaW1wbGUsIHVuaWZvcm1zKTtcblxuICAgICAgICB0aGlzLnF1YWQgPSBuZXcgUXVhZFV2KCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBXZWJHTCBzdGF0ZSBpbiB3aGljaCB0aGlzIHJlbmRlcmVyIHdpbGwgd29yay5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5TdGF0ZX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuZm9yMmQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5UaWxpbmdTcHJpdGV9IHRzIC0gdGlsaW5nU3ByaXRlIHRvIGJlIHJlbmRlcmVkXG4gICAgICovXG4gICAgcHVibGljIHJlbmRlcih0czogVGlsaW5nU3ByaXRlKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyO1xuICAgICAgICBjb25zdCBxdWFkID0gdGhpcy5xdWFkO1xuXG4gICAgICAgIGxldCB2ZXJ0aWNlcyA9IHF1YWQudmVydGljZXM7XG5cbiAgICAgICAgdmVydGljZXNbMF0gPSB2ZXJ0aWNlc1s2XSA9ICh0cy5fd2lkdGgpICogLXRzLmFuY2hvci54O1xuICAgICAgICB2ZXJ0aWNlc1sxXSA9IHZlcnRpY2VzWzNdID0gdHMuX2hlaWdodCAqIC10cy5hbmNob3IueTtcblxuICAgICAgICB2ZXJ0aWNlc1syXSA9IHZlcnRpY2VzWzRdID0gKHRzLl93aWR0aCkgKiAoMS4wIC0gdHMuYW5jaG9yLngpO1xuICAgICAgICB2ZXJ0aWNlc1s1XSA9IHZlcnRpY2VzWzddID0gdHMuX2hlaWdodCAqICgxLjAgLSB0cy5hbmNob3IueSk7XG5cbiAgICAgICAgaWYgKHRzLnV2UmVzcGVjdEFuY2hvcilcbiAgICAgICAge1xuICAgICAgICAgICAgdmVydGljZXMgPSBxdWFkLnV2cztcblxuICAgICAgICAgICAgdmVydGljZXNbMF0gPSB2ZXJ0aWNlc1s2XSA9IC10cy5hbmNob3IueDtcbiAgICAgICAgICAgIHZlcnRpY2VzWzFdID0gdmVydGljZXNbM10gPSAtdHMuYW5jaG9yLnk7XG5cbiAgICAgICAgICAgIHZlcnRpY2VzWzJdID0gdmVydGljZXNbNF0gPSAxLjAgLSB0cy5hbmNob3IueDtcbiAgICAgICAgICAgIHZlcnRpY2VzWzVdID0gdmVydGljZXNbN10gPSAxLjAgLSB0cy5hbmNob3IueTtcbiAgICAgICAgfVxuXG4gICAgICAgIHF1YWQuaW52YWxpZGF0ZSgpO1xuXG4gICAgICAgIGNvbnN0IHRleCA9IHRzLl90ZXh0dXJlO1xuICAgICAgICBjb25zdCBiYXNlVGV4ID0gdGV4LmJhc2VUZXh0dXJlO1xuICAgICAgICBjb25zdCBsdCA9IHRzLnRpbGVUcmFuc2Zvcm0ubG9jYWxUcmFuc2Zvcm07XG4gICAgICAgIGNvbnN0IHV2ID0gdHMudXZNYXRyaXg7XG4gICAgICAgIGxldCBpc1NpbXBsZSA9IGJhc2VUZXguaXNQb3dlck9mVHdvXG4gICAgICAgICAgICAmJiB0ZXguZnJhbWUud2lkdGggPT09IGJhc2VUZXgud2lkdGggJiYgdGV4LmZyYW1lLmhlaWdodCA9PT0gYmFzZVRleC5oZWlnaHQ7XG5cbiAgICAgICAgLy8gYXV0bywgZm9yY2UgcmVwZWF0IHdyYXBNb2RlIGZvciBiaWcgdGlsaW5nIHRleHR1cmVzXG4gICAgICAgIGlmIChpc1NpbXBsZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFiYXNlVGV4Ll9nbFRleHR1cmVzW3JlbmRlcmVyLkNPTlRFWFRfVUlEXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoYmFzZVRleC53cmFwTW9kZSA9PT0gV1JBUF9NT0RFUy5DTEFNUClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGJhc2VUZXgud3JhcE1vZGUgPSBXUkFQX01PREVTLlJFUEVBVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaXNTaW1wbGUgPSBiYXNlVGV4LndyYXBNb2RlICE9PSBXUkFQX01PREVTLkNMQU1QO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2hhZGVyID0gaXNTaW1wbGUgPyB0aGlzLnNpbXBsZVNoYWRlciA6IHRoaXMuc2hhZGVyO1xuXG4gICAgICAgIGNvbnN0IHcgPSB0ZXgud2lkdGg7XG4gICAgICAgIGNvbnN0IGggPSB0ZXguaGVpZ2h0O1xuICAgICAgICBjb25zdCBXID0gdHMuX3dpZHRoO1xuICAgICAgICBjb25zdCBIID0gdHMuX2hlaWdodDtcblxuICAgICAgICB0ZW1wTWF0LnNldChsdC5hICogdyAvIFcsXG4gICAgICAgICAgICBsdC5iICogdyAvIEgsXG4gICAgICAgICAgICBsdC5jICogaCAvIFcsXG4gICAgICAgICAgICBsdC5kICogaCAvIEgsXG4gICAgICAgICAgICBsdC50eCAvIFcsXG4gICAgICAgICAgICBsdC50eSAvIEgpO1xuXG4gICAgICAgIC8vIHRoYXQgcGFydCBpcyB0aGUgc2FtZSBhcyBhYm92ZTpcbiAgICAgICAgLy8gdGVtcE1hdC5pZGVudGl0eSgpO1xuICAgICAgICAvLyB0ZW1wTWF0LnNjYWxlKHRleC53aWR0aCwgdGV4LmhlaWdodCk7XG4gICAgICAgIC8vIHRlbXBNYXQucHJlcGVuZChsdCk7XG4gICAgICAgIC8vIHRlbXBNYXQuc2NhbGUoMS4wIC8gdHMuX3dpZHRoLCAxLjAgLyB0cy5faGVpZ2h0KTtcblxuICAgICAgICB0ZW1wTWF0LmludmVydCgpO1xuICAgICAgICBpZiAoaXNTaW1wbGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBNYXQucHJlcGVuZCh1di5tYXBDb29yZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBzaGFkZXIudW5pZm9ybXMudU1hcENvb3JkID0gdXYubWFwQ29vcmQudG9BcnJheSh0cnVlKTtcbiAgICAgICAgICAgIHNoYWRlci51bmlmb3Jtcy51Q2xhbXBGcmFtZSA9IHV2LnVDbGFtcEZyYW1lO1xuICAgICAgICAgICAgc2hhZGVyLnVuaWZvcm1zLnVDbGFtcE9mZnNldCA9IHV2LnVDbGFtcE9mZnNldDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNoYWRlci51bmlmb3Jtcy51VHJhbnNmb3JtID0gdGVtcE1hdC50b0FycmF5KHRydWUpO1xuICAgICAgICBzaGFkZXIudW5pZm9ybXMudUNvbG9yID0gcHJlbXVsdGlwbHlUaW50VG9SZ2JhKHRzLnRpbnQsIHRzLndvcmxkQWxwaGEsXG4gICAgICAgICAgICBzaGFkZXIudW5pZm9ybXMudUNvbG9yLCBiYXNlVGV4LmFscGhhTW9kZSBhcyBhbnkpO1xuICAgICAgICBzaGFkZXIudW5pZm9ybXMudHJhbnNsYXRpb25NYXRyaXggPSB0cy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm0udG9BcnJheSh0cnVlKTtcbiAgICAgICAgc2hhZGVyLnVuaWZvcm1zLnVTYW1wbGVyID0gdGV4O1xuXG4gICAgICAgIHJlbmRlcmVyLnNoYWRlci5iaW5kKHNoYWRlcik7XG4gICAgICAgIHJlbmRlcmVyLmdlb21ldHJ5LmJpbmQocXVhZCk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZS5ibGVuZE1vZGUgPSBjb3JyZWN0QmxlbmRNb2RlKHRzLmJsZW5kTW9kZSwgYmFzZVRleC5hbHBoYU1vZGUgYXMgYW55KTtcbiAgICAgICAgcmVuZGVyZXIuc3RhdGUuc2V0KHRoaXMuc3RhdGUpO1xuICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5kcmF3KHRoaXMucmVuZGVyZXIuZ2wuVFJJQU5HTEVTLCA2LCAwKTtcbiAgICB9XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHR5cGUgeyBUZXh0dXJlTWF0cml4LCBCdWZmZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuLyoqXG4gKiBDbGFzcyBjb250cm9scyBjYWNoZSBmb3IgVVYgbWFwcGluZyBmcm9tIFRleHR1cmUgbm9ybWFsIHNwYWNlIHRvIEJhc2VUZXh0dXJlIG5vcm1hbCBzcGFjZS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXNoQmF0Y2hVdnNcbntcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGF0YTogRmxvYXQzMkFycmF5O1xuICAgIHB1YmxpYyB1dkJ1ZmZlcjogQnVmZmVyO1xuICAgIHB1YmxpYyB1dk1hdHJpeDogVGV4dHVyZU1hdHJpeDtcblxuICAgIHByaXZhdGUgX2J1ZmZlclVwZGF0ZUlkOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfdGV4dHVyZVVwZGF0ZUlkOiBudW1iZXI7XG5cbiAgICAvLyBJbnRlcm5hbC1vbmx5IHByb3BlcnRpZXNcbiAgICBfdXBkYXRlSUQ6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5CdWZmZXJ9IHV2QnVmZmVyIC0gQnVmZmVyIHdpdGggbm9ybWFsaXplZCB1didzXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmVNYXRyaXh9IHV2TWF0cml4IC0gTWF0ZXJpYWwgVVYgbWF0cml4XG4gICAgICovXG4gICAgY29uc3RydWN0b3IodXZCdWZmZXI6IEJ1ZmZlciwgdXZNYXRyaXg6IFRleHR1cmVNYXRyaXgpXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIHdpdGggbm9ybWFsaXplZCBVVidzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQnVmZmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51dkJ1ZmZlciA9IHV2QnVmZmVyO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXRlcmlhbCBVViBtYXRyaXhcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlTWF0cml4fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51dk1hdHJpeCA9IHV2TWF0cml4O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVViBCdWZmZXIgZGF0YVxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRhID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9idWZmZXJVcGRhdGVJZCA9IC0xO1xuXG4gICAgICAgIHRoaXMuX3RleHR1cmVVcGRhdGVJZCA9IC0xO1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZUlEID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB1cGRhdGVzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmb3JjZVVwZGF0ZV0gLSBmb3JjZSB0aGUgdXBkYXRlXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZShmb3JjZVVwZGF0ZT86IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAoIWZvcmNlVXBkYXRlXG4gICAgICAgICAgICAmJiB0aGlzLl9idWZmZXJVcGRhdGVJZCA9PT0gdGhpcy51dkJ1ZmZlci5fdXBkYXRlSURcbiAgICAgICAgICAgICYmIHRoaXMuX3RleHR1cmVVcGRhdGVJZCA9PT0gdGhpcy51dk1hdHJpeC5fdXBkYXRlSURcbiAgICAgICAgKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9idWZmZXJVcGRhdGVJZCA9IHRoaXMudXZCdWZmZXIuX3VwZGF0ZUlEO1xuICAgICAgICB0aGlzLl90ZXh0dXJlVXBkYXRlSWQgPSB0aGlzLnV2TWF0cml4Ll91cGRhdGVJRDtcblxuICAgICAgICBjb25zdCBkYXRhID0gdGhpcy51dkJ1ZmZlci5kYXRhIGFzIEZsb2F0MzJBcnJheTtcblxuICAgICAgICBpZiAoIXRoaXMuZGF0YSB8fCB0aGlzLmRhdGEubGVuZ3RoICE9PSBkYXRhLmxlbmd0aClcbiAgICAgICAge1xuICAgICAgICAgICAgKHRoaXMuZGF0YSBhcyBhbnkpID0gbmV3IEZsb2F0MzJBcnJheShkYXRhLmxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnV2TWF0cml4Lm11bHRpcGx5VXZzKGRhdGEsIHRoaXMuZGF0YSk7XG5cbiAgICAgICAgdGhpcy5fdXBkYXRlSUQrKztcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgU3RhdGUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFBvaW50LCBQb2x5Z29uIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgeyBCTEVORF9NT0RFUywgRFJBV19NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgTWVzaEJhdGNoVXZzIH0gZnJvbSAnLi9NZXNoQmF0Y2hVdnMnO1xuaW1wb3J0IHsgTWVzaE1hdGVyaWFsIH0gZnJvbSAnLi9NZXNoTWF0ZXJpYWwnO1xuXG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHR5cGUgeyBUZXh0dXJlLCBSZW5kZXJlciwgR2VvbWV0cnksIEJ1ZmZlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnREYXRhIH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5cbmNvbnN0IHRlbXBQb2ludCA9IG5ldyBQb2ludCgpO1xuY29uc3QgdGVtcFBvbHlnb24gPSBuZXcgUG9seWdvbigpO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBNZXNoIGV4dGVuZHMgR2xvYmFsTWl4aW5zLk1lc2gge31cblxuLyoqXG4gKiBCYXNlIG1lc2ggY2xhc3MuXG4gKlxuICogVGhpcyBjbGFzcyBlbXBvd2VycyB5b3UgdG8gaGF2ZSBtYXhpbXVtIGZsZXhpYmlsaXR5IHRvIHJlbmRlciBhbnkga2luZCBvZiBXZWJHTCB2aXN1YWxzIHlvdSBjYW4gdGhpbmsgb2YuXG4gKiBUaGlzIGNsYXNzIGFzc3VtZXMgYSBjZXJ0YWluIGxldmVsIG9mIFdlYkdMIGtub3dsZWRnZS5cbiAqIElmIHlvdSBrbm93IGEgYml0IHRoaXMgc2hvdWxkIGFic3RyYWN0IGVub3VnaCBhd2F5IHRvIG1ha2UgeW91IGxpZmUgZWFzaWVyIVxuICpcbiAqIFByZXR0eSBtdWNoIEFMTCBXZWJHTCBjYW4gYmUgYnJva2VuIGRvd24gaW50byB0aGUgZm9sbG93aW5nOlxuICogLSBHZW9tZXRyeSAtIFRoZSBzdHJ1Y3R1cmUgYW5kIGRhdGEgZm9yIHRoZSBtZXNoLiBUaGlzIGNhbiBpbmNsdWRlIGFueXRoaW5nIGZyb20gcG9zaXRpb25zLCB1dnMsIG5vcm1hbHMsIGNvbG9ycyBldGMuLlxuICogLSBTaGFkZXIgLSBUaGlzIGlzIHRoZSBzaGFkZXIgdGhhdCBQaXhpSlMgd2lsbCByZW5kZXIgdGhlIGdlb21ldHJ5IHdpdGggKGF0dHJpYnV0ZXMgaW4gdGhlIHNoYWRlciBtdXN0IG1hdGNoIHRoZSBnZW9tZXRyeSlcbiAqIC0gU3RhdGUgLSBUaGlzIGlzIHRoZSBzdGF0ZSBvZiBXZWJHTCByZXF1aXJlZCB0byByZW5kZXIgdGhlIG1lc2guXG4gKlxuICogVGhyb3VnaCBhIGNvbWJpbmF0aW9uIG9mIHRoZSBhYm92ZSBlbGVtZW50cyB5b3UgY2FuIHJlbmRlciBhbnl0aGluZyB5b3Ugd2FudCwgMkQgb3IgM0QhXG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkNvbnRhaW5lclxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIE1lc2ggZXh0ZW5kcyBDb250YWluZXJcbntcbiAgICBwdWJsaWMgcmVhZG9ubHkgZ2VvbWV0cnk6IEdlb21ldHJ5O1xuICAgIHB1YmxpYyBzaGFkZXI6IE1lc2hNYXRlcmlhbDtcbiAgICBwdWJsaWMgc3RhdGU6IFN0YXRlO1xuICAgIHB1YmxpYyBkcmF3TW9kZTogRFJBV19NT0RFUztcbiAgICBwdWJsaWMgc3RhcnQ6IG51bWJlcjtcbiAgICBwdWJsaWMgc2l6ZTogbnVtYmVyO1xuXG4gICAgcHJpdmF0ZSB2ZXJ0ZXhEYXRhOiBGbG9hdDMyQXJyYXk7XG4gICAgcHJpdmF0ZSB2ZXJ0ZXhEaXJ0eTogbnVtYmVyO1xuICAgIHByaXZhdGUgX3RyYW5zZm9ybUlEOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfcm91bmRQaXhlbHM6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBiYXRjaFV2czogTWVzaEJhdGNoVXZzO1xuXG4gICAgLy8gSW50ZXJuYWwtb25seSBwcm9wZXJ0aWVzXG4gICAgdXZzOiBGbG9hdDMyQXJyYXk7XG4gICAgaW5kaWNlczogVWludDE2QXJyYXk7XG4gICAgX3RpbnRSR0I6IG51bWJlcjtcbiAgICBfdGV4dHVyZTogVGV4dHVyZTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5HZW9tZXRyeX0gZ2VvbWV0cnkgLSB0aGUgZ2VvbWV0cnkgdGhlIG1lc2ggd2lsbCB1c2VcbiAgICAgKiBAcGFyYW0ge1BJWEkuTWVzaE1hdGVyaWFsfSBzaGFkZXIgLSB0aGUgc2hhZGVyIHRoZSBtZXNoIHdpbGwgdXNlXG4gICAgICogQHBhcmFtIHtQSVhJLlN0YXRlfSBbc3RhdGVdIC0gdGhlIHN0YXRlIHRoYXQgdGhlIFdlYkdMIGNvbnRleHQgaXMgcmVxdWlyZWQgdG8gYmUgaW4gdG8gcmVuZGVyIHRoZSBtZXNoXG4gICAgICogICAgICAgIGlmIG5vIHN0YXRlIGlzIHByb3ZpZGVkLCB1c2VzIHtAbGluayBQSVhJLlN0YXRlLmZvcjJkfSB0byBjcmVhdGUgYSAyRCBzdGF0ZSBmb3IgUGl4aUpTLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZHJhd01vZGU9UElYSS5EUkFXX01PREVTLlRSSUFOR0xFU10gLSB0aGUgZHJhd01vZGUsIGNhbiBiZSBhbnkgb2YgdGhlIFBJWEkuRFJBV19NT0RFUyBjb25zdHNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihnZW9tZXRyeTogR2VvbWV0cnksIHNoYWRlcjogTWVzaE1hdGVyaWFsLCBzdGF0ZT86IFN0YXRlLCBkcmF3TW9kZSA9IERSQVdfTU9ERVMuVFJJQU5HTEVTKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5jbHVkZXMgdmVydGV4IHBvc2l0aW9ucywgZmFjZSBpbmRpY2VzLCBub3JtYWxzLCBjb2xvcnMsIFVWcywgYW5kXG4gICAgICAgICAqIGN1c3RvbSBhdHRyaWJ1dGVzIHdpdGhpbiBidWZmZXJzLCByZWR1Y2luZyB0aGUgY29zdCBvZiBwYXNzaW5nIGFsbFxuICAgICAgICAgKiB0aGlzIGRhdGEgdG8gdGhlIEdQVS4gQ2FuIGJlIHNoYXJlZCBiZXR3ZWVuIG11bHRpcGxlIE1lc2ggb2JqZWN0cy5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5HZW9tZXRyeX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdlb21ldHJ5ID0gZ2VvbWV0cnk7XG5cbiAgICAgICAgZ2VvbWV0cnkucmVmQ291bnQrKztcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVwcmVzZW50cyB0aGUgdmVydGV4IGFuZCBmcmFnbWVudCBzaGFkZXJzIHRoYXQgcHJvY2Vzc2VzIHRoZSBnZW9tZXRyeSBhbmQgcnVucyBvbiB0aGUgR1BVLlxuICAgICAgICAgKiBDYW4gYmUgc2hhcmVkIGJldHdlZW4gbXVsdGlwbGUgTWVzaCBvYmplY3RzLlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlNoYWRlcnxQSVhJLk1lc2hNYXRlcmlhbH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hhZGVyID0gc2hhZGVyO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXByZXNlbnRzIHRoZSBXZWJHTCBzdGF0ZSB0aGUgTWVzaCByZXF1aXJlZCB0byByZW5kZXIsIGV4Y2x1ZGVzIHNoYWRlciBhbmQgZ2VvbWV0cnkuIEUuZy4sXG4gICAgICAgICAqIGJsZW5kIG1vZGUsIGN1bGxpbmcsIGRlcHRoIHRlc3RpbmcsIGRpcmVjdGlvbiBvZiByZW5kZXJpbmcgdHJpYW5nbGVzLCBiYWNrZmFjZSwgZXRjLlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlN0YXRlfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlIHx8IFN0YXRlLmZvcjJkKCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3YXkgdGhlIE1lc2ggc2hvdWxkIGJlIGRyYXduLCBjYW4gYmUgYW55IG9mIHRoZSB7QGxpbmsgUElYSS5EUkFXX01PREVTfSBjb25zdGFudHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHNlZSBQSVhJLkRSQVdfTU9ERVNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZHJhd01vZGUgPSBkcmF3TW9kZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVHlwaWNhbGx5IHRoZSBpbmRleCBvZiB0aGUgSW5kZXhCdWZmZXIgd2hlcmUgdG8gc3RhcnQgZHJhd2luZy5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnN0YXJ0ID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSG93IG11Y2ggb2YgdGhlIGdlb21ldHJ5IHRvIGRyYXcsIGJ5IGRlZmF1bHQgYDBgIHJlbmRlcnMgZXZlcnl0aGluZy5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0aGVhc2UgYXJlIHVzZWQgYXMgZWFzeSBhY2Nlc3MgZm9yIGJhdGNoaW5nXG4gICAgICAgICAqIEBtZW1iZXIge0Zsb2F0MzJBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZzID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdGhlYXNlIGFyZSB1c2VkIGFzIGVhc3kgYWNjZXNzIGZvciBiYXRjaGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtVaW50MTZBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5kaWNlcyA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHRoaXMgaXMgdGhlIGNhY2hpbmcgbGF5ZXIgdXNlZCBieSB0aGUgYmF0Y2hlclxuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZlcnRleERhdGEgPSBuZXcgRmxvYXQzMkFycmF5KDEpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBnZW9tZXRyeSBpcyBjaGFuZ2VkIHVzZWQgdG8gZGVjaWRlIHRvIHJlLXRyYW5zZm9ybVxuICAgICAgICAgKiB0aGUgdmVydGV4RGF0YS5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52ZXJ0ZXhEaXJ0eSA9IDA7XG5cbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtSUQgPSAtMTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgcm91bmRQaXhlbHMgZmllbGRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3JvdW5kUGl4ZWxzID0gc2V0dGluZ3MuUk9VTkRfUElYRUxTO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYXRjaGVkIFVWJ3MgYXJlIGNhY2hlZCBmb3IgYXRsYXMgdGV4dHVyZXNcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NZXNoQmF0Y2hVdnN9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhdGNoVXZzID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUbyBjaGFuZ2UgbWVzaCB1didzLCBjaGFuZ2UgaXRzIHV2QnVmZmVyIGRhdGEgYW5kIGluY3JlbWVudCBpdHMgX3VwZGF0ZUlELlxuICAgICAqIEBtZW1iZXIge1BJWEkuQnVmZmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIGdldCB1dkJ1ZmZlcigpOiBCdWZmZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmdlb21ldHJ5LmJ1ZmZlcnNbMV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVG8gY2hhbmdlIG1lc2ggdmVydGljZXMsIGNoYW5nZSBpdHMgdXZCdWZmZXIgZGF0YSBhbmQgaW5jcmVtZW50IGl0cyBfdXBkYXRlSUQuXG4gICAgICogSW5jcmVtZW50aW5nIF91cGRhdGVJRCBpcyBvcHRpb25hbCBiZWNhdXNlIG1vc3Qgb2YgTWVzaCBvYmplY3RzIGRvIGl0IGFueXdheS5cbiAgICAgKiBAbWVtYmVyIHtQSVhJLkJ1ZmZlcn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgdmVydGljZXNCdWZmZXIoKTogQnVmZmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5nZW9tZXRyeS5idWZmZXJzWzBdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFsaWFzIGZvciB7QGxpbmsgUElYSS5NZXNoI3NoYWRlcn0uXG4gICAgICogQG1lbWJlciB7UElYSS5NZXNoTWF0ZXJpYWx9XG4gICAgICovXG4gICAgc2V0IG1hdGVyaWFsKHZhbHVlOiBNZXNoTWF0ZXJpYWwpXG4gICAge1xuICAgICAgICB0aGlzLnNoYWRlciA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBtYXRlcmlhbCgpOiBNZXNoTWF0ZXJpYWxcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNoYWRlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmxlbmQgbW9kZSB0byBiZSBhcHBsaWVkIHRvIHRoZSBNZXNoLiBBcHBseSBhIHZhbHVlIG9mXG4gICAgICogYFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMYCB0byByZXNldCB0aGUgYmxlbmQgbW9kZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCBQSVhJLkJMRU5EX01PREVTLk5PUk1BTDtcbiAgICAgKiBAc2VlIFBJWEkuQkxFTkRfTU9ERVNcbiAgICAgKi9cbiAgICBzZXQgYmxlbmRNb2RlKHZhbHVlOiBCTEVORF9NT0RFUylcbiAgICB7XG4gICAgICAgIHRoaXMuc3RhdGUuYmxlbmRNb2RlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0IGJsZW5kTW9kZSgpOiBCTEVORF9NT0RFU1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuYmxlbmRNb2RlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRydWUgUGl4aUpTIHdpbGwgTWF0aC5mbG9vcigpIHgveSB2YWx1ZXMgd2hlbiByZW5kZXJpbmcsIHN0b3BwaW5nIHBpeGVsIGludGVycG9sYXRpb24uXG4gICAgICogQWR2YW50YWdlcyBjYW4gaW5jbHVkZSBzaGFycGVyIGltYWdlIHF1YWxpdHkgKGxpa2UgdGV4dCkgYW5kIGZhc3RlciByZW5kZXJpbmcgb24gY2FudmFzLlxuICAgICAqIFRoZSBtYWluIGRpc2FkdmFudGFnZSBpcyBtb3ZlbWVudCBvZiBvYmplY3RzIG1heSBhcHBlYXIgbGVzcyBzbW9vdGguXG4gICAgICogVG8gc2V0IHRoZSBnbG9iYWwgZGVmYXVsdCwgY2hhbmdlIHtAbGluayBQSVhJLnNldHRpbmdzLlJPVU5EX1BJWEVMU31cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgKi9cbiAgICBzZXQgcm91bmRQaXhlbHModmFsdWU6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fcm91bmRQaXhlbHMgIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JvdW5kUGl4ZWxzID0gdmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0IHJvdW5kUGl4ZWxzKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yb3VuZFBpeGVscztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbXVsdGlwbHkgdGludCBhcHBsaWVkIHRvIHRoZSBNZXNoLiBUaGlzIGlzIGEgaGV4IHZhbHVlLiBBIHZhbHVlIG9mXG4gICAgICogYDB4RkZGRkZGYCB3aWxsIHJlbW92ZSBhbnkgdGludCBlZmZlY3QuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMHhGRkZGRkZcbiAgICAgKi9cbiAgICBnZXQgdGludCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNoYWRlci50aW50O1xuICAgIH1cblxuICAgIHNldCB0aW50KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLnNoYWRlci50aW50ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHRleHR1cmUgdGhhdCB0aGUgTWVzaCB1c2VzLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlfVxuICAgICAqL1xuICAgIGdldCB0ZXh0dXJlKCk6IFRleHR1cmVcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnNoYWRlci50ZXh0dXJlO1xuICAgIH1cblxuICAgIHNldCB0ZXh0dXJlKHZhbHVlOiBUZXh0dXJlKVxuICAgIHtcbiAgICAgICAgdGhpcy5zaGFkZXIudGV4dHVyZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YW5kYXJkIHJlbmRlcmVyIGRyYXcuXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBJbnN0YW5jZSB0byByZW5kZXJlci5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBzZXQgcHJvcGVydGllcyBmb3IgYmF0Y2hpbmcuLlxuICAgICAgICAvLyBUT0RPIGNvdWxkIHVzZSBhIGRpZmZlcmVudCB3YXkgdG8gZ3JhYiB2ZXJ0cz9cbiAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLmdlb21ldHJ5LmJ1ZmZlcnNbMF0uZGF0YTtcblxuICAgICAgICAvLyBUT0RPIGJlbmNobWFyayBjaGVjayBmb3IgYXR0cmlidXRlIHNpemUuLlxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnNoYWRlci5iYXRjaGFibGVcbiAgICAgICAgICAgICYmIHRoaXMuZHJhd01vZGUgPT09IERSQVdfTU9ERVMuVFJJQU5HTEVTXG4gICAgICAgICAgICAmJiB2ZXJ0aWNlcy5sZW5ndGggPCBNZXNoLkJBVENIQUJMRV9TSVpFICogMlxuICAgICAgICApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclRvQmF0Y2gocmVuZGVyZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyRGVmYXVsdChyZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFuZGFyZCBub24tYmF0Y2hpbmcgd2F5IG9mIHJlbmRlcmluZy5cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciAtIEluc3RhbmNlIHRvIHJlbmRlcmVyLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfcmVuZGVyRGVmYXVsdChyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBzaGFkZXIgPSB0aGlzLnNoYWRlcjtcblxuICAgICAgICBzaGFkZXIuYWxwaGEgPSB0aGlzLndvcmxkQWxwaGE7XG4gICAgICAgIGlmIChzaGFkZXIudXBkYXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICBzaGFkZXIudXBkYXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZW5kZXJlci5iYXRjaC5mbHVzaCgpO1xuXG4gICAgICAgIGlmIChzaGFkZXIucHJvZ3JhbS51bmlmb3JtRGF0YS50cmFuc2xhdGlvbk1hdHJpeClcbiAgICAgICAge1xuICAgICAgICAgICAgc2hhZGVyLnVuaWZvcm1zLnRyYW5zbGF0aW9uTWF0cml4ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm0udG9BcnJheSh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGJpbmQgYW5kIHN5bmMgdW5pZm9ybXMuLlxuICAgICAgICByZW5kZXJlci5zaGFkZXIuYmluZChzaGFkZXIpO1xuXG4gICAgICAgIC8vIHNldCBzdGF0ZS4uXG4gICAgICAgIHJlbmRlcmVyLnN0YXRlLnNldCh0aGlzLnN0YXRlKTtcblxuICAgICAgICAvLyBiaW5kIHRoZSBnZW9tZXRyeS4uLlxuICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5iaW5kKHRoaXMuZ2VvbWV0cnksIHNoYWRlcik7XG5cbiAgICAgICAgLy8gdGhlbiByZW5kZXIgaXRcbiAgICAgICAgcmVuZGVyZXIuZ2VvbWV0cnkuZHJhdyh0aGlzLmRyYXdNb2RlLCB0aGlzLnNpemUsIHRoaXMuc3RhcnQsIHRoaXMuZ2VvbWV0cnkuaW5zdGFuY2VDb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyaW5nIGJ5IHVzaW5nIHRoZSBCYXRjaCBzeXN0ZW0uXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBJbnN0YW5jZSB0byByZW5kZXJlci5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3JlbmRlclRvQmF0Y2gocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5O1xuXG4gICAgICAgIGlmICh0aGlzLnNoYWRlci51dk1hdHJpeClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5zaGFkZXIudXZNYXRyaXgudXBkYXRlKCk7XG4gICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVV2cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2V0IHByb3BlcnRpZXMgZm9yIGJhdGNoaW5nLi5cbiAgICAgICAgdGhpcy5jYWxjdWxhdGVWZXJ0aWNlcygpO1xuICAgICAgICB0aGlzLmluZGljZXMgPSBnZW9tZXRyeS5pbmRleEJ1ZmZlci5kYXRhIGFzIFVpbnQxNkFycmF5O1xuICAgICAgICB0aGlzLl90aW50UkdCID0gdGhpcy5zaGFkZXIuX3RpbnRSR0I7XG4gICAgICAgIHRoaXMuX3RleHR1cmUgPSB0aGlzLnNoYWRlci50ZXh0dXJlO1xuXG4gICAgICAgIGNvbnN0IHBsdWdpbk5hbWUgPSB0aGlzLm1hdGVyaWFsLnBsdWdpbk5hbWU7XG5cbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guc2V0T2JqZWN0UmVuZGVyZXIocmVuZGVyZXIucGx1Z2luc1twbHVnaW5OYW1lXSk7XG4gICAgICAgIHJlbmRlcmVyLnBsdWdpbnNbcGx1Z2luTmFtZV0ucmVuZGVyKHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdmVydGV4RGF0YSBmaWVsZCBiYXNlZCBvbiB0cmFuc2Zvcm0gYW5kIHZlcnRpY2VzXG4gICAgICovXG4gICAgcHVibGljIGNhbGN1bGF0ZVZlcnRpY2VzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTtcbiAgICAgICAgY29uc3QgdmVydGljZXMgPSBnZW9tZXRyeS5idWZmZXJzWzBdLmRhdGE7XG5cbiAgICAgICAgaWYgKChnZW9tZXRyeSBhcyBhbnkpLnZlcnRleERpcnR5SWQgPT09IHRoaXMudmVydGV4RGlydHkgJiYgdGhpcy5fdHJhbnNmb3JtSUQgPT09IHRoaXMudHJhbnNmb3JtLl93b3JsZElEKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IHRoaXMudHJhbnNmb3JtLl93b3JsZElEO1xuXG4gICAgICAgIGlmICh0aGlzLnZlcnRleERhdGEubGVuZ3RoICE9PSB2ZXJ0aWNlcy5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudmVydGV4RGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMubGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHd0ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgICAgIGNvbnN0IGEgPSB3dC5hO1xuICAgICAgICBjb25zdCBiID0gd3QuYjtcbiAgICAgICAgY29uc3QgYyA9IHd0LmM7XG4gICAgICAgIGNvbnN0IGQgPSB3dC5kO1xuICAgICAgICBjb25zdCB0eCA9IHd0LnR4O1xuICAgICAgICBjb25zdCB0eSA9IHd0LnR5O1xuXG4gICAgICAgIGNvbnN0IHZlcnRleERhdGEgPSB0aGlzLnZlcnRleERhdGE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZXJ0ZXhEYXRhLmxlbmd0aCAvIDI7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeCA9IHZlcnRpY2VzWyhpICogMildO1xuICAgICAgICAgICAgY29uc3QgeSA9IHZlcnRpY2VzWyhpICogMikgKyAxXTtcblxuICAgICAgICAgICAgdmVydGV4RGF0YVsoaSAqIDIpXSA9IChhICogeCkgKyAoYyAqIHkpICsgdHg7XG4gICAgICAgICAgICB2ZXJ0ZXhEYXRhWyhpICogMikgKyAxXSA9IChiICogeCkgKyAoZCAqIHkpICsgdHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fcm91bmRQaXhlbHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSBzZXR0aW5ncy5SRVNPTFVUSU9OO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRleERhdGEubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmVydGV4RGF0YVtpXSA9IE1hdGgucm91bmQoKHZlcnRleERhdGFbaV0gKiByZXNvbHV0aW9uIHwgMCkgLyByZXNvbHV0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudmVydGV4RGlydHkgPSAoZ2VvbWV0cnkgYXMgYW55KS52ZXJ0ZXhEaXJ0eUlkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdXYgZmllbGQgYmFzZWQgb24gZnJvbSBnZW9tZXRyeSB1didzIG9yIGJhdGNoVXZzXG4gICAgICovXG4gICAgcHVibGljIGNhbGN1bGF0ZVV2cygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnZW9tVXZzID0gdGhpcy5nZW9tZXRyeS5idWZmZXJzWzFdO1xuXG4gICAgICAgIGlmICghdGhpcy5zaGFkZXIudXZNYXRyaXguaXNTaW1wbGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5iYXRjaFV2cylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoVXZzID0gbmV3IE1lc2hCYXRjaFV2cyhnZW9tVXZzLCB0aGlzLnNoYWRlci51dk1hdHJpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmJhdGNoVXZzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51dnMgPSB0aGlzLmJhdGNoVXZzLmRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnV2cyA9IGdlb21VdnMuZGF0YSBhcyBGbG9hdDMyQXJyYXk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBib3VuZHMgb2YgdGhlIG1lc2ggYXMgYSByZWN0YW5nbGUuIFRoZSBib3VuZHMgY2FsY3VsYXRpb24gdGFrZXMgdGhlIHdvcmxkVHJhbnNmb3JtIGludG8gYWNjb3VudC5cbiAgICAgKiB0aGVyZSBtdXN0IGJlIGEgYVZlcnRleFBvc2l0aW9uIGF0dHJpYnV0ZSBwcmVzZW50IGluIHRoZSBnZW9tZXRyeSBmb3IgYm91bmRzIHRvIGJlIGNhbGN1bGF0ZWQgY29ycmVjdGx5LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBfY2FsY3VsYXRlQm91bmRzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuY2FsY3VsYXRlVmVydGljZXMoKTtcblxuICAgICAgICB0aGlzLl9ib3VuZHMuYWRkVmVydGV4RGF0YSh0aGlzLnZlcnRleERhdGEsIDAsIHRoaXMudmVydGV4RGF0YS5sZW5ndGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlc3RzIGlmIGEgcG9pbnQgaXMgaW5zaWRlIHRoaXMgbWVzaC4gV29ya3Mgb25seSBmb3IgUElYSS5EUkFXX01PREVTLlRSSUFOR0xFUy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5JUG9pbnREYXRhfSBwb2ludCAtIHRoZSBwb2ludCB0byB0ZXN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gdGhlIHJlc3VsdCBvZiB0aGUgdGVzdFxuICAgICAqL1xuICAgIHB1YmxpYyBjb250YWluc1BvaW50KHBvaW50OiBJUG9pbnREYXRhKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgaWYgKCF0aGlzLmdldEJvdW5kcygpLmNvbnRhaW5zKHBvaW50LngsIHBvaW50LnkpKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLndvcmxkVHJhbnNmb3JtLmFwcGx5SW52ZXJzZShwb2ludCwgdGVtcFBvaW50KTtcblxuICAgICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMuZ2VvbWV0cnkuZ2V0QnVmZmVyKCdhVmVydGV4UG9zaXRpb24nKS5kYXRhO1xuXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IHRlbXBQb2x5Z29uLnBvaW50cztcbiAgICAgICAgY29uc3QgaW5kaWNlcyA9ICB0aGlzLmdlb21ldHJ5LmdldEluZGV4KCkuZGF0YTtcbiAgICAgICAgY29uc3QgbGVuID0gaW5kaWNlcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHN0ZXAgPSB0aGlzLmRyYXdNb2RlID09PSA0ID8gMyA6IDE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgKyAyIDwgbGVuOyBpICs9IHN0ZXApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGluZDAgPSBpbmRpY2VzW2ldICogMjtcbiAgICAgICAgICAgIGNvbnN0IGluZDEgPSBpbmRpY2VzW2kgKyAxXSAqIDI7XG4gICAgICAgICAgICBjb25zdCBpbmQyID0gaW5kaWNlc1tpICsgMl0gKiAyO1xuXG4gICAgICAgICAgICBwb2ludHNbMF0gPSB2ZXJ0aWNlc1tpbmQwXTtcbiAgICAgICAgICAgIHBvaW50c1sxXSA9IHZlcnRpY2VzW2luZDAgKyAxXTtcbiAgICAgICAgICAgIHBvaW50c1syXSA9IHZlcnRpY2VzW2luZDFdO1xuICAgICAgICAgICAgcG9pbnRzWzNdID0gdmVydGljZXNbaW5kMSArIDFdO1xuICAgICAgICAgICAgcG9pbnRzWzRdID0gdmVydGljZXNbaW5kMl07XG4gICAgICAgICAgICBwb2ludHNbNV0gPSB2ZXJ0aWNlc1tpbmQyICsgMV07XG5cbiAgICAgICAgICAgIGlmICh0ZW1wUG9seWdvbi5jb250YWlucyh0ZW1wUG9pbnQueCwgdGVtcFBvaW50LnkpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgTWVzaCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdHxib29sZWFufSBbb3B0aW9uc10gLSBPcHRpb25zIHBhcmFtZXRlci4gQSBib29sZWFuIHdpbGwgYWN0IGFzIGlmIGFsbFxuICAgICAqICBvcHRpb25zIGhhdmUgYmVlbiBzZXQgdG8gdGhhdCB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gaWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlXG4gICAgICogIHRoZWlyIGRlc3Ryb3kgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICovXG4gICAgcHVibGljIGRlc3Ryb3kob3B0aW9uczogSURlc3Ryb3lPcHRpb25zfGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBzdXBlci5kZXN0cm95KG9wdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuZ2VvbWV0cnkucmVmQ291bnQtLTtcbiAgICAgICAgaWYgKHRoaXMuZ2VvbWV0cnkucmVmQ291bnQgPT09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZ2VvbWV0cnkuZGlzcG9zZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgKHRoaXMgYXMgYW55KS5nZW9tZXRyeSA9IG51bGw7XG4gICAgICAgIHRoaXMuc2hhZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMudXZzID0gbnVsbDtcbiAgICAgICAgdGhpcy5pbmRpY2VzID0gbnVsbDtcbiAgICAgICAgdGhpcy52ZXJ0ZXhEYXRhID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgdmVydGljZXMgdG8gY29uc2lkZXIgYmF0Y2hhYmxlLiBHZW5lcmFsbHksIHRoZSBjb21wbGV4aXR5XG4gICAgICogb2YgdGhlIGdlb21ldHJ5LlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLk1lc2hcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlciB7bnVtYmVyfSBCQVRDSEFCTEVfU0laRVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgQkFUQ0hBQkxFX1NJWkUgPSAxMDA7XG59XG5cbiIsICJpbXBvcnQgeyBQcm9ncmFtLCBTaGFkZXIsIFRleHR1cmVNYXRyaXggfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IE1hdHJpeCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgcHJlbXVsdGlwbHlUaW50VG9SZ2JhIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IGZyYWdtZW50IGZyb20gJy4vc2hhZGVyL21lc2guZnJhZyc7XG5pbXBvcnQgdmVydGV4IGZyb20gJy4vc2hhZGVyL21lc2gudmVydCc7XG5cbmltcG9ydCB0eXBlIHsgVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElNZXNoTWF0ZXJpYWxPcHRpb25zIHtcbiAgICBhbHBoYT86IG51bWJlcjtcbiAgICB0aW50PzogbnVtYmVyO1xuICAgIHBsdWdpbk5hbWU/OiBzdHJpbmc7XG4gICAgcHJvZ3JhbT86IFByb2dyYW07XG4gICAgdW5pZm9ybXM/OiBEaWN0PHVua25vd24+O1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBNZXNoTWF0ZXJpYWwgZXh0ZW5kcyBHbG9iYWxNaXhpbnMuTWVzaE1hdGVyaWFsIHt9XG5cbi8qKlxuICogU2xpZ2h0bHkgb3BpbmlvbmF0ZWQgZGVmYXVsdCBzaGFkZXIgZm9yIFBpeGlKUyAyRCBvYmplY3RzLlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGV4dGVuZHMgUElYSS5TaGFkZXJcbiAqL1xuZXhwb3J0IGNsYXNzIE1lc2hNYXRlcmlhbCBleHRlbmRzIFNoYWRlclxue1xuICAgIHB1YmxpYyByZWFkb25seSB1dk1hdHJpeDogVGV4dHVyZU1hdHJpeDtcblxuICAgIHB1YmxpYyBiYXRjaGFibGU6IGJvb2xlYW47XG4gICAgcHVibGljIHBsdWdpbk5hbWU6IHN0cmluZztcblxuICAgIC8vIEludGVybmFsLW9ubHkgcHJvcGVydGllc1xuICAgIF90aW50UkdCOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIF9jb2xvckRpcnR5OiBib29sZWFuO1xuICAgIHByaXZhdGUgX2FscGhhOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfdGludDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmV9IHVTYW1wbGVyIC0gVGV4dHVyZSB0aGF0IG1hdGVyaWFsIHVzZXMgdG8gcmVuZGVyLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBBZGRpdGlvbmFsIG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMuYWxwaGE9MV0gLSBEZWZhdWx0IGFscGhhLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy50aW50PTB4RkZGRkZGXSAtIERlZmF1bHQgdGludC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMucGx1Z2luTmFtZT0nYmF0Y2gnXSAtIFJlbmRlcmVyIHBsdWdpbiBmb3IgYmF0Y2hpbmcuXG4gICAgICogQHBhcmFtIHtQSVhJLlByb2dyYW19IFtvcHRpb25zLnByb2dyYW09MHhGRkZGRkZdIC0gQ3VzdG9tIHByb2dyYW0uXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zLnVuaWZvcm1zXSAtIEN1c3RvbSB1bmlmb3Jtcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih1U2FtcGxlcjogVGV4dHVyZSwgb3B0aW9ucz86IElNZXNoTWF0ZXJpYWxPcHRpb25zKVxuICAgIHtcbiAgICAgICAgY29uc3QgdW5pZm9ybXMgPSB7XG4gICAgICAgICAgICB1U2FtcGxlcixcbiAgICAgICAgICAgIGFscGhhOiAxLFxuICAgICAgICAgICAgdVRleHR1cmVNYXRyaXg6IE1hdHJpeC5JREVOVElUWSxcbiAgICAgICAgICAgIHVDb2xvcjogbmV3IEZsb2F0MzJBcnJheShbMSwgMSwgMSwgMV0pLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFNldCBkZWZhdWx0c1xuICAgICAgICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB0aW50OiAweEZGRkZGRixcbiAgICAgICAgICAgIGFscGhhOiAxLFxuICAgICAgICAgICAgcGx1Z2luTmFtZTogJ2JhdGNoJyxcbiAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMudW5pZm9ybXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odW5pZm9ybXMsIG9wdGlvbnMudW5pZm9ybXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIob3B0aW9ucy5wcm9ncmFtIHx8IFByb2dyYW0uZnJvbSh2ZXJ0ZXgsIGZyYWdtZW50KSwgdW5pZm9ybXMpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPbmx5IGRvIHVwZGF0ZSBpZiB0aW50IG9yIGFscGhhIGNoYW5nZXMuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jb2xvckRpcnR5ID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRleHR1cmVNYXRyaXggaW5zdGFuY2UgZm9yIHRoaXMgTWVzaCwgdXNlZCB0byB0cmFjayBUZXh0dXJlIGNoYW5nZXNcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlTWF0cml4fVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZNYXRyaXggPSBuZXcgVGV4dHVyZU1hdHJpeCh1U2FtcGxlcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCBpZiBzaGFkZXIgY2FuIGJlIGJhdGNoIHdpdGggdGhlIHJlbmRlcmVyJ3MgYmF0Y2ggc3lzdGVtLlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJhdGNoYWJsZSA9IG9wdGlvbnMucHJvZ3JhbSA9PT0gdW5kZWZpbmVkO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW5kZXJlciBwbHVnaW4gZm9yIGJhdGNoaW5nXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQGRlZmF1bHQgJ2JhdGNoJ1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wbHVnaW5OYW1lID0gb3B0aW9ucy5wbHVnaW5OYW1lO1xuXG4gICAgICAgIHRoaXMudGludCA9IG9wdGlvbnMudGludDtcbiAgICAgICAgdGhpcy5hbHBoYSA9IG9wdGlvbnMuYWxwaGE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmZXJlbmNlIHRvIHRoZSB0ZXh0dXJlIGJlaW5nIHJlbmRlcmVkLlxuICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZX1cbiAgICAgKi9cbiAgICBnZXQgdGV4dHVyZSgpOiBUZXh0dXJlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy51bmlmb3Jtcy51U2FtcGxlcjtcbiAgICB9XG4gICAgc2V0IHRleHR1cmUodmFsdWU6IFRleHR1cmUpXG4gICAge1xuICAgICAgICBpZiAodGhpcy51bmlmb3Jtcy51U2FtcGxlciAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudW5pZm9ybXMudVNhbXBsZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudXZNYXRyaXgudGV4dHVyZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBnZXRzIGF1dG9tYXRpY2FsbHkgc2V0IGJ5IHRoZSBvYmplY3QgdXNpbmcgdGhpcy5cbiAgICAgKlxuICAgICAqIEBkZWZhdWx0IDFcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IGFscGhhKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodmFsdWUgPT09IHRoaXMuX2FscGhhKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5fYWxwaGEgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fY29sb3JEaXJ0eSA9IHRydWU7XG4gICAgfVxuICAgIGdldCBhbHBoYSgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbHBoYTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNdWx0aXBseSB0aW50IGZvciB0aGUgbWF0ZXJpYWwuXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDB4RkZGRkZGXG4gICAgICovXG4gICAgc2V0IHRpbnQodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5fdGludCkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuX3RpbnQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fdGludFJHQiA9ICh2YWx1ZSA+PiAxNikgKyAodmFsdWUgJiAweGZmMDApICsgKCh2YWx1ZSAmIDB4ZmYpIDw8IDE2KTtcbiAgICAgICAgdGhpcy5fY29sb3JEaXJ0eSA9IHRydWU7XG4gICAgfVxuICAgIGdldCB0aW50KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBjYWxsZWQgYXV0b21hdGljYWxseSBieSB0aGUgTWVzaC4gSW50ZW5kZWQgdG8gYmUgb3ZlcnJpZGRlbiBmb3IgY3VzdG9tXG4gICAgICogTWVzaE1hdGVyaWFsIG9iamVjdHMuXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fY29sb3JEaXJ0eSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fY29sb3JEaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgYmFzZVRleHR1cmUgPSB0aGlzLnRleHR1cmUuYmFzZVRleHR1cmU7XG5cbiAgICAgICAgICAgIHByZW11bHRpcGx5VGludFRvUmdiYShcbiAgICAgICAgICAgICAgICB0aGlzLl90aW50LCB0aGlzLl9hbHBoYSwgdGhpcy51bmlmb3Jtcy51Q29sb3IsIChiYXNlVGV4dHVyZS5hbHBoYU1vZGUgYXMgdW5rbm93biBhcyBib29sZWFuKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy51dk1hdHJpeC51cGRhdGUoKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy51VGV4dHVyZU1hdHJpeCA9IHRoaXMudXZNYXRyaXgubWFwQ29vcmQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVFlQRVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgQnVmZmVyLCBHZW9tZXRyeSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG5pbXBvcnQgdHlwZSB7IElBcnJheUJ1ZmZlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG4vKipcbiAqIFN0YW5kYXJkIDJEIGdlb21ldHJ5IHVzZWQgaW4gUGl4aUpTLlxuICpcbiAqIEdlb21ldHJ5IGNhbiBiZSBkZWZpbmVkIHdpdGhvdXQgcGFzc2luZyBpbiBhIHN0eWxlIG9yIGRhdGEgaWYgcmVxdWlyZWQuXG4gKlxuICogYGBganNcbiAqIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFBJWEkuR2VvbWV0cnkoKTtcbiAqXG4gKiBnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoJ3Bvc2l0aW9ucycsIFswLCAwLCAxMDAsIDAsIDEwMCwgMTAwLCAwLCAxMDBdLCAyKTtcbiAqIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgndXZzJywgWzAsMCwxLDAsMSwxLDAsMV0sIDIpO1xuICogZ2VvbWV0cnkuYWRkSW5kZXgoWzAsMSwyLDEsMywyXSk7XG4gKlxuICogYGBgXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAZXh0ZW5kcyBQSVhJLkdlb21ldHJ5XG4gKi9cbmV4cG9ydCBjbGFzcyBNZXNoR2VvbWV0cnkgZXh0ZW5kcyBHZW9tZXRyeVxue1xuICAgIC8vIEludGVybmFsLW9ubHkgcHJvcGVydGllc1xuICAgIF91cGRhdGVJZDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl8bnVtYmVyW119IFt2ZXJ0aWNlc10gLSBQb3NpdGlvbmFsIGRhdGEgb24gZ2VvbWV0cnkuXG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl8bnVtYmVyW119IFt1dnNdIC0gVGV4dHVyZSBVVnMuXG4gICAgICogQHBhcmFtIHtVaW50MTZBcnJheXxudW1iZXJbXX0gW2luZGV4XSAtIEluZGV4QnVmZmVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodmVydGljZXM/OiBJQXJyYXlCdWZmZXIsIHV2cz86IElBcnJheUJ1ZmZlciwgaW5kZXg/OiBJQXJyYXlCdWZmZXIpXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIGNvbnN0IHZlcnRpY2VzQnVmZmVyID0gbmV3IEJ1ZmZlcih2ZXJ0aWNlcyk7XG4gICAgICAgIGNvbnN0IHV2c0J1ZmZlciA9IG5ldyBCdWZmZXIodXZzLCB0cnVlKTtcbiAgICAgICAgY29uc3QgaW5kZXhCdWZmZXIgPSBuZXcgQnVmZmVyKGluZGV4LCB0cnVlLCB0cnVlKTtcblxuICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSgnYVZlcnRleFBvc2l0aW9uJywgdmVydGljZXNCdWZmZXIsIDIsIGZhbHNlLCBUWVBFUy5GTE9BVClcbiAgICAgICAgICAgIC5hZGRBdHRyaWJ1dGUoJ2FUZXh0dXJlQ29vcmQnLCB1dnNCdWZmZXIsIDIsIGZhbHNlLCBUWVBFUy5GTE9BVClcbiAgICAgICAgICAgIC5hZGRJbmRleChpbmRleEJ1ZmZlcik7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpcnR5IGZsYWcgdG8gbGltaXQgdXBkYXRlIGNhbGxzIG9uIE1lc2guIEZvciBleGFtcGxlLFxuICAgICAgICAgKiBsaW1pdGluZyB1cGRhdGVzIG9uIGEgc2luZ2xlIE1lc2ggaW5zdGFuY2Ugd2l0aCBhIHNoYXJlZCBHZW9tZXRyeVxuICAgICAgICAgKiB3aXRoaW4gdGhlIHJlbmRlciBsb29wLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IC0xXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl91cGRhdGVJZCA9IC0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRoZSB2ZXJ0ZXggcG9zaXRpb24gaXMgdXBkYXRlZC5cbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBnZXQgdmVydGV4RGlydHlJZCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlcnNbMF0uX3VwZGF0ZUlEO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICIvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG5cbi8qKlxuICogTm9ybWFsaXplZCBwYXJzZWQgZGF0YSBmcm9tIC5mbnQgZmlsZXMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQml0bWFwRm9udERhdGFcbntcbiAgICBwdWJsaWMgaW5mbzogSUJpdG1hcEZvbnREYXRhSW5mb1tdO1xuICAgIHB1YmxpYyBjb21tb246IElCaXRtYXBGb250RGF0YUNvbW1vbltdO1xuICAgIHB1YmxpYyBwYWdlOiBJQml0bWFwRm9udERhdGFQYWdlW107XG4gICAgcHVibGljIGNoYXI6IElCaXRtYXBGb250RGF0YUNoYXJbXTtcbiAgICBwdWJsaWMga2VybmluZzogSUJpdG1hcEZvbnREYXRhS2VybmluZ1tdO1xuXG4gICAgY29uc3RydWN0b3IoKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuSUJpdG1hcEZvbnREYXRhSW5mb1tdfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5mbyA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLklCaXRtYXBGb250RGF0YUNvbW1vbltdfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY29tbW9uID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuSUJpdG1hcEZvbnREYXRhUGFnZVtdfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGFnZSA9IFtdO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLklCaXRtYXBGb250RGF0YUNoYXJbXX1cbiAgICAgICAgICogQHJlYWRPbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoYXIgPSBbXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5JQml0bWFwRm9udERhdGFLZXJuaW5nW119XG4gICAgICAgICAqIEByZWFkT25seVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5rZXJuaW5nID0gW107XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElCaXRtYXBGb250RGF0YUluZm8ge1xuICAgIGZhY2U6IHN0cmluZztcbiAgICBzaXplOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJpdG1hcEZvbnREYXRhQ29tbW9uIHtcbiAgICBsaW5lSGVpZ2h0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJpdG1hcEZvbnREYXRhUGFnZSB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBmaWxlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJpdG1hcEZvbnREYXRhQ2hhciB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbiAgICB3aWR0aDogbnVtYmVyO1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIHhvZmZzZXQ6IG51bWJlcjtcbiAgICB5b2Zmc2V0OiBudW1iZXI7XG4gICAgeGFkdmFuY2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQml0bWFwRm9udERhdGFLZXJuaW5nIHtcbiAgICBmaXJzdDogbnVtYmVyO1xuICAgIHNlY29uZDogbnVtYmVyO1xuICAgIGFtb3VudDogbnVtYmVyO1xufVxuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBJQml0bWFwRm9udERhdGFJbmZvXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZmFjZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHNpemVcbiAqL1xuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBJQml0bWFwRm9udERhdGFDb21tb25cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBsaW5lSGVpZ2h0XG4gKi9cblxuLyoqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHR5cGVkZWYge29iamVjdH0gSUJpdG1hcEZvbnREYXRhUGFnZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IGlkXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZmlsZVxuICovXG5cbi8qKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEB0eXBlZGVmIHtvYmplY3R9IElCaXRtYXBGb250RGF0YUNoYXJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZFxuICogQHByb3BlcnR5IHtudW1iZXJ9IHBhZ2VcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB4XG4gKiBAcHJvcGVydHkge251bWJlcn0geVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHdpZHRoXG4gKiBAcHJvcGVydHkge251bWJlcn0gaGVpZ2h0XG4gKiBAcHJvcGVydHkge251bWJlcn0geG9mZnNldFxuICogQHByb3BlcnR5IHtudW1iZXJ9IHlvZmZzZXRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB4YWR2YW5jZVxuICovXG5cbi8qKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEB0eXBlZGVmIHtvYmplY3R9IElCaXRtYXBGb250RGF0YUtlcm5pbmdcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmaXJzdFxuICogQHByb3BlcnR5IHtudW1iZXJ9IHNlY29uZFxuICogQHByb3BlcnR5IHtudW1iZXJ9IGFtb3VudFxuICovXG4iLCAiaW1wb3J0IHsgQml0bWFwRm9udERhdGEgfSBmcm9tICcuLi9CaXRtYXBGb250RGF0YSc7XG5cbi8qKlxuICogSW50ZXJuYWwgZGF0YSBmb3JtYXQgdXNlZCB0byBjb252ZXJ0IHRvIEJpdG1hcEZvbnREYXRhLlxuICogQHByaXZhdGVcbiAqL1xuaW50ZXJmYWNlIElCaXRtYXBGb250UmF3RGF0YSB7XG4gICAgaW5mbzoge1xuICAgICAgICBmYWNlOiBzdHJpbmc7XG4gICAgICAgIHNpemU6IHN0cmluZztcbiAgICB9W107XG4gICAgY29tbW9uOiB7IGxpbmVIZWlnaHQ6IHN0cmluZyB9W107XG4gICAgcGFnZToge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICBmaWxlOiBzdHJpbmc7XG4gICAgfVtdO1xuICAgIGNoYXJzOiB7XG4gICAgICAgIGNvdW50OiBudW1iZXI7XG4gICAgfVtdO1xuICAgIGNoYXI6IHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgcGFnZTogc3RyaW5nO1xuICAgICAgICB4OiBzdHJpbmc7XG4gICAgICAgIHk6IHN0cmluZztcbiAgICAgICAgd2lkdGg6IHN0cmluZztcbiAgICAgICAgaGVpZ2h0OiBzdHJpbmc7XG4gICAgICAgIHhvZmZzZXQ6IHN0cmluZztcbiAgICAgICAgeW9mZnNldDogc3RyaW5nO1xuICAgICAgICB4YWR2YW5jZTogc3RyaW5nO1xuICAgIH1bXTtcbiAgICBrZXJuaW5ncz86IHtcbiAgICAgICAgY291bnQ6IG51bWJlcjtcbiAgICB9W107XG4gICAga2VybmluZz86IHtcbiAgICAgICAgZmlyc3Q6IHN0cmluZztcbiAgICAgICAgc2Vjb25kOiBzdHJpbmc7XG4gICAgICAgIGFtb3VudDogc3RyaW5nO1xuICAgIH1bXTtcbn1cblxuLyoqXG4gKiBCaXRtYXBGb250IGZvcm1hdCB0aGF0J3MgVGV4dC1iYXNlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBjbGFzcyBUZXh0Rm9ybWF0XG57XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgcmVzb3VyY2UgcmVmZXJzIHRvIHR4dCBmb250IGRhdGEuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge2FueX0gZGF0YVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgcmVzb3VyY2UgY291bGQgYmUgdHJlYXRlZCBhcyBmb250IGRhdGEsIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChkYXRhOiB1bmtub3duKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyAmJiBkYXRhLmluZGV4T2YoJ2luZm8gZmFjZT0nKSA9PT0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRleHQgZm9udCBkYXRhIHRvIGEgamF2YXNjcmlwdCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHh0IC0gUmF3IHN0cmluZyBkYXRhIHRvIGJlIGNvbnZlcnRlZFxuICAgICAqIEByZXR1cm4ge1BJWEkuQml0bWFwRm9udERhdGF9IFBhcnNlZCBmb250IGRhdGFcbiAgICAgKi9cbiAgICBzdGF0aWMgcGFyc2UodHh0OiBzdHJpbmcpOiBCaXRtYXBGb250RGF0YVxuICAgIHtcbiAgICAgICAgLy8gUmV0cmlldmUgZGF0YSBpdGVtXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdHh0Lm1hdGNoKC9eW2Etel0rXFxzKy4rJC9nbSk7XG4gICAgICAgIGNvbnN0IHJhd0RhdGE6IElCaXRtYXBGb250UmF3RGF0YSA9IHtcbiAgICAgICAgICAgIGluZm86IFtdLFxuICAgICAgICAgICAgY29tbW9uOiBbXSxcbiAgICAgICAgICAgIHBhZ2U6IFtdLFxuICAgICAgICAgICAgY2hhcjogW10sXG4gICAgICAgICAgICBjaGFyczogW10sXG4gICAgICAgICAgICBrZXJuaW5nOiBbXSxcbiAgICAgICAgICAgIGtlcm5pbmdzOiBbXSxcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gaXRlbXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgaXRlbSBuYW1lXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gaXRlbXNbaV0ubWF0Y2goL15bYS16XSsvZ20pWzBdIGFzIGtleW9mIEJpdG1hcEZvbnREYXRhO1xuXG4gICAgICAgICAgICAvLyBFeHRyYWN0IGl0ZW0gYXR0cmlidXRlIGxpc3QgYXMgc3RyaW5nIGV4LjogXCJ3aWR0aD0xMFwiXG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVMaXN0ID0gaXRlbXNbaV0ubWF0Y2goL1thLXpBLVpdKz0oW15cXHNcIiddK3xcIihbXlwiXSopXCIpL2dtKTtcblxuICAgICAgICAgICAgLy8gQ29udmVydCBhdHRyaWJ1dGUgbGlzdCBpbnRvIGFuIG9iamVjdFxuICAgICAgICAgICAgY29uc3QgaXRlbURhdGE6IGFueSA9IHt9O1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgaW4gYXR0cmlidXRlTGlzdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBTcGxpdCBrZXktdmFsdWUgcGFpcnNcbiAgICAgICAgICAgICAgICBjb25zdCBzcGxpdCA9IGF0dHJpYnV0ZUxpc3RbaV0uc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBzcGxpdFswXTtcblxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBldmVudHVhbCBxdW90ZXMgZnJvbSB2YWx1ZVxuICAgICAgICAgICAgICAgIGNvbnN0IHN0clZhbHVlID0gc3BsaXRbMV0ucmVwbGFjZSgvXCIvZ20sICcnKTtcblxuICAgICAgICAgICAgICAgIC8vIFRyeSB0byBjb252ZXJ0IHZhbHVlIGludG8gZmxvYXRcbiAgICAgICAgICAgICAgICBjb25zdCBmbG9hdFZhbHVlID0gcGFyc2VGbG9hdChzdHJWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBVc2Ugc3RyaW5nIHZhbHVlIGNhc2UgZmxvYXQgdmFsdWUgaXMgTmFOXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBpc05hTihmbG9hdFZhbHVlKSA/IHN0clZhbHVlIDogZmxvYXRWYWx1ZTtcblxuICAgICAgICAgICAgICAgIGl0ZW1EYXRhW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHVzaCBjdXJyZW50IGl0ZW0gdG8gdGhlIHJlc3VsdGluZyBkYXRhXG4gICAgICAgICAgICByYXdEYXRhW25hbWVdLnB1c2goaXRlbURhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZm9udCA9IG5ldyBCaXRtYXBGb250RGF0YSgpO1xuXG4gICAgICAgIHJhd0RhdGEuaW5mby5mb3JFYWNoKChpbmZvKSA9PiBmb250LmluZm8ucHVzaCh7XG4gICAgICAgICAgICBmYWNlOiBpbmZvLmZhY2UsXG4gICAgICAgICAgICBzaXplOiBwYXJzZUludChpbmZvLnNpemUsIDEwKSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHJhd0RhdGEuY29tbW9uLmZvckVhY2goKGNvbW1vbikgPT4gZm9udC5jb21tb24ucHVzaCh7XG4gICAgICAgICAgICBsaW5lSGVpZ2h0OiBwYXJzZUludChjb21tb24ubGluZUhlaWdodCwgMTApLFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmF3RGF0YS5wYWdlLmZvckVhY2goKHBhZ2UpID0+IGZvbnQucGFnZS5wdXNoKHtcbiAgICAgICAgICAgIGlkOiBwYXJzZUludChwYWdlLmlkLCAxMCksXG4gICAgICAgICAgICBmaWxlOiBwYWdlLmZpbGUsXG4gICAgICAgIH0pKTtcblxuICAgICAgICByYXdEYXRhLmNoYXIuZm9yRWFjaCgoY2hhcikgPT4gZm9udC5jaGFyLnB1c2goe1xuICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGNoYXIuaWQsIDEwKSxcbiAgICAgICAgICAgIHBhZ2U6IHBhcnNlSW50KGNoYXIucGFnZSwgMTApLFxuICAgICAgICAgICAgeDogcGFyc2VJbnQoY2hhci54LCAxMCksXG4gICAgICAgICAgICB5OiBwYXJzZUludChjaGFyLnksIDEwKSxcbiAgICAgICAgICAgIHdpZHRoOiBwYXJzZUludChjaGFyLndpZHRoLCAxMCksXG4gICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KGNoYXIuaGVpZ2h0LCAxMCksXG4gICAgICAgICAgICB4b2Zmc2V0OiBwYXJzZUludChjaGFyLnhvZmZzZXQsIDEwKSxcbiAgICAgICAgICAgIHlvZmZzZXQ6IHBhcnNlSW50KGNoYXIueW9mZnNldCwgMTApLFxuICAgICAgICAgICAgeGFkdmFuY2U6IHBhcnNlSW50KGNoYXIueGFkdmFuY2UsIDEwKSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHJhd0RhdGEua2VybmluZy5mb3JFYWNoKChrZXJuaW5nKSA9PiBmb250Lmtlcm5pbmcucHVzaCh7XG4gICAgICAgICAgICBmaXJzdDogcGFyc2VJbnQoa2VybmluZy5maXJzdCwgMTApLFxuICAgICAgICAgICAgc2Vjb25kOiBwYXJzZUludChrZXJuaW5nLnNlY29uZCwgMTApLFxuICAgICAgICAgICAgYW1vdW50OiBwYXJzZUludChrZXJuaW5nLmFtb3VudCwgMTApLFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmV0dXJuIGZvbnQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEJpdG1hcEZvbnREYXRhIH0gZnJvbSAnLi4vQml0bWFwRm9udERhdGEnO1xuXG4vKipcbiAqIEJpdG1hcEZvbnQgZm9ybWF0IHRoYXQncyBYTUwtYmFzZWQuXG4gKlxuICogQGNsYXNzXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgY2xhc3MgWE1MRm9ybWF0XG57XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgcmVzb3VyY2UgcmVmZXJzIHRvIHhtbCBmb250IGRhdGEuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge2FueX0gZGF0YVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgcmVzb3VyY2UgY291bGQgYmUgdHJlYXRlZCBhcyBmb250IGRhdGEsIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgdGVzdChkYXRhOiB1bmtub3duKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIGRhdGEgaW5zdGFuY2VvZiBYTUxEb2N1bWVudFxuICAgICAgICAgICAgJiYgZGF0YS5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGFnZScpLmxlbmd0aFxuICAgICAgICAgICAgJiYgZGF0YS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5mbycpWzBdLmdldEF0dHJpYnV0ZSgnZmFjZScpICE9PSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnQgdGhlIFhNTCBpbnRvIEJpdG1hcEZvbnREYXRhIHRoYXQgd2UgY2FuIHVzZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7WE1MRG9jdW1lbnR9IHhtbFxuICAgICAqIEByZXR1cm4ge0JpdG1hcEZvbnREYXRhfSBEYXRhIHRvIHVzZSBmb3IgQml0bWFwRm9udFxuICAgICAqL1xuICAgIHN0YXRpYyBwYXJzZSh4bWw6IFhNTERvY3VtZW50KTogQml0bWFwRm9udERhdGFcbiAgICB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgQml0bWFwRm9udERhdGEoKTtcbiAgICAgICAgY29uc3QgaW5mbyA9IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5mbycpO1xuICAgICAgICBjb25zdCBjb21tb24gPSB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NvbW1vbicpO1xuICAgICAgICBjb25zdCBwYWdlID0geG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdwYWdlJyk7XG4gICAgICAgIGNvbnN0IGNoYXIgPSB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NoYXInKTtcbiAgICAgICAgY29uc3Qga2VybmluZyA9IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgna2VybmluZycpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5mby5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgZGF0YS5pbmZvLnB1c2goe1xuICAgICAgICAgICAgICAgIGZhY2U6IGluZm9baV0uZ2V0QXR0cmlidXRlKCdmYWNlJyksXG4gICAgICAgICAgICAgICAgc2l6ZTogcGFyc2VJbnQoaW5mb1tpXS5nZXRBdHRyaWJ1dGUoJ3NpemUnKSwgMTApLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbW1vbi5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgZGF0YS5jb21tb24ucHVzaCh7XG4gICAgICAgICAgICAgICAgbGluZUhlaWdodDogcGFyc2VJbnQoY29tbW9uW2ldLmdldEF0dHJpYnV0ZSgnbGluZUhlaWdodCcpLCAxMCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgZGF0YS5wYWdlLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBwYXJzZUludChwYWdlW2ldLmdldEF0dHJpYnV0ZSgnaWQnKSwgMTApIHx8IDAsXG4gICAgICAgICAgICAgICAgZmlsZTogcGFnZVtpXS5nZXRBdHRyaWJ1dGUoJ2ZpbGUnKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFyLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBsZXR0ZXIgPSBjaGFyW2ldO1xuXG4gICAgICAgICAgICBkYXRhLmNoYXIucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGxldHRlci5nZXRBdHRyaWJ1dGUoJ2lkJyksIDEwKSxcbiAgICAgICAgICAgICAgICBwYWdlOiBwYXJzZUludChsZXR0ZXIuZ2V0QXR0cmlidXRlKCdwYWdlJyksIDEwKSB8fCAwLFxuICAgICAgICAgICAgICAgIHg6IHBhcnNlSW50KGxldHRlci5nZXRBdHRyaWJ1dGUoJ3gnKSwgMTApLFxuICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGxldHRlci5nZXRBdHRyaWJ1dGUoJ3knKSwgMTApLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBwYXJzZUludChsZXR0ZXIuZ2V0QXR0cmlidXRlKCd3aWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJzZUludChsZXR0ZXIuZ2V0QXR0cmlidXRlKCdoZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgIHhvZmZzZXQ6IHBhcnNlSW50KGxldHRlci5nZXRBdHRyaWJ1dGUoJ3hvZmZzZXQnKSwgMTApLFxuICAgICAgICAgICAgICAgIHlvZmZzZXQ6IHBhcnNlSW50KGxldHRlci5nZXRBdHRyaWJ1dGUoJ3lvZmZzZXQnKSwgMTApLFxuICAgICAgICAgICAgICAgIHhhZHZhbmNlOiBwYXJzZUludChsZXR0ZXIuZ2V0QXR0cmlidXRlKCd4YWR2YW5jZScpLCAxMCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2VybmluZy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgZGF0YS5rZXJuaW5nLnB1c2goe1xuICAgICAgICAgICAgICAgIGZpcnN0OiBwYXJzZUludChrZXJuaW5nW2ldLmdldEF0dHJpYnV0ZSgnZmlyc3QnKSwgMTApLFxuICAgICAgICAgICAgICAgIHNlY29uZDogcGFyc2VJbnQoa2VybmluZ1tpXS5nZXRBdHRyaWJ1dGUoJ3NlY29uZCcpLCAxMCksXG4gICAgICAgICAgICAgICAgYW1vdW50OiBwYXJzZUludChrZXJuaW5nW2ldLmdldEF0dHJpYnV0ZSgnYW1vdW50JyksIDEwKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEJpdG1hcEZvbnREYXRhIH0gZnJvbSAnLi4vQml0bWFwRm9udERhdGEnO1xuaW1wb3J0IHsgWE1MRm9ybWF0IH0gZnJvbSAnLi9YTUxGb3JtYXQnO1xuXG4vKipcbiAqIEJpdG1hcEZvbnQgZm9ybWF0IHRoYXQncyBYTUwtYmFzZWQuXG4gKlxuICogQGNsYXNzXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgY2xhc3MgWE1MU3RyaW5nRm9ybWF0XG57XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgcmVzb3VyY2UgcmVmZXJzIHRvIHRleHQgeG1sIGZvbnQgZGF0YS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7YW55fSBkYXRhXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiByZXNvdXJjZSBjb3VsZCBiZSB0cmVhdGVkIGFzIGZvbnQgZGF0YSwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIHN0YXRpYyB0ZXN0KGRhdGE6IHVua25vd24pOiBib29sZWFuXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnICYmIGRhdGEuaW5kZXhPZignPGZvbnQ+JykgPiAtMSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeG1sID0gbmV3IHNlbGYuRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGRhdGEsICd0ZXh0L3htbCcpO1xuXG4gICAgICAgICAgICByZXR1cm4gWE1MRm9ybWF0LnRlc3QoeG1sKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRoZSB0ZXh0IFhNTCBpbnRvIEJpdG1hcEZvbnREYXRhIHRoYXQgd2UgY2FuIHVzZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB4bWxUeHRcbiAgICAgKiBAcmV0dXJuIHtCaXRtYXBGb250RGF0YX0gRGF0YSB0byB1c2UgZm9yIEJpdG1hcEZvbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgcGFyc2UoeG1sVHh0OiBzdHJpbmcpOiBCaXRtYXBGb250RGF0YVxuICAgIHtcbiAgICAgICAgY29uc3QgeG1sID0gbmV3IHdpbmRvdy5ET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeG1sVHh0LCAndGV4dC94bWwnKTtcblxuICAgICAgICByZXR1cm4gWE1MRm9ybWF0LnBhcnNlKHhtbCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRleHRGb3JtYXQgfSBmcm9tICcuL1RleHRGb3JtYXQnO1xuaW1wb3J0IHsgWE1MRm9ybWF0IH0gZnJvbSAnLi9YTUxGb3JtYXQnO1xuaW1wb3J0IHsgWE1MU3RyaW5nRm9ybWF0IH0gZnJvbSAnLi9YTUxTdHJpbmdGb3JtYXQnO1xuXG4vLyBSZWdpc3RlcmVkIGZvcm1hdHMsIG1heWJlIG1ha2UgdGhpcyBleHRlbnNpYmxlIGluIHRoZSBmdXR1cmU/XG5jb25zdCBmb3JtYXRzID0gW1xuICAgIFRleHRGb3JtYXQsXG4gICAgWE1MRm9ybWF0LFxuICAgIFhNTFN0cmluZ0Zvcm1hdCxcbl0gYXMgY29uc3Q7XG5cbi8qKlxuICogQXV0by1kZXRlY3QgQml0bWFwRm9udCBwYXJzaW5nIGZvcm1hdCBiYXNlZCBvbiBkYXRhLlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7YW55fSBkYXRhIC0gRGF0YSB0byBkZXRlY3QgZm9ybWF0XG4gKiBAcmV0dXJuIHthbnl9IEZvcm1hdCBvciBudWxsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhdXRvRGV0ZWN0Rm9ybWF0KGRhdGE6IHVua25vd24pOiB0eXBlb2YgZm9ybWF0c1tudW1iZXJdIHwgbnVsbFxue1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm9ybWF0cy5sZW5ndGg7IGkrKylcbiAgICB7XG4gICAgICAgIGlmIChmb3JtYXRzW2ldLnRlc3QoZGF0YSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG59XG4iLCAiaW1wb3J0IHsgVGV4dFN0eWxlLCBUZXh0TWV0cmljcywgVEVYVF9HUkFESUVOVCB9IGZyb20gJ0BwaXhpL3RleHQnO1xuXG4vLyBUT0RPOiBQcmV2ZW50IGNvZGUgZHVwbGljYXRpb24gYi93IGdlbmVyYXRlRmlsbFN0eWxlICYgVGV4dCNnZW5lcmF0ZUZpbGxTdHlsZVxuXG4vKipcbiAqIEdlbmVyYXRlcyB0aGUgZmlsbCBzdHlsZS4gQ2FuIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGUgYSBncmFkaWVudCBiYXNlZCBvbiB0aGUgZmlsbCBzdHlsZSBiZWluZyBhbiBhcnJheVxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge29iamVjdH0gc3R5bGUgLSBUaGUgc3R5bGUuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBsaW5lcyAtIFRoZSBsaW5lcyBvZiB0ZXh0LlxuICogQHJldHVybiB7c3RyaW5nfG51bWJlcnxDYW52YXNHcmFkaWVudH0gVGhlIGZpbGwgc3R5bGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlRmlsbFN0eWxlKFxuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIHN0eWxlOiBUZXh0U3R5bGUsXG4gICAgcmVzb2x1dGlvbjogbnVtYmVyLFxuICAgIGxpbmVzOiBzdHJpbmdbXSxcbiAgICBtZXRyaWNzOiBUZXh0TWV0cmljc1xuKTogc3RyaW5nfENhbnZhc0dyYWRpZW50fENhbnZhc1BhdHRlcm5cbntcbiAgICAvLyBUT0RPOiBDYW4ndCBoYXZlIGRpZmZlcmVudCB0eXBlcyBmb3IgZ2V0dGVyIGFuZCBzZXR0ZXIuIFRoZSBnZXR0ZXIgc2hvdWxkbid0IGhhdmUgdGhlIG51bWJlciB0eXBlIGFzXG4gICAgLy8gICAgICAgdGhlIHNldHRlciBjb252ZXJ0cyB0byBzdHJpbmcuIFNlZSB0aGlzIHRocmVhZCBmb3IgbW9yZSBkZXRhaWxzOlxuICAgIC8vICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMjUyMVxuICAgIGNvbnN0IGZpbGxTdHlsZTogc3RyaW5nfHN0cmluZ1tdfENhbnZhc0dyYWRpZW50fENhbnZhc1BhdHRlcm4gPSBzdHlsZS5maWxsIGFzIGFueTtcblxuICAgIGlmICghQXJyYXkuaXNBcnJheShmaWxsU3R5bGUpKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGZpbGxTdHlsZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZmlsbFN0eWxlLmxlbmd0aCA9PT0gMSlcbiAgICB7XG4gICAgICAgIHJldHVybiBmaWxsU3R5bGVbMF07XG4gICAgfVxuXG4gICAgLy8gdGhlIGdyYWRpZW50IHdpbGwgYmUgZXZlbmx5IHNwYWNlZCBvdXQgYWNjb3JkaW5nIHRvIGhvdyBsYXJnZSB0aGUgYXJyYXkgaXMuXG4gICAgLy8gWycjRkYwMDAwJywgJyMwMEZGMDAnLCAnIzAwMDBGRiddIHdvdWxkIGNyZWF0ZWQgc3RvcHMgYXQgMC4yNSwgMC41IGFuZCAwLjc1XG4gICAgbGV0IGdyYWRpZW50OiBzdHJpbmdbXXxDYW52YXNHcmFkaWVudDtcblxuICAgIC8vIGEgZHJvcHNoYWRvdyB3aWxsIGVubGFyZ2UgdGhlIGNhbnZhcyBhbmQgcmVzdWx0IGluIHRoZSBncmFkaWVudCBiZWluZ1xuICAgIC8vIGdlbmVyYXRlZCB3aXRoIHRoZSBpbmNvcnJlY3QgZGltZW5zaW9uc1xuICAgIGNvbnN0IGRyb3BTaGFkb3dDb3JyZWN0aW9uID0gKHN0eWxlLmRyb3BTaGFkb3cpID8gc3R5bGUuZHJvcFNoYWRvd0Rpc3RhbmNlIDogMDtcblxuICAgIC8vIHNob3VsZCBhbHNvIHRha2UgcGFkZGluZyBpbnRvIGFjY291bnQsIHBhZGRpbmcgY2FuIG9mZnNldCB0aGUgZ3JhZGllbnRcbiAgICBjb25zdCBwYWRkaW5nID0gc3R5bGUucGFkZGluZyB8fCAwO1xuXG4gICAgY29uc3Qgd2lkdGggPSBNYXRoLmNlaWwoY2FudmFzLndpZHRoIC8gcmVzb2x1dGlvbikgLSBkcm9wU2hhZG93Q29ycmVjdGlvbiAtIChwYWRkaW5nICogMik7XG4gICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5jZWlsKGNhbnZhcy5oZWlnaHQgLyByZXNvbHV0aW9uKSAtIGRyb3BTaGFkb3dDb3JyZWN0aW9uIC0gKHBhZGRpbmcgKiAyKTtcblxuICAgIC8vIG1ha2UgYSBjb3B5IG9mIHRoZSBzdHlsZSBzZXR0aW5ncywgc28gd2UgY2FuIG1hbmlwdWxhdGUgdGhlbSBsYXRlclxuICAgIGNvbnN0IGZpbGwgPSBmaWxsU3R5bGUuc2xpY2UoKTtcbiAgICBjb25zdCBmaWxsR3JhZGllbnRTdG9wcyA9IHN0eWxlLmZpbGxHcmFkaWVudFN0b3BzLnNsaWNlKCk7XG5cbiAgICAvLyB3YW50aW5nIHRvIGV2ZW5seSBkaXN0cmlidXRlIHRoZSBmaWxscy4gU28gYW4gYXJyYXkgb2YgNCBjb2xvdXJzIHNob3VsZCBnaXZlIGZpbGxzIG9mIDAuMjUsIDAuNSBhbmQgMC43NVxuICAgIGlmICghZmlsbEdyYWRpZW50U3RvcHMubGVuZ3RoKVxuICAgIHtcbiAgICAgICAgY29uc3QgbGVuZ3RoUGx1czEgPSBmaWxsLmxlbmd0aCArIDE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsZW5ndGhQbHVzMTsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgICBmaWxsR3JhZGllbnRTdG9wcy5wdXNoKGkgLyBsZW5ndGhQbHVzMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBzdG9wIHRoZSBibGVlZGluZyBvZiB0aGUgbGFzdCBncmFkaWVudCBvbiB0aGUgbGluZSBhYm92ZSB0byB0aGUgdG9wIGdyYWRpZW50IG9mIHRoZSB0aGlzIGxpbmVcbiAgICAvLyBieSBoYXJkIGRlZmluaW5nIHRoZSBmaXJzdCBncmFkaWVudCBjb2xvdXIgYXQgcG9pbnQgMCwgYW5kIGxhc3QgZ3JhZGllbnQgY29sb3VyIGF0IHBvaW50IDFcbiAgICBmaWxsLnVuc2hpZnQoZmlsbFN0eWxlWzBdKTtcbiAgICBmaWxsR3JhZGllbnRTdG9wcy51bnNoaWZ0KDApO1xuXG4gICAgZmlsbC5wdXNoKGZpbGxTdHlsZVtmaWxsU3R5bGUubGVuZ3RoIC0gMV0pO1xuICAgIGZpbGxHcmFkaWVudFN0b3BzLnB1c2goMSk7XG5cbiAgICBpZiAoc3R5bGUuZmlsbEdyYWRpZW50VHlwZSA9PT0gVEVYVF9HUkFESUVOVC5MSU5FQVJfVkVSVElDQUwpXG4gICAge1xuICAgICAgICAvLyBzdGFydCB0aGUgZ3JhZGllbnQgYXQgdGhlIHRvcCBjZW50ZXIgb2YgdGhlIGNhbnZhcywgYW5kIGVuZCBhdCB0aGUgYm90dG9tIG1pZGRsZSBvZiB0aGUgY2FudmFzXG4gICAgICAgIGdyYWRpZW50ID0gY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCh3aWR0aCAvIDIsIHBhZGRpbmcsIHdpZHRoIC8gMiwgaGVpZ2h0ICsgcGFkZGluZyk7XG5cbiAgICAgICAgLy8gd2UgbmVlZCB0byByZXBlYXQgdGhlIGdyYWRpZW50IHNvIHRoYXQgZWFjaCBpbmRpdmlkdWFsIGxpbmUgb2YgdGV4dCBoYXMgdGhlIHNhbWUgdmVydGljYWwgZ3JhZGllbnQgZWZmZWN0XG4gICAgICAgIC8vIFsnI0ZGMDAwMCcsICcjMDBGRjAwJywgJyMwMDAwRkYnXSBvdmVyIDIgbGluZXMgd291bGQgY3JlYXRlIHN0b3BzIGF0IDAuMTI1LCAwLjI1LCAwLjM3NSwgMC42MjUsIDAuNzUsIDAuODc1XG5cbiAgICAgICAgLy8gVGhlcmUncyBwb3RlbnRpYWwgZm9yIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbiBpc3N1ZXMgYXQgdGhlIHNlYW1zIGJldHdlZW4gZ3JhZGllbnQgcmVwZWF0cy5cbiAgICAgICAgLy8gVGhlIGxvb3AgYmVsb3cgZ2VuZXJhdGVzIHRoZSBzdG9wcyBpbiBvcmRlciwgc28gdHJhY2sgdGhlIGxhc3QgZ2VuZXJhdGVkIG9uZSB0byBwcmV2ZW50XG4gICAgICAgIC8vIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbiBmcm9tIG1ha2luZyB1cyBnbyB0aGUgdGVlbmllc3QgYml0IGJhY2t3YXJkcywgcmVzdWx0aW5nIGluXG4gICAgICAgIC8vIHRoZSBmaXJzdCBhbmQgbGFzdCBjb2xvcnMgZ2V0dGluZyBzd2FwcGVkLlxuICAgICAgICBsZXQgbGFzdEl0ZXJhdGlvblN0b3AgPSAwO1xuXG4gICAgICAgIC8vIEFjdHVhbCBoZWlnaHQgb2YgdGhlIHRleHQgaXRzZWxmLCBub3QgY291bnRpbmcgc3BhY2luZyBmb3IgbGluZUhlaWdodC9sZWFkaW5nL2Ryb3BTaGFkb3cgZXRjXG4gICAgICAgIGNvbnN0IHRleHRIZWlnaHQgPSBtZXRyaWNzLmZvbnRQcm9wZXJ0aWVzLmZvbnRTaXplICsgc3R5bGUuc3Ryb2tlVGhpY2tuZXNzO1xuXG4gICAgICAgIC8vIHRleHRIZWlnaHQsIGJ1dCBhcyBhIDAtMSBzaXplIGluIGdsb2JhbCBncmFkaWVudCBzdG9wIHNwYWNlXG4gICAgICAgIGNvbnN0IGdyYWRTdG9wTGluZUhlaWdodCA9IHRleHRIZWlnaHQgLyBoZWlnaHQ7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdGhpc0xpbmVUb3AgPSBtZXRyaWNzLmxpbmVIZWlnaHQgKiBpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGZpbGwubGVuZ3RoOyBqKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gMC0xIHN0b3AgcG9pbnQgZm9yIHRoZSBjdXJyZW50IGxpbmUsIG11bHRpcGxpZWQgdG8gZ2xvYmFsIHNwYWNlIGFmdGVyd2FyZHNcbiAgICAgICAgICAgICAgICBsZXQgbGluZVN0b3AgPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWxsR3JhZGllbnRTdG9wc1tqXSA9PT0gJ251bWJlcicpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsaW5lU3RvcCA9IGZpbGxHcmFkaWVudFN0b3BzW2pdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsaW5lU3RvcCA9IGogLyBmaWxsLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxTdG9wID0gKHRoaXNMaW5lVG9wIC8gaGVpZ2h0KSArIChsaW5lU3RvcCAqIGdyYWRTdG9wTGluZUhlaWdodCk7XG5cbiAgICAgICAgICAgICAgICAvLyBQcmV2ZW50IGNvbG9yIHN0b3AgZ2VuZXJhdGlvbiBnb2luZyBiYWNrd2FyZHMgZnJvbSBmbG9hdGluZyBwb2ludCBpbXByZWNpc2lvblxuICAgICAgICAgICAgICAgIGxldCBjbGFtcGVkU3RvcCA9IE1hdGgubWF4KGxhc3RJdGVyYXRpb25TdG9wLCBnbG9iYWxTdG9wKTtcblxuICAgICAgICAgICAgICAgIGNsYW1wZWRTdG9wID0gTWF0aC5taW4oY2xhbXBlZFN0b3AsIDEpOyAvLyBDYXAgYXQgMSBhcyB3ZWxsIGZvciBzYWZldHkncyBzYWtlIHRvIGF2b2lkIGEgcG9zc2libGUgdGhyb3cuXG4gICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKGNsYW1wZWRTdG9wLCBmaWxsW2pdKTtcbiAgICAgICAgICAgICAgICBsYXN0SXRlcmF0aW9uU3RvcCA9IGNsYW1wZWRTdG9wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIC8vIHN0YXJ0IHRoZSBncmFkaWVudCBhdCB0aGUgY2VudGVyIGxlZnQgb2YgdGhlIGNhbnZhcywgYW5kIGVuZCBhdCB0aGUgY2VudGVyIHJpZ2h0IG9mIHRoZSBjYW52YXNcbiAgICAgICAgZ3JhZGllbnQgPSBjb250ZXh0LmNyZWF0ZUxpbmVhckdyYWRpZW50KHBhZGRpbmcsIGhlaWdodCAvIDIsIHdpZHRoICsgcGFkZGluZywgaGVpZ2h0IC8gMik7XG5cbiAgICAgICAgLy8gY2FuIGp1c3QgZXZlbmx5IHNwYWNlIG91dCB0aGUgZ3JhZGllbnRzIGluIHRoaXMgY2FzZSwgYXMgbXVsdGlwbGUgbGluZXMgbWFrZXMgbm8gZGlmZmVyZW5jZVxuICAgICAgICAvLyB0byBhbiBldmVuIGxlZnQgdG8gcmlnaHQgZ3JhZGllbnRcbiAgICAgICAgY29uc3QgdG90YWxJdGVyYXRpb25zID0gZmlsbC5sZW5ndGggKyAxO1xuICAgICAgICBsZXQgY3VycmVudEl0ZXJhdGlvbiA9IDE7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxsLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgc3RvcDogbnVtYmVyO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGZpbGxHcmFkaWVudFN0b3BzW2ldID09PSAnbnVtYmVyJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdG9wID0gZmlsbEdyYWRpZW50U3RvcHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RvcCA9IGN1cnJlbnRJdGVyYXRpb24gLyB0b3RhbEl0ZXJhdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3Aoc3RvcCwgZmlsbFtpXSk7XG4gICAgICAgICAgICBjdXJyZW50SXRlcmF0aW9uKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ3JhZGllbnQ7XG59XG4iLCAiaW1wb3J0IHsgZ2VuZXJhdGVGaWxsU3R5bGUgfSBmcm9tICcuL2dlbmVyYXRlRmlsbFN0eWxlJztcbmltcG9ydCB7IGhleDJyZ2IsIHN0cmluZzJoZXggfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IFRleHRNZXRyaWNzLCBUZXh0U3R5bGUgfSBmcm9tICdAcGl4aS90ZXh0JztcblxuLy8gVE9ETzogUHJldmVudCBjb2RlIGR1cGxpY2F0aW9uIGIvdyBkcmF3R2x5cGggJiBUZXh0I3VwZGF0ZVRleHRcblxuLyoqXG4gKiBEcmF3cyB0aGUgZ2x5cGggYG1ldHJpY3MudGV4dGAgb24gdGhlIGdpdmVuIGNhbnZhcy5cbiAqXG4gKiBJZ25vcmVkIGJlY2F1c2Ugbm90IGRpcmVjdGx5IGV4cG9zZWQuXG4gKlxuICogQGlnbm9yZVxuICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gY2FudmFzXG4gKiBAcGFyYW0ge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY29udGV4dFxuICogQHBhcmFtIHtUZXh0TWV0cmljc30gbWV0cmljc1xuICogQHBhcmFtIHtudW1iZXJ9IHhcbiAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gKiBAcGFyYW0ge251bWJlcn0gcmVzb2x1dGlvblxuICogQHBhcmFtIHtUZXh0U3R5bGV9IHN0eWxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkcmF3R2x5cGgoXG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCxcbiAgICBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXG4gICAgbWV0cmljczogVGV4dE1ldHJpY3MsXG4gICAgeDogbnVtYmVyLFxuICAgIHk6IG51bWJlcixcbiAgICByZXNvbHV0aW9uOiBudW1iZXIsXG4gICAgc3R5bGU6IFRleHRTdHlsZVxuKTogdm9pZFxue1xuICAgIGNvbnN0IGNoYXIgPSBtZXRyaWNzLnRleHQ7XG4gICAgY29uc3QgZm9udFByb3BlcnRpZXMgPSBtZXRyaWNzLmZvbnRQcm9wZXJ0aWVzO1xuXG4gICAgY29udGV4dC50cmFuc2xhdGUoeCwgeSk7XG4gICAgY29udGV4dC5zY2FsZShyZXNvbHV0aW9uLCByZXNvbHV0aW9uKTtcblxuICAgIGNvbnN0IHR4ID0gc3R5bGUuc3Ryb2tlVGhpY2tuZXNzIC8gMjtcbiAgICBjb25zdCB0eSA9IC0oc3R5bGUuc3Ryb2tlVGhpY2tuZXNzIC8gMik7XG5cbiAgICBjb250ZXh0LmZvbnQgPSBzdHlsZS50b0ZvbnRTdHJpbmcoKTtcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IHN0eWxlLnN0cm9rZVRoaWNrbmVzcztcbiAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZTtcbiAgICBjb250ZXh0LmxpbmVKb2luID0gc3R5bGUubGluZUpvaW47XG4gICAgY29udGV4dC5taXRlckxpbWl0ID0gc3R5bGUubWl0ZXJMaW1pdDtcblxuICAgIC8vIHNldCBjYW52YXMgdGV4dCBzdHlsZXNcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGdlbmVyYXRlRmlsbFN0eWxlKGNhbnZhcywgY29udGV4dCwgc3R5bGUsIHJlc29sdXRpb24sIFtjaGFyXSwgbWV0cmljcyk7XG4gICAgY29udGV4dC5zdHJva2VTdHlsZSA9IHN0eWxlLnN0cm9rZSBhcyBzdHJpbmc7XG5cbiAgICBjb250ZXh0LmZvbnQgPSBzdHlsZS50b0ZvbnRTdHJpbmcoKTtcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IHN0eWxlLnN0cm9rZVRoaWNrbmVzcztcbiAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9IHN0eWxlLnRleHRCYXNlbGluZTtcbiAgICBjb250ZXh0LmxpbmVKb2luID0gc3R5bGUubGluZUpvaW47XG4gICAgY29udGV4dC5taXRlckxpbWl0ID0gc3R5bGUubWl0ZXJMaW1pdDtcblxuICAgIC8vIHNldCBjYW52YXMgdGV4dCBzdHlsZXNcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGdlbmVyYXRlRmlsbFN0eWxlKGNhbnZhcywgY29udGV4dCwgc3R5bGUsIHJlc29sdXRpb24sIFtjaGFyXSwgbWV0cmljcyk7XG4gICAgY29udGV4dC5zdHJva2VTdHlsZSA9IHN0eWxlLnN0cm9rZSBhcyBzdHJpbmc7XG5cbiAgICBjb25zdCBkcm9wU2hhZG93Q29sb3IgPSBzdHlsZS5kcm9wU2hhZG93Q29sb3I7XG4gICAgY29uc3QgcmdiID0gaGV4MnJnYih0eXBlb2YgZHJvcFNoYWRvd0NvbG9yID09PSAnbnVtYmVyJyA/IGRyb3BTaGFkb3dDb2xvciA6IHN0cmluZzJoZXgoZHJvcFNoYWRvd0NvbG9yKSk7XG5cbiAgICBpZiAoc3R5bGUuZHJvcFNoYWRvdylcbiAgICB7XG4gICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSBgcmdiYSgke3JnYlswXSAqIDI1NX0sJHtyZ2JbMV0gKiAyNTV9LCR7cmdiWzJdICogMjU1fSwke3N0eWxlLmRyb3BTaGFkb3dBbHBoYX0pYDtcbiAgICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gc3R5bGUuZHJvcFNoYWRvd0JsdXI7XG4gICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IE1hdGguY29zKHN0eWxlLmRyb3BTaGFkb3dBbmdsZSkgKiBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2U7XG4gICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IE1hdGguc2luKHN0eWxlLmRyb3BTaGFkb3dBbmdsZSkgKiBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2U7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSAnYmxhY2snO1xuICAgICAgICBjb250ZXh0LnNoYWRvd0JsdXIgPSAwO1xuICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFggPSAwO1xuICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSAwO1xuICAgIH1cblxuICAgIGlmIChzdHlsZS5zdHJva2UgJiYgc3R5bGUuc3Ryb2tlVGhpY2tuZXNzKVxuICAgIHtcbiAgICAgICAgY29udGV4dC5zdHJva2VUZXh0KGNoYXIsIHR4LCB0eSArIG1ldHJpY3MubGluZUhlaWdodCAtIGZvbnRQcm9wZXJ0aWVzLmRlc2NlbnQpO1xuICAgIH1cbiAgICBpZiAoc3R5bGUuZmlsbClcbiAgICB7XG4gICAgICAgIGNvbnRleHQuZmlsbFRleHQoY2hhciwgdHgsIHR5ICsgbWV0cmljcy5saW5lSGVpZ2h0IC0gZm9udFByb3BlcnRpZXMuZGVzY2VudCk7XG4gICAgfVxuXG4gICAgY29udGV4dC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7IC8vIGRlZmF1bHRzIG5lZWRlZCBmb3Igb2xkZXIgYnJvd3NlcnMgKGUuZy4gT3BlcmEgMjkpXG5cbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2JhKDAsIDAsIDAsIDApJztcbn1cbiIsICIvKipcbiAqIFByb2Nlc3NlcyB0aGUgcGFzc2VkIGNoYXJhY3RlciBzZXQgZGF0YSBhbmQgcmV0dXJucyBhIGZsYXR0ZW5lZCBhcnJheSBvZiBhbGwgdGhlIGNoYXJhY3RlcnMuXG4gKlxuICogSWdub3JlZCBiZWNhdXNlIG5vdCBkaXJlY3RseSBleHBvc2VkLlxuICpcbiAqIEBpZ25vcmVcbiAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW10gfCBzdHJpbmdbXVtdIH0gY2hhcnNcbiAqIEByZXR1cm5zIHtzdHJpbmdbXX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVDaGFyYWN0ZXJzKGNoYXJzOiBzdHJpbmcgfCAoc3RyaW5nIHwgc3RyaW5nW10pW10pOiBzdHJpbmdbXVxue1xuICAgIC8vIFNwbGl0IHRoZSBjaGFycyBzdHJpbmcgaW50byBpbmRpdmlkdWFsIGNoYXJhY3RlcnNcbiAgICBpZiAodHlwZW9mIGNoYXJzID09PSAnc3RyaW5nJylcbiAgICB7XG4gICAgICAgIGNoYXJzID0gW2NoYXJzXTtcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgYW4gYXJyYXkgb2YgY2hhcmFjdGVycytyYW5nZXNcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMCwgaiA9IGNoYXJzLmxlbmd0aDsgaSA8IGo7IGkrKylcbiAgICB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBjaGFyc1tpXTtcblxuICAgICAgICAvLyBIYW5kbGUgcmFuZ2UgZGVsaW1pdGVkIGJ5IHN0YXJ0L2VuZCBjaGFyc1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGl0ZW0ubGVuZ3RoICE9PSAyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0JpdG1hcEZvbnRdOiBJbnZhbGlkIGNoYXJhY3RlciByYW5nZSBsZW5ndGgsIGV4cGVjdGluZyAyIGdvdCAke2l0ZW0ubGVuZ3RofS5gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc3RhcnRDb2RlID0gaXRlbVswXS5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgY29uc3QgZW5kQ29kZSA9IGl0ZW1bMV0uY2hhckNvZGVBdCgwKTtcblxuICAgICAgICAgICAgaWYgKGVuZENvZGUgPCBzdGFydENvZGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbQml0bWFwRm9udF06IEludmFsaWQgY2hhcmFjdGVyIHJhbmdlLicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRDb2RlLCBqID0gZW5kQ29kZTsgaSA8PSBqOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSGFuZGxlIGEgY2hhcmFjdGVyIHNldCBzdHJpbmdcbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCguLi5pdGVtLnNwbGl0KCcnKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMClcbiAgICB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW0JpdG1hcEZvbnRdOiBFbXB0eSBzZXQgd2hlbiByZXNvbHZpbmcgY2hhcmFjdGVycy4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwgImltcG9ydCB7IGdldFJlc29sdXRpb25PZlVybCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IFJlY3RhbmdsZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgVGV4dHVyZSwgQmFzZVRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFRleHRTdHlsZSwgVGV4dE1ldHJpY3MgfSBmcm9tICdAcGl4aS90ZXh0JztcbmltcG9ydCB7IGF1dG9EZXRlY3RGb3JtYXQgfSBmcm9tICcuL2Zvcm1hdHMnO1xuaW1wb3J0IHsgQml0bWFwRm9udERhdGEgfSBmcm9tICcuL0JpdG1hcEZvbnREYXRhJztcbmltcG9ydCB7IHJlc29sdmVDaGFyYWN0ZXJzLCBkcmF3R2x5cGggfSBmcm9tICcuL3V0aWxzJztcblxuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHR5cGUgeyBJVGV4dFN0eWxlIH0gZnJvbSAnQHBpeGkvdGV4dCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJpdG1hcEZvbnRDaGFyYWN0ZXJcbntcbiAgICB4T2Zmc2V0OiBudW1iZXI7XG4gICAgeU9mZnNldDogbnVtYmVyO1xuICAgIHhBZHZhbmNlOiBudW1iZXI7XG4gICAgdGV4dHVyZTogVGV4dHVyZTtcbiAgICBwYWdlOiBudW1iZXI7XG4gICAga2VybmluZzogRGljdDxudW1iZXI+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElCaXRtYXBGb250T3B0aW9uc1xue1xuICAgIGNoYXJzPzogc3RyaW5nIHwgKHN0cmluZyB8IHN0cmluZ1tdKVtdO1xuICAgIHJlc29sdXRpb24/OiBudW1iZXI7XG4gICAgcGFkZGluZz86IG51bWJlcjtcbiAgICB0ZXh0dXJlV2lkdGg/OiBudW1iZXI7XG4gICAgdGV4dHVyZUhlaWdodD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBCaXRtYXBGb250IHJlcHJlc2VudHMgYSB0eXBlZmFjZSBhdmFpbGFibGUgZm9yIHVzZSB3aXRoIHRoZSBCaXRtYXBUZXh0IGNsYXNzLiBVc2UgdGhlIGBpbnN0YWxsYFxuICogbWV0aG9kIGZvciBhZGRpbmcgYSBmb250IHRvIGJlIHVzZWQuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQml0bWFwRm9udFxue1xuICAgIC8qKlxuICAgICAqIFRoaXMgY2hhcmFjdGVyIHNldCBpbmNsdWRlcyBhbGwgdGhlIGxldHRlcnMgaW4gdGhlIGFscGhhYmV0IChib3RoIGxvd2VyLSBhbmQgdXBwZXItIGNhc2UpLlxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmdbXVtdfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogQml0bWFwRm9udC5mcm9tKFwiRXhhbXBsZUZvbnRcIiwgc3R5bGUsIHsgY2hhcnM6IEJpdG1hcEZvbnQuQUxQSEEgfSlcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEFMUEhBID0gW1snYScsICd6J10sIFsnQScsICdaJ10sICcgJ107XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGNoYXJhY3RlciBzZXQgaW5jbHVkZXMgYWxsIGRlY2ltYWwgZGlnaXRzIChmcm9tIDAgdG8gOSkuXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge3N0cmluZ1tdW119XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBCaXRtYXBGb250LmZyb20oXCJFeGFtcGxlRm9udFwiLCBzdHlsZSwgeyBjaGFyczogQml0bWFwRm9udC5OVU1FUklDIH0pXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBOVU1FUklDID0gW1snMCcsICc5J11dO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBjaGFyYWN0ZXIgc2V0IGlzIHRoZSB1bmlvbiBvZiBgQml0bWFwRm9udC5BTFBIQWAgYW5kIGBCaXRtYXBGb250Lk5VTUVSSUNgLlxuICAgICAqIEByZWFkb25seVxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmdbXVtdfVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQUxQSEFOVU1FUklDID0gW1snYScsICd6J10sIFsnQScsICdaJ10sIFsnMCcsICc5J10sICcgJ107XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGNoYXJhY3RlciBzZXQgY29uc2lzdHMgb2YgYWxsIHRoZSBBU0NJSSB0YWJsZS5cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlciB7c3RyaW5nW11bXX1cbiAgICAgKiBAc2VlIGh0dHA6Ly93d3cuYXNjaWl0YWJsZS5jb20vXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBBU0NJSSA9IFtbJyAnLCAnfiddXTtcblxuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gb2YgZGVmYXVsdCBvcHRpb25zIHdoZW4gdXNpbmcgYEJpdG1hcEZvbnQuZnJvbWAuXG4gICAgICpcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlciB7UElYSS5JQml0bWFwRm9udE9wdGlvbnN9XG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IHJlc29sdXRpb249MVxuICAgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0ZXh0dXJlV2lkdGg9NTEyXG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IHRleHR1cmVIZWlnaHQ9NTEyXG4gICAgICogQHByb3BlcnR5IHtudW1iZXJ9IHBhZGRpbmc9NFxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfHN0cmluZ1tdfHN0cmluZ1tdW119IGNoYXJzPVBJWEkuQml0bWFwRm9udC5BTFBIQU5VTUVSSUNcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IGRlZmF1bHRPcHRpb25zOiBJQml0bWFwRm9udE9wdGlvbnMgPSB7XG4gICAgICAgIHJlc29sdXRpb246IDEsXG4gICAgICAgIHRleHR1cmVXaWR0aDogNTEyLFxuICAgICAgICB0ZXh0dXJlSGVpZ2h0OiA1MTIsXG4gICAgICAgIHBhZGRpbmc6IDQsXG4gICAgICAgIGNoYXJzOiBCaXRtYXBGb250LkFMUEhBTlVNRVJJQyxcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ29sbGVjdGlvbiBvZiBhdmFpbGFibGUvaW5zdGFsbGVkIGZvbnRzLlxuICAgICAqXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge09iamVjdC48c3RyaW5nLCBQSVhJLkJpdG1hcEZvbnQ+fVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgYXZhaWxhYmxlOiBEaWN0PEJpdG1hcEZvbnQ+ID0ge307XG4gICAgcHVibGljIHJlYWRvbmx5IGZvbnQ6IHN0cmluZztcbiAgICBwdWJsaWMgcmVhZG9ubHkgc2l6ZTogbnVtYmVyO1xuICAgIHB1YmxpYyByZWFkb25seSBsaW5lSGVpZ2h0OiBudW1iZXI7XG4gICAgcHVibGljIHJlYWRvbmx5IGNoYXJzOiBEaWN0PElCaXRtYXBGb250Q2hhcmFjdGVyPjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgcGFnZVRleHR1cmVzOiBEaWN0PFRleHR1cmU+O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLkJpdG1hcEZvbnREYXRhfSBkYXRhXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmVbXXxPYmplY3QuPHN0cmluZywgUElYSS5UZXh0dXJlPn0gdGV4dHVyZXNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBCaXRtYXBGb250RGF0YSwgdGV4dHVyZXM6IFRleHR1cmVbXXxEaWN0PFRleHR1cmU+KVxuICAgIHtcbiAgICAgICAgY29uc3QgW2luZm9dID0gZGF0YS5pbmZvO1xuICAgICAgICBjb25zdCBbY29tbW9uXSA9IGRhdGEuY29tbW9uO1xuICAgICAgICBjb25zdCBbcGFnZV0gPSBkYXRhLnBhZ2U7XG4gICAgICAgIGNvbnN0IHJlcyA9IGdldFJlc29sdXRpb25PZlVybChwYWdlLmZpbGUpO1xuICAgICAgICBjb25zdCBwYWdlVGV4dHVyZXM6IERpY3Q8VGV4dHVyZT4gPSB7fTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG5hbWUgb2YgdGhlIGZvbnQgZmFjZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9udCA9IGluZm8uZmFjZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNpemUgb2YgdGhlIGZvbnQgZmFjZSBpbiBwaXhlbHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNpemUgPSBpbmZvLnNpemU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsaW5lLWhlaWdodCBvZiB0aGUgZm9udCBmYWNlIGluIHBpeGVscy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGluZUhlaWdodCA9IGNvbW1vbi5saW5lSGVpZ2h0IC8gcmVzO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWFwIG9mIGNoYXJhY3RlcnMgYnkgY2hhcmFjdGVyIGNvZGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge29iamVjdH1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoYXJzID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtYXAgb2YgYmFzZSBwYWdlIHRleHR1cmVzIChpLmUuLCBzaGVldHMgb2YgZ2x5cGhzKS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7b2JqZWN0fVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucGFnZVRleHR1cmVzID0gcGFnZVRleHR1cmVzO1xuXG4gICAgICAgIC8vIENvbnZlcnQgdGhlIGlucHV0IFRleHR1cmUsIFRleHR1cmVzIG9yIG9iamVjdFxuICAgICAgICAvLyBpbnRvIGEgcGFnZSBUZXh0dXJlIGxvb2t1cCBieSBcImlkXCJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnBhZ2UubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHsgaWQsIGZpbGUgfSA9IGRhdGEucGFnZVtpXTtcblxuICAgICAgICAgICAgcGFnZVRleHR1cmVzW2lkXSA9IHRleHR1cmVzIGluc3RhbmNlb2YgQXJyYXlcbiAgICAgICAgICAgICAgICA/IHRleHR1cmVzW2ldIDogdGV4dHVyZXNbZmlsZV07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwYXJzZSBsZXR0ZXJzXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5jaGFyLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB7IGlkLCBwYWdlIH0gPSBkYXRhLmNoYXJbaV07XG4gICAgICAgICAgICBsZXQgeyB4LCB5LCB3aWR0aCwgaGVpZ2h0LCB4b2Zmc2V0LCB5b2Zmc2V0LCB4YWR2YW5jZSB9ID0gZGF0YS5jaGFyW2ldO1xuXG4gICAgICAgICAgICB4IC89IHJlcztcbiAgICAgICAgICAgIHkgLz0gcmVzO1xuICAgICAgICAgICAgd2lkdGggLz0gcmVzO1xuICAgICAgICAgICAgaGVpZ2h0IC89IHJlcztcbiAgICAgICAgICAgIHhvZmZzZXQgLz0gcmVzO1xuICAgICAgICAgICAgeW9mZnNldCAvPSByZXM7XG4gICAgICAgICAgICB4YWR2YW5jZSAvPSByZXM7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBuZXcgUmVjdGFuZ2xlKFxuICAgICAgICAgICAgICAgIHggKyAocGFnZVRleHR1cmVzW3BhZ2VdLmZyYW1lLnggLyByZXMpLFxuICAgICAgICAgICAgICAgIHkgKyAocGFnZVRleHR1cmVzW3BhZ2VdLmZyYW1lLnkgLyByZXMpLFxuICAgICAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5jaGFyc1tpZF0gPSB7XG4gICAgICAgICAgICAgICAgeE9mZnNldDogeG9mZnNldCxcbiAgICAgICAgICAgICAgICB5T2Zmc2V0OiB5b2Zmc2V0LFxuICAgICAgICAgICAgICAgIHhBZHZhbmNlOiB4YWR2YW5jZSxcbiAgICAgICAgICAgICAgICBrZXJuaW5nOiB7fSxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiBuZXcgVGV4dHVyZShcbiAgICAgICAgICAgICAgICAgICAgcGFnZVRleHR1cmVzW3BhZ2VdLmJhc2VUZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICByZWN0XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBwYWdlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBhcnNlIGtlcm5pbmdzXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5rZXJuaW5nLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgeyBmaXJzdCwgc2Vjb25kLCBhbW91bnQgfSA9IGRhdGEua2VybmluZ1tpXTtcblxuICAgICAgICAgICAgZmlyc3QgLz0gcmVzO1xuICAgICAgICAgICAgc2Vjb25kIC89IHJlcztcbiAgICAgICAgICAgIGFtb3VudCAvPSByZXM7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmNoYXJzW3NlY29uZF0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFyc1tzZWNvbmRdLmtlcm5pbmdbZmlyc3RdID0gYW1vdW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHJlZmVyZW5jZXMgdG8gY3JlYXRlZCBnbHlwaCB0ZXh0dXJlcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkXG4gICAge1xuICAgICAgICBmb3IgKGNvbnN0IGlkIGluIHRoaXMuY2hhcnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2hhcnNbaWRdLnRleHR1cmUuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5jaGFyc1tpZF0udGV4dHVyZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGlkIGluIHRoaXMucGFnZVRleHR1cmVzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VUZXh0dXJlc1tpZF0uZGVzdHJveSh0cnVlKTtcbiAgICAgICAgICAgIHRoaXMucGFnZVRleHR1cmVzW2lkXSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgcmVhZG9ubHkgbnVsbC5cbiAgICAgICAgKHRoaXMgYXMgYW55KS5jaGFycyA9IG51bGw7XG4gICAgICAgICh0aGlzIGFzIGFueSkucGFnZVRleHR1cmVzID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIG5ldyBiaXRtYXAgZm9udC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge1hNTERvY3VtZW50fHN0cmluZ3xQSVhJLkJpdG1hcEZvbnREYXRhfSBkYXRhIC0gVGhlXG4gICAgICogICAgICAgIGNoYXJhY3RlcnMgbWFwIHRoYXQgY291bGQgYmUgcHJvdmlkZWQgYXMgeG1sIG9yIHJhdyBzdHJpbmcuXG4gICAgICogQHBhcmFtIHtPYmplY3QuPHN0cmluZywgUElYSS5UZXh0dXJlPnxQSVhJLlRleHR1cmV8UElYSS5UZXh0dXJlW119XG4gICAgICogICAgICAgIHRleHR1cmVzIC0gTGlzdCBvZiB0ZXh0dXJlcyBmb3IgZWFjaCBwYWdlLlxuICAgICAqIEByZXR1cm4ge1BJWEkuQml0bWFwRm9udH0gUmVzdWx0IGZvbnQgb2JqZWN0IHdpdGggZm9udCwgc2l6ZSwgbGluZUhlaWdodFxuICAgICAqICAgICAgICAgYW5kIGNoYXIgZmllbGRzLlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgaW5zdGFsbChcbiAgICAgICAgZGF0YTogc3RyaW5nfFhNTERvY3VtZW50fEJpdG1hcEZvbnREYXRhLFxuICAgICAgICB0ZXh0dXJlczogVGV4dHVyZXxUZXh0dXJlW118RGljdDxUZXh0dXJlPlxuICAgICk6IEJpdG1hcEZvbnRcbiAgICB7XG4gICAgICAgIGxldCBmb250RGF0YTtcblxuICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEJpdG1hcEZvbnREYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb250RGF0YSA9IGRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBhdXRvRGV0ZWN0Rm9ybWF0KGRhdGEpO1xuXG4gICAgICAgICAgICBpZiAoIWZvcm1hdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VucmVjb2duaXplZCBkYXRhIGZvcm1hdCBmb3IgZm9udC4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9udERhdGEgPSBmb3JtYXQucGFyc2UoZGF0YSBhcyBhbnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2luZ2xlIHRleHR1cmUsIGNvbnZlcnQgdG8gbGlzdFxuICAgICAgICBpZiAodGV4dHVyZXMgaW5zdGFuY2VvZiBUZXh0dXJlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0dXJlcyA9IFt0ZXh0dXJlc107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmb250ID0gbmV3IEJpdG1hcEZvbnQoZm9udERhdGEsIHRleHR1cmVzKTtcblxuICAgICAgICBCaXRtYXBGb250LmF2YWlsYWJsZVtmb250LmZvbnRdID0gZm9udDtcblxuICAgICAgICByZXR1cm4gZm9udDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYml0bWFwIGZvbnQgYnkgbmFtZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgdW5pbnN0YWxsKG5hbWU6IHN0cmluZyk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IGZvbnQgPSBCaXRtYXBGb250LmF2YWlsYWJsZVtuYW1lXTtcblxuICAgICAgICBpZiAoIWZvbnQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZm9udCBmb3VuZCBuYW1lZCAnJHtuYW1lfSdgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvbnQuZGVzdHJveSgpO1xuICAgICAgICBkZWxldGUgQml0bWFwRm9udC5hdmFpbGFibGVbbmFtZV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGEgYml0bWFwLWZvbnQgZm9yIHRoZSBnaXZlbiBzdHlsZSBhbmQgY2hhcmFjdGVyIHNldC4gVGhpcyBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICoga2VybmluZ3MgeWV0LiBXaXRoIGBzdHlsZWAgcHJvcGVydGllcywgb25seSB0aGUgZm9sbG93aW5nIG5vbi1sYXlvdXQgcHJvcGVydGllcyBhcmUgdXNlZDpcbiAgICAgKlxuICAgICAqIC0ge0BsaW5rIFBJWEkuVGV4dFN0eWxlI2Ryb3BTaGFkb3d8ZHJvcFNoYWRvd31cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSNkcm9wU2hhZG93RGlzdGFuY2V8ZHJvcFNoYWRvd0Rpc3RhbmNlfVxuICAgICAqIC0ge0BsaW5rIFBJWEkuVGV4dFN0eWxlI2Ryb3BTaGFkb3dDb2xvcnxkcm9wU2hhZG93Q29sb3J9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjZHJvcFNoYWRvd0JsdXJ8ZHJvcFNoYWRvd0JsdXJ9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjZHJvcFNoYWRvd0FuZ2xlfGRyb3BTaGFkb3dBbmdsZX1cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSNmaWxsfGZpbGx9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjZmlsbEdyYWRpZW50U3RvcHN8ZmlsbEdyYWRpZW50U3RvcHN9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjZmlsbEdyYWRpZW50VHlwZXxmaWxsR3JhZGllbnRUeXBlfVxuICAgICAqIC0ge0BsaW5rIFBJWEkuVGV4dFN0eWxlI2ZvbnRGYW1pbHl8Zm9udEZhbWlseX1cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSNmb250U2l6ZXxmb250U2l6ZX1cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSNmb250VmFyaWFudHxmb250VmFyaWFudH1cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSNmb250V2VpZ2h0fGZvbnRXZWlnaHR9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjbGluZUpvaW58bGluZUpvaW59XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjbWl0ZXJMaW1pdHxtaXRlckxpbWl0fVxuICAgICAqIC0ge0BsaW5rIFBJWEkuVGV4dFN0eWxlI3N0cm9rZXxzdHJva2V9XG4gICAgICogLSB7QGxpbmsgUElYSS5UZXh0U3R5bGUjc3Ryb2tlVGhpY2tuZXNzfHN0cm9rZVRoaWNrbmVzc31cbiAgICAgKiAtIHtAbGluayBQSVhJLlRleHRTdHlsZSN0ZXh0QmFzZWxpbmV8dGV4dEJhc2VsaW5lfVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgY3VzdG9tIGZvbnQgdG8gdXNlIHdpdGggQml0bWFwVGV4dC5cbiAgICAgKiBAcGFyYW0ge29iamVjdHxQSVhJLlRleHRTdHlsZX0gW3N0eWxlXSAtIFN0eWxlIG9wdGlvbnMgdG8gcmVuZGVyIHdpdGggQml0bWFwRm9udC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuSUJpdG1hcEZvbnRPcHRpb25zfSBbb3B0aW9uc10gLSBTZXR1cCBvcHRpb25zIGZvciBmb250IG9yIG5hbWUgb2YgdGhlIGZvbnQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd8c3RyaW5nW118c3RyaW5nW11bXX0gW29wdGlvbnMuY2hhcnM9UElYSS5CaXRtYXBGb250LkFMUEhBTlVNRVJJQ10gLSBjaGFyYWN0ZXJzIGluY2x1ZGVkXG4gICAgICogICAgICBpbiB0aGUgZm9udCBzZXQuIFlvdSBjYW4gYWxzbyB1c2UgcmFuZ2VzLiBGb3IgZXhhbXBsZSwgYFtbJ2EnLCAneiddLCBbJ0EnLCAnWiddLCBcIiFAIyQlXiYqKCl+e31bXSBcIl1gLlxuICAgICAqICAgICAgRG9uJ3QgZm9yZ2V0IHRvIGluY2x1ZGUgc3BhY2VzICcgJyBpbiB5b3VyIGNoYXJhY3RlciBzZXQhXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnJlc29sdXRpb249MV0gLSBSZW5kZXIgcmVzb2x1dGlvbiBmb3IgZ2x5cGhzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy50ZXh0dXJlV2lkdGg9NTEyXSAtIE9wdGlvbmFsIHdpZHRoIG9mIGF0bGFzLCBzbWFsbGVyIHZhbHVlcyB0byByZWR1Y2UgbWVtb3J5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy50ZXh0dXJlSGVpZ2h0PTUxMl0gLSBPcHRpb25hbCBoZWlnaHQgb2YgYXRsYXMsIHNtYWxsZXIgdmFsdWVzIHRvIHJlZHVjZSBtZW1vcnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnBhZGRpbmc9NF0gLSBQYWRkaW5nIGJldHdlZW4gZ2x5cGhzIG9uIHRleHR1cmUgYXRsYXMuXG4gICAgICogQHJldHVybiB7UElYSS5CaXRtYXBGb250fSBGb250IGdlbmVyYXRlZCBieSBzdHlsZSBvcHRpb25zLlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIFBJWEkuQml0bWFwRm9udC5mcm9tKFwiVGl0bGVGb250XCIsIHtcbiAgICAgKiAgICAgZm9udEZhbWlseTogXCJBcmlhbFwiLFxuICAgICAqICAgICBmb250U2l6ZTogMTIsXG4gICAgICogICAgIHN0cm9rZVRoaWNrbmVzczogMixcbiAgICAgKiAgICAgZmlsbDogXCJwdXJwbGVcIlxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogY29uc3QgdGl0bGUgPSBuZXcgUElYSS5CaXRtYXBUZXh0KFwiVGhpcyBpcyB0aGUgdGl0bGVcIiwgeyBmb250TmFtZTogXCJUaXRsZUZvbnRcIiB9KTtcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZyb20obmFtZTogc3RyaW5nLCB0ZXh0U3R5bGU/OiBUZXh0U3R5bGUgfCBQYXJ0aWFsPElUZXh0U3R5bGU+LCBvcHRpb25zPzogSUJpdG1hcEZvbnRPcHRpb25zKTogQml0bWFwRm9udFxuICAgIHtcbiAgICAgICAgaWYgKCFuYW1lKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tCaXRtYXBGb250XSBQcm9wZXJ0eSBgbmFtZWAgaXMgcmVxdWlyZWQuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjaGFycyxcbiAgICAgICAgICAgIHBhZGRpbmcsXG4gICAgICAgICAgICByZXNvbHV0aW9uLFxuICAgICAgICAgICAgdGV4dHVyZVdpZHRoLFxuICAgICAgICAgICAgdGV4dHVyZUhlaWdodCB9ID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICAgIHt9LCBCaXRtYXBGb250LmRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAgICAgICBjb25zdCBjaGFyc0xpc3QgPSByZXNvbHZlQ2hhcmFjdGVycyhjaGFycyk7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gdGV4dFN0eWxlIGluc3RhbmNlb2YgVGV4dFN0eWxlID8gdGV4dFN0eWxlIDogbmV3IFRleHRTdHlsZSh0ZXh0U3R5bGUpO1xuICAgICAgICBjb25zdCBsaW5lV2lkdGggPSB0ZXh0dXJlV2lkdGg7XG4gICAgICAgIGNvbnN0IGZvbnREYXRhID0gbmV3IEJpdG1hcEZvbnREYXRhKCk7XG5cbiAgICAgICAgZm9udERhdGEuaW5mb1swXSA9IHtcbiAgICAgICAgICAgIGZhY2U6IHN0eWxlLmZvbnRGYW1pbHkgYXMgc3RyaW5nLFxuICAgICAgICAgICAgc2l6ZTogc3R5bGUuZm9udFNpemUgYXMgbnVtYmVyLFxuICAgICAgICB9O1xuICAgICAgICBmb250RGF0YS5jb21tb25bMF0gPSB7XG4gICAgICAgICAgICBsaW5lSGVpZ2h0OiBzdHlsZS5mb250U2l6ZSBhcyBudW1iZXIsXG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IHBvc2l0aW9uWCA9IDA7XG4gICAgICAgIGxldCBwb3NpdGlvblkgPSAwO1xuXG4gICAgICAgIGxldCBjYW52YXM7XG4gICAgICAgIGxldCBjb250ZXh0O1xuICAgICAgICBsZXQgYmFzZVRleHR1cmU7XG4gICAgICAgIGxldCBtYXhDaGFySGVpZ2h0ID0gMDtcbiAgICAgICAgY29uc3QgYmFzZVRleHR1cmVzID0gW107XG4gICAgICAgIGNvbnN0IHRleHR1cmVzOiBUZXh0dXJlW10gPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYXJzTGlzdC5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFjYW52YXMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gdGV4dHVyZVdpZHRoO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0ZXh0dXJlSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlID0gbmV3IEJhc2VUZXh0dXJlKGNhbnZhcywgeyByZXNvbHV0aW9uIH0pO1xuXG4gICAgICAgICAgICAgICAgYmFzZVRleHR1cmVzLnB1c2goYmFzZVRleHR1cmUpO1xuICAgICAgICAgICAgICAgIHRleHR1cmVzLnB1c2gobmV3IFRleHR1cmUoYmFzZVRleHR1cmUpKTtcblxuICAgICAgICAgICAgICAgIGZvbnREYXRhLnBhZ2UucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0ZXh0dXJlcy5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICAgICBmaWxlOiAnJyxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTWVhc3VyZSBnbHlwaCBkaW1lbnNpb25zXG4gICAgICAgICAgICBjb25zdCBtZXRyaWNzID0gVGV4dE1ldHJpY3MubWVhc3VyZVRleHQoY2hhcnNMaXN0W2ldLCBzdHlsZSwgZmFsc2UsIGNhbnZhcyk7XG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IG1ldHJpY3Mud2lkdGg7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLmNlaWwobWV0cmljcy5oZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHVnbHkgLSBidXQgaXRhbGljcyBhcmUgZ2l2ZW4gbW9yZSBzcGFjZSBzbyB0aGV5IGRvbid0IG92ZXJsYXBcbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmVHbHlwaFdpZHRoID0gTWF0aC5jZWlsKChzdHlsZS5mb250U3R5bGUgPT09ICdpdGFsaWMnID8gMiA6IDEpICogd2lkdGgpO1xuXG4gICAgICAgICAgICAvLyBDYW4ndCBmaXQgY2hhciBhbnltb3JlOiBuZXh0IGNhbnZhcyBwbGVhc2UhXG4gICAgICAgICAgICBpZiAocG9zaXRpb25ZID49IHRleHR1cmVIZWlnaHQgLSAoaGVpZ2h0ICogcmVzb2x1dGlvbikpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uWSA9PT0gMClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IHdhbnQgdXNlciBkZWJ1Z2dpbmcgYW4gaW5maW5pdGUgbG9vcCAob3IgZG8gd2U/IDopXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0JpdG1hcEZvbnRdIHRleHR1cmVIZWlnaHQgJHt0ZXh0dXJlSGVpZ2h0fXB4IGlzIGBcbiAgICAgICAgICAgICAgICAgICAgICAgICsgYHRvbyBzbWFsbCBmb3IgJHtzdHlsZS5mb250U2l6ZX1weCBmb250c2ApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC0taTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgYXRsYXMgb25jZSBjdXJyZW50IGhhcyBmaWxsZWQgdXBcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBudWxsO1xuICAgICAgICAgICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGJhc2VUZXh0dXJlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSAwO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IDA7XG4gICAgICAgICAgICAgICAgbWF4Q2hhckhlaWdodCA9IDA7XG5cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWF4Q2hhckhlaWdodCA9IE1hdGgubWF4KGhlaWdodCArIG1ldHJpY3MuZm9udFByb3BlcnRpZXMuZGVzY2VudCwgbWF4Q2hhckhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIFdyYXAgbGluZSBvbmNlIGZ1bGwgcm93IGhhcyBiZWVuIHJlbmRlcmVkXG4gICAgICAgICAgICBpZiAoKHRleHR1cmVHbHlwaFdpZHRoICogcmVzb2x1dGlvbikgKyBwb3NpdGlvblggPj0gbGluZVdpZHRoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvblkgKz0gbWF4Q2hhckhlaWdodCAqIHJlc29sdXRpb247XG4gICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5jZWlsKHBvc2l0aW9uWSk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb25YID0gMDtcbiAgICAgICAgICAgICAgICBtYXhDaGFySGVpZ2h0ID0gMDtcblxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkcmF3R2x5cGgoY2FudmFzLCBjb250ZXh0LCBtZXRyaWNzLCBwb3NpdGlvblgsIHBvc2l0aW9uWSwgcmVzb2x1dGlvbiwgc3R5bGUpO1xuXG4gICAgICAgICAgICAvLyBVbmlxdWUgKG51bWVyaWMpIElEIG1hcHBpbmcgdG8gdGhpcyBnbHlwaFxuICAgICAgICAgICAgY29uc3QgaWQgPSBtZXRyaWNzLnRleHQuY2hhckNvZGVBdCgwKTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgdGV4dHVyZSBob2xkaW5nIGp1c3QgdGhlIGdseXBoXG4gICAgICAgICAgICBmb250RGF0YS5jaGFyLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgIHBhZ2U6IHRleHR1cmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgeDogcG9zaXRpb25YIC8gcmVzb2x1dGlvbixcbiAgICAgICAgICAgICAgICB5OiBwb3NpdGlvblkgLyByZXNvbHV0aW9uLFxuICAgICAgICAgICAgICAgIHdpZHRoOiB0ZXh0dXJlR2x5cGhXaWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQsXG4gICAgICAgICAgICAgICAgeG9mZnNldDogMCxcbiAgICAgICAgICAgICAgICB5b2Zmc2V0OiAwLFxuICAgICAgICAgICAgICAgIHhhZHZhbmNlOiBNYXRoLmNlaWwod2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIC0gKHN0eWxlLmRyb3BTaGFkb3cgPyBzdHlsZS5kcm9wU2hhZG93RGlzdGFuY2UgOiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLSAoc3R5bGUuc3Ryb2tlID8gc3R5bGUuc3Ryb2tlVGhpY2tuZXNzIDogMCkpLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHBvc2l0aW9uWCArPSAodGV4dHVyZUdseXBoV2lkdGggKyAoMiAqIHBhZGRpbmcpKSAqIHJlc29sdXRpb247XG4gICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmNlaWwocG9zaXRpb25YKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZvbnQgPSBuZXcgQml0bWFwRm9udChmb250RGF0YSwgdGV4dHVyZXMpO1xuXG4gICAgICAgIC8vIE1ha2UgaXQgZWFzaWVyIHRvIHJlcGxhY2UgYSBmb250XG4gICAgICAgIGlmIChCaXRtYXBGb250LmF2YWlsYWJsZVtuYW1lXSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICB7XG4gICAgICAgICAgICBCaXRtYXBGb250LnVuaW5zdGFsbChuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEJpdG1hcEZvbnQuYXZhaWxhYmxlW25hbWVdID0gZm9udDtcblxuICAgICAgICByZXR1cm4gZm9udDtcbiAgICB9XG59XG5cbi8qKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBpbnRlcmZhY2UgSUJpdG1hcEZvbnRPcHRpb25zXG4gKiBAcHJvcGVydHkge3N0cmluZyB8IHN0cmluZ1tdIHwgc3RyaW5nW11bXX0gW2NoYXJzPVBJWEkuQml0bWFwRm9udC5BTFBIQU5VTUVSSUNdIC0gdGhlIGNoYXJhY3RlciBzZXQgdG8gZ2VuZXJhdGVcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbcmVzb2x1dGlvbj0xXSAtIHRoZSByZXNvbHV0aW9uIGZvciByZW5kZXJpbmdcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbcGFkZGluZz00XSAtIHRoZSBwYWRkaW5nIGJldHdlZW4gZ2x5cGhzIGluIHRoZSBhdGxhc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFt0ZXh0dXJlV2lkdGg9NTEyXSAtIHRoZSB3aWR0aCBvZiB0aGUgdGV4dHVyZSBhdGxhc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFt0ZXh0dXJlSGVpZ2h0PTUxMl0gLSB0aGUgaGVpZ2h0IG9mIHRoZSB0ZXh0dXJlIGF0bGFzXG4gKi9cblxuIiwgImltcG9ydCB7IE9ic2VydmFibGVQb2ludCwgUG9pbnQgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgTWVzaCwgTWVzaEdlb21ldHJ5LCBNZXNoTWF0ZXJpYWwgfSBmcm9tICdAcGl4aS9tZXNoJztcbmltcG9ydCB7IHJlbW92ZUl0ZW1zLCBkZXByZWNhdGlvbiB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IEJpdG1hcEZvbnQgfSBmcm9tICcuL0JpdG1hcEZvbnQnO1xuXG5pbXBvcnQgdHlwZSB7IERpY3QgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IFJlY3RhbmdsZSB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBJQml0bWFwVGV4dFN0eWxlIH0gZnJvbSAnLi9CaXRtYXBUZXh0U3R5bGUnO1xuaW1wb3J0IHR5cGUgeyBUZXh0U3R5bGVBbGlnbiB9IGZyb20gJ0BwaXhpL3RleHQnO1xuaW1wb3J0IHR5cGUgeyBCaXRtYXBGb250RGF0YSB9IGZyb20gJy4vQml0bWFwRm9udERhdGEnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuXG5pbnRlcmZhY2UgUGFnZU1lc2hEYXRhIHtcbiAgICBpbmRleDogbnVtYmVyO1xuICAgIGluZGV4Q291bnQ6IG51bWJlcjtcbiAgICB2ZXJ0ZXhDb3VudDogbnVtYmVyO1xuICAgIHV2c0NvdW50OiBudW1iZXI7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBtZXNoOiBNZXNoO1xuICAgIHZlcnRpY2VzPzogRmxvYXQzMkFycmF5O1xuICAgIHV2cz86IEZsb2F0MzJBcnJheTtcbiAgICBpbmRpY2VzPzogVWludDE2QXJyYXk7XG59XG5pbnRlcmZhY2UgQ2hhclJlbmRlckRhdGEge1xuICAgIHRleHR1cmU6IFRleHR1cmU7XG4gICAgbGluZTogbnVtYmVyO1xuICAgIGNoYXJDb2RlOiBudW1iZXI7XG4gICAgcG9zaXRpb246IFBvaW50O1xufVxuXG5jb25zdCBwYWdlTWVzaERhdGFQb29sOiBQYWdlTWVzaERhdGFbXSA9IFtdO1xuY29uc3QgY2hhclJlbmRlckRhdGFQb29sOiBDaGFyUmVuZGVyRGF0YVtdID0gW107XG5cbi8qKlxuICogQSBCaXRtYXBUZXh0IG9iamVjdCB3aWxsIGNyZWF0ZSBhIGxpbmUgb3IgbXVsdGlwbGUgbGluZXMgb2YgdGV4dCB1c2luZyBiaXRtYXAgZm9udC5cbiAqXG4gKiBUaGUgcHJpbWFyeSBhZHZhbnRhZ2Ugb2YgdGhpcyBjbGFzcyBvdmVyIFRleHQgaXMgdGhhdCBhbGwgb2YgeW91ciB0ZXh0dXJlcyBhcmUgcHJlLWdlbmVyYXRlZCBhbmQgbG9hZGluZyxcbiAqIG1lYW5pbmcgdGhhdCByZW5kZXJpbmcgaXMgZmFzdCwgYW5kIGNoYW5naW5nIHRleHQgaGFzIG5vIHBlcmZvcm1hbmNlIGltcGxpY2F0aW9ucy5cbiAqXG4gKiBTdXBwb3J0aW5nIGNoYXJhY3RlciBzZXRzIG90aGVyIHRoYW4gbGF0aW4sIHN1Y2ggYXMgQ0pLIGxhbmd1YWdlcywgbWF5IGJlIGltcHJhY3RpY2FsIGR1ZSB0byB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMuXG4gKlxuICogVG8gc3BsaXQgYSBsaW5lIHlvdSBjYW4gdXNlICdcXG4nLCAnXFxyJyBvciAnXFxyXFxuJyBpbiB5b3VyIHN0cmluZy5cbiAqXG4gKiBQaXhpSlMgY2FuIGF1dG8tZ2VuZXJhdGUgZm9udHMgb24tdGhlLWZseSB1c2luZyBCaXRtYXBGb250IG9yIHVzZSBmbnQgZmlsZXMgcHJvdmlkZWQgYnk6XG4gKiBodHRwOi8vd3d3LmFuZ2VsY29kZS5jb20vcHJvZHVjdHMvYm1mb250LyBmb3IgV2luZG93cyBvclxuICogaHR0cDovL3d3dy5ibWdseXBoLmNvbS8gZm9yIE1hYy5cbiAqXG4gKiBBIEJpdG1hcFRleHQgY2FuIG9ubHkgYmUgY3JlYXRlZCB3aGVuIHRoZSBmb250IGlzIGxvYWRlZC5cbiAqXG4gKiBgYGBqc1xuICogLy8gaW4gdGhpcyBjYXNlIHRoZSBmb250IGlzIGluIGEgZmlsZSBjYWxsZWQgJ2Rlc3lyZWwuZm50J1xuICogbGV0IGJpdG1hcFRleHQgPSBuZXcgUElYSS5CaXRtYXBUZXh0KFwidGV4dCB1c2luZyBhIGZhbmN5IGZvbnQhXCIsIHtmb250OiBcIjM1cHggRGVzeXJlbFwiLCBhbGlnbjogXCJyaWdodFwifSk7XG4gKiBgYGBcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQ29udGFpbmVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG5leHBvcnQgY2xhc3MgQml0bWFwVGV4dCBleHRlbmRzIENvbnRhaW5lclxue1xuICAgIHB1YmxpYyBzdGF0aWMgc3R5bGVEZWZhdWx0czogUGFydGlhbDxJQml0bWFwVGV4dFN0eWxlPiA9IHtcbiAgICAgICAgYWxpZ246ICdsZWZ0JyxcbiAgICAgICAgdGludDogMHhGRkZGRkYsXG4gICAgICAgIG1heFdpZHRoOiAwLFxuICAgICAgICBsZXR0ZXJTcGFjaW5nOiAwLFxuICAgIH07XG4gICAgcHVibGljIGRpcnR5OiBib29sZWFuO1xuICAgIHByb3RlY3RlZCBfdGV4dFdpZHRoOiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF90ZXh0SGVpZ2h0OiBudW1iZXI7XG4gICAgcHJvdGVjdGVkIF90ZXh0OiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIF9tYXhXaWR0aDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfbWF4TGluZUhlaWdodDogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfbGV0dGVyU3BhY2luZzogbnVtYmVyO1xuICAgIHByb3RlY3RlZCBfYW5jaG9yOiBPYnNlcnZhYmxlUG9pbnQ7XG4gICAgcHJvdGVjdGVkIF9mb250TmFtZTogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBfZm9udFNpemU6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX2FsaWduOiBUZXh0U3R5bGVBbGlnbjtcbiAgICBwcm90ZWN0ZWQgX2FjdGl2ZVBhZ2VzTWVzaERhdGE6IFBhZ2VNZXNoRGF0YVtdO1xuICAgIHByb3RlY3RlZCBfdGludCA9IDB4RkZGRkZGO1xuICAgIHByb3RlY3RlZCBfcm91bmRQaXhlbHM6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBfdGV4dHVyZUNhY2hlOiBSZWNvcmQ8bnVtYmVyLCBUZXh0dXJlPjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gQSBzdHJpbmcgdGhhdCB5b3Ugd291bGQgbGlrZSB0aGUgdGV4dCB0byBkaXNwbGF5LlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzdHlsZSAtIFRoZSBzdHlsZSBwYXJhbWV0ZXJzLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHlsZS5mb250TmFtZSAtIFRoZSBpbnN0YWxsZWQgQml0bWFwRm9udCBuYW1lLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3R5bGUuZm9udFNpemVdIC0gVGhlIHNpemUgb2YgdGhlIGZvbnQgaW4gcGl4ZWxzLCBlLmcuIDI0LiBJZiB1bmRlZmluZWQsXG4gICAgICouICAgICB0aGlzIHdpbGwgZGVmYXVsdCB0byB0aGUgQml0bWFwRm9udCBzaXplLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3R5bGUuYWxpZ249J2xlZnQnXSAtIEFsaWdubWVudCBmb3IgbXVsdGlsaW5lIHRleHQgKCdsZWZ0JywgJ2NlbnRlcicgb3IgJ3JpZ2h0JyksXG4gICAgICogICAgICBkb2VzIG5vdCBhZmZlY3Qgc2luZ2xlIGxpbmUgdGV4dC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLnRpbnQ9MHhGRkZGRkZdIC0gVGhlIHRpbnQgY29sb3IuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHlsZS5sZXR0ZXJTcGFjaW5nPTBdIC0gVGhlIGFtb3VudCBvZiBzcGFjaW5nIGJldHdlZW4gbGV0dGVycy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0eWxlLm1heFdpZHRoPTBdIC0gVGhlIG1heCB3aWR0aCBvZiB0aGUgdGV4dCBiZWZvcmUgbGluZSB3cmFwcGluZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0ZXh0OiBzdHJpbmcsIHN0eWxlOiBQYXJ0aWFsPElCaXRtYXBUZXh0U3R5bGU+ID0ge30pXG4gICAge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIGlmIChzdHlsZS5mb250KVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbignNS4zLjAnLCAnUElYSS5CaXRtYXBUZXh0IGNvbnN0cnVjdG9yIHN0eWxlLmZvbnQgcHJvcGVydHkgaXMgZGVwcmVjYXRlZC4nKTtcblxuICAgICAgICAgICAgdGhpcy5fdXBncmFkZVN0eWxlKHN0eWxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFwcGx5IHRoZSBkZWZhdWx0c1xuICAgICAgICBjb25zdCB7IGFsaWduLCB0aW50LCBtYXhXaWR0aCwgbGV0dGVyU3BhY2luZywgZm9udE5hbWUsIGZvbnRTaXplIH0gPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAge30sIEJpdG1hcFRleHQuc3R5bGVEZWZhdWx0cywgc3R5bGUpO1xuXG4gICAgICAgIGlmICghQml0bWFwRm9udC5hdmFpbGFibGVbZm9udE5hbWVdKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgQml0bWFwRm9udCBcIiR7Zm9udE5hbWV9XCJgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb2xsZWN0aW9uIG9mIHBhZ2UgbWVzaCBkYXRhLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtvYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9hY3RpdmVQYWdlc01lc2hEYXRhID0gW107XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFByaXZhdGUgdHJhY2tlciBmb3IgdGhlIHdpZHRoIG9mIHRoZSBvdmVyYWxsIHRleHRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGV4dFdpZHRoID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSB0cmFja2VyIGZvciB0aGUgaGVpZ2h0IG9mIHRoZSBvdmVyYWxsIHRleHRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGV4dEhlaWdodCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFByaXZhdGUgdHJhY2tlciBmb3IgdGhlIGN1cnJlbnQgdGV4dCBhbGlnbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYWxpZ24gPSBhbGlnbjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSB0cmFja2VyIGZvciB0aGUgY3VycmVudCB0aW50LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90aW50ID0gdGludDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUHJpdmF0ZSB0cmFja2VyIGZvciB0aGUgY3VycmVudCBmb250IG5hbWUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2ZvbnROYW1lID0gZm9udE5hbWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFByaXZhdGUgdHJhY2tlciBmb3IgdGhlIGN1cnJlbnQgZm9udCBzaXplLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9mb250U2l6ZSA9IGZvbnRTaXplIHx8IEJpdG1hcEZvbnQuYXZhaWxhYmxlW2ZvbnROYW1lXS5zaXplO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQcml2YXRlIHRyYWNrZXIgZm9yIHRoZSBjdXJyZW50IHRleHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3RleHQgPSB0ZXh0O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWF4IHdpZHRoIG9mIHRoaXMgYml0bWFwIHRleHQgaW4gcGl4ZWxzLiBJZiB0aGUgdGV4dCBwcm92aWRlZCBpcyBsb25nZXIgdGhhbiB0aGVcbiAgICAgICAgICogdmFsdWUgcHJvdmlkZWQsIGxpbmUgYnJlYWtzIHdpbGwgYmUgYXV0b21hdGljYWxseSBpbnNlcnRlZCBpbiB0aGUgbGFzdCB3aGl0ZXNwYWNlLlxuICAgICAgICAgKiBEaXNhYmxlIGJ5IHNldHRpbmcgdmFsdWUgdG8gMFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9tYXhXaWR0aCA9IG1heFdpZHRoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbWF4IGxpbmUgaGVpZ2h0LiBUaGlzIGlzIHVzZWZ1bCB3aGVuIHRyeWluZyB0byB1c2UgdGhlIHRvdGFsIGhlaWdodCBvZiB0aGUgVGV4dCxcbiAgICAgICAgICogaWU6IHdoZW4gdHJ5aW5nIHRvIHZlcnRpY2FsbHkgYWxpZ24uIChJbnRlcm5hbGx5IHVzZWQpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX21heExpbmVIZWlnaHQgPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMZXR0ZXIgc3BhY2luZy4gVGhpcyBpcyB1c2VmdWwgZm9yIHNldHRpbmcgdGhlIHNwYWNlIGJldHdlZW4gY2hhcmFjdGVycy5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbGV0dGVyU3BhY2luZyA9IGxldHRlclNwYWNpbmc7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRleHQgYW5jaG9yLiByZWFkLW9ubHlcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5PYnNlcnZhYmxlUG9pbnR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9hbmNob3IgPSBuZXcgT2JzZXJ2YWJsZVBvaW50KCgpOiB2b2lkID0+IHsgdGhpcy5kaXJ0eSA9IHRydWU7IH0sIHRoaXMsIDAsIDApO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0cnVlIFBpeGlKUyB3aWxsIE1hdGguZmxvb3IoKSB4L3kgdmFsdWVzIHdoZW4gcmVuZGVyaW5nXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuc2V0dGluZ3MuUk9VTkRfUElYRUxTXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9yb3VuZFBpeGVscyA9IHNldHRpbmdzLlJPVU5EX1BJWEVMUztcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IHRvIGB0cnVlYCBpZiB0aGUgQml0bWFwVGV4dCBuZWVkcyB0byBiZSByZWRyYXduLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhY2hlZCBjaGFyIHRleHR1cmUgaXMgZGVzdHJveWVkIHdoZW4gQml0bWFwVGV4dCBpcyBkZXN0cm95ZWRcbiAgICAgICAgICogQG1lbWJlciB7UmVjb3JkPG51bWJlciwgVGV4dHVyZT59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90ZXh0dXJlQ2FjaGUgPSB7fTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIHRleHQgYW5kIHVwZGF0ZXMgaXQgd2hlbiBuZWVkZWQuIFRoaXMgc2hvdWxkIG9ubHkgYmUgY2FsbGVkXG4gICAgICogaWYgdGhlIEJpdG1hcEZvbnQgaXMgcmVnZW5lcmF0ZWQuXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZVRleHQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IEJpdG1hcEZvbnQuYXZhaWxhYmxlW3RoaXMuX2ZvbnROYW1lXTtcbiAgICAgICAgY29uc3Qgc2NhbGUgPSB0aGlzLl9mb250U2l6ZSAvIGRhdGEuc2l6ZTtcbiAgICAgICAgY29uc3QgcG9zID0gbmV3IFBvaW50KCk7XG4gICAgICAgIGNvbnN0IGNoYXJzOiBDaGFyUmVuZGVyRGF0YVtdID0gW107XG4gICAgICAgIGNvbnN0IGxpbmVXaWR0aHMgPSBbXTtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMuX3RleHQucmVwbGFjZSgvKD86XFxyXFxufFxccikvZywgJ1xcbicpIHx8ICcgJztcbiAgICAgICAgY29uc3QgdGV4dExlbmd0aCA9IHRleHQubGVuZ3RoO1xuICAgICAgICBjb25zdCBtYXhXaWR0aCA9IHRoaXMuX21heFdpZHRoICogZGF0YS5zaXplIC8gdGhpcy5fZm9udFNpemU7XG5cbiAgICAgICAgbGV0IHByZXZDaGFyQ29kZSA9IG51bGw7XG4gICAgICAgIGxldCBsYXN0TGluZVdpZHRoID0gMDtcbiAgICAgICAgbGV0IG1heExpbmVXaWR0aCA9IDA7XG4gICAgICAgIGxldCBsaW5lID0gMDtcbiAgICAgICAgbGV0IGxhc3RCcmVha1BvcyA9IC0xO1xuICAgICAgICBsZXQgbGFzdEJyZWFrV2lkdGggPSAwO1xuICAgICAgICBsZXQgc3BhY2VzUmVtb3ZlZCA9IDA7XG4gICAgICAgIGxldCBtYXhMaW5lSGVpZ2h0ID0gMDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHRMZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgY2hhckNvZGUgPSB0ZXh0LmNoYXJDb2RlQXQoaSk7XG4gICAgICAgICAgICBjb25zdCBjaGFyID0gdGV4dC5jaGFyQXQoaSk7XG5cbiAgICAgICAgICAgIGlmICgoLyg/OlxccykvKS50ZXN0KGNoYXIpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhc3RCcmVha1BvcyA9IGk7XG4gICAgICAgICAgICAgICAgbGFzdEJyZWFrV2lkdGggPSBsYXN0TGluZVdpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xccicgfHwgY2hhciA9PT0gJ1xcbicpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGluZVdpZHRocy5wdXNoKGxhc3RMaW5lV2lkdGgpO1xuICAgICAgICAgICAgICAgIG1heExpbmVXaWR0aCA9IE1hdGgubWF4KG1heExpbmVXaWR0aCwgbGFzdExpbmVXaWR0aCk7XG4gICAgICAgICAgICAgICAgKytsaW5lO1xuICAgICAgICAgICAgICAgICsrc3BhY2VzUmVtb3ZlZDtcblxuICAgICAgICAgICAgICAgIHBvcy54ID0gMDtcbiAgICAgICAgICAgICAgICBwb3MueSArPSBkYXRhLmxpbmVIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcHJldkNoYXJDb2RlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2hhckRhdGEgPSBkYXRhLmNoYXJzW2NoYXJDb2RlXTtcblxuICAgICAgICAgICAgaWYgKCFjaGFyRGF0YSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHByZXZDaGFyQ29kZSAmJiBjaGFyRGF0YS5rZXJuaW5nW3ByZXZDaGFyQ29kZV0pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcG9zLnggKz0gY2hhckRhdGEua2VybmluZ1twcmV2Q2hhckNvZGVdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjaGFyUmVuZGVyRGF0YSA9IGNoYXJSZW5kZXJEYXRhUG9vbC5wb3AoKSB8fCB7XG4gICAgICAgICAgICAgICAgdGV4dHVyZTogVGV4dHVyZS5FTVBUWSxcbiAgICAgICAgICAgICAgICBsaW5lOiAwLFxuICAgICAgICAgICAgICAgIGNoYXJDb2RlOiAwLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgUG9pbnQoKSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNoYXJSZW5kZXJEYXRhLnRleHR1cmUgPSBjaGFyRGF0YS50ZXh0dXJlO1xuICAgICAgICAgICAgY2hhclJlbmRlckRhdGEubGluZSA9IGxpbmU7XG4gICAgICAgICAgICBjaGFyUmVuZGVyRGF0YS5jaGFyQ29kZSA9IGNoYXJDb2RlO1xuICAgICAgICAgICAgY2hhclJlbmRlckRhdGEucG9zaXRpb24ueCA9IHBvcy54ICsgY2hhckRhdGEueE9mZnNldCArICh0aGlzLl9sZXR0ZXJTcGFjaW5nIC8gMik7XG4gICAgICAgICAgICBjaGFyUmVuZGVyRGF0YS5wb3NpdGlvbi55ID0gcG9zLnkgKyBjaGFyRGF0YS55T2Zmc2V0O1xuXG4gICAgICAgICAgICBjaGFycy5wdXNoKGNoYXJSZW5kZXJEYXRhKTtcblxuICAgICAgICAgICAgcG9zLnggKz0gY2hhckRhdGEueEFkdmFuY2UgKyB0aGlzLl9sZXR0ZXJTcGFjaW5nO1xuICAgICAgICAgICAgbGFzdExpbmVXaWR0aCA9IHBvcy54O1xuICAgICAgICAgICAgbWF4TGluZUhlaWdodCA9IE1hdGgubWF4KG1heExpbmVIZWlnaHQsIChjaGFyRGF0YS55T2Zmc2V0ICsgY2hhckRhdGEudGV4dHVyZS5oZWlnaHQpKTtcbiAgICAgICAgICAgIHByZXZDaGFyQ29kZSA9IGNoYXJDb2RlO1xuXG4gICAgICAgICAgICBpZiAobGFzdEJyZWFrUG9zICE9PSAtMSAmJiBtYXhXaWR0aCA+IDAgJiYgcG9zLnggPiBtYXhXaWR0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICArK3NwYWNlc1JlbW92ZWQ7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSXRlbXMoY2hhcnMsIDEgKyBsYXN0QnJlYWtQb3MgLSBzcGFjZXNSZW1vdmVkLCAxICsgaSAtIGxhc3RCcmVha1Bvcyk7XG4gICAgICAgICAgICAgICAgaSA9IGxhc3RCcmVha1BvcztcbiAgICAgICAgICAgICAgICBsYXN0QnJlYWtQb3MgPSAtMTtcblxuICAgICAgICAgICAgICAgIGxpbmVXaWR0aHMucHVzaChsYXN0QnJlYWtXaWR0aCk7XG4gICAgICAgICAgICAgICAgbWF4TGluZVdpZHRoID0gTWF0aC5tYXgobWF4TGluZVdpZHRoLCBsYXN0QnJlYWtXaWR0aCk7XG4gICAgICAgICAgICAgICAgbGluZSsrO1xuXG4gICAgICAgICAgICAgICAgcG9zLnggPSAwO1xuICAgICAgICAgICAgICAgIHBvcy55ICs9IGRhdGEubGluZUhlaWdodDtcbiAgICAgICAgICAgICAgICBwcmV2Q2hhckNvZGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGFzdENoYXIgPSB0ZXh0LmNoYXJBdCh0ZXh0Lmxlbmd0aCAtIDEpO1xuXG4gICAgICAgIGlmIChsYXN0Q2hhciAhPT0gJ1xccicgJiYgbGFzdENoYXIgIT09ICdcXG4nKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoKC8oPzpcXHMpLykudGVzdChsYXN0Q2hhcikpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFzdExpbmVXaWR0aCA9IGxhc3RCcmVha1dpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaW5lV2lkdGhzLnB1c2gobGFzdExpbmVXaWR0aCk7XG4gICAgICAgICAgICBtYXhMaW5lV2lkdGggPSBNYXRoLm1heChtYXhMaW5lV2lkdGgsIGxhc3RMaW5lV2lkdGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGluZUFsaWduT2Zmc2V0cyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGxpbmU7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGFsaWduT2Zmc2V0ID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2FsaWduID09PSAncmlnaHQnKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFsaWduT2Zmc2V0ID0gbWF4TGluZVdpZHRoIC0gbGluZVdpZHRoc1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX2FsaWduID09PSAnY2VudGVyJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhbGlnbk9mZnNldCA9IChtYXhMaW5lV2lkdGggLSBsaW5lV2lkdGhzW2ldKSAvIDI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpbmVBbGlnbk9mZnNldHMucHVzaChhbGlnbk9mZnNldCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsZW5DaGFycyA9IGNoYXJzLmxlbmd0aDtcblxuICAgICAgICBjb25zdCBwYWdlc01lc2hEYXRhOiBSZWNvcmQ8bnVtYmVyLCBQYWdlTWVzaERhdGE+ID0ge307XG5cbiAgICAgICAgY29uc3QgbmV3UGFnZXNNZXNoRGF0YTogUGFnZU1lc2hEYXRhW10gPSBbXTtcblxuICAgICAgICBjb25zdCBhY3RpdmVQYWdlc01lc2hEYXRhID0gdGhpcy5fYWN0aXZlUGFnZXNNZXNoRGF0YTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjdGl2ZVBhZ2VzTWVzaERhdGEubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHBhZ2VNZXNoRGF0YVBvb2wucHVzaChhY3RpdmVQYWdlc01lc2hEYXRhW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuQ2hhcnM7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IGNoYXJzW2ldLnRleHR1cmU7XG4gICAgICAgICAgICBjb25zdCBiYXNlVGV4dHVyZVVpZCA9IHRleHR1cmUuYmFzZVRleHR1cmUudWlkO1xuXG4gICAgICAgICAgICBpZiAoIXBhZ2VzTWVzaERhdGFbYmFzZVRleHR1cmVVaWRdKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxldCBwYWdlTWVzaERhdGEgPSBwYWdlTWVzaERhdGFQb29sLnBvcCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFwYWdlTWVzaERhdGEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBNZXNoR2VvbWV0cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0ZXJpYWwgPSBuZXcgTWVzaE1hdGVyaWFsKFRleHR1cmUuRU1QVFkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhDb3VudDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnRleENvdW50OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXZzQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gsXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNlczogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2czogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGljZXM6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgZGF0YS4uXG4gICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEuaW5kZXhDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLnZlcnRleENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEudXZzQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YS50b3RhbCA9IDA7XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPIG5lZWQgdG8gZ2V0IHBhZ2UgdGV4dHVyZSBoZXJlIHNvbWVob3cuLlxuICAgICAgICAgICAgICAgIGNvbnN0IHsgX3RleHR1cmVDYWNoZSB9ID0gdGhpcztcblxuICAgICAgICAgICAgICAgIF90ZXh0dXJlQ2FjaGVbYmFzZVRleHR1cmVVaWRdID0gX3RleHR1cmVDYWNoZVtiYXNlVGV4dHVyZVVpZF0gfHwgbmV3IFRleHR1cmUodGV4dHVyZS5iYXNlVGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLm1lc2gudGV4dHVyZSA9IF90ZXh0dXJlQ2FjaGVbYmFzZVRleHR1cmVVaWRdO1xuXG4gICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLm1lc2gudGludCA9IHRoaXMuX3RpbnQ7XG5cbiAgICAgICAgICAgICAgICBuZXdQYWdlc01lc2hEYXRhLnB1c2gocGFnZU1lc2hEYXRhKTtcblxuICAgICAgICAgICAgICAgIHBhZ2VzTWVzaERhdGFbYmFzZVRleHR1cmVVaWRdID0gcGFnZU1lc2hEYXRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYWdlc01lc2hEYXRhW2Jhc2VUZXh0dXJlVWlkXS50b3RhbCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGV0cyBmaW5kIGFueSBwcmV2aW91c2x5IGFjdGl2ZSBwYWdlTWVzaERhdGFzIHRoYXQgYXJlIG5vIGxvbmdlciByZXF1aXJlZCBmb3JcbiAgICAgICAgLy8gdGhlIHVwZGF0ZWQgdGV4dCAoaWYgYW55KSwgcmVtb3ZlZCBhbmQgcmV0dXJuIHRoZW0gdG8gdGhlIHBvb2wuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWN0aXZlUGFnZXNNZXNoRGF0YS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKG5ld1BhZ2VzTWVzaERhdGEuaW5kZXhPZihhY3RpdmVQYWdlc01lc2hEYXRhW2ldKSA9PT0gLTEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlsZChhY3RpdmVQYWdlc01lc2hEYXRhW2ldLm1lc2gpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gbmV4dCBsZXRzIGFkZCBhbnkgbmV3IG1lc2hlcywgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBhZGRlZCB0byB0aGlzIEJpdG1hcFRleHRcbiAgICAgICAgLy8gd2Ugb25seSBhZGQgaWYgaXRzIG5vdCBhbHJlYWR5IGEgY2hpbGQgb2YgdGhpcyBCaXRtYXBPYmplY3RcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdQYWdlc01lc2hEYXRhLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAobmV3UGFnZXNNZXNoRGF0YVtpXS5tZXNoLnBhcmVudCAhPT0gdGhpcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ld1BhZ2VzTWVzaERhdGFbaV0ubWVzaCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBhY3RpdmUgcGFnZSBtZXNoIGRhdGFzIGFyZSBzZXQgdG8gYmUgdGhlIG5ldyBwYWdlcyBhZGRlZC5cbiAgICAgICAgdGhpcy5fYWN0aXZlUGFnZXNNZXNoRGF0YSA9IG5ld1BhZ2VzTWVzaERhdGE7XG5cbiAgICAgICAgZm9yIChjb25zdCBpIGluIHBhZ2VzTWVzaERhdGEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VNZXNoRGF0YSA9IHBhZ2VzTWVzaERhdGFbaV07XG4gICAgICAgICAgICBjb25zdCB0b3RhbCA9IHBhZ2VNZXNoRGF0YS50b3RhbDtcblxuICAgICAgICAgICAgLy8gbGV0cyBvbmx5IGFsbG9jYXRlIG5ldyBidWZmZXJzIGlmIHdlIGNhbiBmaXQgdGhlIG5ldyB0ZXh0IGluIHRoZSBjdXJyZW50IG9uZXMuLlxuICAgICAgICAgICAgLy8gdW5sZXNzIHRoYXQgaXMsIHdlIHdpbGwgYmUgYmF0Y2hpbmcuIEN1cnJlbnRseSBiYXRjaGluZyBkb3NlIG5vdCByZXNwZWN0IHRoZSBzaXplIHByb3BlcnR5IG9mIG1lc2hcbiAgICAgICAgICAgIGlmICghKHBhZ2VNZXNoRGF0YS5pbmRpY2VzPy5sZW5ndGggPiA2ICogdG90YWwpIHx8IHBhZ2VNZXNoRGF0YS52ZXJ0aWNlcy5sZW5ndGggPCBNZXNoLkJBVENIQUJMRV9TSVpFICogMilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEudmVydGljZXMgPSBuZXcgRmxvYXQzMkFycmF5KDQgKiAyICogdG90YWwpO1xuICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YS51dnMgPSBuZXcgRmxvYXQzMkFycmF5KDQgKiAyICogdG90YWwpO1xuICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YS5pbmRpY2VzID0gbmV3IFVpbnQxNkFycmF5KDYgKiB0b3RhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG90YWwgPSBwYWdlTWVzaERhdGEudG90YWw7XG4gICAgICAgICAgICAgICAgY29uc3QgdmVydGljZXMgPSBwYWdlTWVzaERhdGEudmVydGljZXM7XG5cbiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgZ2FyYmFnZSBhdCB0aGUgZW5kIG9mIHRoZSB2ZXJ0aWNlcyBidWZmZXIuIFRoaXMgd2lsbCBwcmV2ZW50IHRoZSBib3VuZHMgbWlzY2FsY3VsYXRpb24uXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRvdGFsICogNCAqIDI7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRpY2VzW2ldID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFzIGEgYnVmZmVyIG1heWJlIGJpZ2dlciB0aGFuIHRoZSBjdXJyZW50IHdvcmQsIHdlIHNldCB0aGUgc2l6ZSBvZiB0aGUgbWVzaE1hdGVyaWFsXG4gICAgICAgICAgICAvLyB0byBtYXRjaCB0aGUgbnVtYmVyIG9mIGxldHRlcnMgbmVlZGVkXG4gICAgICAgICAgICBwYWdlTWVzaERhdGEubWVzaC5zaXplID0gNiAqIHRvdGFsO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5DaGFyczsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBjaGFyID0gY2hhcnNbaV07XG4gICAgICAgICAgICBsZXQgb2Zmc2V0ID0gY2hhci5wb3NpdGlvbi54ICsgbGluZUFsaWduT2Zmc2V0c1tjaGFyLmxpbmVdO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcm91bmRQaXhlbHMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gTWF0aC5yb3VuZChvZmZzZXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB4UG9zID0gb2Zmc2V0ICogc2NhbGU7XG4gICAgICAgICAgICBjb25zdCB5UG9zID0gY2hhci5wb3NpdGlvbi55ICogc2NhbGU7XG4gICAgICAgICAgICBjb25zdCB0ZXh0dXJlID0gY2hhci50ZXh0dXJlO1xuXG4gICAgICAgICAgICBjb25zdCBwYWdlTWVzaCA9IHBhZ2VzTWVzaERhdGFbdGV4dHVyZS5iYXNlVGV4dHVyZS51aWRdO1xuXG4gICAgICAgICAgICBjb25zdCB0ZXh0dXJlRnJhbWUgPSB0ZXh0dXJlLmZyYW1lO1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZVV2cyA9IHRleHR1cmUuX3V2cztcblxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwYWdlTWVzaC5pbmRleCsrO1xuXG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgMF0gPSAwICsgKGluZGV4ICogNCk7XG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgMV0gPSAxICsgKGluZGV4ICogNCk7XG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgMl0gPSAyICsgKGluZGV4ICogNCk7XG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgM10gPSAwICsgKGluZGV4ICogNCk7XG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgNF0gPSAyICsgKGluZGV4ICogNCk7XG4gICAgICAgICAgICBwYWdlTWVzaC5pbmRpY2VzWyhpbmRleCAqIDYpICsgNV0gPSAzICsgKGluZGV4ICogNCk7XG5cbiAgICAgICAgICAgIHBhZ2VNZXNoLnZlcnRpY2VzWyhpbmRleCAqIDgpICsgMF0gPSB4UG9zO1xuICAgICAgICAgICAgcGFnZU1lc2gudmVydGljZXNbKGluZGV4ICogOCkgKyAxXSA9IHlQb3M7XG5cbiAgICAgICAgICAgIHBhZ2VNZXNoLnZlcnRpY2VzWyhpbmRleCAqIDgpICsgMl0gPSB4UG9zICsgKHRleHR1cmVGcmFtZS53aWR0aCAqIHNjYWxlKTtcbiAgICAgICAgICAgIHBhZ2VNZXNoLnZlcnRpY2VzWyhpbmRleCAqIDgpICsgM10gPSB5UG9zO1xuXG4gICAgICAgICAgICBwYWdlTWVzaC52ZXJ0aWNlc1soaW5kZXggKiA4KSArIDRdID0geFBvcyArICh0ZXh0dXJlRnJhbWUud2lkdGggKiBzY2FsZSk7XG4gICAgICAgICAgICBwYWdlTWVzaC52ZXJ0aWNlc1soaW5kZXggKiA4KSArIDVdID0geVBvcyArICh0ZXh0dXJlRnJhbWUuaGVpZ2h0ICogc2NhbGUpO1xuXG4gICAgICAgICAgICBwYWdlTWVzaC52ZXJ0aWNlc1soaW5kZXggKiA4KSArIDZdID0geFBvcztcbiAgICAgICAgICAgIHBhZ2VNZXNoLnZlcnRpY2VzWyhpbmRleCAqIDgpICsgN10gPSB5UG9zICsgKHRleHR1cmVGcmFtZS5oZWlnaHQgKiBzY2FsZSk7XG5cbiAgICAgICAgICAgIHBhZ2VNZXNoLnV2c1soaW5kZXggKiA4KSArIDBdID0gdGV4dHVyZVV2cy54MDtcbiAgICAgICAgICAgIHBhZ2VNZXNoLnV2c1soaW5kZXggKiA4KSArIDFdID0gdGV4dHVyZVV2cy55MDtcblxuICAgICAgICAgICAgcGFnZU1lc2gudXZzWyhpbmRleCAqIDgpICsgMl0gPSB0ZXh0dXJlVXZzLngxO1xuICAgICAgICAgICAgcGFnZU1lc2gudXZzWyhpbmRleCAqIDgpICsgM10gPSB0ZXh0dXJlVXZzLnkxO1xuXG4gICAgICAgICAgICBwYWdlTWVzaC51dnNbKGluZGV4ICogOCkgKyA0XSA9IHRleHR1cmVVdnMueDI7XG4gICAgICAgICAgICBwYWdlTWVzaC51dnNbKGluZGV4ICogOCkgKyA1XSA9IHRleHR1cmVVdnMueTI7XG5cbiAgICAgICAgICAgIHBhZ2VNZXNoLnV2c1soaW5kZXggKiA4KSArIDZdID0gdGV4dHVyZVV2cy54MztcbiAgICAgICAgICAgIHBhZ2VNZXNoLnV2c1soaW5kZXggKiA4KSArIDddID0gdGV4dHVyZVV2cy55MztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3RleHRXaWR0aCA9IG1heExpbmVXaWR0aCAqIHNjYWxlO1xuICAgICAgICB0aGlzLl90ZXh0SGVpZ2h0ID0gKHBvcy55ICsgZGF0YS5saW5lSGVpZ2h0KSAqIHNjYWxlO1xuXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiBwYWdlc01lc2hEYXRhKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBwYWdlTWVzaERhdGEgPSBwYWdlc01lc2hEYXRhW2ldO1xuXG4gICAgICAgICAgICAvLyBhcHBseSBhbmNob3JcbiAgICAgICAgICAgIGlmICh0aGlzLmFuY2hvci54ICE9PSAwIHx8IHRoaXMuYW5jaG9yLnkgIT09IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IHZlcnRleENvdW50ID0gMDtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2hvck9mZnNldFggPSB0aGlzLl90ZXh0V2lkdGggKiB0aGlzLmFuY2hvci54O1xuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2hvck9mZnNldFkgPSB0aGlzLl90ZXh0SGVpZ2h0ICogdGhpcy5hbmNob3IueTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZU1lc2hEYXRhLnRvdGFsOyBpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEudmVydGljZXNbdmVydGV4Q291bnQrK10gLT0gYW5jaG9yT2Zmc2V0WDtcbiAgICAgICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLnZlcnRpY2VzW3ZlcnRleENvdW50KytdIC09IGFuY2hvck9mZnNldFk7XG5cbiAgICAgICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLnZlcnRpY2VzW3ZlcnRleENvdW50KytdIC09IGFuY2hvck9mZnNldFg7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YS52ZXJ0aWNlc1t2ZXJ0ZXhDb3VudCsrXSAtPSBhbmNob3JPZmZzZXRZO1xuXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VNZXNoRGF0YS52ZXJ0aWNlc1t2ZXJ0ZXhDb3VudCsrXSAtPSBhbmNob3JPZmZzZXRYO1xuICAgICAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEudmVydGljZXNbdmVydGV4Q291bnQrK10gLT0gYW5jaG9yT2Zmc2V0WTtcblxuICAgICAgICAgICAgICAgICAgICBwYWdlTWVzaERhdGEudmVydGljZXNbdmVydGV4Q291bnQrK10gLT0gYW5jaG9yT2Zmc2V0WDtcbiAgICAgICAgICAgICAgICAgICAgcGFnZU1lc2hEYXRhLnZlcnRpY2VzW3ZlcnRleENvdW50KytdIC09IGFuY2hvck9mZnNldFk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9tYXhMaW5lSGVpZ2h0ID0gbWF4TGluZUhlaWdodCAqIHNjYWxlO1xuXG4gICAgICAgICAgICBjb25zdCB2ZXJ0ZXhCdWZmZXIgPSBwYWdlTWVzaERhdGEubWVzaC5nZW9tZXRyeS5nZXRCdWZmZXIoJ2FWZXJ0ZXhQb3NpdGlvbicpO1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZUJ1ZmZlciA9IHBhZ2VNZXNoRGF0YS5tZXNoLmdlb21ldHJ5LmdldEJ1ZmZlcignYVRleHR1cmVDb29yZCcpO1xuICAgICAgICAgICAgY29uc3QgaW5kZXhCdWZmZXIgPSBwYWdlTWVzaERhdGEubWVzaC5nZW9tZXRyeS5nZXRJbmRleCgpO1xuXG4gICAgICAgICAgICB2ZXJ0ZXhCdWZmZXIuZGF0YSA9IHBhZ2VNZXNoRGF0YS52ZXJ0aWNlcztcbiAgICAgICAgICAgIHRleHR1cmVCdWZmZXIuZGF0YSA9IHBhZ2VNZXNoRGF0YS51dnM7XG4gICAgICAgICAgICBpbmRleEJ1ZmZlci5kYXRhID0gcGFnZU1lc2hEYXRhLmluZGljZXM7XG5cbiAgICAgICAgICAgIHZlcnRleEJ1ZmZlci51cGRhdGUoKTtcbiAgICAgICAgICAgIHRleHR1cmVCdWZmZXIudXBkYXRlKCk7XG4gICAgICAgICAgICBpbmRleEJ1ZmZlci51cGRhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNoYXJSZW5kZXJEYXRhUG9vbC5wdXNoKGNoYXJzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHRyYW5zZm9ybSBvZiB0aGlzIG9iamVjdFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cGRhdGVUcmFuc2Zvcm0oKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lclVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlcyB0ZXh0IGJlZm9yZSBjYWxsaW5nIHBhcmVudCdzIGdldExvY2FsQm91bmRzXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlJlY3RhbmdsZX0gVGhlIHJlY3Rhbmd1bGFyIGJvdW5kaW5nIGFyZWFcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0TG9jYWxCb3VuZHMoKTogUmVjdGFuZ2xlXG4gICAge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG5cbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldExvY2FsQm91bmRzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0ZXh0IHdoZW4gbmVlZGVkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCB2YWxpZGF0ZSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5kaXJ0eSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUZXh0KCk7XG4gICAgICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdGludCBvZiB0aGUgQml0bWFwVGV4dCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMHhmZmZmZmZcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHRpbnQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGludDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0IHRpbnQodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl90aW50ID09PSB2YWx1ZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuX3RpbnQgPSB2YWx1ZTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2FjdGl2ZVBhZ2VzTWVzaERhdGEubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVBhZ2VzTWVzaERhdGFbaV0ubWVzaC50aW50ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYWxpZ25tZW50IG9mIHRoZSBCaXRtYXBUZXh0IG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKiBAZGVmYXVsdCAnbGVmdCdcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGFsaWduKCk6IFRleHRTdHlsZUFsaWduXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYWxpZ247XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBhbGlnbih2YWx1ZTogVGV4dFN0eWxlQWxpZ24pXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fYWxpZ24gIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hbGlnbiA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgQml0bWFwRm9udC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge3N0cmluZ31cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGZvbnROYW1lKCk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvbnROYW1lO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgZm9udE5hbWUodmFsdWU6IHN0cmluZylcbiAgICB7XG4gICAgICAgIGlmICghQml0bWFwRm9udC5hdmFpbGFibGVbdmFsdWVdKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgQml0bWFwRm9udCBcIiR7dmFsdWV9XCJgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9mb250TmFtZSAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2ZvbnROYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBzaXplIG9mIHRoZSBmb250IHRvIGRpc3BsYXkuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHVibGljIGdldCBmb250U2l6ZSgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb250U2l6ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0IGZvbnRTaXplKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fZm9udFNpemUgIT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9mb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYW5jaG9yIHNldHMgdGhlIG9yaWdpbiBwb2ludCBvZiB0aGUgdGV4dC5cbiAgICAgKlxuICAgICAqIFRoZSBkZWZhdWx0IGlzIGAoMCwwKWAsIHRoaXMgbWVhbnMgdGhlIHRleHQncyBvcmlnaW4gaXMgdGhlIHRvcCBsZWZ0LlxuICAgICAqXG4gICAgICogU2V0dGluZyB0aGUgYW5jaG9yIHRvIGAoMC41LDAuNSlgIG1lYW5zIHRoZSB0ZXh0J3Mgb3JpZ2luIGlzIGNlbnRlcmVkLlxuICAgICAqXG4gICAgICogU2V0dGluZyB0aGUgYW5jaG9yIHRvIGAoMSwxKWAgd291bGQgbWVhbiB0aGUgdGV4dCdzIG9yaWdpbiBwb2ludCB3aWxsIGJlIHRoZSBib3R0b20gcmlnaHQgY29ybmVyLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5Qb2ludCB8IG51bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGFuY2hvcigpOiBPYnNlcnZhYmxlUG9pbnRcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbmNob3I7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBhbmNob3IodmFsdWU6IE9ic2VydmFibGVQb2ludClcbiAgICB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9hbmNob3Iuc2V0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2FuY2hvci5jb3B5RnJvbSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdGV4dCBvZiB0aGUgQml0bWFwVGV4dCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtzdHJpbmd9XG4gICAgICovXG4gICAgcHVibGljIGdldCB0ZXh0KCk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RleHQ7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCB0ZXh0KHRleHQ6IHN0cmluZylcbiAgICB7XG4gICAgICAgIHRleHQgPSBTdHJpbmcodGV4dCA9PT0gbnVsbCB8fCB0ZXh0ID09PSB1bmRlZmluZWQgPyAnJyA6IHRleHQpO1xuXG4gICAgICAgIGlmICh0aGlzLl90ZXh0ID09PSB0ZXh0KVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXggd2lkdGggb2YgdGhpcyBiaXRtYXAgdGV4dCBpbiBwaXhlbHMuIElmIHRoZSB0ZXh0IHByb3ZpZGVkIGlzIGxvbmdlciB0aGFuIHRoZVxuICAgICAqIHZhbHVlIHByb3ZpZGVkLCBsaW5lIGJyZWFrcyB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgaW5zZXJ0ZWQgaW4gdGhlIGxhc3Qgd2hpdGVzcGFjZS5cbiAgICAgKiBEaXNhYmxlIGJ5IHNldHRpbmcgdGhlIHZhbHVlIHRvIDAuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHVibGljIGdldCBtYXhXaWR0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXhXaWR0aDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0IG1heFdpZHRoKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fbWF4V2lkdGggPT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWF4V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIG1heCBsaW5lIGhlaWdodC4gVGhpcyBpcyB1c2VmdWwgd2hlbiB0cnlpbmcgdG8gdXNlIHRoZSB0b3RhbCBoZWlnaHQgb2YgdGhlIFRleHQsXG4gICAgICogaS5lLiB3aGVuIHRyeWluZyB0byB2ZXJ0aWNhbGx5IGFsaWduLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgbWF4TGluZUhlaWdodCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHRoaXMudmFsaWRhdGUoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fbWF4TGluZUhlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIG92ZXJhbGwgdGV4dCwgZGlmZmVyZW50IGZyb20gZm9udFNpemUsXG4gICAgICogd2hpY2ggaXMgZGVmaW5lZCBpbiB0aGUgc3R5bGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgdGV4dFdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSgpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0V2lkdGg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkaXRpb25hbCBzcGFjZSBiZXR3ZWVuIGNoYXJhY3RlcnMuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgcHVibGljIGdldCBsZXR0ZXJTcGFjaW5nKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xldHRlclNwYWNpbmc7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBsZXR0ZXJTcGFjaW5nKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fbGV0dGVyU3BhY2luZyAhPT0gdmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2xldHRlclNwYWNpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdHJ1ZSBQaXhpSlMgd2lsbCBNYXRoLmZsb29yKCkgeC95IHZhbHVlcyB3aGVuIHJlbmRlcmluZywgc3RvcHBpbmcgcGl4ZWwgaW50ZXJwb2xhdGlvbi5cbiAgICAgKiBBZHZhbnRhZ2VzIGNhbiBpbmNsdWRlIHNoYXJwZXIgaW1hZ2UgcXVhbGl0eSAobGlrZSB0ZXh0KSBhbmQgZmFzdGVyIHJlbmRlcmluZyBvbiBjYW52YXMuXG4gICAgICogVGhlIG1haW4gZGlzYWR2YW50YWdlIGlzIG1vdmVtZW50IG9mIG9iamVjdHMgbWF5IGFwcGVhciBsZXNzIHNtb290aC5cbiAgICAgKiBUbyBzZXQgdGhlIGdsb2JhbCBkZWZhdWx0LCBjaGFuZ2Uge0BsaW5rIFBJWEkuc2V0dGluZ3MuUk9VTkRfUElYRUxTfVxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCBQSVhJLnNldHRpbmdzLlJPVU5EX1BJWEVMU1xuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcm91bmRQaXhlbHMoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kUGl4ZWxzO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgcm91bmRQaXhlbHModmFsdWU6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX3JvdW5kUGl4ZWxzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9yb3VuZFBpeGVscyA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBvdmVyYWxsIHRleHQsIGRpZmZlcmVudCBmcm9tIGZvbnRTaXplLFxuICAgICAqIHdoaWNoIGlzIGRlZmluZWQgaW4gdGhlIHN0eWxlIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHRleHRIZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICB0aGlzLnZhbGlkYXRlKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3RleHRIZWlnaHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHksIGNvbnZlcnQgb2xkIHN0eWxlLmZvbnQgY29uc3RydWN0b3IgcGFyYW0gdG8gZm9udE5hbWUgJiBmb250U2l6ZSBwcm9wZXJ0aWVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjMuMFxuICAgICAqL1xuICAgIF91cGdyYWRlU3R5bGUoc3R5bGU6IFBhcnRpYWw8SUJpdG1hcFRleHRTdHlsZT4pOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodHlwZW9mIHN0eWxlLmZvbnQgPT09ICdzdHJpbmcnKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZVNwbGl0ID0gc3R5bGUuZm9udC5zcGxpdCgnICcpO1xuXG4gICAgICAgICAgICBzdHlsZS5mb250TmFtZSA9IHZhbHVlU3BsaXQubGVuZ3RoID09PSAxXG4gICAgICAgICAgICAgICAgPyB2YWx1ZVNwbGl0WzBdXG4gICAgICAgICAgICAgICAgOiB2YWx1ZVNwbGl0LnNsaWNlKDEpLmpvaW4oJyAnKTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlU3BsaXQubGVuZ3RoID49IDIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3R5bGUuZm9udFNpemUgPSBwYXJzZUludCh2YWx1ZVNwbGl0WzBdLCAxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBzdHlsZS5mb250TmFtZSA9IHN0eWxlLmZvbnQubmFtZTtcbiAgICAgICAgICAgIHN0eWxlLmZvbnRTaXplID0gdHlwZW9mIHN0eWxlLmZvbnQuc2l6ZSA9PT0gJ251bWJlcidcbiAgICAgICAgICAgICAgICA/IHN0eWxlLmZvbnQuc2l6ZVxuICAgICAgICAgICAgICAgIDogcGFyc2VJbnQoc3R5bGUuZm9udC5zaXplLCAxMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXN0cm95KG9wdGlvbnM/OiBib29sZWFuIHwgSURlc3Ryb3lPcHRpb25zKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeyBfdGV4dHVyZUNhY2hlIH0gPSB0aGlzO1xuXG4gICAgICAgIGZvciAoY29uc3QgaWQgaW4gX3RleHR1cmVDYWNoZSlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdGV4dHVyZSA9IF90ZXh0dXJlQ2FjaGVbaWRdO1xuXG4gICAgICAgICAgICB0ZXh0dXJlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIGRlbGV0ZSBfdGV4dHVyZUNhY2hlW2lkXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3RleHR1cmVDYWNoZSA9IG51bGw7XG5cbiAgICAgICAgc3VwZXIuZGVzdHJveShvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIGJpdG1hcCBmb250IHdpdGggZGF0YSBhbmQgYSB0ZXh0dXJlLlxuICAgICAqXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgKiBAc2VlIFBJWEkuQml0bWFwRm9udC5pbnN0YWxsXG4gICAgICogQHN0YXRpY1xuICAgICAqL1xuICAgIHN0YXRpYyByZWdpc3RlckZvbnQoZGF0YTogc3RyaW5nfFhNTERvY3VtZW50fEJpdG1hcEZvbnREYXRhLCB0ZXh0dXJlczogVGV4dHVyZXxUZXh0dXJlW118RGljdDxUZXh0dXJlPik6IEJpdG1hcEZvbnRcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdQSVhJLkJpdG1hcFRleHQucmVnaXN0ZXJGb250IGlzIGRlcHJlY2F0ZWQsIHVzZSBQSVhJLkJpdG1hcEZvbnQuaW5zdGFsbCcpO1xuXG4gICAgICAgIHJldHVybiBCaXRtYXBGb250Lmluc3RhbGwoZGF0YSwgdGV4dHVyZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbGlzdCBvZiBpbnN0YWxsZWQgZm9udHMuXG4gICAgICpcbiAgICAgKiBAc2VlIFBJWEkuQml0bWFwRm9udC5hdmFpbGFibGVcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjMuMFxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKiBAbWVtYmVyIHtPYmplY3QuPHN0cmluZywgUElYSS5CaXRtYXBGb250Pn1cbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0IGZvbnRzKCk6IERpY3Q8Qml0bWFwRm9udD5cbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdQSVhJLkJpdG1hcFRleHQuZm9udHMgaXMgZGVwcmVjYXRlZCwgdXNlIFBJWEkuQml0bWFwRm9udC5hdmFpbGFibGUnKTtcblxuICAgICAgICByZXR1cm4gQml0bWFwRm9udC5hdmFpbGFibGU7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IExvYWRlclJlc291cmNlIH0gZnJvbSAnQHBpeGkvbG9hZGVycyc7XG5pbXBvcnQgeyBhdXRvRGV0ZWN0Rm9ybWF0IH0gZnJvbSAnLi9mb3JtYXRzJztcbmltcG9ydCB7IEJpdG1hcEZvbnQgfSBmcm9tICcuL0JpdG1hcEZvbnQnO1xuXG5pbXBvcnQgdHlwZSB7IElMb2FkZXJSZXNvdXJjZSB9IGZyb20gJ0BwaXhpL2xvYWRlcnMnO1xuaW1wb3J0IHR5cGUgeyBEaWN0IH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuaW1wb3J0IHR5cGUgeyBMb2FkZXIgfSBmcm9tICdAcGl4aS9sb2FkZXJzJztcbmltcG9ydCB0eXBlIHsgVGV4dHVyZSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuXG4vKipcbiAqIHtAbGluayBQSVhJLkxvYWRlciBMb2FkZXJ9IG1pZGRsZXdhcmUgZm9yIGxvYWRpbmdcbiAqIGJpdG1hcC1iYXNlZCBmb250cyBzdWl0YWJsZSBmb3IgdXNpbmcgd2l0aCB7QGxpbmsgUElYSS5CaXRtYXBUZXh0fS5cbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBpbXBsZW1lbnRzIFBJWEkuSUxvYWRlclBsdWdpblxuICovXG5leHBvcnQgY2xhc3MgQml0bWFwRm9udExvYWRlclxue1xuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBwbHVnaW4gaXMgaW5zdGFsbGVkLlxuICAgICAqXG4gICAgICogQHNlZSBQSVhJLkxvYWRlci5yZWdpc3RlclBsdWdpblxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYWRkKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIExvYWRlclJlc291cmNlLnNldEV4dGVuc2lvblhoclR5cGUoJ2ZudCcsIExvYWRlclJlc291cmNlLlhIUl9SRVNQT05TRV9UWVBFLlRFWFQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCBhZnRlciBhIHJlc291cmNlIGlzIGxvYWRlZC5cbiAgICAgKiBAc2VlIFBJWEkuTG9hZGVyLmxvYWRlck1pZGRsZXdhcmVcbiAgICAgKiBAcGFyYW0ge1BJWEkuTG9hZGVyUmVzb3VyY2V9IHJlc291cmNlXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbmV4dFxuICAgICAqL1xuICAgIHN0YXRpYyB1c2UodGhpczogTG9hZGVyLCByZXNvdXJjZTogSUxvYWRlclJlc291cmNlLCBuZXh0OiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBmb3JtYXQgPSBhdXRvRGV0ZWN0Rm9ybWF0KHJlc291cmNlLmRhdGEpO1xuXG4gICAgICAgIC8vIFJlc291cmNlIHdhcyBub3QgcmVjb2duaXNlZCBhcyBhbnkgb2YgdGhlIGV4cGVjdGVkIGZvbnQgZGF0YSBmb3JtYXRcbiAgICAgICAgaWYgKCFmb3JtYXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5leHQoKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmFzZVVybCA9IEJpdG1hcEZvbnRMb2FkZXIuZ2V0QmFzZVVybCh0aGlzLCByZXNvdXJjZSk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBmb3JtYXQucGFyc2UocmVzb3VyY2UuZGF0YSk7XG4gICAgICAgIGNvbnN0IHRleHR1cmVzOiBEaWN0PFRleHR1cmU+ID0ge307XG5cbiAgICAgICAgLy8gSGFuZGxlIGNvbXBsZXRlZCwgd2hlbiB0aGUgbnVtYmVyIG9mIHRleHR1cmVzXG4gICAgICAgIC8vIGxvYWQgaXMgdGhlIHNhbWUgbnVtYmVyIGFzIHJlZmVyZW5jZXMgaW4gdGhlIGZudCBmaWxlXG4gICAgICAgIGNvbnN0IGNvbXBsZXRlZCA9IChwYWdlOiBJTG9hZGVyUmVzb3VyY2UpOiB2b2lkID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRleHR1cmVzW3BhZ2UubWV0YWRhdGEucGFnZUZpbGVdID0gcGFnZS50ZXh0dXJlO1xuXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModGV4dHVyZXMpLmxlbmd0aCA9PT0gZGF0YS5wYWdlLmxlbmd0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXNvdXJjZS5iaXRtYXBGb250ID0gQml0bWFwRm9udC5pbnN0YWxsKGRhdGEsIHRleHR1cmVzKTtcbiAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnBhZ2UubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VGaWxlID0gZGF0YS5wYWdlW2ldLmZpbGU7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBiYXNlVXJsICsgcGFnZUZpbGU7XG4gICAgICAgICAgICBsZXQgZXhpc3RzID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIGluY2FzZSB0aGUgaW1hZ2UgaXMgbG9hZGVkIG91dHNpZGVcbiAgICAgICAgICAgIC8vIHVzaW5nIHRoZSBzYW1lIGxvYWRlciwgcmVzb3VyY2Ugd2lsbCBiZSBhdmFpbGFibGVcbiAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBpbiB0aGlzLnJlc291cmNlcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBiaXRtYXBSZXNvdXJjZTogSUxvYWRlclJlc291cmNlID0gdGhpcy5yZXNvdXJjZXNbbmFtZV07XG5cbiAgICAgICAgICAgICAgICBpZiAoYml0bWFwUmVzb3VyY2UudXJsID09PSB1cmwpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBiaXRtYXBSZXNvdXJjZS5tZXRhZGF0YS5wYWdlRmlsZSA9IHBhZ2VGaWxlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYml0bWFwUmVzb3VyY2UudGV4dHVyZSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkKGJpdG1hcFJlc291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJpdG1hcFJlc291cmNlLm9uQWZ0ZXJNaWRkbGV3YXJlLmFkZChjb21wbGV0ZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gdGV4dHVyZSBpcyBub3QgbG9hZGVkLCB3ZSdsbCBhdHRlbXB0IHRvIGFkZFxuICAgICAgICAgICAgLy8gaXQgdG8gdGhlIGxvYWQgYW5kIGFkZCB0aGUgdGV4dHVyZSB0byB0aGUgbGlzdFxuICAgICAgICAgICAgaWYgKCFleGlzdHMpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gU3RhbmRhcmQgbG9hZGluZyBvcHRpb25zIGZvciBpbWFnZXNcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBjcm9zc09yaWdpbjogcmVzb3VyY2UuY3Jvc3NPcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgIGxvYWRUeXBlOiBMb2FkZXJSZXNvdXJjZS5MT0FEX1RZUEUuSU1BR0UsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBwYWdlRmlsZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UubWV0YWRhdGEuaW1hZ2VNZXRhZGF0YVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRSZXNvdXJjZTogcmVzb3VyY2UsXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYWRkKHVybCwgb3B0aW9ucywgY29tcGxldGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmb2xkZXIgcGF0aCBmcm9tIGEgcmVzb3VyY2VcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7UElYSS5Mb2FkZXJ9IGxvYWRlclxuICAgICAqIEBwYXJhbSB7UElYSS5Mb2FkZXJSZXNvdXJjZX0gcmVzb3VyY2VcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2V0QmFzZVVybChsb2FkZXI6IExvYWRlciwgcmVzb3VyY2U6IElMb2FkZXJSZXNvdXJjZSk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgbGV0IHJlc1VybCA9ICFyZXNvdXJjZS5pc0RhdGFVcmwgPyBCaXRtYXBGb250TG9hZGVyLmRpcm5hbWUocmVzb3VyY2UudXJsKSA6ICcnO1xuXG4gICAgICAgIGlmIChyZXNvdXJjZS5pc0RhdGFVcmwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChyZXNVcmwgPT09ICcuJylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXNVcmwgPSAnJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGxvYWRlci5iYXNlVXJsICYmIHJlc1VybClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBiYXNldXJsIGhhcyBhIHRyYWlsaW5nIHNsYXNoIHRoZW4gYWRkIG9uZSB0byByZXNVcmwgc28gdGhlIHJlcGxhY2Ugd29ya3MgYmVsb3dcbiAgICAgICAgICAgICAgICBpZiAobG9hZGVyLmJhc2VVcmwuY2hhckF0KGxvYWRlci5iYXNlVXJsLmxlbmd0aCAtIDEpID09PSAnLycpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXNVcmwgKz0gJy8nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlbW92ZSBiYXNlVXJsIGZyb20gcmVzVXJsXG4gICAgICAgIHJlc1VybCA9IHJlc1VybC5yZXBsYWNlKGxvYWRlci5iYXNlVXJsLCAnJyk7XG5cbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYW4gcmVzVXJsIG5vdywgaXQgbmVlZHMgYSB0cmFpbGluZyBzbGFzaC4gRW5zdXJlIHRoYXQgaXQgZG9lcyBpZiB0aGUgc3RyaW5nIGlzbid0IGVtcHR5LlxuICAgICAgICBpZiAocmVzVXJsICYmIHJlc1VybC5jaGFyQXQocmVzVXJsLmxlbmd0aCAtIDEpICE9PSAnLycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJlc1VybCArPSAnLyc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzVXJsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcGxhY2VtZW50IGZvciBOb2RlSlMncyBwYXRoLmRpcm5hbWVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBQYXRoIHRvIGdldCBkaXJlY3RvcnkgZm9yXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgZGlybmFtZSh1cmw6IHN0cmluZyk6IHN0cmluZ1xuICAgIHtcbiAgICAgICAgY29uc3QgZGlyID0gdXJsXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxcXC9nLCAnLycpIC8vIGNvbnZlcnQgd2luZG93cyBub3RhdGlvbiB0byBVTklYIG5vdGF0aW9uLCBVUkwtc2FmZSBiZWNhdXNlIGl0J3MgYSBmb3JiaWRkZW4gY2hhcmFjdGVyXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwvJC8sICcnKSAvLyByZXBsYWNlIHRyYWlsaW5nIHNsYXNoXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwvW15cXC9dKiQvLCAnJyk7IC8vIHJlbW92ZSBldmVyeXRoaW5nIGFmdGVyIHRoZSBsYXN0XG5cbiAgICAgICAgLy8gRmlsZSByZXF1ZXN0IGlzIHJlbGF0aXZlLCB1c2UgY3VycmVudCBkaXJlY3RvcnlcbiAgICAgICAgaWYgKGRpciA9PT0gdXJsKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gJy4nO1xuICAgICAgICB9XG4gICAgICAgIC8vIFN0YXJ0ZWQgd2l0aCBhIHNsYXNoXG4gICAgICAgIGVsc2UgaWYgKGRpciA9PT0gJycpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAnLyc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGlyO1xuICAgIH1cbn1cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBGaWx0ZXIsIGRlZmF1bHRWZXJ0ZXggfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCBmcmFnbWVudCBmcm9tICcuL2FscGhhLmZyYWcnO1xuXG4vKipcbiAqIFNpbXBsZXN0IGZpbHRlciAtIGFwcGxpZXMgYWxwaGEuXG4gKlxuICogVXNlIHRoaXMgaW5zdGVhZCBvZiBDb250YWluZXIncyBhbHBoYSBwcm9wZXJ0eSB0byBhdm9pZCB2aXN1YWwgbGF5ZXJpbmcgb2YgaW5kaXZpZHVhbCBlbGVtZW50cy5cbiAqIEFscGhhRmlsdGVyIGFwcGxpZXMgYWxwaGEgZXZlbmx5IGFjcm9zcyB0aGUgZW50aXJlIGRpc3BsYXkgb2JqZWN0IGFuZCBhbnkgb3BhcXVlIGVsZW1lbnRzIGl0IGNvbnRhaW5zLlxuICogSWYgZWxlbWVudHMgYXJlIG5vdCBvcGFxdWUsIHRoZXkgd2lsbCBibGVuZCB3aXRoIGVhY2ggb3RoZXIgYW55d2F5LlxuICpcbiAqIFZlcnkgaGFuZHkgaWYgeW91IHdhbnQgdG8gdXNlIGNvbW1vbiBmZWF0dXJlcyBvZiBhbGwgZmlsdGVyczpcbiAqXG4gKiAxLiBBc3NpZ24gYSBibGVuZE1vZGUgdG8gdGhpcyBmaWx0ZXIsIGJsZW5kIGFsbCBlbGVtZW50cyBpbnNpZGUgZGlzcGxheSBvYmplY3Qgd2l0aCBiYWNrZ3JvdW5kLlxuICpcbiAqIDIuIFRvIHVzZSBjbGlwcGluZyBpbiBkaXNwbGF5IGNvb3JkaW5hdGVzLCBhc3NpZ24gYSBmaWx0ZXJBcmVhIHRvIHRoZSBzYW1lIGNvbnRhaW5lciB0aGF0IGhhcyB0aGlzIGZpbHRlci5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuRmlsdGVyXG4gKiBAbWVtYmVyb2YgUElYSS5maWx0ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBBbHBoYUZpbHRlciBleHRlbmRzIEZpbHRlclxue1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYWxwaGE9MV0gLSBBbW91bnQgb2YgYWxwaGEgZnJvbSAwIHRvIDEsIHdoZXJlIDAgaXMgdHJhbnNwYXJlbnRcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhbHBoYSA9IDEuMClcbiAgICB7XG4gICAgICAgIHN1cGVyKGRlZmF1bHRWZXJ0ZXgsIGZyYWdtZW50LCB7IHVBbHBoYTogMSB9KTtcblxuICAgICAgICB0aGlzLmFscGhhID0gYWxwaGE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29lZmZpY2llbnQgZm9yIGFscGhhIG11bHRpcGxpY2F0aW9uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMVxuICAgICAqL1xuICAgIGdldCBhbHBoYSgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaWZvcm1zLnVBbHBoYTtcbiAgICB9XG5cbiAgICBzZXQgYWxwaGEodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudW5pZm9ybXMudUFscGhhID0gdmFsdWU7XG4gICAgfVxufVxuIiwgIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwgImNvbnN0IHZlcnRUZW1wbGF0ZSA9IGBcbiAgICBhdHRyaWJ1dGUgdmVjMiBhVmVydGV4UG9zaXRpb247XG5cbiAgICB1bmlmb3JtIG1hdDMgcHJvamVjdGlvbk1hdHJpeDtcblxuICAgIHVuaWZvcm0gZmxvYXQgc3RyZW5ndGg7XG5cbiAgICB2YXJ5aW5nIHZlYzIgdkJsdXJUZXhDb29yZHNbJXNpemUlXTtcblxuICAgIHVuaWZvcm0gdmVjNCBpbnB1dFNpemU7XG4gICAgdW5pZm9ybSB2ZWM0IG91dHB1dEZyYW1lO1xuXG4gICAgdmVjNCBmaWx0ZXJWZXJ0ZXhQb3NpdGlvbiggdm9pZCApXG4gICAge1xuICAgICAgICB2ZWMyIHBvc2l0aW9uID0gYVZlcnRleFBvc2l0aW9uICogbWF4KG91dHB1dEZyYW1lLnp3LCB2ZWMyKDAuKSkgKyBvdXRwdXRGcmFtZS54eTtcblxuICAgICAgICByZXR1cm4gdmVjNCgocHJvamVjdGlvbk1hdHJpeCAqIHZlYzMocG9zaXRpb24sIDEuMCkpLnh5LCAwLjAsIDEuMCk7XG4gICAgfVxuXG4gICAgdmVjMiBmaWx0ZXJUZXh0dXJlQ29vcmQoIHZvaWQgKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGFWZXJ0ZXhQb3NpdGlvbiAqIChvdXRwdXRGcmFtZS56dyAqIGlucHV0U2l6ZS56dyk7XG4gICAgfVxuXG4gICAgdm9pZCBtYWluKHZvaWQpXG4gICAge1xuICAgICAgICBnbF9Qb3NpdGlvbiA9IGZpbHRlclZlcnRleFBvc2l0aW9uKCk7XG5cbiAgICAgICAgdmVjMiB0ZXh0dXJlQ29vcmQgPSBmaWx0ZXJUZXh0dXJlQ29vcmQoKTtcbiAgICAgICAgJWJsdXIlXG4gICAgfWA7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUJsdXJWZXJ0U291cmNlKGtlcm5lbFNpemU6IG51bWJlciwgeDogYm9vbGVhbik6IHN0cmluZ1xue1xuICAgIGNvbnN0IGhhbGZMZW5ndGggPSBNYXRoLmNlaWwoa2VybmVsU2l6ZSAvIDIpO1xuXG4gICAgbGV0IHZlcnRTb3VyY2UgPSB2ZXJ0VGVtcGxhdGU7XG5cbiAgICBsZXQgYmx1ckxvb3AgPSAnJztcbiAgICBsZXQgdGVtcGxhdGU7XG5cbiAgICBpZiAoeClcbiAgICB7XG4gICAgICAgIHRlbXBsYXRlID0gJ3ZCbHVyVGV4Q29vcmRzWyVpbmRleCVdID0gIHRleHR1cmVDb29yZCArIHZlYzIoJXNhbXBsZUluZGV4JSAqIHN0cmVuZ3RoLCAwLjApOyc7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIHRlbXBsYXRlID0gJ3ZCbHVyVGV4Q29vcmRzWyVpbmRleCVdID0gIHRleHR1cmVDb29yZCArIHZlYzIoMC4wLCAlc2FtcGxlSW5kZXglICogc3RyZW5ndGgpOyc7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXJuZWxTaXplOyBpKyspXG4gICAge1xuICAgICAgICBsZXQgYmx1ciA9IHRlbXBsYXRlLnJlcGxhY2UoJyVpbmRleCUnLCBpLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGJsdXIgPSBibHVyLnJlcGxhY2UoJyVzYW1wbGVJbmRleCUnLCBgJHtpIC0gKGhhbGZMZW5ndGggLSAxKX0uMGApO1xuXG4gICAgICAgIGJsdXJMb29wICs9IGJsdXI7XG4gICAgICAgIGJsdXJMb29wICs9ICdcXG4nO1xuICAgIH1cblxuICAgIHZlcnRTb3VyY2UgPSB2ZXJ0U291cmNlLnJlcGxhY2UoJyVibHVyJScsIGJsdXJMb29wKTtcbiAgICB2ZXJ0U291cmNlID0gdmVydFNvdXJjZS5yZXBsYWNlKCclc2l6ZSUnLCBrZXJuZWxTaXplLnRvU3RyaW5nKCkpO1xuXG4gICAgcmV0dXJuIHZlcnRTb3VyY2U7XG59XG4iLCAiaW50ZXJmYWNlIElHQVVTU0lBTl9WQUxVRVMge1xuICAgIFt4OiBudW1iZXJdOiBudW1iZXJbXTtcbn1cbmNvbnN0IEdBVVNTSUFOX1ZBTFVFUzogSUdBVVNTSUFOX1ZBTFVFUyA9IHtcbiAgICA1OiBbMC4xNTMzODgsIDAuMjIxNDYxLCAwLjI1MDMwMV0sXG4gICAgNzogWzAuMDcxMzAzLCAwLjEzMTUxNCwgMC4xODk4NzksIDAuMjE0NjA3XSxcbiAgICA5OiBbMC4wMjg1MzIsIDAuMDY3MjM0LCAwLjEyNDAwOSwgMC4xNzkwNDQsIDAuMjAyMzZdLFxuICAgIDExOiBbMC4wMDkzLCAwLjAyODAwMiwgMC4wNjU5ODQsIDAuMTIxNzAzLCAwLjE3NTcxMywgMC4xOTg1OTZdLFxuICAgIDEzOiBbMC4wMDI0MDYsIDAuMDA5MjU1LCAwLjAyNzg2NywgMC4wNjU2NjYsIDAuMTIxMTE3LCAwLjE3NDg2OCwgMC4xOTc2NDFdLFxuICAgIDE1OiBbMC4wMDA0ODksIDAuMDAyNDAzLCAwLjAwOTI0NiwgMC4wMjc4NCwgMC4wNjU2MDIsIDAuMTIwOTk5LCAwLjE3NDY5NywgMC4xOTc0NDhdLFxufTtcblxuY29uc3QgZnJhZ1RlbXBsYXRlID0gW1xuICAgICd2YXJ5aW5nIHZlYzIgdkJsdXJUZXhDb29yZHNbJXNpemUlXTsnLFxuICAgICd1bmlmb3JtIHNhbXBsZXIyRCB1U2FtcGxlcjsnLFxuXG4gICAgJ3ZvaWQgbWFpbih2b2lkKScsXG4gICAgJ3snLFxuICAgICcgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCgwLjApOycsXG4gICAgJyAgICAlYmx1ciUnLFxuICAgICd9JyxcblxuXS5qb2luKCdcXG4nKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlQmx1ckZyYWdTb3VyY2Uoa2VybmVsU2l6ZTogbnVtYmVyKTogc3RyaW5nXG57XG4gICAgY29uc3Qga2VybmVsID0gR0FVU1NJQU5fVkFMVUVTW2tlcm5lbFNpemVdO1xuICAgIGNvbnN0IGhhbGZMZW5ndGggPSBrZXJuZWwubGVuZ3RoO1xuXG4gICAgbGV0IGZyYWdTb3VyY2UgPSBmcmFnVGVtcGxhdGU7XG5cbiAgICBsZXQgYmx1ckxvb3AgPSAnJztcbiAgICBjb25zdCB0ZW1wbGF0ZSA9ICdnbF9GcmFnQ29sb3IgKz0gdGV4dHVyZTJEKHVTYW1wbGVyLCB2Qmx1clRleENvb3Jkc1slaW5kZXglXSkgKiAldmFsdWUlOyc7XG4gICAgbGV0IHZhbHVlOiBudW1iZXI7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtlcm5lbFNpemU7IGkrKylcbiAgICB7XG4gICAgICAgIGxldCBibHVyID0gdGVtcGxhdGUucmVwbGFjZSgnJWluZGV4JScsIGkudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgdmFsdWUgPSBpO1xuXG4gICAgICAgIGlmIChpID49IGhhbGZMZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlID0ga2VybmVsU2l6ZSAtIGkgLSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgYmx1ciA9IGJsdXIucmVwbGFjZSgnJXZhbHVlJScsIGtlcm5lbFt2YWx1ZV0udG9TdHJpbmcoKSk7XG5cbiAgICAgICAgYmx1ckxvb3AgKz0gYmx1cjtcbiAgICAgICAgYmx1ckxvb3AgKz0gJ1xcbic7XG4gICAgfVxuXG4gICAgZnJhZ1NvdXJjZSA9IGZyYWdTb3VyY2UucmVwbGFjZSgnJWJsdXIlJywgYmx1ckxvb3ApO1xuICAgIGZyYWdTb3VyY2UgPSBmcmFnU291cmNlLnJlcGxhY2UoJyVzaXplJScsIGtlcm5lbFNpemUudG9TdHJpbmcoKSk7XG5cbiAgICByZXR1cm4gZnJhZ1NvdXJjZTtcbn1cbiIsICIvKipcbiAqIERpZmZlcmVudCB0eXBlcyBvZiBlbnZpcm9ubWVudHMgZm9yIFdlYkdMLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAbmFtZSBFTlZcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gV0VCR0xfTEVHQUNZIC0gVXNlZCBmb3Igb2xkZXIgdjEgV2ViR0wgZGV2aWNlcy4gUGl4aUpTIHdpbGwgYWltIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5XG4gKiAgd2l0aCBvbGRlciAvIGxlc3MgYWR2YW5jZWQgZGV2aWNlcy4gSWYgeW91IGV4cGVyaWVuY2UgdW5leHBsYWluZWQgZmxpY2tlcmluZyBwcmVmZXIgdGhpcyBlbnZpcm9ubWVudC5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBXRUJHTCAtIFZlcnNpb24gMSBvZiBXZWJHTFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFdFQkdMMiAtIFZlcnNpb24gMiBvZiBXZWJHTFxuICovXG5leHBvcnQgZW51bSBFTlYge1xuICAgIFdFQkdMX0xFR0FDWSxcbiAgICBXRUJHTCxcbiAgICBXRUJHTDIsXG59XG5cbi8qKlxuICogQ29uc3RhbnQgdG8gaWRlbnRpZnkgdGhlIFJlbmRlcmVyIFR5cGUuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBuYW1lIFJFTkRFUkVSX1RZUEVcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5LTk9XTiAtIFVua25vd24gcmVuZGVyIHR5cGUuXG4gKiBAcHJvcGVydHkge251bWJlcn0gV0VCR0wgLSBXZWJHTCByZW5kZXIgdHlwZS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBDQU5WQVMgLSBDYW52YXMgcmVuZGVyIHR5cGUuXG4gKi9cbmV4cG9ydCBlbnVtIFJFTkRFUkVSX1RZUEUge1xuICAgIFVOS05PV04sXG4gICAgV0VCR0wsXG4gICAgQ0FOVkFTLFxufVxuXG4vKipcbiAqIEJpdHdpc2UgT1Igb2YgbWFza3MgdGhhdCBpbmRpY2F0ZSB0aGUgYnVmZmVycyB0byBiZSBjbGVhcmVkLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAbmFtZSBCVUZGRVJfQklUU1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBDT0xPUiAtIEluZGljYXRlcyB0aGUgYnVmZmVycyBjdXJyZW50bHkgZW5hYmxlZCBmb3IgY29sb3Igd3JpdGluZy5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBERVBUSCAtIEluZGljYXRlcyB0aGUgZGVwdGggYnVmZmVyLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNURU5DSUwgLSBJbmRpY2F0ZXMgdGhlIHN0ZW5jaWwgYnVmZmVyLlxuICovXG5leHBvcnQgZW51bSBCVUZGRVJfQklUUyB7XG4gICAgQ09MT1IgPSAweDAwMDA0MDAwLFxuICAgIERFUFRIID0gMHgwMDAwMDEwMCxcbiAgICBTVEVOQ0lMID0gMHgwMDAwMDQwMFxufVxuXG4vKipcbiAqIFZhcmlvdXMgYmxlbmQgbW9kZXMgc3VwcG9ydGVkIGJ5IFBJWEkuXG4gKlxuICogSU1QT1JUQU5UIC0gVGhlIFdlYkdMIHJlbmRlcmVyIG9ubHkgc3VwcG9ydHMgdGhlIE5PUk1BTCwgQURELCBNVUxUSVBMWSBhbmQgU0NSRUVOIGJsZW5kIG1vZGVzLlxuICogQW55dGhpbmcgZWxzZSB3aWxsIHNpbGVudGx5IGFjdCBsaWtlIE5PUk1BTC5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQG5hbWUgQkxFTkRfTU9ERVNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gTk9STUFMXG4gKiBAcHJvcGVydHkge251bWJlcn0gQUREXG4gKiBAcHJvcGVydHkge251bWJlcn0gTVVMVElQTFlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTQ1JFRU5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBPVkVSTEFZXG4gKiBAcHJvcGVydHkge251bWJlcn0gREFSS0VOXG4gKiBAcHJvcGVydHkge251bWJlcn0gTElHSFRFTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IENPTE9SX0RPREdFXG4gKiBAcHJvcGVydHkge251bWJlcn0gQ09MT1JfQlVSTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IEhBUkRfTElHSFRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTT0ZUX0xJR0hUXG4gKiBAcHJvcGVydHkge251bWJlcn0gRElGRkVSRU5DRVxuICogQHByb3BlcnR5IHtudW1iZXJ9IEVYQ0xVU0lPTlxuICogQHByb3BlcnR5IHtudW1iZXJ9IEhVRVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNBVFVSQVRJT05cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBDT0xPUlxuICogQHByb3BlcnR5IHtudW1iZXJ9IExVTUlOT1NJVFlcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT1JNQUxfTlBNXG4gKiBAcHJvcGVydHkge251bWJlcn0gQUREX05QTVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNDUkVFTl9OUE1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT05FXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1JDX0lOXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1JDX09VVFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNSQ19BVE9QXG4gKiBAcHJvcGVydHkge251bWJlcn0gRFNUX09WRVJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEU1RfSU5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEU1RfT1VUXG4gKiBAcHJvcGVydHkge251bWJlcn0gRFNUX0FUT1BcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBTVUJUUkFDVFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNSQ19PVkVSXG4gKiBAcHJvcGVydHkge251bWJlcn0gRVJBU0VcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBYT1JcbiAqL1xuZXhwb3J0IGVudW0gQkxFTkRfTU9ERVMge1xuICAgIE5PUk1BTCA9IDAsXG4gICAgQUREID0gMSxcbiAgICBNVUxUSVBMWSA9IDIsXG4gICAgU0NSRUVOID0gMyxcbiAgICBPVkVSTEFZID0gNCxcbiAgICBEQVJLRU4gPSA1LFxuICAgIExJR0hURU4gPSA2LFxuICAgIENPTE9SX0RPREdFID0gNyxcbiAgICBDT0xPUl9CVVJOID0gOCxcbiAgICBIQVJEX0xJR0hUID0gOSxcbiAgICBTT0ZUX0xJR0hUID0gMTAsXG4gICAgRElGRkVSRU5DRSA9IDExLFxuICAgIEVYQ0xVU0lPTiA9IDEyLFxuICAgIEhVRSA9IDEzLFxuICAgIFNBVFVSQVRJT04gPSAxNCxcbiAgICBDT0xPUiA9IDE1LFxuICAgIExVTUlOT1NJVFkgPSAxNixcbiAgICBOT1JNQUxfTlBNID0gMTcsXG4gICAgQUREX05QTSA9IDE4LFxuICAgIFNDUkVFTl9OUE0gPSAxOSxcbiAgICBOT05FID0gMjAsXG5cbiAgICBTUkNfT1ZFUiA9IDAsXG4gICAgU1JDX0lOID0gMjEsXG4gICAgU1JDX09VVCA9IDIyLFxuICAgIFNSQ19BVE9QID0gMjMsXG4gICAgRFNUX09WRVIgPSAyNCxcbiAgICBEU1RfSU4gPSAyNSxcbiAgICBEU1RfT1VUID0gMjYsXG4gICAgRFNUX0FUT1AgPSAyNyxcbiAgICBFUkFTRSA9IDI2LFxuICAgIFNVQlRSQUNUID0gMjgsXG4gICAgWE9SID0gMjksXG59XG5cbi8qKlxuICogVmFyaW91cyB3ZWJnbCBkcmF3IG1vZGVzLiBUaGVzZSBjYW4gYmUgdXNlZCB0byBzcGVjaWZ5IHdoaWNoIEdMIGRyYXdNb2RlIHRvIHVzZVxuICogdW5kZXIgY2VydGFpbiBzaXR1YXRpb25zIGFuZCByZW5kZXJlcnMuXG4gKlxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBuYW1lIERSQVdfTU9ERVNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gUE9JTlRTXG4gKiBAcHJvcGVydHkge251bWJlcn0gTElORVNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMSU5FX0xPT1BcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMSU5FX1NUUklQXG4gKiBAcHJvcGVydHkge251bWJlcn0gVFJJQU5HTEVTXG4gKiBAcHJvcGVydHkge251bWJlcn0gVFJJQU5HTEVfU1RSSVBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBUUklBTkdMRV9GQU5cbiAqL1xuZXhwb3J0IGVudW0gRFJBV19NT0RFUyB7XG4gICAgUE9JTlRTLFxuICAgIExJTkVTLFxuICAgIExJTkVfTE9PUCxcbiAgICBMSU5FX1NUUklQLFxuICAgIFRSSUFOR0xFUyxcbiAgICBUUklBTkdMRV9TVFJJUCxcbiAgICBUUklBTkdMRV9GQU4sXG59XG5cbi8qKlxuICogVmFyaW91cyBHTCB0ZXh0dXJlL3Jlc291cmNlcyBmb3JtYXRzLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBGT1JNQVRTXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFJHQkE9NjQwOFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFJHQj02NDA3XG4gKiBAcHJvcGVydHkge251bWJlcn0gQUxQSEE9NjQwNlxuICogQHByb3BlcnR5IHtudW1iZXJ9IExVTUlOQU5DRT02NDA5XG4gKiBAcHJvcGVydHkge251bWJlcn0gTFVNSU5BTkNFX0FMUEhBPTY0MTBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBERVBUSF9DT01QT05FTlQ9NjQwMlxuICogQHByb3BlcnR5IHtudW1iZXJ9IERFUFRIX1NURU5DSUw9MzQwNDFcbiAqL1xuZXhwb3J0IGVudW0gRk9STUFUUyB7XG4gICAgUkdCQSA9IDY0MDgsXG4gICAgUkdCID0gNjQwNyxcbiAgICBBTFBIQSA9IDY0MDYsXG4gICAgTFVNSU5BTkNFID0gNjQwOSxcbiAgICBMVU1JTkFOQ0VfQUxQSEEgPSA2NDEwLFxuICAgIERFUFRIX0NPTVBPTkVOVCA9IDY0MDIsXG4gICAgREVQVEhfU1RFTkNJTCA9IDM0MDQxLFxufVxuXG4vKipcbiAqIFZhcmlvdXMgR0wgdGFyZ2V0IHR5cGVzLlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBUQVJHRVRTXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFRFWFRVUkVfMkQ9MzU1M1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFRFWFRVUkVfQ1VCRV9NQVA9MzQwNjdcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBURVhUVVJFXzJEX0FSUkFZPTM1ODY2XG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YPTM0MDY5XG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9YPTM0MDcwXG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9ZPTM0MDcxXG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9ZPTM0MDcyXG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9aPTM0MDczXG4gKiBAcHJvcGVydHkge251bWJlcn0gVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9aPTM0MDc0XG4gKi9cbmV4cG9ydCBlbnVtIFRBUkdFVFMge1xuICAgIFRFWFRVUkVfMkQgPSAzNTUzLFxuICAgIFRFWFRVUkVfQ1VCRV9NQVAgPSAzNDA2NyxcbiAgICBURVhUVVJFXzJEX0FSUkFZID0gMzU4NjYsXG4gICAgVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YID0gMzQwNjksXG4gICAgVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9YID0gMzQwNzAsXG4gICAgVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9ZID0gMzQwNzEsXG4gICAgVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9ZID0gMzQwNzIsXG4gICAgVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9aID0gMzQwNzMsXG4gICAgVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9aID0gMzQwNzQsXG59XG5cbi8qKlxuICogVmFyaW91cyBHTCBkYXRhIGZvcm1hdCB0eXBlcy5cbiAqXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQG5hbWUgVFlQRVNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5TSUdORURfQllURT01MTIxXG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5TSUdORURfU0hPUlQ9NTEyM1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFVOU0lHTkVEX1NIT1JUXzVfNl81PTMzNjM1XG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5TSUdORURfU0hPUlRfNF80XzRfND0zMjgxOVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFVOU0lHTkVEX1NIT1JUXzVfNV81XzE9MzI4MjBcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBGTE9BVD01MTI2XG4gKiBAcHJvcGVydHkge251bWJlcn0gSEFMRl9GTE9BVD0zNjE5M1xuICovXG5leHBvcnQgZW51bSBUWVBFUyB7XG4gICAgVU5TSUdORURfQllURSA9IDUxMjEsXG4gICAgVU5TSUdORURfU0hPUlQgPSA1MTIzLFxuICAgIFVOU0lHTkVEX1NIT1JUXzVfNl81ID0gMzM2MzUsXG4gICAgVU5TSUdORURfU0hPUlRfNF80XzRfNCA9IDMyODE5LFxuICAgIFVOU0lHTkVEX1NIT1JUXzVfNV81XzEgPSAzMjgyMCxcbiAgICBGTE9BVCA9IDUxMjYsXG4gICAgSEFMRl9GTE9BVCA9IDM2MTkzLFxufVxuXG4vKipcbiAqIFRoZSBzY2FsZSBtb2RlcyB0aGF0IGFyZSBzdXBwb3J0ZWQgYnkgcGl4aS5cbiAqXG4gKiBUaGUge0BsaW5rIFBJWEkuc2V0dGluZ3MuU0NBTEVfTU9ERX0gc2NhbGUgbW9kZSBhZmZlY3RzIHRoZSBkZWZhdWx0IHNjYWxpbmcgbW9kZSBvZiBmdXR1cmUgb3BlcmF0aW9ucy5cbiAqIEl0IGNhbiBiZSByZS1hc3NpZ25lZCB0byBlaXRoZXIgTElORUFSIG9yIE5FQVJFU1QsIGRlcGVuZGluZyB1cG9uIHN1aXRhYmlsaXR5LlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAbmFtZSBTQ0FMRV9NT0RFU1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBMSU5FQVIgU21vb3RoIHNjYWxpbmdcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBORUFSRVNUIFBpeGVsYXRpbmcgc2NhbGluZ1xuICovXG5leHBvcnQgZW51bSBTQ0FMRV9NT0RFUyB7XG4gICAgTkVBUkVTVCxcbiAgICBMSU5FQVIsXG59XG5cbi8qKlxuICogVGhlIHdyYXAgbW9kZXMgdGhhdCBhcmUgc3VwcG9ydGVkIGJ5IHBpeGkuXG4gKlxuICogVGhlIHtAbGluayBQSVhJLnNldHRpbmdzLldSQVBfTU9ERX0gd3JhcCBtb2RlIGFmZmVjdHMgdGhlIGRlZmF1bHQgd3JhcHBpbmcgbW9kZSBvZiBmdXR1cmUgb3BlcmF0aW9ucy5cbiAqIEl0IGNhbiBiZSByZS1hc3NpZ25lZCB0byBlaXRoZXIgQ0xBTVAgb3IgUkVQRUFULCBkZXBlbmRpbmcgdXBvbiBzdWl0YWJpbGl0eS5cbiAqIElmIHRoZSB0ZXh0dXJlIGlzIG5vbiBwb3dlciBvZiB0d28gdGhlbiBjbGFtcCB3aWxsIGJlIHVzZWQgcmVnYXJkbGVzcyBhcyBXZWJHTCBjYW5cbiAqIG9ubHkgdXNlIFJFUEVBVCBpZiB0aGUgdGV4dHVyZSBpcyBwbzIuXG4gKlxuICogVGhpcyBwcm9wZXJ0eSBvbmx5IGFmZmVjdHMgV2ViR0wuXG4gKlxuICogQG5hbWUgV1JBUF9NT0RFU1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gQ0xBTVAgLSBUaGUgdGV4dHVyZXMgdXZzIGFyZSBjbGFtcGVkXG4gKiBAcHJvcGVydHkge251bWJlcn0gUkVQRUFUIC0gVGhlIHRleHR1cmUgdXZzIHRpbGUgYW5kIHJlcGVhdFxuICogQHByb3BlcnR5IHtudW1iZXJ9IE1JUlJPUkVEX1JFUEVBVCAtIFRoZSB0ZXh0dXJlIHV2cyB0aWxlIGFuZCByZXBlYXQgd2l0aCBtaXJyb3JpbmdcbiAqL1xuZXhwb3J0IGVudW0gV1JBUF9NT0RFUyB7XG4gICAgQ0xBTVAgPSAzMzA3MSxcbiAgICBSRVBFQVQgPSAxMDQ5NyxcbiAgICBNSVJST1JFRF9SRVBFQVQgPSAzMzY0OCxcbn1cblxuLyoqXG4gKiBNaXBtYXAgZmlsdGVyaW5nIG1vZGVzIHRoYXQgYXJlIHN1cHBvcnRlZCBieSBwaXhpLlxuICpcbiAqIFRoZSB7QGxpbmsgUElYSS5zZXR0aW5ncy5NSVBNQVBfVEVYVFVSRVN9IGFmZmVjdHMgZGVmYXVsdCB0ZXh0dXJlIGZpbHRlcmluZy5cbiAqIE1pcG1hcHMgYXJlIGdlbmVyYXRlZCBmb3IgYSBiYXNlVGV4dHVyZSBpZiBpdHMgYG1pcG1hcGAgZmllbGQgaXMgYE9OYCxcbiAqIG9yIGl0cyBgUE9XMmAgYW5kIHRleHR1cmUgZGltZW5zaW9ucyBhcmUgcG93ZXJzIG9mIDIuXG4gKiBEdWUgdG8gcGxhdGZvcm0gcmVzdHJpY3Rpb24sIGBPTmAgb3B0aW9uIHdpbGwgd29yayBsaWtlIGBQT1cyYCBmb3Igd2ViZ2wtMS5cbiAqXG4gKiBUaGlzIHByb3BlcnR5IG9ubHkgYWZmZWN0cyBXZWJHTC5cbiAqXG4gKiBAbmFtZSBNSVBNQVBfTU9ERVNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IE9GRiAtIE5vIG1pcG1hcHNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBQT1cyIC0gR2VuZXJhdGUgbWlwbWFwcyBpZiB0ZXh0dXJlIGRpbWVuc2lvbnMgYXJlIHBvdzJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBPTiAtIEFsd2F5cyBnZW5lcmF0ZSBtaXBtYXBzXG4gKi9cbmV4cG9ydCBlbnVtIE1JUE1BUF9NT0RFUyB7XG4gICAgT0ZGLFxuICAgIFBPVzIsXG4gICAgT04sXG59XG5cbi8qKlxuICogSG93IHRvIHRyZWF0IHRleHR1cmVzIHdpdGggcHJlbXVsdGlwbGllZCBhbHBoYVxuICpcbiAqIEBuYW1lIEFMUEhBX01PREVTXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQHN0YXRpY1xuICogQGVudW0ge251bWJlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT19QUkVNVUxUSVBMSUVEX0FMUEhBIC0gU291cmNlIGlzIG5vdCBwcmVtdWx0aXBsaWVkLCBsZWF2ZSBpdCBsaWtlIHRoYXQuXG4gKiAgT3B0aW9uIGZvciBjb21wcmVzc2VkIGFuZCBkYXRhIHRleHR1cmVzIHRoYXQgYXJlIGNyZWF0ZWQgZnJvbSB0eXBlZCBhcnJheXMuXG4gKiBAcHJvcGVydHkge251bWJlcn0gUFJFTVVMVElQTFlfT05fVVBMT0FEIC0gU291cmNlIGlzIG5vdCBwcmVtdWx0aXBsaWVkLCBwcmVtdWx0aXBseSBvbiB1cGxvYWQuXG4gKiAgRGVmYXVsdCBvcHRpb24sIHVzZWQgZm9yIGFsbCBsb2FkZWQgaW1hZ2VzLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IFBSRU1VTFRJUExJRURfQUxQSEEgLSBTb3VyY2UgaXMgYWxyZWFkeSBwcmVtdWx0aXBsaWVkXG4gKiAgRXhhbXBsZTogc3BpbmUgYXRsYXNlcyB3aXRoIGBfcG1hYCBzdWZmaXguXG4gKiBAcHJvcGVydHkge251bWJlcn0gTlBNIC0gQWxpYXMgZm9yIE5PX1BSRU1VTFRJUExJRURfQUxQSEEuXG4gKiBAcHJvcGVydHkge251bWJlcn0gVU5QQUNLIC0gRGVmYXVsdCBvcHRpb24sIGFsaWFzIGZvciBQUkVNVUxUSVBMWV9PTl9VUExPQUQuXG4gKiBAcHJvcGVydHkge251bWJlcn0gUE1BIC0gQWxpYXMgZm9yIFBSRU1VTFRJUExJRURfQUxQSEEuXG4gKi9cbmV4cG9ydCBlbnVtIEFMUEhBX01PREVTIHtcbiAgICBOUE0gPSAwLFxuICAgIFVOUEFDSyA9IDEsXG4gICAgUE1BID0gMixcbiAgICBOT19QUkVNVUxUSVBMSUVEX0FMUEhBID0gMCxcbiAgICBQUkVNVUxUSVBMWV9PTl9VUExPQUQgPSAxLFxuICAgIFBSRU1VTFRJUExZX0FMUEhBID0gMixcbn1cblxuLyoqXG4gKiBIb3cgdG8gY2xlYXIgcmVuZGVyVGV4dHVyZXMgaW4gZmlsdGVyXG4gKlxuICogQG5hbWUgQ0xFQVJfTU9ERVNcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAc3RhdGljXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IEJMRU5EIC0gUHJlc2VydmUgdGhlIGluZm9ybWF0aW9uIGluIHRoZSB0ZXh0dXJlLCBibGVuZCBhYm92ZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IENMRUFSIC0gTXVzdCB1c2UgYGdsLmNsZWFyYCBvcGVyYXRpb25cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBCTElUIC0gQ2xlYXIgb3IgYmxpdCBpdCwgZGVwZW5kcyBvbiBkZXZpY2UgYW5kIGxldmVsIG9mIHBhcmFub2lhXG4gKiBAcHJvcGVydHkge251bWJlcn0gTk8gLSBBbGlhcyBmb3IgQkxFTkQsIHNhbWUgYXMgYGZhbHNlYCBpbiBlYXJsaWVyIHZlcnNpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gWUVTIC0gQWxpYXMgZm9yIENMRUFSLCBzYW1lIGFzIGB0cnVlYCBpbiBlYXJsaWVyIHZlcnNpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gQVVUTyAtIEFsaWFzIGZvciBCTElUXG4gKi9cbmV4cG9ydCBlbnVtIENMRUFSX01PREVTIHtcbiAgICBOTyA9IDAsXG4gICAgWUVTID0gMSxcbiAgICBBVVRPID0gMixcbiAgICBCTEVORCA9IDAsXG4gICAgQ0xFQVIgPSAxLFxuICAgIEJMSVQgPSAyLFxufVxuXG4vKipcbiAqIFRoZSBnYyBtb2RlcyB0aGF0IGFyZSBzdXBwb3J0ZWQgYnkgcGl4aS5cbiAqXG4gKiBUaGUge0BsaW5rIFBJWEkuc2V0dGluZ3MuR0NfTU9ERX0gR2FyYmFnZSBDb2xsZWN0aW9uIG1vZGUgZm9yIFBpeGlKUyB0ZXh0dXJlcyBpcyBBVVRPXG4gKiBJZiBzZXQgdG8gR0NfTU9ERSwgdGhlIHJlbmRlcmVyIHdpbGwgb2NjYXNpb25hbGx5IGNoZWNrIHRleHR1cmVzIHVzYWdlLiBJZiB0aGV5IGFyZSBub3RcbiAqIHVzZWQgZm9yIGEgc3BlY2lmaWVkIHBlcmlvZCBvZiB0aW1lIHRoZXkgd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIEdQVS4gVGhleSB3aWxsIG9mIGNvdXJzZVxuICogYmUgdXBsb2FkZWQgYWdhaW4gd2hlbiB0aGV5IGFyZSByZXF1aXJlZC4gVGhpcyBpcyBhIHNpbGVudCBiZWhpbmQgdGhlIHNjZW5lcyBwcm9jZXNzIHRoYXRcbiAqIHNob3VsZCBlbnN1cmUgdGhhdCB0aGUgR1BVIGRvZXMgbm90ICBnZXQgZmlsbGVkIHVwLlxuICpcbiAqIEhhbmR5IGZvciBtb2JpbGUgZGV2aWNlcyFcbiAqIFRoaXMgcHJvcGVydHkgb25seSBhZmZlY3RzIFdlYkdMLlxuICpcbiAqIEBuYW1lIEdDX01PREVTXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHN0YXRpY1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBBVVRPIC0gR2FyYmFnZSBjb2xsZWN0aW9uIHdpbGwgaGFwcGVuIHBlcmlvZGljYWxseSBhdXRvbWF0aWNhbGx5XG4gKiBAcHJvcGVydHkge251bWJlcn0gTUFOVUFMIC0gR2FyYmFnZSBjb2xsZWN0aW9uIHdpbGwgbmVlZCB0byBiZSBjYWxsZWQgbWFudWFsbHlcbiAqL1xuZXhwb3J0IGVudW0gR0NfTU9ERVMge1xuICAgIEFVVE8sXG4gICAgTUFOVUFMLFxufVxuXG4vKipcbiAqIENvbnN0YW50cyB0aGF0IHNwZWNpZnkgZmxvYXQgcHJlY2lzaW9uIGluIHNoYWRlcnMuXG4gKlxuICogQG5hbWUgUFJFQ0lTSU9OXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGNvbnN0YW50XG4gKiBAc3RhdGljXG4gKiBAZW51bSB7c3RyaW5nfVxuICogQHByb3BlcnR5IHtzdHJpbmd9IExPVz0nbG93cCdcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBNRURJVU09J21lZGl1bXAnXG4gKiBAcHJvcGVydHkge3N0cmluZ30gSElHSD0naGlnaHAnXG4gKi9cbmV4cG9ydCBlbnVtIFBSRUNJU0lPTiB7XG4gICAgTE9XID0gJ2xvd3AnLFxuICAgIE1FRElVTSA9ICdtZWRpdW1wJyxcbiAgICBISUdIID0gJ2hpZ2hwJyxcbn1cblxuLyoqXG4gKiBDb25zdGFudHMgZm9yIG1hc2sgaW1wbGVtZW50YXRpb25zLlxuICogV2UgdXNlIGB0eXBlYCBzdWZmaXggYmVjYXVzZSBpdCBsZWFkcyB0byB2ZXJ5IGRpZmZlcmVudCBiZWhhdmlvdXJzXG4gKlxuICogQG5hbWUgTUFTS19UWVBFU1xuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gTk9ORSAtIE1hc2sgaXMgaWdub3JlZFxuICogQHByb3BlcnR5IHtudW1iZXJ9IFNDSVNTT1IgLSBTY2lzc29yIG1hc2ssIHJlY3RhbmdsZSBvbiBzY3JlZW4sIGNoZWFwXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1RFTkNJTCAtIFN0ZW5jaWwgbWFzaywgMS1iaXQsIG1lZGl1bSwgd29ya3Mgb25seSBpZiByZW5kZXJlciBzdXBwb3J0cyBzdGVuY2lsXG4gKiBAcHJvcGVydHkge251bWJlcn0gU1BSSVRFIC0gTWFzayB0aGF0IHVzZXMgU3ByaXRlTWFza0ZpbHRlciwgdXNlcyB0ZW1wb3JhcnkgUmVuZGVyVGV4dHVyZVxuICovXG5leHBvcnQgZW51bSBNQVNLX1RZUEVTIHtcbiAgICBOT05FID0gMCxcbiAgICBTQ0lTU09SID0gMSxcbiAgICBTVEVOQ0lMID0gMixcbiAgICBTUFJJVEUgPSAzLFxufVxuXG4vKipcbiAqIENvbnN0YW50cyBmb3IgbXVsdGktc2FtcGxpbmcgYW50aWFsaWFzaW5nLlxuICpcbiAqIEBzZWUgUElYSS5GcmFtZWJ1ZmZlciNtdWx0aXNhbXBsZVxuICpcbiAqIEBuYW1lIE1TQUFfUVVBTElUWVxuICogQG1lbWJlcm9mIFBJWElcbiAqIEBzdGF0aWNcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJvcGVydHkge251bWJlcn0gTk9ORSAtIE5vIG11bHRpc2FtcGxpbmcgZm9yIHRoaXMgcmVuZGVyVGV4dHVyZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IExPVyAtIFRyeSAyIHNhbXBsZXNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBNRURJVU0gLSBUcnkgNCBzYW1wbGVzXG4gKiBAcHJvcGVydHkge251bWJlcn0gSElHSCAtIFRyeSA4IHNhbXBsZXNcbiAqL1xuZXhwb3J0IGVudW0gTVNBQV9RVUFMSVRZIHtcbiAgICBOT05FID0gMCxcbiAgICBMT1cgPSAyLFxuICAgIE1FRElVTSA9IDQsXG4gICAgSElHSCA9IDhcbn1cbiIsICJpbXBvcnQgeyBGaWx0ZXIgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgZ2VuZXJhdGVCbHVyVmVydFNvdXJjZSB9IGZyb20gJy4vZ2VuZXJhdGVCbHVyVmVydFNvdXJjZSc7XG5pbXBvcnQgeyBnZW5lcmF0ZUJsdXJGcmFnU291cmNlIH0gZnJvbSAnLi9nZW5lcmF0ZUJsdXJGcmFnU291cmNlJztcbmltcG9ydCB7IENMRUFSX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuaW1wb3J0IHR5cGUgeyBSZW5kZXJUZXh0dXJlLCBzeXN0ZW1zIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5cbi8qKlxuICogVGhlIEJsdXJGaWx0ZXJQYXNzIGFwcGxpZXMgYSBob3Jpem9udGFsIG9yIHZlcnRpY2FsIEdhdXNzaWFuIGJsdXIgdG8gYW4gb2JqZWN0LlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5GaWx0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJLmZpbHRlcnNcbiAqL1xuZXhwb3J0IGNsYXNzIEJsdXJGaWx0ZXJQYXNzIGV4dGVuZHMgRmlsdGVyXG57XG4gICAgcHVibGljIGhvcml6b250YWw6IGJvb2xlYW47XG4gICAgcHVibGljIHN0cmVuZ3RoOiBudW1iZXI7XG4gICAgcHVibGljIHBhc3NlczogbnVtYmVyO1xuXG4gICAgcHJpdmF0ZSBfcXVhbGl0eTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBob3Jpem9udGFsIC0gRG8gcGFzcyBhbG9uZyB0aGUgeC1heGlzIChgdHJ1ZWApIG9yIHktYXhpcyAoYGZhbHNlYCkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdHJlbmd0aD04XSAtIFRoZSBzdHJlbmd0aCBvZiB0aGUgYmx1ciBmaWx0ZXIuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtxdWFsaXR5PTRdIC0gVGhlIHF1YWxpdHkgb2YgdGhlIGJsdXIgZmlsdGVyLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmVzb2x1dGlvbj1QSVhJLnNldHRpbmdzLkZJTFRFUl9SRVNPTFVUSU9OXSAtIFRoZSByZXNvbHV0aW9uIG9mIHRoZSBibHVyIGZpbHRlci5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2tlcm5lbFNpemU9NV0gLSBUaGUga2VybmVsU2l6ZSBvZiB0aGUgYmx1ciBmaWx0ZXIuT3B0aW9uczogNSwgNywgOSwgMTEsIDEzLCAxNS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihob3Jpem9udGFsOiBib29sZWFuLCBzdHJlbmd0aCA9IDgsIHF1YWxpdHkgPSA0LCByZXNvbHV0aW9uID0gc2V0dGluZ3MuRklMVEVSX1JFU09MVVRJT04sIGtlcm5lbFNpemUgPSA1KVxuICAgIHtcbiAgICAgICAgY29uc3QgdmVydFNyYyA9IGdlbmVyYXRlQmx1clZlcnRTb3VyY2Uoa2VybmVsU2l6ZSwgaG9yaXpvbnRhbCk7XG4gICAgICAgIGNvbnN0IGZyYWdTcmMgPSBnZW5lcmF0ZUJsdXJGcmFnU291cmNlKGtlcm5lbFNpemUpO1xuXG4gICAgICAgIHN1cGVyKFxuICAgICAgICAgICAgLy8gdmVydGV4IHNoYWRlclxuICAgICAgICAgICAgdmVydFNyYyxcbiAgICAgICAgICAgIC8vIGZyYWdtZW50IHNoYWRlclxuICAgICAgICAgICAgZnJhZ1NyY1xuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbCA9IGhvcml6b250YWw7XG5cbiAgICAgICAgdGhpcy5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjtcblxuICAgICAgICB0aGlzLl9xdWFsaXR5ID0gMDtcblxuICAgICAgICB0aGlzLnF1YWxpdHkgPSBxdWFsaXR5O1xuXG4gICAgICAgIHRoaXMuYmx1ciA9IHN0cmVuZ3RoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIGZpbHRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbX0gZmlsdGVyTWFuYWdlciAtIFRoZSBtYW5hZ2VyLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBpbnB1dCAtIFRoZSBpbnB1dCB0YXJnZXQuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlclRleHR1cmV9IG91dHB1dCAtIFRoZSBvdXRwdXQgdGFyZ2V0LlxuICAgICAqIEBwYXJhbSB7UElYSS5DTEVBUl9NT0RFU30gY2xlYXJNb2RlIC0gSG93IHRvIGNsZWFyXG4gICAgICovXG4gICAgcHVibGljIGFwcGx5KFxuICAgICAgICBmaWx0ZXJNYW5hZ2VyOiBzeXN0ZW1zLkZpbHRlclN5c3RlbSwgaW5wdXQ6IFJlbmRlclRleHR1cmUsIG91dHB1dDogUmVuZGVyVGV4dHVyZSwgY2xlYXJNb2RlOiBDTEVBUl9NT0RFU1xuICAgICk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmIChvdXRwdXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhvcml6b250YWwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5zdHJlbmd0aCA9ICgxIC8gb3V0cHV0LndpZHRoKSAqIChvdXRwdXQud2lkdGggLyBpbnB1dC53aWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5zdHJlbmd0aCA9ICgxIC8gb3V0cHV0LmhlaWdodCkgKiAob3V0cHV0LmhlaWdodCAvIGlucHV0LmhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5ob3Jpem9udGFsKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5zdHJlbmd0aCA9ICgxIC8gZmlsdGVyTWFuYWdlci5yZW5kZXJlci53aWR0aCkgKiAoZmlsdGVyTWFuYWdlci5yZW5kZXJlci53aWR0aCAvIGlucHV0LndpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuaWZvcm1zLnN0cmVuZ3RoID0gKDEgLyBmaWx0ZXJNYW5hZ2VyLnJlbmRlcmVyLmhlaWdodCkgKiAoZmlsdGVyTWFuYWdlci5yZW5kZXJlci5oZWlnaHQgLyBpbnB1dC5oZWlnaHQpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzY3JlZW4gc3BhY2UhXG4gICAgICAgIHRoaXMudW5pZm9ybXMuc3RyZW5ndGggKj0gdGhpcy5zdHJlbmd0aDtcbiAgICAgICAgdGhpcy51bmlmb3Jtcy5zdHJlbmd0aCAvPSB0aGlzLnBhc3NlcztcblxuICAgICAgICBpZiAodGhpcy5wYXNzZXMgPT09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZpbHRlck1hbmFnZXIuYXBwbHlGaWx0ZXIodGhpcywgaW5wdXQsIG91dHB1dCwgY2xlYXJNb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlclRhcmdldCA9IGZpbHRlck1hbmFnZXIuZ2V0RmlsdGVyVGV4dHVyZSgpO1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBmaWx0ZXJNYW5hZ2VyLnJlbmRlcmVyO1xuXG4gICAgICAgICAgICBsZXQgZmxpcCA9IGlucHV0O1xuICAgICAgICAgICAgbGV0IGZsb3AgPSByZW5kZXJUYXJnZXQ7XG5cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYmxlbmQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZpbHRlck1hbmFnZXIuYXBwbHlGaWx0ZXIodGhpcywgZmxpcCwgZmxvcCwgQ0xFQVJfTU9ERVMuQ0xFQVIpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRoaXMucGFzc2VzIC0gMTsgaSsrKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpbHRlck1hbmFnZXIuYmluZEFuZENsZWFyKGZsaXAsIENMRUFSX01PREVTLkJMSVQpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy51U2FtcGxlciA9IGZsb3A7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wID0gZmxvcDtcblxuICAgICAgICAgICAgICAgIGZsb3AgPSBmbGlwO1xuICAgICAgICAgICAgICAgIGZsaXAgPSB0ZW1wO1xuXG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuc2hhZGVyLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIuZ2VvbWV0cnkuZHJhdyg1KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ibGVuZCA9IHRydWU7XG4gICAgICAgICAgICBmaWx0ZXJNYW5hZ2VyLmFwcGx5RmlsdGVyKHRoaXMsIGZsb3AsIG91dHB1dCwgY2xlYXJNb2RlKTtcbiAgICAgICAgICAgIGZpbHRlck1hbmFnZXIucmV0dXJuRmlsdGVyVGV4dHVyZShyZW5kZXJUYXJnZXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHN0cmVuZ3RoIG9mIGJvdGggdGhlIGJsdXIuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMTZcbiAgICAgKi9cbiAgICBnZXQgYmx1cigpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmVuZ3RoO1xuICAgIH1cblxuICAgIHNldCBibHVyKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLnBhZGRpbmcgPSAxICsgKE1hdGguYWJzKHZhbHVlKSAqIDIpO1xuICAgICAgICB0aGlzLnN0cmVuZ3RoID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcXVhbGl0eSBvZiB0aGUgYmx1ciBieSBtb2RpZnlpbmcgdGhlIG51bWJlciBvZiBwYXNzZXMuIE1vcmUgcGFzc2VzIG1lYW5zIGhpZ2hlclxuICAgICAqIHF1YWlsaXR5IGJsdXJpbmcgYnV0IHRoZSBsb3dlciB0aGUgcGVyZm9ybWFuY2UuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgNFxuICAgICAqL1xuICAgIGdldCBxdWFsaXR5KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1YWxpdHk7XG4gICAgfVxuXG4gICAgc2V0IHF1YWxpdHkodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX3F1YWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5wYXNzZXMgPSB2YWx1ZTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgRmlsdGVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJ0BwaXhpL3NldHRpbmdzJztcbmltcG9ydCB7IEJsdXJGaWx0ZXJQYXNzIH0gZnJvbSAnLi9CbHVyRmlsdGVyUGFzcyc7XG5pbXBvcnQgeyBDTEVBUl9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbmltcG9ydCB0eXBlIHsgUmVuZGVyVGV4dHVyZSwgc3lzdGVtcyB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBCTEVORF9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5cbi8qKlxuICogVGhlIEJsdXJGaWx0ZXIgYXBwbGllcyBhIEdhdXNzaWFuIGJsdXIgdG8gYW4gb2JqZWN0LlxuICpcbiAqIFRoZSBzdHJlbmd0aCBvZiB0aGUgYmx1ciBjYW4gYmUgc2V0IGZvciB0aGUgeC1heGlzIGFuZCB5LWF4aXMgc2VwYXJhdGVseS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuRmlsdGVyXG4gKiBAbWVtYmVyb2YgUElYSS5maWx0ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBCbHVyRmlsdGVyIGV4dGVuZHMgRmlsdGVyXG57XG4gICAgcHVibGljIGJsdXJYRmlsdGVyOiBCbHVyRmlsdGVyUGFzcztcbiAgICBwdWJsaWMgYmx1cllGaWx0ZXI6IEJsdXJGaWx0ZXJQYXNzO1xuXG4gICAgcHJpdmF0ZSBfcmVwZWF0RWRnZVBpeGVsczogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RyZW5ndGg9OF0gLSBUaGUgc3RyZW5ndGggb2YgdGhlIGJsdXIgZmlsdGVyLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcXVhbGl0eT00XSAtIFRoZSBxdWFsaXR5IG9mIHRoZSBibHVyIGZpbHRlci5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb249UElYSS5zZXR0aW5ncy5GSUxURVJfUkVTT0xVVElPTl0gLSBUaGUgcmVzb2x1dGlvbiBvZiB0aGUgYmx1ciBmaWx0ZXIuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtrZXJuZWxTaXplPTVdIC0gVGhlIGtlcm5lbFNpemUgb2YgdGhlIGJsdXIgZmlsdGVyLk9wdGlvbnM6IDUsIDcsIDksIDExLCAxMywgMTUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3RyZW5ndGggPSA4LCBxdWFsaXR5ID0gNCwgcmVzb2x1dGlvbiA9IHNldHRpbmdzLkZJTFRFUl9SRVNPTFVUSU9OLCBrZXJuZWxTaXplID0gNSlcbiAgICB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5ibHVyWEZpbHRlciA9IG5ldyBCbHVyRmlsdGVyUGFzcyh0cnVlLCBzdHJlbmd0aCwgcXVhbGl0eSwgcmVzb2x1dGlvbiwga2VybmVsU2l6ZSk7XG4gICAgICAgIHRoaXMuYmx1cllGaWx0ZXIgPSBuZXcgQmx1ckZpbHRlclBhc3MoZmFsc2UsIHN0cmVuZ3RoLCBxdWFsaXR5LCByZXNvbHV0aW9uLCBrZXJuZWxTaXplKTtcblxuICAgICAgICB0aGlzLnJlc29sdXRpb24gPSByZXNvbHV0aW9uO1xuICAgICAgICB0aGlzLnF1YWxpdHkgPSBxdWFsaXR5O1xuICAgICAgICB0aGlzLmJsdXIgPSBzdHJlbmd0aDtcblxuICAgICAgICB0aGlzLnJlcGVhdEVkZ2VQaXhlbHMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBmaWx0ZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW19IGZpbHRlck1hbmFnZXIgLSBUaGUgbWFuYWdlci5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyVGV4dHVyZX0gaW5wdXQgLSBUaGUgaW5wdXQgdGFyZ2V0LlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBvdXRwdXQgLSBUaGUgb3V0cHV0IHRhcmdldC5cbiAgICAgKiBAcGFyYW0ge1BJWEkuQ0xFQVJfTU9ERVN9IGNsZWFyTW9kZSAtIEhvdyB0byBjbGVhclxuICAgICAqL1xuICAgIGFwcGx5KGZpbHRlck1hbmFnZXI6IHN5c3RlbXMuRmlsdGVyU3lzdGVtLCBpbnB1dDogUmVuZGVyVGV4dHVyZSwgb3V0cHV0OiBSZW5kZXJUZXh0dXJlLCBjbGVhck1vZGU6IENMRUFSX01PREVTKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgeFN0cmVuZ3RoID0gTWF0aC5hYnModGhpcy5ibHVyWEZpbHRlci5zdHJlbmd0aCk7XG4gICAgICAgIGNvbnN0IHlTdHJlbmd0aCA9IE1hdGguYWJzKHRoaXMuYmx1cllGaWx0ZXIuc3RyZW5ndGgpO1xuXG4gICAgICAgIGlmICh4U3RyZW5ndGggJiYgeVN0cmVuZ3RoKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJUYXJnZXQgPSBmaWx0ZXJNYW5hZ2VyLmdldEZpbHRlclRleHR1cmUoKTtcblxuICAgICAgICAgICAgdGhpcy5ibHVyWEZpbHRlci5hcHBseShmaWx0ZXJNYW5hZ2VyLCBpbnB1dCwgcmVuZGVyVGFyZ2V0LCBDTEVBUl9NT0RFUy5DTEVBUik7XG4gICAgICAgICAgICB0aGlzLmJsdXJZRmlsdGVyLmFwcGx5KGZpbHRlck1hbmFnZXIsIHJlbmRlclRhcmdldCwgb3V0cHV0LCBjbGVhck1vZGUpO1xuXG4gICAgICAgICAgICBmaWx0ZXJNYW5hZ2VyLnJldHVybkZpbHRlclRleHR1cmUocmVuZGVyVGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh5U3RyZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmx1cllGaWx0ZXIuYXBwbHkoZmlsdGVyTWFuYWdlciwgaW5wdXQsIG91dHB1dCwgY2xlYXJNb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYmx1clhGaWx0ZXIuYXBwbHkoZmlsdGVyTWFuYWdlciwgaW5wdXQsIG91dHB1dCwgY2xlYXJNb2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCB1cGRhdGVQYWRkaW5nKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl9yZXBlYXRFZGdlUGl4ZWxzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnBhZGRpbmcgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wYWRkaW5nID0gTWF0aC5tYXgoTWF0aC5hYnModGhpcy5ibHVyWEZpbHRlci5zdHJlbmd0aCksIE1hdGguYWJzKHRoaXMuYmx1cllGaWx0ZXIuc3RyZW5ndGgpKSAqIDI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdHJlbmd0aCBvZiBib3RoIHRoZSBibHVyWCBhbmQgYmx1clkgcHJvcGVydGllcyBzaW11bHRhbmVvdXNseVxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDJcbiAgICAgKi9cbiAgICBnZXQgYmx1cigpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmJsdXJYRmlsdGVyLmJsdXI7XG4gICAgfVxuXG4gICAgc2V0IGJsdXIodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuYmx1clhGaWx0ZXIuYmx1ciA9IHRoaXMuYmx1cllGaWx0ZXIuYmx1ciA9IHZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZGRpbmcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBudW1iZXIgb2YgcGFzc2VzIGZvciBibHVyLiBNb3JlIHBhc3NlcyBtZWFucyBoaWdoZXIgcXVhaWxpdHkgYmx1cmluZy5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAxXG4gICAgICovXG4gICAgZ2V0IHF1YWxpdHkoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5ibHVyWEZpbHRlci5xdWFsaXR5O1xuICAgIH1cblxuICAgIHNldCBxdWFsaXR5KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLmJsdXJYRmlsdGVyLnF1YWxpdHkgPSB0aGlzLmJsdXJZRmlsdGVyLnF1YWxpdHkgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdHJlbmd0aCBvZiB0aGUgYmx1clggcHJvcGVydHlcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAyXG4gICAgICovXG4gICAgZ2V0IGJsdXJYKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmx1clhGaWx0ZXIuYmx1cjtcbiAgICB9XG5cbiAgICBzZXQgYmx1clgodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuYmx1clhGaWx0ZXIuYmx1ciA9IHZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZGRpbmcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdHJlbmd0aCBvZiB0aGUgYmx1clkgcHJvcGVydHlcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKiBAZGVmYXVsdCAyXG4gICAgICovXG4gICAgZ2V0IGJsdXJZKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmx1cllGaWx0ZXIuYmx1cjtcbiAgICB9XG5cbiAgICBzZXQgYmx1clkodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuYmx1cllGaWx0ZXIuYmx1ciA9IHZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZGRpbmcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBibGVuZG1vZGUgb2YgdGhlIGZpbHRlclxuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMXG4gICAgICovXG4gICAgZ2V0IGJsZW5kTW9kZSgpOiBCTEVORF9NT0RFU1xuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmx1cllGaWx0ZXIuYmxlbmRNb2RlO1xuICAgIH1cblxuICAgIHNldCBibGVuZE1vZGUodmFsdWU6IEJMRU5EX01PREVTKVxuICAgIHtcbiAgICAgICAgdGhpcy5ibHVyWUZpbHRlci5ibGVuZE1vZGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSB0aGUgZWRnZSBvZiB0aGUgdGFyZ2V0IHdpbGwgYmUgY2xhbXBlZFxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAqL1xuICAgIGdldCByZXBlYXRFZGdlUGl4ZWxzKCk6IGJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXBlYXRFZGdlUGl4ZWxzO1xuICAgIH1cblxuICAgIHNldCByZXBlYXRFZGdlUGl4ZWxzKHZhbHVlOiBib29sZWFuKVxuICAgIHtcbiAgICAgICAgdGhpcy5fcmVwZWF0RWRnZVBpeGVscyA9IHZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZGRpbmcoKTtcbiAgICB9XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgRmlsdGVyLCBkZWZhdWx0RmlsdGVyVmVydGV4IH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgZnJhZ21lbnQgZnJvbSAnLi9jb2xvck1hdHJpeC5mcmFnJztcblxuaW1wb3J0IHR5cGUgeyBBcnJheUZpeGVkIH0gZnJvbSAnQHBpeGkvdXRpbHMnO1xuXG5leHBvcnQgdHlwZSBDb2xvck1hdHJpeCA9IEFycmF5Rml4ZWQ8bnVtYmVyLCAyMD47XG5cbi8qKlxuICogVGhlIENvbG9yTWF0cml4RmlsdGVyIGNsYXNzIGxldHMgeW91IGFwcGx5IGEgNXg0IG1hdHJpeCB0cmFuc2Zvcm1hdGlvbiBvbiB0aGUgUkdCQVxuICogY29sb3IgYW5kIGFscGhhIHZhbHVlcyBvZiBldmVyeSBwaXhlbCBvbiB5b3VyIGRpc3BsYXlPYmplY3QgdG8gcHJvZHVjZSBhIHJlc3VsdFxuICogd2l0aCBhIG5ldyBzZXQgb2YgUkdCQSBjb2xvciBhbmQgYWxwaGEgdmFsdWVzLiBJdCdzIHByZXR0eSBwb3dlcmZ1bCFcbiAqXG4gKiBgYGBqc1xuICogIGxldCBjb2xvck1hdHJpeCA9IG5ldyBQSVhJLmZpbHRlcnMuQ29sb3JNYXRyaXhGaWx0ZXIoKTtcbiAqICBjb250YWluZXIuZmlsdGVycyA9IFtjb2xvck1hdHJpeF07XG4gKiAgY29sb3JNYXRyaXguY29udHJhc3QoMik7XG4gKiBgYGBcbiAqIEBhdXRob3IgQ2xcdTAwRTltZW50IENoZW5lYmF1bHQgPGNsZW1lbnRAZ29vZGJveWRpZ2l0YWwuY29tPlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkZpbHRlclxuICogQG1lbWJlcm9mIFBJWEkuZmlsdGVyc1xuICovXG5leHBvcnQgY2xhc3MgQ29sb3JNYXRyaXhGaWx0ZXIgZXh0ZW5kcyBGaWx0ZXJcbntcbiAgICBwdWJsaWMgZ3JheXNjYWxlOiAoc2NhbGU6IG51bWJlciwgbXVsdGlwbHk6IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICBjb25zdCB1bmlmb3JtcyA9IHtcbiAgICAgICAgICAgIG06IG5ldyBGbG9hdDMyQXJyYXkoWzEsIDAsIDAsIDAsIDAsXG4gICAgICAgICAgICAgICAgMCwgMSwgMCwgMCwgMCxcbiAgICAgICAgICAgICAgICAwLCAwLCAxLCAwLCAwLFxuICAgICAgICAgICAgICAgIDAsIDAsIDAsIDEsIDBdKSxcbiAgICAgICAgICAgIHVBbHBoYTogMSxcbiAgICAgICAgfTtcblxuICAgICAgICBzdXBlcihkZWZhdWx0RmlsdGVyVmVydGV4LCBmcmFnbWVudCwgdW5pZm9ybXMpO1xuXG4gICAgICAgIHRoaXMuYWxwaGEgPSAxO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyYW5zZm9ybXMgY3VycmVudCBtYXRyaXggYW5kIHNldCB0aGUgbmV3IG9uZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gbWF0cml4IC0gNXg0IG1hdHJpeFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlwbHkgLSBpZiB0cnVlLCBjdXJyZW50IG1hdHJpeCBhbmQgbWF0cml4IGFyZSBtdWx0aXBsaWVkLiBJZiBmYWxzZSxcbiAgICAgKiAganVzdCBzZXQgdGhlIGN1cnJlbnQgbWF0cml4IHdpdGggQHBhcmFtIG1hdHJpeFxuICAgICAqL1xuICAgIHByaXZhdGUgX2xvYWRNYXRyaXgobWF0cml4OiBDb2xvck1hdHJpeCwgbXVsdGlwbHkgPSBmYWxzZSk6IHZvaWRcbiAgICB7XG4gICAgICAgIGxldCBuZXdNYXRyaXggPSBtYXRyaXg7XG5cbiAgICAgICAgaWYgKG11bHRpcGx5KVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9tdWx0aXBseShuZXdNYXRyaXgsIHRoaXMudW5pZm9ybXMubSwgbWF0cml4KTtcbiAgICAgICAgICAgIG5ld01hdHJpeCA9IHRoaXMuX2NvbG9yTWF0cml4KG5ld01hdHJpeCkgYXMgYW55O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2V0IHRoZSBuZXcgbWF0cml4XG4gICAgICAgIHRoaXMudW5pZm9ybXMubSA9IG5ld01hdHJpeDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNdWx0aXBsaWVzIHR3byBtYXQ1J3NcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gb3V0IC0gNXg0IG1hdHJpeCB0aGUgcmVjZWl2aW5nIG1hdHJpeFxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IGEgLSA1eDQgbWF0cml4IHRoZSBmaXJzdCBvcGVyYW5kXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gYiAtIDV4NCBtYXRyaXggdGhlIHNlY29uZCBvcGVyYW5kXG4gICAgICogQHJldHVybnMge251bWJlcltdfSA1eDQgbWF0cml4XG4gICAgICovXG4gICAgcHJpdmF0ZSBfbXVsdGlwbHkob3V0OiBDb2xvck1hdHJpeCwgYTogQ29sb3JNYXRyaXgsIGI6IENvbG9yTWF0cml4KTogQ29sb3JNYXRyaXhcbiAgICB7XG4gICAgICAgIC8vIFJlZCBDaGFubmVsXG4gICAgICAgIG91dFswXSA9IChhWzBdICogYlswXSkgKyAoYVsxXSAqIGJbNV0pICsgKGFbMl0gKiBiWzEwXSkgKyAoYVszXSAqIGJbMTVdKTtcbiAgICAgICAgb3V0WzFdID0gKGFbMF0gKiBiWzFdKSArIChhWzFdICogYls2XSkgKyAoYVsyXSAqIGJbMTFdKSArIChhWzNdICogYlsxNl0pO1xuICAgICAgICBvdXRbMl0gPSAoYVswXSAqIGJbMl0pICsgKGFbMV0gKiBiWzddKSArIChhWzJdICogYlsxMl0pICsgKGFbM10gKiBiWzE3XSk7XG4gICAgICAgIG91dFszXSA9IChhWzBdICogYlszXSkgKyAoYVsxXSAqIGJbOF0pICsgKGFbMl0gKiBiWzEzXSkgKyAoYVszXSAqIGJbMThdKTtcbiAgICAgICAgb3V0WzRdID0gKGFbMF0gKiBiWzRdKSArIChhWzFdICogYls5XSkgKyAoYVsyXSAqIGJbMTRdKSArIChhWzNdICogYlsxOV0pICsgYVs0XTtcblxuICAgICAgICAvLyBHcmVlbiBDaGFubmVsXG4gICAgICAgIG91dFs1XSA9IChhWzVdICogYlswXSkgKyAoYVs2XSAqIGJbNV0pICsgKGFbN10gKiBiWzEwXSkgKyAoYVs4XSAqIGJbMTVdKTtcbiAgICAgICAgb3V0WzZdID0gKGFbNV0gKiBiWzFdKSArIChhWzZdICogYls2XSkgKyAoYVs3XSAqIGJbMTFdKSArIChhWzhdICogYlsxNl0pO1xuICAgICAgICBvdXRbN10gPSAoYVs1XSAqIGJbMl0pICsgKGFbNl0gKiBiWzddKSArIChhWzddICogYlsxMl0pICsgKGFbOF0gKiBiWzE3XSk7XG4gICAgICAgIG91dFs4XSA9IChhWzVdICogYlszXSkgKyAoYVs2XSAqIGJbOF0pICsgKGFbN10gKiBiWzEzXSkgKyAoYVs4XSAqIGJbMThdKTtcbiAgICAgICAgb3V0WzldID0gKGFbNV0gKiBiWzRdKSArIChhWzZdICogYls5XSkgKyAoYVs3XSAqIGJbMTRdKSArIChhWzhdICogYlsxOV0pICsgYVs5XTtcblxuICAgICAgICAvLyBCbHVlIENoYW5uZWxcbiAgICAgICAgb3V0WzEwXSA9IChhWzEwXSAqIGJbMF0pICsgKGFbMTFdICogYls1XSkgKyAoYVsxMl0gKiBiWzEwXSkgKyAoYVsxM10gKiBiWzE1XSk7XG4gICAgICAgIG91dFsxMV0gPSAoYVsxMF0gKiBiWzFdKSArIChhWzExXSAqIGJbNl0pICsgKGFbMTJdICogYlsxMV0pICsgKGFbMTNdICogYlsxNl0pO1xuICAgICAgICBvdXRbMTJdID0gKGFbMTBdICogYlsyXSkgKyAoYVsxMV0gKiBiWzddKSArIChhWzEyXSAqIGJbMTJdKSArIChhWzEzXSAqIGJbMTddKTtcbiAgICAgICAgb3V0WzEzXSA9IChhWzEwXSAqIGJbM10pICsgKGFbMTFdICogYls4XSkgKyAoYVsxMl0gKiBiWzEzXSkgKyAoYVsxM10gKiBiWzE4XSk7XG4gICAgICAgIG91dFsxNF0gPSAoYVsxMF0gKiBiWzRdKSArIChhWzExXSAqIGJbOV0pICsgKGFbMTJdICogYlsxNF0pICsgKGFbMTNdICogYlsxOV0pICsgYVsxNF07XG5cbiAgICAgICAgLy8gQWxwaGEgQ2hhbm5lbFxuICAgICAgICBvdXRbMTVdID0gKGFbMTVdICogYlswXSkgKyAoYVsxNl0gKiBiWzVdKSArIChhWzE3XSAqIGJbMTBdKSArIChhWzE4XSAqIGJbMTVdKTtcbiAgICAgICAgb3V0WzE2XSA9IChhWzE1XSAqIGJbMV0pICsgKGFbMTZdICogYls2XSkgKyAoYVsxN10gKiBiWzExXSkgKyAoYVsxOF0gKiBiWzE2XSk7XG4gICAgICAgIG91dFsxN10gPSAoYVsxNV0gKiBiWzJdKSArIChhWzE2XSAqIGJbN10pICsgKGFbMTddICogYlsxMl0pICsgKGFbMThdICogYlsxN10pO1xuICAgICAgICBvdXRbMThdID0gKGFbMTVdICogYlszXSkgKyAoYVsxNl0gKiBiWzhdKSArIChhWzE3XSAqIGJbMTNdKSArIChhWzE4XSAqIGJbMThdKTtcbiAgICAgICAgb3V0WzE5XSA9IChhWzE1XSAqIGJbNF0pICsgKGFbMTZdICogYls5XSkgKyAoYVsxN10gKiBiWzE0XSkgKyAoYVsxOF0gKiBiWzE5XSkgKyBhWzE5XTtcblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIEZsb2F0MzIgQXJyYXkgYW5kIG5vcm1hbGl6ZSB0aGUgb2Zmc2V0IGNvbXBvbmVudCB0byAwLTFcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gbWF0cml4IC0gNXg0IG1hdHJpeFxuICAgICAqIEByZXR1cm4ge251bWJlcltdfSA1eDQgbWF0cml4IHdpdGggYWxsIHZhbHVlcyBiZXR3ZWVuIDAtMVxuICAgICAqL1xuICAgIHByaXZhdGUgX2NvbG9yTWF0cml4KG1hdHJpeDogQ29sb3JNYXRyaXgpOiBDb2xvck1hdHJpeFxuICAgIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgRmxvYXQzMiBBcnJheSBhbmQgbm9ybWFsaXplIHRoZSBvZmZzZXQgY29tcG9uZW50IHRvIDAtMVxuICAgICAgICBjb25zdCBtID0gbmV3IEZsb2F0MzJBcnJheShtYXRyaXgpO1xuXG4gICAgICAgIG1bNF0gLz0gMjU1O1xuICAgICAgICBtWzldIC89IDI1NTtcbiAgICAgICAgbVsxNF0gLz0gMjU1O1xuICAgICAgICBtWzE5XSAvPSAyNTU7XG5cbiAgICAgICAgcmV0dXJuIG0gYXMgYW55O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkanVzdHMgYnJpZ2h0bmVzc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGIgLSB2YWx1ZSBvZiB0aGUgYnJpZ3RobmVzcyAoMC0xLCB3aGVyZSAwIGlzIGJsYWNrKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlwbHkgLSBpZiB0cnVlLCBjdXJyZW50IG1hdHJpeCBhbmQgbWF0cml4IGFyZSBtdWx0aXBsaWVkLiBJZiBmYWxzZSxcbiAgICAgKiAganVzdCBzZXQgdGhlIGN1cnJlbnQgbWF0cml4IHdpdGggQHBhcmFtIG1hdHJpeFxuICAgICAqL1xuICAgIHB1YmxpYyBicmlnaHRuZXNzKGI6IG51bWJlciwgbXVsdGlwbHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXRyaXg6IENvbG9yTWF0cml4ID0gW1xuICAgICAgICAgICAgYiwgMCwgMCwgMCwgMCxcbiAgICAgICAgICAgIDAsIGIsIDAsIDAsIDAsXG4gICAgICAgICAgICAwLCAwLCBiLCAwLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgbWF0cmljZXMgaW4gZ3JleSBzY2FsZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZSAtIHZhbHVlIG9mIHRoZSBncmV5ICgwLTEsIHdoZXJlIDAgaXMgYmxhY2spXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIGdyZXlzY2FsZShzY2FsZTogbnVtYmVyLCBtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICBzY2FsZSwgc2NhbGUsIHNjYWxlLCAwLCAwLFxuICAgICAgICAgICAgc2NhbGUsIHNjYWxlLCBzY2FsZSwgMCwgMCxcbiAgICAgICAgICAgIHNjYWxlLCBzY2FsZSwgc2NhbGUsIDAsIDAsXG4gICAgICAgICAgICAwLCAwLCAwLCAxLCAwLFxuICAgICAgICBdO1xuXG4gICAgICAgIHRoaXMuX2xvYWRNYXRyaXgobWF0cml4LCBtdWx0aXBseSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBibGFjayBhbmQgd2hpdGUgbWF0cmljZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlwbHkgLSBpZiB0cnVlLCBjdXJyZW50IG1hdHJpeCBhbmQgbWF0cml4IGFyZSBtdWx0aXBsaWVkLiBJZiBmYWxzZSxcbiAgICAgKiAganVzdCBzZXQgdGhlIGN1cnJlbnQgbWF0cml4IHdpdGggQHBhcmFtIG1hdHJpeFxuICAgICAqL1xuICAgIHB1YmxpYyBibGFja0FuZFdoaXRlKG11bHRpcGx5OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIDAuMywgMC42LCAwLjEsIDAsIDAsXG4gICAgICAgICAgICAwLjMsIDAuNiwgMC4xLCAwLCAwLFxuICAgICAgICAgICAgMC4zLCAwLjYsIDAuMSwgMCwgMCxcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGh1ZSBwcm9wZXJ0eSBvZiB0aGUgY29sb3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3RhdGlvbiAtIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgaHVlKHJvdGF0aW9uOiBudW1iZXIsIG11bHRpcGx5OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgcm90YXRpb24gPSAocm90YXRpb24gfHwgMCkgLyAxODAgKiBNYXRoLlBJO1xuXG4gICAgICAgIGNvbnN0IGNvc1IgPSBNYXRoLmNvcyhyb3RhdGlvbik7XG4gICAgICAgIGNvbnN0IHNpblIgPSBNYXRoLnNpbihyb3RhdGlvbik7XG4gICAgICAgIGNvbnN0IHNxcnQgPSBNYXRoLnNxcnQ7XG5cbiAgICAgICAgLyogYSBnb29kIGFwcHJveGltYXRpb24gZm9yIGh1ZSByb3RhdGlvblxuICAgICAgICAgVGhpcyBtYXRyaXggaXMgZmFyIGJldHRlciB0aGFuIHRoZSB2ZXJzaW9ucyB3aXRoIG1hZ2ljIGx1bWluYW5jZSBjb25zdGFudHNcbiAgICAgICAgIGZvcm1lcmx5IHVzZWQgaGVyZSwgYnV0IGFsc28gdXNlZCBpbiB0aGUgc3RhcmxpbmcgZnJhbWV3b3JrIChmbGFzaCkgYW5kIGtub3duIGZyb20gdGhpc1xuICAgICAgICAgb2xkIHBhcnQgb2YgdGhlIGludGVybmV0OiBxdWFzaW1vbmRvLmNvbS9hcmNoaXZlcy8wMDA1NjUucGhwXG5cbiAgICAgICAgIFRoaXMgbmV3IG1hdHJpeCBpcyBiYXNlZCBvbiByZ2IgY3ViZSByb3RhdGlvbiBpbiBzcGFjZS4gTG9vayBoZXJlIGZvciBhIG1vcmUgZGVzY3JpcHRpdmVcbiAgICAgICAgIGltcGxlbWVudGF0aW9uIGFzIGEgc2hhZGVyIG5vdCBhIGdlbmVyYWwgbWF0cml4OlxuICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2V2YW53L2dsZnguanMvYmxvYi81ODg0MWMyMzkxOWJkNTk3ODdlZmZjMDMzM2E0ODk3YjQzODM1NDEyL3NyYy9maWx0ZXJzL2FkanVzdC9odWVzYXR1cmF0aW9uLmpzXG5cbiAgICAgICAgIFRoaXMgaXMgdGhlIHNvdXJjZSBmb3IgdGhlIGNvZGU6XG4gICAgICAgICBzZWUgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84NTA3ODg1L3NoaWZ0LWh1ZS1vZi1hbi1yZ2ItY29sb3IvODUxMDc1MSM4NTEwNzUxXG4gICAgICAgICAqL1xuXG4gICAgICAgIGNvbnN0IHcgPSAxIC8gMztcbiAgICAgICAgY29uc3Qgc3FyVyA9IHNxcnQodyk7IC8vIHdlaWdodCBpc1xuXG4gICAgICAgIGNvbnN0IGEwMCA9IGNvc1IgKyAoKDEuMCAtIGNvc1IpICogdyk7XG4gICAgICAgIGNvbnN0IGEwMSA9ICh3ICogKDEuMCAtIGNvc1IpKSAtIChzcXJXICogc2luUik7XG4gICAgICAgIGNvbnN0IGEwMiA9ICh3ICogKDEuMCAtIGNvc1IpKSArIChzcXJXICogc2luUik7XG5cbiAgICAgICAgY29uc3QgYTEwID0gKHcgKiAoMS4wIC0gY29zUikpICsgKHNxclcgKiBzaW5SKTtcbiAgICAgICAgY29uc3QgYTExID0gY29zUiArICh3ICogKDEuMCAtIGNvc1IpKTtcbiAgICAgICAgY29uc3QgYTEyID0gKHcgKiAoMS4wIC0gY29zUikpIC0gKHNxclcgKiBzaW5SKTtcblxuICAgICAgICBjb25zdCBhMjAgPSAodyAqICgxLjAgLSBjb3NSKSkgLSAoc3FyVyAqIHNpblIpO1xuICAgICAgICBjb25zdCBhMjEgPSAodyAqICgxLjAgLSBjb3NSKSkgKyAoc3FyVyAqIHNpblIpO1xuICAgICAgICBjb25zdCBhMjIgPSBjb3NSICsgKHcgKiAoMS4wIC0gY29zUikpO1xuXG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICBhMDAsIGEwMSwgYTAyLCAwLCAwLFxuICAgICAgICAgICAgYTEwLCBhMTEsIGExMiwgMCwgMCxcbiAgICAgICAgICAgIGEyMCwgYTIxLCBhMjIsIDAsIDAsXG4gICAgICAgICAgICAwLCAwLCAwLCAxLCAwLFxuICAgICAgICBdO1xuXG4gICAgICAgIHRoaXMuX2xvYWRNYXRyaXgobWF0cml4LCBtdWx0aXBseSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjb250cmFzdCBtYXRyaXgsIGluY3JlYXNlIHRoZSBzZXBhcmF0aW9uIGJldHdlZW4gZGFyayBhbmQgYnJpZ2h0XG4gICAgICogSW5jcmVhc2UgY29udHJhc3QgOiBzaGFkb3dzIGRhcmtlciBhbmQgaGlnaGxpZ2h0cyBicmlnaHRlclxuICAgICAqIERlY3JlYXNlIGNvbnRyYXN0IDogYnJpbmcgdGhlIHNoYWRvd3MgdXAgYW5kIHRoZSBoaWdobGlnaHRzIGRvd25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhbW91bnQgLSB2YWx1ZSBvZiB0aGUgY29udHJhc3QgKDAtMSlcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgY29udHJhc3QoYW1vdW50OiBudW1iZXIsIG11bHRpcGx5OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdiA9IChhbW91bnQgfHwgMCkgKyAxO1xuICAgICAgICBjb25zdCBvID0gLTAuNSAqICh2IC0gMSk7XG5cbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIHYsIDAsIDAsIDAsIG8sXG4gICAgICAgICAgICAwLCB2LCAwLCAwLCBvLFxuICAgICAgICAgICAgMCwgMCwgdiwgMCwgbyxcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHNhdHVyYXRpb24gbWF0cml4LCBpbmNyZWFzZSB0aGUgc2VwYXJhdGlvbiBiZXR3ZWVuIGNvbG9yc1xuICAgICAqIEluY3JlYXNlIHNhdHVyYXRpb24gOiBpbmNyZWFzZSBjb250cmFzdCwgYnJpZ2h0bmVzcywgYW5kIHNoYXJwbmVzc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCAtIFRoZSBzYXR1cmF0aW9uIGFtb3VudCAoMC0xKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW211bHRpcGx5XSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIHNhdHVyYXRlKGFtb3VudCA9IDAsIG11bHRpcGx5PzogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHggPSAoYW1vdW50ICogMiAvIDMpICsgMTtcbiAgICAgICAgY29uc3QgeSA9ICgoeCAtIDEpICogLTAuNSk7XG5cbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIHgsIHksIHksIDAsIDAsXG4gICAgICAgICAgICB5LCB4LCB5LCAwLCAwLFxuICAgICAgICAgICAgeSwgeSwgeCwgMCwgMCxcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXNhdHVyYXRlIGltYWdlIChyZW1vdmUgY29sb3IpXG4gICAgICpcbiAgICAgKiBDYWxsIHRoZSBzYXR1cmF0ZSBmdW5jdGlvblxuICAgICAqXG4gICAgICovXG4gICAgcHVibGljIGRlc2F0dXJhdGUoKTogdm9pZCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAge1xuICAgICAgICB0aGlzLnNhdHVyYXRlKC0xKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOZWdhdGl2ZSBpbWFnZSAoaW52ZXJzZSBvZiBjbGFzc2ljIHJnYiBtYXRyaXgpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgbmVnYXRpdmUobXVsdGlwbHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXRyaXg6IENvbG9yTWF0cml4ID0gW1xuICAgICAgICAgICAgLTEsIDAsIDAsIDEsIDAsXG4gICAgICAgICAgICAwLCAtMSwgMCwgMSwgMCxcbiAgICAgICAgICAgIDAsIDAsIC0xLCAxLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNlcGlhIGltYWdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgc2VwaWEobXVsdGlwbHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXRyaXg6IENvbG9yTWF0cml4ID0gW1xuICAgICAgICAgICAgMC4zOTMsIDAuNzY4OTk5OSwgMC4xODg5OTk5OSwgMCwgMCxcbiAgICAgICAgICAgIDAuMzQ5LCAwLjY4NTk5OTksIDAuMTY3OTk5OTksIDAsIDAsXG4gICAgICAgICAgICAwLjI3MiwgMC41MzM5OTk5LCAwLjEzMDk5OTk5LCAwLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbG9yIG1vdGlvbiBwaWN0dXJlIHByb2Nlc3MgaW52ZW50ZWQgaW4gMTkxNiAodGhhbmtzIERvbWluaWMgU3phYmxld3NraSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlwbHkgLSBpZiB0cnVlLCBjdXJyZW50IG1hdHJpeCBhbmQgbWF0cml4IGFyZSBtdWx0aXBsaWVkLiBJZiBmYWxzZSxcbiAgICAgKiAganVzdCBzZXQgdGhlIGN1cnJlbnQgbWF0cml4IHdpdGggQHBhcmFtIG1hdHJpeFxuICAgICAqL1xuICAgIHB1YmxpYyB0ZWNobmljb2xvcihtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAxLjkxMjUyNzc4OTE0NTYwODMsIC0wLjg1NDUzNDQ5NzY5NTE2NDUsIC0wLjA5MTU1NTA4NDgyNzU1NTg1LCAwLCAxMS43OTM2MDM0MzQzNzczMzcsXG4gICAgICAgICAgICAtMC4zMDg3ODMzMzg1OTI4MDk3LCAxLjc2NTg5MDg1NTU0NTg0MjgsIC0wLjEwNjAxNzQzMDc0NzIyMjQ1LCAwLCAtNzAuMzUyMDUxNjE0NjEzOTgsXG4gICAgICAgICAgICAtMC4yMzExMDMzNzc1NDg2MTYsIC0wLjc1MDE4OTkxOTc0NDAyMTIsIDEuODQ3NTk3ODE2MTA4MTg5LCAwLCAzMC45NTA5NDA4Njk0OTExMzgsXG4gICAgICAgICAgICAwLCAwLCAwLCAxLCAwLFxuICAgICAgICBdO1xuXG4gICAgICAgIHRoaXMuX2xvYWRNYXRyaXgobWF0cml4LCBtdWx0aXBseSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUG9sYXJvaWQgZmlsdGVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgcG9sYXJvaWQobXVsdGlwbHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXRyaXg6IENvbG9yTWF0cml4ID0gW1xuICAgICAgICAgICAgMS40MzgsIC0wLjA2MiwgLTAuMDYyLCAwLCAwLFxuICAgICAgICAgICAgLTAuMTIyLCAxLjM3OCwgLTAuMTIyLCAwLCAwLFxuICAgICAgICAgICAgLTAuMDE2LCAtMC4wMTYsIDEuNDgzLCAwLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbHRlciB3aG8gdHJhbnNmb3JtcyA6IFJlZCAtPiBCbHVlIGFuZCBCbHVlIC0+IFJlZFxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIHRvQkdSKG11bHRpcGx5OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIDAsIDAsIDEsIDAsIDAsXG4gICAgICAgICAgICAwLCAxLCAwLCAwLCAwLFxuICAgICAgICAgICAgMSwgMCwgMCwgMCwgMCxcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb2xvciByZXZlcnNhbCBmaWxtIGludHJvZHVjZWQgYnkgRWFzdG1hbiBLb2RhayBpbiAxOTM1LiAodGhhbmtzIERvbWluaWMgU3phYmxld3NraSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXVsdGlwbHkgLSBpZiB0cnVlLCBjdXJyZW50IG1hdHJpeCBhbmQgbWF0cml4IGFyZSBtdWx0aXBsaWVkLiBJZiBmYWxzZSxcbiAgICAgKiAganVzdCBzZXQgdGhlIGN1cnJlbnQgbWF0cml4IHdpdGggQHBhcmFtIG1hdHJpeFxuICAgICAqL1xuICAgIHB1YmxpYyBrb2RhY2hyb21lKG11bHRpcGx5OiBib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIDEuMTI4NTU4MjM5NjU5MzUyNSwgLTAuMzk2NzM4MjI4MzYwMTM0OCwgLTAuMDM5OTI1NTkxNzI5MjE3OTMsIDAsIDYzLjcyOTU4NzYyMTk2NTAyLFxuICAgICAgICAgICAgLTAuMTY0MDQzMzk5NjIyNDQ2MTYsIDEuMDgzNTI1MTU2NjI5MTMwNCwgLTAuMDU0OTg4MDUxMTU2MzMxMzIsIDAsIDI0LjczMjQwNzg5NjcwNjIwMyxcbiAgICAgICAgICAgIC0wLjE2Nzg2MDEwNzA2MTU1NzYzLCAtMC41NjAzNDE2Mjc3Njk1MjQ4LCAxLjYwMTQ4NTA3NjE5NjQ5NDMsIDAsIDM1LjYyOTgyODA3NDYwOTQ2LFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJyb3duIGRlbGljaW91cyBicm93bmkgZmlsdGVyICh0aGFua3MgRG9taW5pYyBTemFibGV3c2tpKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIGJyb3duaShtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAwLjU5OTcwMjM0OTgxNTk3MTUsIDAuMzQ1NTMyNDMwNDgzOTEyNjMsIC0wLjI3MDgyOTg2NzQ1MzgwNDIsIDAsIDQ3LjQzMTkyODU1NjAwODczLFxuICAgICAgICAgICAgLTAuMDM3NzAzMjQ5ODM3NzgzMTU3LCAwLjg2MDk1Nzc1ODc5OTI2NDEsIDAuMTUwNTk1NTIzODg0NTk5MTMsIDAsIC0zNi45Njg0MTQ5ODMxOTEyNyxcbiAgICAgICAgICAgIDAuMjQxMTM2MzUxMjgxNTMzMzUsIC0wLjA3NDQxMDM3OTA4NDIyNDkyLCAwLjQ0OTcyMTgyMDY0ODc3MTUzLCAwLCAtNy41NjIwNzUyNzc1OTEyODMsXG4gICAgICAgICAgICAwLCAwLCAwLCAxLCAwLFxuICAgICAgICBdO1xuXG4gICAgICAgIHRoaXMuX2xvYWRNYXRyaXgobWF0cml4LCBtdWx0aXBseSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmludGFnZSBmaWx0ZXIgKHRoYW5rcyBEb21pbmljIFN6YWJsZXdza2kpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG11bHRpcGx5IC0gaWYgdHJ1ZSwgY3VycmVudCBtYXRyaXggYW5kIG1hdHJpeCBhcmUgbXVsdGlwbGllZC4gSWYgZmFsc2UsXG4gICAgICogIGp1c3Qgc2V0IHRoZSBjdXJyZW50IG1hdHJpeCB3aXRoIEBwYXJhbSBtYXRyaXhcbiAgICAgKi9cbiAgICBwdWJsaWMgdmludGFnZShtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAwLjYyNzkzNDU2MzU2MDU5OTQsIDAuMzIwMjE4MzQyMDgxOTM2NywgLTAuMDM5NjU0MDgyMTEzMTI0NTMsIDAsIDkuNjUxMjg1ODM1Mjk0MTIzLFxuICAgICAgICAgICAgMC4wMjU3ODM5NzcwNDgwODg2OCwgMC42NDQxMTg4NjQ0Mzc0NzcxLCAwLjAzMjU5MTI3NjE2MTQ5Mjk0LCAwLCA3LjQ2MjgyOTE3NjQ3MDU5MSxcbiAgICAgICAgICAgIDAuMDQ2NjA1NTU1Njc4MjcxOSwgLTAuMDg1MTIzMjk4NzI0Nzg5MSwgMC41MjQxNjQ4MDE4NzAwNDY1LCAwLCA1LjE1OTE5MDU4ODIzNTI5NixcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXZSBkb24ndCBrbm93IGV4YWN0bHkgd2hhdCBpdCBkb2VzLCBraW5kIG9mIGdyYWRpZW50IG1hcCwgYnV0IGZ1bm55IHRvIHBsYXkgd2l0aCFcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZXNhdHVyYXRpb24gLSBUb25lIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdG9uZWQgLSBUb25lIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGlnaHRDb2xvciAtIFRvbmUgdmFsdWVzLCBleGFtcGxlOiBgMHhGRkU1ODBgXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhcmtDb2xvciAtIFRvbmUgdmFsdWVzLCBleGFtcGxlOiBgMHhGRkU1ODBgXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIGNvbG9yVG9uZShkZXNhdHVyYXRpb246IG51bWJlciwgdG9uZWQ6IG51bWJlciwgbGlnaHRDb2xvcjogbnVtYmVyLCBkYXJrQ29sb3I6IG51bWJlciwgbXVsdGlwbHk6IGJvb2xlYW4pOiB2b2lkXG4gICAge1xuICAgICAgICBkZXNhdHVyYXRpb24gPSBkZXNhdHVyYXRpb24gfHwgMC4yO1xuICAgICAgICB0b25lZCA9IHRvbmVkIHx8IDAuMTU7XG4gICAgICAgIGxpZ2h0Q29sb3IgPSBsaWdodENvbG9yIHx8IDB4RkZFNTgwO1xuICAgICAgICBkYXJrQ29sb3IgPSBkYXJrQ29sb3IgfHwgMHgzMzgwMDA7XG5cbiAgICAgICAgY29uc3QgbFIgPSAoKGxpZ2h0Q29sb3IgPj4gMTYpICYgMHhGRikgLyAyNTU7XG4gICAgICAgIGNvbnN0IGxHID0gKChsaWdodENvbG9yID4+IDgpICYgMHhGRikgLyAyNTU7XG4gICAgICAgIGNvbnN0IGxCID0gKGxpZ2h0Q29sb3IgJiAweEZGKSAvIDI1NTtcblxuICAgICAgICBjb25zdCBkUiA9ICgoZGFya0NvbG9yID4+IDE2KSAmIDB4RkYpIC8gMjU1O1xuICAgICAgICBjb25zdCBkRyA9ICgoZGFya0NvbG9yID4+IDgpICYgMHhGRikgLyAyNTU7XG4gICAgICAgIGNvbnN0IGRCID0gKGRhcmtDb2xvciAmIDB4RkYpIC8gMjU1O1xuXG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAwLjMsIDAuNTksIDAuMTEsIDAsIDAsXG4gICAgICAgICAgICBsUiwgbEcsIGxCLCBkZXNhdHVyYXRpb24sIDAsXG4gICAgICAgICAgICBkUiwgZEcsIGRCLCB0b25lZCwgMCxcbiAgICAgICAgICAgIGxSIC0gZFIsIGxHIC0gZEcsIGxCIC0gZEIsIDAsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOaWdodCBlZmZlY3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbnRlbnNpdHkgLSBUaGUgaW50ZW5zaXR5IG9mIHRoZSBuaWdodCBlZmZlY3QuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIG5pZ2h0KGludGVuc2l0eTogbnVtYmVyLCBtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGludGVuc2l0eSA9IGludGVuc2l0eSB8fCAwLjE7XG5cbiAgICAgICAgY29uc3QgbWF0cml4OiBDb2xvck1hdHJpeCA9IFtcbiAgICAgICAgICAgIGludGVuc2l0eSAqICgtMi4wKSwgLWludGVuc2l0eSwgMCwgMCwgMCxcbiAgICAgICAgICAgIC1pbnRlbnNpdHksIDAsIGludGVuc2l0eSwgMCwgMCxcbiAgICAgICAgICAgIDAsIGludGVuc2l0eSwgaW50ZW5zaXR5ICogMi4wLCAwLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZWRhdG9yIGVmZmVjdFxuICAgICAqXG4gICAgICogRXJhc2UgdGhlIGN1cnJlbnQgbWF0cml4IGJ5IHNldHRpbmcgYSBuZXcgaW5kZXBlbnQgb25lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYW1vdW50IC0gaG93IG11Y2ggdGhlIHByZWRhdG9yIGZlZWxzIGhpcyBmdXR1cmUgdmljdGltXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIHByZWRhdG9yKGFtb3VudDogbnVtYmVyLCBtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAvLyByb3cgMVxuICAgICAgICAgICAgMTEuMjI0MTMwNjMwNDkzMTY0ICogYW1vdW50LFxuICAgICAgICAgICAgLTQuNzk0NDg2OTk5NTExNzE5ICogYW1vdW50LFxuICAgICAgICAgICAgLTIuODc0NjExODU0NTUzMjIyNyAqIGFtb3VudCxcbiAgICAgICAgICAgIDAgKiBhbW91bnQsXG4gICAgICAgICAgICAwLjQwMzQyNDM4MjIwOTc3NzgzICogYW1vdW50LFxuICAgICAgICAgICAgLy8gcm93IDJcbiAgICAgICAgICAgIC0zLjYzMzA2OTc1MzY0Njg1MDYgKiBhbW91bnQsXG4gICAgICAgICAgICA5LjE5MzE1NzE5NjA0NDkyMiAqIGFtb3VudCxcbiAgICAgICAgICAgIC0yLjk1MTgxMDgzNjc5MTk5MiAqIGFtb3VudCxcbiAgICAgICAgICAgIDAgKiBhbW91bnQsXG4gICAgICAgICAgICAtMS4zMTYxMzUwNDg4NjYyNzIgKiBhbW91bnQsXG4gICAgICAgICAgICAvLyByb3cgM1xuICAgICAgICAgICAgLTMuMjE4NDE5NzkwMjY3OTQ0MyAqIGFtb3VudCxcbiAgICAgICAgICAgIC00LjIzNzUwMzA1MTc1NzgxMjUgKiBhbW91bnQsXG4gICAgICAgICAgICA3LjQ3NjQ0ODA1OTA4MjAzMSAqIGFtb3VudCxcbiAgICAgICAgICAgIDAgKiBhbW91bnQsXG4gICAgICAgICAgICAwLjgwNDQ0NTkyMjM3NDcyNTMgKiBhbW91bnQsXG4gICAgICAgICAgICAvLyByb3cgNFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgbXVsdGlwbHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExTRCBlZmZlY3RcbiAgICAgKlxuICAgICAqIE11bHRpcGx5IHRoZSBjdXJyZW50IG1hdHJpeFxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBtdWx0aXBseSAtIGlmIHRydWUsIGN1cnJlbnQgbWF0cml4IGFuZCBtYXRyaXggYXJlIG11bHRpcGxpZWQuIElmIGZhbHNlLFxuICAgICAqICBqdXN0IHNldCB0aGUgY3VycmVudCBtYXRyaXggd2l0aCBAcGFyYW0gbWF0cml4XG4gICAgICovXG4gICAgcHVibGljIGxzZChtdWx0aXBseTogYm9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IG1hdHJpeDogQ29sb3JNYXRyaXggPSBbXG4gICAgICAgICAgICAyLCAtMC40LCAwLjUsIDAsIDAsXG4gICAgICAgICAgICAtMC41LCAyLCAtMC40LCAwLCAwLFxuICAgICAgICAgICAgLTAuNCwgLTAuNSwgMywgMCwgMCxcbiAgICAgICAgICAgIDAsIDAsIDAsIDEsIDAsXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5fbG9hZE1hdHJpeChtYXRyaXgsIG11bHRpcGx5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFcmFzZSB0aGUgY3VycmVudCBtYXRyaXggYnkgc2V0dGluZyB0aGUgZGVmYXVsdCBvbmVcbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyByZXNldCgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBtYXRyaXg6IENvbG9yTWF0cml4ID0gW1xuICAgICAgICAgICAgMSwgMCwgMCwgMCwgMCxcbiAgICAgICAgICAgIDAsIDEsIDAsIDAsIDAsXG4gICAgICAgICAgICAwLCAwLCAxLCAwLCAwLFxuICAgICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgXTtcblxuICAgICAgICB0aGlzLl9sb2FkTWF0cml4KG1hdHJpeCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXRyaXggb2YgdGhlIGNvbG9yIG1hdHJpeCBmaWx0ZXJcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcltdfVxuICAgICAqIEBkZWZhdWx0IFsxLCAwLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAwLCAxLCAwXVxuICAgICAqL1xuICAgIGdldCBtYXRyaXgoKTogQ29sb3JNYXRyaXhcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaWZvcm1zLm07XG4gICAgfVxuXG4gICAgc2V0IG1hdHJpeCh2YWx1ZTogQ29sb3JNYXRyaXgpXG4gICAge1xuICAgICAgICB0aGlzLnVuaWZvcm1zLm0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgb3BhY2l0eSB2YWx1ZSB0byB1c2Ugd2hlbiBtaXhpbmcgdGhlIG9yaWdpbmFsIGFuZCByZXN1bHRhbnQgY29sb3JzLlxuICAgICAqXG4gICAgICogV2hlbiB0aGUgdmFsdWUgaXMgMCwgdGhlIG9yaWdpbmFsIGNvbG9yIGlzIHVzZWQgd2l0aG91dCBtb2RpZmljYXRpb24uXG4gICAgICogV2hlbiB0aGUgdmFsdWUgaXMgMSwgdGhlIHJlc3VsdCBjb2xvciBpcyB1c2VkLlxuICAgICAqIFdoZW4gaW4gdGhlIHJhbmdlICgwLCAxKSB0aGUgY29sb3IgaXMgaW50ZXJwb2xhdGVkIGJldHdlZW4gdGhlIG9yaWdpbmFsIGFuZCByZXN1bHQgYnkgdGhpcyBhbW91bnQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMVxuICAgICAqL1xuICAgIGdldCBhbHBoYSgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaWZvcm1zLnVBbHBoYTtcbiAgICB9XG5cbiAgICBzZXQgYWxwaGEodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMudW5pZm9ybXMudUFscGhhID0gdmFsdWU7XG4gICAgfVxufVxuXG4vLyBBbWVyaWNhbml6ZWQgYWxpYXNcbkNvbG9yTWF0cml4RmlsdGVyLnByb3RvdHlwZS5ncmF5c2NhbGUgPSBDb2xvck1hdHJpeEZpbHRlci5wcm90b3R5cGUuZ3JleXNjYWxlO1xuIiwgIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwgImltcG9ydCB7IEZpbHRlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHsgTWF0cml4LCBQb2ludCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IGZyYWdtZW50IGZyb20gJy4vZGlzcGxhY2VtZW50LmZyYWcnO1xuaW1wb3J0IHZlcnRleCBmcm9tICcuL2Rpc3BsYWNlbWVudC52ZXJ0JztcblxuaW1wb3J0IHR5cGUgeyBDTEVBUl9NT0RFUyB9IGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5pbXBvcnQgdHlwZSB7IFJlbmRlclRleHR1cmUsIHN5c3RlbXMsIFRleHR1cmUsIElTcHJpdGVNYXNrVGFyZ2V0IH0gZnJvbSAnQHBpeGkvY29yZSc7XG5cbi8qKlxuICogVGhlIERpc3BsYWNlbWVudEZpbHRlciBjbGFzcyB1c2VzIHRoZSBwaXhlbCB2YWx1ZXMgZnJvbSB0aGUgc3BlY2lmaWVkIHRleHR1cmVcbiAqIChjYWxsZWQgdGhlIGRpc3BsYWNlbWVudCBtYXApIHRvIHBlcmZvcm0gYSBkaXNwbGFjZW1lbnQgb2YgYW4gb2JqZWN0LlxuICpcbiAqIFlvdSBjYW4gdXNlIHRoaXMgZmlsdGVyIHRvIGFwcGx5IGFsbCBtYW5vciBvZiBjcmF6eSB3YXJwaW5nIGVmZmVjdHMuXG4gKiBDdXJyZW50bHkgdGhlIGByYCBwcm9wZXJ0eSBvZiB0aGUgdGV4dHVyZSBpcyB1c2VkIHRvIG9mZnNldCB0aGUgYHhgXG4gKiBhbmQgdGhlIGBnYCBwcm9wZXJ0eSBvZiB0aGUgdGV4dHVyZSBpcyB1c2VkIHRvIG9mZnNldCB0aGUgYHlgLlxuICpcbiAqIFRoZSB3YXkgaXQgd29ya3MgaXMgaXQgdXNlcyB0aGUgdmFsdWVzIG9mIHRoZSBkaXNwbGFjZW1lbnQgbWFwIHRvIGxvb2sgdXAgdGhlXG4gKiBjb3JyZWN0IHBpeGVscyB0byBvdXRwdXQuIFRoaXMgbWVhbnMgaXQncyBub3QgdGVjaG5pY2FsbHkgbW92aW5nIHRoZSBvcmlnaW5hbC5cbiAqIEluc3RlYWQsIGl0J3Mgc3RhcnRpbmcgYXQgdGhlIG91dHB1dCBhbmQgYXNraW5nIFwid2hpY2ggcGl4ZWwgZnJvbSB0aGUgb3JpZ2luYWwgZ29lcyBoZXJlXCIuXG4gKiBGb3IgZXhhbXBsZSwgaWYgYSBkaXNwbGFjZW1lbnQgbWFwIHBpeGVsIGhhcyBgcmVkID0gMWAgYW5kIHRoZSBmaWx0ZXIgc2NhbGUgaXMgYDIwYCxcbiAqIHRoaXMgZmlsdGVyIHdpbGwgb3V0cHV0IHRoZSBwaXhlbCBhcHByb3hpbWF0ZWx5IDIwIHBpeGVscyB0byB0aGUgcmlnaHQgb2YgdGhlIG9yaWdpbmFsLlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5GaWx0ZXJcbiAqIEBtZW1iZXJvZiBQSVhJLmZpbHRlcnNcbiAqL1xuZXhwb3J0IGNsYXNzIERpc3BsYWNlbWVudEZpbHRlciBleHRlbmRzIEZpbHRlclxue1xuICAgIHB1YmxpYyBtYXNrU3ByaXRlOiBJU3ByaXRlTWFza1RhcmdldDtcbiAgICBwdWJsaWMgbWFza01hdHJpeDogTWF0cml4O1xuICAgIHB1YmxpYyBzY2FsZTogUG9pbnQ7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuU3ByaXRlfSBzcHJpdGUgLSBUaGUgc3ByaXRlIHVzZWQgZm9yIHRoZSBkaXNwbGFjZW1lbnQgbWFwLiAobWFrZSBzdXJlIGl0cyBhZGRlZCB0byB0aGUgc2NlbmUhKVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc2NhbGVdIC0gVGhlIHNjYWxlIG9mIHRoZSBkaXNwbGFjZW1lbnRcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcHJpdGU6IElTcHJpdGVNYXNrVGFyZ2V0LCBzY2FsZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgY29uc3QgbWFza01hdHJpeCA9IG5ldyBNYXRyaXgoKTtcblxuICAgICAgICBzcHJpdGUucmVuZGVyYWJsZSA9IGZhbHNlO1xuXG4gICAgICAgIHN1cGVyKHZlcnRleCwgZnJhZ21lbnQsIHtcbiAgICAgICAgICAgIG1hcFNhbXBsZXI6IHNwcml0ZS5fdGV4dHVyZSxcbiAgICAgICAgICAgIGZpbHRlck1hdHJpeDogbWFza01hdHJpeCxcbiAgICAgICAgICAgIHNjYWxlOiB7IHg6IDEsIHk6IDEgfSxcbiAgICAgICAgICAgIHJvdGF0aW9uOiBuZXcgRmxvYXQzMkFycmF5KFsxLCAwLCAwLCAxXSksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubWFza1Nwcml0ZSA9IHNwcml0ZTtcbiAgICAgICAgdGhpcy5tYXNrTWF0cml4ID0gbWFza01hdHJpeDtcblxuICAgICAgICBpZiAoc2NhbGUgPT09IG51bGwgfHwgc2NhbGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAge1xuICAgICAgICAgICAgc2NhbGUgPSAyMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzY2FsZVgsIHNjYWxlWSBmb3IgZGlzcGxhY2VtZW50c1xuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlBvaW50fVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zY2FsZSA9IG5ldyBQb2ludChzY2FsZSwgc2NhbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIGZpbHRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbX0gZmlsdGVyTWFuYWdlciAtIFRoZSBtYW5hZ2VyLlxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJUZXh0dXJlfSBpbnB1dCAtIFRoZSBpbnB1dCB0YXJnZXQuXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlclRleHR1cmV9IG91dHB1dCAtIFRoZSBvdXRwdXQgdGFyZ2V0LlxuICAgICAqIEBwYXJhbSB7UElYSS5DTEVBUl9NT0RFU30gY2xlYXJNb2RlIC0gY2xlYXJNb2RlLlxuICAgICAqL1xuICAgIHB1YmxpYyBhcHBseShcbiAgICAgICAgZmlsdGVyTWFuYWdlcjogc3lzdGVtcy5GaWx0ZXJTeXN0ZW0sIGlucHV0OiBSZW5kZXJUZXh0dXJlLCBvdXRwdXQ6IFJlbmRlclRleHR1cmUsIGNsZWFyTW9kZTogQ0xFQVJfTU9ERVNcbiAgICApOiB2b2lkXG4gICAge1xuICAgICAgICAvLyBmaWxsIG1hc2tNYXRyaXggd2l0aCBfbm9ybWFsaXplZCBzcHJpdGUgdGV4dHVyZSBjb29yZHNfXG4gICAgICAgIHRoaXMudW5pZm9ybXMuZmlsdGVyTWF0cml4ID0gZmlsdGVyTWFuYWdlci5jYWxjdWxhdGVTcHJpdGVNYXRyaXgodGhpcy5tYXNrTWF0cml4LCB0aGlzLm1hc2tTcHJpdGUpO1xuICAgICAgICB0aGlzLnVuaWZvcm1zLnNjYWxlLnggPSB0aGlzLnNjYWxlLng7XG4gICAgICAgIHRoaXMudW5pZm9ybXMuc2NhbGUueSA9IHRoaXMuc2NhbGUueTtcblxuICAgICAgICAvLyBFeHRyYWN0IHJvdGF0aW9uIGZyb20gd29ybGQgdHJhbnNmb3JtXG4gICAgICAgIGNvbnN0IHd0ID0gdGhpcy5tYXNrU3ByaXRlLndvcmxkVHJhbnNmb3JtO1xuICAgICAgICBjb25zdCBsZW5YID0gTWF0aC5zcXJ0KCh3dC5hICogd3QuYSkgKyAod3QuYiAqIHd0LmIpKTtcbiAgICAgICAgY29uc3QgbGVuWSA9IE1hdGguc3FydCgod3QuYyAqIHd0LmMpICsgKHd0LmQgKiB3dC5kKSk7XG5cbiAgICAgICAgaWYgKGxlblggIT09IDAgJiYgbGVuWSAhPT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5yb3RhdGlvblswXSA9IHd0LmEgLyBsZW5YO1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5yb3RhdGlvblsxXSA9IHd0LmIgLyBsZW5YO1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5yb3RhdGlvblsyXSA9IHd0LmMgLyBsZW5ZO1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy5yb3RhdGlvblszXSA9IHd0LmQgLyBsZW5ZO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJhdyB0aGUgZmlsdGVyLi4uXG4gICAgICAgIGZpbHRlck1hbmFnZXIuYXBwbHlGaWx0ZXIodGhpcywgaW5wdXQsIG91dHB1dCwgY2xlYXJNb2RlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdGV4dHVyZSB1c2VkIGZvciB0aGUgZGlzcGxhY2VtZW50IG1hcC4gTXVzdCBiZSBwb3dlciBvZiAyIHNpemVkIHRleHR1cmUuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtQSVhJLlRleHR1cmV9XG4gICAgICovXG4gICAgZ2V0IG1hcCgpOiBUZXh0dXJlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy51bmlmb3Jtcy5tYXBTYW1wbGVyO1xuICAgIH1cblxuICAgIHNldCBtYXAodmFsdWU6IFRleHR1cmUpXG4gICAge1xuICAgICAgICB0aGlzLnVuaWZvcm1zLm1hcFNhbXBsZXIgPSB2YWx1ZTtcbiAgICB9XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgRmlsdGVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdmVydGV4IGZyb20gJy4vZnhhYS52ZXJ0JztcbmltcG9ydCBmcmFnbWVudCBmcm9tICcuL2Z4YWEuZnJhZyc7XG5cbi8qKlxuICogQmFzaWMgRlhBQSAoRmFzdCBBcHByb3hpbWF0ZSBBbnRpLUFsaWFzaW5nKSBpbXBsZW1lbnRhdGlvbiBiYXNlZCBvbiB0aGUgY29kZSBvbiBnZWVrczNkLmNvbVxuICogd2l0aCB0aGUgbW9kaWZpY2F0aW9uIHRoYXQgdGhlIHRleHR1cmUyRExvZCBzdHVmZiB3YXMgcmVtb3ZlZCBzaW5jZSBpdCBpcyB1bnN1cHBvcnRlZCBieSBXZWJHTC5cbiAqXG4gKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9taXRzdWhpa28vd2ViZ2wtbWVpbmNyYWZ0XG4gKlxuICogQGNsYXNzXG4gKiBAZXh0ZW5kcyBQSVhJLkZpbHRlclxuICogQG1lbWJlcm9mIFBJWEkuZmlsdGVyc1xuICpcbiAqL1xuZXhwb3J0IGNsYXNzIEZYQUFGaWx0ZXIgZXh0ZW5kcyBGaWx0ZXJcbntcbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICAvLyBUT0RPIC0gbmVlZHMgd29ya1xuICAgICAgICBzdXBlcih2ZXJ0ZXgsIGZyYWdtZW50KTtcbiAgICB9XG59XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgRmlsdGVyLCBkZWZhdWx0RmlsdGVyVmVydGV4IH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgZnJhZ21lbnQgZnJvbSAnLi9ub2lzZS5mcmFnJztcblxuLyoqXG4gKiBAYXV0aG9yIFZpY28gQHZpY29jb3RlYVxuICogb3JpZ2luYWwgZmlsdGVyOiBodHRwczovL2dpdGh1Yi5jb20vZXZhbncvZ2xmeC5qcy9ibG9iL21hc3Rlci9zcmMvZmlsdGVycy9hZGp1c3Qvbm9pc2UuanNcbiAqL1xuXG4vKipcbiAqIEEgTm9pc2UgZWZmZWN0IGZpbHRlci5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuRmlsdGVyXG4gKiBAbWVtYmVyb2YgUElYSS5maWx0ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBOb2lzZUZpbHRlciBleHRlbmRzIEZpbHRlclxue1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbbm9pc2U9MC41XSAtIFRoZSBub2lzZSBpbnRlbnNpdHksIHNob3VsZCBiZSBhIG5vcm1hbGl6ZWQgdmFsdWUgaW4gdGhlIHJhbmdlIFswLCAxXS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3NlZWRdIC0gQSByYW5kb20gc2VlZCBmb3IgdGhlIG5vaXNlIGdlbmVyYXRpb24uIERlZmF1bHQgaXMgYE1hdGgucmFuZG9tKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG5vaXNlID0gMC41LCBzZWVkID0gTWF0aC5yYW5kb20oKSlcbiAgICB7XG4gICAgICAgIHN1cGVyKGRlZmF1bHRGaWx0ZXJWZXJ0ZXgsIGZyYWdtZW50LCB7XG4gICAgICAgICAgICB1Tm9pc2U6IDAsXG4gICAgICAgICAgICB1U2VlZDogMCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2lzZSA9IG5vaXNlO1xuICAgICAgICB0aGlzLnNlZWQgPSBzZWVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBhbW91bnQgb2Ygbm9pc2UgdG8gYXBwbHksIHRoaXMgdmFsdWUgc2hvdWxkIGJlIGluIHRoZSByYW5nZSAoMCwgMV0uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICogQGRlZmF1bHQgMC41XG4gICAgICovXG4gICAgZ2V0IG5vaXNlKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudW5pZm9ybXMudU5vaXNlO1xuICAgIH1cblxuICAgIHNldCBub2lzZSh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy51bmlmb3Jtcy51Tm9pc2UgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHNlZWQgdmFsdWUgdG8gYXBwbHkgdG8gdGhlIHJhbmRvbSBub2lzZSBnZW5lcmF0aW9uLiBgTWF0aC5yYW5kb20oKWAgaXMgYSBnb29kIHZhbHVlIHRvIHVzZS5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgc2VlZCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaWZvcm1zLnVTZWVkO1xuICAgIH1cblxuICAgIHNldCBzZWVkKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLnVuaWZvcm1zLnVTZWVkID0gdmFsdWU7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRleHR1cmUsIEJhc2VUZXh0dXJlLCBSZW5kZXJUZXh0dXJlLCBSZW5kZXJlciwgTWFza0RhdGEgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFNwcml0ZSB9IGZyb20gJ0BwaXhpL3Nwcml0ZSc7XG5pbXBvcnQgeyBDb250YWluZXIsIERpc3BsYXlPYmplY3QsIElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuaW1wb3J0IHsgSVBvaW50RGF0YSwgTWF0cml4LCBSZWN0YW5nbGUgfSBmcm9tICdAcGl4aS9tYXRoJztcbmltcG9ydCB7IHVpZCB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSAnQHBpeGkvc2V0dGluZ3MnO1xuaW1wb3J0IHsgQ2FudmFzUmVuZGVyZXIgfSBmcm9tICdAcGl4aS9jYW52YXMtcmVuZGVyZXInO1xuXG5jb25zdCBfdGVtcE1hdHJpeCA9IG5ldyBNYXRyaXgoKTtcblxuRGlzcGxheU9iamVjdC5wcm90b3R5cGUuX2NhY2hlQXNCaXRtYXAgPSBmYWxzZTtcbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLl9jYWNoZURhdGEgPSBudWxsO1xuXG4vLyBmaWd1cmVkIHRoZXJlJ3Mgbm8gcG9pbnQgYWRkaW5nIEFMTCB0aGUgZXh0cmEgdmFyaWFibGVzIHRvIHByb3RvdHlwZS5cbi8vIHRoaXMgbW9kZWwgY2FuIGhvbGQgdGhlIGluZm9ybWF0aW9uIG5lZWRlZC4gVGhpcyBjYW4gYWxzbyBiZSBnZW5lcmF0ZWQgb24gZGVtYW5kIGFzXG4vLyBtb3N0IG9iamVjdHMgYXJlIG5vdCBjYWNoZWQgYXMgYml0bWFwcy5cbi8qKlxuICogQGNsYXNzXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBjbGFzcyBDYWNoZURhdGFcbntcbiAgICBwdWJsaWMgdGV4dHVyZUNhY2hlSWQ6IHN0cmluZztcbiAgICBwdWJsaWMgb3JpZ2luYWxSZW5kZXI6IChyZW5kZXJlcjogUmVuZGVyZXIpID0+IHZvaWQ7XG4gICAgcHVibGljIG9yaWdpbmFsUmVuZGVyQ2FudmFzOiAocmVuZGVyZXI6IENhbnZhc1JlbmRlcmVyKSA9PiB2b2lkO1xuICAgIHB1YmxpYyBvcmlnaW5hbENhbGN1bGF0ZUJvdW5kczogKCkgPT4gdm9pZDtcbiAgICBwdWJsaWMgb3JpZ2luYWxHZXRMb2NhbEJvdW5kczogKHJlY3Q/OiBSZWN0YW5nbGUpID0+IFJlY3RhbmdsZTtcbiAgICBwdWJsaWMgb3JpZ2luYWxVcGRhdGVUcmFuc2Zvcm06ICgpID0+IHZvaWQ7XG4gICAgcHVibGljIG9yaWdpbmFsRGVzdHJveTogKG9wdGlvbnM/OiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbikgPT4gdm9pZDtcbiAgICBwdWJsaWMgb3JpZ2luYWxNYXNrOiBDb250YWluZXJ8TWFza0RhdGE7XG4gICAgcHVibGljIG9yaWdpbmFsRmlsdGVyQXJlYTogUmVjdGFuZ2xlO1xuICAgIHB1YmxpYyBvcmlnaW5hbENvbnRhaW5zUG9pbnQ6IChwb2ludDogSVBvaW50RGF0YSkgPT4gYm9vbGVhbjtcbiAgICBwdWJsaWMgc3ByaXRlOiBTcHJpdGU7XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICB0aGlzLnRleHR1cmVDYWNoZUlkID0gbnVsbDtcblxuICAgICAgICB0aGlzLm9yaWdpbmFsUmVuZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbFJlbmRlckNhbnZhcyA9IG51bGw7XG4gICAgICAgIHRoaXMub3JpZ2luYWxDYWxjdWxhdGVCb3VuZHMgPSBudWxsO1xuICAgICAgICB0aGlzLm9yaWdpbmFsR2V0TG9jYWxCb3VuZHMgPSBudWxsO1xuXG4gICAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUcmFuc2Zvcm0gPSBudWxsO1xuICAgICAgICB0aGlzLm9yaWdpbmFsRGVzdHJveSA9IG51bGw7XG4gICAgICAgIHRoaXMub3JpZ2luYWxNYXNrID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbEZpbHRlckFyZWEgPSBudWxsO1xuICAgICAgICB0aGlzLm9yaWdpbmFsQ29udGFpbnNQb2ludCA9IG51bGw7XG4gICAgICAgIHRoaXMuc3ByaXRlID0gbnVsbDtcbiAgICB9XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKERpc3BsYXlPYmplY3QucHJvdG90eXBlLCB7XG4gICAgLyoqXG4gICAgICogU2V0IHRoaXMgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0aGlzIGRpc3BsYXkgb2JqZWN0IHRvIGJlIGNhY2hlZCBhcyBhIGJpdG1hcC5cbiAgICAgKiBUaGlzIGJhc2ljYWxseSB0YWtlcyBhIHNuYXAgc2hvdCBvZiB0aGUgZGlzcGxheSBvYmplY3QgYXMgaXQgaXMgYXQgdGhhdCBtb21lbnQuIEl0IGNhblxuICAgICAqIHByb3ZpZGUgYSBwZXJmb3JtYW5jZSBiZW5lZml0IGZvciBjb21wbGV4IHN0YXRpYyBkaXNwbGF5T2JqZWN0cy5cbiAgICAgKiBUbyByZW1vdmUgc2ltcGx5IHNldCB0aGlzIHByb3BlcnR5IHRvIGBmYWxzZWBcbiAgICAgKlxuICAgICAqIElNUE9SVEFOVCBHT1RDSEEgLSBNYWtlIHN1cmUgdGhhdCBhbGwgeW91ciB0ZXh0dXJlcyBhcmUgcHJlbG9hZGVkIEJFRk9SRSBzZXR0aW5nIHRoaXMgcHJvcGVydHkgdG8gdHJ1ZVxuICAgICAqIGFzIGl0IHdpbGwgdGFrZSBhIHNuYXBzaG90IG9mIHdoYXQgaXMgY3VycmVudGx5IHRoZXJlLiBJZiB0aGUgdGV4dHVyZXMgaGF2ZSBub3QgbG9hZGVkIHRoZW4gdGhleSB3aWxsIG5vdCBhcHBlYXIuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gICAgICovXG4gICAgY2FjaGVBc0JpdG1hcDoge1xuICAgICAgICBnZXQoKTogQ2FjaGVEYXRhXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZUFzQml0bWFwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQodmFsdWU6IENhY2hlRGF0YSk6IHZvaWRcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NhY2hlQXNCaXRtYXAgPT09IHZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY2FjaGVBc0JpdG1hcCA9IHZhbHVlO1xuXG4gICAgICAgICAgICBsZXQgZGF0YTogQ2FjaGVEYXRhO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jYWNoZURhdGEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZURhdGEgPSBuZXcgQ2FjaGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2NhY2hlRGF0YTtcblxuICAgICAgICAgICAgICAgIGRhdGEub3JpZ2luYWxSZW5kZXIgPSB0aGlzLnJlbmRlcjtcbiAgICAgICAgICAgICAgICBkYXRhLm9yaWdpbmFsUmVuZGVyQ2FudmFzID0gdGhpcy5yZW5kZXJDYW52YXM7XG5cbiAgICAgICAgICAgICAgICBkYXRhLm9yaWdpbmFsVXBkYXRlVHJhbnNmb3JtID0gdGhpcy51cGRhdGVUcmFuc2Zvcm07XG4gICAgICAgICAgICAgICAgZGF0YS5vcmlnaW5hbENhbGN1bGF0ZUJvdW5kcyA9IHRoaXMuY2FsY3VsYXRlQm91bmRzO1xuICAgICAgICAgICAgICAgIGRhdGEub3JpZ2luYWxHZXRMb2NhbEJvdW5kcyA9IHRoaXMuZ2V0TG9jYWxCb3VuZHM7XG5cbiAgICAgICAgICAgICAgICBkYXRhLm9yaWdpbmFsRGVzdHJveSA9IHRoaXMuZGVzdHJveTtcblxuICAgICAgICAgICAgICAgIGRhdGEub3JpZ2luYWxDb250YWluc1BvaW50ID0gdGhpcy5jb250YWluc1BvaW50O1xuXG4gICAgICAgICAgICAgICAgZGF0YS5vcmlnaW5hbE1hc2sgPSB0aGlzLl9tYXNrO1xuICAgICAgICAgICAgICAgIGRhdGEub3JpZ2luYWxGaWx0ZXJBcmVhID0gdGhpcy5maWx0ZXJBcmVhO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIgPSB0aGlzLl9yZW5kZXJDYWNoZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDYW52YXMgPSB0aGlzLl9yZW5kZXJDYWNoZWRDYW52YXM7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3kgPSB0aGlzLl9jYWNoZUFzQml0bWFwRGVzdHJveTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5fY2FjaGVEYXRhO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3ByaXRlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVzdHJveUNhY2hlZERpc3BsYXlPYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlciA9IGRhdGEub3JpZ2luYWxSZW5kZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJDYW52YXMgPSBkYXRhLm9yaWdpbmFsUmVuZGVyQ2FudmFzO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlQm91bmRzID0gZGF0YS5vcmlnaW5hbENhbGN1bGF0ZUJvdW5kcztcbiAgICAgICAgICAgICAgICB0aGlzLmdldExvY2FsQm91bmRzID0gZGF0YS5vcmlnaW5hbEdldExvY2FsQm91bmRzO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5kZXN0cm95ID0gZGF0YS5vcmlnaW5hbERlc3Ryb3k7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSA9IGRhdGEub3JpZ2luYWxVcGRhdGVUcmFuc2Zvcm07XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluc1BvaW50ID0gZGF0YS5vcmlnaW5hbENvbnRhaW5zUG9pbnQ7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9tYXNrID0gZGF0YS5vcmlnaW5hbE1hc2s7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJBcmVhID0gZGF0YS5vcmlnaW5hbEZpbHRlckFyZWE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSxcbn0pO1xuXG4vKipcbiAqIFJlbmRlcnMgYSBjYWNoZWQgdmVyc2lvbiBvZiB0aGUgc3ByaXRlIHdpdGggV2ViR0xcbiAqXG4gKiBAcHJpdmF0ZVxuICogQGZ1bmN0aW9uIF9yZW5kZXJDYWNoZWRcbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gdGhlIFdlYkdMIHJlbmRlcmVyXG4gKi9cbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLl9yZW5kZXJDYWNoZWQgPSBmdW5jdGlvbiBfcmVuZGVyQ2FjaGVkKHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbntcbiAgICBpZiAoIXRoaXMudmlzaWJsZSB8fCB0aGlzLndvcmxkQWxwaGEgPD0gMCB8fCAhdGhpcy5yZW5kZXJhYmxlKVxuICAgIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2luaXRDYWNoZWREaXNwbGF5T2JqZWN0KHJlbmRlcmVyKTtcblxuICAgIHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUudHJhbnNmb3JtLl93b3JsZElEID0gdGhpcy50cmFuc2Zvcm0uX3dvcmxkSUQ7XG4gICAgdGhpcy5fY2FjaGVEYXRhLnNwcml0ZS53b3JsZEFscGhhID0gdGhpcy53b3JsZEFscGhhO1xuICAgICh0aGlzLl9jYWNoZURhdGEuc3ByaXRlIGFzIGFueSkuX3JlbmRlcihyZW5kZXJlcik7XG59O1xuXG4vKipcbiAqIFByZXBhcmVzIHRoZSBXZWJHTCByZW5kZXJlciB0byBjYWNoZSB0aGUgc3ByaXRlXG4gKlxuICogQHByaXZhdGVcbiAqIEBmdW5jdGlvbiBfaW5pdENhY2hlZERpc3BsYXlPYmplY3RcbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gdGhlIFdlYkdMIHJlbmRlcmVyXG4gKi9cbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLl9pbml0Q2FjaGVkRGlzcGxheU9iamVjdCA9IGZ1bmN0aW9uIF9pbml0Q2FjaGVkRGlzcGxheU9iamVjdChyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG57XG4gICAgaWYgKHRoaXMuX2NhY2hlRGF0YSAmJiB0aGlzLl9jYWNoZURhdGEuc3ByaXRlKVxuICAgIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIG1ha2Ugc3VyZSBhbHBoYSBpcyBzZXQgdG8gMSBvdGhlcndpc2UgaXQgd2lsbCBnZXQgcmVuZGVyZWQgYXMgaW52aXNpYmxlIVxuICAgIGNvbnN0IGNhY2hlQWxwaGEgPSB0aGlzLmFscGhhO1xuXG4gICAgdGhpcy5hbHBoYSA9IDE7XG5cbiAgICAvLyBmaXJzdCB3ZSBmbHVzaCBhbnl0aGluZyBsZWZ0IGluIHRoZSByZW5kZXJlciAob3RoZXJ3aXNlIGl0IHdvdWxkIGdldCByZW5kZXJlZCB0byB0aGUgY2FjaGVkIHRleHR1cmUpXG4gICAgcmVuZGVyZXIuYmF0Y2guZmx1c2goKTtcbiAgICAvLyB0aGlzLmZpbHRlcnM9IFtdO1xuXG4gICAgLy8gbmV4dCB3ZSBmaW5kIHRoZSBkaW1lbnNpb25zIG9mIHRoZSB1bnRyYW5zZm9ybWVkIG9iamVjdFxuICAgIC8vIHRoaXMgZnVuY3Rpb24gYWxzbyBjYWxscyB1cGRhdGV0cmFuc2Zvcm0gb24gYWxsIGl0cyBjaGlsZHJlbiBhcyBwYXJ0IG9mIHRoZSBtZWFzdXJpbmcuXG4gICAgLy8gVGhpcyBtZWFucyB3ZSBkb24ndCBuZWVkIHRvIHVwZGF0ZSB0aGUgdHJhbnNmb3JtIGFnYWluIGluIHRoaXMgZnVuY3Rpb25cbiAgICAvLyBUT0RPIHBhc3MgYW4gb2JqZWN0IHRvIGNsb25lIHRvbz8gc2F2ZXMgaGF2aW5nIHRvIGNyZWF0ZSBhIG5ldyBvbmUgZWFjaCB0aW1lIVxuICAgIGNvbnN0IGJvdW5kcyA9ICh0aGlzIGFzIENvbnRhaW5lcikuZ2V0TG9jYWxCb3VuZHMobnVsbCwgdHJ1ZSkuY2xvbmUoKTtcblxuICAgIC8vIGFkZCBzb21lIHBhZGRpbmchXG4gICAgaWYgKHRoaXMuZmlsdGVycylcbiAgICB7XG4gICAgICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmZpbHRlcnNbMF0ucGFkZGluZztcblxuICAgICAgICBib3VuZHMucGFkKHBhZGRpbmcpO1xuICAgIH1cblxuICAgIGJvdW5kcy5jZWlsKHNldHRpbmdzLlJFU09MVVRJT04pO1xuXG4gICAgLy8gZm9yIG5vdyB3ZSBjYWNoZSB0aGUgY3VycmVudCByZW5kZXJUYXJnZXQgdGhhdCB0aGUgV2ViR0wgcmVuZGVyZXIgaXMgY3VycmVudGx5IHVzaW5nLlxuICAgIC8vIHRoaXMgY291bGQgYmUgbW9yZSBlbGVnYW50Li5cbiAgICBjb25zdCBjYWNoZWRSZW5kZXJUZXh0dXJlID0gcmVuZGVyZXIucmVuZGVyVGV4dHVyZS5jdXJyZW50O1xuICAgIGNvbnN0IGNhY2hlZFNvdXJjZUZyYW1lID0gcmVuZGVyZXIucmVuZGVyVGV4dHVyZS5zb3VyY2VGcmFtZS5jbG9uZSgpO1xuICAgIGNvbnN0IGNhY2hlZFByb2plY3Rpb25UcmFuc2Zvcm0gPSByZW5kZXJlci5wcm9qZWN0aW9uLnRyYW5zZm9ybTtcblxuICAgIC8vIFdlIGFsc28gc3RvcmUgdGhlIGZpbHRlciBzdGFjayAtIEkgd2lsbCBkZWZpbml0ZWx5IGxvb2sgdG8gY2hhbmdlIGhvdyB0aGlzIHdvcmtzIGEgbGl0dGxlIGxhdGVyIGRvd24gdGhlIGxpbmUuXG4gICAgLy8gY29uc3Qgc3RhY2sgPSByZW5kZXJlci5maWx0ZXJNYW5hZ2VyLmZpbHRlclN0YWNrO1xuXG4gICAgLy8gdGhpcyByZW5kZXJUZXh0dXJlIHdpbGwgYmUgdXNlZCB0byBzdG9yZSB0aGUgY2FjaGVkIERpc3BsYXlPYmplY3RcbiAgICBjb25zdCByZW5kZXJUZXh0dXJlID0gUmVuZGVyVGV4dHVyZS5jcmVhdGUoeyB3aWR0aDogYm91bmRzLndpZHRoLCBoZWlnaHQ6IGJvdW5kcy5oZWlnaHQgfSk7XG5cbiAgICBjb25zdCB0ZXh0dXJlQ2FjaGVJZCA9IGBjYWNoZUFzQml0bWFwXyR7dWlkKCl9YDtcblxuICAgIHRoaXMuX2NhY2hlRGF0YS50ZXh0dXJlQ2FjaGVJZCA9IHRleHR1cmVDYWNoZUlkO1xuXG4gICAgQmFzZVRleHR1cmUuYWRkVG9DYWNoZShyZW5kZXJUZXh0dXJlLmJhc2VUZXh0dXJlLCB0ZXh0dXJlQ2FjaGVJZCk7XG4gICAgVGV4dHVyZS5hZGRUb0NhY2hlKHJlbmRlclRleHR1cmUsIHRleHR1cmVDYWNoZUlkKTtcblxuICAgIC8vIG5lZWQgdG8gc2V0IC8vXG4gICAgY29uc3QgbSA9IHRoaXMudHJhbnNmb3JtLmxvY2FsVHJhbnNmb3JtLmNvcHlUbyhfdGVtcE1hdHJpeCkuaW52ZXJ0KCkudHJhbnNsYXRlKC1ib3VuZHMueCwgLWJvdW5kcy55KTtcblxuICAgIC8vIHNldCBhbGwgcHJvcGVydGllcyB0byB0aGVyZSBvcmlnaW5hbCBzbyB3ZSBjYW4gcmVuZGVyIHRvIGEgdGV4dHVyZVxuICAgIHRoaXMucmVuZGVyID0gdGhpcy5fY2FjaGVEYXRhLm9yaWdpbmFsUmVuZGVyO1xuXG4gICAgcmVuZGVyZXIucmVuZGVyKHRoaXMsIHJlbmRlclRleHR1cmUsIHRydWUsIG0sIGZhbHNlKTtcblxuICAgIC8vIG5vdyByZXN0b3JlIHRoZSBzdGF0ZSBiZSBzZXR0aW5nIHRoZSBuZXcgcHJvcGVydGllc1xuICAgIHJlbmRlcmVyLnByb2plY3Rpb24udHJhbnNmb3JtID0gY2FjaGVkUHJvamVjdGlvblRyYW5zZm9ybTtcbiAgICByZW5kZXJlci5yZW5kZXJUZXh0dXJlLmJpbmQoY2FjaGVkUmVuZGVyVGV4dHVyZSwgY2FjaGVkU291cmNlRnJhbWUpO1xuXG4gICAgLy8gcmVuZGVyZXIuZmlsdGVyTWFuYWdlci5maWx0ZXJTdGFjayA9IHN0YWNrO1xuXG4gICAgdGhpcy5yZW5kZXIgPSB0aGlzLl9yZW5kZXJDYWNoZWQ7XG4gICAgLy8gdGhlIHJlc3QgaXMgdGhlIHNhbWUgYXMgZm9yIENhbnZhc1xuICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtID0gdGhpcy5kaXNwbGF5T2JqZWN0VXBkYXRlVHJhbnNmb3JtO1xuICAgIHRoaXMuY2FsY3VsYXRlQm91bmRzID0gdGhpcy5fY2FsY3VsYXRlQ2FjaGVkQm91bmRzO1xuICAgIHRoaXMuZ2V0TG9jYWxCb3VuZHMgPSB0aGlzLl9nZXRDYWNoZWRMb2NhbEJvdW5kcztcblxuICAgIHRoaXMuX21hc2sgPSBudWxsO1xuICAgIHRoaXMuZmlsdGVyQXJlYSA9IG51bGw7XG5cbiAgICAvLyBjcmVhdGUgb3VyIGNhY2hlZCBzcHJpdGVcbiAgICBjb25zdCBjYWNoZWRTcHJpdGUgPSBuZXcgU3ByaXRlKHJlbmRlclRleHR1cmUpO1xuXG4gICAgY2FjaGVkU3ByaXRlLnRyYW5zZm9ybS53b3JsZFRyYW5zZm9ybSA9IHRoaXMudHJhbnNmb3JtLndvcmxkVHJhbnNmb3JtO1xuICAgIGNhY2hlZFNwcml0ZS5hbmNob3IueCA9IC0oYm91bmRzLnggLyBib3VuZHMud2lkdGgpO1xuICAgIGNhY2hlZFNwcml0ZS5hbmNob3IueSA9IC0oYm91bmRzLnkgLyBib3VuZHMuaGVpZ2h0KTtcbiAgICBjYWNoZWRTcHJpdGUuYWxwaGEgPSBjYWNoZUFscGhhO1xuICAgIGNhY2hlZFNwcml0ZS5fYm91bmRzID0gdGhpcy5fYm91bmRzO1xuXG4gICAgdGhpcy5fY2FjaGVEYXRhLnNwcml0ZSA9IGNhY2hlZFNwcml0ZTtcblxuICAgIHRoaXMudHJhbnNmb3JtLl9wYXJlbnRJRCA9IC0xO1xuICAgIC8vIHJlc3RvcmUgdGhlIHRyYW5zZm9ybSBvZiB0aGUgY2FjaGVkIHNwcml0ZSB0byBhdm9pZCB0aGUgbmFzdHkgZmxpY2tlci4uXG4gICAgaWYgKCF0aGlzLnBhcmVudClcbiAgICB7XG4gICAgICAgIHRoaXMuZW5hYmxlVGVtcFBhcmVudCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICB0aGlzLmRpc2FibGVUZW1wUGFyZW50KG51bGwpO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgIH1cblxuICAgIC8vIG1hcCB0aGUgaGl0IHRlc3QuLlxuICAgICh0aGlzIGFzIFNwcml0ZSkuY29udGFpbnNQb2ludCA9IGNhY2hlZFNwcml0ZS5jb250YWluc1BvaW50LmJpbmQoY2FjaGVkU3ByaXRlKTtcbn07XG5cbi8qKlxuICogUmVuZGVycyBhIGNhY2hlZCB2ZXJzaW9uIG9mIHRoZSBzcHJpdGUgd2l0aCBjYW52YXNcbiAqXG4gKiBAcHJpdmF0ZVxuICogQGZ1bmN0aW9uIF9yZW5kZXJDYWNoZWRDYW52YXNcbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAcGFyYW0ge1BJWEkuQ2FudmFzUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIGNhbnZhcyByZW5kZXJlclxuICovXG5EaXNwbGF5T2JqZWN0LnByb3RvdHlwZS5fcmVuZGVyQ2FjaGVkQ2FudmFzID0gZnVuY3Rpb24gX3JlbmRlckNhY2hlZENhbnZhcyhyZW5kZXJlcjogQ2FudmFzUmVuZGVyZXIpOiB2b2lkXG57XG4gICAgaWYgKCF0aGlzLnZpc2libGUgfHwgdGhpcy53b3JsZEFscGhhIDw9IDAgfHwgIXRoaXMucmVuZGVyYWJsZSlcbiAgICB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9pbml0Q2FjaGVkRGlzcGxheU9iamVjdENhbnZhcyhyZW5kZXJlcik7XG5cbiAgICB0aGlzLl9jYWNoZURhdGEuc3ByaXRlLndvcmxkQWxwaGEgPSB0aGlzLndvcmxkQWxwaGE7XG4gICAgKHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUgYXMgYW55KS5fcmVuZGVyQ2FudmFzKHJlbmRlcmVyKTtcbn07XG5cbi8vIFRPRE8gdGhpcyBjYW4gYmUgdGhlIHNhbWUgYXMgdGhlIFdlYkdMIHZlcnNpb24uLiB3aWxsIG5lZWQgdG8gZG8gYSBsaXR0bGUgdHdlYWtpbmcgZmlyc3QgdGhvdWdoLi5cbi8qKlxuICogUHJlcGFyZXMgdGhlIENhbnZhcyByZW5kZXJlciB0byBjYWNoZSB0aGUgc3ByaXRlXG4gKlxuICogQHByaXZhdGVcbiAqIEBmdW5jdGlvbiBfaW5pdENhY2hlZERpc3BsYXlPYmplY3RDYW52YXNcbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAcGFyYW0ge1BJWEkuQ2FudmFzUmVuZGVyZXJ9IHJlbmRlcmVyIC0gVGhlIGNhbnZhcyByZW5kZXJlclxuICovXG5EaXNwbGF5T2JqZWN0LnByb3RvdHlwZS5faW5pdENhY2hlZERpc3BsYXlPYmplY3RDYW52YXMgPSBmdW5jdGlvbiBfaW5pdENhY2hlZERpc3BsYXlPYmplY3RDYW52YXMoXG4gICAgcmVuZGVyZXI6IENhbnZhc1JlbmRlcmVyXG4pOiB2b2lkXG57XG4gICAgaWYgKHRoaXMuX2NhY2hlRGF0YSAmJiB0aGlzLl9jYWNoZURhdGEuc3ByaXRlKVxuICAgIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGdldCBib3VuZHMgYWN0dWFsbHkgdHJhbnNmb3JtcyB0aGUgb2JqZWN0IGZvciB1cyBhbHJlYWR5IVxuICAgIGNvbnN0IGJvdW5kcyA9ICh0aGlzIGFzIENvbnRhaW5lcikuZ2V0TG9jYWxCb3VuZHMobnVsbCwgdHJ1ZSk7XG5cbiAgICBjb25zdCBjYWNoZUFscGhhID0gdGhpcy5hbHBoYTtcblxuICAgIHRoaXMuYWxwaGEgPSAxO1xuXG4gICAgY29uc3QgY2FjaGVkUmVuZGVyVGFyZ2V0ID0gcmVuZGVyZXIuY29udGV4dDtcbiAgICBjb25zdCBjYWNoZWRQcm9qZWN0aW9uVHJhbnNmb3JtID0gKHJlbmRlcmVyIGFzIGFueSkuX3Byb2pUcmFuc2Zvcm07XG5cbiAgICBib3VuZHMuY2VpbChzZXR0aW5ncy5SRVNPTFVUSU9OKTtcblxuICAgIGNvbnN0IHJlbmRlclRleHR1cmUgPSBSZW5kZXJUZXh0dXJlLmNyZWF0ZSh7IHdpZHRoOiBib3VuZHMud2lkdGgsIGhlaWdodDogYm91bmRzLmhlaWdodCB9KTtcblxuICAgIGNvbnN0IHRleHR1cmVDYWNoZUlkID0gYGNhY2hlQXNCaXRtYXBfJHt1aWQoKX1gO1xuXG4gICAgdGhpcy5fY2FjaGVEYXRhLnRleHR1cmVDYWNoZUlkID0gdGV4dHVyZUNhY2hlSWQ7XG5cbiAgICBCYXNlVGV4dHVyZS5hZGRUb0NhY2hlKHJlbmRlclRleHR1cmUuYmFzZVRleHR1cmUsIHRleHR1cmVDYWNoZUlkKTtcbiAgICBUZXh0dXJlLmFkZFRvQ2FjaGUocmVuZGVyVGV4dHVyZSwgdGV4dHVyZUNhY2hlSWQpO1xuXG4gICAgLy8gbmVlZCB0byBzZXQgLy9cbiAgICBjb25zdCBtID0gX3RlbXBNYXRyaXg7XG5cbiAgICB0aGlzLnRyYW5zZm9ybS5sb2NhbFRyYW5zZm9ybS5jb3B5VG8obSk7XG4gICAgbS5pbnZlcnQoKTtcblxuICAgIG0udHggLT0gYm91bmRzLng7XG4gICAgbS50eSAtPSBib3VuZHMueTtcblxuICAgIC8vIG0uYXBwZW5kKHRoaXMudHJhbnNmb3JtLndvcmxkVHJhbnNmb3JtLilcbiAgICAvLyBzZXQgYWxsIHByb3BlcnRpZXMgdG8gdGhlcmUgb3JpZ2luYWwgc28gd2UgY2FuIHJlbmRlciB0byBhIHRleHR1cmVcbiAgICB0aGlzLnJlbmRlckNhbnZhcyA9IHRoaXMuX2NhY2hlRGF0YS5vcmlnaW5hbFJlbmRlckNhbnZhcztcblxuICAgIHJlbmRlcmVyLnJlbmRlcih0aGlzLCByZW5kZXJUZXh0dXJlLCB0cnVlLCBtLCBmYWxzZSk7XG4gICAgLy8gbm93IHJlc3RvcmUgdGhlIHN0YXRlIGJlIHNldHRpbmcgdGhlIG5ldyBwcm9wZXJ0aWVzXG4gICAgcmVuZGVyZXIuY29udGV4dCA9IGNhY2hlZFJlbmRlclRhcmdldDtcbiAgICAocmVuZGVyZXIgYXMgYW55KS5fcHJvalRyYW5zZm9ybSA9IGNhY2hlZFByb2plY3Rpb25UcmFuc2Zvcm07XG5cbiAgICB0aGlzLnJlbmRlckNhbnZhcyA9IHRoaXMuX3JlbmRlckNhY2hlZENhbnZhcztcbiAgICAvLyB0aGUgcmVzdCBpcyB0aGUgc2FtZSBhcyBmb3IgV2ViR0xcbiAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSA9IHRoaXMuZGlzcGxheU9iamVjdFVwZGF0ZVRyYW5zZm9ybTtcbiAgICB0aGlzLmNhbGN1bGF0ZUJvdW5kcyA9IHRoaXMuX2NhbGN1bGF0ZUNhY2hlZEJvdW5kcztcbiAgICB0aGlzLmdldExvY2FsQm91bmRzID0gdGhpcy5fZ2V0Q2FjaGVkTG9jYWxCb3VuZHM7XG5cbiAgICB0aGlzLl9tYXNrID0gbnVsbDtcbiAgICB0aGlzLmZpbHRlckFyZWEgPSBudWxsO1xuXG4gICAgLy8gY3JlYXRlIG91ciBjYWNoZWQgc3ByaXRlXG4gICAgY29uc3QgY2FjaGVkU3ByaXRlID0gbmV3IFNwcml0ZShyZW5kZXJUZXh0dXJlKTtcblxuICAgIGNhY2hlZFNwcml0ZS50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm0gPSB0aGlzLnRyYW5zZm9ybS53b3JsZFRyYW5zZm9ybTtcbiAgICBjYWNoZWRTcHJpdGUuYW5jaG9yLnggPSAtKGJvdW5kcy54IC8gYm91bmRzLndpZHRoKTtcbiAgICBjYWNoZWRTcHJpdGUuYW5jaG9yLnkgPSAtKGJvdW5kcy55IC8gYm91bmRzLmhlaWdodCk7XG4gICAgY2FjaGVkU3ByaXRlLmFscGhhID0gY2FjaGVBbHBoYTtcbiAgICBjYWNoZWRTcHJpdGUuX2JvdW5kcyA9IHRoaXMuX2JvdW5kcztcblxuICAgIHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUgPSBjYWNoZWRTcHJpdGU7XG5cbiAgICB0aGlzLnRyYW5zZm9ybS5fcGFyZW50SUQgPSAtMTtcbiAgICAvLyByZXN0b3JlIHRoZSB0cmFuc2Zvcm0gb2YgdGhlIGNhY2hlZCBzcHJpdGUgdG8gYXZvaWQgdGhlIG5hc3R5IGZsaWNrZXIuLlxuICAgIGlmICghdGhpcy5wYXJlbnQpXG4gICAge1xuICAgICAgICB0aGlzLnBhcmVudCA9IChyZW5kZXJlciBhcyBhbnkpLl90ZW1wRGlzcGxheU9iamVjdFBhcmVudDtcbiAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgIH1cblxuICAgIC8vIG1hcCB0aGUgaGl0IHRlc3QuLlxuICAgICh0aGlzIGFzIFNwcml0ZSkuY29udGFpbnNQb2ludCA9IGNhY2hlZFNwcml0ZS5jb250YWluc1BvaW50LmJpbmQoY2FjaGVkU3ByaXRlKTtcbn07XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgYm91bmRzIG9mIHRoZSBjYWNoZWQgc3ByaXRlXG4gKlxuICogQHByaXZhdGVcbiAqL1xuRGlzcGxheU9iamVjdC5wcm90b3R5cGUuX2NhbGN1bGF0ZUNhY2hlZEJvdW5kcyA9IGZ1bmN0aW9uIF9jYWxjdWxhdGVDYWNoZWRCb3VuZHMoKTogdm9pZFxue1xuICAgIHRoaXMuX2JvdW5kcy5jbGVhcigpO1xuICAgIHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUudHJhbnNmb3JtLl93b3JsZElEID0gdGhpcy50cmFuc2Zvcm0uX3dvcmxkSUQ7XG4gICAgKHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUgYXMgYW55KS5fY2FsY3VsYXRlQm91bmRzKCk7XG4gICAgdGhpcy5fYm91bmRzLnVwZGF0ZUlEID0gKHRoaXMgYXMgYW55KS5fYm91bmRzSUQ7XG59O1xuXG4vKipcbiAqIEdldHMgdGhlIGJvdW5kcyBvZiB0aGUgY2FjaGVkIHNwcml0ZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHJldHVybiB7UmVjdGFuZ2xlfSBUaGUgbG9jYWwgYm91bmRzLlxuICovXG5EaXNwbGF5T2JqZWN0LnByb3RvdHlwZS5fZ2V0Q2FjaGVkTG9jYWxCb3VuZHMgPSBmdW5jdGlvbiBfZ2V0Q2FjaGVkTG9jYWxCb3VuZHMoKTogUmVjdGFuZ2xlXG57XG4gICAgcmV0dXJuIHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUuZ2V0TG9jYWxCb3VuZHMobnVsbCk7XG59O1xuXG4vKipcbiAqIERlc3Ryb3lzIHRoZSBjYWNoZWQgc3ByaXRlLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLl9kZXN0cm95Q2FjaGVkRGlzcGxheU9iamVjdCA9IGZ1bmN0aW9uIF9kZXN0cm95Q2FjaGVkRGlzcGxheU9iamVjdCgpOiB2b2lkXG57XG4gICAgdGhpcy5fY2FjaGVEYXRhLnNwcml0ZS5fdGV4dHVyZS5kZXN0cm95KHRydWUpO1xuICAgIHRoaXMuX2NhY2hlRGF0YS5zcHJpdGUgPSBudWxsO1xuXG4gICAgQmFzZVRleHR1cmUucmVtb3ZlRnJvbUNhY2hlKHRoaXMuX2NhY2hlRGF0YS50ZXh0dXJlQ2FjaGVJZCk7XG4gICAgVGV4dHVyZS5yZW1vdmVGcm9tQ2FjaGUodGhpcy5fY2FjaGVEYXRhLnRleHR1cmVDYWNoZUlkKTtcblxuICAgIHRoaXMuX2NhY2hlRGF0YS50ZXh0dXJlQ2FjaGVJZCA9IG51bGw7XG59O1xuXG4vKipcbiAqIERlc3Ryb3lzIHRoZSBjYWNoZWQgb2JqZWN0LlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge29iamVjdHxib29sZWFufSBbb3B0aW9uc10gLSBPcHRpb25zIHBhcmFtZXRlci4gQSBib29sZWFuIHdpbGwgYWN0IGFzIGlmIGFsbCBvcHRpb25zXG4gKiAgaGF2ZSBiZWVuIHNldCB0byB0aGF0IHZhbHVlLlxuICogIFVzZWQgd2hlbiBkZXN0cm95aW5nIGNvbnRhaW5lcnMsIHNlZSB0aGUgQ29udGFpbmVyLmRlc3Ryb3kgbWV0aG9kLlxuICovXG5EaXNwbGF5T2JqZWN0LnByb3RvdHlwZS5fY2FjaGVBc0JpdG1hcERlc3Ryb3kgPSBmdW5jdGlvbiBfY2FjaGVBc0JpdG1hcERlc3Ryb3kob3B0aW9uczogSURlc3Ryb3lPcHRpb25zfGJvb2xlYW4pOiB2b2lkXG57XG4gICAgdGhpcy5jYWNoZUFzQml0bWFwID0gZmFsc2U7XG4gICAgdGhpcy5kZXN0cm95KG9wdGlvbnMpO1xufTtcbiIsICJpbXBvcnQgeyBEaXNwbGF5T2JqZWN0LCBDb250YWluZXIgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcblxuLyoqXG4gKiBUaGUgaW5zdGFuY2UgbmFtZSBvZiB0aGUgb2JqZWN0LlxuICpcbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAbWVtYmVyIHtzdHJpbmd9IG5hbWVcbiAqL1xuRGlzcGxheU9iamVjdC5wcm90b3R5cGUubmFtZSA9IG51bGw7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZGlzcGxheSBvYmplY3QgaW4gdGhlIGNvbnRhaW5lci5cbiAqXG4gKiBSZWN1cnNpdmUgc2VhcmNoZXMgYXJlIGRvbmUgaW4gYSBwcmVvcmRlciB0cmF2ZXJzYWwuXG4gKlxuICogQG1ldGhvZCBnZXRDaGlsZEJ5TmFtZVxuICogQG1lbWJlcm9mIFBJWEkuQ29udGFpbmVyI1xuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBJbnN0YW5jZSBuYW1lLlxuICogQHBhcmFtIHtib29sZWFufVtkZWVwPWZhbHNlXSAtIFdoZXRoZXIgdG8gc2VhcmNoIHJlY3Vyc2l2ZWx5XG4gKiBAcmV0dXJuIHtQSVhJLkRpc3BsYXlPYmplY3R9IFRoZSBjaGlsZCB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS5cbiAqL1xuQ29udGFpbmVyLnByb3RvdHlwZS5nZXRDaGlsZEJ5TmFtZSA9IGZ1bmN0aW9uIGdldENoaWxkQnlOYW1lKG5hbWU6IHN0cmluZywgZGVlcD86IGJvb2xlYW4pOiBEaXNwbGF5T2JqZWN0XG57XG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7IGkrKylcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLmNoaWxkcmVuW2ldLm5hbWUgPT09IG5hbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuW2ldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRlZXApXG4gICAge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgaiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgajsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9ICh0aGlzLmNoaWxkcmVuW2ldIGFzIENvbnRhaW5lcik7XG5cbiAgICAgICAgICAgIGlmICghY2hpbGQuZ2V0Q2hpbGRCeU5hbWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9ICh0aGlzLmNoaWxkcmVuW2ldIGFzIENvbnRhaW5lcikuZ2V0Q2hpbGRCeU5hbWUobmFtZSwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICh0YXJnZXQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xufTtcbiIsICJpbXBvcnQgeyBEaXNwbGF5T2JqZWN0IH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBQb2ludCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGdsb2JhbCBwb3NpdGlvbiBvZiB0aGUgZGlzcGxheU9iamVjdC4gRG9lcyBub3QgZGVwZW5kIG9uIG9iamVjdCBzY2FsZSwgcm90YXRpb24gYW5kIHBpdm90LlxuICpcbiAqIEBtZXRob2QgZ2V0R2xvYmFsUG9zaXRpb25cbiAqIEBtZW1iZXJvZiBQSVhJLkRpc3BsYXlPYmplY3QjXG4gKiBAcGFyYW0ge1BJWEkuUG9pbnR9IFtwb2ludD1uZXcgUElYSS5Qb2ludCgpXSAtIFRoZSBwb2ludCB0byB3cml0ZSB0aGUgZ2xvYmFsIHZhbHVlIHRvLlxuICogQHBhcmFtIHtib29sZWFufSBbc2tpcFVwZGF0ZT1mYWxzZV0gLSBTZXR0aW5nIHRvIHRydWUgd2lsbCBzdG9wIHRoZSB0cmFuc2Zvcm1zIG9mIHRoZSBzY2VuZSBncmFwaCBmcm9tXG4gKiAgYmVpbmcgdXBkYXRlZC4gVGhpcyBtZWFucyB0aGUgY2FsY3VsYXRpb24gcmV0dXJuZWQgTUFZIGJlIG91dCBvZiBkYXRlIEJVVCB3aWxsIGdpdmUgeW91IGFcbiAqICBuaWNlIHBlcmZvcm1hbmNlIGJvb3N0LlxuICogQHJldHVybiB7UElYSS5Qb2ludH0gVGhlIHVwZGF0ZWQgcG9pbnQuXG4gKi9cbkRpc3BsYXlPYmplY3QucHJvdG90eXBlLmdldEdsb2JhbFBvc2l0aW9uID0gZnVuY3Rpb24gZ2V0R2xvYmFsUG9zaXRpb24ocG9pbnQ6IFBvaW50ID0gbmV3IFBvaW50KCksIHNraXBVcGRhdGUgPSBmYWxzZSk6IFBvaW50XG57XG4gICAgaWYgKHRoaXMucGFyZW50KVxuICAgIHtcbiAgICAgICAgdGhpcy5wYXJlbnQudG9HbG9iYWwodGhpcy5wb3NpdGlvbiwgcG9pbnQsIHNraXBVcGRhdGUpO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICBwb2ludC54ID0gdGhpcy5wb3NpdGlvbi54O1xuICAgICAgICBwb2ludC55ID0gdGhpcy5wb3NpdGlvbi55O1xuICAgIH1cblxuICAgIHJldHVybiBwb2ludDtcbn07XG4iLCAiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgTWVzaEdlb21ldHJ5IH0gZnJvbSAnQHBpeGkvbWVzaCc7XG5cbmV4cG9ydCBjbGFzcyBQbGFuZUdlb21ldHJ5IGV4dGVuZHMgTWVzaEdlb21ldHJ5XG57XG4gICAgcHVibGljIHNlZ1dpZHRoOiBudW1iZXI7XG4gICAgcHVibGljIHNlZ0hlaWdodDogbnVtYmVyO1xuICAgIHB1YmxpYyB3aWR0aDogbnVtYmVyO1xuICAgIHB1YmxpYyBoZWlnaHQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHdpZHRoID0gMTAwLCBoZWlnaHQgPSAxMDAsIHNlZ1dpZHRoID0gMTAsIHNlZ0hlaWdodCA9IDEwKVxuICAgIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLnNlZ1dpZHRoID0gc2VnV2lkdGg7XG4gICAgICAgIHRoaXMuc2VnSGVpZ2h0ID0gc2VnSGVpZ2h0O1xuXG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5idWlsZCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZnJlc2hlcyBwbGFuZSBjb29yZGluYXRlc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgYnVpbGQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgdG90YWwgPSB0aGlzLnNlZ1dpZHRoICogdGhpcy5zZWdIZWlnaHQ7XG4gICAgICAgIGNvbnN0IHZlcnRzID0gW107XG4gICAgICAgIGNvbnN0IHV2cyA9IFtdO1xuICAgICAgICBjb25zdCBpbmRpY2VzID0gW107XG5cbiAgICAgICAgY29uc3Qgc2VnbWVudHNYID0gdGhpcy5zZWdXaWR0aCAtIDE7XG4gICAgICAgIGNvbnN0IHNlZ21lbnRzWSA9IHRoaXMuc2VnSGVpZ2h0IC0gMTtcblxuICAgICAgICBjb25zdCBzaXplWCA9ICh0aGlzLndpZHRoKSAvIHNlZ21lbnRzWDtcbiAgICAgICAgY29uc3Qgc2l6ZVkgPSAodGhpcy5oZWlnaHQpIC8gc2VnbWVudHNZO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWw7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeCA9IChpICUgdGhpcy5zZWdXaWR0aCk7XG4gICAgICAgICAgICBjb25zdCB5ID0gKChpIC8gdGhpcy5zZWdXaWR0aCkgfCAwKTtcblxuICAgICAgICAgICAgdmVydHMucHVzaCh4ICogc2l6ZVgsIHkgKiBzaXplWSk7XG4gICAgICAgICAgICB1dnMucHVzaCh4IC8gc2VnbWVudHNYLCB5IC8gc2VnbWVudHNZKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRvdGFsU3ViID0gc2VnbWVudHNYICogc2VnbWVudHNZO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWxTdWI7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgeHBvcyA9IGkgJSBzZWdtZW50c1g7XG4gICAgICAgICAgICBjb25zdCB5cG9zID0gKGkgLyBzZWdtZW50c1gpIHwgMDtcblxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSAoeXBvcyAqIHRoaXMuc2VnV2lkdGgpICsgeHBvcztcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlMiA9ICh5cG9zICogdGhpcy5zZWdXaWR0aCkgKyB4cG9zICsgMTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlMyA9ICgoeXBvcyArIDEpICogdGhpcy5zZWdXaWR0aCkgKyB4cG9zO1xuICAgICAgICAgICAgY29uc3QgdmFsdWU0ID0gKCh5cG9zICsgMSkgKiB0aGlzLnNlZ1dpZHRoKSArIHhwb3MgKyAxO1xuXG4gICAgICAgICAgICBpbmRpY2VzLnB1c2godmFsdWUsIHZhbHVlMiwgdmFsdWUzLFxuICAgICAgICAgICAgICAgIHZhbHVlMiwgdmFsdWU0LCB2YWx1ZTMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idWZmZXJzWzBdLmRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHZlcnRzKTtcbiAgICAgICAgdGhpcy5idWZmZXJzWzFdLmRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHV2cyk7XG4gICAgICAgIHRoaXMuaW5kZXhCdWZmZXIuZGF0YSA9IG5ldyBVaW50MTZBcnJheShpbmRpY2VzKTtcblxuICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUgY2hhbmdlcyBhcmUgdXBsb2FkZWRcbiAgICAgICAgdGhpcy5idWZmZXJzWzBdLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmJ1ZmZlcnNbMV0udXBkYXRlKCk7XG4gICAgICAgIHRoaXMuaW5kZXhCdWZmZXIudXBkYXRlKCk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IE1lc2hHZW9tZXRyeSB9IGZyb20gJ0BwaXhpL21lc2gnO1xuaW1wb3J0IHR5cGUgeyBJUG9pbnQgfSBmcm9tICdAcGl4aS9tYXRoJztcblxuLyoqXG4gKiBSb3BlR2VvbWV0cnkgYWxsb3dzIHlvdSB0byBkcmF3IGEgZ2VvbWV0cnkgYWNyb3NzIHNldmVyYWwgcG9pbnRzIGFuZCB0aGVuIG1hbmlwdWxhdGUgdGhlc2UgcG9pbnRzLlxuICpcbiAqIGBgYGpzXG4gKiBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAqICAgICBwb2ludHMucHVzaChuZXcgUElYSS5Qb2ludChpICogNTAsIDApKTtcbiAqIH07XG4gKiBjb25zdCByb3BlID0gbmV3IFBJWEkuUm9wZUdlb21ldHJ5KDEwMCwgcG9pbnRzKTtcbiAqIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5NZXNoR2VvbWV0cnlcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKlxuICovXG5leHBvcnQgY2xhc3MgUm9wZUdlb21ldHJ5IGV4dGVuZHMgTWVzaEdlb21ldHJ5XG57XG4gICAgcHVibGljIHBvaW50czogSVBvaW50W107XG4gICAgcHVibGljIHJlYWRvbmx5IHRleHR1cmVTY2FsZTogbnVtYmVyO1xuICAgIF93aWR0aDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt3aWR0aD0yMDBdIC0gVGhlIHdpZHRoIChpLmUuLCB0aGlja25lc3MpIG9mIHRoZSByb3BlLlxuICAgICAqIEBwYXJhbSB7UElYSS5Qb2ludFtdfSBbcG9pbnRzXSAtIEFuIGFycmF5IG9mIHtAbGluayBQSVhJLlBvaW50fSBvYmplY3RzIHRvIGNvbnN0cnVjdCB0aGlzIHJvcGUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt0ZXh0dXJlU2NhbGU9MF0gLSBCeSBkZWZhdWx0IHRoZSByb3BlIHRleHR1cmUgd2lsbCBiZSBzdHJldGNoZWQgdG8gbWF0Y2hcbiAgICAgKiAgICAgcm9wZSBsZW5ndGguIElmIHRleHR1cmVTY2FsZSBpcyBwb3NpdGl2ZSB0aGlzIHZhbHVlIHdpbGwgYmUgdHJlYXRlZCBhcyBhIHNjYWxpbmdcbiAgICAgKiAgICAgZmFjdG9yIGFuZCB0aGUgdGV4dHVyZSB3aWxsIHByZXNlcnZlIGl0cyBhc3BlY3QgcmF0aW8gaW5zdGVhZC4gVG8gY3JlYXRlIGEgdGlsaW5nIHJvcGVcbiAgICAgKiAgICAgc2V0IGJhc2VUZXh0dXJlLndyYXBNb2RlIHRvIHtAbGluayBQSVhJLldSQVBfTU9ERVMuUkVQRUFUfSBhbmQgdXNlIGEgcG93ZXIgb2YgdHdvIHRleHR1cmUsXG4gICAgICogICAgIHRoZW4gc2V0IHRleHR1cmVTY2FsZT0xIHRvIGtlZXAgdGhlIG9yaWdpbmFsIHRleHR1cmUgcGl4ZWwgc2l6ZS5cbiAgICAgKiAgICAgSW4gb3JkZXIgdG8gcmVkdWNlIGFscGhhIGNoYW5uZWwgYXJ0aWZhY3RzIHByb3ZpZGUgYSBsYXJnZXIgdGV4dHVyZSBhbmQgZG93bnNhbXBsZSAtXG4gICAgICogICAgIGkuZS4gc2V0IHRleHR1cmVTY2FsZT0wLjUgdG8gc2NhbGUgaXQgZG93biB0d2ljZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih3aWR0aCA9IDIwMCwgcG9pbnRzOiBJUG9pbnRbXSwgdGV4dHVyZVNjYWxlID0gMClcbiAgICB7XG4gICAgICAgIHN1cGVyKG5ldyBGbG9hdDMyQXJyYXkocG9pbnRzLmxlbmd0aCAqIDQpLFxuICAgICAgICAgICAgbmV3IEZsb2F0MzJBcnJheShwb2ludHMubGVuZ3RoICogNCksXG4gICAgICAgICAgICBuZXcgVWludDE2QXJyYXkoKHBvaW50cy5sZW5ndGggLSAxKSAqIDYpKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gYXJyYXkgb2YgcG9pbnRzIHRoYXQgZGV0ZXJtaW5lIHRoZSByb3BlXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuUG9pbnRbXX1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgd2lkdGggKGkuZS4sIHRoaWNrbmVzcykgb2YgdGhlIHJvcGUuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRPbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl93aWR0aCA9IHdpZHRoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSb3BlIHRleHR1cmUgc2NhbGUsIGlmIHplcm8gdGhlbiB0aGUgcm9wZSB0ZXh0dXJlIGlzIHN0cmV0Y2hlZC5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcmVhZE9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGV4dHVyZVNjYWxlID0gdGV4dHVyZVNjYWxlO1xuXG4gICAgICAgIHRoaXMuYnVpbGQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggKGkuZS4sIHRoaWNrbmVzcykgb2YgdGhlIHJvcGUuXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEByZWFkT25seVxuICAgICAqL1xuICAgIGdldCB3aWR0aCgpOiBudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWR0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWZyZXNoZXMgUm9wZSBpbmRpY2VzIGFuZCB1dnNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gdGhpcy5wb2ludHM7XG5cbiAgICAgICAgaWYgKCFwb2ludHMpIHJldHVybjtcblxuICAgICAgICBjb25zdCB2ZXJ0ZXhCdWZmZXIgPSB0aGlzLmdldEJ1ZmZlcignYVZlcnRleFBvc2l0aW9uJyk7XG4gICAgICAgIGNvbnN0IHV2QnVmZmVyID0gdGhpcy5nZXRCdWZmZXIoJ2FUZXh0dXJlQ29vcmQnKTtcbiAgICAgICAgY29uc3QgaW5kZXhCdWZmZXIgPSB0aGlzLmdldEluZGV4KCk7XG5cbiAgICAgICAgLy8gaWYgdG9vIGxpdHRsZSBwb2ludHMsIG9yIHRleHR1cmUgaGFzbid0IGdvdCBVVnMgc2V0IHlldCBqdXN0IG1vdmUgb24uXG4gICAgICAgIGlmIChwb2ludHMubGVuZ3RoIDwgMSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIG51bWJlciBvZiBwb2ludHMgaGFzIGNoYW5nZWQgd2Ugd2lsbCBuZWVkIHRvIHJlY3JlYXRlIHRoZSBhcnJheWJ1ZmZlcnNcbiAgICAgICAgaWYgKHZlcnRleEJ1ZmZlci5kYXRhLmxlbmd0aCAvIDQgIT09IHBvaW50cy5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZlcnRleEJ1ZmZlci5kYXRhID0gbmV3IEZsb2F0MzJBcnJheShwb2ludHMubGVuZ3RoICogNCk7XG4gICAgICAgICAgICB1dkJ1ZmZlci5kYXRhID0gbmV3IEZsb2F0MzJBcnJheShwb2ludHMubGVuZ3RoICogNCk7XG4gICAgICAgICAgICBpbmRleEJ1ZmZlci5kYXRhID0gbmV3IFVpbnQxNkFycmF5KChwb2ludHMubGVuZ3RoIC0gMSkgKiA2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHV2cyA9IHV2QnVmZmVyLmRhdGE7XG4gICAgICAgIGNvbnN0IGluZGljZXMgPSBpbmRleEJ1ZmZlci5kYXRhO1xuXG4gICAgICAgIHV2c1swXSA9IDA7XG4gICAgICAgIHV2c1sxXSA9IDA7XG4gICAgICAgIHV2c1syXSA9IDA7XG4gICAgICAgIHV2c1szXSA9IDE7XG5cbiAgICAgICAgbGV0IGFtb3VudCA9IDA7XG4gICAgICAgIGxldCBwcmV2ID0gcG9pbnRzWzBdO1xuICAgICAgICBjb25zdCB0ZXh0dXJlV2lkdGggPSB0aGlzLl93aWR0aCAqIHRoaXMudGV4dHVyZVNjYWxlO1xuICAgICAgICBjb25zdCB0b3RhbCA9IHBvaW50cy5sZW5ndGg7IC8vIC0gMTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIHRpbWUgdG8gZG8gc29tZSBzbWFydCBkcmF3aW5nIVxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBpICogNDtcblxuICAgICAgICAgICAgaWYgKHRoaXMudGV4dHVyZVNjYWxlID4gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgcGl4ZWwgZGlzdGFuY2UgZnJvbSBwcmV2aW91cyBwb2ludFxuICAgICAgICAgICAgICAgIGNvbnN0IGR4ID0gcHJldi54IC0gcG9pbnRzW2ldLng7XG4gICAgICAgICAgICAgICAgY29uc3QgZHkgPSBwcmV2LnkgLSBwb2ludHNbaV0ueTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguc3FydCgoZHggKiBkeCkgKyAoZHkgKiBkeSkpO1xuXG4gICAgICAgICAgICAgICAgcHJldiA9IHBvaW50c1tpXTtcbiAgICAgICAgICAgICAgICBhbW91bnQgKz0gZGlzdGFuY2UgLyB0ZXh0dXJlV2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gc3RyZXRjaCB0ZXh0dXJlXG4gICAgICAgICAgICAgICAgYW1vdW50ID0gaSAvICh0b3RhbCAtIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB1dnNbaW5kZXhdID0gYW1vdW50O1xuICAgICAgICAgICAgdXZzW2luZGV4ICsgMV0gPSAwO1xuXG4gICAgICAgICAgICB1dnNbaW5kZXggKyAyXSA9IGFtb3VudDtcbiAgICAgICAgICAgIHV2c1tpbmRleCArIDNdID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpbmRleENvdW50ID0gMDtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsIC0gMTsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGkgKiAyO1xuXG4gICAgICAgICAgICBpbmRpY2VzW2luZGV4Q291bnQrK10gPSBpbmRleDtcbiAgICAgICAgICAgIGluZGljZXNbaW5kZXhDb3VudCsrXSA9IGluZGV4ICsgMTtcbiAgICAgICAgICAgIGluZGljZXNbaW5kZXhDb3VudCsrXSA9IGluZGV4ICsgMjtcblxuICAgICAgICAgICAgaW5kaWNlc1tpbmRleENvdW50KytdID0gaW5kZXggKyAyO1xuICAgICAgICAgICAgaW5kaWNlc1tpbmRleENvdW50KytdID0gaW5kZXggKyAxO1xuICAgICAgICAgICAgaW5kaWNlc1tpbmRleENvdW50KytdID0gaW5kZXggKyAzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgdGhlIGNoYW5nZXMgYXJlIHVwbG9hZGVkXG4gICAgICAgIHV2QnVmZmVyLnVwZGF0ZSgpO1xuICAgICAgICBpbmRleEJ1ZmZlci51cGRhdGUoKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVZlcnRpY2VzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmVmcmVzaGVzIHZlcnRpY2VzIG9mIFJvcGUgbWVzaFxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVWZXJ0aWNlcygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBwb2ludHMgPSB0aGlzLnBvaW50cztcblxuICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCA8IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBsYXN0UG9pbnQgPSBwb2ludHNbMF07XG4gICAgICAgIGxldCBuZXh0UG9pbnQ7XG4gICAgICAgIGxldCBwZXJwWCA9IDA7XG4gICAgICAgIGxldCBwZXJwWSA9IDA7XG5cbiAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLmJ1ZmZlcnNbMF0uZGF0YTtcbiAgICAgICAgY29uc3QgdG90YWwgPSBwb2ludHMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWw7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcG9pbnQgPSBwb2ludHNbaV07XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGkgKiA0O1xuXG4gICAgICAgICAgICBpZiAoaSA8IHBvaW50cy5sZW5ndGggLSAxKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5leHRQb2ludCA9IHBvaW50c1tpICsgMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmV4dFBvaW50ID0gcG9pbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBlcnBZID0gLShuZXh0UG9pbnQueCAtIGxhc3RQb2ludC54KTtcbiAgICAgICAgICAgIHBlcnBYID0gbmV4dFBvaW50LnkgLSBsYXN0UG9pbnQueTtcblxuICAgICAgICAgICAgbGV0IHJhdGlvID0gKDEgLSAoaSAvICh0b3RhbCAtIDEpKSkgKiAxMDtcblxuICAgICAgICAgICAgaWYgKHJhdGlvID4gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByYXRpbyA9IDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHBlcnBMZW5ndGggPSBNYXRoLnNxcnQoKHBlcnBYICogcGVycFgpICsgKHBlcnBZICogcGVycFkpKTtcbiAgICAgICAgICAgIGNvbnN0IG51bSA9IHRoaXMudGV4dHVyZVNjYWxlID4gMCA/IHRoaXMudGV4dHVyZVNjYWxlICogdGhpcy5fd2lkdGggLyAyIDogdGhpcy5fd2lkdGggLyAyO1xuXG4gICAgICAgICAgICBwZXJwWCAvPSBwZXJwTGVuZ3RoO1xuICAgICAgICAgICAgcGVycFkgLz0gcGVycExlbmd0aDtcblxuICAgICAgICAgICAgcGVycFggKj0gbnVtO1xuICAgICAgICAgICAgcGVycFkgKj0gbnVtO1xuXG4gICAgICAgICAgICB2ZXJ0aWNlc1tpbmRleF0gPSBwb2ludC54ICsgcGVycFg7XG4gICAgICAgICAgICB2ZXJ0aWNlc1tpbmRleCArIDFdID0gcG9pbnQueSArIHBlcnBZO1xuICAgICAgICAgICAgdmVydGljZXNbaW5kZXggKyAyXSA9IHBvaW50LnggLSBwZXJwWDtcbiAgICAgICAgICAgIHZlcnRpY2VzW2luZGV4ICsgM10gPSBwb2ludC55IC0gcGVycFk7XG5cbiAgICAgICAgICAgIGxhc3RQb2ludCA9IHBvaW50O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idWZmZXJzWzBdLnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dHVyZVNjYWxlID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5idWlsZCgpOyAvLyB3ZSBuZWVkIHRvIHVwZGF0ZSBVVnNcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVmVydGljZXMoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBNZXNoLCBNZXNoTWF0ZXJpYWwgfSBmcm9tICdAcGl4aS9tZXNoJztcbmltcG9ydCB7IFdSQVBfTU9ERVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgUm9wZUdlb21ldHJ5IH0gZnJvbSAnLi9nZW9tZXRyeS9Sb3BlR2VvbWV0cnknO1xuXG5pbXBvcnQgdHlwZSB7IFRleHR1cmUsIFJlbmRlcmVyIH0gZnJvbSAnQHBpeGkvY29yZSc7XG5pbXBvcnQgdHlwZSB7IElQb2ludCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuXG4vKipcbiAqIFRoZSByb3BlIGFsbG93cyB5b3UgdG8gZHJhdyBhIHRleHR1cmUgYWNyb3NzIHNldmVyYWwgcG9pbnRzIGFuZCB0aGVuIG1hbmlwdWxhdGUgdGhlc2UgcG9pbnRzXG4gKlxuICpgYGBqc1xuICogZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gKiAgICAgcG9pbnRzLnB1c2gobmV3IFBJWEkuUG9pbnQoaSAqIDUwLCAwKSk7XG4gKiB9O1xuICogbGV0IHJvcGUgPSBuZXcgUElYSS5TaW1wbGVSb3BlKFBJWEkuVGV4dHVyZS5mcm9tKFwic25ha2UucG5nXCIpLCBwb2ludHMpO1xuICogIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5NZXNoXG4gKiBAbWVtYmVyb2YgUElYSVxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIFNpbXBsZVJvcGUgZXh0ZW5kcyBNZXNoXG57XG4gICAgcHVibGljIGF1dG9VcGRhdGU6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gdGV4dHVyZSAtIFRoZSB0ZXh0dXJlIHRvIHVzZSBvbiB0aGUgcm9wZS5cbiAgICAgKiBAcGFyYW0ge1BJWEkuUG9pbnRbXX0gcG9pbnRzIC0gQW4gYXJyYXkgb2Yge0BsaW5rIFBJWEkuUG9pbnR9IG9iamVjdHMgdG8gY29uc3RydWN0IHRoaXMgcm9wZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3RleHR1cmVTY2FsZT0wXSAtIE9wdGlvbmFsLiBQb3NpdGl2ZSB2YWx1ZXMgc2NhbGUgcm9wZSB0ZXh0dXJlXG4gICAgICoga2VlcGluZyBpdHMgYXNwZWN0IHJhdGlvLiBZb3UgY2FuIHJlZHVjZSBhbHBoYSBjaGFubmVsIGFydGlmYWN0cyBieSBwcm92aWRpbmcgYSBsYXJnZXIgdGV4dHVyZVxuICAgICAqIGFuZCBkb3duc2FtcGxpbmcgaGVyZS4gSWYgc2V0IHRvIHplcm8sIHRleHR1cmUgd2lsbCBiZSBzdHJlY2hlZCBpbnN0ZWFkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRleHR1cmU6IFRleHR1cmUsIHBvaW50czogSVBvaW50W10sIHRleHR1cmVTY2FsZSA9IDApXG4gICAge1xuICAgICAgICBjb25zdCByb3BlR2VvbWV0cnkgPSBuZXcgUm9wZUdlb21ldHJ5KHRleHR1cmUuaGVpZ2h0LCBwb2ludHMsIHRleHR1cmVTY2FsZSk7XG4gICAgICAgIGNvbnN0IG1lc2hNYXRlcmlhbCA9IG5ldyBNZXNoTWF0ZXJpYWwodGV4dHVyZSk7XG5cbiAgICAgICAgaWYgKHRleHR1cmVTY2FsZSA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGF0dGVtcHQgdG8gc2V0IFVWIHdyYXBwaW5nLCB3aWxsIGZhaWwgb24gbm9uLXBvd2VyIG9mIHR3byB0ZXh0dXJlc1xuICAgICAgICAgICAgdGV4dHVyZS5iYXNlVGV4dHVyZS53cmFwTW9kZSA9IFdSQVBfTU9ERVMuUkVQRUFUO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKHJvcGVHZW9tZXRyeSwgbWVzaE1hdGVyaWFsKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmUtY2FsY3VsYXRlIHZlcnRpY2VzIGJ5IHJvcGUgcG9pbnRzIGVhY2ggZnJhbWVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYXV0b1VwZGF0ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgX3JlbmRlcihyZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCBnZW9tZXRyeTogUm9wZUdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeSBhcyBhbnk7XG5cbiAgICAgICAgaWYgKHRoaXMuYXV0b1VwZGF0ZSB8fCBnZW9tZXRyeS5fd2lkdGggIT09IHRoaXMuc2hhZGVyLnRleHR1cmUuaGVpZ2h0KVxuICAgICAgICB7XG4gICAgICAgICAgICBnZW9tZXRyeS5fd2lkdGggPSB0aGlzLnNoYWRlci50ZXh0dXJlLmhlaWdodDtcbiAgICAgICAgICAgIGdlb21ldHJ5LnVwZGF0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuX3JlbmRlcihyZW5kZXJlcik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IE1lc2gsIE1lc2hNYXRlcmlhbCB9IGZyb20gJ0BwaXhpL21lc2gnO1xuaW1wb3J0IHsgUGxhbmVHZW9tZXRyeSB9IGZyb20gJy4vZ2VvbWV0cnkvUGxhbmVHZW9tZXRyeSc7XG5cbmltcG9ydCB0eXBleyBSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBJRGVzdHJveU9wdGlvbnMgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcblxuLyoqXG4gKiBUaGUgU2ltcGxlUGxhbmUgYWxsb3dzIHlvdSB0byBkcmF3IGEgdGV4dHVyZSBhY3Jvc3Mgc2V2ZXJhbCBwb2ludHMgYW5kIHRoZW4gbWFuaXB1bGF0ZSB0aGVzZSBwb2ludHNcbiAqXG4gKmBgYGpzXG4gKiBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAqICAgICBwb2ludHMucHVzaChuZXcgUElYSS5Qb2ludChpICogNTAsIDApKTtcbiAqIH07XG4gKiBsZXQgU2ltcGxlUGxhbmUgPSBuZXcgUElYSS5TaW1wbGVQbGFuZShQSVhJLlRleHR1cmUuZnJvbShcInNuYWtlLnBuZ1wiKSwgcG9pbnRzKTtcbiAqICBgYGBcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuTWVzaFxuICogQG1lbWJlcm9mIFBJWElcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVQbGFuZSBleHRlbmRzIE1lc2hcbntcbiAgICBwcm90ZWN0ZWQgX3RleHR1cmVJRDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmV9IHRleHR1cmUgLSBUaGUgdGV4dHVyZSB0byB1c2Ugb24gdGhlIFNpbXBsZVBsYW5lLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2ZXJ0aWNlc1ggLSBUaGUgbnVtYmVyIG9mIHZlcnRpY2VzIGluIHRoZSB4LWF4aXNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmVydGljZXNZIC0gVGhlIG51bWJlciBvZiB2ZXJ0aWNlcyBpbiB0aGUgeS1heGlzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodGV4dHVyZTogVGV4dHVyZSwgdmVydGljZXNYOiBudW1iZXIsIHZlcnRpY2VzWTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgY29uc3QgcGxhbmVHZW9tZXRyeSA9IG5ldyBQbGFuZUdlb21ldHJ5KHRleHR1cmUud2lkdGgsIHRleHR1cmUuaGVpZ2h0LCB2ZXJ0aWNlc1gsIHZlcnRpY2VzWSk7XG4gICAgICAgIGNvbnN0IG1lc2hNYXRlcmlhbCA9IG5ldyBNZXNoTWF0ZXJpYWwoVGV4dHVyZS5XSElURSk7XG5cbiAgICAgICAgc3VwZXIocGxhbmVHZW9tZXRyeSwgbWVzaE1hdGVyaWFsKTtcblxuICAgICAgICAvLyBsZXRzIGNhbGwgdGhlIHNldHRlciB0byBlbnN1cmUgYWxsIG5lY2Vzc2FyeSB1cGRhdGVzIGFyZSBwZXJmb3JtZWRcbiAgICAgICAgdGhpcy50ZXh0dXJlID0gdGV4dHVyZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdXNlZCBmb3Igb3ZlcnJpZGVzLCB0byBkbyBzb21ldGhpbmcgaW4gY2FzZSB0ZXh0dXJlIGZyYW1lIHdhcyBjaGFuZ2VkLlxuICAgICAqIE1lc2hlcyBiYXNlZCBvbiBwbGFuZSBjYW4gb3ZlcnJpZGUgaXQgYW5kIGNoYW5nZSBtb3JlIGRldGFpbHMgYmFzZWQgb24gdGV4dHVyZS5cbiAgICAgKi9cbiAgICBwdWJsaWMgdGV4dHVyZVVwZGF0ZWQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gdGhpcy5zaGFkZXIudGV4dHVyZS5fdXBkYXRlSUQ7XG5cbiAgICAgICAgY29uc3QgZ2VvbWV0cnk6IFBsYW5lR2VvbWV0cnkgPSB0aGlzLmdlb21ldHJ5IGFzIGFueTtcblxuICAgICAgICBnZW9tZXRyeS53aWR0aCA9IHRoaXMuc2hhZGVyLnRleHR1cmUud2lkdGg7XG4gICAgICAgIGdlb21ldHJ5LmhlaWdodCA9IHRoaXMuc2hhZGVyLnRleHR1cmUuaGVpZ2h0O1xuXG4gICAgICAgIGdlb21ldHJ5LmJ1aWxkKCk7XG4gICAgfVxuXG4gICAgc2V0IHRleHR1cmUodmFsdWU6IFRleHR1cmUpXG4gICAge1xuICAgICAgICAvLyBUcmFjayB0ZXh0dXJlIHNhbWUgd2F5IHNwcml0ZSBkb2VzLlxuICAgICAgICAvLyBGb3IgZ2VuZXJhdGVkIG1lc2hlcyBsaWtlIE5pbmVTbGljZVBsYW5lIGl0IGNhbiBjaGFuZ2UgdGhlIGdlb21ldHJ5LlxuICAgICAgICAvLyBVbmZvcnR1bmF0ZWx5LCB0aGlzIG1ldGhvZCBtaWdodCBub3Qgd29yayBpZiB5b3UgZGlyZWN0bHkgY2hhbmdlIHRleHR1cmUgaW4gbWF0ZXJpYWwuXG5cbiAgICAgICAgaWYgKHRoaXMuc2hhZGVyLnRleHR1cmUgPT09IHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNoYWRlci50ZXh0dXJlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3RleHR1cmVJRCA9IC0xO1xuXG4gICAgICAgIGlmICh2YWx1ZS5iYXNlVGV4dHVyZS52YWxpZClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy50ZXh0dXJlVXBkYXRlZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdmFsdWUub25jZSgndXBkYXRlJywgdGhpcy50ZXh0dXJlVXBkYXRlZCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgdGV4dHVyZSgpOiBUZXh0dXJlXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5zaGFkZXIudGV4dHVyZTtcbiAgICB9XG5cbiAgICBfcmVuZGVyKHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICh0aGlzLl90ZXh0dXJlSUQgIT09IHRoaXMuc2hhZGVyLnRleHR1cmUuX3VwZGF0ZUlEKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnRleHR1cmVVcGRhdGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlci5fcmVuZGVyKHJlbmRlcmVyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZGVzdHJveShvcHRpb25zOiBJRGVzdHJveU9wdGlvbnN8Ym9vbGVhbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuc2hhZGVyLnRleHR1cmUub2ZmKCd1cGRhdGUnLCB0aGlzLnRleHR1cmVVcGRhdGVkLCB0aGlzKTtcbiAgICAgICAgc3VwZXIuZGVzdHJveShvcHRpb25zKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgTWVzaCwgTWVzaEdlb21ldHJ5LCBNZXNoTWF0ZXJpYWwgfSBmcm9tICdAcGl4aS9tZXNoJztcbmltcG9ydCB7IFRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuaW1wb3J0IHR5cGUgeyBJVHlwZWRBcnJheSwgSUFycmF5QnVmZmVyLCBSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBEUkFXX01PREVTIH0gZnJvbSAnQHBpeGkvY29uc3RhbnRzJztcblxuLyoqXG4gKiBUaGUgU2ltcGxlIE1lc2ggY2xhc3MgbWltaWNzIE1lc2ggaW4gUGl4aUpTIHY0LCBwcm92aWRpbmcgZWFzeS10by11c2UgY29uc3RydWN0b3IgYXJndW1lbnRzLlxuICogRm9yIG1vcmUgcm9idXN0IGN1c3RvbWl6YXRpb24sIHVzZSB7QGxpbmsgUElYSS5NZXNofS5cbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuTWVzaFxuICogQG1lbWJlcm9mIFBJWElcbiAqL1xuZXhwb3J0IGNsYXNzIFNpbXBsZU1lc2ggZXh0ZW5kcyBNZXNoXG57XG4gICAgcHVibGljIGF1dG9VcGRhdGU6IGJvb2xlYW47XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gW3RleHR1cmU9VGV4dHVyZS5FTVBUWV0gLSBUaGUgdGV4dHVyZSB0byB1c2VcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gW3ZlcnRpY2VzXSAtIGlmIHlvdSB3YW50IHRvIHNwZWNpZnkgdGhlIHZlcnRpY2VzXG4gICAgICogQHBhcmFtIHtGbG9hdDMyQXJyYXl9IFt1dnNdIC0gaWYgeW91IHdhbnQgdG8gc3BlY2lmeSB0aGUgdXZzXG4gICAgICogQHBhcmFtIHtVaW50MTZBcnJheX0gW2luZGljZXNdIC0gaWYgeW91IHdhbnQgdG8gc3BlY2lmeSB0aGUgaW5kaWNlc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZHJhd01vZGVdIC0gdGhlIGRyYXdNb2RlLCBjYW4gYmUgYW55IG9mIHRoZSBNZXNoLkRSQVdfTU9ERVMgY29uc3RzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHRleHR1cmUgPSBUZXh0dXJlLkVNUFRZLFxuICAgICAgICB2ZXJ0aWNlcz86IElBcnJheUJ1ZmZlcixcbiAgICAgICAgdXZzPzogSUFycmF5QnVmZmVyLFxuICAgICAgICBpbmRpY2VzPzogSUFycmF5QnVmZmVyLFxuICAgICAgICBkcmF3TW9kZT86IERSQVdfTU9ERVNcbiAgICApXG4gICAge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBNZXNoR2VvbWV0cnkodmVydGljZXMsIHV2cywgaW5kaWNlcyk7XG5cbiAgICAgICAgZ2VvbWV0cnkuZ2V0QnVmZmVyKCdhVmVydGV4UG9zaXRpb24nKS5zdGF0aWMgPSBmYWxzZTtcblxuICAgICAgICBjb25zdCBtZXNoTWF0ZXJpYWwgPSBuZXcgTWVzaE1hdGVyaWFsKHRleHR1cmUpO1xuXG4gICAgICAgIHN1cGVyKGdlb21ldHJ5LCBtZXNoTWF0ZXJpYWwsIG51bGwsIGRyYXdNb2RlKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdXBsb2FkIHZlcnRpY2VzIGJ1ZmZlciBlYWNoIGZyYW1lXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1dG9VcGRhdGUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gb2YgdmVydGljZXMgZGF0YS5cbiAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICovXG4gICAgZ2V0IHZlcnRpY2VzKCk6IElUeXBlZEFycmF5XG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5nZW9tZXRyeS5nZXRCdWZmZXIoJ2FWZXJ0ZXhQb3NpdGlvbicpLmRhdGE7XG4gICAgfVxuICAgIHNldCB2ZXJ0aWNlcyh2YWx1ZTogSVR5cGVkQXJyYXkpXG4gICAge1xuICAgICAgICB0aGlzLmdlb21ldHJ5LmdldEJ1ZmZlcignYVZlcnRleFBvc2l0aW9uJykuZGF0YSA9IHZhbHVlO1xuICAgIH1cblxuICAgIF9yZW5kZXIocmVuZGVyZXI6IFJlbmRlcmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgaWYgKHRoaXMuYXV0b1VwZGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5nZW9tZXRyeS5nZXRCdWZmZXIoJ2FWZXJ0ZXhQb3NpdGlvbicpLnVwZGF0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuX3JlbmRlcihyZW5kZXJlcik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFNpbXBsZVBsYW5lIH0gZnJvbSAnLi9TaW1wbGVQbGFuZSc7XG5cbmltcG9ydCB0eXBlIHsgSVR5cGVkQXJyYXkgfSBmcm9tICdAcGl4aS9jb3JlJztcblxuY29uc3QgREVGQVVMVF9CT1JERVJfU0laRSA9IDEwO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBOaW5lU2xpY2VQbGFuZSBleHRlbmRzIEdsb2JhbE1peGlucy5OaW5lU2xpY2VQbGFuZSB7fVxuXG4vKipcbiAqIFRoZSBOaW5lU2xpY2VQbGFuZSBhbGxvd3MgeW91IHRvIHN0cmV0Y2ggYSB0ZXh0dXJlIHVzaW5nIDktc2xpY2Ugc2NhbGluZy4gVGhlIGNvcm5lcnMgd2lsbCByZW1haW4gdW5zY2FsZWQgKHVzZWZ1bFxuICogZm9yIGJ1dHRvbnMgd2l0aCByb3VuZGVkIGNvcm5lcnMgZm9yIGV4YW1wbGUpIGFuZCB0aGUgb3RoZXIgYXJlYXMgd2lsbCBiZSBzY2FsZWQgaG9yaXpvbnRhbGx5IGFuZCBvciB2ZXJ0aWNhbGx5XG4gKlxuICpgYGBqc1xuICogbGV0IFBsYW5lOSA9IG5ldyBQSVhJLk5pbmVTbGljZVBsYW5lKFBJWEkuVGV4dHVyZS5mcm9tKCdCb3hXaXRoUm91bmRlZENvcm5lcnMucG5nJyksIDE1LCAxNSwgMTUsIDE1KTtcbiAqICBgYGBcbiAqIDxwcmU+XG4gKiAgICAgIEEgICAgICAgICAgICAgICAgICAgICAgICAgIEJcbiAqICAgICstLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0rXG4gKiAgQyB8IDEgfCAgICAgICAgICAyICAgICAgICAgICB8IDMgfFxuICogICAgKy0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLStcbiAqICAgIHwgICB8ICAgICAgICAgICAgICAgICAgICAgIHwgICB8XG4gKiAgICB8IDQgfCAgICAgICAgICA1ICAgICAgICAgICB8IDYgfFxuICogICAgfCAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgIHxcbiAqICAgICstLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0rXG4gKiAgRCB8IDcgfCAgICAgICAgICA4ICAgICAgICAgICB8IDkgfFxuICogICAgKy0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLStcblxuICogIFdoZW4gY2hhbmdpbmcgdGhpcyBvYmplY3RzIHdpZHRoIGFuZC9vciBoZWlnaHQ6XG4gKiAgICAgYXJlYXMgMSAzIDcgYW5kIDkgd2lsbCByZW1haW4gdW5zY2FsZWQuXG4gKiAgICAgYXJlYXMgMiBhbmQgOCB3aWxsIGJlIHN0cmV0Y2hlZCBob3Jpem9udGFsbHlcbiAqICAgICBhcmVhcyA0IGFuZCA2IHdpbGwgYmUgc3RyZXRjaGVkIHZlcnRpY2FsbHlcbiAqICAgICBhcmVhIDUgd2lsbCBiZSBzdHJldGNoZWQgYm90aCBob3Jpem9udGFsbHkgYW5kIHZlcnRpY2FsbHlcbiAqIDwvcHJlPlxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TaW1wbGVQbGFuZVxuICogQG1lbWJlcm9mIFBJWElcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBOaW5lU2xpY2VQbGFuZSBleHRlbmRzIFNpbXBsZVBsYW5lXG57XG4gICAgcHJpdmF0ZSBfb3JpZ1dpZHRoOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfb3JpZ0hlaWdodDogbnVtYmVyO1xuICAgIF9sZWZ0V2lkdGg6IG51bWJlcjtcbiAgICBfcmlnaHRXaWR0aDogbnVtYmVyO1xuICAgIF90b3BIZWlnaHQ6IG51bWJlcjtcbiAgICBfYm90dG9tSGVpZ2h0OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuVGV4dHVyZX0gdGV4dHVyZSAtIFRoZSB0ZXh0dXJlIHRvIHVzZSBvbiB0aGUgTmluZVNsaWNlUGxhbmUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtsZWZ0V2lkdGg9MTBdIC0gc2l6ZSBvZiB0aGUgbGVmdCB2ZXJ0aWNhbCBiYXIgKEEpXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt0b3BIZWlnaHQ9MTBdIC0gc2l6ZSBvZiB0aGUgdG9wIGhvcml6b250YWwgYmFyIChDKVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmlnaHRXaWR0aD0xMF0gLSBzaXplIG9mIHRoZSByaWdodCB2ZXJ0aWNhbCBiYXIgKEIpXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtib3R0b21IZWlnaHQ9MTBdIC0gc2l6ZSBvZiB0aGUgYm90dG9tIGhvcml6b250YWwgYmFyIChEKVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICB0ZXh0dXJlOiBUZXh0dXJlLFxuICAgICAgICBsZWZ0V2lkdGggPSBERUZBVUxUX0JPUkRFUl9TSVpFLFxuICAgICAgICB0b3BIZWlnaHQgPSBERUZBVUxUX0JPUkRFUl9TSVpFLFxuICAgICAgICByaWdodFdpZHRoID0gREVGQVVMVF9CT1JERVJfU0laRSxcbiAgICAgICAgYm90dG9tSGVpZ2h0ID0gREVGQVVMVF9CT1JERVJfU0laRVxuICAgIClcbiAgICB7XG4gICAgICAgIHN1cGVyKFRleHR1cmUuV0hJVEUsIDQsIDQpO1xuXG4gICAgICAgIHRoaXMuX29yaWdXaWR0aCA9IHRleHR1cmUub3JpZy53aWR0aDtcbiAgICAgICAgdGhpcy5fb3JpZ0hlaWdodCA9IHRleHR1cmUub3JpZy5oZWlnaHQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgTmluZVNsaWNlUGxhbmUsIHNldHRpbmcgdGhpcyB3aWxsIGFjdHVhbGx5IG1vZGlmeSB0aGUgdmVydGljZXMgYW5kIFVWJ3Mgb2YgdGhpcyBwbGFuZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBvdmVycmlkZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fd2lkdGggPSB0aGlzLl9vcmlnV2lkdGg7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIE5pbmVTbGljZVBsYW5lLCBzZXR0aW5nIHRoaXMgd2lsbCBhY3R1YWxseSBtb2RpZnkgdGhlIHZlcnRpY2VzIGFuZCBVVidzIG9mIHRoaXMgcGxhbmVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAb3ZlcnJpZGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHRoaXMuX29yaWdIZWlnaHQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgbGVmdCBjb2x1bW4gKGEpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xlZnRXaWR0aCA9IGxlZnRXaWR0aDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHdpZHRoIG9mIHRoZSByaWdodCBjb2x1bW4gKGIpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3JpZ2h0V2lkdGggPSByaWdodFdpZHRoO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSB0b3Agcm93IChjKVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90b3BIZWlnaHQgPSB0b3BIZWlnaHQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIGJvdHRvbSByb3cgKGQpXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2JvdHRvbUhlaWdodCA9IGJvdHRvbUhlaWdodDtcblxuICAgICAgICAvLyBsZXRzIGNhbGwgdGhlIHNldHRlciB0byBlbnN1cmUgYWxsIG5lY2Vzc2FyeSB1cGRhdGVzIGFyZSBwZXJmb3JtZWRcbiAgICAgICAgdGhpcy50ZXh0dXJlID0gdGV4dHVyZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdGV4dHVyZVVwZGF0ZWQoKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gdGhpcy5zaGFkZXIudGV4dHVyZS5fdXBkYXRlSUQ7XG4gICAgICAgIHRoaXMuX3JlZnJlc2goKTtcbiAgICB9XG5cbiAgICBnZXQgdmVydGljZXMoKTogSVR5cGVkQXJyYXlcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmdlb21ldHJ5LmdldEJ1ZmZlcignYVZlcnRleFBvc2l0aW9uJykuZGF0YTtcbiAgICB9XG5cbiAgICBzZXQgdmVydGljZXModmFsdWU6IElUeXBlZEFycmF5KVxuICAgIHtcbiAgICAgICAgdGhpcy5nZW9tZXRyeS5nZXRCdWZmZXIoJ2FWZXJ0ZXhQb3NpdGlvbicpLmRhdGEgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBob3Jpem9udGFsIHZlcnRpY2VzLlxuICAgICAqXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZUhvcml6b250YWxWZXJ0aWNlcygpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7XG5cbiAgICAgICAgY29uc3Qgc2NhbGUgPSB0aGlzLl9nZXRNaW5TY2FsZSgpO1xuXG4gICAgICAgIHZlcnRpY2VzWzldID0gdmVydGljZXNbMTFdID0gdmVydGljZXNbMTNdID0gdmVydGljZXNbMTVdID0gdGhpcy5fdG9wSGVpZ2h0ICogc2NhbGU7XG4gICAgICAgIHZlcnRpY2VzWzE3XSA9IHZlcnRpY2VzWzE5XSA9IHZlcnRpY2VzWzIxXSA9IHZlcnRpY2VzWzIzXSA9IHRoaXMuX2hlaWdodCAtICh0aGlzLl9ib3R0b21IZWlnaHQgKiBzY2FsZSk7XG4gICAgICAgIHZlcnRpY2VzWzI1XSA9IHZlcnRpY2VzWzI3XSA9IHZlcnRpY2VzWzI5XSA9IHZlcnRpY2VzWzMxXSA9IHRoaXMuX2hlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSB2ZXJ0aWNhbCB2ZXJ0aWNlcy5cbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVWZXJ0aWNhbFZlcnRpY2VzKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHZlcnRpY2VzID0gdGhpcy52ZXJ0aWNlcztcblxuICAgICAgICBjb25zdCBzY2FsZSA9IHRoaXMuX2dldE1pblNjYWxlKCk7XG5cbiAgICAgICAgdmVydGljZXNbMl0gPSB2ZXJ0aWNlc1sxMF0gPSB2ZXJ0aWNlc1sxOF0gPSB2ZXJ0aWNlc1syNl0gPSB0aGlzLl9sZWZ0V2lkdGggKiBzY2FsZTtcbiAgICAgICAgdmVydGljZXNbNF0gPSB2ZXJ0aWNlc1sxMl0gPSB2ZXJ0aWNlc1syMF0gPSB2ZXJ0aWNlc1syOF0gPSB0aGlzLl93aWR0aCAtICh0aGlzLl9yaWdodFdpZHRoICogc2NhbGUpO1xuICAgICAgICB2ZXJ0aWNlc1s2XSA9IHZlcnRpY2VzWzE0XSA9IHZlcnRpY2VzWzIyXSA9IHZlcnRpY2VzWzMwXSA9IHRoaXMuX3dpZHRoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHNtYWxsZXIgb2YgYSBzZXQgb2YgdmVydGljYWwgYW5kIGhvcml6b250YWwgc2NhbGUgb2YgbmluZSBzbGljZSBjb3JuZXJzLlxuICAgICAqXG4gICAgICogQHJldHVybiB7bnVtYmVyfSBTbWFsbGVyIG51bWJlciBvZiB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FsZS5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgX2dldE1pblNjYWxlKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgY29uc3QgdyA9IHRoaXMuX2xlZnRXaWR0aCArIHRoaXMuX3JpZ2h0V2lkdGg7XG4gICAgICAgIGNvbnN0IHNjYWxlVyA9IHRoaXMuX3dpZHRoID4gdyA/IDEuMCA6IHRoaXMuX3dpZHRoIC8gdztcblxuICAgICAgICBjb25zdCBoID0gdGhpcy5fdG9wSGVpZ2h0ICsgdGhpcy5fYm90dG9tSGVpZ2h0O1xuICAgICAgICBjb25zdCBzY2FsZUggPSB0aGlzLl9oZWlnaHQgPiBoID8gMS4wIDogdGhpcy5faGVpZ2h0IC8gaDtcblxuICAgICAgICBjb25zdCBzY2FsZSA9IE1hdGgubWluKHNjYWxlVywgc2NhbGVIKTtcblxuICAgICAgICByZXR1cm4gc2NhbGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHdpZHRoIG9mIHRoZSBOaW5lU2xpY2VQbGFuZSwgc2V0dGluZyB0aGlzIHdpbGwgYWN0dWFsbHkgbW9kaWZ5IHRoZSB2ZXJ0aWNlcyBhbmQgVVYncyBvZiB0aGlzIHBsYW5lXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xuICAgIH1cblxuICAgIHNldCB3aWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5fd2lkdGggPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIE5pbmVTbGljZVBsYW5lLCBzZXR0aW5nIHRoaXMgd2lsbCBhY3R1YWxseSBtb2RpZnkgdGhlIHZlcnRpY2VzIGFuZCBVVidzIG9mIHRoaXMgcGxhbmVcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgaGVpZ2h0KCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcbiAgICB9XG5cbiAgICBzZXQgaGVpZ2h0KHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9oZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgbGVmdCBjb2x1bW5cbiAgICAgKlxuICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgKi9cbiAgICBnZXQgbGVmdFdpZHRoKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlZnRXaWR0aDtcbiAgICB9XG5cbiAgICBzZXQgbGVmdFdpZHRoKHZhbHVlOiBudW1iZXIpXG4gICAge1xuICAgICAgICB0aGlzLl9sZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgcmlnaHQgY29sdW1uXG4gICAgICpcbiAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICovXG4gICAgZ2V0IHJpZ2h0V2lkdGgoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmlnaHRXaWR0aDtcbiAgICB9XG5cbiAgICBzZXQgcmlnaHRXaWR0aCh2YWx1ZTogbnVtYmVyKVxuICAgIHtcbiAgICAgICAgdGhpcy5fcmlnaHRXaWR0aCA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgdG9wIHJvd1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCB0b3BIZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdG9wSGVpZ2h0O1xuICAgIH1cblxuICAgIHNldCB0b3BIZWlnaHQodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX3RvcEhlaWdodCA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgYm90dG9tIHJvd1xuICAgICAqXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIGdldCBib3R0b21IZWlnaHQoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm90dG9tSGVpZ2h0O1xuICAgIH1cblxuICAgIHNldCBib3R0b21IZWlnaHQodmFsdWU6IG51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX2JvdHRvbUhlaWdodCA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIE5pbmVTbGljZVBsYW5lIGNvb3Jkcy4gQWxsIG9mIHRoZW0uXG4gICAgICovXG4gICAgcHJpdmF0ZSBfcmVmcmVzaCgpOiB2b2lkXG4gICAge1xuICAgICAgICBjb25zdCB0ZXh0dXJlID0gdGhpcy50ZXh0dXJlO1xuXG4gICAgICAgIGNvbnN0IHV2cyA9IHRoaXMuZ2VvbWV0cnkuYnVmZmVyc1sxXS5kYXRhO1xuXG4gICAgICAgIHRoaXMuX29yaWdXaWR0aCA9IHRleHR1cmUub3JpZy53aWR0aDtcbiAgICAgICAgdGhpcy5fb3JpZ0hlaWdodCA9IHRleHR1cmUub3JpZy5oZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgX3V2dyA9IDEuMCAvIHRoaXMuX29yaWdXaWR0aDtcbiAgICAgICAgY29uc3QgX3V2aCA9IDEuMCAvIHRoaXMuX29yaWdIZWlnaHQ7XG5cbiAgICAgICAgdXZzWzBdID0gdXZzWzhdID0gdXZzWzE2XSA9IHV2c1syNF0gPSAwO1xuICAgICAgICB1dnNbMV0gPSB1dnNbM10gPSB1dnNbNV0gPSB1dnNbN10gPSAwO1xuICAgICAgICB1dnNbNl0gPSB1dnNbMTRdID0gdXZzWzIyXSA9IHV2c1szMF0gPSAxO1xuICAgICAgICB1dnNbMjVdID0gdXZzWzI3XSA9IHV2c1syOV0gPSB1dnNbMzFdID0gMTtcblxuICAgICAgICB1dnNbMl0gPSB1dnNbMTBdID0gdXZzWzE4XSA9IHV2c1syNl0gPSBfdXZ3ICogdGhpcy5fbGVmdFdpZHRoO1xuICAgICAgICB1dnNbNF0gPSB1dnNbMTJdID0gdXZzWzIwXSA9IHV2c1syOF0gPSAxIC0gKF91dncgKiB0aGlzLl9yaWdodFdpZHRoKTtcbiAgICAgICAgdXZzWzldID0gdXZzWzExXSA9IHV2c1sxM10gPSB1dnNbMTVdID0gX3V2aCAqIHRoaXMuX3RvcEhlaWdodDtcbiAgICAgICAgdXZzWzE3XSA9IHV2c1sxOV0gPSB1dnNbMjFdID0gdXZzWzIzXSA9IDEgLSAoX3V2aCAqIHRoaXMuX2JvdHRvbUhlaWdodCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVIb3Jpem9udGFsVmVydGljZXMoKTtcbiAgICAgICAgdGhpcy51cGRhdGVWZXJ0aWNhbFZlcnRpY2VzKCk7XG5cbiAgICAgICAgdGhpcy5nZW9tZXRyeS5idWZmZXJzWzBdLnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmdlb21ldHJ5LmJ1ZmZlcnNbMV0udXBkYXRlKCk7XG4gICAgfVxufVxuIiwgIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwgImltcG9ydCB7IFRleHR1cmUgfSBmcm9tICdAcGl4aS9jb3JlJztcbmltcG9ydCB7IFNwcml0ZSB9IGZyb20gJ0BwaXhpL3Nwcml0ZSc7XG5pbXBvcnQgeyBUaWNrZXIsIFVQREFURV9QUklPUklUWSB9IGZyb20gJ0BwaXhpL3RpY2tlcic7XG5pbXBvcnQgdHlwZSB7IElEZXN0cm95T3B0aW9ucyB9IGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuXG4vKipcbiAqIEFuIEFuaW1hdGVkU3ByaXRlIGlzIGEgc2ltcGxlIHdheSB0byBkaXNwbGF5IGFuIGFuaW1hdGlvbiBkZXBpY3RlZCBieSBhIGxpc3Qgb2YgdGV4dHVyZXMuXG4gKlxuICogYGBganNcbiAqIGxldCBhbGllbkltYWdlcyA9IFtcImltYWdlX3NlcXVlbmNlXzAxLnBuZ1wiLFwiaW1hZ2Vfc2VxdWVuY2VfMDIucG5nXCIsXCJpbWFnZV9zZXF1ZW5jZV8wMy5wbmdcIixcImltYWdlX3NlcXVlbmNlXzA0LnBuZ1wiXTtcbiAqIGxldCB0ZXh0dXJlQXJyYXkgPSBbXTtcbiAqXG4gKiBmb3IgKGxldCBpPTA7IGkgPCA0OyBpKyspXG4gKiB7XG4gKiAgICAgIGxldCB0ZXh0dXJlID0gUElYSS5UZXh0dXJlLmZyb20oYWxpZW5JbWFnZXNbaV0pO1xuICogICAgICB0ZXh0dXJlQXJyYXkucHVzaCh0ZXh0dXJlKTtcbiAqIH07XG4gKlxuICogbGV0IGFuaW1hdGVkU3ByaXRlID0gbmV3IFBJWEkuQW5pbWF0ZWRTcHJpdGUodGV4dHVyZUFycmF5KTtcbiAqIGBgYFxuICpcbiAqIFRoZSBtb3JlIGVmZmljaWVudCBhbmQgc2ltcGxlciB3YXkgdG8gY3JlYXRlIGFuIGFuaW1hdGVkIHNwcml0ZSBpcyB1c2luZyBhIHtAbGluayBQSVhJLlNwcml0ZXNoZWV0fVxuICogY29udGFpbmluZyB0aGUgYW5pbWF0aW9uIGRlZmluaXRpb25zOlxuICpcbiAqIGBgYGpzXG4gKiBQSVhJLkxvYWRlci5zaGFyZWQuYWRkKFwiYXNzZXRzL3Nwcml0ZXNoZWV0Lmpzb25cIikubG9hZChzZXR1cCk7XG4gKlxuICogZnVuY3Rpb24gc2V0dXAoKSB7XG4gKiAgIGxldCBzaGVldCA9IFBJWEkuTG9hZGVyLnNoYXJlZC5yZXNvdXJjZXNbXCJhc3NldHMvc3ByaXRlc2hlZXQuanNvblwiXS5zcHJpdGVzaGVldDtcbiAqICAgYW5pbWF0ZWRTcHJpdGUgPSBuZXcgUElYSS5BbmltYXRlZFNwcml0ZShzaGVldC5hbmltYXRpb25zW1wiaW1hZ2Vfc2VxdWVuY2VcIl0pO1xuICogICAuLi5cbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBjbGFzc1xuICogQGV4dGVuZHMgUElYSS5TcHJpdGVcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKi9cbmV4cG9ydCBjbGFzcyBBbmltYXRlZFNwcml0ZSBleHRlbmRzIFNwcml0ZVxue1xuICAgIHB1YmxpYyBhbmltYXRpb25TcGVlZDogbnVtYmVyO1xuICAgIHB1YmxpYyBsb29wOiBib29sZWFuO1xuICAgIHB1YmxpYyB1cGRhdGVBbmNob3I6IGJvb2xlYW47XG4gICAgcHVibGljIG9uQ29tcGxldGU6ICgpID0+IHZvaWQ7XG4gICAgcHVibGljIG9uRnJhbWVDaGFuZ2U6IChjdXJyZW50RnJhbWU6IG51bWJlcikgPT4gdm9pZDtcbiAgICBwdWJsaWMgb25Mb29wOiAoKSA9PiB2b2lkO1xuXG4gICAgcHJpdmF0ZSBfcGxheWluZzogYm9vbGVhbjtcbiAgICBwcml2YXRlIF90ZXh0dXJlczogVGV4dHVyZVtdO1xuICAgIHByaXZhdGUgX2R1cmF0aW9uczogbnVtYmVyW107XG4gICAgcHJpdmF0ZSBfYXV0b1VwZGF0ZTogYm9vbGVhbjtcbiAgICBwcml2YXRlIF9pc0Nvbm5lY3RlZFRvVGlja2VyOiBib29sZWFuO1xuICAgIHByaXZhdGUgX2N1cnJlbnRUaW1lOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfcHJldmlvdXNGcmFtZTogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmVbXXxQSVhJLkFuaW1hdGVkU3ByaXRlLkZyYW1lT2JqZWN0W119IHRleHR1cmVzIC0gQW4gYXJyYXkgb2Yge0BsaW5rIFBJWEkuVGV4dHVyZX0gb3IgZnJhbWVcbiAgICAgKiAgb2JqZWN0cyB0aGF0IG1ha2UgdXAgdGhlIGFuaW1hdGlvbi5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFthdXRvVXBkYXRlPXRydWVdIC0gV2hldGhlciB0byB1c2UgUElYSS5UaWNrZXIuc2hhcmVkIHRvIGF1dG8gdXBkYXRlIGFuaW1hdGlvbiB0aW1lLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRleHR1cmVzOiBUZXh0dXJlW118RnJhbWVPYmplY3RbXSwgYXV0b1VwZGF0ZSA9IHRydWUpXG4gICAge1xuICAgICAgICBzdXBlcih0ZXh0dXJlc1swXSBpbnN0YW5jZW9mIFRleHR1cmUgPyB0ZXh0dXJlc1swXSA6IHRleHR1cmVzWzBdLnRleHR1cmUpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7UElYSS5UZXh0dXJlW119XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl90ZXh0dXJlcyA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJbXX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2R1cmF0aW9ucyA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCB1c2VzIFBJWEkuVGlja2VyLnNoYXJlZCB0byBhdXRvIHVwZGF0ZSBhbmltYXRpb24gdGltZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2F1dG9VcGRhdGUgPSBhdXRvVXBkYXRlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBgdHJ1ZWAgaWYgdGhlIGluc3RhbmNlIGlzIGN1cnJlbnRseSBjb25uZWN0ZWQgdG8gUElYSS5UaWNrZXIuc2hhcmVkIHRvIGF1dG8gdXBkYXRlIGFuaW1hdGlvbiB0aW1lLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNwZWVkIHRoYXQgdGhlIEFuaW1hdGVkU3ByaXRlIHdpbGwgcGxheSBhdC4gSGlnaGVyIGlzIGZhc3RlciwgbG93ZXIgaXMgc2xvd2VyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDFcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uU3BlZWQgPSAxO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIG9yIG5vdCB0aGUgYW5pbWF0ZSBzcHJpdGUgcmVwZWF0cyBhZnRlciBwbGF5aW5nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxvb3AgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGUgYW5jaG9yIHRvIFtUZXh0dXJlJ3MgZGVmYXVsdEFuY2hvcl17QGxpbmsgUElYSS5UZXh0dXJlI2RlZmF1bHRBbmNob3J9IHdoZW4gZnJhbWUgY2hhbmdlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogVXNlZnVsIHdpdGggW3Nwcml0ZSBzaGVldCBhbmltYXRpb25zXXtAbGluayBQSVhJLlNwcml0ZXNoZWV0I2FuaW1hdGlvbnN9IGNyZWF0ZWQgd2l0aCB0b29scy5cbiAgICAgICAgICogQ2hhbmdpbmcgYW5jaG9yIGZvciBlYWNoIGZyYW1lIGFsbG93cyB0byBwaW4gc3ByaXRlIG9yaWdpbiB0byBjZXJ0YWluIG1vdmluZyBmZWF0dXJlXG4gICAgICAgICAqIG9mIHRoZSBmcmFtZSAoZS5nLiBsZWZ0IGZvb3QpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBOb3RlOiBFbmFibGluZyB0aGlzIHdpbGwgb3ZlcnJpZGUgYW55IHByZXZpb3VzbHkgc2V0IGBhbmNob3JgIG9uIGVhY2ggZnJhbWUgY2hhbmdlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51cGRhdGVBbmNob3IgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlci1hc3NpZ25lZCBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYW4gQW5pbWF0ZWRTcHJpdGUgZmluaXNoZXMgcGxheWluZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogYW5pbWF0aW9uLm9uQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAqICAgLy8gZmluaXNoZWQhXG4gICAgICAgICAqIH07XG4gICAgICAgICAqIEBtZW1iZXIge0Z1bmN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkNvbXBsZXRlID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlci1hc3NpZ25lZCBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYW4gQW5pbWF0ZWRTcHJpdGUgY2hhbmdlcyB3aGljaCB0ZXh0dXJlIGlzIGJlaW5nIHJlbmRlcmVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBhbmltYXRpb24ub25GcmFtZUNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICogICAvLyB1cGRhdGVkIVxuICAgICAgICAgKiB9O1xuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25GcmFtZUNoYW5nZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZXItYXNzaWduZWQgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIGBsb29wYCBpcyB0cnVlLCBhbmQgYW4gQW5pbWF0ZWRTcHJpdGUgaXMgcGxheWVkIGFuZFxuICAgICAgICAgKiBsb29wcyBhcm91bmQgdG8gc3RhcnQgYWdhaW4uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIGFuaW1hdGlvbi5vbkxvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAqICAgLy8gbG9vcGVkIVxuICAgICAgICAgKiB9O1xuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub25Mb29wID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogRWxhcHNlZCB0aW1lIHNpbmNlIGFuaW1hdGlvbiBoYXMgYmVlbiBzdGFydGVkLCB1c2VkIGludGVybmFsbHkgdG8gZGlzcGxheSBjdXJyZW50IHRleHR1cmUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gMDtcblxuICAgICAgICB0aGlzLl9wbGF5aW5nID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0ZXh0dXJlIGluZGV4IHRoYXQgd2FzIGRpc3BsYXllZCBsYXN0IHRpbWVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcHJldmlvdXNGcmFtZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy50ZXh0dXJlcyA9IHRleHR1cmVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3BzIHRoZSBBbmltYXRlZFNwcml0ZS5cbiAgICAgKlxuICAgICAqL1xuICAgIHB1YmxpYyBzdG9wKCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGlmICghdGhpcy5fcGxheWluZylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5fYXV0b1VwZGF0ZSAmJiB0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyKVxuICAgICAgICB7XG4gICAgICAgICAgICBUaWNrZXIuc2hhcmVkLnJlbW92ZSh0aGlzLnVwZGF0ZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQbGF5cyB0aGUgQW5pbWF0ZWRTcHJpdGUuXG4gICAgICpcbiAgICAgKi9cbiAgICBwdWJsaWMgcGxheSgpOiB2b2lkXG4gICAge1xuICAgICAgICBpZiAodGhpcy5fcGxheWluZylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcGxheWluZyA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLl9hdXRvVXBkYXRlICYmICF0aGlzLl9pc0Nvbm5lY3RlZFRvVGlja2VyKVxuICAgICAgICB7XG4gICAgICAgICAgICBUaWNrZXIuc2hhcmVkLmFkZCh0aGlzLnVwZGF0ZSwgdGhpcywgVVBEQVRFX1BSSU9SSVRZLkhJR0gpO1xuICAgICAgICAgICAgdGhpcy5faXNDb25uZWN0ZWRUb1RpY2tlciA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wcyB0aGUgQW5pbWF0ZWRTcHJpdGUgYW5kIGdvZXMgdG8gYSBzcGVjaWZpYyBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBmcmFtZU51bWJlciAtIEZyYW1lIGluZGV4IHRvIHN0b3AgYXQuXG4gICAgICovXG4gICAgcHVibGljIGdvdG9BbmRTdG9wKGZyYW1lTnVtYmVyOiBudW1iZXIpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnN0b3AoKTtcblxuICAgICAgICBjb25zdCBwcmV2aW91c0ZyYW1lID0gdGhpcy5jdXJyZW50RnJhbWU7XG5cbiAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSBmcmFtZU51bWJlcjtcblxuICAgICAgICBpZiAocHJldmlvdXNGcmFtZSAhPT0gdGhpcy5jdXJyZW50RnJhbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGV4dHVyZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR29lcyB0byBhIHNwZWNpZmljIGZyYW1lIGFuZCBiZWdpbnMgcGxheWluZyB0aGUgQW5pbWF0ZWRTcHJpdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZnJhbWVOdW1iZXIgLSBGcmFtZSBpbmRleCB0byBzdGFydCBhdC5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ290b0FuZFBsYXkoZnJhbWVOdW1iZXI6IG51bWJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzRnJhbWUgPSB0aGlzLmN1cnJlbnRGcmFtZTtcblxuICAgICAgICB0aGlzLl9jdXJyZW50VGltZSA9IGZyYW1lTnVtYmVyO1xuXG4gICAgICAgIGlmIChwcmV2aW91c0ZyYW1lICE9PSB0aGlzLmN1cnJlbnRGcmFtZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUZXh0dXJlKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnBsYXkoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBvYmplY3QgdHJhbnNmb3JtIGZvciByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGVsdGFUaW1lIC0gVGltZSBzaW5jZSBsYXN0IHRpY2suXG4gICAgICovXG4gICAgdXBkYXRlKGRlbHRhVGltZTogbnVtYmVyKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgZWxhcHNlZCA9IHRoaXMuYW5pbWF0aW9uU3BlZWQgKiBkZWx0YVRpbWU7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzRnJhbWUgPSB0aGlzLmN1cnJlbnRGcmFtZTtcblxuICAgICAgICBpZiAodGhpcy5fZHVyYXRpb25zICE9PSBudWxsKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgbGFnID0gdGhpcy5fY3VycmVudFRpbWUgJSAxICogdGhpcy5fZHVyYXRpb25zW3RoaXMuY3VycmVudEZyYW1lXTtcblxuICAgICAgICAgICAgbGFnICs9IGVsYXBzZWQgLyA2MCAqIDEwMDA7XG5cbiAgICAgICAgICAgIHdoaWxlIChsYWcgPCAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lLS07XG4gICAgICAgICAgICAgICAgbGFnICs9IHRoaXMuX2R1cmF0aW9uc1t0aGlzLmN1cnJlbnRGcmFtZV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHNpZ24gPSBNYXRoLnNpZ24odGhpcy5hbmltYXRpb25TcGVlZCAqIGRlbHRhVGltZSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gTWF0aC5mbG9vcih0aGlzLl9jdXJyZW50VGltZSk7XG5cbiAgICAgICAgICAgIHdoaWxlIChsYWcgPj0gdGhpcy5fZHVyYXRpb25zW3RoaXMuY3VycmVudEZyYW1lXSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWcgLT0gdGhpcy5fZHVyYXRpb25zW3RoaXMuY3VycmVudEZyYW1lXSAqIHNpZ247XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgKz0gc2lnbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgKz0gbGFnIC8gdGhpcy5fZHVyYXRpb25zW3RoaXMuY3VycmVudEZyYW1lXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRUaW1lICs9IGVsYXBzZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fY3VycmVudFRpbWUgPCAwICYmICF0aGlzLmxvb3ApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZ290b0FuZFN0b3AoMCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9uQ29tcGxldGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY3VycmVudFRpbWUgPj0gdGhpcy5fdGV4dHVyZXMubGVuZ3RoICYmICF0aGlzLmxvb3ApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZ290b0FuZFN0b3AodGhpcy5fdGV4dHVyZXMubGVuZ3RoIC0gMSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9uQ29tcGxldGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJldmlvdXNGcmFtZSAhPT0gdGhpcy5jdXJyZW50RnJhbWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmxvb3AgJiYgdGhpcy5vbkxvb3ApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uU3BlZWQgPiAwICYmIHRoaXMuY3VycmVudEZyYW1lIDwgcHJldmlvdXNGcmFtZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25Mb29wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYW5pbWF0aW9uU3BlZWQgPCAwICYmIHRoaXMuY3VycmVudEZyYW1lID4gcHJldmlvdXNGcmFtZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25Mb29wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRleHR1cmUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGRpc3BsYXllZCB0ZXh0dXJlIHRvIG1hdGNoIHRoZSBjdXJyZW50IGZyYW1lIGluZGV4LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVRleHR1cmUoKTogdm9pZFxuICAgIHtcbiAgICAgICAgY29uc3QgY3VycmVudEZyYW1lID0gdGhpcy5jdXJyZW50RnJhbWU7XG5cbiAgICAgICAgaWYgKHRoaXMuX3ByZXZpb3VzRnJhbWUgPT09IGN1cnJlbnRGcmFtZSlcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcHJldmlvdXNGcmFtZSA9IGN1cnJlbnRGcmFtZTtcblxuICAgICAgICB0aGlzLl90ZXh0dXJlID0gdGhpcy5fdGV4dHVyZXNbY3VycmVudEZyYW1lXTtcbiAgICAgICAgdGhpcy5fdGV4dHVyZUlEID0gLTE7XG4gICAgICAgIHRoaXMuX3RleHR1cmVUcmltbWVkSUQgPSAtMTtcbiAgICAgICAgdGhpcy5fY2FjaGVkVGludCA9IDB4RkZGRkZGO1xuICAgICAgICB0aGlzLnV2cyA9IHRoaXMuX3RleHR1cmUuX3V2cy51dnNGbG9hdDMyO1xuXG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZUFuY2hvcilcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fYW5jaG9yLmNvcHlGcm9tKHRoaXMuX3RleHR1cmUuZGVmYXVsdEFuY2hvcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vbkZyYW1lQ2hhbmdlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm9uRnJhbWVDaGFuZ2UodGhpcy5jdXJyZW50RnJhbWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIEFuaW1hdGVkU3ByaXRlIGFuZCBkZXN0cm95cyBpdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fGJvb2xlYW59IFtvcHRpb25zXSAtIE9wdGlvbnMgcGFyYW1ldGVyLiBBIGJvb2xlYW4gd2lsbCBhY3QgYXMgaWYgYWxsIG9wdGlvbnNcbiAgICAgKiAgaGF2ZSBiZWVuIHNldCB0byB0aGF0IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gSWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlIHRoZWlyIGRlc3Ryb3lcbiAgICAgKiAgICAgIG1ldGhvZCBjYWxsZWQgYXMgd2VsbC4gJ29wdGlvbnMnIHdpbGwgYmUgcGFzc2VkIG9uIHRvIHRob3NlIGNhbGxzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudGV4dHVyZT1mYWxzZV0gLSBTaG91bGQgaXQgZGVzdHJveSB0aGUgY3VycmVudCB0ZXh0dXJlIG9mIHRoZSBzcHJpdGUgYXMgd2VsbC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmJhc2VUZXh0dXJlPWZhbHNlXSAtIFNob3VsZCBpdCBkZXN0cm95IHRoZSBiYXNlIHRleHR1cmUgb2YgdGhlIHNwcml0ZSBhcyB3ZWxsLlxuICAgICAqL1xuICAgIHB1YmxpYyBkZXN0cm95KG9wdGlvbnM6IElEZXN0cm95T3B0aW9uc3xib29sZWFuKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3kob3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5vbkNvbXBsZXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5vbkZyYW1lQ2hhbmdlID0gbnVsbDtcbiAgICAgICAgdGhpcy5vbkxvb3AgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc2hvcnQgaGFuZCB3YXkgb2YgY3JlYXRpbmcgYW4gQW5pbWF0ZWRTcHJpdGUgZnJvbSBhbiBhcnJheSBvZiBmcmFtZSBpZHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gZnJhbWVzIC0gVGhlIGFycmF5IG9mIGZyYW1lcyBpZHMgdGhlIEFuaW1hdGVkU3ByaXRlIHdpbGwgdXNlIGFzIGl0cyB0ZXh0dXJlIGZyYW1lcy5cbiAgICAgKiBAcmV0dXJuIHtQSVhJLkFuaW1hdGVkU3ByaXRlfSBUaGUgbmV3IGFuaW1hdGVkIHNwcml0ZSB3aXRoIHRoZSBzcGVjaWZpZWQgZnJhbWVzLlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbUZyYW1lcyhmcmFtZXM6IHN0cmluZ1tdKTogQW5pbWF0ZWRTcHJpdGVcbiAgICB7XG4gICAgICAgIGNvbnN0IHRleHR1cmVzID0gW107XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmcmFtZXMubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRleHR1cmVzLnB1c2goVGV4dHVyZS5mcm9tKGZyYW1lc1tpXSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBBbmltYXRlZFNwcml0ZSh0ZXh0dXJlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzaG9ydCBoYW5kIHdheSBvZiBjcmVhdGluZyBhbiBBbmltYXRlZFNwcml0ZSBmcm9tIGFuIGFycmF5IG9mIGltYWdlIGlkcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBpbWFnZXMgLSBUaGUgYXJyYXkgb2YgaW1hZ2UgdXJscyB0aGUgQW5pbWF0ZWRTcHJpdGUgd2lsbCB1c2UgYXMgaXRzIHRleHR1cmUgZnJhbWVzLlxuICAgICAqIEByZXR1cm4ge1BJWEkuQW5pbWF0ZWRTcHJpdGV9IFRoZSBuZXcgYW5pbWF0ZSBzcHJpdGUgd2l0aCB0aGUgc3BlY2lmaWVkIGltYWdlcyBhcyBmcmFtZXMuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBmcm9tSW1hZ2VzKGltYWdlczogc3RyaW5nW10pOiBBbmltYXRlZFNwcml0ZVxuICAgIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZXMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlcy5sZW5ndGg7ICsraSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGV4dHVyZXMucHVzaChUZXh0dXJlLmZyb20oaW1hZ2VzW2ldKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IEFuaW1hdGVkU3ByaXRlKHRleHR1cmVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgdG90YWwgbnVtYmVyIG9mIGZyYW1lcyBpbiB0aGUgQW5pbWF0ZWRTcHJpdGUuIFRoaXMgaXMgdGhlIHNhbWUgYXMgbnVtYmVyIG9mIHRleHR1cmVzXG4gICAgICogYXNzaWduZWQgdG8gdGhlIEFuaW1hdGVkU3ByaXRlLlxuICAgICAqXG4gICAgICogQHJlYWRvbmx5XG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqIEBkZWZhdWx0IDBcbiAgICAgKi9cbiAgICBnZXQgdG90YWxGcmFtZXMoKTogbnVtYmVyXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGV4dHVyZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBhcnJheSBvZiB0ZXh0dXJlcyB1c2VkIGZvciB0aGlzIEFuaW1hdGVkU3ByaXRlLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7UElYSS5UZXh0dXJlW119XG4gICAgICovXG4gICAgZ2V0IHRleHR1cmVzKCk6IFRleHR1cmVbXXxGcmFtZU9iamVjdFtdXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGV4dHVyZXM7XG4gICAgfVxuXG4gICAgc2V0IHRleHR1cmVzKHZhbHVlOiBUZXh0dXJlW118RnJhbWVPYmplY3RbXSlcbiAgICB7XG4gICAgICAgIGlmICh2YWx1ZVswXSBpbnN0YW5jZW9mIFRleHR1cmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3RleHR1cmVzID0gdmFsdWUgYXMgVGV4dHVyZVtdO1xuICAgICAgICAgICAgdGhpcy5fZHVyYXRpb25zID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX3RleHR1cmVzID0gW107XG4gICAgICAgICAgICB0aGlzLl9kdXJhdGlvbnMgPSBbXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0dXJlcy5wdXNoKCh2YWx1ZVtpXSBhcyBGcmFtZU9iamVjdCkudGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZHVyYXRpb25zLnB1c2goKHZhbHVlW2ldIGFzIEZyYW1lT2JqZWN0KS50aW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wcmV2aW91c0ZyYW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5nb3RvQW5kU3RvcCgwKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0dXJlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBUaGUgQW5pbWF0ZWRTcHJpdGVzIGN1cnJlbnQgZnJhbWUgaW5kZXguXG4gICAgKlxuICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICogQHJlYWRvbmx5XG4gICAgKi9cbiAgICBnZXQgY3VycmVudEZyYW1lKCk6IG51bWJlclxuICAgIHtcbiAgICAgICAgbGV0IGN1cnJlbnRGcmFtZSA9IE1hdGguZmxvb3IodGhpcy5fY3VycmVudFRpbWUpICUgdGhpcy5fdGV4dHVyZXMubGVuZ3RoO1xuXG4gICAgICAgIGlmIChjdXJyZW50RnJhbWUgPCAwKVxuICAgICAgICB7XG4gICAgICAgICAgICBjdXJyZW50RnJhbWUgKz0gdGhpcy5fdGV4dHVyZXMubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGN1cnJlbnRGcmFtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgaWYgdGhlIEFuaW1hdGVkU3ByaXRlIGlzIGN1cnJlbnRseSBwbGF5aW5nLlxuICAgICAqXG4gICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgKiBAcmVhZG9ubHlcbiAgICAgKi9cbiAgICBnZXQgcGxheWluZygpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGxheWluZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRvIHVzZSBQSVhJLlRpY2tlci5zaGFyZWQgdG8gYXV0byB1cGRhdGUgYW5pbWF0aW9uIHRpbWVcbiAgICAgKlxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICovXG4gICAgZ2V0IGF1dG9VcGRhdGUoKTogYm9vbGVhblxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9VcGRhdGU7XG4gICAgfVxuXG4gICAgc2V0IGF1dG9VcGRhdGUodmFsdWU6IGJvb2xlYW4pXG4gICAge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX2F1dG9VcGRhdGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX2F1dG9VcGRhdGUgPSB2YWx1ZTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9hdXRvVXBkYXRlICYmIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgVGlja2VyLnNoYXJlZC5yZW1vdmUodGhpcy51cGRhdGUsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX2F1dG9VcGRhdGUgJiYgIXRoaXMuX2lzQ29ubmVjdGVkVG9UaWNrZXIgJiYgdGhpcy5fcGxheWluZylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBUaWNrZXIuc2hhcmVkLmFkZCh0aGlzLnVwZGF0ZSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNDb25uZWN0ZWRUb1RpY2tlciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRnJhbWVPYmplY3Qge1xuICAgIHRleHR1cmU6IFRleHR1cmU7XG4gICAgdGltZTogbnVtYmVyO1xufVxuXG4vKipcbiAqIEBtZW1iZXJvZiBQSVhJLkFuaW1hdGVkU3ByaXRlXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBGcmFtZU9iamVjdFxuICogQHR5cGUge29iamVjdH1cbiAqIEBwcm9wZXJ0eSB7UElYSS5UZXh0dXJlfSB0ZXh0dXJlIC0gVGhlIHtAbGluayBQSVhJLlRleHR1cmV9IG9mIHRoZSBmcmFtZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWUgLSB0aGUgZHVyYXRpb24gb2YgdGhlIGZyYW1lIGluIG1zXG4gKi9cbiIsICIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsICJpbXBvcnQgeyBkZXByZWNhdGlvbiB9IGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB0eXBlIHtcbiAgICBzeXN0ZW1zLFxuICAgIHJlc291cmNlcyxcbiAgICBSZW5kZXJlcixcbiAgICBJbWFnZVNvdXJjZSxcbiAgICBCYXNlVGV4dHVyZSxcbiAgICBSZW5kZXJUZXh0dXJlLFxuICAgIFRleHR1cmUsXG4gICAgU3RhdGUsXG4gICAgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHR5cGUgeyBEaXNwbGF5T2JqZWN0LCBDb250YWluZXIgfSBmcm9tICdAcGl4aS9kaXNwbGF5JztcbmltcG9ydCB0eXBlIHsgVGlsaW5nU3ByaXRlIH0gZnJvbSAnQHBpeGkvc3ByaXRlLXRpbGluZyc7XG5pbXBvcnQgdHlwZSB7XG4gICAgUG9pbnQsXG4gICAgT2JzZXJ2YWJsZVBvaW50LFxuICAgIElQb2ludCxcbiAgICBSZWN0YW5nbGUsXG4gICAgVHJhbnNmb3JtLFxuICAgIGdyb3VwRDgsXG4gICAgTWF0cml4IH0gZnJvbSAnQHBpeGkvbWF0aCc7XG5pbXBvcnQgdHlwZSB7IEludGVyYWN0aW9uTWFuYWdlciwgSW50ZXJhY3Rpb25EYXRhLCBJbnRlcmFjdGlvbkV2ZW50IH0gZnJvbSAnQHBpeGkvaW50ZXJhY3Rpb24nO1xuaW1wb3J0IHR5cGUgeyBBY2Nlc3NpYmlsaXR5TWFuYWdlciB9IGZyb20gJ0BwaXhpL2FjY2Vzc2liaWxpdHknO1xuaW1wb3J0IHR5cGUgeyBUaWNrZXIgfSBmcm9tICdAcGl4aS90aWNrZXInO1xuaW1wb3J0IHR5cGUgeyBHcmFwaGljcywgR3JhcGhpY3NEYXRhIH0gZnJvbSAnQHBpeGkvZ3JhcGhpY3MnO1xuaW1wb3J0IHR5cGUgeyBTcHJpdGUgfSBmcm9tICdAcGl4aS9zcHJpdGUnO1xuaW1wb3J0IHR5cGUgeyBCaXRtYXBUZXh0LCBCaXRtYXBGb250TG9hZGVyIH0gZnJvbSAnQHBpeGkvdGV4dC1iaXRtYXAnO1xuaW1wb3J0IHR5cGUgeyBDYW52YXNSZW5kZXJUYXJnZXQgfSBmcm9tICdAcGl4aS91dGlscyc7XG5pbXBvcnQgdHlwZSB7IExvYWRlciwgTG9hZGVyUmVzb3VyY2UgfSBmcm9tICdAcGl4aS9sb2FkZXJzJztcbmltcG9ydCB0eXBlIHsgQmFzZVByZXBhcmUsIFByZXBhcmUgfSBmcm9tICdAcGl4aS9wcmVwYXJlJztcbmltcG9ydCB0eXBlIHsgRXh0cmFjdCB9IGZyb20gJ0BwaXhpL2V4dHJhY3QnO1xuaW1wb3J0IHR5cGUgeyBBbmltYXRlZFNwcml0ZSB9IGZyb20gJ0BwaXhpL3Nwcml0ZS1hbmltYXRlZCc7XG5pbXBvcnQgdHlwZSB7IE1lc2ggfSBmcm9tICdAcGl4aS9tZXNoJztcbmltcG9ydCB0eXBlIHsgUGFydGljbGVDb250YWluZXIgfSBmcm9tICdAcGl4aS9wYXJ0aWNsZXMnO1xuaW1wb3J0IHR5cGUgeyBTcHJpdGVzaGVldExvYWRlciB9IGZyb20gJ0BwaXhpL3Nwcml0ZXNoZWV0JztcbmltcG9ydCB0eXBlIHtcbiAgICBTaW1wbGVSb3BlLFxuICAgIE5pbmVTbGljZVBsYW5lLFxuICAgIFNpbXBsZU1lc2gsXG4gICAgU2ltcGxlUGxhbmUgfSBmcm9tICdAcGl4aS9tZXNoLWV4dHJhcyc7XG5cbmNvbnN0IHY1ID0gJzUuMC4wJztcblxuLy8gQ2FudmFzIGRlcHJlY2F0aW9ucyBuZWVkcyB0byBnZXQgbW92ZWRcbi8vIHRvIHRoZSBsZWdhY3kgcGFja2FnZSwgYnV0IGZvciBub3csIHdlJ2xsXG4vLyBhZCB0aGlzIHJlbWluZGVyXG50eXBlICRGaXhMZWdhY3kgPSBhbnk7XG5cbi8qKlxuICogRGVwcmVjYXRpb25zIChiYWNrd2FyZCBjb21wYXRpYmlsaXRpZXMpIGFyZSBhdXRvbWF0aWNhbGx5IGFwcGxpZWQgZm9yIGJyb3dzZXIgYnVuZGxlc1xuICogaW4gdGhlIFVNRCBtb2R1bGUgZm9ybWF0LiBJZiB1c2luZyBXZWJwYWNrIG9yIFJvbGx1cCwgeW91J2xsIG5lZWQgdG8gYXBwbHkgdGhlc2VcbiAqIGRlcHJlY2F0aW9ucyBtYW51YWxseSBieSBkb2luZyBzb21ldGhpbmcgbGlrZSB0aGlzOlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG4gKiBQSVhJLnVzZURlcHJlY2F0ZWQoKTsgLy8gTVVTVCBiZSBib3VuZCB0byBuYW1lc3BhY2VcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAZnVuY3Rpb24gdXNlRGVwcmVjYXRlZFxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuZXhwb3J0IGZ1bmN0aW9uIHVzZURlcHJlY2F0ZWQodGhpczogYW55KTogdm9pZFxue1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgIGNvbnN0IFBJWEkgPSB0aGlzO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUElYSSwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGNvbnN0YW50IHtSZWdFeHB8c3RyaW5nfSBTVkdfU0laRVxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSVxuICAgICAgICAgKiBAc2VlIFBJWEkucmVzb3VyY2VzLlNWR1Jlc291cmNlLlNWR19TSVpFXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBTVkdfU0laRToge1xuICAgICAgICAgICAgZ2V0KCk6IFJlZ0V4cFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS51dGlscy5TVkdfU0laRSBwcm9wZXJ0eSBoYXMgbW92ZWQgdG8gUElYSS5yZXNvdXJjZXMuU1ZHUmVzb3VyY2UuU1ZHX1NJWkUnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlNWR1Jlc291cmNlLlNWR19TSVpFO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuVHJhbnNmb3JtU3RhdGljXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqIEBzZWUgUElYSS5UcmFuc2Zvcm1cbiAgICAgICAgICovXG4gICAgICAgIFRyYW5zZm9ybVN0YXRpYzoge1xuICAgICAgICAgICAgZ2V0KCk6IFRyYW5zZm9ybVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5UcmFuc2Zvcm1TdGF0aWMgY2xhc3MgaGFzIGJlZW4gcmVtb3ZlZCwgdXNlIFBJWEkuVHJhbnNmb3JtJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5UcmFuc2Zvcm07XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5UcmFuc2Zvcm1CYXNlXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqIEBzZWUgUElYSS5UcmFuc2Zvcm1cbiAgICAgICAgICovXG4gICAgICAgIFRyYW5zZm9ybUJhc2U6IHtcbiAgICAgICAgICAgIGdldCgpOiBUcmFuc2Zvcm1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuVHJhbnNmb3JtQmFzZSBjbGFzcyBoYXMgYmVlbiByZW1vdmVkLCB1c2UgUElYSS5UcmFuc2Zvcm0nKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlRyYW5zZm9ybTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnN0YW50cyB0aGF0IHNwZWNpZnkgdGhlIHRyYW5zZm9ybSB0eXBlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAc3RhdGljXG4gICAgICAgICAqIEBjb25zdGFudFxuICAgICAgICAgKiBAbmFtZSBUUkFOU0ZPUk1fTU9ERVxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSVxuICAgICAgICAgKiBAZW51bSB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAcHJvcGVydHkge251bWJlcn0gU1RBVElDXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBEWU5BTUlDXG4gICAgICAgICAqL1xuICAgICAgICBUUkFOU0ZPUk1fTU9ERToge1xuICAgICAgICAgICAgZ2V0KCk6IHtbbmFtZTogc3RyaW5nXTogbnVtYmVyfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5UUkFOU0ZPUk1fTU9ERSBwcm9wZXJ0eSBoYXMgYmVlbiByZW1vdmVkJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4geyBTVEFUSUM6IDAsIERZTkFNSUM6IDEgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLldlYkdMUmVuZGVyZXJcbiAgICAgICAgICogQHNlZSBQSVhJLlJlbmRlcmVyXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBXZWJHTFJlbmRlcmVyOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIFJlbmRlcmVyXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLldlYkdMUmVuZGVyZXIgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuUmVuZGVyZXInKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlJlbmRlcmVyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuQ2FudmFzUmVuZGVyVGFyZ2V0XG4gICAgICAgICAqIEBzZWUgUElYSS51dGlscy5DYW52YXNSZW5kZXJUYXJnZXRcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIENhbnZhc1JlbmRlclRhcmdldDoge1xuICAgICAgICAgICAgZ2V0KCk6IENhbnZhc1JlbmRlclRhcmdldFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5DYW52YXNSZW5kZXJUYXJnZXQgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkudXRpbHMuQ2FudmFzUmVuZGVyVGFyZ2V0Jyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS51dGlscy5DYW52YXNSZW5kZXJUYXJnZXQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSVxuICAgICAgICAgKiBAbmFtZSBsb2FkZXJcbiAgICAgICAgICogQHR5cGUge1BJWEkuTG9hZGVyfVxuICAgICAgICAgKiBAc2VlIFBJWEkuTG9hZGVyLnNoYXJlZFxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKi9cbiAgICAgICAgbG9hZGVyOiB7XG4gICAgICAgICAgICBnZXQoKTogTG9hZGVyXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmxvYWRlciBpbnN0YW5jZSBoYXMgbW92ZWQgdG8gUElYSS5Mb2FkZXIuc2hhcmVkJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5Mb2FkZXIuc2hhcmVkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuRmlsdGVyTWFuYWdlclxuICAgICAgICAgKiBAc2VlIFBJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW1cbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIEZpbHRlck1hbmFnZXI6IHtcbiAgICAgICAgICAgIGdldCgpOiBzeXN0ZW1zLkZpbHRlclN5c3RlbVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5GaWx0ZXJNYW5hZ2VyIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLnN5c3RlbXMuRmlsdGVyU3lzdGVtJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuYW1lc3BhY2UgUElYSS5DYW52YXNUaW50ZXJcbiAgICAgICAgICogQHNlZSBQSVhJLmNhbnZhc1V0aWxzXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMi4wXG4gICAgICAgICAqL1xuICAgICAgICBDYW52YXNUaW50ZXI6IHtcbiAgICAgICAgICAgIGdldCgpOiAkRml4TGVnYWN5XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4wJywgJ1BJWEkuQ2FudmFzVGludGVyIG5hbWVzcGFjZSBoYXMgbW92ZWQgdG8gUElYSS5jYW52YXNVdGlscycpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuY2FudmFzVXRpbHM7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmFtZXNwYWNlIFBJWEkuR3JvdXBEOFxuICAgICAgICAgKiBAc2VlIFBJWEkuZ3JvdXBEOFxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjIuMFxuICAgICAgICAgKi9cbiAgICAgICAgR3JvdXBEODoge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBncm91cEQ4XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4wJywgJ1BJWEkuR3JvdXBEOCBuYW1lc3BhY2UgaGFzIG1vdmVkIHRvIFBJWEkuZ3JvdXBEOCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuZ3JvdXBEODtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAbmFtZXNwYWNlIFBJWEkuYWNjZXNzaWJpbGl0eVxuICAgICAqIEBzZWUgUElYSVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMy4wXG4gICAgICovXG4gICAgUElYSS5hY2Nlc3NpYmlsaXR5ID0ge307XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhQSVhJLmFjY2Vzc2liaWxpdHksIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmFjY2Vzc2liaWxpdHkuQWNjZXNzaWJpbGl0eU1hbmFnZXJcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgICAgICogQHNlZSBQSVhJLkFjY2Vzc2liaWxpdHlNYW5hZ2VyXG4gICAgICAgICAqL1xuICAgICAgICBBY2Nlc3NpYmlsaXR5TWFuYWdlcjoge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBBY2Nlc3NpYmlsaXR5TWFuYWdlclxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdQSVhJLmFjY2Vzc2liaWxpdHkuQWNjZXNzaWJpbGl0eU1hbmFnZXIgbW92ZWQgdG8gUElYSS5BY2Nlc3NpYmlsaXR5TWFuYWdlcicpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuQWNjZXNzaWJpbGl0eU1hbmFnZXI7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQG5hbWVzcGFjZSBQSVhJLmludGVyYWN0aW9uXG4gICAgICogQHNlZSBQSVhJXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgKi9cbiAgICBQSVhJLmludGVyYWN0aW9uID0ge307XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhQSVhJLmludGVyYWN0aW9uLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5pbnRlcmFjdGlvbi5JbnRlcmFjdGlvbk1hbmFnZXJcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgICAgICogQHNlZSBQSVhJLkludGVyYWN0aW9uTWFuYWdlclxuICAgICAgICAgKi9cbiAgICAgICAgSW50ZXJhY3Rpb25NYW5hZ2VyOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIEludGVyYWN0aW9uTWFuYWdlclxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdQSVhJLmludGVyYWN0aW9uLkludGVyYWN0aW9uTWFuYWdlciBtb3ZlZCB0byBQSVhJLkludGVyYWN0aW9uTWFuYWdlcicpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuSW50ZXJhY3Rpb25NYW5hZ2VyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuaW50ZXJhY3Rpb24uSW50ZXJhY3Rpb25EYXRhXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMy4wXG4gICAgICAgICAqIEBzZWUgUElYSS5JbnRlcmFjdGlvbkRhdGFcbiAgICAgICAgICovXG4gICAgICAgIEludGVyYWN0aW9uRGF0YToge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBJbnRlcmFjdGlvbkRhdGFcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbignNS4zLjAnLCAnUElYSS5pbnRlcmFjdGlvbi5JbnRlcmFjdGlvbkRhdGEgbW92ZWQgdG8gUElYSS5JbnRlcmFjdGlvbkRhdGEnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLkludGVyYWN0aW9uRGF0YTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmludGVyYWN0aW9uLkludGVyYWN0aW9uRXZlbnRcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgICAgICogQHNlZSBQSVhJLkludGVyYWN0aW9uRXZlbnRcbiAgICAgICAgICovXG4gICAgICAgIEludGVyYWN0aW9uRXZlbnQ6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgSW50ZXJhY3Rpb25FdmVudFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdQSVhJLmludGVyYWN0aW9uLkludGVyYWN0aW9uRXZlbnQgbW92ZWQgdG8gUElYSS5JbnRlcmFjdGlvbkV2ZW50Jyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5JbnRlcmFjdGlvbkV2ZW50O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBuYW1lc3BhY2UgUElYSS5wcmVwYXJlXG4gICAgICogQHNlZSBQSVhJXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4yLjFcbiAgICAgKi9cbiAgICBQSVhJLnByZXBhcmUgPSB7fTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBJWEkucHJlcGFyZSwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkucHJlcGFyZS5CYXNlUHJlcGFyZVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjIuMVxuICAgICAgICAgKiBAc2VlIFBJWEkuQmFzZVByZXBhcmVcbiAgICAgICAgICovXG4gICAgICAgIEJhc2VQcmVwYXJlOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIEJhc2VQcmVwYXJlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4xJywgJ1BJWEkucHJlcGFyZS5CYXNlUHJlcGFyZSBtb3ZlZCB0byBQSVhJLkJhc2VQcmVwYXJlJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5CYXNlUHJlcGFyZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5wcmVwYXJlLlByZXBhcmVcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4yLjFcbiAgICAgICAgICogQHNlZSBQSVhJLlByZXBhcmVcbiAgICAgICAgICovXG4gICAgICAgIFByZXBhcmU6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgUHJlcGFyZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMScsICdQSVhJLnByZXBhcmUuUHJlcGFyZSBtb3ZlZCB0byBQSVhJLlByZXBhcmUnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlByZXBhcmU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkucHJlcGFyZS5DYW52YXNQcmVwYXJlXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMi4xXG4gICAgICAgICAqIEBzZWUgUElYSS5DYW52YXNQcmVwYXJlXG4gICAgICAgICAqL1xuICAgICAgICBDYW52YXNQcmVwYXJlOiB7XG4gICAgICAgICAgICBnZXQoKTogJEZpeExlZ2FjeVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMScsICdQSVhJLnByZXBhcmUuQ2FudmFzUHJlcGFyZSBtb3ZlZCB0byBQSVhJLkNhbnZhc1ByZXBhcmUnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLkNhbnZhc1ByZXBhcmU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQG5hbWVzcGFjZSBQSVhJLmV4dHJhY3RcbiAgICAgKiBAc2VlIFBJWElcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjIuMVxuICAgICAqL1xuICAgIFBJWEkuZXh0cmFjdCA9IHt9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUElYSS5leHRyYWN0LCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5leHRyYWN0LkV4dHJhY3RcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4yLjFcbiAgICAgICAgICogQHNlZSBQSVhJLkV4dHJhY3RcbiAgICAgICAgICovXG4gICAgICAgIEV4dHJhY3Q6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgRXh0cmFjdFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMScsICdQSVhJLmV4dHJhY3QuRXh0cmFjdCBtb3ZlZCB0byBQSVhJLkV4dHJhY3QnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLkV4dHJhY3Q7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuZXh0cmFjdC5DYW52YXNFeHRyYWN0XG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMi4xXG4gICAgICAgICAqIEBzZWUgUElYSS5DYW52YXNFeHRyYWN0XG4gICAgICAgICAqL1xuICAgICAgICBDYW52YXNFeHRyYWN0OiB7XG4gICAgICAgICAgICBnZXQoKTogJEZpeExlZ2FjeVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMScsICdQSVhJLmV4dHJhY3QuQ2FudmFzRXh0cmFjdCBtb3ZlZCB0byBQSVhJLkNhbnZhc0V4dHJhY3QnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLkNhbnZhc0V4dHJhY3Q7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBuYW1lc3BhY2UgaGFzIGJlZW4gcmVtb3ZlZC4gQWxsIGNsYXNzZXMgcHJldmlvdXMgbmVzdGVkXG4gICAgICogdW5kZXIgdGhpcyBuYW1lc3BhY2UgaGF2ZSBiZWVuIG1vdmVkIHRvIHRoZSB0b3AtbGV2ZWwgYFBJWElgIG9iamVjdC5cbiAgICAgKiBAbmFtZXNwYWNlIFBJWEkuZXh0cmFzXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKi9cbiAgICBQSVhJLmV4dHJhcyA9IHt9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUElYSS5leHRyYXMsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmV4dHJhcy5UaWxpbmdTcHJpdGVcbiAgICAgICAgICogQHNlZSBQSVhJLlRpbGluZ1Nwcml0ZVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKi9cbiAgICAgICAgVGlsaW5nU3ByaXRlOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIFRpbGluZ1Nwcml0ZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5leHRyYXMuVGlsaW5nU3ByaXRlIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLlRpbGluZ1Nwcml0ZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuVGlsaW5nU3ByaXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmV4dHJhcy5UaWxpbmdTcHJpdGVSZW5kZXJlclxuICAgICAgICAgKiBAc2VlIFBJWEkuVGlsaW5nU3ByaXRlUmVuZGVyZXJcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIFRpbGluZ1Nwcml0ZVJlbmRlcmVyOiB7XG4gICAgICAgICAgICBnZXQoKTogJEZpeExlZ2FjeVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5leHRyYXMuVGlsaW5nU3ByaXRlUmVuZGVyZXIgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuVGlsaW5nU3ByaXRlUmVuZGVyZXInKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlRpbGluZ1Nwcml0ZVJlbmRlcmVyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmV4dHJhcy5BbmltYXRlZFNwcml0ZVxuICAgICAgICAgKiBAc2VlIFBJWEkuQW5pbWF0ZWRTcHJpdGVcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIEFuaW1hdGVkU3ByaXRlOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIEFuaW1hdGVkU3ByaXRlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmV4dHJhcy5BbmltYXRlZFNwcml0ZSBjbGFzcyBoYXMgbW92ZWQgdG8gUElYSS5BbmltYXRlZFNwcml0ZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuQW5pbWF0ZWRTcHJpdGU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkuZXh0cmFzLkJpdG1hcFRleHRcbiAgICAgICAgICogQHNlZSBQSVhJLkJpdG1hcFRleHRcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIEJpdG1hcFRleHQ6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgQml0bWFwVGV4dFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5leHRyYXMuQml0bWFwVGV4dCBjbGFzcyBoYXMgbW92ZWQgdG8gUElYSS5CaXRtYXBUZXh0Jyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5CaXRtYXBUZXh0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWV0aG9kIFBJWEkuVGlsaW5nU3ByaXRlLmZyb21GcmFtZVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMy4wXG4gICAgICogQHNlZSBQSVhJLlRpbGluZ1Nwcml0ZS5mcm9tXG4gICAgICovXG4gICAgUElYSS5UaWxpbmdTcHJpdGUuZnJvbUZyYW1lID0gZnVuY3Rpb24gZnJvbUZyYW1lKGZyYW1lSWQ6IHN0cmluZywgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiBUaWxpbmdTcHJpdGVcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKCc1LjMuMCcsICdUaWxpbmdTcHJpdGUuZnJvbUZyYW1lIGlzIGRlcHJlY2F0ZWQsIHVzZSBUaWxpbmdTcHJpdGUuZnJvbScpO1xuXG4gICAgICAgIHJldHVybiBQSVhJLlRpbGluZ1Nwcml0ZS5mcm9tKGZyYW1lSWQsIHsgd2lkdGgsIGhlaWdodCB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZXRob2QgUElYSS5UaWxpbmdTcHJpdGUuZnJvbUltYWdlXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4zLjBcbiAgICAgKiBAc2VlIFBJWEkuVGlsaW5nU3ByaXRlLmZyb21cbiAgICAgKi9cbiAgICBQSVhJLlRpbGluZ1Nwcml0ZS5mcm9tSW1hZ2UgPSBmdW5jdGlvbiBmcm9tSW1hZ2UoXG4gICAgICAgIGltYWdlSWQ6IHN0cmluZyxcbiAgICAgICAgd2lkdGg6IG51bWJlcixcbiAgICAgICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgICAgIG9wdGlvbnM6IGFueSA9IHt9KTogVGlsaW5nU3ByaXRlXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbignNS4zLjAnLCAnVGlsaW5nU3ByaXRlLmZyb21JbWFnZSBpcyBkZXByZWNhdGVkLCB1c2UgVGlsaW5nU3ByaXRlLmZyb20nKTtcblxuICAgICAgICAvLyBGYWxsYmFjayBzdXBwb3J0IGZvciBjcm9zc29yaWdpbiwgc2NhbGVNb2RlIHBhcmFtZXRlcnNcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKVxuICAgICAgICB7XG4gICAgICAgICAgICBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItcmVzdC1wYXJhbXNcbiAgICAgICAgICAgICAgICBzY2FsZU1vZGU6IGFyZ3VtZW50c1s0XSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZU9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1yZXN0LXBhcmFtc1xuICAgICAgICAgICAgICAgICAgICBjcm9zc29yaWdpbjogYXJndW1lbnRzWzNdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgb3B0aW9ucy53aWR0aCA9IHdpZHRoO1xuICAgICAgICBvcHRpb25zLmhlaWdodCA9IGhlaWdodDtcblxuICAgICAgICByZXR1cm4gUElYSS5UaWxpbmdTcHJpdGUuZnJvbShpbWFnZUlkLCBvcHRpb25zKTtcbiAgICB9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUElYSS51dGlscywge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGZ1bmN0aW9uIFBJWEkudXRpbHMuZ2V0U3ZnU2l6ZVxuICAgICAgICAgKiBAc2VlIFBJWEkucmVzb3VyY2VzLlNWR1Jlc291cmNlLmdldFNpemVcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIGdldFN2Z1NpemU6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgcmVzb3VyY2VzLlNWR1Jlc291cmNlLmdldFNpemVcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkudXRpbHMuZ2V0U3ZnU2l6ZSBmdW5jdGlvbiBoYXMgbW92ZWQgdG8gUElYSS5yZXNvdXJjZXMuU1ZHUmVzb3VyY2UuZ2V0U2l6ZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkucmVzb3VyY2VzLlNWR1Jlc291cmNlLmdldFNpemU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQWxsIGNsYXNzZXMgb24gdGhpcyBuYW1lc3BhY2UgaGF2ZSBtb3ZlZCB0byB0aGUgaGlnaC1sZXZlbCBgUElYSWAgb2JqZWN0LlxuICAgICAqIEBuYW1lc3BhY2UgUElYSS5tZXNoXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKi9cbiAgICBQSVhJLm1lc2ggPSB7fTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBJWEkubWVzaCwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkubWVzaC5NZXNoXG4gICAgICAgICAqIEBzZWUgUElYSS5TaW1wbGVNZXNoXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBNZXNoOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIFNpbXBsZU1lc2hcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkubWVzaC5NZXNoIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLlNpbXBsZU1lc2gnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlNpbXBsZU1lc2g7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkubWVzaC5OaW5lU2xpY2VQbGFuZVxuICAgICAgICAgKiBAc2VlIFBJWEkuTmluZVNsaWNlUGxhbmVcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIE5pbmVTbGljZVBsYW5lOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIE5pbmVTbGljZVBsYW5lXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLm1lc2guTmluZVNsaWNlUGxhbmUgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuTmluZVNsaWNlUGxhbmUnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLk5pbmVTbGljZVBsYW5lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLm1lc2guUGxhbmVcbiAgICAgICAgICogQHNlZSBQSVhJLlNpbXBsZVBsYW5lXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBQbGFuZToge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBTaW1wbGVQbGFuZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5tZXNoLlBsYW5lIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLlNpbXBsZVBsYW5lJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5TaW1wbGVQbGFuZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5tZXNoLlJvcGVcbiAgICAgICAgICogQHNlZSBQSVhJLlNpbXBsZVJvcGVcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIFJvcGU6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgU2ltcGxlUm9wZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5tZXNoLlJvcGUgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuU2ltcGxlUm9wZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuU2ltcGxlUm9wZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5tZXNoLlJhd01lc2hcbiAgICAgICAgICogQHNlZSBQSVhJLk1lc2hcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIFJhd01lc2g6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgTWVzaFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5tZXNoLlJhd01lc2ggY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuTWVzaCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuTWVzaDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5tZXNoLkNhbnZhc01lc2hSZW5kZXJlclxuICAgICAgICAgKiBAc2VlIFBJWEkuQ2FudmFzTWVzaFJlbmRlcmVyXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBDYW52YXNNZXNoUmVuZGVyZXI6IHtcbiAgICAgICAgICAgIGdldCgpOiAkRml4TGVnYWN5XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLm1lc2guQ2FudmFzTWVzaFJlbmRlcmVyIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLkNhbnZhc01lc2hSZW5kZXJlcicpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuQ2FudmFzTWVzaFJlbmRlcmVyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLm1lc2guTWVzaFJlbmRlcmVyXG4gICAgICAgICAqIEBzZWUgUElYSS5NZXNoUmVuZGVyZXJcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIE1lc2hSZW5kZXJlcjoge1xuICAgICAgICAgICAgZ2V0KCk6ICRGaXhMZWdhY3lcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkubWVzaC5NZXNoUmVuZGVyZXIgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuTWVzaFJlbmRlcmVyJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5NZXNoUmVuZGVyZXI7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBuYW1lc3BhY2UgaGFzIGJlZW4gcmVtb3ZlZCBhbmQgaXRlbXMgaGF2ZSBiZWVuIG1vdmVkIHRvXG4gICAgICogdGhlIHRvcC1sZXZlbCBgUElYSWAgb2JqZWN0LlxuICAgICAqIEBuYW1lc3BhY2UgUElYSS5wYXJ0aWNsZXNcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqL1xuICAgIFBJWEkucGFydGljbGVzID0ge307XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhQSVhJLnBhcnRpY2xlcywge1xuICAgICAgICAvKipcbiAgICAgICAgICogQGNsYXNzIFBJWEkucGFydGljbGVzLlBhcnRpY2xlQ29udGFpbmVyXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqIEBzZWUgUElYSS5QYXJ0aWNsZUNvbnRhaW5lclxuICAgICAgICAgKi9cbiAgICAgICAgUGFydGljbGVDb250YWluZXI6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgUGFydGljbGVDb250YWluZXJcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkucGFydGljbGVzLlBhcnRpY2xlQ29udGFpbmVyIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLlBhcnRpY2xlQ29udGFpbmVyJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5QYXJ0aWNsZUNvbnRhaW5lcjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5wYXJ0aWNsZXMuUGFydGljbGVSZW5kZXJlclxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAc2VlIFBJWEkuUGFydGljbGVSZW5kZXJlclxuICAgICAgICAgKi9cbiAgICAgICAgUGFydGljbGVSZW5kZXJlcjoge1xuICAgICAgICAgICAgZ2V0KCk6ICRGaXhMZWdhY3lcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkucGFydGljbGVzLlBhcnRpY2xlUmVuZGVyZXIgY2xhc3MgaGFzIG1vdmVkIHRvIFBJWEkuUGFydGljbGVSZW5kZXJlcicpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuUGFydGljbGVSZW5kZXJlcjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG5hbWVzcGFjZSBoYXMgYmVlbiByZW1vdmVkIGFuZCBpdGVtcyBoYXZlIGJlZW4gbW92ZWQgdG9cbiAgICAgKiB0aGUgdG9wLWxldmVsIGBQSVhJYCBvYmplY3QuXG4gICAgICogQG5hbWVzcGFjZSBQSVhJLnRpY2tlclxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICovXG4gICAgUElYSS50aWNrZXIgPSB7fTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBJWEkudGlja2VyLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS50aWNrZXIuVGlja2VyXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqIEBzZWUgUElYSS5UaWNrZXJcbiAgICAgICAgICovXG4gICAgICAgIFRpY2tlcjoge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBUaWNrZXJcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkudGlja2VyLlRpY2tlciBjbGFzcyBoYXMgbW92ZWQgdG8gUElYSS5UaWNrZXInKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBQSVhJLlRpY2tlcjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmFtZSBQSVhJLnRpY2tlci5zaGFyZWRcbiAgICAgICAgICogQHR5cGUge1BJWEkuVGlja2VyfVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAc2VlIFBJWEkuVGlja2VyLnNoYXJlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2hhcmVkOiB7XG4gICAgICAgICAgICBnZXQoKTogVGlja2VyXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLnRpY2tlci5zaGFyZWQgaW5zdGFuY2UgaGFzIG1vdmVkIHRvIFBJWEkuVGlja2VyLnNoYXJlZCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuVGlja2VyLnNoYXJlZDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBbGwgY2xhc3NlcyBvbiB0aGlzIG5hbWVzcGFjZSBoYXZlIG1vdmVkIHRvIHRoZSBoaWdoLWxldmVsIGBQSVhJYCBvYmplY3QuXG4gICAgICogQG5hbWVzcGFjZSBQSVhJLmxvYWRlcnNcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqL1xuICAgIFBJWEkubG9hZGVycyA9IHt9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoUElYSS5sb2FkZXJzLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAY2xhc3MgUElYSS5sb2FkZXJzLkxvYWRlclxuICAgICAgICAgKiBAc2VlIFBJWEkuTG9hZGVyXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBMb2FkZXI6IHtcbiAgICAgICAgICAgIGdldCgpOiB0eXBlb2YgTG9hZGVyXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmxvYWRlcnMuTG9hZGVyIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLkxvYWRlcicpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuTG9hZGVyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBjbGFzcyBQSVhJLmxvYWRlcnMuUmVzb3VyY2VcbiAgICAgICAgICogQHNlZSBQSVhJLkxvYWRlclJlc291cmNlXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBMb2FkZXJSZXNvdXJjZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5sb2FkZXJzLlJlc291cmNlIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLkxvYWRlclJlc291cmNlJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5Mb2FkZXJSZXNvdXJjZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZnVuY3Rpb24gUElYSS5sb2FkZXJzLmJpdG1hcEZvbnRQYXJzZXJcbiAgICAgICAgICogQHNlZSBQSVhJLkJpdG1hcEZvbnRMb2FkZXIudXNlXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBiaXRtYXBGb250UGFyc2VyOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIEJpdG1hcEZvbnRMb2FkZXIudXNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmxvYWRlcnMuYml0bWFwRm9udFBhcnNlciBmdW5jdGlvbiBoYXMgbW92ZWQgdG8gUElYSS5CaXRtYXBGb250TG9hZGVyLnVzZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuQml0bWFwRm9udExvYWRlci51c2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQGZ1bmN0aW9uIFBJWEkubG9hZGVycy5wYXJzZUJpdG1hcEZvbnREYXRhXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBwYXJzZUJpdG1hcEZvbnREYXRhOiB7XG4gICAgICAgICAgICBnZXQoKTogdm9pZFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5sb2FkZXJzLnBhcnNlQml0bWFwRm9udERhdGEgZnVuY3Rpb24gaGFzIHJlbW92ZWQnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZnVuY3Rpb24gUElYSS5sb2FkZXJzLnNwcml0ZXNoZWV0UGFyc2VyXG4gICAgICAgICAqIEBzZWUgUElYSS5TcHJpdGVzaGVldExvYWRlci51c2VcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIHNwcml0ZXNoZWV0UGFyc2VyOiB7XG4gICAgICAgICAgICBnZXQoKTogdHlwZW9mIFNwcml0ZXNoZWV0TG9hZGVyLnVzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5sb2FkZXJzLnNwcml0ZXNoZWV0UGFyc2VyIGZ1bmN0aW9uIGhhcyBtb3ZlZCB0byBQSVhJLlNwcml0ZXNoZWV0TG9hZGVyLnVzZScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBJWEkuU3ByaXRlc2hlZXRMb2FkZXIudXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBmdW5jdGlvbiBQSVhJLmxvYWRlcnMuZ2V0UmVzb3VyY2VQYXRoXG4gICAgICAgICAqIEBzZWUgUElYSS5TcHJpdGVzaGVldExvYWRlci5nZXRSZXNvdXJjZVBhdGhcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICovXG4gICAgICAgIGdldFJlc291cmNlUGF0aDoge1xuICAgICAgICAgICAgZ2V0KCk6IHR5cGVvZiBTcHJpdGVzaGVldExvYWRlci5nZXRSZXNvdXJjZVBhdGhcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkubG9hZGVycy5nZXRSZXNvdXJjZVBhdGggcHJvcGVydHkgaGFzIG1vdmVkIHRvIFBJWEkuU3ByaXRlc2hlZXRMb2FkZXIuZ2V0UmVzb3VyY2VQYXRoJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUElYSS5TcHJpdGVzaGVldExvYWRlci5nZXRSZXNvdXJjZVBhdGg7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQGZ1bmN0aW9uIFBJWEkubG9hZGVycy5Mb2FkZXIuYWRkUGl4aU1pZGRsZXdhcmVcbiAgICAgKiBAc2VlIFBJWEkuTG9hZGVyLnJlZ2lzdGVyUGx1Z2luXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtaWRkbGV3YXJlXG4gICAgICovXG4gICAgUElYSS5Mb2FkZXIuYWRkUGl4aU1pZGRsZXdhcmUgPSBmdW5jdGlvbiBhZGRQaXhpTWlkZGxld2FyZShtaWRkbGV3YXJlOiBhbnkpOiB0eXBlb2YgTG9hZGVyXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbih2NSxcbiAgICAgICAgICAgICdQSVhJLmxvYWRlcnMuTG9hZGVyLmFkZFBpeGlNaWRkbGV3YXJlIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQsIHVzZSBQSVhJLmxvYWRlcnMuTG9hZGVyLnJlZ2lzdGVyUGx1Z2luJ1xuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBQSVhJLmxvYWRlcnMuTG9hZGVyLnJlZ2lzdGVyUGx1Z2luKHsgdXNlOiBtaWRkbGV3YXJlKCkgfSk7XG4gICAgfTtcblxuICAgIC8vIGNvbnZlbmllbmNlIGZvciBjb252ZXJ0aW5nIGV2ZW50IG5hbWUgdG8gc2lnbmFsIG5hbWVcbiAgICBjb25zdCBldmVudFRvU2lnbmFsID0gKGV2ZW50OiBhbnkpOiBzdHJpbmcgPT5cbiAgICAgICAgYG9uJHtldmVudC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke2V2ZW50LnNsaWNlKDEpfWA7XG5cbiAgICBPYmplY3QuYXNzaWduKFBJWEkuTG9hZGVyLnByb3RvdHlwZSxcbiAgICAgICAge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2UgdGhlIGNvcnJlc3BvbmRpbmcgc2lnbmFsLCBlLmcuLCBldmVudCBgc3RhcnRgYCBpcyBzaWduYWwgYG9uU3RhcnRgLlxuICAgICAgICAgICAgICogQG1ldGhvZCBQSVhJLkxvYWRlciNvblxuICAgICAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb24oZXZlbnQ6IGFueSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWduYWwgPSBldmVudFRvU2lnbmFsKGV2ZW50KTtcblxuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCBgUElYSS5Mb2FkZXIjb24gaXMgY29tcGxldGVseSBkZXByZWNhdGVkLCB1c2UgUElYSS5Mb2FkZXIjJHtzaWduYWx9LmFkZGApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVXNlIHRoZSBjb3JyZXNwb25kaW5nIHNpZ25hbCwgZS5nLiwgZXZlbnQgYHN0YXJ0YGAgaXMgc2lnbmFsIGBvblN0YXJ0YC5cbiAgICAgICAgICAgICAqIEBtZXRob2QgUElYSS5Mb2FkZXIjb25jZVxuICAgICAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25jZShldmVudDogYW55KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpZ25hbCA9IGV2ZW50VG9TaWduYWwoZXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsIGBQSVhJLkxvYWRlciNvbmNlIGlzIGNvbXBsZXRlbHkgZGVwcmVjYXRlZCwgdXNlIFBJWEkuTG9hZGVyIyR7c2lnbmFsfS5vbmNlYCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBVc2UgdGhlIGNvcnJlc3BvbmRpbmcgc2lnbmFsLCBlLmcuLCBldmVudCBgc3RhcnRgYCBpcyBzaWduYWwgYG9uU3RhcnRgLlxuICAgICAgICAgICAgICogQG1ldGhvZCBQSVhJLkxvYWRlciNvZmZcbiAgICAgICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9mZihldmVudDogYW55KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpZ25hbCA9IGV2ZW50VG9TaWduYWwoZXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsIGBQSVhJLkxvYWRlciNvZmYgaXMgY29tcGxldGVseSBkZXByZWNhdGVkLCB1c2UgUElYSS5Mb2FkZXIjJHtzaWduYWx9LmRldGFjaGApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAY2xhc3MgUElYSS5leHRyYWN0LldlYkdMRXh0cmFjdFxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLkV4dHJhY3RcbiAgICAgKi9cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUElYSS5leHRyYWN0LCAnV2ViR0xFeHRyYWN0Jywge1xuICAgICAgICBnZXQoKTogdHlwZW9mIEV4dHJhY3RcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmV4dHJhY3QuV2ViR0xFeHRyYWN0IG1ldGhvZCBoYXMgbW92ZWQgdG8gUElYSS5FeHRyYWN0Jyk7XG5cbiAgICAgICAgICAgIHJldHVybiBQSVhJLkV4dHJhY3Q7XG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAY2xhc3MgUElYSS5wcmVwYXJlLldlYkdMUHJlcGFyZVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLlByZXBhcmVcbiAgICAgKi9cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUElYSS5wcmVwYXJlLCAnV2ViR0xQcmVwYXJlJywge1xuICAgICAgICBnZXQoKTogdHlwZW9mIFByZXBhcmVcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLnByZXBhcmUuV2ViR0xQcmVwYXJlIGNsYXNzIGhhcyBtb3ZlZCB0byBQSVhJLlByZXBhcmUnKTtcblxuICAgICAgICAgICAgcmV0dXJuIFBJWEkuUHJlcGFyZTtcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5Db250YWluZXIjX3JlbmRlcldlYkdMXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBzZWUgUElYSS5Db250YWluZXIjcmVuZGVyXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciBJbnN0YW5jZSBvZiByZW5kZXJlclxuICAgICAqL1xuICAgIFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZS5fcmVuZGVyV2ViR0wgPSBmdW5jdGlvbiBfcmVuZGVyV2ViR0wodGhpczogQ29udGFpbmVyLCByZW5kZXJlcjogUmVuZGVyZXIpOiB2b2lkXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuQ29udGFpbmVyLl9yZW5kZXJXZWJHTCBtZXRob2QgaGFzIG1vdmVkIHRvIFBJWEkuQ29udGFpbmVyLl9yZW5kZXInKTtcblxuICAgICAgICB0aGlzLl9yZW5kZXIocmVuZGVyZXIpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIFBJWEkuQ29udGFpbmVyI3JlbmRlcldlYkdMXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAc2VlIFBJWEkuQ29udGFpbmVyI3JlbmRlclxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgSW5zdGFuY2Ugb2YgcmVuZGVyZXJcbiAgICAgKi9cbiAgICBQSVhJLkNvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyV2ViR0wgPSBmdW5jdGlvbiByZW5kZXJXZWJHTCh0aGlzOiBDb250YWluZXIsIHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5Db250YWluZXIucmVuZGVyV2ViR0wgbWV0aG9kIGhhcyBtb3ZlZCB0byBQSVhJLkNvbnRhaW5lci5yZW5kZXInKTtcblxuICAgICAgICB0aGlzLnJlbmRlcihyZW5kZXJlcik7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5EaXNwbGF5T2JqZWN0I3JlbmRlcldlYkdMXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAc2VlIFBJWEkuRGlzcGxheU9iamVjdCNyZW5kZXJcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIEluc3RhbmNlIG9mIHJlbmRlcmVyXG4gICAgICovXG4gICAgUElYSS5EaXNwbGF5T2JqZWN0LnByb3RvdHlwZS5yZW5kZXJXZWJHTCA9IGZ1bmN0aW9uIHJlbmRlcldlYkdMKHRoaXM6IERpc3BsYXlPYmplY3QsIHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5EaXNwbGF5T2JqZWN0LnJlbmRlcldlYkdMIG1ldGhvZCBoYXMgbW92ZWQgdG8gUElYSS5EaXNwbGF5T2JqZWN0LnJlbmRlcicpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyKHJlbmRlcmVyKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG1ldGhvZCBQSVhJLkNvbnRhaW5lciNyZW5kZXJBZHZhbmNlZFdlYkdMXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAc2VlIFBJWEkuQ29udGFpbmVyI3JlbmRlckFkdmFuY2VkXG4gICAgICogQHBhcmFtIHtQSVhJLlJlbmRlcmVyfSByZW5kZXJlciBJbnN0YW5jZSBvZiByZW5kZXJlclxuICAgICAqL1xuICAgIFBJWEkuQ29udGFpbmVyLnByb3RvdHlwZS5yZW5kZXJBZHZhbmNlZFdlYkdMID0gZnVuY3Rpb24gcmVuZGVyQWR2YW5jZWRXZWJHTCh0aGlzOiBDb250YWluZXIsIHJlbmRlcmVyOiBSZW5kZXJlcik6IHZvaWRcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5Db250YWluZXIucmVuZGVyQWR2YW5jZWRXZWJHTCBtZXRob2QgaGFzIG1vdmVkIHRvIFBJWEkuQ29udGFpbmVyLnJlbmRlckFkdmFuY2VkJyk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJBZHZhbmNlZChyZW5kZXJlcik7XG4gICAgfTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFBJWEkuc2V0dGluZ3MsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZmF1bHQgdHJhbnNmb3JtIHR5cGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBzdGF0aWNcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQG1lbWJlcm9mIFBJWEkuc2V0dGluZ3NcbiAgICAgICAgICogQHR5cGUge1BJWEkuVFJBTlNGT1JNX01PREV9XG4gICAgICAgICAqIEBkZWZhdWx0IFBJWEkuVFJBTlNGT1JNX01PREUuU1RBVElDXG4gICAgICAgICAqL1xuICAgICAgICBUUkFOU0ZPUk1fTU9ERToge1xuICAgICAgICAgICAgZ2V0KCk6IG51bWJlclxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5zZXR0aW5ncy5UUkFOU0ZPUk1fTU9ERSBwcm9wZXJ0eSBoYXMgYmVlbiByZW1vdmVkJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoKTogdm9pZFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5zZXR0aW5ncy5UUkFOU0ZPUk1fTU9ERSBwcm9wZXJ0eSBoYXMgYmVlbiByZW1vdmVkJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyBCYXNlVGV4dHVyZTogQmFzZVRleHR1cmVBbnkgfSA9IFBJWEk7XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIGxvYWRTb3VyY2VcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5CYXNlVGV4dHVyZSNcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqL1xuICAgIEJhc2VUZXh0dXJlQW55LnByb3RvdHlwZS5sb2FkU291cmNlID0gZnVuY3Rpb24gbG9hZFNvdXJjZShpbWFnZTogc3RyaW5nIHwgSFRNTEltYWdlRWxlbWVudCk6IHZvaWRcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5CYXNlVGV4dHVyZS5sb2FkU291cmNlIG1ldGhvZCBoYXMgYmVlbiBkZXByZWNhdGVkJyk7XG5cbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSBQSVhJLnJlc291cmNlcy5hdXRvRGV0ZWN0UmVzb3VyY2UoaW1hZ2UpO1xuXG4gICAgICAgIHJlc291cmNlLmludGVybmFsID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLnNldFJlc291cmNlKHJlc291cmNlKTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9O1xuXG4gICAgbGV0IGJhc2VUZXh0dXJlSWREZXByZWNhdGlvbiA9IGZhbHNlO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoQmFzZVRleHR1cmVBbnkucHJvdG90eXBlLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmFtZSBQSVhJLkJhc2VUZXh0dXJlI2hhc0xvYWRlZFxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqIEBzZWUgUElYSS5CYXNlVGV4dHVyZSN2YWxpZFxuICAgICAgICAgKi9cbiAgICAgICAgaGFzTG9hZGVkOiB7XG4gICAgICAgICAgICBnZXQoKTogYm9vbGVhblxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5CYXNlVGV4dHVyZS5oYXNMb2FkZWQgcHJvcGVydHkgaGFzIGJlZW4gcmVtb3ZlZCwgdXNlIFBJWEkuQmFzZVRleHR1cmUudmFsaWQnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbGlkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuYW1lIFBJWEkuQmFzZVRleHR1cmUjaW1hZ2VVcmxcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQHNlZSBQSVhJLnJlc291cmNlcy5JbWFnZVJlc291cmNlI3VybFxuICAgICAgICAgKi9cbiAgICAgICAgaW1hZ2VVcmw6IHtcbiAgICAgICAgICAgIGdldCh0aGlzOiBCYXNlVGV4dHVyZSk6IHN0cmluZ1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5CYXNlVGV4dHVyZS5pbWFnZVVybCBwcm9wZXJ0eSBoYXMgYmVlbiByZW1vdmVkLCB1c2UgUElYSS5CYXNlVGV4dHVyZS5yZXNvdXJjZS51cmwnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5yZXNvdXJjZSBhcyByZXNvdXJjZXMuSW1hZ2VSZXNvdXJjZSk/LnVybDtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHNldCh0aGlzOiBCYXNlVGV4dHVyZSwgaW1hZ2VVcmw6IHN0cmluZyk6IHZvaWRcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuQmFzZVRleHR1cmUuaW1hZ2VVcmwgcHJvcGVydHkgaGFzIGJlZW4gcmVtb3ZlZCwgdXNlIFBJWEkuQmFzZVRleHR1cmUucmVzb3VyY2UudXJsJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXNvdXJjZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnJlc291cmNlIGFzIHJlc291cmNlcy5JbWFnZVJlc291cmNlKS51cmwgPSBpbWFnZVVybDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQG5hbWUgUElYSS5CYXNlVGV4dHVyZSNzb3VyY2VcbiAgICAgICAgICogQHR5cGUge0hUTUxJbWFnZUVsZW1lbnR8SFRNTENhbnZhc0VsZW1lbnR8SFRNTFZpZGVvRWxlbWVudHxTVkdFbGVtZW50fVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQHNlZSBQSVhJLnJlc291cmNlcy5CYXNlSW1hZ2VSZXNvdXJjZSNzb3VyY2VcbiAgICAgICAgICovXG4gICAgICAgIHNvdXJjZToge1xuICAgICAgICAgICAgZ2V0KHRoaXM6IEJhc2VUZXh0dXJlKTogSW1hZ2VTb3VyY2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuQmFzZVRleHR1cmUuc291cmNlIHByb3BlcnR5IGhhcyBiZWVuIG1vdmVkLCB1c2UgYFBJWEkuQmFzZVRleHR1cmUucmVzb3VyY2Uuc291cmNlYCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLnJlc291cmNlIGFzIHJlc291cmNlcy5CYXNlSW1hZ2VSZXNvdXJjZSkuc291cmNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh0aGlzOiBCYXNlVGV4dHVyZSwgc291cmNlOiBJbWFnZVNvdXJjZSk6IHZvaWRcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuQmFzZVRleHR1cmUuc291cmNlIHByb3BlcnR5IGhhcyBiZWVuIG1vdmVkLCB1c2UgYFBJWEkuQmFzZVRleHR1cmUucmVzb3VyY2Uuc291cmNlYCAnXG4gICAgICAgICAgICAgICAgICAgICsgJ2lmIHlvdSB3YW50IHRvIHNldCBIVE1MQ2FudmFzRWxlbWVudC4gT3RoZXJ3aXNlLCBjcmVhdGUgbmV3IEJhc2VUZXh0dXJlLicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzb3VyY2UpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAodGhpcy5yZXNvdXJjZSBhcyByZXNvdXJjZXMuQmFzZUltYWdlUmVzb3VyY2UpLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmFtZSBQSVhJLkJhc2VUZXh0dXJlI3ByZW11bHRpcGx5QWxwaGFcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMi4wXG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAc2VlIFBJWEkuQmFzZVRleHR1cmUjYWxwaGFNb2RlXG4gICAgICAgICAqL1xuICAgICAgICBwcmVtdWx0aXBseUFscGhhOiB7XG4gICAgICAgICAgICBnZXQodGhpczogQmFzZVRleHR1cmUpOiBib29sZWFuXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4wJywgJ1BJWEkuQmFzZVRleHR1cmUucHJlbXVsdGlwbHlBbHBoYSBwcm9wZXJ0eSBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBhbHBoYU1vZGVgJ1xuICAgICAgICAgICAgICAgICAgICArICcsIHNlZSBgUElYSS5BTFBIQV9NT0RFU2AnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFscGhhTW9kZSAhPT0gMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQodGhpczogQmFzZVRleHR1cmUsIHZhbHVlOiBib29sZWFuKTogdm9pZFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMCcsICdQSVhJLkJhc2VUZXh0dXJlLnByZW11bHRpcGx5QWxwaGEgcHJvcGVydHkgaGFzIGJlZW4gY2hhbmdlZCB0byBgYWxwaGFNb2RlYCdcbiAgICAgICAgICAgICAgICAgICAgKyAnLCBzZWUgYFBJWEkuQUxQSEFfTU9ERVNgJyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFscGhhTW9kZSA9IE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQmF0Y2ggbG9jYWwgZmllbGQsIHN0b3JlcyBjdXJyZW50IHRleHR1cmUgbG9jYXRpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQG5hbWUgUElYSS5CYXNlVGV4dHVyZSNfaWRcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4yLjBcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHNlZSBQSVhJLkJhc2VUZXh0dXJlI19iYXRjaExvY2F0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBfaWQ6IHtcbiAgICAgICAgICAgIGdldCh0aGlzOiBCYXNlVGV4dHVyZSk6IG51bWJlclxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmICghYmFzZVRleHR1cmVJZERlcHJlY2F0aW9uKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gI3BvcGVseXNoZXY6IFRoYXQgcHJvcGVydHkgd2FzIGEgaG90IHBsYWNlLCBJIGRvbid0IHdhbnQgdG8gY2FsbCBkZXByZWNhdGlvbiBtZXRob2Qgb24gaXQgaWYgcG9zc2libGVcbiAgICAgICAgICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMi4wJywgJ1BJWEkuQmFzZVRleHR1cmUuX2lkIGJhdGNoIGxvY2FsIGZpZWxkIGhhcyBiZWVuIGNoYW5nZWQgdG8gYF9iYXRjaExvY2F0aW9uYCcpO1xuICAgICAgICAgICAgICAgICAgICBiYXNlVGV4dHVyZUlkRGVwcmVjYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYXRjaExvY2F0aW9uO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh0aGlzOiBCYXNlVGV4dHVyZSwgdmFsdWU6IG51bWJlcik6IHZvaWRcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXRjaExvY2F0aW9uID0gdmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQG1ldGhvZCBmcm9tSW1hZ2VcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlcm9mIFBJWEkuQmFzZVRleHR1cmVcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBzZWUgUElYSS5CYXNlVGV4dHVyZS5mcm9tXG4gICAgICovXG4gICAgQmFzZVRleHR1cmVBbnkuZnJvbUltYWdlID0gZnVuY3Rpb24gZnJvbUltYWdlKFxuICAgICAgICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LFxuICAgICAgICBjcm9zc29yaWdpbjogc3RyaW5nIHwgYm9vbGVhbixcbiAgICAgICAgc2NhbGVNb2RlOiBudW1iZXIsXG4gICAgICAgIHNjYWxlOiBudW1iZXIpOiBCYXNlVGV4dHVyZVxuICAgIHtcbiAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLkJhc2VUZXh0dXJlLmZyb21JbWFnZSBtZXRob2QgaGFzIGJlZW4gcmVwbGFjZWQgd2l0aCBQSVhJLkJhc2VUZXh0dXJlLmZyb20nKTtcblxuICAgICAgICBjb25zdCByZXNvdXJjZU9wdGlvbnMgPSB7IHNjYWxlLCBjcm9zc29yaWdpbiB9O1xuXG4gICAgICAgIHJldHVybiBCYXNlVGV4dHVyZUFueS5mcm9tKGNhbnZhcywgeyBzY2FsZU1vZGUsIHJlc291cmNlT3B0aW9ucyB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG1ldGhvZCBmcm9tQ2FudmFzXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJvZiBQSVhJLkJhc2VUZXh0dXJlXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAc2VlIFBJWEkuQmFzZVRleHR1cmUuZnJvbVxuICAgICAqL1xuICAgIEJhc2VUZXh0dXJlQW55LmZyb21DYW52YXMgPSBmdW5jdGlvbiBmcm9tQ2FudmFzKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIHNjYWxlTW9kZTogbnVtYmVyKTogQmFzZVRleHR1cmVcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5CYXNlVGV4dHVyZS5mcm9tQ2FudmFzIG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIFBJWEkuQmFzZVRleHR1cmUuZnJvbScpO1xuXG4gICAgICAgIHJldHVybiBCYXNlVGV4dHVyZUFueS5mcm9tKGNhbnZhcywgeyBzY2FsZU1vZGUgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgZnJvbVNWR1xuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyb2YgUElYSS5CYXNlVGV4dHVyZVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLkJhc2VUZXh0dXJlLmZyb21cbiAgICAgKi9cbiAgICBCYXNlVGV4dHVyZUFueS5mcm9tU1ZHID0gZnVuY3Rpb24gZnJvbVNWRyhcbiAgICAgICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCxcbiAgICAgICAgY3Jvc3NvcmlnaW46IHN0cmluZyB8IGJvb2xlYW4sXG4gICAgICAgIHNjYWxlTW9kZTogbnVtYmVyLFxuICAgICAgICBzY2FsZTogbnVtYmVyKTogQmFzZVRleHR1cmVcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5CYXNlVGV4dHVyZS5mcm9tU1ZHIG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIFBJWEkuQmFzZVRleHR1cmUuZnJvbScpO1xuXG4gICAgICAgIGNvbnN0IHJlc291cmNlT3B0aW9ucyA9IHsgc2NhbGUsIGNyb3Nzb3JpZ2luIH07XG5cbiAgICAgICAgcmV0dXJuIEJhc2VUZXh0dXJlQW55LmZyb20oY2FudmFzLCB7IHNjYWxlTW9kZSwgcmVzb3VyY2VPcHRpb25zIH0pO1xuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhQSVhJLnJlc291cmNlcy5JbWFnZVJlc291cmNlLnByb3RvdHlwZSwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG5hbWUgUElYSS5yZXNvdXJjZXMuSW1hZ2VSZXNvdXJjZSNwcmVtdWx0aXBseUFscGhhXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjIuMFxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQHNlZSBQSVhJLnJlc291cmNlcy5JbWFnZVJlc291cmNlI2FscGhhTW9kZVxuICAgICAgICAgKi9cbiAgICAgICAgcHJlbXVsdGlwbHlBbHBoYToge1xuICAgICAgICAgICAgZ2V0KHRoaXM6IHJlc291cmNlcy5JbWFnZVJlc291cmNlKTogYm9vbGVhblxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKCc1LjIuMCcsICdQSVhJLnJlc291cmNlcy5JbWFnZVJlc291cmNlLnByZW11bHRpcGx5QWxwaGEgcHJvcGVydHkgJ1xuICAgICAgICAgICAgICAgICAgICArICdoYXMgYmVlbiBjaGFuZ2VkIHRvIGBhbHBoYU1vZGVgLCBzZWUgYFBJWEkuQUxQSEFfTU9ERVNgJyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hbHBoYU1vZGUgIT09IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0KHRoaXM6IHJlc291cmNlcy5JbWFnZVJlc291cmNlLCB2YWx1ZTogYm9vbGVhbik6IHZvaWRcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZXByZWNhdGlvbignNS4yLjAnLCAnUElYSS5yZXNvdXJjZXMuSW1hZ2VSZXNvdXJjZS5wcmVtdWx0aXBseUFscGhhIHByb3BlcnR5ICdcbiAgICAgICAgICAgICAgICAgICAgKyAnaGFzIGJlZW4gY2hhbmdlZCB0byBgYWxwaGFNb2RlYCwgc2VlIGBQSVhJLkFMUEhBX01PREVTYCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWxwaGFNb2RlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIFBJWEkuUG9pbnQjY29weVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLlBvaW50I2NvcHlGcm9tXG4gICAgICovXG4gICAgUElYSS5Qb2ludC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkodGhpczogUG9pbnQsIHA6IElQb2ludCk6IFBvaW50XG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuUG9pbnQuY29weSBtZXRob2QgaGFzIGJlZW4gcmVwbGFjZWQgd2l0aCBQSVhJLlBvaW50LmNvcHlGcm9tJyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29weUZyb20ocCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5PYnNlcnZhYmxlUG9pbnQjY29weVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLk9ic2VydmFibGVQb2ludCNjb3B5RnJvbVxuICAgICAqL1xuICAgIFBJWEkuT2JzZXJ2YWJsZVBvaW50LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSh0aGlzOiBPYnNlcnZhYmxlUG9pbnQsIHA6IElQb2ludCk6IE9ic2VydmFibGVQb2ludFxuICAgIHtcbiAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLk9ic2VydmFibGVQb2ludC5jb3B5IG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIFBJWEkuT2JzZXJ2YWJsZVBvaW50LmNvcHlGcm9tJyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29weUZyb20ocCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5SZWN0YW5nbGUjY29weVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLlJlY3RhbmdsZSNjb3B5RnJvbVxuICAgICAqL1xuICAgIFBJWEkuUmVjdGFuZ2xlLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSh0aGlzOiBSZWN0YW5nbGUsIHA6IFJlY3RhbmdsZSk6IFJlY3RhbmdsZVxuICAgIHtcbiAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLlJlY3RhbmdsZS5jb3B5IG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIFBJWEkuUmVjdGFuZ2xlLmNvcHlGcm9tJyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY29weUZyb20ocCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5NYXRyaXgjY29weVxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLk1hdHJpeCNjb3B5VG9cbiAgICAgKi9cbiAgICBQSVhJLk1hdHJpeC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkodGhpczogTWF0cml4LCBwOiBNYXRyaXgpOiBNYXRyaXhcbiAgICB7XG4gICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5NYXRyaXguY29weSBtZXRob2QgaGFzIGJlZW4gcmVwbGFjZWQgd2l0aCBQSVhJLk1hdHJpeC5jb3B5VG8nKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5jb3B5VG8ocCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgUElYSS5zeXN0ZW1zLlN0YXRlU3lzdGVtI3NldFN0YXRlXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4xLjBcbiAgICAgKiBAc2VlIFBJWEkuc3lzdGVtcy5TdGF0ZVN5c3RlbSNzZXRcbiAgICAgKi9cbiAgICBQSVhJLnN5c3RlbXMuU3RhdGVTeXN0ZW0ucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gc2V0U3RhdGUodGhpczogc3lzdGVtcy5TdGF0ZVN5c3RlbSwgczogU3RhdGUpOiB2b2lkXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbigndjUuMS4wJywgJ1N0YXRlU3lzdGVtLnNldFN0YXRlIGhhcyBiZWVuIHJlbmFtZWQgdG8gU3RhdGVTeXN0ZW0uc2V0Jyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0KHMpO1xuICAgIH07XG5cbiAgICBPYmplY3QuYXNzaWduKFBJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW0ucHJvdG90eXBlLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWV0aG9kIFBJWEkuRmlsdGVyTWFuYWdlciNnZXRSZW5kZXJUYXJnZXRcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQHNlZSBQSVhJLnN5c3RlbXMuRmlsdGVyU3lzdGVtI2dldEZpbHRlclRleHR1cmVcbiAgICAgICAgICovXG4gICAgICAgIGdldFJlbmRlclRhcmdldCh0aGlzOiBzeXN0ZW1zLkZpbHRlclN5c3RlbSwgX2NsZWFyOiBib29sZWFuLCByZXNvbHV0aW9uOiBudW1iZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LFxuICAgICAgICAgICAgICAgICdQSVhJLkZpbHRlck1hbmFnZXIuZ2V0UmVuZGVyVGFyZ2V0IG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIFBJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW0jZ2V0RmlsdGVyVGV4dHVyZSdcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpbHRlclRleHR1cmUobnVsbCwgcmVzb2x1dGlvbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgUElYSS5GaWx0ZXJNYW5hZ2VyI3JldHVyblJlbmRlclRhcmdldFxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAc2VlIFBJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW0jcmV0dXJuRmlsdGVyVGV4dHVyZVxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuUmVuZGVyVGFyZ2V0KHRoaXM6IHN5c3RlbXMuRmlsdGVyU3lzdGVtLCByZW5kZXJUZXh0dXJlOiBhbnkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LFxuICAgICAgICAgICAgICAgICdQSVhJLkZpbHRlck1hbmFnZXIucmV0dXJuUmVuZGVyVGFyZ2V0IG1ldGhvZCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoICdcbiAgICAgICAgICAgICAgICArICdQSVhJLnN5c3RlbXMuRmlsdGVyU3lzdGVtLnJldHVybkZpbHRlclRleHR1cmUnXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLnJldHVybkZpbHRlclRleHR1cmUocmVuZGVyVGV4dHVyZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgUElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbSNjYWxjdWxhdGVTY3JlZW5TcGFjZU1hdHJpeFxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAcGFyYW0ge1BJWEkuTWF0cml4fSBvdXRwdXRNYXRyaXggLSB0aGUgbWF0cml4IHRvIG91dHB1dCB0by5cbiAgICAgICAgICogQHJldHVybiB7UElYSS5NYXRyaXh9IFRoZSBtYXBwZWQgbWF0cml4LlxuICAgICAgICAgKi9cbiAgICAgICAgY2FsY3VsYXRlU2NyZWVuU3BhY2VNYXRyaXgodGhpczogc3lzdGVtcy5GaWx0ZXJTeXN0ZW0sIG91dHB1dE1hdHJpeDogYW55KVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuc3lzdGVtcy5GaWx0ZXJTeXN0ZW0uY2FsY3VsYXRlU2NyZWVuU3BhY2VNYXRyaXggbWV0aG9kIGlzIHJlbW92ZWQsICdcbiAgICAgICAgICAgICAgICArICd1c2UgYCh2VGV4dHVyZUNvb3JkICogaW5wdXRTaXplLnh5KSArIG91dHB1dEZyYW1lLnh5YCBpbnN0ZWFkJyk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1hcHBlZE1hdHJpeCA9IG91dHB1dE1hdHJpeC5pZGVudGl0eSgpO1xuICAgICAgICAgICAgY29uc3QgeyBzb3VyY2VGcmFtZSwgZGVzdGluYXRpb25GcmFtZSB9ID0gdGhpcy5hY3RpdmVTdGF0ZTtcblxuICAgICAgICAgICAgbWFwcGVkTWF0cml4LnRyYW5zbGF0ZShzb3VyY2VGcmFtZS54IC8gZGVzdGluYXRpb25GcmFtZS53aWR0aCwgc291cmNlRnJhbWUueSAvIGRlc3RpbmF0aW9uRnJhbWUuaGVpZ2h0KTtcbiAgICAgICAgICAgIG1hcHBlZE1hdHJpeC5zY2FsZShkZXN0aW5hdGlvbkZyYW1lLndpZHRoLCBkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCk7XG5cbiAgICAgICAgICAgIHJldHVybiBtYXBwZWRNYXRyaXg7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgUElYSS5zeXN0ZW1zLkZpbHRlclN5c3RlbSNjYWxjdWxhdGVOb3JtYWxpemVkU2NyZWVuU3BhY2VNYXRyaXhcbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQHBhcmFtIHtQSVhJLk1hdHJpeH0gb3V0cHV0TWF0cml4IC0gVGhlIG1hdHJpeCB0byBvdXRwdXQgdG8uXG4gICAgICAgICAqIEByZXR1cm4ge1BJWEkuTWF0cml4fSBUaGUgbWFwcGVkIG1hdHJpeC5cbiAgICAgICAgICovXG4gICAgICAgIGNhbGN1bGF0ZU5vcm1hbGl6ZWRTY3JlZW5TcGFjZU1hdHJpeCh0aGlzOiBzeXN0ZW1zLkZpbHRlclN5c3RlbSwgb3V0cHV0TWF0cml4OiBNYXRyaXgpOiBNYXRyaXhcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLnN5c3RlbXMuRmlsdGVyTWFuYWdlci5jYWxjdWxhdGVOb3JtYWxpemVkU2NyZWVuU3BhY2VNYXRyaXggbWV0aG9kIGlzIHJlbW92ZWQsICdcbiAgICAgICAgICAgICAgICArICd1c2UgYCgodlRleHR1cmVDb29yZCAqIGlucHV0U2l6ZS54eSkgKyBvdXRwdXRGcmFtZS54eSkgLyBvdXRwdXRGcmFtZS56d2AgaW5zdGVhZC4nKTtcblxuICAgICAgICAgICAgY29uc3QgeyBzb3VyY2VGcmFtZSwgZGVzdGluYXRpb25GcmFtZSB9ID0gdGhpcy5hY3RpdmVTdGF0ZTtcbiAgICAgICAgICAgIGNvbnN0IG1hcHBlZE1hdHJpeCA9IG91dHB1dE1hdHJpeC5pZGVudGl0eSgpO1xuXG4gICAgICAgICAgICBtYXBwZWRNYXRyaXgudHJhbnNsYXRlKHNvdXJjZUZyYW1lLnggLyBkZXN0aW5hdGlvbkZyYW1lLndpZHRoLCBzb3VyY2VGcmFtZS55IC8gZGVzdGluYXRpb25GcmFtZS5oZWlnaHQpO1xuXG4gICAgICAgICAgICBjb25zdCB0cmFuc2xhdGVTY2FsZVggPSAoZGVzdGluYXRpb25GcmFtZS53aWR0aCAvIHNvdXJjZUZyYW1lLndpZHRoKTtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zbGF0ZVNjYWxlWSA9IChkZXN0aW5hdGlvbkZyYW1lLmhlaWdodCAvIHNvdXJjZUZyYW1lLmhlaWdodCk7XG5cbiAgICAgICAgICAgIG1hcHBlZE1hdHJpeC5zY2FsZSh0cmFuc2xhdGVTY2FsZVgsIHRyYW5zbGF0ZVNjYWxlWSk7XG5cbiAgICAgICAgICAgIHJldHVybiBtYXBwZWRNYXRyaXg7XG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhQSVhJLlJlbmRlclRleHR1cmUucHJvdG90eXBlLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmFtZSBQSVhJLlJlbmRlclRleHR1cmUjc291cmNlRnJhbWVcbiAgICAgICAgICogQHR5cGUge1BJWEkuUmVjdGFuZ2xlfVxuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIHNvdXJjZUZyYW1lOiB7XG4gICAgICAgICAgICBnZXQodGhpczogUmVuZGVyVGV4dHVyZSk6IFJlY3RhbmdsZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5SZW5kZXJUZXh0dXJlLnNvdXJjZUZyYW1lIHByb3BlcnR5IGhhcyBiZWVuIHJlbW92ZWQnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlckZyYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBuYW1lIFBJWEkuUmVuZGVyVGV4dHVyZSNzaXplXG4gICAgICAgICAqIEB0eXBlIHtQSVhJLlJlY3RhbmdsZX1cbiAgICAgICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBzaXplOiB7XG4gICAgICAgICAgICBnZXQodGhpczogUmVuZGVyVGV4dHVyZSk6IFJlY3RhbmdsZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5SZW5kZXJUZXh0dXJlLnNpemUgcHJvcGVydHkgaGFzIGJlZW4gcmVtb3ZlZCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBjbGFzcyBCbHVyWEZpbHRlclxuICAgICAqIEBtZW1iZXJvZiBQSVhJLmZpbHRlcnNcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBzZWUgUElYSS5maWx0ZXJzLkJsdXJGaWx0ZXJQYXNzXG4gICAgICovXG4gICAgY2xhc3MgQmx1clhGaWx0ZXIgZXh0ZW5kcyBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlclBhc3NcbiAgICB7XG4gICAgICAgIGNvbnN0cnVjdG9yKHN0cmVuZ3RoOiBudW1iZXIsIHF1YWxpdHk6IG51bWJlciwgcmVzb2x1dGlvbjogbnVtYmVyLCBrZXJuZWxTaXplOiBudW1iZXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5maWx0ZXJzLkJsdXJYRmlsdGVyIGNsYXNzIGlzIGRlcHJlY2F0ZWQsIHVzZSBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlclBhc3MnKTtcblxuICAgICAgICAgICAgc3VwZXIodHJ1ZSwgc3RyZW5ndGgsIHF1YWxpdHksIHJlc29sdXRpb24sIGtlcm5lbFNpemUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGNsYXNzIEJsdXJZRmlsdGVyXG4gICAgICogQG1lbWJlcm9mIFBJWEkuZmlsdGVyc1xuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlclBhc3NcbiAgICAgKi9cbiAgICBjbGFzcyBCbHVyWUZpbHRlciBleHRlbmRzIFBJWEkuZmlsdGVycy5CbHVyRmlsdGVyUGFzc1xuICAgIHtcbiAgICAgICAgY29uc3RydWN0b3Ioc3RyZW5ndGg6IG51bWJlciwgcXVhbGl0eTogbnVtYmVyLCByZXNvbHV0aW9uOiBudW1iZXIsIGtlcm5lbFNpemU6IG51bWJlcilcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLmZpbHRlcnMuQmx1cllGaWx0ZXIgY2xhc3MgaXMgZGVwcmVjYXRlZCwgdXNlIFBJWEkuZmlsdGVycy5CbHVyRmlsdGVyUGFzcycpO1xuXG4gICAgICAgICAgICBzdXBlcihmYWxzZSwgc3RyZW5ndGgsIHF1YWxpdHksIHJlc29sdXRpb24sIGtlcm5lbFNpemUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbihQSVhJLmZpbHRlcnMsIHtcbiAgICAgICAgQmx1clhGaWx0ZXIsXG4gICAgICAgIEJsdXJZRmlsdGVyLFxuICAgIH0pO1xuXG4gICAgY29uc3Qge1xuICAgICAgICBTcHJpdGU6IFNwcml0ZUFueSxcbiAgICAgICAgVGV4dHVyZTogVGV4dHVyZUFueSxcbiAgICAgICAgR3JhcGhpY3M6IEdyYXBoaWNzQW55IH0gPSBQSVhJO1xuXG4gICAgLy8gU3VwcG9ydCBmb3IgcGl4aS5qcy1sZWdhY3kgYmlmdXJjYXRpb25cbiAgICAvLyBnaXZlIHVzZXJzIGEgZnJpZW5kbHkgYXNzaXN0IHRvIHVzZSBsZWdhY3lcbiAgICBpZiAoIUdyYXBoaWNzQW55LnByb3RvdHlwZS5nZW5lcmF0ZUNhbnZhc1RleHR1cmUpXG4gICAge1xuICAgICAgICBHcmFwaGljc0FueS5wcm90b3R5cGUuZ2VuZXJhdGVDYW52YXNUZXh0dXJlID0gZnVuY3Rpb24gZ2VuZXJhdGVDYW52YXNUZXh0dXJlKCk6IHZvaWRcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLkdyYXBoaWNzLmdlbmVyYXRlQ2FudmFzVGV4dHVyZSBtZXRob2QgaXMgb25seSBhdmFpbGFibGUgaW4gXCJwaXhpLmpzLWxlZ2FjeVwiJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAbWVtYmVyIHtQSVhJLkdyYXBoaWNzfSBQSVhJLkdyYXBoaWNzI2dyYXBoaWNzRGF0YVxuICAgICAqIEBzZWUgUElYSS5HcmFwaGljcyNnZW9tZXRyeVxuICAgICAqIEByZWFkb25seVxuICAgICAqL1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmFwaGljc0FueS5wcm90b3R5cGUsICdncmFwaGljc0RhdGEnLCB7XG4gICAgICAgIGdldCh0aGlzOiBHcmFwaGljcyk6IEdyYXBoaWNzRGF0YVtdXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS5HcmFwaGljcy5ncmFwaGljc0RhdGEgcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwgdXNlIFBJWEkuR3JhcGhpY3MuZ2VvbWV0cnkuZ3JhcGhpY3NEYXRhJyk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdlb21ldHJ5LmdyYXBoaWNzRGF0YTtcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFVzZSB0aGVzZSB0byBkZXByZWNhdGUgYWxsIHRoZSBTcHJpdGUgZnJvbSogbWV0aG9kc1xuICAgIGZ1bmN0aW9uIHNwcml0ZUZyb20obmFtZTogc3RyaW5nLCBzb3VyY2U6IHN0cmluZywgY3Jvc3NvcmlnaW46IHN0cmluZyB8IGJvb2xlYW4sIHNjYWxlTW9kZTogbnVtYmVyKTogU3ByaXRlXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbih2NSwgYFBJWEkuU3ByaXRlLiR7bmFtZX0gbWV0aG9kIGlzIGRlcHJlY2F0ZWQsIHVzZSBQSVhJLlNwcml0ZS5mcm9tYCk7XG5cbiAgICAgICAgcmV0dXJuIFNwcml0ZUFueS5mcm9tKHNvdXJjZSwge1xuICAgICAgICAgICAgcmVzb3VyY2VPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgc2NhbGU6IHNjYWxlTW9kZSxcbiAgICAgICAgICAgICAgICBjcm9zc29yaWdpbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQHNlZSBQSVhJLlNwcml0ZS5mcm9tXG4gICAgICogQG1ldGhvZCBQSVhJLlNwcml0ZS5mcm9tSW1hZ2VcbiAgICAgKiBAcmV0dXJuIHtQSVhJLlNwcml0ZX1cbiAgICAgKi9cbiAgICBTcHJpdGVBbnkuZnJvbUltYWdlID0gc3ByaXRlRnJvbS5iaW5kKG51bGwsICdmcm9tSW1hZ2UnKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlNwcml0ZS5mcm9tU1ZHXG4gICAgICogQHNlZSBQSVhJLlNwcml0ZS5mcm9tXG4gICAgICogQHJldHVybiB7UElYSS5TcHJpdGV9XG4gICAgICovXG4gICAgU3ByaXRlQW55LmZyb21TVkcgPSBzcHJpdGVGcm9tLmJpbmQobnVsbCwgJ2Zyb21TVkcnKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlNwcml0ZS5mcm9tQ2FudmFzXG4gICAgICogQHNlZSBQSVhJLlNwcml0ZS5mcm9tXG4gICAgICogQHJldHVybiB7UElYSS5TcHJpdGV9XG4gICAgICovXG4gICAgU3ByaXRlQW55LmZyb21DYW52YXMgPSBzcHJpdGVGcm9tLmJpbmQobnVsbCwgJ2Zyb21DYW52YXMnKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlNwcml0ZS5mcm9tVmlkZW9cbiAgICAgKiBAc2VlIFBJWEkuU3ByaXRlLmZyb21cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlNwcml0ZX1cbiAgICAgKi9cbiAgICBTcHJpdGVBbnkuZnJvbVZpZGVvID0gc3ByaXRlRnJvbS5iaW5kKG51bGwsICdmcm9tVmlkZW8nKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlNwcml0ZS5mcm9tRnJhbWVcbiAgICAgKiBAc2VlIFBJWEkuU3ByaXRlLmZyb21cbiAgICAgKiBAcmV0dXJuIHtQSVhJLlNwcml0ZX1cbiAgICAgKi9cbiAgICBTcHJpdGVBbnkuZnJvbUZyYW1lID0gc3ByaXRlRnJvbS5iaW5kKG51bGwsICdmcm9tRnJhbWUnKTtcblxuICAgIC8vIFVzZSB0aGVzZSB0byBkZXByZWNhdGUgYWxsIHRoZSBUZXh0dXJlIGZyb20qIG1ldGhvZHNcbiAgICBmdW5jdGlvbiB0ZXh0dXJlRnJvbShuYW1lOiBzdHJpbmcsIHNvdXJjZTogc3RyaW5nLCBjcm9zc29yaWdpbjogc3RyaW5nIHwgYm9vbGVhbiwgc2NhbGVNb2RlOiBudW1iZXIpOiBUZXh0dXJlXG4gICAge1xuICAgICAgICBkZXByZWNhdGlvbih2NSwgYFBJWEkuVGV4dHVyZS4ke25hbWV9IG1ldGhvZCBpcyBkZXByZWNhdGVkLCB1c2UgUElYSS5UZXh0dXJlLmZyb21gKTtcblxuICAgICAgICByZXR1cm4gVGV4dHVyZUFueS5mcm9tKHNvdXJjZSwge1xuICAgICAgICAgICAgcmVzb3VyY2VPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgc2NhbGU6IHNjYWxlTW9kZSxcbiAgICAgICAgICAgICAgICBjcm9zc29yaWdpbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlRleHR1cmUuZnJvbUltYWdlXG4gICAgICogQHNlZSBQSVhJLlRleHR1cmUuZnJvbVxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dHVyZX1cbiAgICAgKi9cbiAgICBUZXh0dXJlQW55LmZyb21JbWFnZSA9IHRleHR1cmVGcm9tLmJpbmQobnVsbCwgJ2Zyb21JbWFnZScpO1xuXG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAbWV0aG9kIFBJWEkuVGV4dHVyZS5mcm9tU1ZHXG4gICAgICogQHNlZSBQSVhJLlRleHR1cmUuZnJvbVxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dHVyZX1cbiAgICAgKi9cbiAgICBUZXh0dXJlQW55LmZyb21TVkcgPSB0ZXh0dXJlRnJvbS5iaW5kKG51bGwsICdmcm9tU1ZHJyk7XG5cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBtZXRob2QgUElYSS5UZXh0dXJlLmZyb21DYW52YXNcbiAgICAgKiBAc2VlIFBJWEkuVGV4dHVyZS5mcm9tXG4gICAgICogQHJldHVybiB7UElYSS5UZXh0dXJlfVxuICAgICAqL1xuICAgIFRleHR1cmVBbnkuZnJvbUNhbnZhcyA9IHRleHR1cmVGcm9tLmJpbmQobnVsbCwgJ2Zyb21DYW52YXMnKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICogQG1ldGhvZCBQSVhJLlRleHR1cmUuZnJvbVZpZGVvXG4gICAgICogQHNlZSBQSVhJLlRleHR1cmUuZnJvbVxuICAgICAqIEByZXR1cm4ge1BJWEkuVGV4dHVyZX1cbiAgICAgKi9cbiAgICBUZXh0dXJlQW55LmZyb21WaWRlbyA9IHRleHR1cmVGcm9tLmJpbmQobnVsbCwgJ2Zyb21WaWRlbycpO1xuXG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgNS4wLjBcbiAgICAgKiBAbWV0aG9kIFBJWEkuVGV4dHVyZS5mcm9tRnJhbWVcbiAgICAgKiBAc2VlIFBJWEkuVGV4dHVyZS5mcm9tXG4gICAgICogQHJldHVybiB7UElYSS5UZXh0dXJlfVxuICAgICAqL1xuICAgIFRleHR1cmVBbnkuZnJvbUZyYW1lID0gdGV4dHVyZUZyb20uYmluZChudWxsLCAnZnJvbUZyYW1lJyk7XG5cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBtZW1iZXIge2Jvb2xlYW59IFBJWEkuQWJzdHJhY3RSZW5kZXJlciNhdXRvUmVzaXplXG4gICAgICogQHNlZSBQSVhJLkFic3RyYWN0UmVuZGVyZXIjYXV0b0RlbnNpdHlcbiAgICAgKi9cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUElYSS5BYnN0cmFjdFJlbmRlcmVyLnByb3RvdHlwZSwgJ2F1dG9SZXNpemUnLCB7XG4gICAgICAgIGdldCh0aGlzOiBBYnN0cmFjdFJlbmRlcmVyKTogYm9vbGVhblxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuQWJzdHJhY3RSZW5kZXJlci5hdXRvUmVzaXplIHByb3BlcnR5IGlzIGRlcHJlY2F0ZWQsICdcbiAgICAgICAgICAgICAgICArICd1c2UgUElYSS5BYnN0cmFjdFJlbmRlcmVyLmF1dG9EZW5zaXR5Jyk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dG9EZW5zaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQodGhpczogYW55LCB2YWx1ZTogYm9vbGVhbik6IHZvaWRcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLkFic3RyYWN0UmVuZGVyZXIuYXV0b1Jlc2l6ZSBwcm9wZXJ0eSBpcyBkZXByZWNhdGVkLCAnXG4gICAgICAgICAgICAgICAgKyAndXNlIFBJWEkuQWJzdHJhY3RSZW5kZXJlci5hdXRvRGVuc2l0eScpO1xuXG4gICAgICAgICAgICB0aGlzLmF1dG9EZW5zaXR5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAqIEBtZW1iZXIge1BJWEkuc3lzdGVtcy5UZXh0dXJlU3lzdGVtfSBQSVhJLlJlbmRlcmVyI3RleHR1cmVNYW5hZ2VyXG4gICAgICogQHNlZSBQSVhJLlJlbmRlcmVyI3RleHR1cmVcbiAgICAgKi9cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUElYSS5SZW5kZXJlci5wcm90b3R5cGUsICd0ZXh0dXJlTWFuYWdlcicsIHtcbiAgICAgICAgZ2V0KHRoaXM6IFJlbmRlcmVyKVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbih2NSwgJ1BJWEkuUmVuZGVyZXIudGV4dHVyZU1hbmFnZXIgcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwgdXNlIFBJWEkuUmVuZGVyZXIudGV4dHVyZScpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0dXJlO1xuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQG5hbWVzcGFjZSBQSVhJLnV0aWxzLm1peGluc1xuICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICovXG4gICAgUElYSS51dGlscy5taXhpbnMgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyb2YgUElYSS51dGlscy5taXhpbnNcbiAgICAgICAgICogQGZ1bmN0aW9uIG1peGluXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBtaXhpbigpOiB2b2lkXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS51dGlscy5taXhpbnMubWl4aW4gZnVuY3Rpb24gaXMgbm8gbG9uZ2VyIGF2YWlsYWJsZScpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlcm9mIFBJWEkudXRpbHMubWl4aW5zXG4gICAgICAgICAqIEBmdW5jdGlvbiBkZWxheU1peGluXG4gICAgICAgICAqIEBkZXByZWNhdGVkIHNpbmNlIDUuMC4wXG4gICAgICAgICAqL1xuICAgICAgICBkZWxheU1peGluKCk6IHZvaWRcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24odjUsICdQSVhJLnV0aWxzLm1peGlucy5kZWxheU1peGluIGZ1bmN0aW9uIGlzIG5vIGxvbmdlciBhdmFpbGFibGUnKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLnV0aWxzLm1peGluc1xuICAgICAgICAgKiBAZnVuY3Rpb24gcGVyZm9ybU1peGluc1xuICAgICAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjAuMFxuICAgICAgICAgKi9cbiAgICAgICAgcGVyZm9ybU1peGlucygpOiB2b2lkXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlcHJlY2F0aW9uKHY1LCAnUElYSS51dGlscy5taXhpbnMucGVyZm9ybU1peGlucyBmdW5jdGlvbiBpcyBubyBsb25nZXIgYXZhaWxhYmxlJyk7XG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBQSVhJLkJpdG1hcFRleHRcbiAgICAgKiBAbWVtYmVyIHtvYmplY3R9IGZvbnRcbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSA1LjMuMFxuICAgICAqL1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQSVhJLkJpdG1hcFRleHQucHJvdG90eXBlLCAnZm9udCcsIHtcbiAgICAgICAgZ2V0KHRoaXM6IEJpdG1hcFRleHQpOiBhbnlcbiAgICAgICAge1xuICAgICAgICAgICAgZGVwcmVjYXRpb24oJzUuMy4wJywgJ1BJWEkuQml0bWFwVGV4dC5mb250IHByb3BlcnR5IGlzIGRlcHJlY2F0ZWQsICdcbiAgICAgICAgICAgICAgICArICd1c2UgZm9udE5hbWUsIGZvbnRTaXplLCB0aW50IG9yIGFsaWduIHByb3BlcnRpZXMnKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLl9mb250TmFtZSxcbiAgICAgICAgICAgICAgICBzaXplOiB0aGlzLl9mb250U2l6ZSxcbiAgICAgICAgICAgICAgICB0aW50OiB0aGlzLl90aW50LFxuICAgICAgICAgICAgICAgIGFsaWduOiB0aGlzLl9hbGlnbixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIHNldCh0aGlzOiBCaXRtYXBUZXh0LCB2YWx1ZTogYW55KVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXByZWNhdGlvbignNS4zLjAnLCAnUElYSS5CaXRtYXBUZXh0LmZvbnQgcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwgJ1xuICAgICAgICAgICAgICAgICsgJ3VzZSBmb250TmFtZSwgZm9udFNpemUsIHRpbnQgb3IgYWxpZ24gcHJvcGVydGllcycpO1xuXG4gICAgICAgICAgICBpZiAoIXZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc3R5bGU6IGFueSA9IHsgZm9udDogdmFsdWUgfTtcblxuICAgICAgICAgICAgdGhpcy5fdXBncmFkZVN0eWxlKHN0eWxlKTtcblxuICAgICAgICAgICAgc3R5bGUuZm9udFNpemUgPSBzdHlsZS5mb250U2l6ZSB8fCBQSVhJLkJpdG1hcEZvbnQuYXZhaWxhYmxlW3N0eWxlLmZvbnROYW1lXS5zaXplO1xuXG4gICAgICAgICAgICB0aGlzLl9mb250TmFtZSA9IHN0eWxlLmZvbnROYW1lO1xuICAgICAgICAgICAgdGhpcy5fZm9udFNpemUgPSBzdHlsZS5mb250U2l6ZTtcblxuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG4iLCAiaW1wb3J0ICdAcGl4aS9wb2x5ZmlsbCc7XG5cbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJ0BwaXhpL3V0aWxzJztcbmltcG9ydCB7IEFjY2Vzc2liaWxpdHlNYW5hZ2VyIH0gZnJvbSAnQHBpeGkvYWNjZXNzaWJpbGl0eSc7XG5pbXBvcnQgeyBJbnRlcmFjdGlvbk1hbmFnZXIgfSBmcm9tICdAcGl4aS9pbnRlcmFjdGlvbic7XG5pbXBvcnQgeyBBcHBsaWNhdGlvbiB9IGZyb20gJ0BwaXhpL2FwcCc7XG5pbXBvcnQgeyBSZW5kZXJlciwgQmF0Y2hSZW5kZXJlciB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHsgRXh0cmFjdCB9IGZyb20gJ0BwaXhpL2V4dHJhY3QnO1xuaW1wb3J0IHsgTG9hZGVyLCBBcHBMb2FkZXJQbHVnaW4gfSBmcm9tICdAcGl4aS9sb2FkZXJzJztcbmltcG9ydCB7IFBhcnRpY2xlUmVuZGVyZXIgfSBmcm9tICdAcGl4aS9wYXJ0aWNsZXMnO1xuaW1wb3J0IHsgUHJlcGFyZSB9IGZyb20gJ0BwaXhpL3ByZXBhcmUnO1xuaW1wb3J0IHsgU3ByaXRlc2hlZXRMb2FkZXIgfSBmcm9tICdAcGl4aS9zcHJpdGVzaGVldCc7XG5pbXBvcnQgeyBUaWxpbmdTcHJpdGVSZW5kZXJlciB9IGZyb20gJ0BwaXhpL3Nwcml0ZS10aWxpbmcnO1xuaW1wb3J0IHsgQml0bWFwRm9udExvYWRlciB9IGZyb20gJ0BwaXhpL3RleHQtYml0bWFwJztcbmltcG9ydCB7IFRpY2tlclBsdWdpbiB9IGZyb20gJ0BwaXhpL3RpY2tlcic7XG5pbXBvcnQgeyBBbHBoYUZpbHRlciB9IGZyb20gJ0BwaXhpL2ZpbHRlci1hbHBoYSc7XG5pbXBvcnQgeyBCbHVyRmlsdGVyLCBCbHVyRmlsdGVyUGFzcyB9IGZyb20gJ0BwaXhpL2ZpbHRlci1ibHVyJztcbmltcG9ydCB7IENvbG9yTWF0cml4RmlsdGVyIH0gZnJvbSAnQHBpeGkvZmlsdGVyLWNvbG9yLW1hdHJpeCc7XG5pbXBvcnQgeyBEaXNwbGFjZW1lbnRGaWx0ZXIgfSBmcm9tICdAcGl4aS9maWx0ZXItZGlzcGxhY2VtZW50JztcbmltcG9ydCB7IEZYQUFGaWx0ZXIgfSBmcm9tICdAcGl4aS9maWx0ZXItZnhhYSc7XG5pbXBvcnQgeyBOb2lzZUZpbHRlciB9IGZyb20gJ0BwaXhpL2ZpbHRlci1ub2lzZSc7XG5pbXBvcnQgJ0BwaXhpL21peGluLWNhY2hlLWFzLWJpdG1hcCc7XG5pbXBvcnQgJ0BwaXhpL21peGluLWdldC1jaGlsZC1ieS1uYW1lJztcbmltcG9ydCAnQHBpeGkvbWl4aW4tZ2V0LWdsb2JhbC1wb3NpdGlvbic7XG5cbi8vIEV4cG9ydCBkZXByZWNhdGlvbnMgc28gUm9sbHVwIGNhbiBjYWxsIGl0XG4vLyBpbiB0aGUgZm9vdGVyIGFmdGVyIGdsb2JhbCBpcyBkZWZpbmVkXG4vLyBvdGhlciBtb2R1bGUgbXVzdCBjYWxsIHRoaXMgbWFudWFsbHlcbmltcG9ydCB7IHVzZURlcHJlY2F0ZWQgfSBmcm9tICcuL3VzZURlcHJlY2F0ZWQnO1xuXG4vLyBJbnN0YWxsIHJlbmRlcmVyIHBsdWdpbnNcblJlbmRlcmVyLnJlZ2lzdGVyUGx1Z2luKCdhY2Nlc3NpYmlsaXR5JywgQWNjZXNzaWJpbGl0eU1hbmFnZXIpO1xuUmVuZGVyZXIucmVnaXN0ZXJQbHVnaW4oJ2V4dHJhY3QnLCBFeHRyYWN0KTtcblJlbmRlcmVyLnJlZ2lzdGVyUGx1Z2luKCdpbnRlcmFjdGlvbicsIEludGVyYWN0aW9uTWFuYWdlcik7XG5SZW5kZXJlci5yZWdpc3RlclBsdWdpbigncGFydGljbGUnLCBQYXJ0aWNsZVJlbmRlcmVyKTtcblJlbmRlcmVyLnJlZ2lzdGVyUGx1Z2luKCdwcmVwYXJlJywgUHJlcGFyZSk7XG5SZW5kZXJlci5yZWdpc3RlclBsdWdpbignYmF0Y2gnLCBCYXRjaFJlbmRlcmVyKTtcblJlbmRlcmVyLnJlZ2lzdGVyUGx1Z2luKCd0aWxpbmdTcHJpdGUnLCBUaWxpbmdTcHJpdGVSZW5kZXJlcik7XG5cbkxvYWRlci5yZWdpc3RlclBsdWdpbihCaXRtYXBGb250TG9hZGVyKTtcbkxvYWRlci5yZWdpc3RlclBsdWdpbihTcHJpdGVzaGVldExvYWRlcik7XG5cbkFwcGxpY2F0aW9uLnJlZ2lzdGVyUGx1Z2luKFRpY2tlclBsdWdpbik7XG5BcHBsaWNhdGlvbi5yZWdpc3RlclBsdWdpbihBcHBMb2FkZXJQbHVnaW4pO1xuXG4vKipcbiAqIFN0cmluZyBvZiB0aGUgY3VycmVudCBQSVhJIHZlcnNpb24uXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50XG4gKiBAbWVtYmVyb2YgUElYSVxuICogQG5hbWUgVkVSU0lPTlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IFZFUlNJT04gPSAnX19WRVJTSU9OX18nO1xuXG4vKipcbiAqIEBuYW1lc3BhY2UgUElYSVxuICovXG5cbi8qKlxuICogVGhpcyBuYW1lc3BhY2UgY29udGFpbnMgV2ViR0wtb25seSBkaXNwbGF5IGZpbHRlcnMgdGhhdCBjYW4gYmUgYXBwbGllZFxuICogdG8gRGlzcGxheU9iamVjdHMgdXNpbmcgdGhlIHtAbGluayBQSVhJLkRpc3BsYXlPYmplY3QjZmlsdGVycyBmaWx0ZXJzfSBwcm9wZXJ0eS5cbiAqXG4gKiBTaW5jZSBQaXhpSlMgb25seSBoYWQgYSBoYW5kZnVsIG9mIGJ1aWx0LWluIGZpbHRlcnMsIGFkZGl0aW9uYWwgZmlsdGVyc1xuICogY2FuIGJlIGRvd25sb2FkZWQge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9waXhpanMvcGl4aS1maWx0ZXJzIGhlcmV9IGZyb20gdGhlXG4gKiBQaXhpSlMgRmlsdGVycyByZXBvc2l0b3J5LlxuICpcbiAqIEFsbCBmaWx0ZXJzIG11c3QgZXh0ZW5kIHtAbGluayBQSVhJLkZpbHRlcn0uXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIENyZWF0ZSBhIG5ldyBhcHBsaWNhdGlvblxuICogY29uc3QgYXBwID0gbmV3IFBJWEkuQXBwbGljYXRpb24oKTtcbiAqXG4gKiAvLyBEcmF3IGEgZ3JlZW4gcmVjdGFuZ2xlXG4gKiBjb25zdCByZWN0ID0gbmV3IFBJWEkuR3JhcGhpY3MoKVxuICogICAgIC5iZWdpbkZpbGwoMHgwMGZmMDApXG4gKiAgICAgLmRyYXdSZWN0KDQwLCA0MCwgMjAwLCAyMDApO1xuICpcbiAqIC8vIEFkZCBhIGJsdXIgZmlsdGVyXG4gKiByZWN0LmZpbHRlcnMgPSBbbmV3IFBJWEkuZmlsdGVycy5CbHVyRmlsdGVyKCldO1xuICpcbiAqIC8vIERpc3BsYXkgcmVjdGFuZ2xlXG4gKiBhcHAuc3RhZ2UuYWRkQ2hpbGQocmVjdCk7XG4gKiBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFwcC52aWV3KTtcbiAqIEBuYW1lc3BhY2UgUElYSS5maWx0ZXJzXG4gKi9cbmV4cG9ydCBjb25zdCBmaWx0ZXJzID0ge1xuICAgIEFscGhhRmlsdGVyLFxuICAgIEJsdXJGaWx0ZXIsXG4gICAgQmx1ckZpbHRlclBhc3MsXG4gICAgQ29sb3JNYXRyaXhGaWx0ZXIsXG4gICAgRGlzcGxhY2VtZW50RmlsdGVyLFxuICAgIEZYQUFGaWx0ZXIsXG4gICAgTm9pc2VGaWx0ZXIsXG59O1xuXG4vLyBFeHBvcnQgRVMgZm9yIHRob3NlIGltcG9ydGluZyBzcGVjaWZpY2FsbHkgYnkgbmFtZSxcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL2FjY2Vzc2liaWxpdHknO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvYXBwJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL2NvbnN0YW50cyc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9jb3JlJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL2Rpc3BsYXknO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvZXh0cmFjdCc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9ncmFwaGljcyc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9sb2FkZXJzJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL2ludGVyYWN0aW9uJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL21hdGgnO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvbWVzaCc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9tZXNoLWV4dHJhcyc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9wYXJ0aWNsZXMnO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvcHJlcGFyZSc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9ydW5uZXInO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvc3ByaXRlJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL3Nwcml0ZXNoZWV0JztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL3Nwcml0ZS1hbmltYXRlZCc7XG5leHBvcnQgKiBmcm9tICdAcGl4aS9zcHJpdGUtdGlsaW5nJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL3RleHQnO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvdGV4dC1iaXRtYXAnO1xuZXhwb3J0ICogZnJvbSAnQHBpeGkvdGlja2VyJztcbmV4cG9ydCAqIGZyb20gJ0BwaXhpL3NldHRpbmdzJztcbmV4cG9ydCB7XG4gICAgdXRpbHMsXG4gICAgdXNlRGVwcmVjYXRlZCxcbn07XG4iLCAiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcblxuZXhwb3J0IGNvbnN0IGtleXMgPSBuZXcgU2V0PEtleT4oKTtcbmV4cG9ydCB0eXBlIEtleUV2ZW50ID0gJ3VwJyB8ICdkb3duJyB8ICdrZXlwcmVzc2VkJztcblxuY2xhc3MgS2V5IGV4dGVuZHMgUElYSS51dGlscy5FdmVudEVtaXR0ZXIge1xuXHRwcml2YXRlIF9wcmVzc2VkQXQ6IG51bWJlciA9IDA7XG5cblx0Y29uc3RydWN0b3IocHVibGljIHJlYWRvbmx5IGlkOiBzdHJpbmcgfCBudW1iZXIpIHtcblx0XHRzdXBlcigpO1xuXHRcdGtleXMuYWRkKHRoaXMpO1xuXHR9XG5cblx0cHJpdmF0ZSBfaXNQcmVzc2VkOiBib29sZWFuID0gZmFsc2U7XG5cblx0Z2V0IGlzUHJlc3NlZCgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5faXNQcmVzc2VkO1xuXHR9XG5cblx0Z2V0IGR1cmF0aW9uKCk6IG51bWJlciB7XG5cdFx0aWYgKCF0aGlzLl9pc1ByZXNzZWQpIHJldHVybiAwO1xuXHRcdHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5fcHJlc3NlZEF0O1xuXHR9XG5cblx0aGFuZGxlKGV2ZW50OiBLZXlib2FyZEV2ZW50LCBhY3Rpb246IEtleUV2ZW50KSB7XG5cdFx0dGhpcy5lbWl0KGFjdGlvbiwgZXZlbnQsIHRoaXMuZHVyYXRpb24pO1xuXHRcdGlmIChhY3Rpb24gPT09ICdkb3duJyB8fCBhY3Rpb24gPT09ICdrZXlwcmVzc2VkJykge1xuXHRcdFx0dGhpcy5faXNQcmVzc2VkID0gdHJ1ZTtcblx0XHRcdHRoaXMuX3ByZXNzZWRBdCA9IERhdGUubm93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2lzUHJlc3NlZCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdG9uKGV2ZW50OiBLZXlFdmVudCwgZm46IChldmVudD86IEtleWJvYXJkRXZlbnQsIGR1cmF0aW9uPzogbnVtYmVyKSA9PiB1bmtub3duLCBjb250ZXh0PzogYW55KTogdGhpcyB7XG5cdFx0c3VwZXIub24oZXZlbnQsIGZuLCBjb250ZXh0KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdG9uY2UoZXZlbnQ6IEtleUV2ZW50LCBmbjogKGV2ZW50TjogS2V5Ym9hcmRFdmVudCwgZHVyYXRpb25OOiBudW1iZXIpID0+IHVua25vd24sIGNvbnRleHQ/OiBhbnkpOiB0aGlzIHtcblx0XHRzdXBlci5vbmNlKGV2ZW50LCBmbiwgY29udGV4dCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRpc01pbmVFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCk6IGJvb2xlYW4ge1xuXHRcdGlmICh0eXBlb2YgdGhpcy5pZCA9PT0gJ3N0cmluZycpIHJldHVybiBldmVudC5rZXkgPT09IHRoaXMuaWQ7XG5cdFx0cmV0dXJuIGV2ZW50LmtleUNvZGUgPT09IHRoaXMuaWQ7XG5cdH1cbn1cblxuZXhwb3J0IGNvbnN0IFEgPSBuZXcgS2V5KCdxJyk7XG5leHBvcnQgY29uc3QgRCA9IG5ldyBLZXkoJ2QnKTtcbmV4cG9ydCBjb25zdCB1cCA9IG5ldyBLZXkoJ0Fycm93VXAnKTtcbmV4cG9ydCBjb25zdCBsZWZ0ID0gbmV3IEtleSgnQXJyb3dMZWZ0Jyk7XG5leHBvcnQgY29uc3QgcmlnaHQgPSBuZXcgS2V5KCdBcnJvd1JpZ2h0Jyk7XG5leHBvcnQgY29uc3QgZG93biA9IG5ldyBLZXkoJ0Fycm93RG93bicpO1xuZXhwb3J0IGNvbnN0IHNwYWNlID0gbmV3IEtleSgnICcpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQgPT4ge1xuXHRrZXlzLmZvckVhY2goa2V5ID0+IHtcblx0XHRpZiAoa2V5LmlzTWluZUV2ZW50KGV2ZW50KSkga2V5LmhhbmRsZShldmVudCwgJ2Rvd24nKTtcblx0fSk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBldmVudCA9PiB7XG5cdGtleXMuZm9yRWFjaChrZXkgPT4ge1xuXHRcdGlmIChrZXkuaXNNaW5lRXZlbnQoZXZlbnQpKSBrZXkuaGFuZGxlKGV2ZW50LCAndXAnKTtcblx0fSk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBldmVudCA9PiB7XG5cdGtleXMuZm9yRWFjaChrZXkgPT4ge1xuXHRcdGlmIChrZXkuaXNNaW5lRXZlbnQoZXZlbnQpKSBrZXkuaGFuZGxlKGV2ZW50LCAna2V5cHJlc3NlZCcpO1xuXHR9KTtcbn0pO1xuIiwgImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbmV4cG9ydCBjbGFzcyBSZWN0YW5nbGUgZXh0ZW5kcyBQSVhJLlJlY3RhbmdsZSB7XG5cdHB1YmxpYyBoYWxmV2lkdGg6IG51bWJlcjtcblx0cHVibGljIGhhbGZIZWlnaHQ6IG51bWJlcjtcblx0cHVibGljIHhBbmNob3JPZmZzZXQ6IG51bWJlcjtcblx0cHVibGljIHlBbmNob3JPZmZzZXQ6IG51bWJlcjtcblx0cHVibGljIGFuY2hvcjogUElYSS5PYnNlcnZhYmxlUG9pbnQ7XG5cblx0Y29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBhbmNob3I/OiBQSVhJLk9ic2VydmFibGVQb2ludCkge1xuXHRcdHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xuXHRcdHRoaXMuYW5jaG9yID0gYW5jaG9yID8/IG5ldyBQSVhJLlBvaW50KCk7XG5cdFx0dGhpcy5oYWxmV2lkdGggPSB3aWR0aCAvIDI7XG5cdFx0dGhpcy5oYWxmSGVpZ2h0ID0gaGVpZ2h0IC8gMjtcblx0XHR0aGlzLnhBbmNob3JPZmZzZXQgPSB0aGlzLndpZHRoICogdGhpcy5hbmNob3IueDtcblx0XHR0aGlzLnlBbmNob3JPZmZzZXQgPSB0aGlzLmhlaWdodCAqIHRoaXMuYW5jaG9yLnk7XG5cdH1cblxuXHRzdGF0aWMgZnJvbVNwcml0ZShzcHJpdGU6IFBJWEkuRGlzcGxheU9iamVjdCkge1xuXHRcdHJldHVybiBuZXcgUmVjdGFuZ2xlKHNwcml0ZS54LCBzcHJpdGUueSwgc3ByaXRlLmdldEJvdW5kcygpLndpZHRoLCBzcHJpdGUuZ2V0Qm91bmRzKCkuaGVpZ2h0KTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZWN0YW5nbGVDb2xsYXBzZShyZWN0YW5nbGUxOiBQSVhJLkRpc3BsYXlPYmplY3QsIHJlY3RhbmdsZTI6IFBJWEkuRGlzcGxheU9iamVjdCkge1xuXHRjb25zdCByZWN0MSA9IFJlY3RhbmdsZS5mcm9tU3ByaXRlKHJlY3RhbmdsZTEpO1xuXHRjb25zdCByZWN0MiA9IFJlY3RhbmdsZS5mcm9tU3ByaXRlKHJlY3RhbmdsZTIpO1xuXG5cdHJldHVybiByZWN0MS54IDwgcmVjdDIueCArIHJlY3QyLndpZHRoICYmIHJlY3QxLnggKyByZWN0MS53aWR0aCA+IHJlY3QyLnggJiYgcmVjdDEueSA8IHJlY3QyLnkgKyByZWN0Mi5oZWlnaHQgJiYgcmVjdDEuaGVpZ2h0ICsgcmVjdDEueSA+IHJlY3QyLnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXN0YW5jZUJldHdlZW5Ud29Qb2ludHMocDE6IFBJWEkuSVBvaW50RGF0YSwgcDI6IFBJWEkuSVBvaW50RGF0YSk6IG51bWJlciB7XG5cdGNvbnN0IGEgPSBwMS54IC0gcDIueDtcblx0Y29uc3QgYiA9IHAxLnkgLSBwMi55O1xuXG5cdHJldHVybiBNYXRoLmh5cG90KGEsIGIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFuYWdlUmVjdGFuZ2xlQ29sbGlzaW9ucyhyZWN0YW5nbGUxOiBQSVhJLkRpc3BsYXlPYmplY3QsIHJlY3RhbmdsZTI6IFBJWEkuRGlzcGxheU9iamVjdCkge1xuXHRjb25zdCByZWN0MSA9IFJlY3RhbmdsZS5mcm9tU3ByaXRlKHJlY3RhbmdsZTEpO1xuXHRjb25zdCByZWN0MiA9IFJlY3RhbmdsZS5mcm9tU3ByaXRlKHJlY3RhbmdsZTIpO1xuXHRjb25zdCB2eCA9IHJlY3QxLnggKyBNYXRoLmFicyhyZWN0MS5oYWxmV2lkdGgpIC0gcmVjdDEueEFuY2hvck9mZnNldCAtIChyZWN0Mi54ICsgTWF0aC5hYnMocmVjdDIuaGFsZldpZHRoKSAtIHJlY3QyLnhBbmNob3JPZmZzZXQpO1xuXHRjb25zdCB2eSA9IHJlY3QxLnkgKyBNYXRoLmFicyhyZWN0MS5oYWxmSGVpZ2h0KSAtIHJlY3QxLnlBbmNob3JPZmZzZXQgLSAocmVjdDIueSArIE1hdGguYWJzKHJlY3QyLmhhbGZIZWlnaHQpIC0gcmVjdDIueUFuY2hvck9mZnNldCk7XG5cdGNvbnN0IGNvbWJpbmVkSGFsZldpZHRocyA9IE1hdGguYWJzKHJlY3QxLmhhbGZXaWR0aCkgKyBNYXRoLmFicyhyZWN0Mi5oYWxmV2lkdGgpO1xuXHRjb25zdCBjb21iaW5lZEhhbGZIZWlnaHRzID0gTWF0aC5hYnMocmVjdDEuaGFsZkhlaWdodCkgKyBNYXRoLmFicyhyZWN0Mi5oYWxmSGVpZ2h0KTtcblx0bGV0IGNvbGxpc2lvbiwgb3ZlcmxhcFgsIG92ZXJsYXBZO1xuXG5cdGlmIChNYXRoLmFicyh2eCkgPCBjb21iaW5lZEhhbGZXaWR0aHMpIHtcblx0XHRpZiAoTWF0aC5hYnModnkpIDwgY29tYmluZWRIYWxmSGVpZ2h0cykge1xuXHRcdFx0b3ZlcmxhcFggPSBjb21iaW5lZEhhbGZXaWR0aHMgLSBNYXRoLmFicyh2eCk7XG5cdFx0XHRvdmVybGFwWSA9IGNvbWJpbmVkSGFsZkhlaWdodHMgLSBNYXRoLmFicyh2eSk7XG5cblx0XHRcdGlmIChvdmVybGFwWCA+PSBvdmVybGFwWSkge1xuXHRcdFx0XHRpZiAodnkgPiAwKSB7XG5cdFx0XHRcdFx0Y29sbGlzaW9uID0gJ3RvcCc7XG5cdFx0XHRcdFx0cmVjdDEueSA9IHJlY3QxLnkgKyBvdmVybGFwWTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb2xsaXNpb24gPSAnYm90dG9tJztcblx0XHRcdFx0XHRyZWN0MS55ID0gcmVjdDEueSAtIG92ZXJsYXBZO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodnggPiAwKSB7XG5cdFx0XHRcdFx0Y29sbGlzaW9uID0gJ2xlZnQnO1xuXHRcdFx0XHRcdHJlY3QxLnggPSByZWN0MS54ICsgb3ZlcmxhcFg7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29sbGlzaW9uID0gJ3JpZ2h0Jztcblx0XHRcdFx0XHRyZWN0MS54ID0gcmVjdDEueCAtIG92ZXJsYXBYO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGNvbGxpc2lvbjtcbn1cbiIsICJpbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xuXG5pbnRlcmZhY2UgRW50aXR5T3B0aW9ucyB7XG5cdGhhc0dyYXZpdHk/OiBib29sZWFuO1xuXHRtYXNzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBFbnRpdHkgZXh0ZW5kcyBQSVhJLlNwcml0ZSBpbXBsZW1lbnRzIEVudGl0eU9wdGlvbnMge1xuXHRwdWJsaWMgaGFzR3Jhdml0eTogYm9vbGVhbjtcblx0cHVibGljIG1hc3M6IG51bWJlcjtcblx0cHVibGljIGNhbkZhbGw6IGJvb2xlYW47XG5cdHB1YmxpYyB2ZWxvY2l0eTogUElYSS5Qb2ludDtcblx0cHVibGljIGlzT25Hcm91bmQ6IGJvb2xlYW47XG5cdFxuXHRwcm90ZWN0ZWQgY29uc3RydWN0b3IodGV4dHVyZTogc3RyaW5nLCBvcHRpb25zPzogRW50aXR5T3B0aW9ucyk7XG5cdHByb3RlY3RlZCBjb25zdHJ1Y3Rvcih0ZXh0dXJlOiBQSVhJLlRleHR1cmUsIG9wdGlvbnM/OiBFbnRpdHlPcHRpb25zKTtcblx0cHJvdGVjdGVkIGNvbnN0cnVjdG9yKHRleHR1cmU6IFBJWEkuVGV4dHVyZSB8IHN0cmluZywgb3B0aW9ucz86IEVudGl0eU9wdGlvbnMpIHtcblx0XHRsZXQgdGV4dHVyZU5hbWU7XG5cdFx0aWYgKHR5cGVvZiB0ZXh0dXJlID09PSAnc3RyaW5nJykge1xuXHRcdFx0dGV4dHVyZU5hbWUgPSB0ZXh0dXJlO1xuXHRcdFx0dGV4dHVyZSA9IFBJWEkuTG9hZGVyLnNoYXJlZC5yZXNvdXJjZXNbdGV4dHVyZV0udGV4dHVyZTtcblx0XHR9XG5cdFx0aWYgKCF0ZXh0dXJlKSB0aHJvdyBuZXcgRXJyb3IoYFRleHR1cmUgJyR7dGV4dHVyZU5hbWV9JyBub3QgZm91bmQuYCk7XG5cdFx0XG5cdFx0c3VwZXIodGV4dHVyZSk7XG5cdFx0dGhpcy5zZXR1cCgpO1xuXHRcdHRoaXMudmVsb2NpdHkgPSBuZXcgUElYSS5Qb2ludCgwLCAwKTtcblx0XHR0aGlzLmhhc0dyYXZpdHkgPSBvcHRpb25zPy5oYXNHcmF2aXR5ID8/IGZhbHNlO1xuXHRcdHRoaXMubWFzcyA9IG9wdGlvbnM/Lm1hc3MgPz8gMTtcblx0XHR0aGlzLmNhbkZhbGwgPSB0cnVlO1xuXHRcdHRoaXMuaXNPbkdyb3VuZCA9IGZhbHNlO1xuXHRcdFxuXHRcdHRoaXMub24oJ3VwZGF0ZScsICgpID0+IHRoaXMudXBkYXRlKCkpO1xuXHR9XG5cdFxuXHRhYnN0cmFjdCBzZXR1cCgpO1xuXHRcblx0dXBkYXRlKCkge1xuXHRcdGlmICghdGhpcy5jYW5GYWxsKSB0aGlzLnZlbG9jaXR5LnkgPSAwO1xuXHRcdGVsc2UgaWYgKHRoaXMuaGFzR3Jhdml0eSkgdGhpcy52ZWxvY2l0eS55ICs9IDAuMTtcblx0XHRcblx0XHR0aGlzLnBvc2l0aW9uLnggKz0gdGhpcy52ZWxvY2l0eS54O1xuXHRcdHRoaXMucG9zaXRpb24ueSArPSB0aGlzLnZlbG9jaXR5Lnk7XG5cdFx0XG5cdFx0aWYgKHRoaXMuaXNPbkdyb3VuZCkgdGhpcy5lbWl0KCdvbkdyb3VuZCcpO1xuXHR9XG5cdFxuXHRkZXN0cm95KG9wdGlvbnM/OiB7IGNoaWxkcmVuPzogYm9vbGVhbjsgdGV4dHVyZT86IGJvb2xlYW47IGJhc2VUZXh0dXJlPzogYm9vbGVhbiB9KSB7XG5cdFx0c3VwZXIuZGVzdHJveShvcHRpb25zKTtcblx0fVxufVxuIiwgImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgRW50aXR5IGZyb20gJy4vRW50aXR5JztcblxuZXhwb3J0IGludGVyZmFjZSBXYWxsT3B0aW9ucyB7XG5cdHg6IG51bWJlcjtcblx0eTogbnVtYmVyO1xuXHR3aWR0aDogbnVtYmVyO1xuXHRoZWlnaHQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2FsbEVudGl0eSBleHRlbmRzIEVudGl0eSB7XG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihvcHRpb25zOiBXYWxsT3B0aW9ucykge1xuXHRcdHN1cGVyKFBJWEkuVGV4dHVyZS5XSElURSwge1xuXHRcdFx0bWFzczogMTAwMCxcblx0XHR9KTtcblx0XHR0aGlzLnBvc2l0aW9uLnNldChvcHRpb25zLngsIG9wdGlvbnMueSk7XG5cdFx0dGhpcy53aWR0aCA9IG9wdGlvbnMud2lkdGg7XG5cdFx0dGhpcy5oZWlnaHQgPSBvcHRpb25zLmhlaWdodDtcblx0fVxuXG5cdHB1YmxpYyBzZXR1cCgpIHt9XG59XG4iLCAiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCB7IGFjdHVhbFNjZW5lIH0gZnJvbSAnLi4vYXBwLmpzJztcbmltcG9ydCB7IEQsIFEsIHNwYWNlIH0gZnJvbSAnLi4vY2xpZW50L0lucHV0TWFuYWdlci5qcyc7XG5pbXBvcnQge2lzUmVjdGFuZ2xlQ29sbGFwc2UsIG1hbmFnZVJlY3RhbmdsZUNvbGxpc2lvbnN9IGZyb20gJy4uL3V0aWxzL2NvbGxpc2lvbnNVdGlscy5qcyc7XG5pbXBvcnQgRW50aXR5IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCBXYWxsRW50aXR5IGZyb20gJy4vV2FsbEVudGl0eSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllciBleHRlbmRzIEVudGl0eSB7XG5cdHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcblx0XHRzdXBlcigncGxheWVyJywge1xuXHRcdFx0aGFzR3Jhdml0eTogdHJ1ZVxuXHRcdH0pO1xuXHR9XG5cdFxuXHRwdWJsaWMgc2V0dXAoKSB7fVxuXHRcblx0cHVibGljIHVwZGF0ZSgpIHtcblx0XHRzdXBlci51cGRhdGUoKTtcblx0XHRjb25zdCB3YWxsczogV2FsbEVudGl0eVtdID0gYWN0dWFsU2NlbmUuY2hpbGRyZW4uZmlsdGVyKChlbnRpdHk6IEVudGl0eSk6IGVudGl0eSBpcyBXYWxsRW50aXR5ID0+IGVudGl0eSBpbnN0YW5jZW9mIFdhbGxFbnRpdHkpO1xuXHRcdFxuXHRcdGlmICh0aGlzLmlzT25Hcm91bmQpIHtcblx0XHRcdGlmIChRLmlzUHJlc3NlZCAmJiB0aGlzLnZlbG9jaXR5LnggPiAtNSkgdGhpcy5tb3ZlKG5ldyBQSVhJLlBvaW50KC0xLCAwKSwgMS43KTtcblx0XHRcdGlmIChELmlzUHJlc3NlZCAmJiB0aGlzLnZlbG9jaXR5LnggPCA1KSB0aGlzLm1vdmUobmV3IFBJWEkuUG9pbnQoMSwgMCksIDEuNyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChRLmlzUHJlc3NlZCAmJiB0aGlzLnZlbG9jaXR5LnggPiAtNSkgdGhpcy5tb3ZlKG5ldyBQSVhJLlBvaW50KC0xLCAwKSwgMC41NSk7XG5cdFx0XHRpZiAoRC5pc1ByZXNzZWQgJiYgdGhpcy52ZWxvY2l0eS54IDwgNSkgdGhpcy5tb3ZlKG5ldyBQSVhJLlBvaW50KDEsIDApLCAwLjU1KTtcblx0XHRcdHRoaXMudmVsb2NpdHkueCAqPSAwLjkyO1xuXHRcdH1cblx0XHRpZiAoc3BhY2UuaXNQcmVzc2VkICYmICF0aGlzLmNhbkZhbGwpIHtcblx0XHRcdHRoaXMubW92ZShuZXcgUElYSS5Qb2ludCgwLCAtMSksIDIuNSk7XG5cdFx0XHR0aGlzLnBvc2l0aW9uLnkgKz0gdGhpcy52ZWxvY2l0eS55O1xuXHRcdH1cblx0XHRcblx0XHRpZiAod2FsbHMuZXZlcnkod2FsbCA9PiAhaXNSZWN0YW5nbGVDb2xsYXBzZSh0aGlzLCB3YWxsKSkpIHtcblx0XHRcdHRoaXMuY2FuRmFsbCA9IHRydWU7XG5cdFx0XHR0aGlzLmlzT25Hcm91bmQgPSBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0d2FsbHMuZm9yRWFjaCh3YWxsID0+IHtcblx0XHRcdGlmIChpc1JlY3RhbmdsZUNvbGxhcHNlKHRoaXMsIHdhbGwpKSB7XG5cdFx0XHRcdHN3aXRjaCAobWFuYWdlUmVjdGFuZ2xlQ29sbGlzaW9ucyh3YWxsLCB0aGlzKSkge1xuXHRcdFx0XHRcdGNhc2UgJ2JvdHRvbSc6XG5cdFx0XHRcdFx0XHR0aGlzLm1vdmUobmV3IFBJWEkuUG9pbnQodGhpcy52ZWxvY2l0eS54IC8gMTAsIDEpLCAyKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNhc2UgJ3RvcCc6XG5cdFx0XHRcdFx0XHR0aGlzLmNhbkZhbGwgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMubW92ZShuZXcgUElYSS5Qb2ludCgtdGhpcy52ZWxvY2l0eS54IC8gNSwgMSksIDIpO1xuXHRcdFx0XHRcdFx0dGhpcy5pc09uR3JvdW5kID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNhc2UgJ2xlZnQnOlxuXHRcdFx0XHRcdGNhc2UgJ3JpZ2h0Jzpcblx0XHRcdFx0XHRcdHRoaXMubW92ZShuZXcgUElYSS5Qb2ludCgtdGhpcy52ZWxvY2l0eS54LCAwKSwgMSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdFxuXHRwdWJsaWMgbW92ZShkaXJlY3Rpb246IFBJWEkuUG9pbnQsIHNwZWVkOiBudW1iZXIpOiB2b2lkIHtcblx0XHR0aGlzLnZlbG9jaXR5LnggKz0gZGlyZWN0aW9uLnggKiBzcGVlZDtcblx0XHR0aGlzLnZlbG9jaXR5LnkgKz0gZGlyZWN0aW9uLnkgKiBzcGVlZDtcblx0fVxufVxuIiwgImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5pbXBvcnQgRW50aXR5IGZyb20gJy4uL2VudGl0eS9FbnRpdHknO1xuaW1wb3J0IFdhbGxFbnRpdHksIHsgV2FsbE9wdGlvbnMgfSBmcm9tICcuLi9lbnRpdHkvV2FsbEVudGl0eSc7XG5cbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIFNjZW5lIGV4dGVuZHMgUElYSS5Db250YWluZXIge1xuXHRwdWJsaWMgYmFja2dyb3VuZDogUElYSS5TcHJpdGU7XG5cblx0cHJvdGVjdGVkIGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5zZXR1cCgpO1xuXHR9XG5cblx0YWJzdHJhY3Qgc2V0dXAoKTtcblxuXHR1cGRhdGUoKSB7XG5cdFx0dGhpcy5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+IHtcblx0XHRcdGlmIChjaGlsZCBpbnN0YW5jZW9mIEVudGl0eSkgY2hpbGQuZW1pdCgndXBkYXRlJyk7XG5cdFx0fSk7XG5cdH1cblxuXHRkZXN0cm95KCkge1xuXHRcdHN1cGVyLmRlc3Ryb3koKTtcblxuXHRcdHRoaXMuYmFja2dyb3VuZC5kZXN0cm95KCk7XG5cdH1cblxuXHRwdWJsaWMgYWRkV2FsbChvcHRpb25zOiBXYWxsT3B0aW9ucykge1xuXHRcdHRoaXMuYWRkQ2hpbGQobmV3IFdhbGxFbnRpdHkob3B0aW9ucykpO1xuXHR9XG59XG4iLCAiaW1wb3J0IFBsYXllciBmcm9tICcuLi9lbnRpdHkvUGxheWVyJztcbmltcG9ydCBTY2VuZSBmcm9tICcuL1NjZW5lJztcblxuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQ2hhbWJlclNjZW5lIGV4dGVuZHMgU2NlbmUge1xuXHRwdWJsaWMgcGxheWVyOiBQbGF5ZXI7XG5cdFxuXHRwdWJsaWMgc3Bhd25QbGF5ZXIocG9zaXRpb246IFBJWEkuSVBvaW50RGF0YSkge1xuXHRcdHRoaXMucGxheWVyID0gbmV3IFBsYXllcigpO1xuXHRcdHRoaXMuYWRkQ2hpbGQodGhpcy5wbGF5ZXIpO1xuXHRcdHRoaXMucGxheWVyLnBvc2l0aW9uLnNldChwb3NpdGlvbi54LCBwb3NpdGlvbi55KTtcblx0fVxufVxuIiwgImltcG9ydCBDaGFtYmVyU2NlbmUgZnJvbSAnLi9DaGFtYmVyU2NlbmUuanMnO1xyXG5pbXBvcnQgKiBhcyBQSVhJIGZyb20gJ3BpeGkuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVzdENoYW1iZXIgZXh0ZW5kcyBDaGFtYmVyU2NlbmUge1xyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cdFxyXG5cdFxyXG5cdHB1YmxpYyBzZXR1cCgpIHtcclxuXHRcdHRoaXMuc3Bhd25QbGF5ZXIoe1xyXG5cdFx0XHR4OiAxNjAwLFxyXG5cdFx0XHR5OiA1MDBcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHR0aGlzLmJhY2tncm91bmQgPSBQSVhJLlNwcml0ZS5mcm9tKFBJWEkuTG9hZGVyLnNoYXJlZC5yZXNvdXJjZXNbJ3Rlc3RDaGFtYmVyQmFja2dyb3VuZCddLnRleHR1cmUpO1xyXG5cdFx0dGhpcy5iYWNrZ3JvdW5kLnpJbmRleCA9IC0xMDAwO1xyXG5cdFx0dGhpcy5hZGRDaGlsZCh0aGlzLmJhY2tncm91bmQpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0ICogYXMgUElYSSBmcm9tICdwaXhpLmpzJztcbmltcG9ydCBTY2VuZSBmcm9tICcuL3NjZW5lcy9TY2VuZS5qcyc7XG5pbXBvcnQgVGVzdENoYW1iZXIgZnJvbSAnLi9zY2VuZXMvVGVzdENoYW1iZXIuanMnO1xuXG5leHBvcnQgbGV0IGFjdHVhbFNjZW5lOiBTY2VuZTtcblxuZXhwb3J0IGNvbnN0IGFwcCA9IG5ldyBQSVhJLkFwcGxpY2F0aW9uKHtcblx0YW50aWFsaWFzOiB0cnVlLFxuXHRyZXNpemVUbzogd2luZG93LFxuXHRiYWNrZ3JvdW5kQ29sb3I6IDB4ZGRkZGRkLFxufSk7XG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRUZXh0dXJlcygpIHtcblx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG5cdFx0UElYSS5Mb2FkZXIuc2hhcmVkLmFkZCgndGVzdCcsICdhc3NldHMvdGVzdC5wbmcnKTtcblx0XHRQSVhJLkxvYWRlci5zaGFyZWQuYWRkKCdwbGF5ZXInLCAnYXNzZXRzL3BsYXllci5wbmcnKTtcblx0XHRQSVhJLkxvYWRlci5zaGFyZWQuYWRkKCd0ZXN0Q2hhbWJlckJhY2tncm91bmQnLCAnYXNzZXRzL3Rlc3QgbGV2ZWwucG5nJyk7XG5cdFx0UElYSS5Mb2FkZXIuc2hhcmVkLmxvYWQocmVzb2x2ZSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiB0ZXN0cygpIHtcblx0UElYSS5Mb2FkZXIuc2hhcmVkLm9uQ29tcGxldGUuYWRkKCgpID0+IHtcblx0XHRjb25zdCBzcHJpdGUgPSBQSVhJLlNwcml0ZS5mcm9tKFBJWEkuTG9hZGVyLnNoYXJlZC5yZXNvdXJjZXNbJ3Rlc3QnXS50ZXh0dXJlKTtcblx0XHRzcHJpdGUucG9zaXRpb24uc2V0KHdpbmRvdy5pbm5lcldpZHRoIC8gMiwgd2luZG93LmlubmVySGVpZ2h0IC8gMik7XG5cdFx0YXBwLnN0YWdlLmFkZENoaWxkKHNwcml0ZSk7XG5cdH0pO1xuXG5cdFBJWEkuVGlja2VyLnNoYXJlZC5hZGQoXG5cdFx0KCkgPT4ge1xuXHRcdFx0YWN0dWFsU2NlbmU/LnVwZGF0ZSgpO1xuXHRcdH0sXG5cdFx0dW5kZWZpbmVkLFxuXHRcdFBJWEkuVVBEQVRFX1BSSU9SSVRZLkhJR0hcblx0KTtcblxuXHRzZXRTY2VuZShuZXcgVGVzdENoYW1iZXIoKSk7XG59XG5cbmZ1bmN0aW9uIHNldFNjZW5lKHNjZW5lOiBTY2VuZSkge1xuXHRhY3R1YWxTY2VuZSA9IHNjZW5lO1xuXHRhcHAuc3RhZ2UuYWRkQ2hpbGQoYWN0dWFsU2NlbmUpO1xufVxuXG5sb2FkVGV4dHVyZXMoKS50aGVuKCgpID0+IHtcblx0dGVzdHMoKTtcbn0pO1xuXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFwcC52aWV3KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUEsSUFBQyxVQUFTO0FBTVYsVUFBSSxnQkFBZ0IsUUFBTztBQUMzQixVQUFJLHlCQUNGLGlCQUdBLGFBQWEsaUJBQ2IsWUFBWSxpQkFDWixTQUFTLGlCQUNULFVBQVUsaUJBR1Q7QUFDQyxZQUFJO0FBQ0osWUFB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QUFBWixFQUFBLFVBQVk7QUFDUixpQkFBQSxhQUFBLFdBQUEsU0FBQTtBQUNBLGlCQUFBLGFBQUEsV0FBQSxPQUFBO0FBQ0EsaUJBQUEsYUFBQSxhQUFBLFFBQUE7S0FIUSxlQUFBLGVBQVc7QUFnRHZCLE1BQVk7QUFBWixFQUFBLFVBQVk7QUFDUixpQkFBQSxhQUFBLFlBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsU0FBQSxLQUFBO0FBQ0EsaUJBQUEsYUFBQSxjQUFBLEtBQUE7QUFDQSxpQkFBQSxhQUFBLFlBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsYUFBQSxLQUFBO0FBQ0EsaUJBQUEsYUFBQSxZQUFBLEtBQUE7QUFDQSxpQkFBQSxhQUFBLGFBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsaUJBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsZUFBQSxNQUFBO0FBQ0EsaUJBQUEsYUFBQSxTQUFBLE1BQUE7QUFDQSxpQkFBQSxhQUFBLGdCQUFBLE1BQUE7QUFDQSxpQkFBQSxhQUFBLFdBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsZ0JBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsYUFBQSxNQUFBO0FBQ0EsaUJBQUEsYUFBQSxnQkFBQSxNQUFBO0FBQ0EsaUJBQUEsYUFBQSxVQUFBLE1BQUE7QUFFQSxpQkFBQSxhQUFBLGNBQUEsS0FBQTtBQUNBLGlCQUFBLGFBQUEsWUFBQSxNQUFBO0FBQ0EsaUJBQUEsYUFBQSxhQUFBLE1BQUE7QUFDQSxpQkFBQSxhQUFBLGNBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsY0FBQSxNQUFBO0FBQ0EsaUJBQUEsYUFBQSxZQUFBLE1BQUE7QUFDQSxpQkFBQSxhQUFBLGFBQUEsTUFBQTtBQUNBLGlCQUFBLGFBQUEsY0FBQSxNQUFBO0FB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LEVBQUUsTUFBUSxFQUFFLEtBQUssRUFBRTtBQUNwRSxVQUFJLEtBQU0sRUFBRSxLQUFLLEVBQUUsS0FBTyxFQUFFLEtBQUssRUFBRSxLQUFPLEVBQUUsS0FBSyxFQUFFLE1BQVEsRUFBRSxLQUFLLEVBQUU7QUFDcEUsVUFBSSxLQUFNLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsS0FBTyxFQUFFLEtBQUssRUFBRSxNQUFRLEVBQUUsS0FBSyxFQUFFO0FBQ3BFLFVBQUksS0FBTSxFQUFFLEtBQUssRUFBRSxLQUFPLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsTUFBUSxFQUFFLEtBQUssRUFBRSxNQUFPLEVBQUU7QUFHN0UsVUFBSSxLQUFNLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsS0FBTyxFQUFFLEtBQUssRUFBRSxNQUFRLEVBQUUsS0FBSyxFQUFFO0FBQ3BFLFVBQUksS0FBTSxFQUFFLEtBQUssRUFBRSxLQUFPLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsTUFBUSxFQUFFLEtBQUssRUFBRTtBQUNwRSxVQUFJLEtBQU0sRUFBRSxLQUFLLEVBQUUsS0FBTyxFQUFFLEtBQUssRUFBRSxLQUFPLEVBQUUsS0FBSyxFQUFFLE1BQVEsRUFBRSxLQUFLLEVBQUU7QUFDcEUsVUFBSSxLQUFNLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsS0FBTyxFQUFFLEtBQUssRUFBRSxNQUFRLEVBQUUsS0FBSyxFQUFFO0FBQ3BFLFVBQUksS0FBTSxFQUFFLEtBQUssRUFBRSxLQUFPLEVBQUUsS0FBSyxFQUFFLEtBQU8sRUFBRSxLQUFLLEVBQUUsTUFBUSxFQUFFLEtBQUssRUFBRSxNQUFPLEVBQUU7QUFHN0UsVUFBSSxNQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3pFLFVBQUksTUFBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsTUFBUSxFQUFFLE1BQU0sRUFBRTtBQUN6RSxVQUFJLE1BQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLE1BQVEsRUFBRSxNQUFNLEVBQUU7QUFDekUsVUFBSSxNQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3pFLFVBQUksTUFBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsTUFBUSxFQUFFLE1BQU0sRUFBRSxNQUFPLEVBQUU7QUFHbEYsVUFBSSxNQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3pFLFVBQUksTUFBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsTUFBUSxFQUFFLE1BQU0sRUFBRTtBQUN6RSxVQUFJLE1BQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLE1BQVEsRUFBRSxNQUFNLEVBQUU7QUFDekUsVUFBSSxNQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsS0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3pFLFVBQUksTUFBTyxFQUFFLE1BQU0sRUFBRSxLQUFPLEVBQUUsTUFBTSxFQUFFLEtBQU8sRUFBRSxNQUFNLEVBQUUsTUFBUSxFQUFFLE1BQU0sRUFBRSxNQUFPLEVBQUU7QUFFbEYsYUFBTzs7QUFVSCx1QkFBQSxVQUFBLGVBQVIsU0FBcUI7QUFHakIsVUFBTSxJQUFJLElBQUksYUFBYTtBQUUzQixRQUFFLE1BQU07QUFDUixRQUFFLE1BQU07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TixXQUFLLFdBQVc7QUFBQTtBQUFBLElBR1YsUUFBUTtBQUNkLFdBQUssU0FBUyxJQUFJLG1CQUFXO0FBQUE7QUFBQTtBQTNCL0IsTUFJTyxnQkFKUDs7O0FDQUEsbUNBR21EO0FBQUEsSUFHM0MsWUFBWTtBQUNsQixXQUFLLFNBQVMsSUFBSTtBQUNsQixXQUFLLFNBQVMsS0FBSztBQUNuQixXQUFLLE9BQU8sU0FBUyxJQUFJLFNBQVMsR0FBRyxTQUFTO0FBQUE7QUFBQTtBQVRoRCxNQUdPLHVCQUhQOzs7QUNBQSxrQ0FHeUM7QUFBQSxJQUNqQztBQUNOO0FBQUE7QUFBQSxJQUlNO0FBQ04sV0FBSyxZQUFZO0FBQUEsUUFDaEIsR0FBRztBQUFBLFFBQ0gsR0FBRztBQUFBO0FBR0osV0FBSyxhQUFhLEFBQUssT0FBTyxLQUFLLEFBQUssUUFBTyxPQUFPLFVBQVUseUJBQXlCO0FBQ3pGLFdBQUssV0FBVyxTQUFTO0FBQ3pCLFdBQUssU0FBUyxLQUFLO0FBQUE7QUFBQTtBQWpCckIsTUFHTyxzQkFIUDs7O0FDSU8sTUFBSTtBQUVKLE1BQU0sTUFBTSxJQUFTLFlBQVk7QUFBQSxJQUN2QyxXQUFXO0FBQUEsSUFDWCxVQUFVO0FBQUEsSUFDVixpQkFBaUI7QUFBQTtBQUdsQjtBQUNDLFVBQU0sSUFBSSxRQUFRO0FBQ2pCLE1BQUssUUFBTyxPQUFPLElBQUksUUFBUTtBQUMvQixNQUFLLFFBQU8sT0FBTyxJQUFJLFVBQVU7QUFDakMsTUFBSyxRQUFPLE9BQU8sSUFBSSx5QkFBeUI7QUFDaEQsTUFBSyxRQUFPLE9BQU8sS0FBSztBQUFBO0FBQUE7QUFJMUI7QUFDQyxJQUFLLFFBQU8sT0FBTyxXQUFXLElBQUk7QUFDakMsWUFBTSxTQUFTLEFBQUssT0FBTyxLQUFLLEFBQUssUUFBTyxPQUFPLFVBQVUsUUFBUTtBQUNyRSxhQUFPLFNBQVMsSUFBSSxPQUFPLGFBQWEsR0FBRyxPQUFPLGNBQWM7QUFDaEUsVUFBSSxNQUFNLFNBQVM7QUFBQTtBQUdwQixJQUFLLE9BQU8sT0FBTyxJQUNsQjtBQUNDLGlEQUFhO0FBQUEsT0FFZCxRQUNBLEFBQUssZ0JBQWdCO0FBR3RCLGFBQVMsSUFBSTtBQUFBO0FBR2Qsb0JBQWtCO0FBQ2pCLGtCQUFjO0FBQ2QsUUFBSSxNQUFNLFNBQVM7QUFBQTtBQUdwQixpQkFBZSxLQUFLO0FBQ25CO0FBQUE7QUFHRCxXQUFTLEtBQUssWUFBWSxJQUFJOyIsCiAgIm5hbWVzIjogW10KfQo=
